WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'confluence.extra.jira:macro-browser-resources', location = 'templates/extra/jira/view-in-jira.js' */
AJS.bind("add-handler.property-panel",function(b,a){AJS.log("add-handler.property-panel: panel name = "+a.name);if(a.name!="macro"){return}a.registerButtonHandler("view-in-jira",function(o,h){if(AJS.Editor.JiraConnector.servers){var l=AJS.Editor.JiraConnector.servers;var c=AJS.$(h);var f=c.attr("data-macro-default-parameter");var s=c.attr("data-macro-parameters")||"";var e=Confluence.MacroParameterSerializer.deserialize(s);var u=/=|!=|~|>|<|!~| is | in /i;var d=function(v){var i=v.indexOf("|");if(i>=0){return v.substring(0,i)}return v};var k=f||e.jqlQuery||e.key||d(s);var g=e.server;var j=e.serverId;var q=k.match(u);var m=null;for(var p=0;p<l.length;p++){if((j&&l[p].id==j)){m=l[p];break}if((g&&l[p].name==g)||(!g&&l[p].selected)){m=l[p];break}}if(m!=null){var r=(typeof m.displayUrl!=="undefined")?m.displayUrl:m.url;if(r.charAt(r.length-1)=="/"){r=r.substr(0,r.length-1)}var t=tinymce.isIE?"_blank":"confluence-goto-jiralink-"+AJS.params.pageId;if(!q){var n=window.open(r+"/browse/"+encodeURIComponent(k),t);n.opener=null}else{var n=window.open(r+"/secure/IssueNavigator.jspa?reset=true&jqlQuery="+encodeURIComponent(k),t);n.opener=null}}}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:macro-browser-resources', location = 'templates/extra/jira/show-summary.js' */
AJS.bind("init.rte",function(){if(!AJS.Confluence&&!AJS.Confluence.PropertyPanel&&!AJS.Confluence.PropertyPanel.Macro){AJS.logError("Jira Issues Macro : can't register property panel init handler since AJS.Confluence.PropertyPanel.Macro is undefined");return}var a="showSummary";var f="jira";var e="jiraissues";var d="show-summary";AJS.Confluence.PropertyPanel.Macro.registerInitHandler(c,f);AJS.Confluence.PropertyPanel.Macro.registerInitHandler(c,e);function c(g,m,j){var l=AJS.$.grep(m,function(i){return i.parameterName==d})[0];if(!l){AJS.logError("Jira Issues Macro - Show-summary : The system cannot find SummaryButton, all buttons are: ");for(var k in m){AJS.logError(m[k].text)}return}if(b(g)){var h=AJS.SummaryHelper.getParam(g,a);if(h=="false"){l.text="\u663e\u793a\u6c47\u603b"}else{l.text="\u9690\u85cf\u6c47\u603b"}}else{l.className+=" hidden"}}function b(g){var i=AJS.$(g);var j=i.attr("src");if(!j){return true}var h=AJS.SummaryHelper.getParam(g,"count");if(j.indexOf("confluence.extra.jira/jira-table")==-1&&h!="true"){return true}return false}});AJS.bind("add-handler.property-panel",function(b,a){if(a.name!="macro"){return}a.registerButtonHandler("show-summary",function(e,c){var d=AJS.SummaryHelper.getParam(c,"showSummary");AJS.SummaryHelper.updateMacro("jira",c,"showSummary",d=="false"?"true":"false")})});AJS.SummaryHelper=(function(){return{getCurrentParams:function(a){return Confluence.MacroParameterSerializer.deserialize(a.attr("data-macro-parameters"))},getParam:function(a,d){var c=AJS.$(a);var b=AJS.SummaryHelper.getCurrentParams(c);return b[d]},updateMacro:function(b,a,c,g){var e=AJS.$(a);AJS.Rte.getEditor().selection.select(e[0]);AJS.Rte.BookmarkManager.storeBookmark();var d=AJS.SummaryHelper.getCurrentParams(e);d[c]=g;var f={contentId:Confluence.Editor.getContentId(),macro:{name:b,params:d,defaultParameterValue:e.attr("data-macro-default-parameter")}};tinymce.confluence.MacroUtils.insertMacro(f)}}})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:fields', location = '/fields/fields.soy' */
// This file was automatically generated from fields.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace jiraIntegration.templates.fields.
 */

if (typeof jiraIntegration == 'undefined') { var jiraIntegration = {}; }
if (typeof jiraIntegration.templates == 'undefined') { jiraIntegration.templates = {}; }
if (typeof jiraIntegration.templates.fields == 'undefined') { jiraIntegration.templates.fields = {}; }


jiraIntegration.templates.fields.stringField = function(opt_data, opt_ignored) {
  return '' + jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {extraFieldClasses: 'long-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.stringField.soyTemplateName = 'jiraIntegration.templates.fields.stringField';
}


jiraIntegration.templates.fields.textareaField = function(opt_data, opt_ignored) {
  return '<div class="field-group jira-field' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '" data-jira-type="' + soy.$$escapeHtml(opt_data.jiraType) + '"><label for="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.labelText) + ((opt_data.isRequired) ? '<span class="aui-icon icon-required"></span>' : '') + '</label><textarea rows="3" id="' + soy.$$escapeHtml(opt_data.name) + '" class="textarea long-field" data-name="' + soy.$$escapeHtml(opt_data.name) + '" name="' + soy.$$escapeHtml(opt_data.name) + '"' + ((opt_data.extraAttributes) ? ' ' + aui.renderExtraAttributes(opt_data) : '') + '>' + soy.$$escapeHtml(opt_data.value) + '</textarea>' + jiraIntegration.templates.fields.errors(opt_data) + '</div>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.textareaField.soyTemplateName = 'jiraIntegration.templates.fields.textareaField';
}


jiraIntegration.templates.fields.arrayField = function(opt_data, opt_ignored) {
  return '' + jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {extraFieldClasses: 'long-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.arrayField.soyTemplateName = 'jiraIntegration.templates.fields.arrayField';
}


jiraIntegration.templates.fields.numberField = function(opt_data, opt_ignored) {
  return '' + jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {extraFieldClasses: 'medium-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.numberField.soyTemplateName = 'jiraIntegration.templates.fields.numberField';
}


jiraIntegration.templates.fields.allowedValuesField = function(opt_data, opt_ignored) {
  return '' + ((opt_data.options.length) ? jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {type: 'select'})) : jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {type: 'value', value: '\u65e0'})));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.allowedValuesField.soyTemplateName = 'jiraIntegration.templates.fields.allowedValuesField';
}


jiraIntegration.templates.fields.timeTrackingField = function(opt_data, opt_ignored) {
  return '' + jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {extraFieldClasses: 'medium-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.timeTrackingField.soyTemplateName = 'jiraIntegration.templates.fields.timeTrackingField';
}


jiraIntegration.templates.fields.radioField = function(opt_data, opt_ignored) {
  return '' + aui.form.radioField(soy.$$augmentMap(opt_data, {legendContent: opt_data.labelText, extraAttributes: {'data-name': opt_data.name, name: opt_data.name, 'data-jira-type': opt_data.jiraType}, extraClasses: 'jira-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.radioField.soyTemplateName = 'jiraIntegration.templates.fields.radioField';
}


jiraIntegration.templates.fields.unrenderableTypeField = function(opt_data, opt_ignored) {
  return '<div class="field-group jira-field jira-field-unrenderable' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '"><label>' + soy.$$escapeHtml(opt_data.labelText) + ((opt_data.isRequired) ? '<span class="aui-icon icon-required"></span>' : '') + '</label>' + aui.form.value({content: opt_data.reasonContent}) + jiraIntegration.templates.fields.errors(opt_data) + '</div>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.unrenderableTypeField.soyTemplateName = 'jiraIntegration.templates.fields.unrenderableTypeField';
}


jiraIntegration.templates.fields.dateField = function(opt_data, opt_ignored) {
  return '' + jiraIntegration.templates.fields.fieldWithExtraAttributes(soy.$$augmentMap(opt_data, {extraFieldClasses: 'medium-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.dateField.soyTemplateName = 'jiraIntegration.templates.fields.dateField';
}


jiraIntegration.templates.fields.checkboxField = function(opt_data, opt_ignored) {
  return '' + aui.form.checkboxField(soy.$$augmentMap(opt_data, {legendContent: opt_data.labelText, extraAttributes: {'data-name': opt_data.name, name: opt_data.name, 'data-jira-type': opt_data.jiraType}, extraClasses: 'jira-field'}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.checkboxField.soyTemplateName = 'jiraIntegration.templates.fields.checkboxField';
}


jiraIntegration.templates.fields.select2WithIconField = function(opt_data, opt_ignored) {
  var output = '<div class="field-group jira-field' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '" data-jira-type="' + soy.$$escapeHtml(opt_data.jiraType) + '"><label for="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.labelText) + ((opt_data.isRequired) ? '<span class="aui-icon icon-required"></span>' : '') + '</label><select id="' + soy.$$escapeHtml(opt_data.name) + '" class="medium-field" name="' + soy.$$escapeHtml(opt_data.name) + '" data-name="' + soy.$$escapeHtml(opt_data.name) + '"' + ((opt_data.extraAttributes) ? ' ' + aui.renderExtraAttributes(opt_data) : '') + '>';
  var optionList112 = opt_data.options;
  var optionListLen112 = optionList112.length;
  for (var optionIndex112 = 0; optionIndex112 < optionListLen112; optionIndex112++) {
    var optionData112 = optionList112[optionIndex112];
    output += '<option value="' + soy.$$escapeHtml(optionData112.value) + '" ' + ((optionData112.selected) ? 'selected' : '') + ' data-icon-url="' + soy.$$escapeHtml(optionData112.iconUrl) + '">' + soy.$$escapeHtml(optionData112.text) + '</option>';
  }
  output += '</select>' + jiraIntegration.templates.fields.errors(opt_data) + '</div>';
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.select2WithIconField.soyTemplateName = 'jiraIntegration.templates.fields.select2WithIconField';
}


jiraIntegration.templates.fields.select2WithIconOption = function(opt_data, opt_ignored) {
  return ((opt_data.iconUrl) ? aui.avatar.avatar({avatarImageUrl: opt_data.iconUrl, size: 'xsmall', isProject: opt_data.isProject, extraClasses: 'select-option-image', tagName: 'span'}) : '') + '<span class="select-option" title="' + soy.$$escapeHtml(opt_data.optionValue) + '">' + soy.$$escapeHtml(opt_data.optionValue) + '</span>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.select2WithIconOption.soyTemplateName = 'jiraIntegration.templates.fields.select2WithIconOption';
}


jiraIntegration.templates.fields.labelFieldResult = function(opt_data, opt_ignored) {
  return '' + ((opt_data.label.isNew) ? soy.$$escapeHtml(AJS.format('\x22{0}\x22 - (\u65b0\u6807\u7b7e)',opt_data.label.labelName)) : soy.$$escapeHtml(opt_data.label.labelName));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.labelFieldResult.soyTemplateName = 'jiraIntegration.templates.fields.labelFieldResult';
}


jiraIntegration.templates.fields.userOptionSelect = function(opt_data, opt_ignored) {
  var output = '';
  var userOption__soy150 = '' + soy.$$escapeHtml(opt_data.displayName) + ((! opt_data.isSystemOption) ? ' - (' + soy.$$escapeHtml(opt_data.name) + ')' : '');
  output += '<span data-value="' + soy.$$escapeHtml(opt_data.name) + '" title="' + soy.$$filterNoAutoescape(userOption__soy150) + '">' + soy.$$filterNoAutoescape(userOption__soy150) + '</span>';
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.userOptionSelect.soyTemplateName = 'jiraIntegration.templates.fields.userOptionSelect';
}


jiraIntegration.templates.fields.sprintSelect = function(opt_data, opt_ignored) {
  return '<span title="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.name) + '<span class="sprint-detail">' + ((opt_data.state == 'FUTURE') ? soy.$$escapeHtml(AJS.format('\uff08{0} \u4e2d\u7684\u672a\u6765\u51b2\u523a\uff09',opt_data.board)) : '') + ((opt_data.state == 'ACTIVE') ? soy.$$escapeHtml(AJS.format('\uff08{0} \u4e2d\u7684\u6d3b\u8dc3\u51b2\u523a\uff09',opt_data.board)) : '') + '</span></span>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.sprintSelect.soyTemplateName = 'jiraIntegration.templates.fields.sprintSelect';
}


jiraIntegration.templates.fields.epicSelect = function(opt_data, opt_ignored) {
  return '<span title="' + soy.$$escapeHtml(opt_data.name) + ' (' + soy.$$escapeHtml(opt_data.key) + ')">' + soy.$$escapeHtml(opt_data.name) + ((opt_data.key) ? '<span class="epic-detail">' + soy.$$escapeHtml(opt_data.key) + '</span>' : '') + '</span>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.epicSelect.soyTemplateName = 'jiraIntegration.templates.fields.epicSelect';
}


jiraIntegration.templates.fields.errors = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '';
  if (opt_data.errorTexts) {
    var errorList195 = opt_data.errorTexts;
    var errorListLen195 = errorList195.length;
    for (var errorIndex195 = 0; errorIndex195 < errorListLen195; errorIndex195++) {
      var errorData195 = errorList195[errorIndex195];
      output += '<div class="error">' + soy.$$escapeHtml(errorData195) + '</div>';
    }
  }
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.errors.soyTemplateName = 'jiraIntegration.templates.fields.errors';
}


jiraIntegration.templates.fields.fieldWithExtraAttributes = function(opt_data, opt_ignored) {
  var output = '<div class="field-group jira-field' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '" data-jira-type=' + soy.$$escapeHtml(opt_data.jiraType) + '>' + aui.form.label({forField: opt_data.name, isRequired: opt_data.isRequired, content: '' + soy.$$escapeHtml(opt_data.labelText)});
  switch (opt_data.type) {
    case 'select':
      output += aui.form.select({id: opt_data.name, name: opt_data.name, labelContent: '' + soy.$$escapeHtml(opt_data.labelText), options: opt_data.options, isRequired: opt_data.isRequired, isMultiple: opt_data.isMultiple, extraAttributes: soy.$$augmentMap({'data-name': opt_data.name}, opt_data.extraAttributes), extraClasses: opt_data.extraFieldClasses});
      break;
    case 'value':
      output += aui.form.value({id: opt_data.name, content: '' + soy.$$escapeHtml(opt_data.value)});
      break;
    default:
      output += aui.form.input({id: opt_data.name, name: opt_data.name, type: 'text', value: opt_data.value, extraAttributes: soy.$$augmentMap({'data-name': opt_data.name}, opt_data.extraAttributes), extraClasses: opt_data.extraFieldClasses});
  }
  output += jiraIntegration.templates.fields.errors(opt_data) + '</div>';
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.fieldWithExtraAttributes.soyTemplateName = 'jiraIntegration.templates.fields.fieldWithExtraAttributes';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:fields', location = '/fields/fields.js' */
window.jiraIntegration=window.jiraIntegration||{};window.jiraIntegration.fields=(function(V,aq){var t=window.jiraIntegration;var o="YYYY-MM-DD";var k={template:t.templates.fields.stringField,getContext:E,getValue:N};var ah={template:t.templates.fields.stringField,getContext:ai,getValue:N};var Y={template:t.templates.fields.stringField,getContext:u,getInternalValue:y,getValue:w,behavior:j};var I={template:t.templates.fields.stringField,getContext:u,getValue:Q,behavior:r};var D={template:t.templates.fields.arrayField,getContext:l,getValue:M,behavior:m};var B={template:t.templates.fields.textareaField,getContext:E,getValue:N};var S={template:t.templates.fields.numberField,getContext:aj,getValue:P};var e={template:t.templates.fields.arrayField,getContext:l,getValue:M};var an={template:t.templates.fields.allowedValuesField,getContext:i,getValue:aq.bind(c,null,"id"),behavior:ap};var ac={template:t.templates.fields.allowedValuesField,getContext:i,getValue:aq.bind(c,null,"id")};var ab={template:t.templates.fields.timeTrackingField,getContext:ao,getValue:h};var X={template:t.templates.fields.dateField,getContext:J,getValue:x,behavior:H};var n={template:t.templates.fields.select2WithIconField,getContext:U,getValue:aq.bind(c,null,"id"),behavior:b};var v={template:t.templates.fields.unrenderableTypeField,getContext:f,};var ar={template:t.templates.fields.stringField,getContext:E,getInternalValue:y,getValue:P,behavior:Z,};var z={template:t.templates.fields.stringField,getContext:E,getInternalValue:y,getValue:aa,behavior:ag,};var af={template:t.templates.fields.checkboxField,getContext:ae,getValue:L,};var W={template:t.templates.fields.radioField,getContext:ae,getValue:d,};var p={"com.pyxis.greenhopper.jira:gh-epic-label":k,string:k,summary:k,"com.atlassian.jira.plugin.system.customfieldtypes:textfield":k,"com.atlassian.jira.plugin.system.customfieldtypes:url":ah,environment:B,"com.atlassian.jira.plugin.system.customfieldtypes:textarea":B,description:B,"com.atlassian.jira.plugin.system.customfieldtypes:float":S,array:e,"com.atlassian.jira.plugin.system.customfieldtypes:labels":e,labels:D,priority:n,resolution:an,fixVersions:an,versions:an,components:an,security:an,"com.atlassian.jira.plugin.system.customfieldtypes:version":an,"com.atlassian.jira.plugin.system.customfieldtypes:multiversion":an,"com.atlassian.jira.plugin.system.customfieldtypes:project":an,assignee:Y,reporter:I,"com.atlassian.jira.plugin.system.customfieldtypes:userpicker":I,"com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker":I,timetracking:ab,duedate:X,"com.atlassian.jira.plugin.system.customfieldtypes:datepicker":X,"com.atlassian.jira.plugin.system.customfieldtypes:multiselect":ac,"com.atlassian.jira.plugin.system.customfieldtypes:select":ac,"com.pyxis.greenhopper.jira:gh-sprint":ar,"com.pyxis.greenhopper.jira:gh-epic-link":z,"com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes":af,"com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons":W,};var F={ignoreFieldsWithDefaultValue:false};function A(az,aC,aD,aA){var at=aC.schema.system||"customfield_"+aC.schema.customId;var au=aC.schema.system||aC.schema.custom||aC.schema.customId;var av=p[au];var aB=Boolean(av&&(!av.canRender||av.canRender(aC)));var ay=Boolean(aC.operations&&aC.operations.length);var aE=aB&&ay?av:v;var ax=aC.required&&{"data-aui-validation-field":"",required:true};var aw={labelText:aC.name,name:at,isRequired:aC.required,value:aD[at],errorTexts:aA[at],jiraType:au,isRenderable:aB,hasOperations:ay,handler:aE,extraAttributes:ax};return aE.getContext(aw,aC,az,aD)}function f(av,at,au){if(!av.isRenderable){av.reasonContent=au?AJS.format("\u5728 Jira \u4e2d{0}\u7f16\u8f91{1}\u8fd9\u4e2a\u5b57\u6bb5\u3002",'<a href="'+au.url+'">',"</a>"):AJS.escapeHtml("\u521b\u5efa\u5b8c\u6210\u540e\uff0c\u5728 Jira \u4e2d\u7f16\u8f91\u6b64\u5b57\u6bb5\u3002")}else{if(!av.hasOperations){av.reasonContent=au?AJS.format("\u5728 Jira \u4e2d{0}\u7f16\u8f91{1}\u8fd9\u4e2a\u5b57\u6bb5\u3002",'<a href="'+au.url+'">',"</a>"):AJS.escapeHtml("\u521b\u5efa\u5b8c\u6210\u540e\uff0c\u5728 Jira \u4e2d\u7f16\u8f91\u6b64\u5b57\u6bb5\u3002")}else{av.reasonContent=null}}return av}function E(aw,at,au){var av=aw.name;aw.value=(V.isPlainObject(aw.value)?aw.value.name:aw.value)||(au&&au.fields[av])||(at&&at.defaultValue)||"";return aw}function N(at){return at.val()}function ai(av,at,au){var aw={"data-aui-validation-field":"",pattern:"([a-zA-Z][a-zA-Z0-9-+.]*://.+)|^$","data-aui-validation-pattern-msg":"\u8f93\u5165\u6709\u6548 URL \u65b9\u6848"};return V.extend(true,{},E(av,at,au),{extraAttributes:aw})}function J(av,at,au){var aw={"data-aui-validation-field":"",pattern:"^([0-9]{2,4}-(0?[1-9]|10|11|12)-([0-2]?[1-9]|10|20|30|31))$|^$","data-aui-validation-pattern-msg":"\u8f93\u5165\u6709\u6548\u65e5\u671f"};return V.extend(true,{},E(av,at,au),{extraAttributes:aw})}function x(at){var au=at.val();if(au===""){return null}else{return au}}function aj(av,at,au){var aw={"data-aui-validation-field":"",pattern:"(([0-9]*[.])?[0-9]+)|^$","data-aui-validation-pattern-msg":"\u8f93\u5165\u6709\u6548\u6570\u5b57"};return V.extend(true,{},E(av,at,au),{extraAttributes:aw})}function P(at){var au=at.val();if(C(au)){return Number(au)}return au||null}function H(at){var av=at.find("input");if(!!navigator.userAgent.match(/Trident/)&&AJS.version<"5.3.5"){var au="placeholder" in document.createElement("input");av.attr("placeholder",o);if(!au){av.on("focus",function(){if(av.val()===av.attr("placeholder")){av.val("")}}).on("blur",function(){if(av.val()===""){av.val(av.attr("placeholder"))}}).blur()}}else{WRM.require("wr!com.atlassian.auiplugin:aui-date-picker").done(function(){av.datePicker({overrideBrowserDefault:true})})}}function l(aw,at,au){var av=aw.name;aw.value=(aw.value&&aw.value.join(","))||(au&&au.fields[av]&&au.fields[av].join(","))||(at&&at.defaultValue&&at.defaultValue.join(" "));return aw}function M(at){return aq.map(at.val().split(","),V.trim)}function i(au,aA,az){var at=au.name;var aB=au.value;var av=az&&az.fields[at];var aw=aA&&aA.defaultValue;var ay;function ax(aC){if(Array.isArray(aC)){return aC.map(function(aD){return aD.name||aD.id})}else{return[aC.name||aC.id]}}if(aB){ay=ax(aB)}else{if(av){ay=ax(av)}else{if(aw){ay=ax(aw)}else{ay=[]}}}au.options=aq.map(aA.allowedValues,function(aC){return{value:aC.id,text:aC.name||aC.value,selected:aq.contains(ay,aC.name||aC.id)}});if(!aA.required&&aA.schema.type==="option"){au.options.unshift({value:-1,text:"\u65e0"})}au.isMultiple=aq.contains(aA.operations,"add");delete au.value;return au}function c(aw,au){var ax=au.val();var at=au.attr("multiple");var av=function(az){var ay={};ay[aw]=az;return ay};if(at){return Array.isArray(ax)?aq.map(ax,av):[av(ax)]}return av(ax)}function ap(at){at.find("select[multiple]").auiSelect2()}function u(aw,at,au){var av=aw.name;aw.value=(aw.value&&aw.value.name)||(au&&au.fields[av]&&au.fields[av].name)||(R(at)==="assignee"?-1:"")||(at&&at.defaultValue&&at.defaultValue.name);aw.extraClasses=at.schema.type==="array"?"multi-user-picker":"single-user-picker";return aw}function Q(au){var av=function(ax){return{name:ax}};var aw=au.val();var at=au.closest(".jira-field").is(".multi-user-picker");if(!aw){return at?[]:null}return at?aq.map(aw.split(","),av):av(aw)}function w(at){var au=at.val();if(au==="-1"){return undefined}return{name:au}}function ae(av,at,au){var aw=av.value||(au&&au.fields[av.name])||(at&&at.defaultValue);av.fields=aq.map(at.allowedValues,function(ax){return{value:ax.id,labelText:ax.name||ax.value,isChecked:Array.isArray(aw)?aw.some(function(ay){return ay.id===ax.id}):aw&&aw.id===ax.id,}});delete av.value;return av}function L(at){return at.find("input:checked").toArray().map(function(av){var au=V(av);return{id:au.attr("value"),value:au.parent().find("label").text()}})}function d(au){var at=L(au);return at.length===1?at[0]:null}function am(aA,at,ax,az,au){var ay=aA.find("input");var aB=aA.attr("name");ay.removeClass("text").removeClass("long-field").addClass("medium-long-field");var av={minimumInputLength:1,id:aB,name:aB,query:function(aD){function aC(aE){aD.callback({results:aE})}q(at,ax,aD.term,az).done(aC)}};ay.auiSelect2(V.extend(av,au));var aw=ay.auiSelect2("data");if(aw&&aw.id!==-1){ay.auiSelect2("val",aw.id)}aA.find("div.aui-select2-container").addClass("jira-select2-drop-box")}function r(at,ax,aw,av){var au=(at.find(".long-field").attr("value"))||"";var ay={formatInputTooShort:function(){return "\u67e5\u627e\u7528\u6237......"},initSelection:al(ax,{id:-1,text:au,isSystemOption:false}),};O(at,ax,aw,av,ay)}function O(at,ax,av,au,aw){var ay=V.extend({},aw,{multiple:av==="com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker",formatResult:function(az){return t.templates.fields.userOptionSelect({name:az.id,displayName:az.text,isSystemOption:!!az.isSystemOption})}});am(at,ax,av,au,ay)}function j(at,aw,av,au){var ax={minimumInputLength:0,initSelection:al(aw,{id:-1,text:"\u81ea\u52a8",isSystemOption:true}),query:function(az){function ay(aA){if(az.page===1){if(!az.element.prop("required")){aA.unshift({id:"",text:"\u672a\u5206\u914d",isSystemOption:true})}aA.unshift({id:-1,text:"\u81ea\u52a8",isSystemOption:true})}az.callback({results:aA})}if(az.term.length>0){q(aw,av,az.term,au).done(ay)}else{ay([])}},};O(at,aw,av,au,ax)}function m(at,aw,av,au){var ax=at.find("input");t.fields._labelPicker.build(ax,function(ay){return q(aw,av,ay,au)})}function q(ax,av,aw,au){var at=V.extend({restType:av,issueKey:(au&&au.key)||"",term:aw},ax);return V.ajax({type:"POST",timeout:0,contentType:"application/json",dataType:"json",url:AJS.contextPath()+"/rest/jira-integration/latest/fields/autocomplete",data:JSON.stringify(at)})}function ao(av,at,au){var aw={"data-aui-validation-field":"",pattern:"(([0-9]+w|[0-9]+d|[0-9]+m|[0-9]+h|[0-9]+)\\s*)*","data-aui-validation-pattern-msg":"\u8f93\u5165\u6709\u6548\u65f6\u95f4\u9884\u4f30\u503c\uff08\u4f8b\u5982 3 \u5468 4 \u5929 12 \u5c0f\u65f6\uff09"};av.value=(av.value&&av.value.remainingEstimate)||(au&&au.fields[name]&&au.fields[name].remainingEstimate)||"";return V.extend(true,{},av,{extraAttributes:aw})}function h(at){return{remainingEstimate:at.val()}}function U(ax,at,au){var aw=ax.name;var ay=(ax.value&&ax.value.id)||(at&&at.defaultValue&&at.defaultValue.id)||"";var av=(ax.value&&ax.value.name)||(au&&au.fields&&au.fields[aw]&&au.fields[aw].name)||(at&&at.defaultValue&&at.defaultValue.id)||"";delete ax.value;ax.options=aq.map(at.allowedValues,function(az){return{value:az.id,text:az.name,selected:av===az.name||ay===az.id,iconUrl:az.iconUrl}});return ax}function K(au){var at;if(au.id){at=V(au.element).attr("data-icon-url")}return t.templates.fields.select2WithIconOption({optionValue:au.text,iconUrl:at})}function b(ax,aw,au,at){if(!V.fn.auiSelect2){AJS.log("AUI version 5.2 or greater is required as this plugin needs the .auiSelect2() jQuery plugin.");return}var av=ax.find("select");av.addClass("jira-select2-drop-box");av.auiSelect2({hasAvatar:true,minimumResultsForSearch:-1,formatSelection:K,formatResult:K})}function Z(at,ax,av,au){var aw={minimumInputLength:0,formatResult:function(ay){return t.templates.fields.sprintSelect({name:ay.text,state:ay.state,board:ay.board})},query:function(ay){q(ax,av,ay.term,au).done(function(aB){var aA=aq.groupBy(aB,function(aC){return aC.suggestion?"suggestions":"all"});var az=["suggestions","all"].filter(function(aC){return aA[aC]&&aA[aC].length>0}).map(function(aC){return{text:aC==="suggestions"?"\u5efa\u8bae":"\u5168\u90e8\u51b2\u523a",children:aA[aC]}});ay.callback({results:aq.compact(az)})})},initSelection:al(ax,{id:-1,text:"\u9009\u62e9\u4e00\u4e2a\u51b2\u523a"}),};return am(at,ax,av,au,aw)}function ag(at,ax,av,au){var aw={minimumInputLength:0,formatResult:function(ay){return t.templates.fields.epicSelect({name:ay.text,key:ay.id})},query:function(ay){q(ax,av,ay.term,au).done(function(aA){var az=aq.uniq(aA.map(function(aB){return aB.list})).map(function(aB){return{text:aB,children:aA.filter(function(aC){return aC.list===aB})}});ay.callback({results:az})})},initSelection:al(ax,{id:-1,text:"\u9009\u62e9\u4e00\u4e2a\u957f\u7bc7\u6545\u4e8b"}),};return am(at,ax,av,au,aw)}function aa(at){var au=N(at);return au&&au!==""?au:undefined}function y(at){var au=at.auiSelect2("data");return au&&au.id===-1?undefined:au}function s(au,at){if(aq.has(p,au)&&console&&console.warn){console.warn("Redefining handler for type "+au+".")}p[au]=at}function R(at){return at.schema?(at.schema.system||at.schema.custom||at.schema.customId):at}function ak(at){return p[R(at)]}function G(at){var au=g(at);return au&&ak(au)}function g(at){return at.closest(".jira-field").attr("data-jira-type")}function T(au,at){return V.ajax({type:"GET",timeout:0,url:AJS.contextPath()+"/rest/jira-integration/1.0/servers/"+au.serverId+"/projects/"+au.projectKey+"/issue-types/"+au.issueType+"/fields-meta"}).pipe(function(aw){var av=[];aq.each(aw.fields,function(ay){var ax=R(ay);if(ay.required&&!aq.contains(at.excludedFields,ax)){av.push(ay)}});return av})}function C(at){return/\d/.test(at)&&/^-?\d*\.?\d*$/.test(at)}function a(au,av,at){var ax=g(au);var aw=ax&&ak(ax);var ay=aw&&aw.behavior;if(ay){ay(au,av,ax,at)}}function ad(at){var au=G(at);return au&&au.getValue&&au.getValue(at)}function al(au,at){return function(av,ax){var aw=au[av.attr("id")];ax(aw||at)}}return{addFieldHandler:s,getFieldHandler:ak,getFieldType:R,isKnownRestType:function(at){return p.hasOwnProperty(at)},canRender:function(at){var av=R(at);var au=p[av];if(!au){return false}return at.operations&&at.operations.length&&(!au.canRender||au.canRender(at))},getContext:function(au,at,av,aw){return A(au,at,av||{},aw||{})},renderField:function(au,at,av,ax){var aw=A(au,at,av||{},ax||{});return aw.handler.template(aw)},getInternalJSON:function(at){var au=G(at);return au&&au.getInternalValue&&au.getInternalValue(at)||ad(at)},getJSON:ad,attachFieldBehavior:a,attachFieldBehaviors:function(av,au,at){av.find(".jira-field").each(function(ay,ax){var aw=V(ax);a(aw,au,at)})},setFieldError:function(au,aw){var at=au.find(".error");at.remove();if(!aw){return}var av=t.templates.fields.errors({errorTexts:aw});au.append(av)},renderCreateRequiredFields:function(ax,aw,av,au,at){au=aq.extend({},F,au);function ay(az){if(au.ignoreFieldsWithDefaultValue){az=aq.filter(az,function(aB){return !aB.hasDefaultValue})}var aA=aq.filter(az,function(aB){return !t.fields.canRender(aB)});if(aA.length){if(at){at(aA)}return}ax.html(aq.map(az,function(aB){return t.fields.renderField(null,aB,null,null)}).join(""));t.fields.attachFieldBehaviors(ax,{serverId:av.serverId,projectKey:av.projectKey},null)}if(au.requiredFields){ay(au.requiredFields)}else{T(av,au).done(ay)}}}}(AJS.$,window._));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:fields', location = '/fields/label-picker.js' */
var jiraIntegration=window.jiraIntegration||{};jiraIntegration.fields=jiraIntegration.fields||{};jiraIntegration.fields._labelPicker=function(a){var b=function(d,c){d.auiSelect2({tags:true,multiple:true,tokenSeparators:[","," "],createSearchChoice:function(e){if(!e){return null}return{id:e,text:e,isNew:true}},query:function(f){var e=function(g){f.callback({results:g})};c(f.term).done(e)},formatResult:function(e){return jiraIntegration.templates.fields.labelFieldResult({label:{labelName:e.text,isNew:e.isNew}})},initSelection:function(e,g){var f=d.auiSelect2("val").map(function(h){return{id:h,text:h,}});g(f)}})};return{build:b}}(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.e8173e0382', location = 'aui.chunk.3d91536d339557e0c62c--06bb442d31b31326ccd2.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.e8173e0382"],{"3vMk":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),i("rSV2"),i("YQ7q"),i("6fSn"),i("Nu/Z"),i("98E3"),i("U8Ze")},"98E3":function(t,n,i){},U8Ze:function(t,n,i){"use strict";var o=c(i("+x/D")),e=i("XphB"),a=function(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n.default=t,n}(i("JFi+")),u=c(i("TmQU")),r=c(i("+ay7")),f=c(i("4dFR"));function c(t){return t&&t.__esModule?t:{default:t}}i("tYoR");var l="_aui-form-notification-initialised",s="aui-icon-notification",d="aui-form-notification-tooltip-error",p="aui-form-notification-tooltip-info",v="data-aui-notification-wait",m="data-aui-notification-info",h="data-aui-notification-error",y="aui-form-notification-position",g=[h,"data-aui-notification-success",v,m],w=[],b=1,_=9,E=3;function T(t){k(t)||(!function(t){t.addClass(l),function(t){var n=(0,o.default)('<span class="aui-icon aui-icon-small '+s+'"/>');t.after(n)}(t)}(t),function(t){N(t).tooltip({gravity:function(t){var n=t.data(y)||"side",i=K[n];i||(i="w",a.warn("Invalid notification position: '"+n+'\'. Valid options are "side", "bottom, "top"'));return i}(t),title:function(){return O(t)},trigger:"manual",offset:function(t){return-1!==x.indexOf(t.attr("type"))}(t)?_:E,opacity:b,className:function(){return"aui-form-notification-tooltip "+function(t){var n=B(t);if(n===h)return d;if(n===m)return p}(t)},html:!0})}(t),function(t){C(t)&&function(t){t.on("keydown",function(n){if(j(n)&&function(t){return""!==O(t)}(t)){var i=A(t);i.length&&(i.focus(),n.preventDefault())}})}(t)}(t),S(t)),w.push(t)}function k(t){return t.hasClass(l)}var x=["text","url","email","tel","password"];function O(t){var n=B(t);return function(t){if(""===t)return t;var n=function(t){var n;try{n=JSON.parse(t)}catch(i){n=[t]}return n}(t);return 1===n.length?n[0]:"<ul><li>"+n.join("</li><li>")+"</li></ul>"}(n?t.attr(n):"")}function B(t){var n;return g.some(function(i){if(t.is("["+i+"]"))return n=i,!0}),n}function C(t){return t.is(":aui-focusable")}function J(t){N(t).tooltip("show"),C(t)&&function(t){D(t).on("keydown",function(n){var i=R(function(t){return D(t).find(":aui-tabbable").last()}(t)),o=R(A(t));j(n)&&i&&i&&t.focus(),function(t){return t.keyCode===r.default.TAB&&t.shiftKey}(n)&&o&&o&&(t.focus(),n.preventDefault())})}(t)}function M(t){N(t).tooltip("hide")}function U(t,n){return(0,o.default)(t.target).closest(n).length>0}function j(t){return t.keyCode===r.default.TAB&&!t.shiftKey&&!t.altKey}function A(t){return D(t).find(":aui-tabbable").first()}function D(t){return(0,e.maybeTooltip)(N(t))}document.addEventListener("focus",function(t){w.forEach(function(n){var i=(0,o.default)(n);if(C(i)){var e=i.is(t.target),a=U(t,i);if(e||a)J(i);else{var u=D(i).get(0);u&&!o.default.contains(u,t.target)&&M(i)}}})},!0);var K={side:"w",top:"se",bottom:"ne"};function N(t){return function(t){return t.next("."+s)}(t)}function R(t){var n=t instanceof o.default?t[0]:t;return n&&n===document.activeElement}function S(t){var n=(0,o.default)(t);if(k(n)){var i=B(n);if(function(t,n){n&&!function(t){return t.next("aui-spinner").length>0}(t)?t.after('<aui-spinner class="form-notification-spinner" size="small"></aui-spinner>'):t.parent().find("aui-spinner").remove()}(n,i===v),!i)M(n);else{var e=O(n);(o.default.contains(n[0],document.activeElement)||R(n)||!C(n))&&e?J(n):M(n)}}}document.addEventListener("mousedown",function(t){(0,o.default)(t.target).is("a")||((0,o.default)(t.target).closest(".aui-form-notification-tooltip").length>0||(0,o.default)("[data-aui-notification-field]").each(function(){var n=(0,o.default)(this),i=n.is(t.target),e=U(t,n);i||e||M(n),C(n)&&M(n)}))}),(0,f.default)("data-aui-notification-field",{attached:function(t){T((0,o.default)(t))},attributes:function(){var t={};return g.forEach(function(n){t[n]=S}),t}(),type:f.default.type.ATTRIBUTE}),(0,u.default)("aui/form-notification")}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.component.form-validation', location = 'aui.chunk.65ac9ff2e18790f6c525--e4c234a7491fa4bca45a.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.component.form-validation"],{"0+Cw":function(a,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=u(t("+x/D")),n=function(a){if(a&&a.__esModule)return a;var e={};if(null!=a)for(var t in a)Object.prototype.hasOwnProperty.call(a,t)&&(e[t]=a[t]);return e.default=a,e}(t("JFi+"));function u(a){return a&&a.__esModule?a:{default:a}}var r=["displayfield","watchfield","when","novalidate","state"],l=[];var d={register:function(a,e){var t;if("string"==typeof a)t=a;else{var u=function(a){var e=!1;return a.some(function(a){var t=-1!==i.default.inArray(a,r);return t&&(e=a),t}),e}(a);if(u)return n.warn('Validators cannot be registered with the argument "'+u+'", as it is a reserved argument.'),!1;t="[data-aui-validation-"+a.join("],[data-aui-validation-")+"]"}var d={validatorFunction:e,validatorTrigger:t};return l.push(d),d},validators:function(){return l}};(0,u(t("TmQU")).default)("aui/form-validation/validator-register",d),e.default=d,a.exports=e.default},"6rRy":function(a,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=f(t("+x/D"));t("U8Ze"),t("Ikcz");var n=f(t("TmQU")),u=function(a){if(a&&a.__esModule)return a;var e={};if(null!=a)for(var t in a)Object.prototype.hasOwnProperty.call(a,t)&&(e[t]=a[t]);return e.default=a,e}(t("bPPT")),r=f(t("KloK")),l=f(t("4dFR")),d=f(t("0+Cw"));function f(a){return a&&a.__esModule?a:{default:a}}var o="aui-validation-",c="data-aui-notification-",s="aui-validation-state",v="invalid",g="valid",m="validating",h="unvalidated",p="_aui-form-validation-initialised",k="_aui-internal-field-state-changed";function x(a){(function(a){return a.hasClass(p)})(a)||(!function(a){M(a).attr("data-aui-notification-field","")}(a),function(a){a.addClass(p)}(a),function(a){(function(a){var e,t=function(){a.trigger("aui-stop-typing")};a.on("keyup",function(){clearTimeout(e),e=setTimeout(t,1500)})})(a),function(a){var e=y(a,"when"),t=y(a,"watchfield");(t?a.add("#"+t):a).on(e,function(){b(a)})}(a)}(a),w(a,h))}function b(a){if(!y(a,"novalidate"))return function(a){!function(a){_(M(a),"none")}(a);var e=function(a){var e=[];return T().forEach(function(t,i){var n=t.validatorTrigger;a.is(n)&&e.push(i)}),e}(a);w(a,m);var t=function(a,e){var t=[];return e.forEach(function(e){var n=T()[e].validatorFunction,r=new i.default.Deferred;n(function(a,e){var t={validate:function(){e.resolve()},invalidate:function(t){w(a,v,t),e.reject()},args:function(a){return function(e){return a.attr("data-"+o+e)||a.attr(e)}}(a),el:a[0],$el:a};return u.prop(t,"$el",{sinceVersion:"5.9.0",removeInVersion:"9.0.0",alternativeName:"el",extraInfo:"See https://ecosystem.atlassian.net/browse/AUI-3263."}),t}(a,r)),t.push(r)}),t}(a,e),n=i.default.when.apply(i.default,t);return n.done(function(){w(a,g)}),n}(a);w(a,g)}function y(a,e){var t=a.attr("data-"+o+e);return t||(t={when:"change"}[e]),t}function T(){return d.default.validators()}function w(a,e,t){if(a.attr("data-"+s,e),e!==h){a.trigger(i.default.Event(k));var n=M(a),u={};u[m]="wait",u[v]="error",u[g]="success";var r=u[e];e===m?function(a){setTimeout(function(){var e=D(a)===m;e&&_(a,"wait")},500)}(a):_(n,r,t)}}function _(a,e,t){var i=function(a){return a.is("["+c+"wait]")}(a);if(function(a){O(a,"wait"),O(a,"success")}(a),!("success"===e&&!i))if("none"===e)O(a,"error");else{var n=a.attr(c+e)||"[]",u=t?function(a,e){var t=JSON.parse(e).concat([a]);return JSON.stringify(t)}(t,n):"";a.attr(c+e,u)}}function O(a,e){a.removeAttr(c+e)}function M(a){var e=y(a,"displayfield");return void 0===e?a:(0,i.default)("#"+e)}function D(a){return a.attr("data-"+s)}function I(a,e){e.preventDefault(),a.one(k,function(){a.trigger("submit")})}function A(a,e){var t="[data-"+s+"="+e+"]";return a.find(t)}(0,i.default)(document).on("submit",function(a){var e=a.target,t=(0,i.default)(e),n=function(a){return function(a){var e=-1!==a.indexOf(v),t=-1!==a.indexOf(h),i=-1!==a.indexOf(m);return e?v:t?h:i?m:g}(function(a){return i.default.map(a,function(a){return D((0,i.default)(a))})}(a.find("."+p)))}(t);if(n===h)I(t,a),function(a){A(a,h).each(function(a,e){E.validate((0,i.default)(e))})}(t);else if(n===m)I(t,a);else if(n===v)a.preventDefault(),function(a){A(a,v).first().focus()}(t);else if(n===g){var u=i.default.Event("aui-valid-submit");t.trigger(u),u.isDefaultPrevented()&&a.preventDefault()}});var E={register:d.default.register,validate:function(a){b(a=(0,i.default)(a))}};(0,l.default)("data-aui-validation-field",{attached:function(a){a.form&&a.form.setAttribute("novalidate","novalidate"),x((0,i.default)(a)),l.default.init(a)},type:l.default.type.ATTRIBUTE}),(0,n.default)("aui/form-validation",E),(0,r.default)("formValidation",E),e.default=E,a.exports=e.default},Ikcz:function(a,e,t){"use strict";var i=l(t("+x/D")),n=l(t("TmQU")),u=(l(t("uDDF")),l(t("HH5i"))),r=l(t("0+Cw"));function l(a){return a&&a.__esModule?a:{default:a}}function d(a){var e=a.el.value.length,t=0===e,i=parseInt(a.args("minlength"),10),n=parseInt(a.args("maxlength"),10);if(i&&n&&i===n&&!t&&e!==i){var u=g("exactlength",a.args,[i]);a.invalidate(u)}else if(i&&e<i&&!t){var r=g("minlength",a.args);a.invalidate(r)}else if(n&&e>n){var l=g("maxlength",a.args);a.invalidate(l)}else a.validate()}function f(a){return"password"===a.getAttribute("type")}function o(a,e){var t=a.match(e);return!!t&&a===t[0]}function c(a){var e=g("pattern",a.args);o(a.el.value,new RegExp(a.args("pattern")))?a.validate():a.invalidate(e)}function s(a){var e=g("required",a.args);a.el.value?a.validate():a.invalidate(e)}function v(a){var e=g("validnumber",a.args),t=parseInt(a.el.value,10);if(isNaN(t))a.invalidate(e);else{var i=a.args("min"),n=a.args("max");i&&t<parseInt(i,10)?a.invalidate(g("min",a.args)):n&&t>parseInt(n,10)?a.invalidate(g("max",a.args)):a.validate()}}function g(a,e,t){var i;i=void 0!==u.default.keys?u.default.keys["aui.validation.message."+a]:m[a];var n=t;t||(n=[e(a)]);var r,l=e(a+"-msg");return r=l?[l].concat(n):[i].concat(n),AJS.format.apply(null,r)}r.default.register(["maxlength","minlength"],d),r.default.register("[maxlength],[minlength]",d),r.default.register(["matchingfield"],function(a){var e=a.el.value,t=document.getElementById(a.args("matchingfield")),i=t.value,n=g("matchingfield",a.args,[e,i]);(f(a.el)||f(t))&&(n=g("matchingfield-novalue",a.args)),e&&i&&i!==e?a.invalidate(n):a.validate()}),r.default.register(["doesnotcontain"],function(a){var e=g("doesnotcontain",a.args);-1===a.el.value.indexOf(a.args("doesnotcontain"))?a.validate():a.invalidate(e)}),r.default.register(["pattern"],c),r.default.register("[pattern]",c),r.default.register(["required"],s),r.default.register("[required]",s),r.default.register(["min","max"],v),r.default.register("[min],[max]",v),r.default.register(["dateformat"],function(a){var e=a.args("dateformat"),t=g("dateformat",a.args),i={Y:"[0-9]{4}",y:"[0-9]{2}",m:"(0?[1-9]|10|11|12)",M:"[Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec]",D:"[Mon|Tue|Wed|Thu|Fri|Sat|Sun]",d:"([0-2]?[1-9]|10|20|30|31)"},n="";e.split("").forEach(function(a){var e=i.hasOwnProperty(a);n+=e?i[a]:a});var u=new RegExp(n+"$","i");o(a.el.value,u)?a.validate():a.invalidate(t)}),r.default.register(["minchecked","maxchecked"],function(a){var e=(0,i.default)(a.el).find(":checked").length,t=!a.args("minchecked")||e>=a.args("minchecked"),n=!a.args("maxchecked")||e<=a.args("maxchecked"),u=g("minchecked",a.args),r=g("maxchecked",a.args);t&&n?a.validate():t?n||a.invalidate(r):a.invalidate(u)});var m={minlength:u.default.getText("aui.validation.message.minlength"),maxlength:u.default.getText("aui.validation.message.maxlength"),exactlength:u.default.getText("aui.validation.message.exactlength"),matchingfield:u.default.getText("aui.validation.message.matchingfield"),"matchingfield-novalue":u.default.getText("aui.validation.message.matchingfield-novalue"),doesnotcontain:u.default.getText("aui.validation.message.doesnotcontain"),pattern:u.default.getText("aui.validation.message.pattern"),required:u.default.getText("aui.validation.message.required"),validnumber:u.default.getText("aui.validation.message.validnumber"),min:u.default.getText("aui.validation.message.min"),max:u.default.getText("aui.validation.message.max"),dateformat:u.default.getText("aui.validation.message.dateformat"),minchecked:u.default.getText("aui.validation.message.minchecked"),maxchecked:u.default.getText("aui.validation.message.maxchecked")};(0,n.default)("aui/form-validation/basic-validators")},defA:function(a,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),t("3vMk"),t("6rRy")}},[["defA","runtime","aui.splitchunk.vendors--e54c7c7304","aui.splitchunk.vendors--b47d4b691d","aui.splitchunk.vendors--9c48cc20a9","aui.splitchunk.vendors--be1eb78c1a","aui.splitchunk.vendors--23f50a6f00","aui.splitchunk.172ffb6da7","aui.splitchunk.b0831cc7d0","aui.splitchunk.572a8bf5cd","aui.splitchunk.087aba7911","aui.splitchunk.fbd1a5ab27","aui.splitchunk.d49cf794d2","aui.splitchunk.54d3f16c20","aui.splitchunk.e54c7c7304","aui.splitchunk.336ae4f9e7","aui.splitchunk.1659111a3c","aui.splitchunk.f5828f5ab9","aui.splitchunk.fb15cffa72","aui.splitchunk.56dfb54d0c","aui.splitchunk.f673ef53ac","aui.splitchunk.9c48cc20a9","aui.splitchunk.908fe798b4","aui.splitchunk.792781e698","aui.splitchunk.462ee5f9ef","aui.splitchunk.382c9b559f","aui.splitchunk.ed86a19e01","aui.splitchunk.50dca3e042","aui.splitchunk.be1eb78c1a","aui.splitchunk.23f50a6f00","aui.splitchunk.e8173e0382"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form.js' */
window.jiraIntegration=window.jiraIntegration||{};window.jiraIntegration.JiraCreateIssueForm=(function(d,a){b.defaults={allowUnsupportedFields:false,ignoreFieldsWithDefaultValue:true,excludedField:["project","issuetype","reporter"],formClass:"jira-interation-create-issue-form",requiredFieldsOnly:true,renderSummaryAndDescription:false,get$unsupportedFieldMessage:function(f,g){return d(jiraIntegration.templates.jiraCreateIssueForm.unsupportedFieldsMessage({unsupportedFields:f,createIssueUrl:g}))},get$unexpectedError:function(f){return d(aui.message.error({content:AJS.escapeHtml(f)}))},get$communicationError:function(f){return d(jiraIntegration.templates.jiraCreateIssueForm.communicationErrorMessage({message:f}))},get$unauthorizeMessage:function(f){return d(jiraIntegration.templates.jiraCreateIssueForm.authorize({extraClasses:"jira-oauth-dialog",applicationName:f}))},get$unsupportedServerMessage:function(f){return d(jiraIntegration.templates.jiraCreateIssueForm.unsupportedServerMessage({serverUrl:f}))},get$unrenderableRequiredFieldsMessage:function(g,f){var h=g.map(function(i){return AJS.escapeHtml(i.name)}).join(", ");return d(jiraIntegration.templates.jiraCreateIssueForm.unrenderableRequiredFieldsMessage({names:h,count:g.length,serverUrl:f}))},ajax:function(f){alert("JiraCreateIssueForm requires the option 'ajax(options)' to be specified and respond like jQuery.ajax.\nThis method should handle response status codes other than 200 and 500 (those are handled by us).")}};function b(f){this.configuration=a.extend({},b.defaults,f);if(this.configuration.renderSummaryAndDescription){this.configuration.excludedField.push("summary","description")}this._init()}b.prototype._trigger=function(f,g){var h=this.configuration[f];if(h){h.apply(this,Array.prototype.slice.call(arguments,1))}};b.prototype._selectServer=function(f,h){var g=this;if(this.currentServerId===f&&!h){return}this.currentServerId=f;this.formIsLoading(this.defaultFields.server);jiraIntegration.JiraCreateIssueForm.Data.isIssueCreationSupported(f,this.configuration.ajax).done(function(i){if(i){g._loadProjectData(f);g.formLoadingCompleted(g.defaultFields.server)}else{var j=jiraIntegration.JiraCreateIssueForm.Data.getServerById(f).displayUrl;g._handleUnsupportedServer(j)}}).fail(function(i){if(i[0]&&i[0].authenticationUri){g._handleAuthorizeError(i[0])}else{g._handleAjaxError(i)}})};b.prototype._bindEventListener=function(){var f=this;this.defaultFields.server.on("change",function(h){f.fieldValues=a.extend({},f.fieldValues,f._getFieldValues());f.resetForm(true);var g=this.value;if(g){f._selectServer(g)}else{jiraIntegration.JiraCreateIssueForm.FieldHelper.resetSelectField(f.defaultFields.project);f.defaultFields.project.trigger("change")}f._trigger("onServerChanged",this.value)});this.defaultFields.project.on("change",function(){var h=this.value||d(this).select2("data").value;var g=d(f.defaultFields.issueType).select2("data");f.fieldValues=a.extend({},f.fieldValues,f._getFieldValues());if(h){d('option[value=""]',f.defaultFields.project).remove();f._loadIssueType(f.currentServerId,h,g)}else{jiraIntegration.JiraCreateIssueForm.FieldHelper.resetSelectField(f.defaultFields.issueType)}f.defaultFields.issueType.trigger("change");f._trigger("onProjectChanged",this.value)});this.defaultFields.issueType.on("change",function(){f.fieldValues=a.extend({},f.fieldValues,f._getFieldValues());f.resetForm(true);if(this.value){f._loadFields(f.fieldValues)}else{f.$containerRequireField&&f.$containerRequireField.html("");c(this.$form)}f._trigger("onTypeChanged",this.value)})};b.prototype._getFieldValues=function(){return this._getJSON({getFieldJSON:jiraIntegration.fields.getInternalJSON,$form:this.$form,})};b.prototype._init=function(){this.container=d(this.configuration.container);this.fieldValues={};if(this.container.length){this._renderForm();this._bindEventListener();this._loadServerData()}else{throw new Error("container property should be defined.")}};b.prototype._renderForm=function(){var f=this;this.$form=d(jiraIntegration.templates.jiraCreateIssueForm.form({formClass:this.configuration.formClass})).on("aui-valid-submit",function(g){if(f.configuration.onSubmit){g.preventDefault();f.configuration.onSubmit()}}).on("focus",".fake-tabbable",function(){const g=this.parentElement.children[1].getElementsByTagName("input")[0];d(g).focus()});if(this.configuration.renderSummaryAndDescription){this._renderSummaryAndDescription()}this.container.append(this.$form);this.defaultFields=this._getDefaultFields();a.each(this.defaultFields,a.bind(function(g){this.createSelect2WithIcon(d(g))},this));this.$containerRequireField=d(".create-issue-required-fields",this.container);this._trigger("onFormRendered")};b.prototype._renderSummaryAndDescription=function(){var f=d(".create-issue-default-fields",this.$form);f.append(aui.form.textField({labelContent:"\u6458\u8981",isRequired:true,name:"summary",value:this._getSummaryFromConfiguration()}));f.append(aui.form.textareaField({labelContent:"\u63cf\u8ff0",name:"description"}))};b.prototype._getDefaultFields=function(){return{server:d(".server-select",this.$form),project:d(".project-select",this.$form),issueType:d(".issuetype-select",this.$form)}};b.prototype._loadServerData=function(){var f=this;this.formIsLoading(this.defaultFields.server);jiraIntegration.JiraCreateIssueForm.Data.loadServers(f.configuration.ajax).then(function(g){f.formLoadingCompleted(f.defaultFields.server);f._loadServerDataComplete(g)})};b.prototype._loadFields=function(g){var h=this;var f=a.extend({},this.getContextJSON(),g);this.formIsLoading(this.defaultFields.issueType);var i=jiraIntegration.JiraCreateIssueForm.Data.getFieldMetadata(f,h.configuration.ajax);i.done(function(n){var j=h._filterFields(n.fields);if(h.configuration.renderSummaryAndDescription){var k=n.fields.description;var m=!!(k&&k.required);h._setDescriptionAsRequiredField(m)}var l=h._unrenderableRequiredFields(j);if(l.length===0){h._renderFields(j,f);h._trigger("onFieldsRendered")}else{h._handleUnrenderableRequiredFields(l)}h._fieldTypeAnalytics(j);h.formLoadingCompleted(h.defaultFields.issueType)}).fail(a.bind(h._handleAjaxError,this))};b.prototype._loadServerDataComplete=function(f){if(f.length){if(f.length===1){jiraIntegration.JiraCreateIssueForm.FieldHelper.hideField(this.defaultFields.server)}this._hasMultiServer=f.length>1;jiraIntegration.JiraCreateIssueForm.FieldHelper.fillSelectData(this.defaultFields.server,f,this.configuration.serverId||f[0].id);this._selectServer(this.configuration.serverId||f[0].id)}else{this._handlerUnexpectedError("\u6ca1\u6709 Jira \u670d\u52a1\u5668, \u8bf7\u68c0\u67e5\u5e94\u7528\u94fe\u63a5\u914d\u7f6e\u3002")}};b.prototype._loadProjectData=function(f){var g=this;this.formIsLoading(this.defaultFields.project);var h=jiraIntegration.JiraCreateIssueForm.Data.loadProjects(f,g.configuration.ajax);h.then(function(i){if(i.errors&&i.errors.length){var j=i.errors[0];if(j.authenticationUri){g._handleAuthorizeError(j)}else{g._handlerUnexpectedError(j.message)}}else{if(i.length){jiraIntegration.JiraCreateIssueForm.FieldHelper.fillSelectData(g.defaultFields.project,i,g.configuration.projectId)}else{g._handlerUnexpectedError("\u60a8\u6ca1\u6709\u5728\u6b64 Jira \u670d\u52a1\u5668\u4e0a\u521b\u5efa\u95ee\u9898\u7684\u6743\u9650\u3002")}}g.formLoadingCompleted(g.defaultFields.project)},a.bind(g._handleAjaxError,this))};b.prototype._loadIssueType=function(g,f,h){var i=jiraIntegration.JiraCreateIssueForm.Data.getIssueTypes(g,f,this.configuration.ajax);jiraIntegration.JiraCreateIssueForm.FieldHelper.fillSelectData(this.defaultFields.issueType,i,h&&h.id)};b.prototype._fieldTypeAnalytics=function(f){var h=f.map(function(j){var i=jiraIntegration.fields.getFieldType(j);return{required:j.required,restType:i,knownRestType:jiraIntegration.fields.isKnownRestType(i),}});var g=h.reduce(function(i,j){if(j.knownRestType){i[j.required?"requiredFields":"otherFields"].push(j.restType)}else{i[j.required?"unknownRequiredFieldsCount":"unknownOtherFieldsCount"]++}return i},{requiredFields:[],otherFields:[],unknownRequiredFieldsCount:0,unknownOtherFieldsCount:0});g=Object.keys(g).reduce(function(k,m){var n=g[m];if(!Array.isArray(n)){k[m]=n;return k}var j=n.length;k[m+".size"]=j;for(var l=0;l<j;l++){k[m+"["+l+"]"]=n[l]}return k},{});AJS.trigger("analytics",{name:"jira.integration.issue.create.form.displayed",data:g,})};b.prototype._renderFields=function(f,g){this.$containerRequireField.html("");var h=a.reject(f,jiraIntegration.fields.canRender);if(!this.configuration.allowUnsupportedFields&&h.length){this._handleUnsupportedFields(h)}else{this.$containerRequireField.html(a.map(f,function(i){return jiraIntegration.fields.renderField(null,i,g,null)}).join(""));jiraIntegration.fields.attachFieldBehaviors(this.$containerRequireField,g,null);this._trigger("onRequiredFieldsRendered",f,h)}};b.prototype._setError=function(f){c(this.$form);this.$form.prepend(f);this.formLoadingCompleted();this.formHasError()};b.prototype._handleCommunicationError=function(g){var f=this.configuration.get$communicationError(g);this._setError(f)};b.prototype._handlerUnexpectedError=function(g){var f=this.configuration.get$unexpectedError(g);this._setError(f)};b.prototype._handleUnsupportedFields=function(f){f=a.map(f,function(h){return AJS.escapeHtml(h.name)});var g=this.configuration.get$unsupportedFieldMessage(f,this._getCreateJiraIssueUrl());c(this.$form);this.$form.prepend(g);this._trigger("onError");this.formLoadingCompleted()};b.prototype._handleUnsupportedServer=function(f){var g=this.configuration.get$unsupportedServerMessage(f);this._setError(g)};b.prototype._handleAjaxError=function(i){var h=this;if(i.status>=500&&i.status<600){var f=(i.responseJSON.errors&&i.responseJSON.errors[0]);var g=f&&f.exceptionName;if(g&&g==="com.atlassian.integration.jira.JiraCommunicationException"){this._handleCommunicationError(f.message)}else{h._handlerUnexpectedError(AJS.format("\u65e0\u6cd5\u4e0e Jira \u8fdb\u884c\u901a\u4fe1\uff08HTTP \u9519\u8bef {0}\uff09",i.status))}}else{h._handlerUnexpectedError("\u4ece Jira \u63a5\u6536\u5230\u610f\u5916\u54cd\u5e94\u3002")}h.formHasError()};b.prototype._handleAuthorizeError=function(h){var g=this;this.formHasError();var f=this.configuration.get$unauthorizeMessage(h.applicationName);this.$form.append(f);d(".applink-authenticate",f).on("click",function(i){AppLinks.authenticateRemoteCredentials(h.authenticationUri,function(){g.resetForm();g._selectServer(g.currentServerId,true)},function(){g._handlerUnexpectedError(AJS.format("\u4f60\u5df2\u7ecf\u88ab\u62d2\u7edd\u5141\u8bb8\u8bbf\u95ee{0}\u3002",h.applicationName))});i.preventDefault()})};b.prototype._handleUnrenderableRequiredFields=function(f){var g=this.configuration.get$unrenderableRequiredFieldsMessage(f,this._getCreateJiraIssueUrl());c(this.$form);this.$form.append(g);this.formLoadingCompleted()};b.prototype._getCreateJiraIssueUrl=function(){var h=this.defaultFields.project.find("option:selected").val();var i=this.defaultFields.issueType.find("option:selected").val();var j=jiraIntegration.JiraCreateIssueForm.Data.getServerById(this.currentServerId).displayUrl;j=j+"/secure/CreateIssueDetails!Init.jspa?pid="+h+"&issuetype="+i;var g=this._getFieldValue("summary");if(g.length){j=j+"&summary="+encodeURIComponent(g)}var f=this._getFieldValue("description");if(f.length){j=j+"&description="+encodeURIComponent(f)}return j};b.prototype._filterFields=function(f){var g=this;return a.filter(f,function(j){var i=j.schema?(j.schema.system||j.schema.custom||j.schema.customId):j;var h=a.contains(g.configuration.excludedField,i)||(g.configuration.ignoreFieldsWithDefaultValue&&j.hasDefaultValue)||(g.configuration.requiredFieldsOnly&&!j.required);return !h})};b.prototype._unrenderableRequiredFields=function(f){return f.filter(function(g){return g.required&&!jiraIntegration.fields.canRender(g)})};b.prototype._getFieldValue=function(g){var f=d("[name='"+g+"']",this.$form);return(f)?d.trim(f.val()):""};b.prototype._setDescriptionAsRequiredField=function(f){var g=d('.field-group [name="description"]',this.$form).prev("label");g.find(".aui-icon.aui-icon-required").remove();if(f){g.append(aui.icons.icon({icon:"required"}))}};b.prototype._getSummaryFromConfiguration=function(){var f=this.configuration.initialSummary;delete this.configuration.initialSummary;return f};b.prototype._getJSON=function(f){if(!f.verbose){return e(f.$form,function(l,j,k){return f.getFieldJSON(l)})}var h=jiraIntegration.JiraCreateIssueForm.Data.getCachedFieldMetadataEntry(this.getContextJSON()).value;var g=Object.keys(h.fields).reduce(function(k,j){var i=h.fields[j];k[j]=jiraIntegration.fields.getContext(null,i,null,null);return k},{});return e(this.$form,function(m,j,l){var k=g[j];return{name:j,jiraType:k.jiraType,required:k.isRequired,label:k.labelText,value:f.getFieldJSON(m),index:l}})};b.prototype.resetForm=function(f){c(this.$form);d(".field-group",this.$form).show();if(this.configuration.renderSummaryAndDescription){this._setDescriptionAsRequiredField(false)}if(!this._hasMultiServer){jiraIntegration.JiraCreateIssueForm.FieldHelper.hideField(this.defaultFields.server)}this.$containerRequireField.html("");this.fieldValues=f?this.fieldValues:{}};b.prototype.formHasError=function(){d(".field-group",this.$form).hide();this.$containerRequireField.html("");if(this._hasMultiServer){jiraIntegration.JiraCreateIssueForm.FieldHelper.showField(this.defaultFields.server)}jiraIntegration.JiraCreateIssueForm.FieldHelper.setFieldDisabled(d(".insert-issue-button"),true);this._trigger("onError");this.formLoadingCompleted()};b.prototype.getCurrentServer=function(){return jiraIntegration.JiraCreateIssueForm.Data.getServerById(this.currentServerId)};b.prototype.formIsLoading=function(f){if(f){jiraIntegration.JiraCreateIssueForm.FieldHelper.setIsLoading(f,true)}var g=d(":input",d(this.$form));jiraIntegration.JiraCreateIssueForm.FieldHelper.setFieldDisabled(g,true)};b.prototype.formLoadingCompleted=function(f){if(f){jiraIntegration.JiraCreateIssueForm.FieldHelper.setIsLoading(f,false)}else{d(".aui-icon.aui-icon-wait",this.$form).remove()}var g=d(":input",d(this.$form));jiraIntegration.JiraCreateIssueForm.FieldHelper.setFieldDisabled(g,false)};b.prototype.createSelect2WithIcon=function(f){if(f.is(".server-select")){f.auiSelect2({minimumResultsForSearch:-1})}else{var g=f.is(".project-select")?{formatSelection:this.projectSelectFormat,formatResult:this.projectSelectFormat,extraAttributes:this.defaultFields}:{formatSelection:this.issueTypeSelectFormat,formatResult:this.issueTypeSelectFormat,minimumResultsForSearch:-1,extraAttributes:this.defaultFields};f.auiSelect2(g)}f.auiSelect2("val","")};b.prototype.projectSelectFormat=function(h){var g=this.extraAttributes.server.select2("data").id;var f=jiraIntegration.JiraCreateIssueForm.Data.getProjectIconUrl(g,h.id);return jiraIntegration.templates.fields.select2WithIconOption({optionValue:h.text,iconUrl:f,isProject:true})};b.prototype.issueTypeSelectFormat=function(i){var h=this.extraAttributes.server.select2("data").id;var f=this.extraAttributes.project.select2("data").id;var g=jiraIntegration.JiraCreateIssueForm.Data.getIssueTypeIconUrl(h,f,i.id);return jiraIntegration.templates.fields.select2WithIconOption({optionValue:i.text,iconUrl:g,isProject:false})};b.prototype.getContextJSON=function(){var f=this.defaultFields.project.val()||d(this.defaultFields.project).select2("data").value;return{serverId:this.currentServerId,projectId:f,projectKey:jiraIntegration.JiraCreateIssueForm.Data.getProjectById(this.currentServerId,f).key,issueTypeId:this.defaultFields.issueType.val(),summary:this._getSummaryFromConfiguration()}};b.prototype.getJSON=function(f){return b.prototype._getJSON({getFieldJSON:jiraIntegration.fields.getJSON,verbose:f,$form:this.$form,})};b.prototype.renderErrors=function(f){e(this.$form,function(g,j){var k=g.closest(".jira-field");var i=function(l){return l.indexOf(j)===0};var h;if(f.hasOwnProperty(j)||Object.keys(f).some(i)){if(!f.hasOwnProperty(j)){j=Object.keys(f).filter(i)[0]}h=Array.isArray(f[j])?f[j]:[f[j]]}jiraIntegration.fields.setFieldError(k,h)})};b.prototype.submit=function(){this.$form.submit()};function e(f,h){var g={};f.find(".create-issue-required-fields").find("input, select, textarea, fieldset").not(".select2-input, .select2-focusser").each(function(k){var l=d(this);var j=l.attr("data-name");if(j){g[j]=h(l,j,k)}});return g}function c(f){d(".aui-message",f).remove()}return b})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form-data.js' */
window.jiraIntegration=window.jiraIntegration||{};var jiraIntegration=window.jiraIntegration;jiraIntegration.JiraCreateIssueForm=jiraIntegration.JiraCreateIssueForm||{};jiraIntegration.JiraCreateIssueForm.Data=(function(d){var j={};var l={};var q=AJS.contextPath()+"/plugins/servlet/jira-integration/icons?serverId={0}&iconType={1}&{2}";var m=[];var p=function(s,t){return s({dataType:"json",timeout:0,url:AJS.contextPath()+"/rest/jira-integration/1.0/servers"+(t||"")})};function o(s){return p(s,"").done(function(t){t.forEach(function(u){j[u.id]=u})})}function i(s,u){var t=j[s]&&j[s].projects;if(t){return d.Deferred().resolve(t)}return p(u,"/"+s+"/projects").done(function(v){if(v.length){v.forEach(function(z){var y=z.issuetypes.filter(function(A){return !A.subtask});z.issueTypes=y;var w={};y.forEach(function(A){w[A.id]=A.iconUrl});var x=z.avatarUrls["16x16"].split("/secure/projectavatar?")[1];if(x.indexOf("pid=")===-1){x=x+"&pid="+z.id}m[e(s,z.id)]={iconUrl:AJS.format(q,s,"project",x),issueTypes:w}});j[s].projects=v}})}function r(t,s){var u=h(t).filter(function(v){return v.id===s})[0];return u?u.issueTypes:[]}function f(s,t){var u=b(s);if(u.value){return d.Deferred().resolve(u.value)}return p(t,"/"+s.serverId+"/projects/"+s.projectKey+"/issue-types/"+s.issueTypeId+"/fields-meta").done(function(v){l[u.key]=v})}function b(t){var s=e(t.serverId,t.projectKey,t.issueTypeId);return{key:s,value:l[s]}}function n(s){return j[s]}function g(s,t){if(!j[s]){throw new Error("Can only be called after server is loaded.")}if("issueCreationSupported" in j[s]){return d.Deferred().resolve(j[s].issueCreationSupported)}return p(t,"/"+s+"/features").then(function(u){if(u.errors){return d.Deferred().reject(u.errors)}else{if(!Array.isArray(u)){return d.Deferred().reject("Unexpected response from Jira")}}j[s].issueCreationSupported=u.indexOf("CREATE_ISSUE")!==-1;return j[s].issueCreationSupported})}function h(s){if(!j[s]){throw new Error("Can only be called after server is loaded.")}return j[s].projects}function k(u,t){var w=h(u);if(!w){return null}for(var v=0,s=w.length;v<s;v++){var x=w[v];if(x.id===t){return x}}return null}function a(t,s){var u=e(t,s);return m[u]?m[u].iconUrl:""}function c(u,t,v){var w=e(u,t);var s=m[w];return(s&&s.issueTypes[v])?s.issueTypes[v]:""}function e(t,s,u){return t+(s?"-"+s:"")+(u?"-"+u:"")}return{loadServers:o,loadProjects:i,getIssueTypes:r,getFieldMetadata:f,getCachedFieldMetadataEntry:b,getServerById:n,getProjectIconUrl:a,getIssueTypeIconUrl:c,getProjects:h,getProjectById:k,isIssueCreationSupported:g}})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form-field-helper.js' */
var jiraIntegration=window.jiraIntegration||{};jiraIntegration.JiraCreateIssueForm=jiraIntegration.JiraCreateIssueForm||{};jiraIntegration.JiraCreateIssueForm.FieldHelper=(function(b,h){function d(j,m,k){var n=[];var l;m.forEach(function(p){var o={value:AJS.escapeHtml(p.id),text:p.name,iconUrl:p.iconUrl?p.iconUrl:(p.avatarUrls?p.avatarUrls["16x16"]:"")};if(k===p.id){o.selected=true;l=p}n.push(aui.form.optionOrOptgroup(o))});if(l){l.text=l.name;j.html(n.join(""));j.auiSelect2("data",l).trigger("change")}else{n.unshift(e(j));j.html(n.join(""));j.auiSelect2("val","").trigger("change")}}function a(j){j.html(e(j));j.auiSelect2("val","").trigger("change")}function e(j){var k=j.attr("data-placeholder");return aui.form.optionOrOptgroup({value:"",text:k,iconUrl:""})}function i(j){j.parent().hide()}function c(j){j.parent().show()}function f(k,j){j?b.fn.disable?k.disable():k.prop("disabled",true):b.fn.enable?k.enable():k.prop("disabled",false)}function g(k,j){return j?k.after(aui.icons.icon({icon:"wait"})):k.next(".aui-icon.aui-icon-wait").remove()}return{fillSelectData:d,resetSelectField:a,hideField:i,showField:c,setFieldDisabled:f,setIsLoading:g}})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form.soy' */
// This file was automatically generated from jira-create-issue-form.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace jiraIntegration.templates.jiraCreateIssueForm.
 */

if (typeof jiraIntegration == 'undefined') { var jiraIntegration = {}; }
if (typeof jiraIntegration.templates == 'undefined') { jiraIntegration.templates = {}; }
if (typeof jiraIntegration.templates.jiraCreateIssueForm == 'undefined') { jiraIntegration.templates.jiraCreateIssueForm = {}; }


jiraIntegration.templates.jiraCreateIssueForm.form = function(opt_data, opt_ignored) {
  return '' + aui.form.form({extraClasses: (opt_data.formClass ? opt_data.formClass + ' ' : '') + 'jira-create-form', method: 'post', action: '#', content: '<fieldset class="create-issue-default-fields"><div class="fake-tabbable" tabindex="0" /><div class="field-group" data-jira-type="server"><label>' + soy.$$escapeHtml('\u670d\u52a1\u5668') + '<span class="aui-icon icon-required"> required</span></label><select class="jira-select2-drop-box server-select medium-long-field" name="server" data-placeholder="' + soy.$$escapeHtml('\u9009\u62e9\u4e00\u4e2a\u670d\u52a1\u5668') + '"><option disabled selected value="">' + soy.$$escapeHtml('\u9009\u62e9\u4e00\u4e2a\u670d\u52a1\u5668') + '</option></select></div><div class="field-group" data-jira-type="project"><label>' + soy.$$escapeHtml('\u9879\u76ee') + '<span class="aui-icon icon-required"> required</span></label><select class="jira-select2-drop-box project-select medium-long-field" name="project" data-placeholder="' + soy.$$escapeHtml('\u9009\u62e9\u4e00\u4e2a\u9879\u76ee') + '"><option disabled selected value="">' + soy.$$escapeHtml('\u9009\u62e9\u4e00\u4e2a\u9879\u76ee') + '</option></select></div><div class="field-group" data-jira-type="issuetype"><label>' + soy.$$escapeHtml('\u95ee\u9898\u7c7b\u578b') + '<span class="aui-icon icon-required"> required</span></label><select class="jira-select2-drop-box issuetype-select" name="issue-type" data-placeholder="' + soy.$$escapeHtml('\u9009\u62e9\u95ee\u9898\u7c7b\u578b') + '"><option disabled selected value="">' + soy.$$escapeHtml('\u9009\u62e9\u95ee\u9898\u7c7b\u578b') + '</option></select></div></fieldset><fieldset class="create-issue-required-fields"></fieldset>'});
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.form.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.form';
}


jiraIntegration.templates.jiraCreateIssueForm.unsupportedFieldsMessage = function(opt_data, opt_ignored) {
  var param28 = '';
  if (opt_data.unsupportedFields.length == 1) {
    var field__soy31 = '<strong>' + soy.$$escapeHtml(opt_data.unsupportedFields) + '</strong>';
    param28 += soy.$$filterNoAutoescape(AJS.format('\u5fc5\u586b\u5b57\u6bb5 {0} \u5728\u8fd9\u4e2a\u8868\u683c\u4e2d\u4e0d\u53ef\u7528\u3002\u60a8\u9700\u8981',field__soy31));
  } else {
    var fieldList__soy38 = '' + jiraIntegration.templates.jiraCreateIssueForm.buildFieldList({fields: opt_data.unsupportedFields});
    param28 += soy.$$filterNoAutoescape(AJS.format('\u5fc5\u586b\u5b57\u6bb5 {0} \u5728\u8fd9\u5f20\u8868\u683c\u4e2d\u4e0d\u53ef\u7528\u3002\u60a8\u9700\u8981',fieldList__soy38));
  }
  param28 += ' <a href="' + soy.$$escapeHtml(opt_data.createIssueUrl) + '" target="_blank">' + soy.$$escapeHtml('\u76f4\u63a5\u5728 Jira \u4e2d\u521b\u5efa\u4e8b\u52a1') + '</a>.';
  var output = '' + aui.message.warning({content: param28});
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.unsupportedFieldsMessage.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.unsupportedFieldsMessage';
}


jiraIntegration.templates.jiraCreateIssueForm.buildFieldList = function(opt_data, opt_ignored) {
  var output = '';
  var joinText__soy50 = '' + ((opt_data.fields.length == 2) ? ' ' + soy.$$escapeHtml('\u548c') + ' ' : ', ');
  var fieldList58 = opt_data.fields;
  var fieldListLen58 = fieldList58.length;
  for (var fieldIndex58 = 0; fieldIndex58 < fieldListLen58; fieldIndex58++) {
    var fieldData58 = fieldList58[fieldIndex58];
    output += ((! (fieldIndex58 == 0)) ? soy.$$escapeHtml(joinText__soy50) : '') + '<strong>' + soy.$$escapeHtml(fieldData58) + '</strong>';
  }
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.buildFieldList.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.buildFieldList';
}


jiraIntegration.templates.jiraCreateIssueForm.authorize = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '';
  var applicationNameEscaped__soy67 = '' + soy.$$escapeHtml(opt_data.applicationName);
  output += aui.message.info({content: '' + soy.$$filterNoAutoescape(AJS.format('{0}\u767b\u5f55\u5e76\u6279\u51c6{1}\u4ece{2}\u68c0\u7d22\u51fa\u7684\u6570\u636e','<a class="oauth-init applink-authenticate" href="#">','</a>',applicationNameEscaped__soy67))});
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.authorize.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.authorize';
}


jiraIntegration.templates.jiraCreateIssueForm.unsupportedServerMessage = function(opt_data, opt_ignored) {
  return '' + aui.message.warning({content: '' + soy.$$filterNoAutoescape(AJS.format('\u4e0d\u652f\u6301\u6240\u9009\u7684 Jira \u670d\u52a1\u5668\u7248\u672c\u3002 \u60a8\u53ef\u80fd\u9700\u8981\u5347\u7ea7\u5230\u7248\u672c 5.x \u4ee5\u4e0a\u6216{0}\u5728 Jira \u4e2d\u521b\u5efa\u4e8b\u52a1{1}\u3002','<a href="' + opt_data.serverUrl + '" target="_blank">','</a>'))});
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.unsupportedServerMessage.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.unsupportedServerMessage';
}


jiraIntegration.templates.jiraCreateIssueForm.unrenderableRequiredFieldsMessage = function(opt_data, opt_ignored) {
  return '' + aui.message.warning({content: '' + soy.$$filterNoAutoescape(AJS.format('\u5fc5\u586b\u7684 {1,choice,1#\u4e2a\u5b57\u6bb5|1\x3c\u4e2a\u5b57\u6bb5} \x3cstrong\x3e{0}\x3c/strong\x3e{1,choice,1#\u5728|1\x3c\u5728}\u6b64\u5bf9\u8bdd\u4e2d\u4e0d\u53ef\u7528\u3002\u60a8\u9700\u8981{2}\u76f4\u63a5\u5728 Jira \u4e2d\u521b\u5efa\u4e8b\u52a1{3}\u3002',opt_data.names,opt_data.count,'<a href="' + opt_data.serverUrl + '" target="_blank">','</a>'))});
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.unrenderableRequiredFieldsMessage.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.unrenderableRequiredFieldsMessage';
}


jiraIntegration.templates.jiraCreateIssueForm.communicationErrorMessage = function(opt_data, opt_ignored) {
  return '' + aui.message.error({titleContent: '' + soy.$$escapeHtml('\u5f88\u9057\u61be\uff0c\u6211\u4eec\u5728\u8fde\u63a5 Jira \u65f6\u9047\u5230\u4e86\u95ee\u9898'), content: '<p>' + soy.$$escapeHtml(opt_data.message) + '</p>'});
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.communicationErrorMessage.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.communicationErrorMessage';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:proxy-js', location = '/jira/proxy.js' */
AppLinks=AJS.$.extend(window.AppLinks||{},{makeRequest:function(a){var b=contextPath||AJS.contextPath();if(a.processData){if(a.appId){a.data=AJS.$.extend(a.data||{},{appId:a.appId})}else{if(a.appType){a.data=AJS.$.extend(a.data||{},{appType:a.appType})}}a.data=AJS.$.extend(a.data||{},{path:a.url})}else{var c=a.url;a=AJS.$.extend(a,{beforeSend:function(d){if(a.appId){d.setRequestHeader("X-AppId",a.appId)}else{if(a.appType){d.setRequestHeader("X-AppType",a.appType)}}d.setRequestHeader("X-AppPath",c)}})}a=AJS.$.extend(a,{url:b+"/plugins/servlet/applinks/proxy"});return AJS.$.ajax(a)},createProxyGetUrl:function(b){var c="";if(b.includeContext){c=contextPath||AJS.contextPath()}var a=c+"/plugins/servlet/applinks/proxy";if(b.appId){a+="?appId="+encodeURIComponent(b.appId)}else{if(b.appType){a+="?appType="+encodeURIComponent(b.appType)}else{AJS.log("You need to specify an appType or appId");return""}}if(b.path){a+="&path="+encodeURIComponent(b.path)}return a}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jqlHelper', location = '/jira/jqlhelper.js' */
AJS.JQLHelper=(function(){var a=/^\s*((key|issuekey)\s*=\s*)?"*([A-Z]+)([0-9]+)?([A-Z]+)?-([0-9]+)"*\s*$/i;var e=/\s*([A-Z][A-Z]+)-[0-9]+\s*/;var j=/(issue|searchrequest)-xml/i;var g=/\/(i#)?browse\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+$)/i;var i=/\/jira\.issueviews:issue-xml\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+)\//;var c=/(jqlQuery|jql)\s*\=([^&]+)/i;var h=/(\?|&)(requestId|filter)\=([^&]+)/i;var b=/(searchrequest-xml\/)([0-9]+)\/SearchRequest/i;var k=/(requestId|filter)\=([^&]+)/i;var d=/=|!=|~|>|<|!~| is | in | was | changed /i;var f=function(p){var m="";var q=g.exec(p);if(q){m="key="+q[2]}else{var n=c.exec(p);if(n){m=n[2]}else{var o=e.exec(p);if(o){m="key="+o[0]}}}m=m.replace(/\+/g," ");return m};var l=function(n,p){var m;var o=decodeURIComponent(n);var q=function(r){if(r.jql){m=r.jql}};AJS.JQLHelper.getJqlQueryFromJiraFilter(o,p,q);return m};return{isSingleKeyJQLExp:function(m){return a.exec(m)},isMultipleSingleKeyJQLExp:function(p){var o=p.split(",");for(var n in o){var m=AJS.$.trim(o[n]);if(!AJS.JQLHelper.isSingleKeyJQLExp(m)){return false}}return true},isIssueUrlOrXmlUrl:function(m){if(g.test(m)||j.test(m)||c.test(m)||i.test(m)){return true}return false},isFilterUrl:function(m){return h.test(m)||b.test(m)},getFilterFromFilterUrl:function(m){if(h.test(m)){var n=h.exec(m);return n[2]+"="+n[3]}else{if(b.test(m)){return"filter="+b.exec(m)[2]}}},getJqlQueryFromJiraFilter:function(p,q,r,o){var m=(h.exec(p)||b.exec(p))[2];var n="/rest/jiraanywhere/1.0/jira/appLink/"+q+"/filter/"+m;AJS.$.ajax({async:false,dataType:"json",url:Confluence.getContextPath()+n,success:r,error:o})},findServerIndexFromUrl:function(m,p){if(typeof(p)!=="undefined"||p.length>0){var o=m.toLowerCase();for(var n=0;n<p.length;n++){if(o.indexOf(p[n].url.toLowerCase())==0){if(m.charAt(p[n].url.length)=="/"){return n}}}}return -1},getJqlQueryFromUrl:f,getJqlAndServerIndexFromUrl:function(n,o){var m={};m.serverIndex=this.findServerIndexFromUrl(n,o);m.jqlQuery=f(n);return m},checkQueryType:function(m){if(!AJS.Editor.JiraAnalytics){return undefined}if(!m||AJS.$.trim(m).length==0){return}if(m.indexOf("http")!=0){return AJS.Editor.JiraAnalytics.linkTypes.jqlDirect}else{if(m.indexOf("jira.issueviews:searchrequest-xml")!=-1||m.indexOf("jira.issueviews:issue-xml")!=-1){return AJS.Editor.JiraAnalytics.linkTypes.xml}else{if(m.indexOf("jira.issueviews:searchrequest-rss")!=-1){return AJS.Editor.JiraAnalytics.linkTypes.rss}else{if(m.indexOf("filter=")!=-1||m.indexOf("filter\\=")!=-1){return AJS.Editor.JiraAnalytics.linkTypes.filter}else{return AJS.Editor.JiraAnalytics.linkTypes.jql}}}}},convertToJQL:function(n,p){var o;if(AJS.$.trim(n)!==""){if(n.indexOf("http")===0&&this.isFilterUrl(n)){o=l(n,p)}else{if(n.indexOf("http")===0&&this.isIssueUrlOrXmlUrl(n)){var m=f(decodeURIComponent(n));if(m.length>0){o=m}}else{if(n.indexOf("http")!==0&&n.match(d)){o=n}else{if(n.match(e)){o="key="+n}else{o='summary ~ "'+n+'" OR description ~ "'+n+'"'}}}}}return o}}})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.components:editor-notifications', location = '/includes/js/editor-notifications.js' */
define("confluence/editor-notifications",[],function(){var a;return{notify:function(b,c,d){var e=require("aui/flag");void 0!==a&&"true"!==a.getAttribute("aria-hidden")&&a.close();void 0===d&&(d="error"===b?"manual":"auto");a=e({type:b,body:c,close:d})}}});require("confluence/module-exporter").safeRequire("confluence/editor-notifications",function(a){var b=require("confluence/api/event"),c=require("confluence/legacy");b.bind("init.rte",function(){c.EditorNotification=a})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:legacy-editor-global-AVOID-IF-POSSIBLE', location = '/includes/js/amd/shim/confluence-editor-amd.js' */
define("confluence-editor/legacy",["confluence/legacy"],function(a){"undefined"===typeof a&&(a={});"undefined"===typeof a.Editor&&(a.Editor={});return a.Editor});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:attachments-insert-utils-resources', location = 'utils/attachments-insert-utils.js' */
define("confluence-editor/utils/attachments-insert-utils",["underscore","confluence/meta","jquery"],function(c,b,d){return{insertFilePlaceholder:function(a,e,f){var g=require("tinymce");a.height="comment"===b.get("content-type")?"150":"250";a.ownerId&&a.ownerId===b.get("content-id")&&(delete a.page,delete a.space,delete a.date);a=c.omit(c.pick(a,"name","page","space","date","height"),function(a){return!a});a={contentId:b.get("content-id")||"0",macro:{name:"view-file",params:a}};g.confluence.MacroUtils.insertMacro(a,
e).done(function(a){f&&d(a).click()})}}});require("confluence/module-exporter").safeRequire("confluence-editor/utils/attachments-insert-utils");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-internationalisation', location = 'i18n/translations.i18n.js' */
define("confluence-editor/i18n/translations.i18n",["ajs"],function(a){return{popup_blocked:"\u6d4f\u89c8\u5668\u963b\u6b62\u4e86\u7f16\u8f91\u5668\u6253\u5f00\u7684\u5f39\u51fa\u6846\u3002",ctrl_key:"Ctrl",shift_key:"Shift",searchreplace:{search_desc:"\u67e5\u627e",replace_desc:"\u67e5\u627e/\u66ff\u6362"},searchreplace_dlg:{allreplacedplural:"{0} \u88ab\u66ff\u6362",allreplacedsingular:"1 \u4e2a\u88ab\u66ff\u6362",
notfound:"\u6ca1\u6709\u4efb\u4f55\u66ff\u6362\u3002",findlabel:"\u67e5\u627e",replacelabel:"\u66ff\u6362",findnext:"\u4e0b\u4e00\u4e2a",findprevious:"\u4e0a\u4e00\u4e2a",replace:"\u66ff\u6362",replaceall:"\u5168\u90e8\u66ff\u6362",close:"\u5173\u95ed"},
advhr:{advhr_desc:"tinymce.advhr.advhr_desc"},emotions:{emotions_desc:"\u8868\u60c5\u7b26\u53f7"},emotions_dlg:{title:"\u63d2\u5165\u8868\u60c5",desc:"\u8868\u60c5\u7b26\u53f7",smile:"\u5fae\u7b11 :)",sad:"\u60b2\u4f24 :(",tongue:"\u5410\u820c :p",biggrin:"\u5927\u7b11 :D",wink:"\u7728\u773c ;)",
thumbs_up:"\u8d5e\u540c (y)",thumbs_down:"\u5426\u5b9a (n)",information:"\u4fe1\u606f (i)",check:"\u6253\u52fe (/)",error:"\u9519\u8bef (x)",warning:"\u8b66\u544a (!)",add:"\u52a0 (+)",forbidden:"\u51cf (-)",help_16:"\u95ee\u53f7 (?)",
lightbulb_on:"\u706f\u4eae (on)",lightbulb:"\u706f\u706d (off)",star_yellow:"\u9ec4\u661f (*y)",star_red:"\u7ea2\u661f (*r)",star_green:"\u7eff\u661f (*g)",star_blue:"\u84dd\u661f (*b)",heart:"\u5fc3\u5f62 \u003c3",broken_heart:"\u5fc3\u788e \u003c/3"},confluence:{conf_macro_browser:"\u5b8f",
conf_macro_browser_desc:"\u63d2\u5165\u5b8f",conf_image:"\u56fe\u7247",confimage_desc:"\u63d2\u5165\u56fe\u50cf",conf_file:"\u6587\u4ef6\u548c\u56fe\u7247",confifile_desc:"\u63d2\u5165\u6587\u4ef6\u548c\u56fe\u7247",conf_link:"\u94fe\u63a5",conflink_desc:"\u63d2\u5165\u94fe\u63a5",conf_table:"\u8868\u683c",
conf_wikimarkup:"Wiki\u6807\u8bb0",conf_wikimarkup_desc:"\u63d2\u5165Wiki\u6807\u8bb0",conf_wikimarkup_errors:"Wiki\u6807\u8bb0\u8f6c\u6362\u9519\u8bef",conf_wikimarkup_timeout:"\u670d\u52a1\u5668\u5904\u7406wiki\u6807\u8bb0\u65f6\u95f4\u8fc7\u957f\uff0c\u4e5f\u8bb8\u662f\u5076\u53d1\u95ee\u9898\uff0c\u53ef\u4ee5\u7a0d\u540e\u518d\u8bd5\u3002",conf_wikimarkup_hint:"\u63d0\u793a: \u53ef\u4ee5\u5728\u7f16\u8f91\u5668\u4e2d\u76f4\u63a5\u8f93\u5165wiki\u6807\u8bb0\uff0c\u7cfb\u7edf\u4f1a\u8fdb\u884c\u683c\u5f0f\u5904\u7406\u3002",conf_wikimarkup_markdown_label:"\u8fdb\u884c\u6807\u8bb0",
conf_wikimarkup_confluence_label:"\u4f01\u4e1a\u7ef4\u57fa",conf_shortcuts_help_desc:"\u952e\u76d8\u5feb\u6377\u65b9\u5f0f\u5e2e\u52a9",conf_insert_button_title:"\u63d2\u5165"},table:{desc:"\u63d2\u5165\u8868\u683c",row_before_desc:"\u6b64\u524d\u63d2\u5165\u884c",row_after_desc:"\u6b64\u540e\u63d2\u5165\u884c",delete_row_desc:"\u5220\u9664\u884c",
numbering_column_desc:"\u63d2\u5165\u884c\u53f7\u5217",responsive:"\u53cd\u5e94\u7075\u654f\u7684",responsive_tooltip:"\u968f\u7740\u60a8\u6dfb\u52a0\u5185\u5bb9\u8868\u683c\u7684\u5217\u53d8\u5bbd\u3002\u62d6\u52a8\u5217\u7684\u8fb9\u754c\uff0c\u76f8\u5bf9\u5f7c\u6b64\u548c\u9875\u9762\u8bbe\u7f6e\u5bbd\u5ea6\u3002",fixed_width:"\u56fa\u5b9a\u5bbd\u5ea6",fixed_width_tooltip:"\u62d6\u52a8\u5217\u8fb9\u6846\u8bbe\u7f6e\u5bbd\u5ea6\u3002\u8be5\u8868\u603b\u662f\u4ee5\u60a8\u8bbe\u7f6e\u7684\u5bbd\u5ea6\u51fa\u73b0\u3002",col_before_desc:"\u6b64\u524d\u63d2\u5165\u5217",col_after_desc:"\u6b64\u540e\u63d2\u5165\u5217",col_copy_desc:"\u590d\u5236\u5217",
col_paste_desc:"\u7c98\u8d34\u5217",col_cut_desc:"\u526a\u5207\u5217",delete_col_desc:"\u5220\u9664\u5217",split_cells_desc:"\u5206\u5272\u5408\u5e76\u7684\u5355\u5143\u683c",merge_cells_desc:"\u5408\u5e76\u5355\u5143\u683c",row_desc:"tinymce.table.row_desc",cell_desc:"tinymce.table.cell_desc",props_desc:"tinymce.table.props_desc",paste_row_before_desc:"\u7c98\u8d34\u884c",
paste_row_after_desc:"\u6b64\u540e\u7c98\u8d34\u884c",cut_row_desc:"\u526a\u5207\u884c",copy_row_desc:"\u590d\u5236\u884c",del:"\u5220\u9664\u8868\u683c",row:"\u884c",col:"\u5217",cell:"\u5355\u5143\u683c",row_highlight:"\u8868\u5934\u884c",col_highlight:"\u8868\u5934\u5217",selection_highlight:"\u66f4\u6539\u5355\u5143\u683c\u989c\u8272",
invalid_table_field:"\u884c\u6570\u3001\u5217\u6570\u5fc5\u987b\u5927\u4e8e0\u3002",table_more_heading:"\u8868\u683c\u8bbe\u7f6e",cell_background_color:"\u80cc\u666f\u8272\uff1a{0}",cell_color_grey:"\u7070\u8272",cell_color_yellow:"\u9ec4\u8272",cell_color_red:"\u7ea2\u8272",cell_color_green:"\u7eff\u8272",cell_color_blue:"\u84dd\u8272",
cell_color_clear:"\u900f\u660e",cut_row_desc_shortcut:"Ctrl+Shift+X",copy_row_desc_shortcut:"Ctrl+Shift+C",paste_row_before_desc_shortcut:"Ctrl+Shift+V",row_before_desc_shortcut:"Alt+\u2191",row_after_desc_shortcut:"Alt+\u2193"},advanced:{style_select:"tinymce.advanced.style_select",
font_size:"tinymce.advanced.font_size",fontdefault:"tinymce.advanced.fontdefault",block:"\u683c\u5f0f",paragraph:"\u6b63\u6587",pre:"\u9884\u683c\u5f0f\u5316",h1:"\u6807\u9898 1",h2:"\u6807\u9898 2",h3:"\u6807\u9898 3",h4:"\u6807\u9898 4",h5:"\u6807\u9898 5",h6:"\u6807\u9898 6",
blockquote:"\u5f15\u7528",code:"tinymce.advanced.code",samp:"tinymce.advanced.samp",dt:"tinymce.advanced.dt",dd:"tinymce.advanced.dd",bold_desc:"\u7c97\u4f53",italic_desc:"\u659c\u4f53",underline_desc:"\u4e0b\u5212\u7ebf",striketrough_desc:"\u5220\u9664\u7ebf",justifyleft_desc:"\u5de6\u5bf9\u9f50",
justifycenter_desc:"\u5c45\u4e2d",justifyright_desc:"\u53f3\u5bf9\u9f50",justifyfull_desc:"\u5145\u6ee1",bullist_desc:"\u65e0\u5e8f\u5217\u8868",numlist_desc:"\u6709\u5e8f\u5217\u8868",tasklist_desc:"\u4efb\u52a1\u5217\u8868",outdent_desc:"\u51cf\u5c0f\u7f29\u8fdb",indent_desc:"\u589e\u5927\u7f29\u8fdb",
undo_desc:"\u56de\u9000",redo_desc:"\u91cd\u505a",link_desc:"tinymce.advanced.link_desc",unlink_desc:"\u53d6\u6d88\u94fe\u63a5",image_desc:"tinymce.advanced.image_desc",cleanup_desc:"tinymce.advanced.cleanup_desc",code_desc:"tinymce.advanced.code_desc",sub_desc:"\u4e0b\u6807",sup_desc:"\u4e0a\u6807",
hr_desc:"\u6c34\u5e73\u7ebf",removeformat_desc:"tinymce.advanced.removeformat_desc",custom1_desc:"tinymce.advanced.custom1_desc",forecolor_desc:"\u9009\u62e9\u6587\u672c\u989c\u8272",backcolor_desc:"tinymce.advanced.backcolor_desc",charmap_desc:"\u7b26\u53f7",visualaid_desc:"tinymce.advanced.visualaid_desc",anchor_desc:"tinymce.advanced.anchor_desc",cut_desc:"tinymce.advanced.cut_desc",
copy_desc:"tinymce.advanced.copy_desc",paste_desc:"tinymce.advanced.paste_desc",image_props_desc:"tinymce.advanced.image_props_desc",newdocument_desc:"tinymce.advanced.newdocument_desc",help_desc:"\u5e2e\u52a9",blockquote_desc:"tinymce.advanced.blockquote_desc",path:"tinymce.advanced.path",newdocument:"tinymce.advanced.newdocument",toolbar_focus:"tinymce.advanced.toolbar_focus",
more_colors:"tinymce.advanced.more_colors",paragraph_shortcut:"Ctrl+0",pre_shortcut:"Ctrl+7",h1_shortcut:"Ctrl+1",h2_shortcut:"Ctrl+2",h3_shortcut:"Ctrl+3",h4_shortcut:"Ctrl+4",h5_shortcut:"Ctrl+5",h6_shortcut:"Ctrl+6",
blockquote_shortcut:"Ctrl+8",bullist_shortcut:"Ctrl+Shift+B",numlist_shortcut:"Ctrl+Shift+N",tasklist_shortcut:"tinymce.confluence.layout.three_col=\u4e09\u680f",undo_shortcut:"Ctrl+Z",redo_shortcut:"Ctrl+Y"},colorpicker:{more_colors:"\u66f4\u591a\u989c\u8272",title:"\u9009\u62e9\u989c\u8272",
picker_tab:"\u9009\u62e9\u5668",picker_title:"\u989c\u8272\u9009\u53d6\u5668",palette_title:"tinymce.colorpicker.palette_title",named_tab:"tinymce.colorpicker.named_tab",named_title:"tinymce.colorpicker.named_title",color:"\u989c\u8272",name:"tinymce.colorpicker.name",apply:"tinymce.colorpicker.apply"},hints:{drafts:"\u63d0\u793a: Confluence\u4f1a\u81ea\u52a8\u4fdd\u5b58\u8349\u7a3f\uff0c\u5982\u679c\u9000\u51fa\u4e86\u7a97\u4f53\uff0c\u53ef\u4ee5\u9009\u62e9\u0022\u7528\u6237\u540d -\u003e \u8349\u7a3f\u0022 \u83dc\u5355\u6062\u590d\u5de5\u4f5c\u3002",
dnd:"\u63d0\u793a: \u53ef\u4ee5\u5c06\u56fe\u7247\u548cOffice\u6587\u4ef6\u76f4\u63a5\u62d6\u653e\u5230\u7f16\u8f91\u5668\u4e2d\u3002",insert_link_recently_viewed:"\u63d0\u793a: \u8f93\u5165 \u0022\u003cstrong\u003e[\u003c/strong\u003e\u0022 \u67e5\u770b\u5efa\u8bae\u9875\u9762\u5217\u8868\u5e76\u63d2\u5165\u94fe\u63a5\u3002",insert_link_search:"\u63d0\u793a: \u8f93\u5165 \u0022\u003cstrong\u003e[\u003c/strong\u003e\u0022 \u53ca\u90e8\u5206\u9875\u9762\u6807\u9898\u8fdb\u884c\u67e5\u627e\u5e76\u94fe\u63a5\u5230\u9875\u9762\u3002",insert_link_end:"\u63d0\u793a: \u5728\u4e00\u4e2a\u8bcd\u540e\u6309\u4e0b \u003cstrong\u003eCtrl+Shift+K\u003c/strong\u003e \u67e5\u627e\u5e76\u94fe\u63a5\u5230\u76f8\u5173\u9875\u9762\uff0c\u518d\u6b21\u6309\u4e0b\u7ec4\u5408\u952e\u4f1a\u83b7\u5f97\u66f4\u591a\u5efa\u8bae\u3002",insert_link_newpage:"\u63d0\u793a: \u8f93\u5165 \u0022\u003cstrong\u003e[\u003c/strong\u003e\u0022 \u548c\u5e0c\u671b\u521b\u5efa\u7684\u9875\u9762\u6807\u9898\uff0c\u5c06\u4f1a\u770b\u5230\u63d2\u5165\u94fe\u63a5\u7684\u5efa\u8bae\u3002",insert_link_user_mention:"\u63d0\u793a: \u5728Confluence\u4e2d\u63d0\u53ca\u67d0\u4eba\u65f6\uff0c\u8f93\u5165 \u0022\u003cstrong\u003e@\u003c/strong\u003e\u0022\u7136\u540e\u662f\u540d\u5b57\u5373\u53ef\u3002",insert_image_on_page:"\u63d0\u793a: \u8f93\u5165 \u0022\u003cstrong\u003e!\u003c/strong\u003e\u0022 \u67e5\u770b\u9875\u9762\u9644\u4ef6\u5e76\u9009\u62e9\u4e00\u4e2a\u63d2\u5165\u3002",insert_image_search:"\u63d0\u793a: \u8f93\u5165 \u0022\u003cstrong\u003e!\u003c/strong\u003e\u0022 \u53ca\u90e8\u5206\u56fe\u7247\u540d\u79f0\u8fdb\u884c\u67e5\u627e\u5e76\u63d2\u5165\u56fe\u7247\u3002",
insert_image_end:"\u63d0\u793a: \u5728\u4e00\u4e2a\u8bcd\u540e\u6309\u4e0b \u003cstrong\u003eCtrl+Shift+M\u003c/strong\u003e \u67e5\u627e\u5e76\u63d2\u5165\u76f8\u5173\u56fe\u7247\u3002",insert_wikimarkup:"\u63d0\u793a: \u7f16\u8f91\u5668\u5c06\u6839\u636e\u8f93\u5165\u81ea\u52a8\u8f6c\u6362wiki\u6807\u8bb0\u3002",insert_wikimarkup_dialog:"\u63d0\u793a: \u6309\u4e0b \u003cstrong\u003eCtrl+Shift+D\u003c/strong\u003e\u6253\u5f00Wiki\u6807\u8bb0\u5bf9\u8bdd\u6846\u3002",insert_link:"\u63d0\u793a: \u6309\u4e0b \u003cstrong\u003eCtrl+K\u003c/strong\u003e \u6253\u5f00\u94fe\u63a5\u6d4f\u89c8\u5668\u3002",insert_image:"\u63d0\u793a: \u6309\u4e0b \u003cstrong\u003eCtrl+M\u003c/strong\u003e \u6253\u5f00\u56fe\u7247\u6d4f\u89c8\u5668\u3002",insert_macro:"\u63d0\u793a: \u6309\u4e0b \u003cstrong\u003eCtrl+Shift+A\u003c/strong\u003e \u6253\u5f00\u5b8f\u6d4f\u89c8\u5668\u3002",insert_macro_toc:"\u63d0\u793a: \u8ba9Confluence\u4e3a\u672c\u9875\u4ea7\u751f\u8868\u683c\u5185\u5bb9\uff0c \u4f7f\u7528\u0022\u63d2\u5165 -\u003e \u8868\u683c\u5185\u5bb9\u0022",insert_bullet_list:"\u63d0\u793a: \u6309\u4e0b \u003cstrong\u003eCtrl+Shift+B\u003c/strong\u003e \u5f15\u5165\u9879\u76ee\u7b26\u53f7\u5217\u8868\u3002",
insert_numbered_list:"\u63d0\u793a: \u6309\u4e0b \u003cstrong\u003eCtrl+Shift+N\u003c/strong\u003e \u5f15\u5165\u6570\u5b57\u5217\u8868\u3002",insert_heading:"\u63d0\u793a: \u6309\u4e0b \u003cstrong\u003eCtrl+1\u003c/strong\u003e \u5f15\u5165\u4e00\u7ea7\u6807\u9898, \u6309\u4e0b\u003cstrong\u003eCtrl+2\u003c/strong\u003e \u5f15\u5165\u4e8c\u7ea7\u6807\u9898\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002",insert_table:"\u63d0\u793a: \u6309\u4e0b \u003cstrong\u003eCtrl+Shift+I\u003c/strong\u003e \u63d2\u5165\u5230\u8868\u4e2d\u3002",table_rows_copy:"\u63d0\u793a: \u6309\u4e0b \u003cstrong\u003eCtrl+Shift+C\u003c/strong\u003e \u590d\u5236\u4e00\u884c\uff0c\u518d\u6309 \u003cstrong\u003eCtrl+Shift+V\u003c/strong\u003e \u5c06\u590d\u5236\u5185\u5bb9\u7c98\u8d34\u5230\u8868\u4e2d\u3002",table_rows_cut:"\u63d0\u793a: \u6309\u4e0b \u003cstrong\u003eCtrl+Shift+X\u003c/strong\u003e \u526a\u5207\u4e00\u884c\uff0c\u518d\u6309 \u003cstrong\u003eCtrl+Shift+V\u003c/strong\u003e \u5c06\u526a\u5207\u5185\u5bb9\u7c98\u8d34\u5230\u8868\u4e2d\u3002",insert_newline:"\u63d0\u793a: \u8f93\u5165 \u003cstrong\u003eShift+Enter\u003c/strong\u003e \u63d2\u5165\u65e0\u7f29\u8fdb\u7684\u65b0\u6bb5\u843d\u3002",autoformat_heading1:"\u63d0\u793a: \u8f93\u5165 \u0022\u003cstrong\u003eh1. \u6807\u9898\u003c/strong\u003e\u0022 \u5feb\u901f\u63d2\u5165\u6807\u98981\u7c7b\u578b\u7684\u6587\u672c\u3002",autoformat_heading3:"\u63d0\u793a: \u8f93\u5165 \u0022\u003cstrong\u003eh3. \u6807\u9898\u003c/strong\u003e\u0022 \u5feb\u901f\u63d2\u5165\u6807\u98981\u7c7b\u578b\u7684\u6587\u672c\u3002",
autoformat_code:"\u63d0\u793a: \u8f93\u5165 \u0022\u003cstrong\u003e{{code}}\u003c/strong\u003e\u0022 \u5feb\u901f\u63d2\u5165\u7b49\u5bbd\u6587\u672c\u3002"},auiwindowmanager:{cancel:"\u53d6\u6d88",ok:"\u786e\u8ba4"},propertypanel:{links_goto:"\u8bbf\u95ee\u94fe\u63a5",links_edit:"\u7f16\u8f91",links_unlink:"\u53d6\u6d88\u94fe\u63a5",links_goto_disabled_tooltip:"\u8be5\u94fe\u63a5\u6307\u5411\u9875\u9762\u4e0a\u60a8\u6b63\u5728\u7f16\u8f91\u7684\u5185\u5bb9",links_edit_tooltip:"\u5728\u5bf9\u8bdd\u6846\u4e2d\u7f16\u8f91\u94fe\u63a5",
links_unlink_tooltip:"\u7528\u94fe\u63a5\u5185\u5bb9\u66ff\u6362\u94fe\u63a5",images_small:"\u5c0f",images_medium:"\u4e2d",images_large:"\u5927",images_original:"\u539f\u59cb\u5927\u5c0f",images_border:"\u8fb9\u6846",images_link_create:"\u94fe\u63a5",images_link_edit:"\u7f16\u8f91\u94fe\u63a5",
images_link_remove:"\u53d6\u6d88\u94fe\u63a5",images_link_create_tooltip:"\u56fe\u7247\u94fe\u63a5\u81f3\u5176\u4ed6\u5185\u5bb9\u3002",images_link_edit_tooltip:"\u7f16\u8f91\u56fe\u7247\u94fe\u63a5",images_link_remove_tooltip:"\u5220\u9664\u6b64\u56fe\u7247\u7684\u94fe\u63a5",images_sizing_tooltip:"\u8c03\u6574\u56fe\u7247\u81f3\u7279\u5b9a\u5bbd\u5ea6",images_small_tooltip:"\u7f29\u5c0f\u56fe\u7247\u5e76\u94fe\u63a5\u5230\u539f\u59cb\u56fe\u7247",
images_medium_tooltip:"\u8c03\u6574\u56fe\u7247\u5927\u5c0f\u5e76\u94fe\u63a5\u5230\u539f\u59cb\u56fe\u7247",images_large_tooltip:"\u8c03\u6574\u56fe\u7247\u81f3\u5927\u56fe\u5e76\u94fe\u63a5\u5230\u6e90\u6587\u4ef6",images_original_tooltip:"\u6062\u590d\u56fe\u7247\u539f\u59cb\u5927\u5c0f",images_thumbnail_tooltip:"tinymce.propertypanel.images.thumbnail.tooltip",images_border_tooltip:"\u5728\u56fe\u7247\u5468\u56f4\u52a0\u8fb9\u6846"}}});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/i18n/translations.i18n","TinyMCELang");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-editor-v4:editor-resources-v4', location = 'build/editor.js' */
!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="","undefined"!=typeof AJS&&(n.p=AJS.contextPath()+"/download/resources/com.atlassian.confluence.plugins.confluence-editor-v4:assets-be875121-fdf1-45da-90f8-283cac0b9a7d/"),n(n.s=0)}({"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/aeTable/css/editor-content.scss":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,"td[data-mce-selected],td[data-mce-selected] p,th[data-mce-selected],th[data-mce-selected] p{background-color:#edf5ff!important}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/confcharmap/charmap.css":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,"#charmap-picker{border:0;font-size:16px;font-family:Arial,Helvetica,FreeSans,sans-serif;padding:2px;text-align:center}#charmap-view{padding-right:1em;text-align:left;vertical-align:top}#charmap-info{text-align:center;vertical-align:top;width:100%}#charmap-info>table{border:0;height:100px;padding:0;width:100%}#code-value{font-size:3em}#code-name{font-size:13px}#code-name,#code-value{color:#666;text-align:center}.charmap a:active,.charmap a:hover,.charmap a:link,.charmap a:visited{color:#326ca6;text-decoration:none}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/draggable/draggable.css":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,"table.draggable{margin-left:-10px;margin-top:-10px}table.draggable:hover>tbody>tr>td.draggable-column,table.draggable:hover>tbody>tr>td.draggable-row,table.draggable:hover>tbody>tr>td.draggable-table{background-color:#777;border-top:1px solid #777;border-left:1px solid #777}table.draggable:hover>tbody>tr>td.draggable-column,table.draggable:hover>tbody>tr>td.draggable-table{border-right:1px solid #aaa}table.draggable:hover>tbody>tr>td.draggable-row,table.draggable:hover>tbody>tr>td.draggable-table{border-bottom:1px solid #aaa}td.draggable-column,td.draggable-row,td.draggable-table{background-color:transparent;border-top:1px solid transparent;border-left:1px solid transparent;cursor:move}td.draggable-column,td.draggable-table{border-right:1px solid transparent}td.draggable-row,td.draggable-table{border-bottom:1px solid transparent}td.draggable-column{height:10px}td.draggable-row{width:10px}.wiki-content img.confluence-embedded-image,.wiki-content img.editor-inline-macro,.wiki-content table.wysiwyg-macro{cursor:move}.wiki-content table.wysiwyg-macro>tbody>tr>td.wysiwyg-macro-body{cursor:text}#move-indicator{font-weight:400!important}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/insert-files/insert-files.css":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,".quick-comment-form #rte-toolbar .insert-files.toolbar-item{padding:0 6px}.quick-comment-form #rte-toolbar .insert-files .toolbar-trigger{margin:0 -6px}#rte-toolbar .insert-files.toolbar-item{padding:0}#rte-toolbar .insert-files .trigger-text{display:none}#rte-toolbar .insert-files .aui-button{padding:0 6px}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/insertwiki/insert-wiki-markup.css":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,'.aui-dialog .wiki-parser-selector{font-size:14px;margin-right:5px}.insert-wiki-markup-panel div,.insert-wiki-markup-panel div form{height:100%;text-align:center}.insert-wiki-markup-panel .spinner{position:absolute;top:50%;left:50%;margin-top:-73px;margin-left:-60px}#insert-wiki-info-title{text-align:left;margin-left:10px}#insert-wiki-markup-form{height:95%}#insert-wiki-markup-form .wiki-title span{box-sizing:border-box;display:-moz-inline-stack;display:inline-block;margin-bottom:10px;max-width:48%;text-align:left;vertical-align:middle;width:48%}#insert-wiki-markup-form .wiki-title span:first-child{margin-right:20px}#insert-wiki-textarea,#insert-wiki-textarea-preview{box-sizing:border-box;display:-moz-inline-stack;display:inline-block;font-size:14px;height:84%;max-width:48%;vertical-align:middle;width:48%;resize:none}#insert-wiki-textarea.originalDefault{height:100%;min-width:100%;width:100%}#insert-wiki-textarea{font-family:Monaco,Consolas,Courier New,"monospace";margin-right:20px}#insert-wiki-textarea-preview{border:1px solid #ccc;border-radius:3px;position:relative}#insert-wiki-textarea-preview iframe{border:0;height:100%;left:0;min-height:100%;overflow:hidden;position:absolute;top:0;width:100%}',""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/iosediting/iosediting.css":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,"body.ios{min-height:150px}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/propertypanel/css/property-panel.css":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,"#property-panel a.macro-placeholder-property-panel-display-newline-button span.icon{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAvklEQVR42rVTPQuFIBT1p1t7e2EFDrXnVmNb4Ca4BS5BW9AfOA+F+wjfAwfpwuHcDzn3olcGIAv5An3fo+u6L55x27bE5P+cZdkWqVJH6pDMsWxTSsFjmqbAMZIC4zjivm9c14XjOLDvO4wx2LYNwzCkBZqmwXmecM7BWgutNdZ1xTzP8LWkQFVVWJYFUspwQUII1HUd2NeSApxzeJRlCfKLovBxYPa6xe9KsedHLc7TXryzidQpnurvZNm/8QMbqb4yyqv4rAAAAABJRU5ErkJggg==);width:16px;height:16px;display:inline-block}#property-panel a.macro-placeholder-property-panel-display-inline-button span.icon{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAw0lEQVR42q1TMQqAMBDr0/UBroJiBUEf0E51dRMcxUlwFBcHPxA5IUuLONSDcDmupO01VQCiEC+gtYagrusH5FVVCfdz0FfRQVVR5CmoLtzfnWBf/R7WWhhjIFnAmvlToOs6XNeF8zyx7zvWdcU8zxjHEW3bhgK8NydaFAWO48C2bViWBdM0YRgGOOcgPc7t9RWyLEPf92ia5hEuyxJ5nj+Lpae+IkkSpGkKZnLW6u/gDHzX+c6kP4j/nfjmNJ8HiP6NN81gzxU6QYojAAAAAElFTkSuQmCC);width:16px;height:16px;display:inline-block}#property-panel a.macro-placeholder-property-panel-display-inline-button,#property-panel a.macro-placeholder-property-panel-display-newline-button{padding:0 6px}",""])},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/status-macro/editor.scss":function(e,t,n){(e.exports=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,"#property-panel a.macro-property-panel-Grey span.icon{background-color:#dfe1e6}#property-panel a.macro-property-panel-Green span.icon{background-color:#00875a}#property-panel a.macro-property-panel-Red span.icon{background-color:#de350b}#property-panel a.macro-property-panel-Yellow span.icon{background-color:#ffab00}#property-panel a.macro-property-panel-Blue span.icon{background-color:#b3d4ff}#property-panel a.macro-property-panel-Blue,#property-panel a.macro-property-panel-Brown,#property-panel a.macro-property-panel-Green,#property-panel a.macro-property-panel-Grey,#property-panel a.macro-property-panel-Red,#property-panel a.macro-property-panel-Yellow{padding:6px;display:inline-block}#property-panel a.macro-property-panel-Blue span.icon,#property-panel a.macro-property-panel-Brown span.icon,#property-panel a.macro-property-panel-Green span.icon,#property-panel a.macro-property-panel-Grey span.icon,#property-panel a.macro-property-panel-Red span.icon,#property-panel a.macro-property-panel-Yellow span.icon{display:inline-block;background-image:none;margin:0;border:0;min-width:auto;border-radius:3px;width:16px;height:16px}.editor-inline-macro[data-macro-name=status]{background:transparent;border:0;min-height:16px;margin:0;vertical-align:-4px}#property-panel .editable.status-macro-title{margin-right:10px;float:none;text-transform:uppercase;text-decoration:none;width:88px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-size:11px;padding:0 5px}#property-panel input.editable.status-macro-title{outline:none;height:30px;line-height:20px;vertical-align:bottom;padding-top:2px}",""])},"./node_modules/css-loader/dist/runtime/api.js":function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var o=(a=r,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),i=r.sources.map((function(e){return"/*# sourceURL="+r.sourceRoot+e+" */"}));return[n].concat(i).concat([o]).join("\n")}var a;return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n})).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];null!=i&&(r[i]=!0)}for(o=0;o<e.length;o++){var a=e[o];null!=a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},"./node_modules/process/browser.js":function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var s,l=[],u=!1,d=-1;function f(){u&&s&&(u=!1,s.length?l=s.concat(l):d=-1,l.length&&m())}function m(){if(!u){var e=c(f);u=!0;for(var t=l.length;t;){for(s=l,l=[];++d<t;)s&&s[d].run();d=-1,t=l.length}s=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||u||c(m)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},"./node_modules/querystring-es3/decode.js":function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,i){t=t||"&",n=n||"=";var a={};if("string"!=typeof e||0===e.length)return a;var c=/\+/g;e=e.split(t);var s=1e3;i&&"number"==typeof i.maxKeys&&(s=i.maxKeys);var l=e.length;s>0&&l>s&&(l=s);for(var u=0;u<l;++u){var d,f,m,p,g=e[u].replace(c,"%20"),h=g.indexOf(n);h>=0?(d=g.substr(0,h),f=g.substr(h+1)):(d=g,f=""),m=decodeURIComponent(d),p=decodeURIComponent(f),r(a,m)?o(a[m])?a[m].push(p):a[m]=[a[m],p]:a[m]=p}return a};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},"./node_modules/querystring-es3/encode.js":function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,c){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?i(a(e),(function(a){var c=encodeURIComponent(r(a))+n;return o(e[a])?i(e[a],(function(e){return c+encodeURIComponent(r(e))})).join(t):c+encodeURIComponent(r(e[a]))})).join(t):c?encodeURIComponent(r(c))+n+encodeURIComponent(r(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function i(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var a=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},"./node_modules/querystring-es3/index.js":function(e,t,n){"use strict";t.decode=t.parse=n("./node_modules/querystring-es3/decode.js"),t.encode=t.stringify=n("./node_modules/querystring-es3/encode.js")},"./node_modules/setimmediate/setImmediate.js":function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var r,o,i,a,c,s=1,l={},u=!1,d=e.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(e);f=f&&f.setTimeout?f:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){p(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){p(e.data)},r=function(e){i.port2.postMessage(e)}):d&&"onreadystatechange"in d.createElement("script")?(o=d.documentElement,r=function(e){var t=d.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,o.removeChild(t),t=null},o.appendChild(t)}):r=function(e){setTimeout(p,0,e)}:(a="setImmediate$"+Math.random()+"$",c=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&p(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",c,!1):e.attachEvent("onmessage",c),r=function(t){e.postMessage(a+t,"*")}),f.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var o={callback:e,args:t};return l[s]=o,r(s),s++},f.clearImmediate=m}function m(e){delete l[e]}function p(e){if(u)setTimeout(p,0,e);else{var t=l[e];if(t){u=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(n,r)}}(t)}finally{m(e),u=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n("./node_modules/webpack/buildin/global.js"),n("./node_modules/process/browser.js"))},"./node_modules/style-loader/lib/addStyles.js":function(e,t,n){var r,o,i={},a=(r=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===o&&(o=r.apply(this,arguments)),o}),c=function(e,t){return t?t.querySelector(e):document.querySelector(e)},s=function(e){var t={};return function(e,n){if("function"==typeof e)return e();if(void 0===t[e]){var r=c.call(this,e,n);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}}(),l=null,u=0,d=[],f=n("./node_modules/style-loader/lib/urls.js");function m(e,t){for(var n=0;n<e.length;n++){var r=e[n],o=i[r.id];if(o){o.refs++;for(var a=0;a<o.parts.length;a++)o.parts[a](r.parts[a]);for(;a<r.parts.length;a++)o.parts.push(y(r.parts[a],t))}else{var c=[];for(a=0;a<r.parts.length;a++)c.push(y(r.parts[a],t));i[r.id]={id:r.id,refs:1,parts:c}}}}function p(e,t){for(var n=[],r={},o=0;o<e.length;o++){var i=e[o],a=t.base?i[0]+t.base:i[0],c={css:i[1],media:i[2],sourceMap:i[3]};r[a]?r[a].parts.push(c):n.push(r[a]={id:a,parts:[c]})}return n}function g(e,t){var n=s(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=d[d.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),d.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var o=s(e.insertAt.before,n);n.insertBefore(t,o)}}function h(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=d.indexOf(e);t>=0&&d.splice(t,1)}function v(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var r=function(){0;return n.nc}();r&&(e.attrs.nonce=r)}return b(t,e.attrs),g(e,t),t}function b(e,t){Object.keys(t).forEach((function(n){e.setAttribute(n,t[n])}))}function y(e,t){var n,r,o,i;if(t.transform&&e.css){if(!(i="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=i}if(t.singleton){var a=u++;n=l||(l=v(t)),r=x.bind(null,n,a,!1),o=x.bind(null,n,a,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",b(t,e.attrs),g(e,t),t}(t),r=T.bind(null,n,t),o=function(){h(n),n.href&&URL.revokeObjectURL(n.href)}):(n=v(t),r=k.bind(null,n),o=function(){h(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=a()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var n=p(e,t);return m(n,t),function(e){for(var r=[],o=0;o<n.length;o++){var a=n[o];(c=i[a.id]).refs--,r.push(c)}e&&m(p(e,t),t);for(o=0;o<r.length;o++){var c;if(0===(c=r[o]).refs){for(var s=0;s<c.parts.length;s++)c.parts[s]();delete i[c.id]}}}};var C,w=(C=[],function(e,t){return C[e]=t,C.filter(Boolean).join("\n")});function x(e,t,n,r){var o=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=w(t,o);else{var i=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}function k(e,t){var n=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function T(e,t,n){var r=n.css,o=n.sourceMap,i=void 0===t.convertToAbsoluteUrls&&o;(t.convertToAbsoluteUrls||i)&&(r=f(r)),o&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var a=new Blob([r],{type:"text/css"}),c=e.href;e.href=URL.createObjectURL(a),c&&URL.revokeObjectURL(c)}},"./node_modules/style-loader/lib/urls.js":function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,r=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var o,i=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(i)?e:(o=0===i.indexOf("//")?i:0===i.indexOf("/")?n+i:r+i.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")}))}},"./node_modules/timers-browserify/main.js":function(e,t,n){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new i(o.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new i(o.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n("./node_modules/setimmediate/setImmediate.js"),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/tinymce/plugins/lists/index.js":function(e,t,n){n("./node_modules/tinymce/plugins/lists/plugin.js")},"./node_modules/tinymce/plugins/lists/plugin.js":function(e,t){!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),n=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),r=tinymce.util.Tools.resolve("tinymce.util.VK"),o=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager"),i=tinymce.util.Tools.resolve("tinymce.util.Tools"),a=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),c=function(e){return e&&"BR"===e.nodeName},s=function(e){return e&&3===e.nodeType},l=function(e){return e&&/^(OL|UL|DL)$/.test(e.nodeName)},u=function(e){return e&&/^(LI|DT|DD)$/.test(e.nodeName)},d=function(e){return e&&/^(TH|TD)$/.test(e.nodeName)},f=c,m=function(e){return e.parentNode.firstChild===e},p=function(e){return e.parentNode.lastChild===e},g=function(e,t){return t&&!!e.schema.getTextBlockElements()[t.nodeName]},h=function(e,t){return e&&e.nodeName in t},v=function(e,t){return!!c(t)&&!(!e.isBlock(t.nextSibling)||c(t.previousSibling))},b=function(e,t,n){var r=e.isEmpty(t);return!(n&&e.select("span[data-mce-type=bookmark]",t).length>0)&&r},y=function(e,t){return e.isChildOf(t,e.getRoot())},C=function(e,n){var r=t.getNode(e,n);return u(e)&&s(r)?{container:r,offset:n>=e.childNodes.length?r.data.length:0}:{container:e,offset:n}},w=function(e){var t=e.cloneRange(),n=C(e.startContainer,e.startOffset);t.setStart(n.container,n.offset);var r=C(e.endContainer,e.endOffset);return t.setEnd(r.container,r.offset),t},x=a.DOM,k=function(e){var t={},n=function(n){var r,o,i;o=e[n?"startContainer":"endContainer"],i=e[n?"startOffset":"endOffset"],1===o.nodeType&&(r=x.create("span",{"data-mce-type":"bookmark"}),o.hasChildNodes()?(i=Math.min(i,o.childNodes.length-1),n?o.insertBefore(r,o.childNodes[i]):x.insertAfter(r,o.childNodes[i])):o.appendChild(r),o=r,i=0),t[n?"startContainer":"endContainer"]=o,t[n?"startOffset":"endOffset"]=i};return n(!0),e.collapsed||n(),t},T=function(e){function t(t){var n,r,o;n=o=e[t?"startContainer":"endContainer"],r=e[t?"startOffset":"endOffset"],n&&(1===n.nodeType&&(r=function(e){for(var t=e.parentNode.firstChild,n=0;t;){if(t===e)return n;1===t.nodeType&&"bookmark"===t.getAttribute("data-mce-type")||n++,t=t.nextSibling}return-1}(n),n=n.parentNode,x.remove(o),!n.hasChildNodes()&&x.isBlock(n)&&n.appendChild(x.create("br"))),e[t?"startContainer":"endContainer"]=n,e[t?"startOffset":"endOffset"]=r)}t(!0),t();var n=x.createRng();return n.setStart(e.startContainer,e.startOffset),e.endContainer&&n.setEnd(e.endContainer,e.endOffset),w(n)},E=a.DOM,S=function(e,t){var n,r=t.parentNode;"LI"===r.nodeName&&r.firstChild===t&&((n=r.previousSibling)&&"LI"===n.nodeName?(n.appendChild(t),b(e,r)&&E.remove(r)):E.setStyle(r,"listStyleType","none")),l(r)&&(n=r.previousSibling)&&"LI"===n.nodeName&&n.appendChild(t)},N=function(e,t){i.each(i.grep(e.select("ol,ul",t)),(function(t){S(e,t)}))},A=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),R=function(e){var t=e.selection.getStart(!0);return e.dom.getParent(t,"OL,UL,DL",_(e,t))},_=function(e,t){var n=e.dom.getParents(t,"TD,TH");return n.length>0?n[0]:e.getBody()},I={getParentList:R,getSelectedSubLists:function(e){var t=R(e),n=e.selection.getSelectedBlocks();return function(e,t){return e&&1===t.length&&t[0]===e}(t,n)?function(e){return i.grep(e.querySelectorAll("ol,ul,dl"),(function(e){return l(e)}))}(t):i.grep(n,(function(e){return l(e)&&t!==e}))},getSelectedListItems:function(e){var t=e.selection.getSelectedBlocks();return i.grep(function(e,t){var n=i.map(t,(function(t){var n=e.dom.getParent(t,"li,dd,dt",_(e,t));return n||t}));return A.unique(n)}(e,t),(function(e){return u(e)}))},getClosestListRootElm:_},B=tinymce.util.Tools.resolve("tinymce.Env"),P=a.DOM,D=function(e,t,n){var r,o,i,a=P.createFragment(),c=e.schema.getBlockElements();if(e.settings.forced_root_block&&(n=n||e.settings.forced_root_block),n&&((o=P.create(n)).tagName===e.settings.forced_root_block&&P.setAttribs(o,e.settings.forced_root_block_attrs),h(t.firstChild,c)||a.appendChild(o)),t)for(;r=t.firstChild;){var s=r.nodeName;i||"SPAN"===s&&"bookmark"===r.getAttribute("data-mce-type")||(i=!0),h(r,c)?(a.appendChild(r),o=null):n?(o||(o=P.create(n),a.appendChild(o)),o.appendChild(r)):a.appendChild(r)}return e.settings.forced_root_block?i||B.ie&&!(B.ie>10)||o.appendChild(P.create("br",{"data-mce-bogus":"1"})):a.appendChild(P.create("br")),a},O=a.DOM,M=function(e,t,n,r){var o,a,c,s,l;for(c=O.select('span[data-mce-type="bookmark"]',t),r=r||D(e,n),(o=O.createRng()).setStartAfter(n),o.setEndAfter(t),s=(a=o.extractContents()).firstChild;s;s=s.firstChild)if("LI"===s.nodeName&&e.dom.isEmpty(s)){O.remove(s);break}e.dom.isEmpty(a)||O.insertAfter(a,t),O.insertAfter(r,t),b(e.dom,n.parentNode)&&(l=n.parentNode,i.each(c,(function(e){l.parentNode.insertBefore(e,n.parentNode)})),O.remove(l)),O.remove(n),b(e.dom,t)&&O.remove(t)},L=a.DOM,F=function(e,t){b(e,t)&&L.remove(t)},j=function(e,t){var n,r,o=t.parentNode;return o?(n=o.parentNode,!(o!==e.getBody()&&("DD"===t.nodeName?(L.rename(t,"DT"),0):m(t)&&p(t)?("LI"===n.nodeName?(L.insertAfter(t,n),F(e.dom,n),L.remove(o)):l(n)?L.remove(o,!0):(n.insertBefore(D(e,t),o),L.remove(o)),0):m(t)?("LI"===n.nodeName?(L.insertAfter(t,n),t.appendChild(o),F(e.dom,n)):l(n)?n.insertBefore(t,o):(n.insertBefore(D(e,t),o),L.remove(t)),0):p(t)?("LI"===n.nodeName?L.insertAfter(t,n):l(n)?L.insertAfter(t,o):(L.insertAfter(D(e,t),o),L.remove(t)),0):("LI"===n.nodeName?(o=n,r=D(e,t,"LI")):r=l(n)?D(e,t,"LI"):D(e,t),M(e,o,t,r),N(e.dom,o.parentNode),0)))):(F(e.dom,t),!0)},H=j,U=function(e){var t=I.getSelectedListItems(e);if(t.length){var n=k(e.selection.getRng()),r=void 0,o=void 0,i=I.getClosestListRootElm(e,e.selection.getStart(!0));for(r=t.length;r--;)for(var a=t[r].parentNode;a&&a!==i;){for(o=t.length;o--;)if(t[o]===a){t.splice(r,1);break}a=a.parentNode}for(r=0;r<t.length&&(j(e,t[r])||0!==r);r++);return e.selection.setRng(T(n)),e.nodeChanged(),!0}},W=function(e,t){i.each(t,(function(t,n){e.setAttribute(n,t)}))},z=function(e,t,n){!function(e,t,n){var r=n["list-style-type"]?n["list-style-type"]:null;e.setStyle(t,"list-style-type",r)}(e,t,n),function(e,t,n){W(t,n["list-attributes"]),i.each(e.select("li",t),(function(e){W(e,n["list-item-attributes"])}))}(e,t,n)},q=function(e,t,n,r){var o,i;for(o=t[n?"startContainer":"endContainer"],i=t[n?"startOffset":"endOffset"],1===o.nodeType&&(o=o.childNodes[Math.min(i,o.childNodes.length-1)]||o),!n&&f(o.nextSibling)&&(o=o.nextSibling);o.parentNode!==r;){if(g(e,o))return o;if(/^(TD|TH)$/.test(o.parentNode.nodeName))return o;o=o.parentNode}return o},V=function(e,t,n){void 0===n&&(n={});var r,a=e.selection.getRng(!0),c="LI",s=I.getClosestListRootElm(e,e.selection.getStart(!0)),u=e.dom;"false"!==u.getContentEditable(e.selection.getNode())&&("DL"===(t=t.toUpperCase())&&(c="DT"),r=k(a),i.each(function(e,t,n){for(var r,a=[],c=e.dom,s=q(e,t,!0,n),l=q(e,t,!1,n),u=[],d=s;d&&(u.push(d),d!==l);d=d.nextSibling);return i.each(u,(function(t){if(g(e,t))return a.push(t),void(r=null);if(c.isBlock(t)||f(t))return f(t)&&c.remove(t),void(r=null);var i=t.nextSibling;o.isBookmarkNode(t)&&(g(e,i)||!i&&t.parentNode===n)?r=null:(r||(r=c.create("p"),t.parentNode.insertBefore(r,t),a.push(r)),r.appendChild(t))})),a}(e,a,s),(function(r){var o,a;(a=r.previousSibling)&&l(a)&&a.nodeName===t&&function(e,t,n){var r=e.getStyle(t,"list-style-type"),o=n?n["list-style-type"]:"";return r===(o=null===o?"":o)}(u,a,n)?(o=a,r=u.rename(r,c),a.appendChild(r)):(o=u.create(t),r.parentNode.insertBefore(o,r),o.appendChild(r),r=u.rename(r,c)),function(e,t,n){i.each(n,(function(n){return e.setStyle(t,((r={})[n]="",r));var r}))}(u,r,["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"]),z(u,o,n),J(e.dom,o)})),e.selection.setRng(T(r)))},$=function(e){var t=k(e.selection.getRng(!0)),n=I.getClosestListRootElm(e,e.selection.getStart(!0)),r=I.getSelectedListItems(e),o=i.grep(r,(function(t){return e.dom.isEmpty(t)}));r=i.grep(r,(function(t){return!e.dom.isEmpty(t)})),i.each(o,(function(t){b(e.dom,t)&&H(e,t)})),i.each(r,(function(t){var r,o;if(t.parentNode!==e.getBody()){for(r=t;r&&r!==n;r=r.parentNode)l(r)&&(o=r);M(e,o,t),N(e.dom,o.parentNode)}})),e.selection.setRng(T(t))},K=function(e,t,n){return function(e,t){return e&&t&&l(e)&&e.nodeName===t.nodeName}(t,n)&&function(e,t,n){return e.getStyle(t,"list-style-type",!0)===e.getStyle(n,"list-style-type",!0)}(e,t,n)&&(r=n,t.className===r.className);var r},J=function(e,t){var n,r;if(n=t.nextSibling,K(e,t,n)){for(;r=n.firstChild;)t.appendChild(r);e.remove(n)}if(n=t.previousSibling,K(e,t,n)){for(;r=n.lastChild;)t.insertBefore(r,t.firstChild);e.remove(n)}},G=function(e,t,n,r,o){if(t.nodeName!==r||X(o)){var a=k(e.selection.getRng(!0));i.each([t].concat(n),(function(t){!function(e,t,n,r){if(t.nodeName!==n){var o=e.rename(t,n);z(e,o,r)}else z(e,t,r)}(e.dom,t,r,o)})),e.selection.setRng(T(a))}else $(e)},X=function(e){return"list-style-type"in e},Y={toggleList:function(e,t,n){var r=I.getParentList(e),o=I.getSelectedSubLists(e);n=n||{},r&&o.length>0?G(e,r,o,t,n):function(e,t,n,r){if(t!==e.getBody())if(t)if(t.nodeName!==n||X(r)){var o=k(e.selection.getRng(!0));z(e.dom,t,r),J(e.dom,e.dom.rename(t,n)),e.selection.setRng(T(o))}else $(e);else V(e,n,r)}(e,r,t,n)},removeList:$,mergeWithAdjacentLists:J},Q=function(e,r,o,i){var a,c,s=r.startContainer,l=r.startOffset;if(3===s.nodeType&&(o?l<s.data.length:l>0))return s;for(a=e.schema.getNonEmptyElements(),1===s.nodeType&&(s=t.getNode(s,l)),c=new n(s,i),o&&v(e.dom,s)&&c.next();s=c[o?"next":"prev2"]();){if("LI"===s.nodeName&&!s.hasChildNodes())return s;if(a[s.nodeName])return s;if(3===s.nodeType&&s.data.length>0)return s}},Z=function(e,t){var n=t.childNodes;return 1===n.length&&!l(n[0])&&e.isBlock(n[0])},ee=function(e,t,n){var r,o;if(o=Z(e,n)?n.firstChild:n,function(e,t){Z(e,t)&&e.remove(t.firstChild,!0)}(e,t),!b(e,t,!0))for(;r=t.firstChild;)o.appendChild(r)},te=function(e,t,n){var r,o,i=t.parentNode;y(e,t)&&y(e,n)&&(l(n.lastChild)&&(o=n.lastChild),i===n.lastChild&&f(i.previousSibling)&&e.remove(i.previousSibling),(r=n.lastChild)&&f(r)&&t.hasChildNodes()&&e.remove(r),b(e,n,!0)&&e.$(n).empty(),ee(e,t,n),o&&n.appendChild(o),e.remove(t),b(e,i)&&i!==e.getRoot()&&e.remove(i))},ne=function(e,t,n,r){var o=e.dom;if(o.isEmpty(r))!function(e,t,n){e.dom.$(n).empty(),te(e.dom,t,n),e.selection.setCursorLocation(n)}(e,n,r);else{var i=k(t);te(o,n,r),e.selection.setRng(T(i))}},re=function(e,t){var n,r,o,i=e.dom,a=e.selection,c=a.getStart(),s=I.getClosestListRootElm(e,c),l=i.getParent(a.getStart(),"LI",s);if(l){if((n=l.parentNode)===e.getBody()&&b(i,n))return!0;if(r=w(a.getRng(!0)),(o=i.getParent(Q(e,r,t,s),"LI",s))&&o!==l)return t?ne(e,r,o,l):function(e,t,n,r){var o=k(t);te(e.dom,n,r);var i=T(o);e.selection.setRng(i)}(e,r,l,o),!0;if(!o&&!t&&Y.removeList(e))return!0}return!1},oe=function(e,t){return re(e,t)||function(e,t){var n=e.dom,r=e.selection.getStart(),o=I.getClosestListRootElm(e,r),i=n.getParent(r,n.isBlock,o);if(i&&n.isEmpty(i)){var a=w(e.selection.getRng(!0)),c=n.getParent(Q(e,a,t,o),"LI",o);if(c)return e.undoManager.transact((function(){!function(e,t,n){var r=e.getParent(t.parentNode,e.isBlock,n);e.remove(t),r&&e.isEmpty(r)&&e.remove(r)}(n,i,o),Y.mergeWithAdjacentLists(n,c.parentNode),e.selection.select(c,!0),e.selection.collapse(t)})),!0}return!1}(e,t)},ie=function(e,t){return e.selection.isCollapsed()?oe(e,t):function(e){var t=e.selection.getStart(),n=I.getClosestListRootElm(e,t);return!!(e.dom.getParent(t,"LI,DT,DD",n)||I.getSelectedListItems(e).length>0)&&(e.undoManager.transact((function(){e.execCommand("Delete"),N(e.dom,e.getBody())})),!0)}(e)},ae=function(e){e.on("keydown",(function(t){t.keyCode===r.BACKSPACE?ie(e,!1)&&t.preventDefault():t.keyCode===r.DELETE&&ie(e,!0)&&t.preventDefault()}))},ce=ie,se=function(e){return{backspaceDelete:function(t){ce(e,t)}}},le=a.DOM,ue=function(e,t){var n;if(l(e)){for(;n=e.firstChild;)t.appendChild(n);le.remove(e)}},de=function(e){var t,n,r,o,i=I.getSelectedListItems(e);if(i.length){for(var a=k(e.selection.getRng(!0)),c=0;c<i.length&&(t=i[c],n=void 0,r=void 0,o=void 0,("DT"===t.nodeName?(le.rename(t,"DD"),1):(n=t.previousSibling)&&l(n)?(n.appendChild(t),1):n&&"LI"===n.nodeName&&l(n.lastChild)?(n.lastChild.appendChild(t),ue(t.lastChild,n.lastChild),1):(n=t.nextSibling)&&l(n)?(n.insertBefore(t,n.firstChild),1):(n=t.previousSibling)&&"LI"===n.nodeName&&(r=le.create(t.parentNode.nodeName),(o=le.getStyle(t.parentNode,"listStyleType"))&&le.setStyle(r,"listStyleType",o),n.appendChild(r),r.appendChild(t),ue(t.lastChild,r),1))||0!==c);c++);return e.selection.setRng(T(a)),e.nodeChanged(),!0}},fe=function(e,t){return function(){var n=e.dom.getParent(e.selection.getStart(),"UL,OL,DL");return n&&n.nodeName===t}},me=function(e){e.on("BeforeExecCommand",(function(t){var n,r=t.command.toLowerCase();if("indent"===r?de(e)&&(n=!0):"outdent"===r&&U(e)&&(n=!0),n)return e.fire("ExecCommand",{command:t.command}),t.preventDefault(),!0})),e.addCommand("InsertUnorderedList",(function(t,n){Y.toggleList(e,"UL",n)})),e.addCommand("InsertOrderedList",(function(t,n){Y.toggleList(e,"OL",n)})),e.addCommand("InsertDefinitionList",(function(t,n){Y.toggleList(e,"DL",n)})),e.addQueryStateHandler("InsertUnorderedList",fe(e,"UL")),e.addQueryStateHandler("InsertOrderedList",fe(e,"OL")),e.addQueryStateHandler("InsertDefinitionList",fe(e,"DL"))},pe=function(e){return e.getParam("lists_indent_on_tab",!0)},ge=function(e){pe(e)&&function(e){e.on("keydown",(function(t){t.keyCode!==r.TAB||r.metaKeyPressed(t)||e.dom.getParent(e.selection.getStart(),"LI,DT,DD")&&(t.preventDefault(),t.shiftKey?U(e):de(e))}))}(e),ae(e)},he=function(e,t){return function(n){var r=n.control;e.on("NodeChange",(function(e){var n=function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return n;return-1}(e.parents,d),o=-1!==n?e.parents.slice(0,n):e.parents,a=i.grep(o,l);r.active(a.length>0&&a[0].nodeName===t)}))}},ve=function(e){return function(t){var n=t.control;e.on("nodechange",(function(){var t=I.getSelectedListItems(e),r=t.length>0&&m(t[0]);n.disabled(r)}))}},be=function(e){(function(e,t){var n=e.settings.plugins?e.settings.plugins:"";return-1!==i.inArray(n.split(/[ ,]/),t)})(e,"advlist")||(e.addButton("numlist",{active:!1,title:"Numbered list",cmd:"InsertOrderedList",onPostRender:he(e,"OL")}),e.addButton("bullist",{active:!1,title:"Bullet list",cmd:"InsertUnorderedList",onPostRender:he(e,"UL")})),e.addButton("indent",{icon:"indent",title:"Increase indent",cmd:"Indent",onPostRender:ve(e)})};e.add("lists",(function(e){return ge(e),be(e),me(e),se(e)}))}()},"./node_modules/tinymce/plugins/paste/index.js":function(e,t,n){n("./node_modules/tinymce/plugins/paste/plugin.js")},"./node_modules/tinymce/plugins/paste/plugin.js":function(e,t){!function(){"use strict";var e=function(t){var n=t,r=function(){return n};return{get:r,set:function(e){n=e},clone:function(){return e(r())}}},t=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=function(e){return!(!/(^|[ ,])powerpaste([, ]|$)/.test(e.settings.plugins)||!t.get("powerpaste")||(void 0!==window.console&&window.console.log&&window.console.log("PowerPaste is incompatible with Paste plugin! Remove 'paste' from the 'plugins' option."),0))},r=function(e,t){return{clipboard:e,quirks:t}},o=function(e,t,n,r){return e.fire("PastePreProcess",{content:t,internal:n,wordContent:r})},i=function(e,t,n,r){return e.fire("PastePostProcess",{node:t,internal:n,wordContent:r})},a=function(e,t){return e.fire("PastePlainTextToggle",{state:t})},c=function(e,t){return e.fire("paste",{ieFake:t})},s={shouldPlainTextInform:function(e){return e.getParam("paste_plaintext_inform",!0)},shouldBlockDrop:function(e){return e.getParam("paste_block_drop",!1)},shouldPasteDataImages:function(e){return e.getParam("paste_data_images",!1)},shouldFilterDrop:function(e){return e.getParam("paste_filter_drop",!0)},getPreProcess:function(e){return e.getParam("paste_preprocess")},getPostProcess:function(e){return e.getParam("paste_postprocess")},getWebkitStyles:function(e){return e.getParam("paste_webkit_styles")},shouldRemoveWebKitStyles:function(e){return e.getParam("paste_remove_styles_if_webkit",!0)},shouldMergeFormats:function(e){return e.getParam("paste_merge_formats",!0)},isSmartPasteEnabled:function(e){return e.getParam("smart_paste",!0)},isPasteAsTextEnabled:function(e){return e.getParam("paste_as_text",!1)},getRetainStyleProps:function(e){return e.getParam("paste_retain_style_properties")},getWordValidElements:function(e){return e.getParam("paste_word_valid_elements","-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody")},shouldConvertWordFakeLists:function(e){return e.getParam("paste_convert_word_fake_lists",!0)},shouldUseDefaultFilters:function(e){return e.getParam("paste_enable_default_filters",!0)}},l=function(e,t,n){"text"===t.pasteFormat.get()?(t.pasteFormat.set("html"),a(e,!1)):(t.pasteFormat.set("text"),a(e,!0),function(e,t){return!1===t.get()&&s.shouldPlainTextInform(e)}(e,n)&&(function(e,t){e.notificationManager.open({text:e.translate(t),type:"info"})}(e,"Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off."),n.set(!0))),e.focus()},u=function(e,t,n){e.addCommand("mceTogglePlainTextPaste",(function(){l(e,t,n)})),e.addCommand("mceInsertClipboardContent",(function(e,n){n.content&&t.pasteHtml(n.content,n.internal),n.text&&t.pasteText(n.text)}))},d=tinymce.util.Tools.resolve("tinymce.Env"),f=tinymce.util.Tools.resolve("tinymce.util.Delay"),m=tinymce.util.Tools.resolve("tinymce.util.Tools"),p=tinymce.util.Tools.resolve("tinymce.util.VK"),g="\x3c!-- x-tinymce/html --\x3e",h={mark:function(e){return g+e},unmark:function(e){return e.replace(g,"")},isMarked:function(e){return-1!==e.indexOf(g)},internalHtmlMime:function(){return"x-tinymce/html"}},v=tinymce.util.Tools.resolve("tinymce.html.Entities"),b=function(e){return e.replace(/\r?\n/g,"<br>")},y=function(e,t,n){var r=e.split(/\n\n/),o=function(e,t){var n,r=[],o="<"+e;if("object"==typeof t){for(n in t)t.hasOwnProperty(n)&&r.push(n+'="'+v.encodeAllRaw(t[n])+'"');r.length&&(o+=" "+r.join(" "))}return o+">"}(t,n),i="</"+t+">",a=m.map(r,(function(e){return e.split(/\n/).join("<br />")}));return 1===a.length?a[0]:m.map(a,(function(e){return o+e+i})).join("")},C={isPlainText:function(e){return!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(e)},convert:function(e,t,n){return t?y(e,t,n):b(e)},toBRs:b,toBlockElements:y},w=tinymce.util.Tools.resolve("tinymce.html.DomParser"),x=tinymce.util.Tools.resolve("tinymce.html.Node"),k=tinymce.util.Tools.resolve("tinymce.html.Schema"),T=tinymce.util.Tools.resolve("tinymce.html.Serializer");function E(e,t){return m.each(t,(function(t){e=t.constructor===RegExp?e.replace(t,""):e.replace(t[0],t[1])})),e}var S={filter:E,innerText:function(e){var t=k(),n=w({},t),r="",o=t.getShortEndedElements(),i=m.makeMap("script noscript style textarea video audio iframe object"," "),a=t.getBlockElements();return e=E(e,[/<!\[[^\]]+\]>/g]),function e(t){var n=t.name,c=t;if("br"!==n)if(o[n]&&(r+=" "),i[n])r+=" ";else{if(3===t.type&&(r+=t.value),!t.shortEnded&&(t=t.firstChild))do{e(t)}while(t=t.next);a[n]&&c.next&&(r+="\n","p"===n&&(r+="\n"))}else r+="\n"}(n.parse(e)),r},trimHtml:function(e){return e=E(e,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,function(e,t,n){return t||n?" ":" "}],/<br class="Apple-interchange-newline">/g,/<br>$/i])},createIdGenerator:function(e){var t=0;return function(){return e+t++}},isMsEdge:function(){return-1!==navigator.userAgent.indexOf(" Edge/")}};function N(e){var t,n;return n=[/^[IVXLMCD]{1,2}\.[ \u00a0]/,/^[ivxlmcd]{1,2}\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/],e=e.replace(/^[\u00a0 ]+/,""),m.each(n,(function(n){if(n.test(e))return t=!0,!1})),t}function A(e){var t,n,r=1;function o(e){var t="";if(3===e.type)return e.value;if(e=e.firstChild)do{t+=o(e)}while(e=e.next);return t}function i(e,t){if(3===e.type&&t.test(e.value))return e.value=e.value.replace(t,""),!1;if(e=e.firstChild)do{if(!i(e,t))return!1}while(e=e.next);return!0}function a(e,o,a){var c=e._listLevel||r;c!==r&&(c<r?t&&(t=t.parent.parent):(n=t,t=null)),t&&t.name===o?t.append(e):(n=n||t,t=new x(o,1),a>1&&t.attr("start",""+a),e.wrap(t)),e.name="li",c>r&&n&&n.lastChild.append(t),r=c,function e(t){if(t._listIgnore)t.remove();else if(t=t.firstChild)do{e(t)}while(t=t.next)}(e),i(e,/^\u00a0+/),i(e,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/),i(e,/^\u00a0+/)}for(var c=[],s=e.firstChild;null!=s;)if(c.push(s),null!==(s=s.walk()))for(;void 0!==s&&s.parent!==e;)s=s.walk();for(var l=0;l<c.length;l++)if("p"===(e=c[l]).name&&e.firstChild){var u=o(e);if(/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(u)){a(e,"ul");continue}if(N(u)){var d=/([0-9]+)\./.exec(u),f=1;d&&(f=parseInt(d[1],10)),a(e,"ol",f);continue}if(e._listLevel){a(e,"ul",1);continue}t=null}else n=t,t=null}function R(e,t,n,r){var o,i={},a=e.dom.parseStyle(r);return m.each(a,(function(a,c){switch(c){case"mso-list":(o=/\w+ \w+([0-9]+)/i.exec(r))&&(n._listLevel=parseInt(o[1],10)),/Ignore/i.test(a)&&n.firstChild&&(n._listIgnore=!0,n.firstChild._listIgnore=!0);break;case"horiz-align":c="text-align";break;case"vert-align":c="vertical-align";break;case"font-color":case"mso-foreground":c="color";break;case"mso-background":case"mso-highlight":c="background";break;case"font-weight":case"font-style":return void("normal"!==a&&(i[c]=a));case"mso-element":if(/^(comment|comment-list)$/i.test(a))return void n.remove()}0!==c.indexOf("mso-comment")?0!==c.indexOf("mso-")&&("all"===s.getRetainStyleProps(e)||t&&t[c])&&(i[c]=a):n.remove()})),/(bold)/i.test(i["font-weight"])&&(delete i["font-weight"],n.wrap(new x("b",1))),/(italic)/i.test(i["font-style"])&&(delete i["font-style"],n.wrap(new x("i",1))),(i=e.dom.serializeStyle(i,n.name))||null}var _={preProcess:function(e,t){return s.shouldUseDefaultFilters(e)?function(e,t){var n,r;(n=s.getRetainStyleProps(e))&&(r=m.makeMap(n.split(/[, ]/))),t=S.filter(t,[/<br class="?Apple-interchange-newline"?>/gi,/<b[^>]+id="?docs-internal-[^>]*>/gi,/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi," "],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(e,t){return t.length>0?t.replace(/./," ").slice(Math.floor(t.length/2)).split("").join(" "):""}]]);var o=s.getWordValidElements(e),i=k({valid_elements:o,valid_children:"-li[p]"});m.each(i.elements,(function(e){e.attributes.class||(e.attributes.class={},e.attributesOrder.push("class")),e.attributes.style||(e.attributes.style={},e.attributesOrder.push("style"))}));var a=w({},i);a.addAttributeFilter("style",(function(t){for(var n,o=t.length;o--;)(n=t[o]).attr("style",R(e,r,n,n.attr("style"))),"span"===n.name&&n.parent&&!n.attributes.length&&n.unwrap()})),a.addAttributeFilter("class",(function(e){for(var t,n,r=e.length;r--;)n=(t=e[r]).attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(n)&&t.remove(),t.attr("class",null)})),a.addNodeFilter("del",(function(e){for(var t=e.length;t--;)e[t].remove()})),a.addNodeFilter("a",(function(e){for(var t,n,r,o=e.length;o--;)if(n=(t=e[o]).attr("href"),r=t.attr("name"),n&&-1!==n.indexOf("#_msocom_"))t.remove();else if(n&&0===n.indexOf("file://")&&(n=n.split("#")[1])&&(n="#"+n),n||r){if(r&&!/^_?(?:toc|edn|ftn)/i.test(r)){t.unwrap();continue}t.attr({href:n,name:r})}else t.unwrap()}));var c=a.parse(t);return s.shouldConvertWordFakeLists(e)&&A(c),t=T({validate:e.settings.validate},i).serialize(c)}(e,t):t},isWordContent:function(e){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(e)||/class="OutlineElement/.test(e)||/id="?docs\-internal\-guid\-/.test(e)}},I=function(e,t){return{content:e,cancelled:t}},B=function(e,t,n,r){var a=o(e,t,n,r);return e.hasEventListeners("PastePostProcess")&&!a.isDefaultPrevented()?function(e,t,n,r){var o=e.dom.create("div",{style:"display:none"},t),a=i(e,o,n,r);return I(a.node.innerHTML,a.isDefaultPrevented())}(e,a.content,n,r):I(a.content,a.isDefaultPrevented())},P=function(e,t,n){var r=_.isWordContent(t),o=r?_.preProcess(e,t):t;return B(e,o,n,r)},D=function(e,t){return e.insertContent(t,{merge:s.shouldMergeFormats(e),paste:!0}),!0},O=function(e){return/^https?:\/\/[\w\?\-\/+=.&%@~#]+$/i.test(e)},M=function(e){return O(e)&&/.(gif|jpe?g|png)$/.test(e)},L=function(e,t,n){return!(!1!==e.selection.isCollapsed()||!O(t))&&function(e,t,n){return e.undoManager.extra((function(){n(e,t)}),(function(){e.execCommand("mceInsertLink",!1,t)})),!0}(e,t,n)},F=function(e,t,n){return!!M(t)&&function(e,t,n){return e.undoManager.extra((function(){n(e,t)}),(function(){e.insertContent('<img src="'+t+'">')})),!0}(e,t,n)},j=function(e,t){!1===s.isSmartPasteEnabled(e)?D(e,t):function(e,t){m.each([L,F,D],(function(n){return!0!==n(e,t,D)}))}(e,t)},H=function(e,t,n){var r=n||h.isMarked(t),o=P(e,h.unmark(t),r);!1===o.cancelled&&j(e,o.content)},U=function(e,t){t=e.dom.encode(t).replace(/\r\n/g,"\n"),t=C.convert(t,e.settings.forced_root_block,e.settings.forced_root_block_attrs),H(e,t,!1)},W=function(e){var t={};if(e){if(e.getData){var n=e.getData("Text");n&&n.length>0&&-1===n.indexOf("data:text/mce-internal,")&&(t["text/plain"]=n)}if(e.types)for(var r=0;r<e.types.length;r++){var o=e.types[r];try{t[o]=e.getData(o)}catch(e){t[o]=""}}}return t},z=function(e,t){return t in e&&e[t].length>0},q=function(e){return z(e,"text/html")||z(e,"text/plain")},V=S.createIdGenerator("mceclip"),$=function(e,t,n,r){t&&(e.selection.setRng(t),t=null);var o,i,a,c,s=n.result,l=-1!==(i=(o=s).indexOf(","))?o.substr(i+1):null,u=V(),d=e.settings.images_reuse_filename&&r.name?function(e,t){var n=t.match(/([\s\S]+?)\.(?:jpeg|jpg|png|gif)$/i);return n?e.dom.encode(n[1]):null}(e,r.name):u,f=new Image;if(f.src=s,a=e.settings,c=f,!a.images_dataimg_filter||a.images_dataimg_filter(c)){var m,p=e.editorUpload.blobCache,g=void 0;(m=p.findFirst((function(e){return e.base64()===l})))?g=m:(g=p.create(u,r,l,d),p.add(g)),H(e,'<img src="'+g.blobUri()+'">',!1)}else H(e,'<img src="'+s+'">',!1)},K=function(e,t,n){var r="paste"===t.type?t.clipboardData:t.dataTransfer;function o(r){var o,i,a,c=!1;if(r)for(o=0;o<r.length;o++)if(i=r[o],/^image\/(jpeg|png|gif|bmp)$/.test(i.type)){var s=i.getAsFile?i.getAsFile():i;(a=new window.FileReader).onload=$.bind(null,e,n,a,s),a.readAsDataURL(s),t.preventDefault(),c=!0}return c}if(e.settings.paste_data_images&&r)return o(r.items)||o(r.files)},J=function(e){return p.metaKeyPressed(e)&&86===e.keyCode||e.shiftKey&&45===e.keyCode},G=function(e,t,n){var r,o=0;function i(n,r,o,i){var a,c;z(n,"text/html")?a=n["text/html"]:(a=t.getHtml(),i=i||h.isMarked(a),t.isDefaultContent(a)&&(o=!0)),a=S.trimHtml(a),t.remove(),c=!1===i&&C.isPlainText(a),a.length&&!c||(o=!0),o&&(a=z(n,"text/plain")&&c?n["text/plain"]:S.innerText(a)),t.isDefaultContent(a)?r||e.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."):o?U(e,a):H(e,a,i)}e.on("keydown",(function(n){function i(e){J(e)&&!e.isDefaultPrevented()&&t.remove()}if(J(n)&&!n.isDefaultPrevented()){if((r=n.shiftKey&&86===n.keyCode)&&d.webkit&&-1!==navigator.userAgent.indexOf("Version/"))return;if(n.stopImmediatePropagation(),o=(new Date).getTime(),d.ie&&r)return n.preventDefault(),void c(e,!0);t.remove(),t.create(),e.once("keyup",i),e.once("paste",(function(){e.off("keyup",i)}))}})),e.on("paste",(function(a){var c=(new Date).getTime(),s=function(e,t){var n=W(t.clipboardData||e.getDoc().dataTransfer);return S.isMsEdge()?m.extend(n,{"text/html":""}):n}(e,a),l=(new Date).getTime()-c,u=(new Date).getTime()-o-l<1e3,p="text"===n.get()||r,g=z(s,h.internalHtmlMime());r=!1,a.isDefaultPrevented()||function(e){var t=e.clipboardData;return-1!==navigator.userAgent.indexOf("Android")&&t&&t.items&&0===t.items.length}(a)?t.remove():q(s)||!K(e,a,t.getLastRng()||e.selection.getRng())?(u||a.preventDefault(),!d.ie||u&&!a.ieFake||z(s,"text/html")||(t.create(),e.dom.bind(t.getEl(),"paste",(function(e){e.stopPropagation()})),e.getDoc().execCommand("Paste",!1,null),s["text/html"]=t.getHtml()),z(s,"text/html")?(a.preventDefault(),g||(g=h.isMarked(s["text/html"])),i(s,u,p,g)):f.setEditorTimeout(e,(function(){i(s,u,p,g)}),0)):t.remove()}))},X=function(e){return d.ie&&e.inline?document.body:e.getBody()},Y=function(e,t){(function(e){return X(e)!==e.getBody()})(e)&&e.dom.bind(t,"paste keyup",(function(t){setTimeout((function(){e.fire("paste")}),0)}))},Q=function(e){return e.dom.get("mcepastebin")},Z=function(e,t){return t===e},ee=function(t){var n=e(null);return{create:function(){return function(e,t,n){var r,o=e.dom,i=e.getBody();t.set(e.selection.getRng()),r=e.dom.add(X(e),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},n),(d.ie||d.gecko)&&o.setStyle(r,"left","rtl"===o.getStyle(i,"direction",!0)?65535:-65535),o.bind(r,"beforedeactivate focusin focusout",(function(e){e.stopPropagation()})),Y(e,r),r.focus(),e.selection.select(r,!0)}(t,n,"%MCEPASTEBIN%")},remove:function(){return function(e,t){if(Q(e)){for(var n=void 0,r=t.get();n=e.dom.get("mcepastebin");)e.dom.remove(n),e.dom.unbind(n);r&&e.selection.setRng(r)}t.set(null)}(t,n)},getEl:function(){return Q(t)},getHtml:function(){return function(e){var t,n,r,o,i,a=function(t,n){t.appendChild(n),e.dom.remove(n,!0)};for(n=m.grep(X(e).childNodes,(function(e){return"mcepastebin"===e.id})),t=n.shift(),m.each(n,(function(e){a(t,e)})),r=(o=e.dom.select("div[id=mcepastebin]",t)).length-1;r>=0;r--)i=e.dom.create("div"),t.insertBefore(i,o[r]),a(i,o[r]);return t?t.innerHTML:""}(t)},getLastRng:function(){return function(e){return e.get()}(n)},isDefault:function(){return function(e,t){var n,r=Q(e);return(n=r)&&"mcepastebin"===n.id&&Z(t,r.innerHTML)}(t,"%MCEPASTEBIN%")},isDefaultContent:function(e){return Z("%MCEPASTEBIN%",e)}}},te=function(e,t){var n=ee(e);return e.on("preInit",(function(){return function(e,t,n){var r;G(e,t,n),e.parser.addNodeFilter("img",(function(t,n,o){var i=function(e){e.attr("data-mce-object")||r===d.transparentSrc||e.remove()},a=function(e){return 0===e.indexOf("webkit-fake-url")},c=function(e){return 0===e.indexOf("data:")};if(!e.settings.paste_data_images&&function(e){return e.data&&!0===e.data.paste}(o))for(var s=t.length;s--;)(r=t[s].attributes.map.src)&&(a(r)?i(t[s]):!e.settings.allow_html_data_urls&&c(r)&&i(t[s]))}))}(e,n,t)})),{pasteFormat:t,pasteHtml:function(t,n){return H(e,t,n)},pasteText:function(t){return U(e,t)},pasteImageData:function(t,n){return K(e,t,n)},getDataTransferItems:W,hasHtmlOrText:q,hasContentType:z}},ne=function(){},re=function(e,t,n){if(!function(e){return!1===d.iOS&&void 0!==e&&"function"==typeof e.setData&&!0!==S.isMsEdge()}(e))return!1;try{return e.clearData(),e.setData("text/html",t),e.setData("text/plain",n),e.setData(h.internalHtmlMime(),t),!0}catch(e){return!1}},oe=function(e,t,n,r){re(e.clipboardData,t.html,t.text)?(e.preventDefault(),r()):n(t.html,r)},ie=function(e){return function(t,n){var r=h.mark(t),o=e.dom.create("div",{contenteditable:"false","data-mce-bogus":"all"}),i=e.dom.create("div",{contenteditable:"true"},r);e.dom.setStyles(o,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),o.appendChild(i),e.dom.add(e.getBody(),o);var a=e.selection.getRng();i.focus();var c=e.dom.createRng();c.selectNodeContents(i),e.selection.setRng(c),setTimeout((function(){e.selection.setRng(a),o.parentNode.removeChild(o),n()}),0)}},ae=function(e){return{html:e.selection.getContent({contextual:!0}),text:e.selection.getContent({format:"text"})}},ce=function(e){e.on("cut",function(e){return function(t){!1===e.selection.isCollapsed()&&oe(t,ae(e),ie(e),(function(){setTimeout((function(){e.execCommand("Delete")}),0)}))}}(e)),e.on("copy",function(e){return function(t){!1===e.selection.isCollapsed()&&oe(t,ae(e),ie(e),ne)}}(e))},se=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),le=function(e,t){return se.getCaretRangeFromPoint(t.clientX,t.clientY,e.getDoc())},ue=function(e,t){e.focus(),e.selection.setRng(t)},de=function(e,t,n){s.shouldBlockDrop(e)&&e.on("dragend dragover draggesture dragdrop drop drag",(function(e){e.preventDefault(),e.stopPropagation()})),s.shouldPasteDataImages(e)||e.on("drop",(function(e){var t=e.dataTransfer;t&&t.files&&t.files.length>0&&e.preventDefault()})),e.on("drop",(function(r){var o,i;if(i=le(e,r),!r.isDefaultPrevented()&&!n.get()){o=t.getDataTransferItems(r.dataTransfer);var a,c=t.hasContentType(o,h.internalHtmlMime());if((t.hasHtmlOrText(o)&&(!(a=o["text/plain"])||0!==a.indexOf("file://"))||!t.pasteImageData(r,i))&&i&&s.shouldFilterDrop(e)){var l=o["mce-internal"]||o["text/html"]||o["text/plain"];l&&(r.preventDefault(),f.setEditorTimeout(e,(function(){e.undoManager.transact((function(){o["mce-internal"]&&e.execCommand("Delete"),ue(e,i),l=S.trimHtml(l),o["text/html"]?t.pasteHtml(l,c):t.pasteText(l)}))})))}}})),e.on("dragstart",(function(e){n.set(!0)})),e.on("dragover dragend",(function(t){s.shouldPasteDataImages(e)&&!1===n.get()&&(t.preventDefault(),ue(e,le(e,t))),"dragend"===t.type&&n.set(!1)}))},fe=function(e){var t=e.plugins.paste,n=s.getPreProcess(e);n&&e.on("PastePreProcess",(function(e){n.call(t,t,e)}));var r=s.getPostProcess(e);r&&e.on("PastePostProcess",(function(e){r.call(t,t,e)}))};function me(e,t){e.on("PastePreProcess",(function(n){n.content=t(e,n.content,n.internal,n.wordContent)}))}function pe(e,t){if(!_.isWordContent(t))return t;var n=[];m.each(e.schema.getBlockElements(),(function(e,t){n.push(t)}));var r=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+n.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");return t=S.filter(t,[[r,"$1"]]),t=S.filter(t,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])}function ge(e,t,n,r){if(r||n)return t;var o,i=s.getWebkitStyles(e);if(!1===s.shouldRemoveWebKitStyles(e)||"all"===i)return t;if(i&&(o=i.split(/[, ]/)),o){var a=e.dom,c=e.selection.getNode();t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,(function(e,t,n,r){var i=a.parseStyle(a.decode(n)),s={};if("none"===o)return t+r;for(var l=0;l<o.length;l++){var u=i[o[l]],d=a.getStyle(c,o[l],!0);/color/.test(o[l])&&(u=a.toHex(u),d=a.toHex(d)),d!==u&&(s[o[l]]=u)}return(s=a.serializeStyle(s,"span"))?t+' style="'+s+'"'+r:t+r}))}else t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return t=t.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,(function(e,t,n,r){return t+' style="'+n+'"'+r}))}function he(e,t){e.$("a",t).find("font,u").each((function(t,n){e.dom.remove(n,!0)}))}var ve=function(e){d.webkit&&me(e,ge),d.ie&&(me(e,pe),function(e,t){e.on("PastePostProcess",(function(n){t(e,n.node)}))}(e,he))},be=function(e){return function(){return e}},ye=(be(!1),be(!0),function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=new Array(arguments.length-1),o=1;o<arguments.length;o++)r[o-1]=arguments[o];return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var o=new Array(arguments.length),i=0;i<o.length;i++)o[i]=arguments[i];var a=r.concat(o);return e.apply(null,a)}}),Ce=function(e,t,n){var r=n.control;r.active("text"===t.pasteFormat.get()),e.on("PastePlainTextToggle",(function(e){r.active(e.state)}))},we=function(e,t){var n=ye(Ce,e,t);e.addButton("pastetext",{active:!1,icon:"pastetext",tooltip:"Paste as text",cmd:"mceTogglePlainTextPaste",onPostRender:n}),e.addMenuItem("pastetext",{text:"Paste as text",selectable:!0,active:t.pasteFormat,cmd:"mceTogglePlainTextPaste",onPostRender:n})};t.add("paste",(function(t){if(!1===n(t)){var o=e(!1),i=e(!1),a=e(s.isPasteAsTextEnabled(t)?"text":"html"),c=te(t,a),l=ve(t);return we(t,c),u(t,c,o),fe(t),ce(t),de(t,c,i),r(c,l)}}))}()},"./node_modules/tinymce/plugins/table/index.js":function(e,t,n){n("./node_modules/tinymce/plugins/table/plugin.js")},"./node_modules/tinymce/plugins/table/plugin.js":function(e,t){!function(){"use strict";var e,t,n=tinymce.util.Tools.resolve("tinymce.PluginManager"),r=function(e){return function(){return e}},o=r(!1),i=r(!0),a={noop:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},noarg:function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e()}},compose:function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e(t.apply(null,arguments))}},constant:r,identity:function(e){return e},tripleEquals:function(e,t){return e===t},curry:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=new Array(arguments.length-1),o=1;o<arguments.length;o++)r[o-1]=arguments[o];return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var o=new Array(arguments.length),i=0;i<o.length;i++)o[i]=arguments[i];var a=r.concat(o);return e.apply(null,a)}},not:function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return!e.apply(null,arguments)}},die:function(e){return function(){throw new Error(e)}},apply:function(e){return e()},call:function(e){e()},never:o,always:i},c=a.never,s=a.always,l=function(){return u},u=function(){var e=function(e){return e.isNone()},t=function(e){return e()},n=function(e){return e},r={fold:function(e,t){return e()},is:c,isSome:c,isNone:s,getOr:n,getOrThunk:t,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},or:n,orThunk:t,map:l,ap:l,each:function(){},bind:l,flatten:l,exists:c,forall:s,filter:l,equals:e,equals_:e,toArray:function(){return[]},toString:a.constant("none()")};return Object.freeze&&Object.freeze(r),r}(),d=function(e){var t=function(){return e},n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:s,isNone:c,getOr:t,getOrThunk:t,getOrDie:t,or:n,orThunk:n,map:function(t){return d(t(e))},ap:function(t){return t.fold(l,(function(t){return d(t(e))}))},each:function(t){t(e)},bind:r,flatten:t,exists:r,forall:r,filter:function(t){return t(e)?o:u},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(c,(function(t){return n(e,t)}))},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return o},f={some:d,none:l,from:function(e){return null==e?u:d(e)}},m=function(e){return function(t){return function(e){if(null===e)return"null";var t=typeof e;return"object"===t&&Array.prototype.isPrototypeOf(e)?"array":"object"===t&&String.prototype.isPrototypeOf(e)?"string":t}(t)===e}},p={isString:m("string"),isObject:m("object"),isArray:m("array"),isNull:m("null"),isBoolean:m("boolean"),isUndefined:m("undefined"),isFunction:m("function"),isNumber:m("number")},g=void 0===(e=Array.prototype.indexOf)?function(e,t){return x(e,t)}:function(t,n){return e.call(t,n)},h=function(e,t){return g(e,t)>-1},v=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o,e)}return r},b=function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n,e)},y=function(e,t){for(var n=e.length-1;n>=0;n--)t(e[n],n,e)},C=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r,e)&&n.push(i)}return n},w=function(e,t){for(var n=0,r=e.length;n<r;n++)if(t(e[n],n,e))return f.some(n);return f.none()},x=function(e,t){for(var n=0,r=e.length;n<r;++n)if(e[n]===t)return n;return-1},k=Array.prototype.push,T=function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!Array.prototype.isPrototypeOf(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);k.apply(t,e[n])}return t},E=function(e,t){for(var n=0,r=e.length;n<r;++n)if(!0!==t(e[n],n,e))return!1;return!0},S=Array.prototype.slice,N=p.isFunction(Array.from)?Array.from:function(e){return S.call(e)},A={map:v,each:b,eachr:y,partition:function(e,t){for(var n=[],r=[],o=0,i=e.length;o<i;o++){var a=e[o];(t(a,o,e)?n:r).push(a)}return{pass:n,fail:r}},filter:C,groupBy:function(e,t){if(0===e.length)return[];for(var n=t(e[0]),r=[],o=[],i=0,a=e.length;i<a;i++){var c=e[i],s=t(c);s!==n&&(r.push(o),o=[]),n=s,o.push(c)}return 0!==o.length&&r.push(o),r},indexOf:function(e,t){var n=g(e,t);return-1===n?f.none():f.some(n)},foldr:function(e,t,n){return y(e,(function(e){n=t(n,e)})),n},foldl:function(e,t,n){return b(e,(function(e){n=t(n,e)})),n},find:function(e,t){for(var n=0,r=e.length;n<r;n++){var o=e[n];if(t(o,n,e))return f.some(o)}return f.none()},findIndex:w,flatten:T,bind:function(e,t){var n=v(e,t);return T(n)},forall:E,exists:function(e,t){return w(e,t).isSome()},contains:h,equal:function(e,t){return e.length===t.length&&E(e,(function(e,n){return e===t[n]}))},reverse:function(e){var t=S.call(e,0);return t.reverse(),t},chunk:function(e,t){for(var n=[],r=0;r<e.length;r+=t){var o=e.slice(r,r+t);n.push(o)}return n},difference:function(e,t){return C(e,(function(e){return!h(t,e)}))},mapToObject:function(e,t){for(var n={},r=0,o=e.length;r<o;r++){var i=e[r];n[String(i)]=t(i,r)}return n},pure:function(e){return[e]},sort:function(e,t){var n=S.call(e,0);return n.sort(t),n},range:function(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n},head:function(e){return 0===e.length?f.none():f.some(e[0])},last:function(e){return 0===e.length?f.none():f.some(e[e.length-1])},from:N},R=void 0===(t=Object.keys)?function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}:t,_=function(e,t){for(var n=R(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i,e)}},I=function(e,t){var n={};return _(e,(function(r,o){var i=t(r,o,e);n[i.k]=i.v})),n},B=function(e,t){var n=[];return _(e,(function(e,r){n.push(t(e,r))})),n},P=function(e){return B(e,(function(e){return e}))},D={bifilter:function(e,t){var n={},r={};return _(e,(function(e,o){(t(e,o)?n:r)[o]=e})),{t:n,f:r}},each:_,map:function(e,t){return I(e,(function(e,n,r){return{k:n,v:t(e,n,r)}}))},mapToArray:B,tupleMap:I,find:function(e,t){for(var n=R(e),r=0,o=n.length;r<o;r++){var i=n[r],a=e[i];if(t(a,i,e))return f.some(a)}return f.none()},keys:R,values:P,size:function(e){return P(e).length}},O=function(e){return e.slice(0).sort()},M={sort:O,reqMessage:function(e,t){throw new Error("All required keys ("+O(e).join(", ")+") were not specified. Specified keys were: "+O(t).join(", ")+".")},unsuppMessage:function(e){throw new Error("Unsupported keys for object: "+O(e).join(", "))},validateStrArr:function(e,t){if(!p.isArray(t))throw new Error("The "+e+" fields must be an array. Was: "+t+".");A.each(t,(function(t){if(!p.isString(t))throw new Error("The value "+t+" in the "+e+" fields was not a string.")}))},invalidTypeMessage:function(e,t){throw new Error("All values need to be of type: "+t+". Keys ("+O(e).join(", ")+") were not.")},checkDupes:function(e){var t=O(e);A.find(t,(function(e,n){return n<t.length-1&&e===t[n+1]})).each((function(e){throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+t.join(", ")+"].")}))}},L={immutable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(e.length!==t.length)throw new Error('Wrong number of arguments to struct. Expected "['+e.length+']", got '+t.length+" arguments");var r={};return A.each(e,(function(e,n){r[e]=a.constant(t[n])})),r}},immutableBag:function(e,t){var n=e.concat(t);if(0===n.length)throw new Error("You must specify at least one required or optional field.");return M.validateStrArr("required",e),M.validateStrArr("optional",t),M.checkDupes(n),function(r){var o=D.keys(r);A.forall(e,(function(e){return A.contains(o,e)}))||M.reqMessage(e,o);var i=A.filter(o,(function(e){return!A.contains(n,e)}));i.length>0&&M.unsuppMessage(i);var c={};return A.each(e,(function(e){c[e]=a.constant(r[e])})),A.each(t,(function(e){c[e]=a.constant(Object.prototype.hasOwnProperty.call(r,e)?f.some(r[e]):f.none())})),c}}},F=L.immutable("width","height"),j=L.immutable("rows","columns"),H=L.immutable("row","column"),U=L.immutable("x","y"),W=L.immutable("element","rowspan","colspan"),z=L.immutable("element","rowspan","colspan","isNew"),q={dimensions:F,grid:j,address:H,coords:U,extended:L.immutable("element","rowspan","colspan","row","column"),detail:W,detailnew:z,rowdata:L.immutable("element","cells","section"),elementnew:L.immutable("element","isNew"),rowdatanew:L.immutable("element","cells","section","isNew"),rowcells:L.immutable("cells","section"),rowdetails:L.immutable("details","section"),bounds:L.immutable("startRow","startCol","finishRow","finishCol")},V=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:a.constant(e)}},$={fromHtml:function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1)throw console.error("HTML does not have a single root node",e),"HTML must have a single root node";return V(n.childNodes[0])},fromTag:function(e,t){var n=(t||document).createElement(e);return V(n)},fromText:function(e,t){var n=(t||document).createTextNode(e);return V(n)},fromDom:V,fromPoint:function(e,t,n){return f.from(e.dom().elementFromPoint(t,n)).map(V)}},K=8,J=9,G=1,X=3,Y=G,Q=J,Z=function(e){return e.nodeType!==Y&&e.nodeType!==Q||0===e.childElementCount},ee={all:function(e,t){var n=void 0===t?document:t.dom();return Z(n)?[]:A.map(n.querySelectorAll(e),$.fromDom)},is:function(e,t){var n=e.dom();if(n.nodeType!==Y)return!1;if(void 0!==n.matches)return n.matches(t);if(void 0!==n.msMatchesSelector)return n.msMatchesSelector(t);if(void 0!==n.webkitMatchesSelector)return n.webkitMatchesSelector(t);if(void 0!==n.mozMatchesSelector)return n.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},one:function(e,t){var n=void 0===t?document:t.dom();return Z(n)?f.none():f.from(n.querySelector(e)).map($.fromDom)}},te=function(e,t){var n=[],r=function(e){return n.push(e),t(e)},o=t(e);do{o=o.bind(r)}while(o.isSome());return n},ne="undefined"!=typeof window?window:Function("return this;")(),re=function(e,t){for(var n=null!=t?t:ne,r=0;r<e.length&&null!=n;++r)n=n[e[r]];return n},oe=function(e,t){var n=e.split(".");return re(n,t)},ie=function(e,t){var n=function(e,t){return oe(e,t)}(e,t);if(null==n)throw e+" not available on this browser";return n},ae=function(){return ie("Node")},ce=function(e,t,n){return 0!=(e.compareDocumentPosition(t)&n)},se=function(e,t){return ce(e,t,ae().DOCUMENT_POSITION_CONTAINED_BY)},le=function(e){var t,n=!1;return function(){return n||(n=!0,t=e.apply(null,arguments)),t}},ue=function(){return de(0,0)},de=function(e,t){return{major:e,minor:t}},fe={nu:de,detect:function(e,t){var n=String(t).toLowerCase();return 0===e.length?ue():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return de(r(1),r(2))}(e,n)},unknown:ue},me=function(e,t){return function(){return t===e}},pe=function(e){var t=e.current;return{current:t,version:e.version,isEdge:me("Edge",t),isChrome:me("Chrome",t),isIE:me("IE",t),isOpera:me("Opera",t),isFirefox:me("Firefox",t),isSafari:me("Safari",t)}},ge={unknown:function(){return pe({current:void 0,version:fe.unknown()})},nu:pe,edge:a.constant("Edge"),chrome:a.constant("Chrome"),ie:a.constant("IE"),opera:a.constant("Opera"),firefox:a.constant("Firefox"),safari:a.constant("Safari")},he=function(e,t){return function(){return t===e}},ve=function(e){var t=e.current;return{current:t,version:e.version,isWindows:he("Windows",t),isiOS:he("iOS",t),isAndroid:he("Android",t),isOSX:he("OSX",t),isLinux:he("Linux",t),isSolaris:he("Solaris",t),isFreeBSD:he("FreeBSD",t)}},be={unknown:function(){return ve({current:void 0,version:fe.unknown()})},nu:ve,windows:a.constant("Windows"),ios:a.constant("iOS"),android:a.constant("Android"),linux:a.constant("Linux"),osx:a.constant("OSX"),solaris:a.constant("Solaris"),freebsd:a.constant("FreeBSD")},ye=function(e,t){var n=String(t).toLowerCase();return A.find(e,(function(e){return e.search(n)}))},Ce=function(e,t){return ye(e,t).map((function(e){var n=fe.detect(e.versionRegexes,t);return{current:e.name,version:n}}))},we=function(e,t){return ye(e,t).map((function(e){var n=fe.detect(e.versionRegexes,t);return{current:e.name,version:n}}))},xe=function(e,t){return t+e},ke=function(e,t){return e+t},Te=function(e,t){return e.substring(t)},Ee=function(e,t){return e.substring(0,e.length-t)},Se=function(e){return""===e?f.none():f.some(e.substr(0,1))},Ne=function(e){return""===e?f.none():f.some(e.substring(1))},Ae=function(e,t,n){return""===t||!(e.length<t.length)&&e.substr(n,n+t.length)===t},Re=function(e,t){return Ae(e,t,0)},_e=function(e,t){return Ae(e,t,e.length-t.length)},Ie={supplant:function(e,t){return e.replace(/\${([^{}]*)}/g,(function(e,n){var r=t[n];return function(e){var t=typeof e;return"string"===t||"number"===t}(r)?r:e}))},startsWith:Re,removeLeading:function(e,t){return Re(e,t)?Te(e,t.length):e},removeTrailing:function(e,t){return _e(e,t)?Ee(e,t.length):e},ensureLeading:function(e,t){return Re(e,t)?e:xe(e,t)},ensureTrailing:function(e,t){return _e(e,t)?e:ke(e,t)},endsWith:_e,contains:function(e,t){return-1!==e.indexOf(t)},trim:function(e){return e.replace(/^\s+|\s+$/g,"")},lTrim:function(e){return e.replace(/^\s+/g,"")},rTrim:function(e){return e.replace(/\s+$/g,"")},capitalize:function(e){return Se(e).bind((function(t){return Ne(e).map((function(e){return t.toUpperCase()+e}))})).getOr(e)}},Be=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Pe=function(e){return function(t){return Ie.contains(t,e)}},De=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return Ie.contains(e,"edge/")&&Ie.contains(e,"chrome")&&Ie.contains(e,"safari")&&Ie.contains(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Be],search:function(e){return Ie.contains(e,"chrome")&&!Ie.contains(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return Ie.contains(e,"msie")||Ie.contains(e,"trident")}},{name:"Opera",versionRegexes:[Be,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Pe("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Pe("firefox")},{name:"Safari",versionRegexes:[Be,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(Ie.contains(e,"safari")||Ie.contains(e,"mobile/"))&&Ie.contains(e,"applewebkit")}}],Oe=[{name:"Windows",search:Pe("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return Ie.contains(e,"iphone")||Ie.contains(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Pe("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Pe("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Pe("linux"),versionRegexes:[]},{name:"Solaris",search:Pe("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Pe("freebsd"),versionRegexes:[]}],Me={browsers:a.constant(De),oses:a.constant(Oe)},Le=function(e){var t=Me.browsers(),n=Me.oses(),r=Ce(t,e).fold(ge.unknown,ge.nu),o=we(n,e).fold(be.unknown,be.nu),i=function(e,t,n){var r=e.isiOS()&&!0===/ipad/i.test(n),o=e.isiOS()&&!r,i=e.isAndroid()&&3===e.version.major,c=e.isAndroid()&&4===e.version.major,s=r||i||c&&!0===/mobile/i.test(n),l=e.isiOS()||e.isAndroid(),u=l&&!s,d=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n);return{isiPad:a.constant(r),isiPhone:a.constant(o),isTablet:a.constant(s),isPhone:a.constant(u),isTouch:a.constant(l),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:a.constant(d)}}(o,r,e);return{browser:r,os:o,deviceType:i}},Fe={detect:le((function(){var e=navigator.userAgent;return Le(e)}))},je=function(e,t){return e.dom()===t.dom()},He=Fe.detect().browser.isIE()?function(e,t){return se(e.dom(),t.dom())}:function(e,t){var n=e.dom(),r=t.dom();return n!==r&&n.contains(r)},Ue={eq:je,isEqualNode:function(e,t){return e.dom().isEqualNode(t.dom())},member:function(e,t){return A.exists(t,a.curry(je,e))},contains:He,is:ee.is},We=function(e){return $.fromDom(e.dom().ownerDocument)},ze=function(e){var t=e.dom();return f.from(t.parentNode).map($.fromDom)},qe=function(e){var t=e.dom();return f.from(t.previousSibling).map($.fromDom)},Ve=function(e){var t=e.dom();return f.from(t.nextSibling).map($.fromDom)},$e=function(e){var t=e.dom();return A.map(t.childNodes,$.fromDom)},Ke=function(e,t){var n=e.dom().childNodes;return f.from(n[t]).map($.fromDom)},Je=L.immutable("element","offset"),Ge={owner:We,defaultView:function(e){var t=e.dom().ownerDocument.defaultView;return $.fromDom(t)},documentElement:function(e){var t=We(e);return $.fromDom(t.dom().documentElement)},parent:ze,findIndex:function(e){return ze(e).bind((function(t){var n=$e(t);return A.findIndex(n,(function(t){return Ue.eq(e,t)}))}))},parents:function(e,t){for(var n=p.isFunction(t)?t:a.constant(!1),r=e.dom(),o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,c=$.fromDom(i);if(o.push(c),!0===n(c))break;r=i}return o},siblings:function(e){return ze(e).map($e).map((function(t){return A.filter(t,(function(t){return!Ue.eq(e,t)}))})).getOr([])},prevSibling:qe,offsetParent:function(e){var t=e.dom();return f.from(t.offsetParent).map($.fromDom)},prevSiblings:function(e){return A.reverse(te(e,qe))},nextSibling:Ve,nextSiblings:function(e){return te(e,Ve)},children:$e,child:Ke,firstChild:function(e){return Ke(e,0)},lastChild:function(e){return Ke(e,e.dom().childNodes.length-1)},childNodesCount:function(e){return e.dom().childNodes.length},hasChildNodes:function(e){return e.dom().hasChildNodes()},leaf:function(e,t){var n=$e(e);return n.length>0&&t<n.length?Je(n[t],0):Je(e,t)}},Xe=function(e,t,n){return A.bind(Ge.children(e),(function(e){return ee.is(e,t)?n(e)?[e]:[]:Xe(e,t,n)}))},Ye={firstLayer:function(e,t){return Xe(e,t,a.constant(!0))},filterFirstLayer:Xe},Qe=function(e){return e.dom().nodeName.toLowerCase()},Ze=function(e){return e.dom().nodeType},et=function(e){return function(t){return Ze(t)===e}},tt=et(G),nt=et(X),rt=et(J),ot={name:Qe,type:Ze,value:function(e){return e.dom().nodeValue},isElement:tt,isText:nt,isDocument:rt,isComment:function(e){return Ze(e)===K||"#comment"===Qe(e)}},it=function(e,t,n){if(!(p.isString(n)||p.isBoolean(n)||p.isNumber(n)))throw console.error("Invalid call to Attr.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},at=function(e,t,n){it(e.dom(),t,n)},ct=function(e,t){var n=e.dom().getAttribute(t);return null===n?void 0:n},st=function(e,t){var n=e.dom();return!(!n||!n.hasAttribute)&&n.hasAttribute(t)},lt={clone:function(e){return A.foldl(e.dom().attributes,(function(e,t){return e[t.name]=t.value,e}),{})},set:at,setAll:function(e,t){var n=e.dom();D.each(t,(function(e,t){it(n,t,e)}))},get:ct,has:st,remove:function(e,t){e.dom().removeAttribute(t)},hasNone:function(e){var t=e.dom().attributes;return null==t||0===t.length},transfer:function(e,t,n){ot.isElement(e)&&ot.isElement(t)&&A.each(n,(function(n){!function(e,t,n){st(e,n)&&!st(t,n)&&at(t,n,ct(e,n))}(e,t,n)}))}},ut=le((function(){return dt($.fromDom(document))})),dt=function(e){var t=e.dom().body;if(null==t)throw"Body is not available yet";return $.fromDom(t)},ft={body:ut,getBody:dt,inBody:function(e){var t=ot.isText(e)?e.dom().parentNode:e.dom();return null!=t&&t.ownerDocument.body.contains(t)}},mt=function(e,t){var n=[];return A.each(Ge.children(e),(function(e){t(e)&&(n=n.concat([e])),n=n.concat(mt(e,t))})),n},pt={all:function(e){return mt(ft.body(),e)},ancestors:function(e,t,n){return A.filter(Ge.parents(e,n),t)},siblings:function(e,t){return A.filter(Ge.siblings(e),t)},children:function(e,t){return A.filter(Ge.children(e),t)},descendants:mt},gt={all:function(e){return ee.all(e)},ancestors:function(e,t,n){return pt.ancestors(e,(function(e){return ee.is(e,t)}),n)},siblings:function(e,t){return pt.siblings(e,(function(e){return ee.is(e,t)}))},children:function(e,t){return pt.children(e,(function(e){return ee.is(e,t)}))},descendants:function(e,t){return ee.all(t,e)}};function ht(e,t,n,r,o){return e(n,r)?f.some(n):p.isFunction(o)&&o(n)?f.none():t(n,r,o)}var vt=function(e,t,n){for(var r=e.dom(),o=p.isFunction(n)?n:a.constant(!1);r.parentNode;){r=r.parentNode;var i=$.fromDom(r);if(t(i))return f.some(i);if(o(i))break}return f.none()},bt=function(e,t){return A.find(e.dom().childNodes,a.compose(t,$.fromDom)).map($.fromDom)},yt=function(e,t){var n=function(e){for(var r=0;r<e.childNodes.length;r++){if(t($.fromDom(e.childNodes[r])))return f.some($.fromDom(e.childNodes[r]));var o=n(e.childNodes[r]);if(o.isSome())return o}return f.none()};return n(e.dom())},Ct={first:function(e){return yt(ft.body(),e)},ancestor:vt,closest:function(e,t,n){return ht((function(e){return t(e)}),vt,e,t,n)},sibling:function(e,t){var n=e.dom();return n.parentNode?bt($.fromDom(n.parentNode),(function(n){return!Ue.eq(e,n)&&t(n)})):f.none()},child:bt,descendant:yt},wt=function(e,t,n){return Ct.ancestor(e,(function(e){return ee.is(e,t)}),n)},xt={first:function(e){return ee.one(e)},ancestor:wt,sibling:function(e,t){return Ct.sibling(e,(function(e){return ee.is(e,t)}))},child:function(e,t){return Ct.child(e,(function(e){return ee.is(e,t)}))},descendant:function(e,t){return ee.one(t,e)},closest:function(e,t,n){return ht(ee.is,wt,e,t,n)}},kt=function(e,t,n){var r=void 0!==n?n:a.constant(!1);return r(t)?f.none():A.contains(e,ot.name(t))?f.some(t):xt.ancestor(t,e.join(","),(function(e){return ee.is(e,"table")||r(e)}))},Tt=function(e,t){return Ge.parent(t).map((function(t){return gt.children(t,e)}))},Et=a.curry(Tt,"th,td"),St=a.curry(Tt,"tr"),Nt=function(e,t){return parseInt(lt.get(e,t),10)},At={cell:function(e,t){return kt(["td","th"],e,t)},firstCell:function(e){return xt.descendant(e,"th,td")},cells:function(e){return Ye.firstLayer(e,"th,td")},neighbourCells:Et,table:function(e,t){return xt.closest(e,"table",t)},row:function(e,t){return kt(["tr"],e,t)},rows:function(e){return Ye.firstLayer(e,"tr")},notCell:function(e,t){return kt(["caption","tr","tbody","tfoot","thead"],e,t)},neighbourRows:St,attr:Nt,grid:function(e,t,n){var r=Nt(e,t),o=Nt(e,n);return q.grid(r,o)}},Rt=function(e){var t=At.rows(e);return A.map(t,(function(e){var t=e,n=Ge.parent(t).bind((function(e){var t=ot.name(e);return"tfoot"===t||"thead"===t||"tbody"===t?t:"tbody"})),r=A.map(At.cells(e),(function(e){var t=lt.has(e,"rowspan")?parseInt(lt.get(e,"rowspan"),10):1,n=lt.has(e,"colspan")?parseInt(lt.get(e,"colspan"),10):1;return q.detail(e,t,n)}));return q.rowdata(t,r,n)}))},_t=function(e,t){return A.map(e,(function(e){var n=A.map(At.cells(e),(function(e){var t=lt.has(e,"rowspan")?parseInt(lt.get(e,"rowspan"),10):1,n=lt.has(e,"colspan")?parseInt(lt.get(e,"colspan"),10):1;return q.detail(e,t,n)}));return q.rowdata(e,n,t.section())}))},It=function(e,t){return e+","+t},Bt=function(e,t){var n=A.bind(e.all(),(function(e){return e.cells()}));return A.filter(n,t)},Pt={generate:function(e){var t={},n=[],r=e.length,o=0;A.each(e,(function(e,r){var i=[];A.each(e.cells(),(function(e,n){for(var a=0;void 0!==t[It(r,a)];)a++;for(var c=q.extended(e.element(),e.rowspan(),e.colspan(),r,a),s=0;s<e.colspan();s++)for(var l=0;l<e.rowspan();l++){var u=a+s,d=It(r+l,u);t[d]=c,o=Math.max(o,u+1)}i.push(c)})),n.push(q.rowdata(e.element(),i,e.section()))}));var i=q.grid(r,o);return{grid:a.constant(i),access:a.constant(t),all:a.constant(n)}},getAt:function(e,t,n){var r=e.access()[It(t,n)];return void 0!==r?f.some(r):f.none()},findItem:function(e,t,n){var r=Bt(e,(function(e){return n(t,e.element())}));return r.length>0?f.some(r[0]):f.none()},filterItems:Bt,justCells:function(e){var t=A.map(e.all(),(function(e){return e.cells()}));return A.flatten(t)}},Dt={isSupported:function(e){return void 0!==e.style}},Ot=function(e,t,n){if(!p.isString(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);Dt.isSupported(e)&&e.style.setProperty(t,n)},Mt=function(e,t){Dt.isSupported(e)&&e.style.removeProperty(t)},Lt=function(e,t,n){var r=e.dom();Ot(r,t,n)},Ft=function(e,t){return Dt.isSupported(e)?e.style.getPropertyValue(t):""},jt=function(e,t){var n=e.dom(),r=Ft(n,t);return f.from(r).filter((function(e){return e.length>0}))},Ht={copy:function(e,t){var n=e.dom(),r=t.dom();Dt.isSupported(n)&&Dt.isSupported(r)&&(r.style.cssText=n.style.cssText)},set:Lt,preserve:function(e,t){var n=lt.get(e,"style"),r=t(e);return(void 0===n?lt.remove:lt.set)(e,"style",n),r},setAll:function(e,t){var n=e.dom();D.each(t,(function(e,t){Ot(n,t,e)}))},setOptions:function(e,t){var n=e.dom();D.each(t,(function(e,t){e.fold((function(){Mt(n,t)}),(function(e){Ot(n,t,e)}))}))},remove:function(e,t){var n=e.dom();Mt(n,t),lt.has(e,"style")&&""===Ie.trim(lt.get(e,"style"))&&lt.remove(e,"style")},get:function(e,t){var n=e.dom(),r=window.getComputedStyle(n).getPropertyValue(t),o=""!==r||ft.inBody(e)?r:Ft(n,t);return null===o?void 0:o},getRaw:jt,getAllRaw:function(e){var t={},n=e.dom();if(Dt.isSupported(n))for(var r=0;r<n.style.length;r++){var o=n.style.item(r);t[o]=n.style[o]}return t},isValidValue:function(e,t,n){var r=$.fromTag(e);return Lt(r,t,n),jt(r,t).isSome()},reflow:function(e){return e.dom().offsetWidth},transfer:function(e,t,n){ot.isElement(e)&&ot.isElement(t)&&A.each(n,(function(n){!function(e,t,n){jt(e,n).each((function(e){jt(t,n).isNone()&&Lt(t,n,e)}))}(e,t,n)}))}},Ut=function(e,t){Ge.parent(e).each((function(n){n.dom().insertBefore(t.dom(),e.dom())}))},Wt=function(e,t){e.dom().appendChild(t.dom())},zt={before:Ut,after:function(e,t){Ge.nextSibling(e).fold((function(){Ge.parent(e).each((function(e){Wt(e,t)}))}),(function(e){Ut(e,t)}))},prepend:function(e,t){Ge.firstChild(e).fold((function(){Wt(e,t)}),(function(n){e.dom().insertBefore(t.dom(),n.dom())}))},append:Wt,appendAt:function(e,t,n){Ge.child(e,n).fold((function(){Wt(e,t)}),(function(e){Ut(e,t)}))},wrap:function(e,t){Ut(e,t),Wt(t,e)}},qt={before:function(e,t){A.each(t,(function(t){zt.before(e,t)}))},after:function(e,t){A.each(t,(function(n,r){var o=0===r?e:t[r-1];zt.after(o,n)}))},prepend:function(e,t){A.each(t.slice().reverse(),(function(t){zt.prepend(e,t)}))},append:function(e,t){A.each(t,(function(t){zt.append(e,t)}))}},Vt=function(e){var t=e.dom();null!==t.parentNode&&t.parentNode.removeChild(t)},$t={empty:function(e){e.dom().textContent="",A.each(Ge.children(e),(function(e){Vt(e)}))},remove:Vt,unwrap:function(e){var t=Ge.children(e);t.length>0&&qt.before(e,t),Vt(e)}},Kt=L.immutable("minRow","minCol","maxRow","maxCol"),Jt=function(e,t){var n=e.grid().columns(),r=e.grid().rows(),o=n,i=0,a=0;return D.each(e.access(),(function(e){if(t(e)){var n=e.row(),c=n+e.rowspan()-1,s=e.column(),l=s+e.colspan()-1;n<r?r=n:c>i&&(i=c),s<o?o=s:l>a&&(a=l)}})),Kt(r,o,i,a)},Gt=function(e,t,n){var r=e[n].element(),o=$.fromTag("td");zt.append(o,$.fromTag("br")),(t?zt.append:zt.prepend)(r,o)},Xt=function(e,t){var n=function(e){return ee.is(e.element(),t)},r=Rt(e),o=Pt.generate(r),i=Jt(o,n),a="th:not("+t+"),td:not("+t+")",c=Ye.filterFirstLayer(e,"th,td",(function(e){return ee.is(e,a)}));return A.each(c,$t.remove),function(e,t,n,r){for(var o=t.grid().columns(),i=t.grid().rows(),a=0;a<i;a++)for(var c=!1,s=0;s<o;s++)a<n.minRow()||a>n.maxRow()||s<n.minCol()||s>n.maxCol()||(Pt.getAt(t,a,s).filter(r).isNone()?Gt(e,c,a):c=!0)}(r,o,i,n),function(e,t){var n=A.filter(Ye.firstLayer(e,"tr"),(function(e){return 0===e.dom().childElementCount}));A.each(n,$t.remove),t.minCol()!==t.maxCol()&&t.minRow()!==t.maxRow()||A.each(Ye.firstLayer(e,"th,td"),(function(e){lt.remove(e,"rowspan"),lt.remove(e,"colspan")})),lt.remove(e,"width"),lt.remove(e,"height"),Ht.remove(e,"width"),Ht.remove(e,"height")}(e,i),e},Yt=function(e,t){return $.fromDom(e.dom().cloneNode(t))},Qt=function(e){return Yt(e,!0)},Zt=function(e,t){var n=$.fromTag(t),r=lt.clone(e);return lt.setAll(n,r),n},en=function(e){return Yt(e,!1)},tn=Qt,nn=function(e,t){var n=Zt(e,t),r=Ge.children(Qt(e));return qt.append(n,r),n},rn=function(e,t){var n=function(t){return e(t)?f.from(t.dom().nodeValue):f.none()},r=Fe.detect().browser,o=r.isIE()&&10===r.version.major?function(e){try{return n(e)}catch(e){return f.none()}}:n;return{get:function(n){if(!e(n))throw new Error("Can only get "+t+" value of a "+t+" node");return o(n).getOr("")},getOption:o,set:function(n,r){if(!e(n))throw new Error("Can only set raw "+t+" value of a "+t+" node");n.dom().nodeValue=r}}}(ot.isText,"text"),on={get:function(e){return rn.get(e)},getOption:function(e){return rn.getOption(e)},set:function(e,t){rn.set(e,t)}},an=function(e){return"img"===ot.name(e)?1:on.getOption(e).fold((function(){return Ge.children(e).length}),(function(e){return e.length}))},cn=["img","br"],sn=an,ln=function(e){var t;return t=e,on.getOption(t).filter((function(e){return 0!==e.trim().length||e.indexOf(" ")>-1})).isSome()||A.contains(cn,ot.name(e))},un=function(e,t){var n=function(e){for(var r=Ge.children(e),o=r.length-1;o>=0;o--){var i=r[o];if(t(i))return f.some(i);var a=n(i);if(a.isSome())return a}return f.none()};return n(e)},dn={first:function(e){return Ct.descendant(e,ln)},last:function(e){return un(e,ln)}},fn=function(){var e=$.fromTag("td");return zt.append(e,$.fromTag("br")),e},mn=function(e,t,n){var r=nn(e,t);return D.each(n,(function(e,t){null===e?lt.remove(r,t):lt.set(r,t,e)})),r},pn=function(e){return e},gn=function(e){return function(){return $.fromTag("tr",e.dom())}},hn=function(e,t,n){return{row:gn(t),cell:function(t){var r=Ge.owner(t.element()),o=$.fromTag(ot.name(t.element()),r.dom()),i=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),a=i.length>0?function(e,t,n){return dn.first(e).map((function(r){var o=n.join(","),i=gt.ancestors(r,o,(function(t){return Ue.eq(t,e)}));return A.foldr(i,(function(e,t){var n=en(t);return zt.append(e,n),n}),t)})).getOr(t)}(t.element(),o,i):o;return zt.append(a,$.fromTag("br")),Ht.copy(t.element(),o),Ht.remove(o,"height"),1!==t.colspan()&&Ht.remove(t.element(),"width"),e(t.element(),o),o},replace:mn,gap:fn}},vn=function(e){return{row:gn(e),cell:fn,replace:pn,gap:fn}},bn=function(e,t){var n=(t||document).createElement("div");return n.innerHTML=e,Ge.children($.fromDom(n))},yn=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function Cn(){return{up:a.constant({selector:xt.ancestor,closest:xt.closest,predicate:Ct.ancestor,all:Ge.parents}),down:a.constant({selector:gt.descendants,predicate:pt.descendants}),styles:a.constant({get:Ht.get,getRaw:Ht.getRaw,set:Ht.set,remove:Ht.remove}),attrs:a.constant({get:lt.get,set:lt.set,remove:lt.remove,copyTo:function(e,t){var n=lt.clone(e);lt.setAll(t,n)}}),insert:a.constant({before:zt.before,after:zt.after,afterAll:qt.after,append:zt.append,appendAll:qt.append,prepend:zt.prepend,wrap:zt.wrap}),remove:a.constant({unwrap:$t.unwrap,remove:$t.remove}),create:a.constant({nu:$.fromTag,clone:function(e){return $.fromDom(e.dom().cloneNode(!1))},text:$.fromText}),query:a.constant({comparePosition:function(e,t){return e.dom().compareDocumentPosition(t.dom())},prevSibling:Ge.prevSibling,nextSibling:Ge.nextSibling}),property:a.constant({children:Ge.children,name:ot.name,parent:Ge.parent,isText:ot.isText,isComment:ot.isComment,isElement:ot.isElement,getText:on.get,setText:on.set,isBoundary:function(e){return!!ot.isElement(e)&&("body"===ot.name(e)||A.contains(yn,ot.name(e)))},isEmptyTag:function(e){return!!ot.isElement(e)&&A.contains(["br","img","hr","input"],ot.name(e))}}),eq:Ue.eq,is:Ue.is}}L.immutable("left","right");var wn=function(e,t,n,r){var o=t(e,n);return A.foldr(r,(function(n,r){var o=t(e,r);return xn(e,n,o)}),o)},xn=function(e,t,n){return t.bind((function(t){return n.filter(a.curry(e.eq,t))}))},kn=function(e,t,n){return n.length>0?function(e,t,n,r){return r(e,t,n[0],n.slice(1))}(e,t,n,wn):f.none()},Tn=function(e,t){return a.curry(e.eq,t)},En=function(e,t,n,r){var o=void 0!==r?r:a.constant(!1),i=[t].concat(e.up().all(t)),c=[n].concat(e.up().all(n)),s=function(e){return A.findIndex(e,o).fold((function(){return e}),(function(t){return e.slice(0,t+1)}))},l=s(i),u=s(c),d=A.find(l,(function(t){return A.exists(u,Tn(e,t))}));return{firstpath:a.constant(l),secondpath:a.constant(u),shared:a.constant(d)}},Sn=En,Nn=function(e,t,n){return kn(e,t,n)},An=function(e,t,n,r){return Sn(e,t,n,r)},Rn=Cn(),_n=function(e,t){return Nn(Rn,(function(t,n){return e(n)}),t)},In=function(e,t,n){return An(Rn,e,t,n)},Bn=function(e,t){return t.column()>=e.startCol()&&t.column()+t.colspan()-1<=e.finishCol()&&t.row()>=e.startRow()&&t.row()+t.rowspan()-1<=e.finishRow()},Pn=function(e,t){var n=t.column(),r=t.column()+t.colspan()-1,o=t.row(),i=t.row()+t.rowspan()-1;return n<=e.finishCol()&&r>=e.startCol()&&o<=e.finishRow()&&i>=e.startRow()},Dn=function(e,t){for(var n=!0,r=a.curry(Bn,t),o=t.startRow();o<=t.finishRow();o++)for(var i=t.startCol();i<=t.finishCol();i++)n=n&&Pt.getAt(e,o,i).exists(r);return n?f.some(t):f.none()},On=function(e,t,n){var r=Pt.findItem(e,t,Ue.eq),o=Pt.findItem(e,n,Ue.eq);return r.bind((function(e){return o.map((function(t){return n=e,r=t,q.bounds(Math.min(n.row(),r.row()),Math.min(n.column(),r.column()),Math.max(n.row()+n.rowspan()-1,r.row()+r.rowspan()-1),Math.max(n.column()+n.colspan()-1,r.column()+r.colspan()-1));var n,r}))}))},Mn=On,Ln=function(e,t,n){return On(e,t,n).bind((function(t){return Dn(e,t)}))},Fn=function(e,t,n,r){return Pt.findItem(e,t,Ue.eq).bind((function(t){var o=n>0?t.row()+t.rowspan()-1:t.row(),i=r>0?t.column()+t.colspan()-1:t.column();return Pt.getAt(e,o+n,i+r).map((function(e){return e.element()}))}))},jn=function(e,t,n){return Mn(e,t,n).map((function(t){var n=Pt.filterItems(e,a.curry(Pn,t));return A.map(n,(function(e){return e.element()}))}))},Hn=function(e,t){return Pt.findItem(e,t,(function(e,t){return Ue.contains(t,e)})).bind((function(e){return e.element()}))},Un=function(e){var t=Rt(e);return Pt.generate(t)},Wn=function(e,t,n){return At.table(e).bind((function(r){var o=Un(r);return Fn(o,e,t,n)}))},zn=function(e,t,n){var r=Un(e);return jn(r,t,n)},qn=function(e,t,n,r,o){var i=Un(e),a=Ue.eq(e,n)?t:Hn(i,t),c=Ue.eq(e,o)?r:Hn(i,r);return jn(i,a,c)},Vn=function(e,t,n){var r=Un(e);return Ln(r,t,n)},$n=function(e,t){return xt.ancestor(e,"table")},Kn=L.immutableBag(["boxes","start","finish"],[]),Jn=function(e,t,n){var r=function(e){return function(t){return n(t)||Ue.eq(t,e)}};return Ue.eq(e,t)?f.some(Kn({boxes:f.some([e]),start:e,finish:t})):$n(e).bind((function(o){return $n(t).bind((function(i){if(Ue.eq(o,i))return f.some(Kn({boxes:zn(o,e,t),start:e,finish:t}));if(Ue.contains(o,i)){var a=(c=gt.ancestors(t,"td,th",r(o))).length>0?c[c.length-1]:t;return f.some(Kn({boxes:qn(o,e,o,t,i),start:e,finish:a}))}if(Ue.contains(i,o)){var c,s=(c=gt.ancestors(e,"td,th",r(i))).length>0?c[c.length-1]:e;return f.some(Kn({boxes:qn(i,e,o,t,i),start:e,finish:s}))}return In(e,t).shared().bind((function(a){return xt.closest(a,"table",n).bind((function(n){var a=gt.ancestors(t,"td,th",r(n)),c=a.length>0?a[a.length-1]:t,s=gt.ancestors(e,"td,th",r(n)),l=s.length>0?s[s.length-1]:e;return f.some(Kn({boxes:qn(n,e,o,t,i),start:l,finish:c}))}))}))}))}))},Gn={identify:Jn,retrieve:function(e,t){var n=gt.descendants(e,t);return n.length>0?f.some(n):f.none()},shiftSelection:function(e,t,n,r,o){return function(e,t){return A.find(e,(function(e){return ee.is(e,t)}))}(e,o).bind((function(e){return Wn(e,t,n).bind((function(e){return function(e,t){return xt.ancestor(e,"table").bind((function(n){return xt.descendant(n,t).bind((function(t){return Jn(t,e).bind((function(e){return e.boxes().map((function(t){return{boxes:a.constant(t),start:a.constant(e.start()),finish:a.constant(e.finish())}}))}))}))}))}(e,r)}))}))},getEdges:function(e,t,n){return xt.descendant(e,t).bind((function(t){return xt.descendant(e,n).bind((function(e){return _n($n,[t,e]).map((function(n){return{first:a.constant(t),last:a.constant(e),table:a.constant(n)}}))}))}))}},Xn=function(e,t){return Gn.retrieve(e,t)},Yn=function(e,t,n){return Gn.getEdges(e,t,n).bind((function(t){var n=function(t){return Ue.eq(e,t)},r=xt.ancestor(t.first(),"thead,tfoot,tbody,table",n),o=xt.ancestor(t.last(),"thead,tfoot,tbody,table",n);return r.bind((function(e){return o.bind((function(n){return Ue.eq(e,n)?Vn(t.table(),t.first(),t.last()):f.none()}))}))}))},Qn="data-mce-selected",Zn={selected:a.constant(Qn),selectedSelector:a.constant("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:a.constant("[data-mce-selected]"),firstSelected:a.constant("data-mce-first-selected"),firstSelectedSelector:a.constant("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:a.constant("data-mce-last-selected"),lastSelectedSelector:a.constant("td[data-mce-last-selected],th[data-mce-last-selected]")},er=function(e){if(!p.isArray(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],n={};return A.each(e,(function(r,o){var i=D.keys(r);if(1!==i.length)throw new Error("one and only one name per case");var a=i[0],c=r[a];if(void 0!==n[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!p.isArray(c))throw new Error("case arguments must be an array");t.push(a),n[a]=function(){var n=arguments.length;if(n!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+n);for(var r=new Array(n),i=0;i<r.length;i++)r[i]=arguments[i];var s=function(e){var n=D.keys(e);if(t.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+n.join(","));if(!A.forall(t,(function(e){return A.contains(n,e)})))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+t.join(", "));return e[a].apply(null,r)};return{fold:function(){if(arguments.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+arguments.length);var t=arguments[o];return t.apply(null,r)},match:s,log:function(e){console.log(e,{constructors:t,constructor:a,params:r})}}}})),n},tr=er([{none:[]},{multiple:["elements"]},{single:["selection"]}]),nr={cata:function(e,t,n,r){return e.fold(t,n,r)},none:tr.none,multiple:tr.multiple,single:tr.single},rr=function(e,t){return nr.cata(t.get(),a.constant([]),a.identity,a.constant([e]))},or=function(e,t){return nr.cata(t.get(),f.none,(function(t,n){return 0===t.length?f.none():Yn(e,Zn.firstSelectedSelector(),Zn.lastSelectedSelector()).bind((function(e){return t.length>1?f.some({bounds:a.constant(e),cells:a.constant(t)}):f.none()}))}),f.none)},ir=function(e,t){var n=rr(e,t);return n.length>0&&A.forall(n,(function(e){return lt.has(e,"rowspan")&&parseInt(lt.get(e,"rowspan"),10)>1||lt.has(e,"colspan")&&parseInt(lt.get(e,"colspan"),10)>1}))?f.some(n):f.none()},ar=rr,cr=function(e){return{element:a.constant(e),mergable:f.none,unmergable:f.none,selection:a.constant([e])}},sr=L.immutable("element","clipboard","generators"),lr={noMenu:cr,forMenu:function(e,t,n){return{element:a.constant(n),mergable:a.constant(or(t,e)),unmergable:a.constant(ir(n,e)),selection:a.constant(ar(n,e))}},notCell:function(e){return cr(e)},paste:sr,pasteRows:function(e,t,n,r,o){return{element:a.constant(n),mergable:f.none,unmergable:f.none,selection:a.constant(ar(n,e)),clipboard:a.constant(r),generators:a.constant(o)}}},ur={registerEvents:function(e,t,n,r){e.on("BeforeGetContent",(function(n){!0===n.selection&&nr.cata(t.get(),a.noop,(function(t){n.preventDefault(),function(e){return At.table(e[0]).map(tn).map((function(e){return[Xt(e,Zn.attributeSelector())]}))}(t).each((function(t){n.content=A.map(t,(function(t){return function(e,t){return e.selection.serializer.serialize(t.dom(),{})}(e,t)})).join("")}))}),a.noop)})),e.on("BeforeSetContent",(function(t){!0===t.selection&&!0===t.paste&&f.from(e.dom.getParent(e.selection.getStart(),"th,td")).each((function(o){var i=$.fromDom(o);At.table(i).bind((function(o){var a=A.filter(bn(t.content),(function(e){return"meta"!==ot.name(e)}));if(1===a.length&&"table"===ot.name(a[0])){t.preventDefault();var c=$.fromDom(e.getDoc()),s=vn(c),l=lr.paste(i,a[0],s);n.pasteCells(o,l).each((function(t){e.selection.setRng(t),e.focus(),r.clear(o)}))}}))}))}))}};function dr(e,t){var n=function(n){var r=t(n);if(r<=0||null===r){var o=Ht.get(n,e);return parseFloat(o)||0}return r},r=function(e,t){return A.foldl(t,(function(t,n){var r=Ht.get(e,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o}),0)};return{set:function(t,n){if(!p.isNumber(n)&&!n.match(/^[0-9]+$/))throw e+".set accepts only positive integer values. Value was "+n;var r=t.dom();Dt.isSupported(r)&&(r.style[e]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(e,t,n){var o=r(e,n);return t>o?t-o:0}}}var fr=dr("height",(function(e){return ft.inBody(e)?e.dom().getBoundingClientRect().height:e.dom().offsetHeight})),mr=function(e){return fr.get(e)},pr=function(e){return fr.getOuter(e)},gr=dr("width",(function(e){return e.dom().offsetWidth})),hr=function(e){return gr.get(e)},vr=function(e){return gr.getOuter(e)},br=Fe.detect(),yr=function(e,t,n){return function(e,t){var n=parseFloat(e);return isNaN(n)?t:n}(Ht.get(e,t),n)},Cr=function(e){return br.browser.isIE()||br.browser.isEdge()?function(e){var t=yr(e,"padding-top",0),n=yr(e,"padding-bottom",0),r=yr(e,"border-top-width",0),o=yr(e,"border-bottom-width",0),i=e.dom().getBoundingClientRect().height;return"border-box"===Ht.get(e,"box-sizing")?i:i-t-n-(r+o)}(e):yr(e,"height",mr(e))},wr=/(\d+(\.\d+)?)(\w|%)*/,xr=/(\d+(\.\d+)?)%/,kr=/(\d+(\.\d+)?)px|em/,Tr=function(e,t){Ht.set(e,"height",t+"px")},Er=function(e,t,n,r){var o=parseInt(e,10);return Ie.endsWith(e,"%")&&"table"!==ot.name(t)?function(e,t,n,r){var o=At.table(e).map((function(e){var r=n(e);return Math.floor(t/100*r)})).getOr(t);return r(e,o),o}(t,o,n,r):o},Sr=function(e){var t=function(e){return Ht.getRaw(e,"height").getOrThunk((function(){return Cr(e)+"px"}))}(e);return t?Er(t,e,mr,Tr):mr(e)},Nr=function(e,t){return lt.has(e,t)?parseInt(lt.get(e,t),10):1},Ar=function(e){return Ht.getRaw(e,"width").fold((function(){return f.from(lt.get(e,"width"))}),(function(e){return f.some(e)}))},Rr=function(e,t){return e/t.pixelWidth()*100},_r={percentageBasedSizeRegex:a.constant(xr),pixelBasedSizeRegex:a.constant(kr),setPixelWidth:function(e,t){Ht.set(e,"width",t+"px")},setPercentageWidth:function(e,t){Ht.set(e,"width",t+"%")},setHeight:Tr,getPixelWidth:function(e,t){return Ar(e).fold((function(){var t=hr(e);return parseInt(t,10)}),(function(n){return function(e,t,n){if(kr.test(t)){var r=kr.exec(t);return parseInt(r[1],10)}if(xr.test(t)){var o=xr.exec(t);return function(e,t){return e/100*t.pixelWidth()}(parseFloat(o[1]),n)}var i=hr(e);return parseInt(i,10)}(e,n,t)}))},getPercentageWidth:function(e,t){return Ar(e).fold((function(){var n=hr(e),r=parseInt(n,10);return Rr(r,t)}),(function(n){return function(e,t,n){if(xr.test(t)){var r=xr.exec(t);return parseFloat(r[1])}var o=hr(e),i=parseInt(o,10);return Rr(i,n)}(e,n,t)}))},getGenericWidth:function(e){return Ar(e).bind((function(e){if(wr.test(e)){var t=wr.exec(e);return f.some({width:a.constant(t[1]),unit:a.constant(t[3])})}return f.none()}))},setGenericWidth:function(e,t,n){Ht.set(e,"width",t+n)},getHeight:function(e){return function(e,t,n){return n(e)/Nr(e,t)}(e,"rowspan",Sr)},getRawWidth:Ar},Ir=function(e,t){_r.getGenericWidth(e).each((function(n){var r=n.width()/2;_r.setGenericWidth(e,r,n.unit()),_r.setGenericWidth(t,r,n.unit())}))},Br=function(e,t){var n=t||$.fromDom(document.documentElement);return Ct.ancestor(e,a.curry(Ue.eq,n)).isSome()},Pr=function(e){var t=e.dom();return t===t.window?e:ot.isDocument(e)?t.defaultView||t.parentWindow:null},Dr=function(e,t){return{left:a.constant(e),top:a.constant(t),translate:function(n,r){return Dr(e+n,t+r)}}},Or=function(e,t){return void 0!==e?e:void 0!==t?t:0},Mr=function(e){var t=e.dom(),n=t.ownerDocument,r=n.body,o=$.fromDom(n.documentElement);return r===t?Dr(r.offsetLeft,r.offsetTop):Br(e,o)?function(e){var t=e.getBoundingClientRect();return Dr(t.left,t.top)}(t):Dr(0,0)},Lr=function(e){var t=e.dom().ownerDocument,n=t.body,r=Pr($.fromDom(t)),o=t.documentElement,i=Or(r.pageYOffset,o.scrollTop),a=Or(r.pageXOffset,o.scrollLeft),c=Or(o.clientTop,n.clientTop),s=Or(o.clientLeft,n.clientLeft);return Mr(e).translate(a-s,i-c)},Fr=L.immutable("row","y"),jr=L.immutable("col","x"),Hr=function(e){return Lr(e).left()+vr(e)},Ur=function(e){return Lr(e).left()},Wr=function(e,t){return jr(e,Ur(t))},zr=function(e,t){return jr(e,Hr(t))},qr=function(e){return Lr(e).top()},Vr=function(e,t,n){if(0===n.length)return[];var r=A.map(n.slice(1),(function(t,n){return t.map((function(t){return e(n,t)}))})),o=n[n.length-1].map((function(e){return t(n.length-1,e)}));return r.concat([o])},$r={delta:a.identity,positions:a.curry(Vr,(function(e,t){return Fr(e,qr(t))}),(function(e,t){return Fr(e,qr(t)+pr(t))})),edge:qr},Kr={delta:a.identity,edge:Ur,positions:a.curry(Vr,Wr,zr)},Jr={height:$r,rtl:{delta:function(e,t){return-e},edge:Hr,positions:a.curry(Vr,zr,Wr)},ltr:Kr},Gr={ltr:Jr.ltr,rtl:Jr.rtl};function Xr(e){var t=function(t){return e(t).isRtl()?Gr.rtl:Gr.ltr};return{delta:function(e,n){return t(n).delta(e,n)},edge:function(e){return t(e).edge(e)},positions:function(e,n){return t(n).positions(e,n)}}}var Yr=function(e){var t=Rt(e);return Pt.generate(t).grid()},Qr=function(e){var t=e,n=function(){return t};return{get:n,set:function(e){t=e},clone:function(){return Qr(n())}}},Zr=function(e,t){return eo(e,t,{validate:p.isFunction,label:"function"})},eo=function(e,t,n){if(0===t.length)throw new Error("You must specify at least one required field.");return M.validateStrArr("required",t),M.checkDupes(t),function(r){var o=D.keys(r);A.forall(t,(function(e){return A.contains(o,e)}))||M.reqMessage(t,o),e(t,o);var i=A.filter(t,(function(e){return!n.validate(r[e],e)}));return i.length>0&&M.invalidTypeMessage(i,n.label),r}},to=a.noop,no={exactly:a.curry(Zr,(function(e,t){var n=A.filter(t,(function(t){return!A.contains(e,t)}));n.length>0&&M.unsuppMessage(n)})),ensure:a.curry(Zr,to),ensureWith:a.curry(eo,to)},ro=function(e){var t=lt.has(e,"colspan")?parseInt(lt.get(e,"colspan"),10):1,n=lt.has(e,"rowspan")?parseInt(lt.get(e,"rowspan"),10):1;return{element:a.constant(e),colspan:a.constant(t),rowspan:a.constant(n)}},oo=no.exactly(["cell","row","replace","gap"]),io=function(e,t){oo(e);var n=Qr(f.none()),r=void 0!==t?t:ro,o=function(t){return function(t){return e.cell(t)}(r(t))},i=function(e){var t=o(e);return n.get().isNone()&&n.set(f.some(t)),a=f.some({item:e,replacement:t}),t},a=f.none();return{getOrInit:function(e,t){return a.fold((function(){return i(e)}),(function(n){return t(e,n.item)?n.replacement:i(e)}))},cursor:n.get}},ao=function(e,t){return function(n){var r=Qr(f.none());oo(n);var o=[],i=function(i){var a=n.replace(i,t,{scope:e});return o.push({item:i,sub:a}),r.get().isNone()&&r.set(f.some(a)),a};return{replaceOrInit:function(e,t){return function(e,t){return A.find(o,(function(n){return t(n.item,e)}))}(e,t).fold((function(){return i(e)}),(function(n){return t(e,n.item)?n.sub:i(e)}))},cursor:r.get}}},co=function(e){oo(e);var t=Qr(f.none());return{combine:function(n){return t.get().isNone()&&t.set(f.some(n)),function(){var t=e.cell({element:a.constant(n),colspan:a.constant(1),rowspan:a.constant(1)});return Ht.remove(t,"width"),Ht.remove(n,"width"),t}},cursor:t.get}},so=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],lo=function(e,t){var n=e.property().name(t);return A.contains(so,n)},uo=function(e,t){return A.contains(["br","img","hr","input"],e.property().name(t))},fo=lo,mo=function(e,t){var n=e.property().name(t);return A.contains(["ol","ul"],n)},po=uo,go=Cn(),ho=function(e){return fo(go,e)},vo=function(e){return mo(go,e)},bo=function(e){return po(go,e)},yo=function(e){var t,n=function(e){return"br"===ot.name(e)},r=function(e){return dn.last(e).bind((function(t){var r,o=(r=t,Ge.nextSibling(r).map((function(e){return!!ho(e)||(bo(e)?"img"!==ot.name(e):void 0)})).getOr(!1));return Ge.parent(t).map((function(r){return!0===o||function(e){return"li"===ot.name(e)||Ct.ancestor(e,vo).isSome()}(r)||n(t)||ho(r)&&!Ue.eq(e,r)?[]:[$.fromTag("br")]}))})).getOr([])},o=0===(t=A.bind(e,(function(e){var t=Ge.children(e);return function(e){return A.forall(e,(function(e){return n(e)||ot.isText(e)&&0===on.get(e).trim().length}))}(t)?[]:t.concat(r(e))}))).length?[$.fromTag("br")]:t;$t.empty(e[0]),qt.append(e[0],o)},Co=function(e){return function(){for(var t=new Array(arguments.length),n=0;n<t.length;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<t.length;o++){var i=t[o];for(var a in i)i.hasOwnProperty(a)&&(r[a]=e(r[a],i[a]))}return r}},wo=Co((function(e,t){return p.isObject(e)&&p.isObject(t)?wo(e,t):t})),xo=Co((function(e,t){return t})),ko={deepMerge:wo,merge:xo},To=function(e){for(var t=[],n=function(e){t.push(e)},r=0;r<e.length;r++)e[r].each(n);return t},Eo=function(e,t){for(var n=0;n<e.length;n++){var r=t(e[n],n);if(r.isSome())return r}return f.none()},So=function(e,t){return q.rowcells(t,e.section())},No=function(e,t){return e.cells()[t]},Ao={addCell:function(e,t,n){var r=e.cells(),o=r.slice(0,t),i=r.slice(t),a=o.concat([n]).concat(i);return So(e,a)},setCells:So,mutateCell:function(e,t,n){e.cells()[t]=n},getCell:No,getCellElement:function(e,t){return No(e,t).element()},mapCells:function(e,t){var n=e.cells(),r=A.map(n,t);return q.rowcells(r,e.section())},cellLength:function(e){return e.cells().length}},Ro=function(e,t){if(0===e.length)return 0;var n=e[0];return A.findIndex(e,(function(e){return!t(n.element(),e.element())})).fold((function(){return e.length}),(function(e){return e}))},_o=function(e,t,n,r){var o=function(e,t){return e[t]}(e,t).cells().slice(n),i=Ro(o,r),c=function(e,t){return A.map(e,(function(e){return Ao.getCell(e,t)}))}(e,n).slice(t),s=Ro(c,r);return{colspan:a.constant(i),rowspan:a.constant(s)}},Io=function(e,t){var n=A.map(e,(function(e,t){return A.map(e.cells(),(function(e,t){return!1}))}));return A.map(e,(function(r,o){var i=A.bind(r.cells(),(function(r,i){if(!1===n[o][i]){var a=_o(e,o,i,t);return function(e,t,r,o){for(var i=e;i<e+r;i++)for(var a=t;a<t+o;a++)n[i][a]=!0}(o,i,a.rowspan(),a.colspan()),[q.detailnew(r.element(),a.rowspan(),a.colspan(),r.isNew())]}return[]}));return q.rowdetails(i,r.section())}))},Bo=function(e,t,n){for(var r=[],o=0;o<e.grid().rows();o++){for(var i=[],a=0;a<e.grid().columns();a++){var c=Pt.getAt(e,o,a).map((function(e){return q.elementnew(e.element(),n)})).getOrThunk((function(){return q.elementnew(t.gap(),!0)}));i.push(c)}var s=q.rowcells(i,e.all()[o].section());r.push(s)}return r},Po=function(e,t,n,r){n===r?lt.remove(e,t):lt.set(e,t,n)},Do=function(e,t){var n=[],r=[],o=function(t,o){t.length>0?function(t,o){var i=xt.child(e,o).getOrThunk((function(){var t=$.fromTag(o,Ge.owner(e).dom());return zt.append(e,t),t}));$t.empty(i);var a=A.map(t,(function(e){e.isNew()&&n.push(e.element());var t=e.element();return $t.empty(t),A.each(e.cells(),(function(e){e.isNew()&&r.push(e.element()),Po(e.element(),"colspan",e.colspan(),1),Po(e.element(),"rowspan",e.rowspan(),1),zt.append(t,e.element())})),t}));qt.append(i,a)}(t,o):function(t){xt.child(e,t).bind($t.remove)}(o)},i=[],c=[],s=[];return A.each(t,(function(e){switch(e.section()){case"thead":i.push(e);break;case"tbody":c.push(e);break;case"tfoot":s.push(e)}})),o(i,"thead"),o(c,"tbody"),o(s,"tfoot"),{newRows:a.constant(n),newCells:a.constant(r)}},Oo=function(e){return A.map(e,(function(e){var t=en(e.element());return A.each(e.cells(),(function(e){var n=tn(e.element());Po(n,"colspan",e.colspan(),1),Po(n,"rowspan",e.rowspan(),1),zt.append(t,n)})),t}))},Mo=function(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n},Lo=function(e,t){for(var n=[],r=e;r<t;r++)n.push(r);return n},Fo=function(e,t){if(t<0||t>=e.length-1)return f.none();var n=e[t].fold((function(){var n=A.reverse(e.slice(0,t));return Eo(n,(function(e,t){return e.map((function(e){return{value:e,delta:t+1}}))}))}),(function(e){return f.some({value:e,delta:0})})),r=e[t+1].fold((function(){var n=e.slice(t+1);return Eo(n,(function(e,t){return e.map((function(e){return{value:e,delta:t+1}}))}))}),(function(e){return f.some({value:e,delta:1})}));return n.bind((function(e){return r.map((function(t){var n=t.delta+e.delta;return Math.abs(t.value-e.value)/n}))}))},jo=function(e,t,n){var r=e();return A.find(r,t).orThunk((function(){return f.from(r[0]).orThunk(n)})).map((function(e){return e.element()}))},Ho=function(e){var t=e.grid(),n=Lo(0,t.columns()),r=Lo(0,t.rows());return A.map(n,(function(t){return jo((function(){return A.bind(r,(function(n){return Pt.getAt(e,n,t).filter((function(e){return e.column()===t})).fold(a.constant([]),(function(e){return[e]}))}))}),(function(e){return 1===e.colspan()}),(function(){return Pt.getAt(e,0,t)}))}))},Uo=function(e){var t=e.grid(),n=Lo(0,t.rows()),r=Lo(0,t.columns());return A.map(n,(function(t){return jo((function(){return A.bind(r,(function(n){return Pt.getAt(e,t,n).filter((function(e){return e.row()===t})).fold(a.constant([]),(function(e){return[e]}))}))}),(function(e){return 1===e.rowspan()}),(function(){return Pt.getAt(e,t,0)}))}))},Wo=function(e,t,n,r,o){var i=$.fromTag("div");return Ht.setAll(i,{position:"absolute",left:t-r/2+"px",top:n+"px",height:o+"px",width:r+"px"}),lt.setAll(i,{"data-column":e,role:"presentation"}),i},zo=function(e,t,n,r,o){var i=$.fromTag("div");return Ht.setAll(i,{position:"absolute",left:t+"px",top:n-o/2+"px",height:o+"px",width:r+"px"}),lt.setAll(i,{"data-row":e,role:"presentation"}),i},qo=function(e){var t=e.replace(/\./g,"-");return{resolve:function(e){return t+"-"+e}}},Vo={resolve:qo("ephox-snooker").resolve},$o=function(e,t){var n=lt.get(e,t);return void 0===n||""===n?[]:n.split(" ")},Ko=$o,Jo=function(e,t,n){var r=$o(e,t).concat([n]);lt.set(e,t,r.join(" "))},Go=function(e,t,n){var r=A.filter($o(e,t),(function(e){return e!==n}));r.length>0?lt.set(e,t,r.join(" ")):lt.remove(e,t)},Xo=function(e){return Ko(e,"class")},Yo=function(e,t){return Jo(e,"class",t)},Qo=function(e,t){return Go(e,"class",t)},Zo=Xo,ei=Yo,ti=Qo,ni=function(e,t){A.contains(Xo(e),t)?Qo(e,t):Yo(e,t)},ri=function(e){return void 0!==e.dom().classList},oi=function(e,t){return ri(e)&&e.dom().classList.contains(t)},ii={add:function(e,t){ri(e)?e.dom().classList.add(t):ei(e,t)},remove:function(e,t){ri(e)?e.dom().classList.remove(t):ti(e,t),function(e){0===(ri(e)?e.dom().classList:Zo(e)).length&&lt.remove(e,"class")}(e)},toggle:function(e,t){return ri(e)?e.dom().classList.toggle(t):ni(e,t)},toggler:function(e,t){var n=ri(e),r=e.dom().classList;return function(e,t,n){var r=n||!1,o=function(){t(),r=!0},i=function(){e(),r=!1};return{on:o,off:i,toggle:function(){(r?i:o)()},isOn:function(){return r}}}((function(){n?r.remove(t):ti(e,t)}),(function(){n?r.add(t):ei(e,t)}),oi(e,t))},has:oi},ai=Vo.resolve("resizer-bar"),ci=Vo.resolve("resizer-rows"),si=Vo.resolve("resizer-cols"),li=function(e){var t=gt.descendants(e.parent(),"."+ai);A.each(t,$t.remove)},ui=function(e,t,n){var r=e.origin();A.each(t,(function(t,o){t.each((function(t){var o=n(r,t);ii.add(o,ai),zt.append(e.parent(),o)}))}))},di=function(e,t,n,r,o,i){var a=Lr(t);!function(e,t,n,r){ui(e,t,(function(e,t){var o=zo(t.row(),n.left()-e.left(),t.y()-e.top(),r,7);return ii.add(o,ci),o}))}(e,n.length>0?o.positions(n,t):[],a,vr(t)),function(e,t,n,r){ui(e,t,(function(e,t){var o=Wo(t.col(),t.x()-e.left(),n.top()-e.top(),7,r);return ii.add(o,si),o}))}(e,r.length>0?i.positions(r,t):[],a,pr(t))},fi=function(e,t){var n=gt.descendants(e.parent(),"."+ai);A.each(n,t)},mi={refresh:function(e,t,n,r){li(e);var o=Rt(t),i=Pt.generate(o),a=Uo(i),c=Ho(i);di(e,t,a,c,n,r)},hide:function(e){fi(e,(function(e){Ht.set(e,"display","none")}))},show:function(e){fi(e,(function(e){Ht.set(e,"display","block")}))},destroy:li,isRowBar:function(e){return ii.has(e,ci)},isColBar:function(e){return ii.has(e,si)}},pi=function(e,t){return A.map(e,(function(e){var n=function(e){return Eo(e,(function(e){return Ge.parent(e.element()).map((function(e){var t=Ge.parent(e).isNone();return q.elementnew(e,t)}))})).getOrThunk((function(){return q.elementnew(t.row(),!0)}))}(e.details());return q.rowdatanew(n.element(),e.details(),e.section(),n.isNew())}))},gi=function(e,t){var n=Io(e,Ue.eq);return pi(n,t)},hi=function(e,t){var n=A.flatten(A.map(e.all(),(function(e){return e.cells()})));return A.find(n,(function(e){return Ue.eq(t,e.element())}))},vi=function(e,t,n,r,o){return function(i,c,s,l,u){var d=Rt(c),m=Pt.generate(d);return t(m,s).map((function(t){var n=function(e,t){return Bo(e,t,!1)}(m,l),r=e(n,t,Ue.eq,o(l)),i=gi(r.grid(),l);return{grid:a.constant(i),cursor:r.cursor}})).fold((function(){return f.none()}),(function(e){var t=Do(c,e.grid());return n(c,e.grid(),u),r(c),mi.refresh(i,c,Jr.height,u),f.some({cursor:e.cursor,newRows:t.newRows,newCells:t.newCells})}))}},bi=gi,yi=function(e,t){return At.cell(t.element()).bind((function(t){return hi(e,t)}))},Ci=function(e,t){var n=A.map(t.selection(),(function(t){return At.cell(t).bind((function(t){return hi(e,t)}))})),r=To(n);return r.length>0?f.some(r):f.none()},wi=function(e,t){return At.cell(t.element()).bind((function(n){return hi(e,n).map((function(e){return ko.merge(e,{generators:t.generators,clipboard:t.clipboard})}))}))},xi=function(e,t){var n=A.map(t.selection(),(function(t){return At.cell(t).bind((function(t){return hi(e,t)}))})),r=To(n);return r.length>0?f.some(ko.merge({cells:r},{generators:t.generators,clipboard:t.clipboard})):f.none()},ki=function(e,t){return t.mergable()},Ti=function(e,t){return t.unmergable()},Ei=function(e){return{is:function(t){return e===t},isValue:a.always,isError:a.never,getOr:a.constant(e),getOrThunk:a.constant(e),getOrDie:a.constant(e),or:function(t){return Ei(e)},orThunk:function(t){return Ei(e)},fold:function(t,n){return n(e)},map:function(t){return Ei(t(e))},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOption:function(){return f.some(e)}}},Si=function(e){return{is:a.never,isValue:a.never,isError:a.always,getOr:a.identity,getOrThunk:function(e){return e()},getOrDie:function(){return a.die(String(e))()},or:function(e){return e},orThunk:function(e){return e()},fold:function(t,n){return t(e)},map:function(t){return Si(e)},each:a.noop,bind:function(t){return Si(e)},exists:a.never,forall:a.always,toOption:f.none}},Ni={value:Ei,error:Si},Ai=function(e,t){return A.map(e,(function(){return q.elementnew(t.cell(),!0)}))},Ri=function(e,t,n){return e.concat(Mo(t,(function(t){return Ao.setCells(e[e.length-1],Ai(e[e.length-1].cells(),n))})))},_i=function(e,t,n){return A.map(e,(function(e){return Ao.setCells(e,e.cells().concat(Ai(Lo(0,t),n)))}))},Ii=function(e,t,n){if(e.row()>=t.length||e.column()>Ao.cellLength(t[0]))return Ni.error("invalid start address out of table bounds, row: "+e.row()+", column: "+e.column());var r=t.slice(e.row()),o=r[0].cells().slice(e.column()),i=Ao.cellLength(n[0]),c=n.length;return Ni.value({rowDelta:a.constant(r.length-c),colDelta:a.constant(o.length-i)})},Bi=function(e,t){var n=Ao.cellLength(e[0]),r=Ao.cellLength(t[0]);return{rowDelta:a.constant(0),colDelta:a.constant(n-r)}},Pi=function(e,t,n){var r=t.colDelta()<0?_i:a.identity;return(t.rowDelta()<0?Ri:a.identity)(r(e,Math.abs(t.colDelta()),n),Math.abs(t.rowDelta()),n)},Di=function(e,t,n,r){if(0===e.length)return e;for(var o=t.startRow();o<=t.finishRow();o++)for(var i=t.startCol();i<=t.finishCol();i++)Ao.mutateCell(e[o],i,q.elementnew(r(),!1));return e},Oi=function(e,t,n,r){for(var o=!0,i=0;i<e.length;i++)for(var a=0;a<Ao.cellLength(e[0]);a++){var c=n(Ao.getCellElement(e[i],a),t);!0===c&&!1===o?Ao.mutateCell(e[i],a,q.elementnew(r(),!0)):!0===c&&(o=!1)}return e},Mi=function(e,t,n,r){if(t>0&&t<e.length){var o=function(e,t){return A.foldl(e,(function(e,n){return A.exists(e,(function(e){return t(e.element(),n.element())}))?e:e.concat([n])}),[])}(e[t-1].cells(),n);A.each(o,(function(o){for(var i=f.none(),a=t;a<e.length;a++)for(var c=0;c<Ao.cellLength(e[0]);c++){var s=e[a].cells()[c];n(s.element(),o.element())&&(i.isNone()&&(i=f.some(r())),i.each((function(t){Ao.mutateCell(e[a],c,q.elementnew(t,!0))})))}}))}return e},Li=function(e,t,n,r){var o=Ao.getCell(e[t],n),i=a.curry(r,o.element()),c=e[t];return e.length>1&&Ao.cellLength(c)>1&&(n>0&&i(Ao.getCellElement(c,n-1))||n<c.length-1&&i(Ao.getCellElement(c,n+1))||t>0&&i(Ao.getCellElement(e[t-1],n))||t<e.length-1&&i(Ao.getCellElement(e[t+1],n)))},Fi=function(e,t,n,r,o){return Ii(e,t,n).map((function(i){var a=Pi(t,i,r);return function(e,t,n,r,o){for(var i=e.row(),a=e.column(),c=i+n.length,s=a+Ao.cellLength(n[0]),l=i;l<c;l++)for(var u=a;u<s;u++){Li(t,l,u,o)&&Oi(t,Ao.getCellElement(t[l],u),o,r.cell);var d=Ao.getCellElement(n[l-i],u-a),f=r.replace(d);Ao.mutateCell(t[l],u,q.elementnew(f,!0))}return t}(e,a,n,r,o)}))},ji=function(e,t,n,r,o){Mi(t,e,o,r.cell);var i=Bi(n,t),a=Pi(n,i,r),c=Bi(t,a),s=Pi(t,c,r);return s.slice(0,e).concat(a).concat(s.slice(e,s.length))},Hi=function(e,t,n,r,o){var i=e.slice(0,t),a=e.slice(t),c=Ao.mapCells(e[n],(function(n,i){return t>0&&t<e.length&&r(Ao.getCellElement(e[t-1],i),Ao.getCellElement(e[t],i))?Ao.getCell(e[t],i):q.elementnew(o(n.element(),r),!0)}));return i.concat([c]).concat(a)},Ui=function(e,t,n,r,o){return A.map(e,(function(e){var i=t>0&&t<Ao.cellLength(e)&&r(Ao.getCellElement(e,t-1),Ao.getCellElement(e,t))?Ao.getCell(e,t):q.elementnew(o(Ao.getCellElement(e,n),r),!0);return Ao.addCell(e,t,i)}))},Wi=function(e,t,n,r,o){var i=n+1;return A.map(e,(function(e,a){var c=a===t?q.elementnew(o(Ao.getCellElement(e,n),r),!0):Ao.getCell(e,n);return Ao.addCell(e,i,c)}))},zi=function(e,t,n,r,o){var i=t+1,a=e.slice(0,i),c=e.slice(i),s=Ao.mapCells(e[t],(function(e,t){return t===n?q.elementnew(o(e.element(),r),!0):e}));return a.concat([s]).concat(c)},qi=function(e,t,n){return e.slice(0,t).concat(e.slice(n+1))},Vi=function(e,t,n){var r=A.map(e,(function(e){var r=e.cells().slice(0,t).concat(e.cells().slice(n+1));return q.rowcells(r,e.section())}));return A.filter(r,(function(e){return e.cells().length>0}))},$i=function(e,t,n,r){return A.map(e,(function(e){return Ao.mapCells(e,(function(e){return function(e){return A.exists(t,(function(t){return n(e.element(),t.element())}))}(e)?q.elementnew(r(e.element(),n),!0):e}))}))},Ki=function(e,t,n,r){return void 0!==Ao.getCellElement(e[t],n)&&t>0&&r(Ao.getCellElement(e[t-1],n),Ao.getCellElement(e[t],n))},Ji=function(e,t,n){return t>0&&n(Ao.getCellElement(e,t-1),Ao.getCellElement(e,t))},Gi=function(e,t,n,r){var o=A.bind(e,(function(r,o){return Ki(e,o,t,n)||Ji(r,t,n)?[]:[Ao.getCell(r,t)]}));return $i(e,o,n,r)},Xi=function(e,t,n,r){var o=e[t],i=A.bind(o.cells(),(function(r,i){return Ki(e,t,i,n)||Ji(o,i,n)?[]:[r]}));return $i(e,i,n,r)},Yi=function(e){return{fold:e}},Qi=function(){return Yi((function(e,t,n,r,o){return e()}))},Zi=function(e){return Yi((function(t,n,r,o,i){return n(e)}))},ea=function(e,t){return Yi((function(n,r,o,i,a){return o(e,t)}))},ta=function(e,t,n){return Yi((function(r,o,i,a,c){return a(e,t,n)}))},na=function(e,t){return Yi((function(n,r,o,i,a){return a(e,t)}))},ra=function(e,t,n,r){var o=e.slice(0),i=function(e,t){return 0===e.length?Qi():1===e.length?Zi(0):0===t?ea(0,1):t===e.length-1?na(t-1,t):t>0&&t<e.length-1?ta(t-1,t,t+1):Qi()}(e,t),c=function(e){return A.map(e,a.constant(0))},s=a.constant(c(o)),l=function(e,t){if(n>=0){var i=Math.max(r.minCellWidth(),o[t]-n);return c(o.slice(0,e)).concat([n,i-o[t]]).concat(c(o.slice(t+1)))}var a=Math.max(r.minCellWidth(),o[e]+n),s=o[e]-a;return c(o.slice(0,e)).concat([a-o[e],s]).concat(c(o.slice(t+1)))},u=l;return i.fold(s,(function(e){return r.singleColumnWidth(o[e],n)}),u,(function(e,t,n){return l(t,n)}),(function(e,t){if(n>=0)return c(o.slice(0,t)).concat([n]);var i=Math.max(r.minCellWidth(),o[t]+n);return c(o.slice(0,t)).concat([i-o[t]])}))},oa=function(e,t){return lt.has(e,t)&&parseInt(lt.get(e,t),10)>1},ia={hasColspan:function(e){return oa(e,"colspan")},hasRowspan:function(e){return oa(e,"rowspan")},minWidth:a.constant(10),minHeight:a.constant(10),getInt:function(e,t){return parseInt(Ht.get(e,t),10)}},aa=function(e,t,n){return Ht.getRaw(e,t).fold((function(){return n(e)+"px"}),(function(e){return e}))},ca=function(e){return aa(e,"width",_r.getPixelWidth)},sa=function(e){return aa(e,"height",_r.getHeight)},la=function(e,t,n,r,o){var i=Ho(e),c=A.map(i,(function(e){return e.map(t.edge)}));return A.map(i,(function(e,t){return e.filter(a.not(ia.hasColspan)).fold((function(){var e=Fo(c,t);return r(e)}),(function(e){return n(e,o)}))}))},ua=function(e){return e.map((function(e){return e+"px"})).getOr("")},da=function(e,t,n,r){var o=Uo(e),i=A.map(o,(function(e){return e.map(t.edge)}));return A.map(o,(function(e,t){return e.filter(a.not(ia.hasRowspan)).fold((function(){var e=Fo(i,t);return r(e)}),(function(e){return n(e)}))}))},fa={getRawWidths:function(e,t){return la(e,t,ca,ua)},getPixelWidths:function(e,t,n){return la(e,t,_r.getPixelWidth,(function(e){return e.getOrThunk(n.minCellWidth)}),n)},getPercentageWidths:function(e,t,n){return la(e,t,_r.getPercentageWidth,(function(e){return e.fold((function(){return n.minCellWidth()}),(function(e){return e/n.pixelWidth()*100}))}),n)},getPixelHeights:function(e,t){return da(e,t,_r.getHeight,(function(e){return e.getOrThunk(ia.minHeight)}))},getRawHeights:function(e,t){return da(e,t,sa,ua)}},ma=function(e,t,n){for(var r=0,o=e;o<t;o++)r+=void 0!==n[o]?n[o]:0;return r},pa=function(e,t){var n=Pt.justCells(e);return A.map(n,(function(e){var n=ma(e.column(),e.column()+e.colspan(),t);return{element:e.element,width:a.constant(n),colspan:e.colspan}}))},ga=function(e,t){var n=Pt.justCells(e);return A.map(n,(function(e){var n=ma(e.row(),e.row()+e.rowspan(),t);return{element:e.element,height:a.constant(n),rowspan:e.rowspan}}))},ha=function(e,t){return A.map(e.all(),(function(e,n){return{element:e.element,height:a.constant(t[n])}}))},va=function(e){var t=parseInt(e,10),n=a.identity;return{width:a.constant(t),pixelWidth:a.constant(t),getWidths:fa.getPixelWidths,getCellDelta:n,singleColumnWidth:function(e,t){return[Math.max(ia.minWidth(),e+t)-e]},minCellWidth:ia.minWidth,setElementWidth:_r.setPixelWidth,setTableWidth:function(e,t,n){var r=A.foldr(t,(function(e,t){return e+t}),0);_r.setPixelWidth(e,r)}}},ba=function(e,t){if(_r.percentageBasedSizeRegex().test(t))return function(e,t){var n=parseFloat(e),r=hr(t);return{width:a.constant(n),pixelWidth:a.constant(r),getWidths:fa.getPercentageWidths,getCellDelta:function(e){return e/r*100},singleColumnWidth:function(e,t){return[100-e]},minCellWidth:function(){return ia.minWidth()/r*100},setElementWidth:_r.setPercentageWidth,setTableWidth:function(e,t,r){var o=n+r;_r.setPercentageWidth(e,o)}}}(_r.percentageBasedSizeRegex().exec(t)[1],e);if(_r.pixelBasedSizeRegex().test(t)){var n=_r.pixelBasedSizeRegex().exec(t);return va(n[1])}var r=hr(e);return va(r)},ya=function(e){return _r.getRawWidth(e).fold((function(){var t=hr(e);return va(t)}),(function(t){return ba(e,t)}))},Ca=function(e){return Pt.generate(e)},wa=function(e){var t=Rt(e);return Ca(t)},xa={adjustWidth:function(e,t,n,r){var o=ya(e),i=o.getCellDelta(t),a=wa(e),c=o.getWidths(a,r,o),s=ra(c,n,i,o),l=A.map(s,(function(e,t){return e+c[t]})),u=pa(a,l);A.each(u,(function(e){o.setElementWidth(e.element(),e.width())})),n===a.grid().columns()-1&&o.setTableWidth(e,l,i)},adjustHeight:function(e,t,n,r){var o=wa(e),i=fa.getPixelHeights(o,r),a=A.map(i,(function(e,r){return n===r?Math.max(t+e,ia.minHeight()):e})),c=ga(o,a),s=ha(o,a);A.each(s,(function(e){_r.setHeight(e.element(),e.height())})),A.each(c,(function(e){_r.setHeight(e.element(),e.height())}));var l,u=(l=a,A.foldr(l,(function(e,t){return e+t}),0));_r.setHeight(e,u)},adjustWidthTo:function(e,t,n){var r=ya(e),o=Ca(t),i=r.getWidths(o,n,r),a=pa(o,i);A.each(a,(function(e){r.setElementWidth(e.element(),e.width())}));var c=A.foldr(i,(function(e,t){return t+e}),0);a.length>0&&r.setElementWidth(e,c)}},ka=function(e){0===At.cells(e).length&&$t.remove(e)},Ta=L.immutable("grid","cursor"),Ea=function(e,t,n){return Sa(e,t,n).orThunk((function(){return Sa(e,0,0)}))},Sa=function(e,t,n){return f.from(e[t]).bind((function(e){return f.from(e.cells()[n]).bind((function(e){return f.from(e.element())}))}))},Na=function(e,t,n){return Ta(e,Sa(e,t,n))},Aa=function(e){return A.foldl(e,(function(e,t){return A.exists(e,(function(e){return e.row()===t.row()}))?e:e.concat([t])}),[]).sort((function(e,t){return e.row()-t.row()}))},Ra=function(e){return A.foldl(e,(function(e,t){return A.exists(e,(function(e){return e.column()===t.column()}))?e:e.concat([t])}),[]).sort((function(e,t){return e.column()-t.column()}))},_a=function(e,t,n){var r=_t(e,n),o=Pt.generate(r);return Bo(o,t,!0)},Ia=xa.adjustWidthTo,Ba={insertRowBefore:vi((function(e,t,n,r){var o=t.row(),i=t.row(),a=Hi(e,i,o,n,r.getOrInit);return Na(a,i,t.column())}),yi,a.noop,a.noop,io),insertRowsBefore:vi((function(e,t,n,r){var o=t[0].row(),i=t[0].row(),a=Aa(t),c=A.foldl(a,(function(e,t){return Hi(e,i,o,n,r.getOrInit)}),e);return Na(c,i,t[0].column())}),Ci,a.noop,a.noop,io),insertRowAfter:vi((function(e,t,n,r){var o=t.row(),i=t.row()+t.rowspan(),a=Hi(e,i,o,n,r.getOrInit);return Na(a,i,t.column())}),yi,a.noop,a.noop,io),insertRowsAfter:vi((function(e,t,n,r){var o=Aa(t),i=o[o.length-1].row(),a=o[o.length-1].row()+o[o.length-1].rowspan(),c=A.foldl(o,(function(e,t){return Hi(e,a,i,n,r.getOrInit)}),e);return Na(c,a,t[0].column())}),Ci,a.noop,a.noop,io),insertColumnBefore:vi((function(e,t,n,r){var o=t.column(),i=t.column(),a=Ui(e,i,o,n,r.getOrInit);return Na(a,t.row(),i)}),yi,Ia,a.noop,io),insertColumnsBefore:vi((function(e,t,n,r){var o=Ra(t),i=o[0].column(),a=o[0].column(),c=A.foldl(o,(function(e,t){return Ui(e,a,i,n,r.getOrInit)}),e);return Na(c,t[0].row(),a)}),Ci,Ia,a.noop,io),insertColumnAfter:vi((function(e,t,n,r){var o=t.column(),i=t.column()+t.colspan(),a=Ui(e,i,o,n,r.getOrInit);return Na(a,t.row(),i)}),yi,Ia,a.noop,io),insertColumnsAfter:vi((function(e,t,n,r){var o=t[t.length-1].column(),i=t[t.length-1].column()+t[t.length-1].colspan(),a=Ra(t),c=A.foldl(a,(function(e,t){return Ui(e,i,o,n,r.getOrInit)}),e);return Na(c,t[0].row(),i)}),Ci,Ia,a.noop,io),splitCellIntoColumns:vi((function(e,t,n,r){var o=Wi(e,t.row(),t.column(),n,r.getOrInit);return Na(o,t.row(),t.column())}),yi,Ia,a.noop,io),splitCellIntoRows:vi((function(e,t,n,r){var o=zi(e,t.row(),t.column(),n,r.getOrInit);return Na(o,t.row(),t.column())}),yi,a.noop,a.noop,io),eraseColumns:vi((function(e,t,n,r){var o=Ra(t),i=Vi(e,o[0].column(),o[o.length-1].column()),a=Ea(i,t[0].row(),t[0].column());return Ta(i,a)}),Ci,Ia,ka,io),eraseRows:vi((function(e,t,n,r){var o=Aa(t),i=qi(e,o[0].row(),o[o.length-1].row()),a=Ea(i,t[0].row(),t[0].column());return Ta(i,a)}),Ci,a.noop,ka,io),makeColumnHeader:vi((function(e,t,n,r){var o=Gi(e,t.column(),n,r.replaceOrInit);return Na(o,t.row(),t.column())}),yi,a.noop,a.noop,ao("row","th")),unmakeColumnHeader:vi((function(e,t,n,r){var o=Gi(e,t.column(),n,r.replaceOrInit);return Na(o,t.row(),t.column())}),yi,a.noop,a.noop,ao(null,"td")),makeRowHeader:vi((function(e,t,n,r){var o=Xi(e,t.row(),n,r.replaceOrInit);return Na(o,t.row(),t.column())}),yi,a.noop,a.noop,ao("col","th")),unmakeRowHeader:vi((function(e,t,n,r){var o=Xi(e,t.row(),n,r.replaceOrInit);return Na(o,t.row(),t.column())}),yi,a.noop,a.noop,ao(null,"td")),mergeCells:vi((function(e,t,n,r){var o=t.cells();yo(o);var i=Di(e,t.bounds(),n,a.constant(o[0]));return Ta(i,f.from(o[0]))}),ki,a.noop,a.noop,co),unmergeCells:vi((function(e,t,n,r){var o=A.foldr(t,(function(e,t){return Oi(e,t,n,r.combine(t))}),e);return Ta(o,f.from(t[0]))}),Ti,Ia,a.noop,co),pasteCells:vi((function(e,t,n,r){var o=function(e,t){var n=Rt(e),r=Pt.generate(n);return Bo(r,t,!0)}(t.clipboard(),t.generators()),i=q.address(t.row(),t.column());return Fi(i,e,o,t.generators(),n).fold((function(){return Ta(e,f.some(t.element()))}),(function(e){var n=Ea(e,t.row(),t.column());return Ta(e,n)}))}),wi,Ia,a.noop,io),pasteRowsBefore:vi((function(e,t,n,r){var o=e[t.cells[0].row()],i=t.cells[0].row(),a=_a(t.clipboard(),t.generators(),o),c=ji(i,e,a,t.generators(),n),s=Ea(c,t.cells[0].row(),t.cells[0].column());return Ta(c,s)}),xi,a.noop,a.noop,io),pasteRowsAfter:vi((function(e,t,n,r){var o=e[t.cells[0].row()],i=t.cells[t.cells.length-1].row()+t.cells[t.cells.length-1].rowspan(),a=_a(t.clipboard(),t.generators(),o),c=ji(i,e,a,t.generators(),n),s=Ea(c,t.cells[0].row(),t.cells[0].column());return Ta(c,s)}),xi,a.noop,a.noop,io)},Pa=function(e){return $.fromDom(e.getBody())},Da=function(e){return e.getBoundingClientRect().width},Oa=function(e){return e.getBoundingClientRect().height},Ma=function(e){return function(t){return Ue.eq(t,Pa(e))}},La=function(e){return/^[0-9]+$/.test(e)&&(e+="px"),e},Fa=function(e){return"rtl"===Ht.get(e,"direction")?"rtl":"ltr"},ja={onDirection:function(e,t){return function(n){return"rtl"===Fa(n)?t:e}},getDirection:Fa},Ha={isRtl:a.constant(!1)},Ua={isRtl:a.constant(!0)},Wa={directionAt:function(e){return"rtl"===ja.getDirection(e)?Ua:Ha}},za=["tableprops","tabledelete","|","tableinsertrowbefore","tableinsertrowafter","tabledeleterow","|","tableinsertcolbefore","tableinsertcolafter","tabledeletecol"],qa={"border-collapse":"collapse",width:"100%"},Va={border:"1"},$a=function(e){return e.getParam("table_default_attributes",Va,"object")},Ka=function(e){return e.getParam("table_default_styles",qa,"object")},Ja=function(e){return e.getParam("table_tab_navigation",!0,"boolean")},Ga=function(e){return e.getParam("table_cell_advtab",!0,"boolean")},Xa=function(e){return e.getParam("table_row_advtab",!0,"boolean")},Ya=function(e){return e.getParam("table_advtab",!0,"boolean")},Qa=function(e){return e.getParam("table_appearance_options",!0,"boolean")},Za=function(e){return e.getParam("table_style_by_css",!1,"boolean")},ec=function(e){return e.getParam("table_cell_class_list",[],"array")},tc=function(e){return e.getParam("table_row_class_list",[],"array")},nc=function(e){return e.getParam("table_class_list",[],"array")},rc=function(e){return!1===e.getParam("table_responsive_width")},oc=function(e,t){return e.fire("newrow",{node:t})},ic=function(e,t){return e.fire("newcell",{node:t})},ac=function(e,t,n,r){e.fire("ObjectResizeStart",{target:t,width:n,height:r})},cc=function(e,t,n,r){e.fire("ObjectResized",{target:t,width:n,height:r})},sc=function(e,t){var n=function(e){return"table"===ot.name(Pa(e))},r=function(e){var t=e.getParam("table_clone_elements");return p.isString(t)?f.some(t.split(/[ ,]/)):Array.isArray(t)?f.some(t):f.none()}(e),o=function(t,n,o,i){return function(a,c){var s=gt.descendants(a,"td[data-mce-style],th[data-mce-style]");A.each(s,(function(e){lt.remove(e,"data-mce-style")}));var l=i(),u=$.fromDom(e.getDoc()),d=Xr(Wa.directionAt),m=hn(o,u,r);return n(a)?t(l,a,c,m,d).bind((function(t){return A.each(t.newRows(),(function(t){oc(e,t.dom())})),A.each(t.newCells(),(function(t){ic(e,t.dom())})),t.cursor().map((function(t){var n=e.dom.createRng();return n.setStart(t.dom(),0),n.setEnd(t.dom(),0),n}))})):f.none()}};return{deleteRow:o(Ba.eraseRows,(function(t){var r=Yr(t);return!1===n(e)||r.rows()>1}),a.noop,t),deleteColumn:o(Ba.eraseColumns,(function(t){var r=Yr(t);return!1===n(e)||r.columns()>1}),a.noop,t),insertRowsBefore:o(Ba.insertRowsBefore,a.always,a.noop,t),insertRowsAfter:o(Ba.insertRowsAfter,a.always,a.noop,t),insertColumnsBefore:o(Ba.insertColumnsBefore,a.always,Ir,t),insertColumnsAfter:o(Ba.insertColumnsAfter,a.always,Ir,t),mergeCells:o(Ba.mergeCells,a.always,a.noop,t),unmergeCells:o(Ba.unmergeCells,a.always,a.noop,t),pasteRowsBefore:o(Ba.pasteRowsBefore,a.always,a.noop,t),pasteRowsAfter:o(Ba.pasteRowsAfter,a.always,a.noop,t),pasteCells:o(Ba.pasteCells,a.always,a.noop,t)}},lc=function(e,t,n){var r=Rt(e),o=Pt.generate(r);return Ci(o,t).map((function(e){var t=Bo(o,n,!1).slice(e[0].row(),e[e.length-1].row()+e[e.length-1].rowspan()),r=bi(t,n);return Oo(r)}))},uc=tinymce.util.Tools.resolve("tinymce.util.Tools"),dc={applyAlign:function(e,t,n){n&&e.formatter.apply("align"+n,{},t)},applyVAlign:function(e,t,n){n&&e.formatter.apply("valign"+n,{},t)},unApplyAlign:function(e,t){uc.each("left center right".split(" "),(function(n){e.formatter.remove("align"+n,{},t)}))},unApplyVAlign:function(e,t){uc.each("top middle bottom".split(" "),(function(n){e.formatter.remove("valign"+n,{},t)}))},getTDTHOverallStyle:function(e,t,n){var r;return r=function(t,r){for(var o=0;o<r.length;o++){var i=e.getStyle(r[o],n);if(void 0===t&&(t=i),t!==i)return""}return t}(r,e.select("td,th",t))}},fc=function(e,t){var n=e.dom,r=t.control.rootControl,o=r.toJSON(),i=n.parseStyle(o.style);"style"===t.control.name()?(r.find("#borderStyle").value(i["border-style"]||"")[0].fire("select"),r.find("#borderColor").value(i["border-color"]||"")[0].fire("change"),r.find("#backgroundColor").value(i["background-color"]||"")[0].fire("change"),r.find("#width").value(i.width||"").fire("change"),r.find("#height").value(i.height||"").fire("change")):(i["border-style"]=o.borderStyle,i["border-color"]=o.borderColor,i["background-color"]=o.backgroundColor,i.width=o.width?La(o.width):"",i.height=o.height?La(o.height):""),r.find("#style").value(n.serializeStyle(n.parseStyle(n.serializeStyle(i))))},mc={createStyleForm:function(e){var t=function(){var t=function(e){return e.getParam("color_picker_callback")}(e);if(t)return function(n){return t.call(e,(function(e){n.control.value(e).fire("change")}),n.control.value())}};return{title:"Advanced",type:"form",defaults:{onchange:a.curry(fc,e)},items:[{label:"Style",name:"style",type:"textbox"},{type:"form",padding:0,formItemDefaults:{layout:"grid",alignH:["start","right"]},defaults:{size:7},items:[{label:"Border style",type:"listbox",name:"borderStyle",width:90,onselect:a.curry(fc,e),values:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{label:"Border color",type:"colorbox",name:"borderColor",onaction:t()},{label:"Background color",type:"colorbox",name:"backgroundColor",onaction:t()}]}]}},buildListItems:function(e,t,n){var r=function(e,n){return n=n||[],uc.each(e,(function(e){var o={text:e.text||e.title};e.menu?o.menu=r(e.menu):(o.value=e.value,t&&t(o)),n.push(o)})),n};return r(e,n||[])},updateStyleField:fc,extractAdvancedStyles:function(e,t){var n=e.parseStyle(e.getAttrib(t,"style")),r={};return n["border-style"]&&(r.borderStyle=n["border-style"]),n["border-color"]&&(r.borderColor=n["border-color"]),n["background-color"]&&(r.backgroundColor=n["background-color"]),r.style=e.serializeStyle(n),r}},pc=function(e,t,n){var r,o=e.dom;function i(e,t,n){n&&o.setAttrib(e,t,n)}function a(e,t,n){n&&o.setStyle(e,t,n)}mc.updateStyleField(e,n),r=n.control.rootControl.toJSON(),e.undoManager.transact((function(){uc.each(t,(function(n){var c,s;i(n,"scope",r.scope),1===t.length?i(n,"style",r.style):(c=n,s=r.style,delete c.dataset.mceStyle,c.style.cssText+=";"+s),i(n,"class",r.class),a(n,"width",La(r.width)),a(n,"height",La(r.height)),r.type&&n.nodeName.toLowerCase()!==r.type&&(n=o.rename(n,r.type)),1===t.length&&(dc.unApplyAlign(e,n),dc.unApplyVAlign(e,n)),r.align&&dc.applyAlign(e,n,r.align),r.valign&&dc.applyVAlign(e,n,r.valign)})),e.focus()}))},gc=function(e){var t,n,r,o=[];if(o=e.dom.select("td[data-mce-selected],th[data-mce-selected]"),t=e.dom.getParent(e.selection.getStart(),"td,th"),!o.length&&t&&o.push(t),t=t||o[0]){n=o.length>1?{width:"",height:"",scope:"",class:"",align:"",valign:"",style:"",type:t.nodeName.toLowerCase()}:function(e,t){var n=e.dom,r={width:n.getStyle(t,"width")||n.getAttrib(t,"width"),height:n.getStyle(t,"height")||n.getAttrib(t,"height"),scope:n.getAttrib(t,"scope"),class:n.getAttrib(t,"class"),type:t.nodeName.toLowerCase(),style:"",align:"",valign:""};return uc.each("left center right".split(" "),(function(n){e.formatter.matchNode(t,"align"+n)&&(r.align=n)})),uc.each("top middle bottom".split(" "),(function(n){e.formatter.matchNode(t,"valign"+n)&&(r.valign=n)})),Ga(e)&&uc.extend(r,mc.extractAdvancedStyles(n,t)),r}(e,t),ec(e).length>0&&(r={name:"class",type:"listbox",label:"Class",values:mc.buildListItems(ec(e),(function(t){t.value&&(t.textStyle=function(){return e.formatter.getCssText({block:"td",classes:[t.value]})})}))});var i={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",layout:"grid",columns:2,labelGapCalc:!1,padding:0,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width",onchange:a.curry(mc.updateStyleField,e)},{label:"Height",name:"height",onchange:a.curry(mc.updateStyleField,e)},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"H Align",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"V Align",name:"valign",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}]},r]};Ga(e)?e.windowManager.open({title:"Cell properties",bodyType:"tabpanel",data:n,body:[{title:"General",type:"form",items:i},mc.createStyleForm(e)],onsubmit:a.curry(pc,e,o)}):e.windowManager.open({title:"Cell properties",data:n,body:i,onsubmit:a.curry(pc,e,o)})}},hc=function(e,t,n){var r=e.getParent(t,"table"),o=t.parentNode,i=e.select(n,r)[0];i||(i=e.create(n),r.firstChild?"CAPTION"===r.firstChild.nodeName?e.insertAfter(i,r.firstChild):r.insertBefore(i,r.firstChild):r.appendChild(i)),i.appendChild(t),o.hasChildNodes()||e.remove(o)};function vc(e,t,n,r){var o=e.dom;function i(e,t,n){n&&o.setAttrib(e,t,n)}mc.updateStyleField(e,r);var a=r.control.rootControl.toJSON();e.undoManager.transact((function(){uc.each(t,(function(t){i(t,"scope",a.scope),i(t,"style",a.style),i(t,"class",a.class),function(e,t,n){n&&o.setStyle(e,t,n)}(t,"height",La(a.height)),a.type!==t.parentNode.nodeName.toLowerCase()&&hc(e.dom,t,a.type),a.align!==n.align&&(dc.unApplyAlign(e,t),dc.applyAlign(e,t,a.align))})),e.focus()}))}var bc=function(e){var t,n,r,o,i,c,s=e.dom,l=[];t=s.getParent(e.selection.getStart(),"table"),n=s.getParent(e.selection.getStart(),"td,th"),uc.each(t.rows,(function(e){uc.each(e.cells,(function(t){if(s.getAttrib(t,"data-mce-selected")||t===n)return l.push(e),!1}))})),(r=l[0])&&(i=l.length>1?{height:"",scope:"",style:"",class:"",align:"",type:r.parentNode.nodeName.toLowerCase()}:function(e,t){var n=e.dom,r={height:n.getStyle(t,"height")||n.getAttrib(t,"height"),scope:n.getAttrib(t,"scope"),class:n.getAttrib(t,"class"),align:"",style:"",type:t.parentNode.nodeName.toLowerCase()};return uc.each("left center right".split(" "),(function(n){e.formatter.matchNode(t,"align"+n)&&(r.align=n)})),Xa(e)&&uc.extend(r,mc.extractAdvancedStyles(n,t)),r}(e,r),tc(e).length>0&&(o={name:"class",type:"listbox",label:"Class",values:mc.buildListItems(tc(e),(function(t){t.value&&(t.textStyle=function(){return e.formatter.getCssText({block:"tr",classes:[t.value]})})}))}),c={type:"form",columns:2,padding:0,defaults:{type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"Header",maxWidth:null,values:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"},o]},Xa(e)?e.windowManager.open({title:"Row properties",data:i,bodyType:"tabpanel",body:[{title:"General",type:"form",items:c},mc.createStyleForm(e)],onsubmit:a.curry(vc,e,l,i)}):e.windowManager.open({title:"Row properties",data:i,body:c,onsubmit:a.curry(vc,e,l,i)}))},yc=tinymce.util.Tools.resolve("tinymce.Env"),Cc={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},wc=function(e,t,n,r,o){void 0===o&&(o=Cc);var i=$.fromTag("table");Ht.setAll(i,o.styles),lt.setAll(i,o.attributes);var a=$.fromTag("tbody");zt.append(i,a);for(var c=[],s=0;s<e;s++){for(var l=$.fromTag("tr"),u=0;u<t;u++){var d=s<n||u<r?$.fromTag("th"):$.fromTag("td");u<r&&lt.set(d,"scope","row"),s<n&&lt.set(d,"scope","col"),zt.append(d,$.fromTag("br")),o.percentages&&Ht.set(d,"width",100/t+"%"),zt.append(l,d)}c.push(l)}return qt.append(a,c),i},xc=function(e){return e.dom().innerHTML},kc=function(e){var t=$.fromTag("div"),n=$.fromDom(e.dom().cloneNode(!0));return zt.append(t,n),xc(t)},Tc=function(e,t){e.selection.select(t.dom(),!0),e.selection.collapse(!0)},Ec=function(e,t,n){var r,o=Ka(e),i={styles:o,attributes:$a(e),percentages:(r=o.width,p.isString(r)&&-1!==r.indexOf("%")&&!rc(e))},c=wc(n,t,0,0,i);lt.set(c,"data-mce-id","__mce");var s=kc(c);return e.insertContent(s),xt.descendant(Pa(e),'table[data-mce-id="__mce"]').map((function(t){return rc(e)&&Ht.set(t,"width",Ht.get(t,"width")),lt.remove(t,"data-mce-id"),function(e,t){A.each(gt.descendants(t,"tr"),(function(t){oc(e,t.dom()),A.each(gt.descendants(t,"th,td"),(function(t){ic(e,t.dom())}))}))}(e,t),function(e,t){xt.descendant(t,"td,th").each(a.curry(Tc,e))}(e,t),t.dom()})).getOr(null)};function Sc(e,t,n,r){if("TD"===t.tagName||"TH"===t.tagName)e.setStyle(t,n,r);else if(t.children)for(var o=0;o<t.children.length;o++)Sc(e,t.children[o],n,r)}var Nc=function(e,t,n){var r,o,i=e.dom;mc.updateStyleField(e,n),!1===(o=n.control.rootControl.toJSON()).class&&delete o.class,e.undoManager.transact((function(){t||(t=Ec(e,o.cols||1,o.rows||1)),function(e,t,n){var r=e.dom,o={},i={};if(o.class=n.class,i.height=La(n.height),r.getAttrib(t,"width")&&!Za(e)?o.width=function(e){return e?e.replace(/px$/,""):""}(n.width):i.width=La(n.width),Za(e)?(i["border-width"]=La(n.border),i["border-spacing"]=La(n.cellspacing),uc.extend(o,{"data-mce-border-color":n.borderColor,"data-mce-cell-padding":n.cellpadding,"data-mce-border":n.border})):uc.extend(o,{border:n.border,cellpadding:n.cellpadding,cellspacing:n.cellspacing}),Za(e)&&t.children)for(var a=0;a<t.children.length;a++)Sc(r,t.children[a],{"border-width":La(n.border),"border-color":n.borderColor,padding:La(n.cellpadding)});n.style?uc.extend(i,r.parseStyle(n.style)):i=uc.extend({},r.parseStyle(r.getAttrib(t,"style")),i),o.style=r.serializeStyle(i),r.setAttribs(t,o)}(e,t,o),(r=i.select("caption",t)[0])&&!o.caption&&i.remove(r),!r&&o.caption&&((r=i.create("caption")).innerHTML=yc.ie?" ":'<br data-mce-bogus="1"/>',t.insertBefore(r,t.firstChild)),dc.unApplyAlign(e,t),o.align&&dc.applyAlign(e,t,o.align),e.focus(),e.addVisual()}))},Ac=function(e,t){var n,r,o,i,c,s=e.dom,l={};!0===t?(n=s.getParent(e.selection.getStart(),"table"))&&(l=function(e,t){var n=e.dom,r={width:n.getStyle(t,"width")||n.getAttrib(t,"width"),height:n.getStyle(t,"height")||n.getAttrib(t,"height"),cellspacing:n.getStyle(t,"border-spacing")||n.getAttrib(t,"cellspacing"),cellpadding:n.getAttrib(t,"data-mce-cell-padding")||n.getAttrib(t,"cellpadding")||dc.getTDTHOverallStyle(e.dom,t,"padding"),border:n.getAttrib(t,"data-mce-border")||n.getAttrib(t,"border")||dc.getTDTHOverallStyle(e.dom,t,"border"),borderColor:n.getAttrib(t,"data-mce-border-color"),caption:!!n.select("caption",t)[0],class:n.getAttrib(t,"class")};return uc.each("left center right".split(" "),(function(n){e.formatter.matchNode(t,"align"+n)&&(r.align=n)})),Ya(e)&&uc.extend(r,mc.extractAdvancedStyles(n,t)),r}(e,n)):(r={label:"Cols",name:"cols"},o={label:"Rows",name:"rows"}),nc(e).length>0&&(l.class&&(l.class=l.class.replace(/\s*mce\-item\-table\s*/g,"")),i={name:"class",type:"listbox",label:"Class",values:mc.buildListItems(nc(e),(function(t){t.value&&(t.textStyle=function(){return e.formatter.getCssText({block:"table",classes:[t.value]})})}))}),c={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",labelGapCalc:!1,padding:0,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:Qa(e)?[r,o,{label:"Width",name:"width",onchange:a.curry(mc.updateStyleField,e)},{label:"Height",name:"height",onchange:a.curry(mc.updateStyleField,e)},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"}]:[r,o,{label:"Width",name:"width",onchange:a.curry(mc.updateStyleField,e)},{label:"Height",name:"height",onchange:a.curry(mc.updateStyleField,e)}]},{label:"Alignment",name:"align",type:"listbox",text:"None",values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},i]},Ya(e)?e.windowManager.open({title:"Table properties",data:l,bodyType:"tabpanel",body:[{title:"General",type:"form",items:c},mc.createStyleForm(e)],onsubmit:a.curry(Nc,e,n)}):e.windowManager.open({title:"Table properties",data:l,body:c,onsubmit:a.curry(Nc,e,n)})},Rc=uc.each,_c={registerCommands:function(e,t,n,r,o){var i=Ma(e),c=function(){return $.fromDom(e.dom.getParent(e.selection.getStart(),"th,td"))},s=function(e){return At.table(e,i)},l=function(e){return{width:Da(e.dom()),height:Da(e.dom())}},u=function(t){var o=c();s(o).each((function(i){var a=lr.forMenu(r,i,o),c=l(i);t(i,a).each((function(t){!function(e,t,n){var r=l(n);t.width===r.width&&t.height===r.height||(ac(e,n.dom(),t.width,t.height),cc(e,n.dom(),r.width,r.height))}(e,c,i),e.selection.setRng(t),e.focus(),n.clear(i)}))}))},d=function(t){var n=c();return s(n).bind((function(t){var o=$.fromDom(e.getDoc()),i=lr.forMenu(r,t,n),c=hn(a.noop,o,f.none());return lc(t,i,c)}))},m=function(t){o.get().each((function(o){var i=A.map(o,(function(e){return tn(e)})),a=c();s(a).bind((function(o){var c=$.fromDom(e.getDoc()),s=vn(c),l=lr.pasteRows(r,o,a,i,s);t(o,l).each((function(t){e.selection.setRng(t),e.focus(),n.clear(o)}))}))}))};Rc({mceTableSplitCells:function(){u(t.unmergeCells)},mceTableMergeCells:function(){u(t.mergeCells)},mceTableInsertRowBefore:function(){u(t.insertRowsBefore)},mceTableInsertRowAfter:function(){u(t.insertRowsAfter)},mceTableInsertColBefore:function(){u(t.insertColumnsBefore)},mceTableInsertColAfter:function(){u(t.insertColumnsAfter)},mceTableDeleteCol:function(){u(t.deleteColumn)},mceTableDeleteRow:function(){u(t.deleteRow)},mceTableCutRow:function(e){o.set(d()),u(t.deleteRow)},mceTableCopyRow:function(e){o.set(d())},mceTablePasteRowBefore:function(e){m(t.pasteRowsBefore)},mceTablePasteRowAfter:function(e){m(t.pasteRowsAfter)},mceTableDelete:function(){var t=$.fromDom(e.dom.getParent(e.selection.getStart(),"th,td"));At.table(t,i).filter(a.not(i)).each((function(t){var n=$.fromText("");zt.after(t,n),$t.remove(t);var r=e.dom.createRng();r.setStart(n.dom(),0),r.setEnd(n.dom(),0),e.selection.setRng(r)}))}},(function(t,n){e.addCommand(n,t)})),Rc({mceInsertTable:a.curry(Ac,e),mceTableProps:a.curry(Ac,e,!0),mceTableRowProps:a.curry(bc,e),mceTableCellProps:a.curry(gc,e)},(function(t,n){e.addCommand(n,(function(e,n){t(n)}))}))}},Ic=function(e){var t=f.from(e.dom().documentElement).map($.fromDom).getOr(e);return{parent:a.constant(t),view:a.constant(e),origin:a.constant(Dr(0,0))}},Bc=function(e,t){return{parent:a.constant(t),view:a.constant(e),origin:a.constant(Dr(0,0))}};function Pc(e){var t=L.immutable.apply(null,e),n=[];return{bind:function(e){if(void 0===e)throw"Event bind error: undefined handler";n.push(e)},unbind:function(e){n=A.filter(n,(function(t){return t!==e}))},trigger:function(){var e=t.apply(null,arguments);A.each(n,(function(t){t(e)}))}}}var Dc={create:function(e){return{registry:D.map(e,(function(e){return{bind:e.bind,unbind:e.unbind}})),trigger:D.map(e,(function(e){return e.trigger}))}}},Oc={mode:no.exactly(["compare","extract","mutate","sink"]),sink:no.exactly(["element","start","stop","destroy"]),api:no.exactly(["forceDrop","drop","move","delayDrop"])},Mc={resolve:qo("ephox-dragster").resolve},Lc=function(e,t){return function(n){if(e(n)){var r=$.fromDom(n.target),o=function(){n.stopPropagation()},i=function(){n.preventDefault()},c=a.compose(i,o),s=function(e,t,n,r,o,i,c){return{target:a.constant(e),x:a.constant(t),y:a.constant(n),stop:r,prevent:o,kill:i,raw:a.constant(c)}}(r,n.clientX,n.clientY,o,i,c,n);t(s)}}},Fc=function(e,t,n,r,o){var i=Lc(n,r);return e.dom().addEventListener(t,i,o),{unbind:a.curry(jc,e,t,i,o)}},jc=function(e,t,n,r){e.dom().removeEventListener(t,n,r)},Hc=function(e,t,n,r){return Fc(e,t,n,r,!1)},Uc=function(e,t,n,r){return Fc(e,t,n,r,!0)},Wc=a.constant(!0),zc={bind:function(e,t,n){return Hc(e,t,Wc,n)},capture:function(e,t,n){return Uc(e,t,Wc,n)}},qc=Oc.mode({compare:function(e,t){return Dr(t.left()-e.left(),t.top()-e.top())},extract:function(e){return f.some(Dr(e.x(),e.y()))},sink:function(e,t){var n=function(e){var t=ko.merge({layerClass:Mc.resolve("blocker")},e),n=$.fromTag("div");return lt.set(n,"role","presentation"),Ht.setAll(n,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),ii.add(n,Mc.resolve("blocker")),ii.add(n,t.layerClass),{element:function(){return n},destroy:function(){$t.remove(n)}}}(t),r=zc.bind(n.element(),"mousedown",e.forceDrop),o=zc.bind(n.element(),"mouseup",e.drop),i=zc.bind(n.element(),"mousemove",e.move),a=zc.bind(n.element(),"mouseout",e.delayDrop);return Oc.sink({element:n.element,start:function(e){zt.append(e,n.element())},stop:function(){$t.remove(n.element())},destroy:function(){n.destroy(),o.unbind(),i.unbind(),a.unbind(),r.unbind()}})},mutate:function(e,t){e.mutate(t.left(),t.top())}});function Vc(){var e=f.none(),t=Dc.create({move:Pc(["info"])});return{onEvent:function(n,r){r.extract(n).each((function(n){(function(t,n){var r=e.map((function(e){return t.compare(e,n)}));return e=f.some(n),r})(r,n).each((function(e){t.trigger.move(e)}))}))},reset:function(){e=f.none()},events:t.registry}}function $c(){var e={onEvent:function(e,t){},reset:a.noop},t=Vc(),n=e;return{on:function(){n.reset(),n=t},off:function(){n.reset(),n=e},isOn:function(){return n===t},onEvent:function(e,t){n.onEvent(e,t)},events:t.events}}var Kc=function(e,t){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},throttle:function(){var r=arguments;null!==n&&clearTimeout(n),n=setTimeout((function(){e.apply(null,r),n=null,r=null}),t)}}},Jc=function(e,t,n){var r=!1,o=Dc.create({start:Pc([]),stop:Pc([])}),i=$c(),a=function(){l.stop(),i.isOn()&&(i.off(),o.trigger.stop())},c=Kc(a,200);i.events.move.bind((function(n){t.mutate(e,n.info())}));var s=function(e){return function(){var t=Array.prototype.slice.call(arguments,0);if(r)return e.apply(null,t)}},l=t.sink(Oc.api({forceDrop:a,drop:s(a),move:s((function(e,n){c.cancel(),i.onEvent(e,t)})),delayDrop:s(c.throttle)}),n);return{element:l.element,go:function(e){l.start(e),i.on(),o.trigger.start()},on:function(){r=!0},off:function(){r=!1},destroy:function(){l.destroy()},events:o.registry}},Gc={transform:function(e,t){var n=void 0!==t?t:{},r=void 0!==n.mode?n.mode:qc;return Jc(e,r,t)}};function Xc(){var e=Dc.create({drag:Pc(["xDelta","yDelta","target"])}),t=f.none(),n=function(){var e=Dc.create({drag:Pc(["xDelta","yDelta"])});return{mutate:function(t,n){e.trigger.drag(t,n)},events:e.registry}}();return n.events.drag.bind((function(n){t.each((function(t){e.trigger.drag(n.xDelta(),n.yDelta(),t)}))})),{assign:function(e){t=f.some(e)},get:function(){return t},mutate:n.mutate,events:e.registry}}var Yc={any:function(e){return xt.first(e).isSome()},ancestor:function(e,t,n){return xt.ancestor(e,t,n).isSome()},sibling:function(e,t){return xt.sibling(e,t).isSome()},child:function(e,t){return xt.child(e,t).isSome()},descendant:function(e,t){return xt.descendant(e,t).isSome()},closest:function(e,t,n){return xt.closest(e,t,n).isSome()}},Qc=Vo.resolve("resizer-bar-dragging");function Zc(e,t){var n=Jr.height,r=function(e,t,n){var r=Xc(),o=Gc.transform(r,{}),i=f.none(),c=function(e,t){return f.from(lt.get(e,t))};r.events.drag.bind((function(e){c(e.target(),"data-row").each((function(t){var n=ia.getInt(e.target(),"top");Ht.set(e.target(),"top",n+e.yDelta()+"px")})),c(e.target(),"data-column").each((function(t){var n=ia.getInt(e.target(),"left");Ht.set(e.target(),"left",n+e.xDelta()+"px")}))}));var s=function(e,t){return ia.getInt(e,t)-parseInt(lt.get(e,"data-initial-"+t),10)};o.events.stop.bind((function(){r.get().each((function(r){i.each((function(o){c(r,"data-row").each((function(e){var t=s(r,"top");lt.remove(r,"data-initial-top"),p.trigger.adjustHeight(o,t,parseInt(e,10))})),c(r,"data-column").each((function(e){var t=s(r,"left");lt.remove(r,"data-initial-left"),p.trigger.adjustWidth(o,t,parseInt(e,10))})),mi.refresh(e,o,n,t)}))}))}));var l=function(t,n){p.trigger.startAdjust(),r.assign(t),lt.set(t,"data-initial-"+n,parseInt(Ht.get(t,n),10)),ii.add(t,Qc),Ht.set(t,"opacity","0.2"),o.go(e.parent())},u=zc.bind(e.parent(),"mousedown",(function(e){mi.isRowBar(e.target())&&l(e.target(),"top"),mi.isColBar(e.target())&&l(e.target(),"left")})),d=function(t){return Ue.eq(t,e.view())},m=zc.bind(e.view(),"mouseover",(function(r){"table"===ot.name(r.target())||Yc.closest(r.target(),"table",d)?(i="table"===ot.name(r.target())?f.some(r.target()):xt.ancestor(r.target(),"table",d)).each((function(r){mi.refresh(e,r,n,t)})):ft.inBody(r.target())&&mi.destroy(e)})),p=Dc.create({adjustHeight:Pc(["table","delta","row"]),adjustWidth:Pc(["table","delta","column"]),startAdjust:Pc([])});return{destroy:function(){u.unbind(),m.unbind(),o.destroy(),mi.destroy(e)},refresh:function(r){mi.refresh(e,r,n,t)},on:o.on,off:o.off,hideBars:a.curry(mi.hide,e),showBars:a.curry(mi.show,e),events:p.registry}}(e,t,n),o=Dc.create({beforeResize:Pc(["table"]),afterResize:Pc(["table"]),startDrag:Pc([])});return r.events.adjustHeight.bind((function(e){o.trigger.beforeResize(e.table());var t=n.delta(e.delta(),e.table());xa.adjustHeight(e.table(),t,e.row(),n),o.trigger.afterResize(e.table())})),r.events.startAdjust.bind((function(e){o.trigger.startDrag()})),r.events.adjustWidth.bind((function(e){o.trigger.beforeResize(e.table());var n=t.delta(e.delta(),e.table());xa.adjustWidth(e.table(),n,e.column(),t),o.trigger.afterResize(e.table())})),{on:r.on,off:r.off,hideBars:r.hideBars,showBars:r.showBars,destroy:r.destroy,events:o.registry}}var es=function(e,t){return e.inline?Bc(Pa(e),function(){var e=$.fromTag("div");return Ht.setAll(e,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),zt.append(ft.body(),e),e}()):Ic($.fromDom(e.getDoc()))},ts=function(e,t){e.inline&&$t.remove(t.parent())},ns=function(e){var t,n,r=f.none(),o=f.none(),i=f.none(),a=/(\d+(\.\d+)?)%/,c=function(e){return"TABLE"===e.nodeName};return e.on("init",(function(){var t=Xr(Wa.directionAt),n=es(e);if(i=f.some(n),function(e){var t=e.getParam("object_resizing",!0);return"table"===t||t}(e)&&function(e){return e.getParam("table_resize_bars",!0,"boolean")}(e)){var a=Zc(n,t);a.on(),a.events.startDrag.bind((function(t){r=f.some(e.selection.getRng())})),a.events.beforeResize.bind((function(t){var n=t.table().dom();ac(e,n,Da(n),Oa(n))})),a.events.afterResize.bind((function(t){var n=t.table(),o=n.dom(),i=gt.descendants(n,"td[data-mce-style],th[data-mce-style]");A.each(i,(function(e){lt.remove(e,"data-mce-style")})),r.each((function(t){e.selection.setRng(t),e.focus()})),cc(e,o,Da(o),Oa(o)),e.undoManager.add()})),o=f.some(a)}})),e.on("ObjectResizeStart",(function(r){var o,i=r.target;c(i)&&(t=r.width,o=i,n=e.dom.getStyle(o,"width")||e.dom.getAttrib(o,"width"))})),e.on("ObjectResized",(function(r){var o=r.target;if(c(o)){var i=o;if(a.test(n)){var s=parseFloat(a.exec(n)[1]),l=r.width*s/t;e.dom.setStyle(i,"width",l+"%")}else{var u=[];uc.each(i.rows,(function(t){uc.each(t.cells,(function(t){var n=e.dom.getStyle(t,"width",!0);u.push({cell:t,width:n})}))})),uc.each(u,(function(t){e.dom.setStyle(t.cell,"width",t.width),e.dom.setAttrib(t.cell,"width",null)}))}}})),{lazyResize:function(){return o},lazyWire:function(){return i.getOr(Ic($.fromDom(e.getBody())))},destroy:function(){o.each((function(e){e.destroy()})),i.each((function(t){ts(e,t)}))}}},rs=function(e){return{fold:e}},os=function(e){return rs((function(t,n,r,o){return t(e)}))},is=function(e){return rs((function(t,n,r,o){return n(e)}))},as=function(e,t){return rs((function(n,r,o,i){return o(e,t)}))},cs=function(e){return rs((function(t,n,r,o){return o(e)}))},ss=function(e,t){return At.table(e,t).bind((function(t){var n=At.cells(t);return A.findIndex(n,(function(t){return Ue.eq(e,t)})).map((function(e){return{index:a.constant(e),all:a.constant(n)}}))}))},ls=function(e,t){return ss(e,t).fold((function(){return os(e)}),(function(t){return t.index()+1<t.all().length?as(e,t.all()[t.index()+1]):cs(e)}))},us=function(e,t){return ss(e,t).fold((function(){return os()}),(function(t){return t.index()-1>=0?as(e,t.all()[t.index()-1]):is(e)}))},ds=er([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),fs={before:ds.before,on:ds.on,after:ds.after,cata:function(e,t,n,r){return e.fold(t,n,r)},getStart:function(e){return e.fold(a.identity,a.identity,a.identity)}},ms=er([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),ps=L.immutable("start","soffset","finish","foffset"),gs={domRange:ms.domRange,relative:ms.relative,exact:ms.exact,exactFromRange:function(e){return ms.exact(e.start(),e.soffset(),e.finish(),e.foffset())},range:ps,getWin:function(e){var t=function(e){return e.match({domRange:function(e){return $.fromDom(e.startContainer)},relative:function(e,t){return fs.getStart(e)},exact:function(e,t,n,r){return e}})}(e);return Ge.defaultView(t)}},hs=function(e,t,n,r){var o=Ge.owner(e).dom().createRange();return o.setStart(e.dom(),t),o.setEnd(n.dom(),r),o},vs=function(e,t,n,r){var o=hs(e,t,n,r),i=Ue.eq(e,n)&&t===r;return o.collapsed&&!i},bs=function(e,t){var n=(t||document).createDocumentFragment();return A.each(e,(function(e){n.appendChild(e.dom())})),$.fromDom(n)},ys=function(e,t){e.selectNodeContents(t.dom())},Cs=function(e){e.deleteContents()},ws=function(e){return{left:a.constant(e.left),top:a.constant(e.top),right:a.constant(e.right),bottom:a.constant(e.bottom),width:a.constant(e.width),height:a.constant(e.height)}},xs={create:function(e){return e.document.createRange()},replaceWith:function(e,t){Cs(e),e.insertNode(t.dom())},selectNodeContents:function(e,t){var n=e.document.createRange();return ys(n,t),n},selectNodeContentsUsing:ys,relativeToNative:function(e,t,n){var r,o=e.document.createRange();return r=o,t.fold((function(e){r.setStartBefore(e.dom())}),(function(e,t){r.setStart(e.dom(),t)}),(function(e){r.setStartAfter(e.dom())})),function(e,t){t.fold((function(t){e.setEndBefore(t.dom())}),(function(t,n){e.setEnd(t.dom(),n)}),(function(t){e.setEndAfter(t.dom())}))}(o,n),o},exactToNative:function(e,t,n,r,o){var i=e.document.createRange();return i.setStart(t.dom(),n),i.setEnd(r.dom(),o),i},deleteContents:Cs,cloneFragment:function(e){var t=e.cloneContents();return $.fromDom(t)},getFirstRect:function(e){var t=e.getClientRects(),n=t.length>0?t[0]:e.getBoundingClientRect();return n.width>0||n.height>0?f.some(n).map(ws):f.none()},getBounds:function(e){var t=e.getBoundingClientRect();return t.width>0||t.height>0?f.some(t).map(ws):f.none()},isWithin:function(e,t){return t.compareBoundaryPoints(e.END_TO_START,e)<1&&t.compareBoundaryPoints(e.START_TO_END,e)>-1},toString:function(e){return e.toString()}},ks=er([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Ts=function(e,t,n){return t($.fromDom(n.startContainer),n.startOffset,$.fromDom(n.endContainer),n.endOffset)},Es=function(e,t){return function(e,t){var n=t.ltr();return n.collapsed?t.rtl().filter((function(e){return!1===e.collapsed})).map((function(e){return ks.rtl($.fromDom(e.endContainer),e.endOffset,$.fromDom(e.startContainer),e.startOffset)})).getOrThunk((function(){return Ts(0,ks.ltr,n)})):Ts(0,ks.ltr,n)}(0,function(e,t){return t.match({domRange:function(e){return{ltr:a.constant(e),rtl:f.none}},relative:function(t,n){return{ltr:le((function(){return xs.relativeToNative(e,t,n)})),rtl:le((function(){return f.some(xs.relativeToNative(e,n,t))}))}},exact:function(t,n,r,o){return{ltr:le((function(){return xs.exactToNative(e,t,n,r,o)})),rtl:le((function(){return f.some(xs.exactToNative(e,r,o,t,n))}))}}})}(e,t))},Ss={ltr:ks.ltr,rtl:ks.rtl,diagnose:Es,asLtrRange:function(e,t){return Es(e,t).match({ltr:function(t,n,r,o){var i=e.document.createRange();return i.setStart(t.dom(),n),i.setEnd(r.dom(),o),i},rtl:function(t,n,r,o){var i=e.document.createRange();return i.setStart(r.dom(),o),i.setEnd(t.dom(),n),i}})}},Ns=function(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom},As=function(e,t,n,r,o){if(0===o)return 0;if(t===r)return o-1;for(var i=r,a=1;a<o;a++){var c=e(a),s=Math.abs(t-c.left);if(n>c.bottom);else{if(n<c.top||s>i)return a-1;i=s}}return 0},Rs={locate:function(e,t,n,r){var o=e.dom().createRange();o.selectNode(t.dom());var i=o.getClientRects();return Eo(i,(function(e){return Ns(e,n,r)?f.some(e):f.none()})).map((function(o){return function(e,t,n,r,o){var i=function(n){var r=e.dom().createRange();return r.setStart(t.dom(),n),r.collapse(!0),r},a=on.get(t).length,c=As((function(e){return i(e).getBoundingClientRect()}),n,r,o.right,a);return i(c)}(e,t,n,r,o)}))}},_s=function(e,t,n,r){var o=e.dom().createRange(),i=Ge.children(t);return Eo(i,(function(t){return o.selectNode(t.dom()),Ns(o.getBoundingClientRect(),n,r)?Is(e,t,n,r):f.none()}))},Is=function(e,t,n,r){return(ot.isText(t)?Rs.locate:_s)(e,t,n,r)},Bs=function(e,t,n,r){var o=e.dom().createRange();o.selectNode(t.dom());var i=o.getBoundingClientRect(),a=Math.max(i.left,Math.min(i.right,n)),c=Math.max(i.top,Math.min(i.bottom,r));return Is(e,t,a,c)},Ps=function(e,t){return t-e.left<e.right-t},Ds=function(e,t,n){var r=e.dom().createRange();return r.selectNode(t.dom()),r.collapse(n),r},Os=function(e,t,n){var r=e.dom().createRange();r.selectNode(t.dom());var o=r.getBoundingClientRect(),i=Ps(o,n);return(!0===i?dn.first:dn.last)(t).map((function(t){return Ds(e,t,i)}))},Ms=function(e,t,n){var r=t.dom().getBoundingClientRect(),o=Ps(r,n);return f.some(Ds(e,t,o))},Ls=function(e,t,n){return(0===Ge.children(t).length?Ms:Os)(e,t,n)},Fs=document.caretPositionFromPoint?function(e,t,n){return f.from(e.dom().caretPositionFromPoint(t,n)).bind((function(t){if(null===t.offsetNode)return f.none();var n=e.dom().createRange();return n.setStart(t.offsetNode,t.offset),n.collapse(),f.some(n)}))}:document.caretRangeFromPoint?function(e,t,n){return f.from(e.dom().caretRangeFromPoint(t,n))}:function(e,t,n){return $.fromPoint(e,t,n).bind((function(r){var o=function(){return Ls(e,r,t)};return 0===Ge.children(r).length?o():function(e,t,n,r){var o=e.dom().createRange();o.selectNode(t.dom());var i=o.getBoundingClientRect(),a=Math.max(i.left,Math.min(i.right,n)),c=Math.max(i.top,Math.min(i.bottom,r));return Bs(e,t,a,c)}(e,r,t,n).orThunk(o)}))},js=function(e,t,n){var r=$.fromDom(e.document);return Fs(r,t,n).map((function(e){return gs.range($.fromDom(e.startContainer),e.startOffset,$.fromDom(e.endContainer),e.endOffset)}))},Hs=function(e,t,n){var r=Ss.asLtrRange(e,t),o=$.fromDom(r.commonAncestorContainer);return ot.isElement(o)?function(e,t,n,r){var o=xs.create(e),i=(ee.is(t,r)?[t]:[]).concat(gt.descendants(t,r));return A.filter(i,(function(e){return xs.selectNodeContentsUsing(o,e),xs.isWithin(n,o)}))}(e,o,r,n):[]},Us=function(e,t){var n=ot.name(e);return"input"===n?fs.after(e):A.contains(["br","img"],n)?0===t?fs.before(e):fs.after(e):fs.on(e,t)},Ws=function(e,t){var n=e.fold(fs.before,Us,fs.after),r=t.fold(fs.before,Us,fs.after);return gs.relative(n,r)},zs=function(e,t,n,r){var o=Us(e,t),i=Us(n,r);return gs.relative(o,i)},qs=function(e){return e.match({domRange:function(e){var t=$.fromDom(e.startContainer),n=$.fromDom(e.endContainer);return zs(t,e.startOffset,n,e.endOffset)},relative:Ws,exact:zs})},Vs=Ws,$s=zs,Ks=function(e,t){f.from(e.getSelection()).each((function(e){e.removeAllRanges(),e.addRange(t)}))},Js=function(e,t,n,r,o){var i=xs.exactToNative(e,t,n,r,o);Ks(e,i)},Gs=function(e,t){return Ss.diagnose(e,t).match({ltr:function(t,n,r,o){Js(e,t,n,r,o)},rtl:function(t,n,r,o){var i=e.getSelection();i.setBaseAndExtent?i.setBaseAndExtent(t.dom(),n,r.dom(),o):i.extend?(i.collapse(t.dom(),n),i.extend(r.dom(),o)):Js(e,r,o,t,n)}})},Xs=function(e){var t=$.fromDom(e.anchorNode),n=$.fromDom(e.focusNode);return vs(t,e.anchorOffset,n,e.focusOffset)?f.some(gs.range($.fromDom(e.anchorNode),e.anchorOffset,$.fromDom(e.focusNode),e.focusOffset)):function(e){if(e.rangeCount>0){var t=e.getRangeAt(0),n=e.getRangeAt(e.rangeCount-1);return f.some(gs.range($.fromDom(t.startContainer),t.startOffset,$.fromDom(n.endContainer),n.endOffset))}return f.none()}(e)},Ys=function(e){return f.from(e.getSelection()).filter((function(e){return e.rangeCount>0})).bind(Xs)},Qs={setExact:function(e,t,n,r,o){var i=$s(t,n,r,o);Gs(e,i)},getExact:Ys,get:function(e){return Ys(e).map((function(e){return gs.exact(e.start(),e.soffset(),e.finish(),e.foffset())}))},setRelative:function(e,t,n){var r=Vs(t,n);Gs(e,r)},toNative:function(e){var t=gs.getWin(e).dom(),n=function(e,n,r,o){return xs.exactToNative(t,e,n,r,o)},r=qs(e);return Ss.diagnose(t,r).match({ltr:n,rtl:n})},setToElement:function(e,t){var n=xs.selectNodeContents(e,t);Ks(e,n)},clear:function(e){e.getSelection().removeAllRanges()},clone:function(e,t){var n=Ss.asLtrRange(e,t);return xs.cloneFragment(n)},replace:function(e,t,n){var r=Ss.asLtrRange(e,t),o=bs(n,e.document);xs.replaceWith(r,o)},deleteAt:function(e,t){var n=Ss.asLtrRange(e,t);xs.deleteContents(n)},forElement:function(e,t){var n=xs.selectNodeContents(e,t);return gs.range($.fromDom(n.startContainer),n.startOffset,$.fromDom(n.endContainer),n.endOffset)},getFirstRect:function(e,t){var n=Ss.asLtrRange(e,t);return xs.getFirstRect(n)},getBounds:function(e,t){var n=Ss.asLtrRange(e,t);return xs.getBounds(n)},getAtPoint:function(e,t,n){return js(e,t,n)},findWithin:function(e,t,n){return Hs(e,t,n)},getAsString:function(e,t){var n=Ss.asLtrRange(e,t);return xs.toString(n)},isCollapsed:function(e,t,n,r){return Ue.eq(e,n)&&t===r}},Zs=tinymce.util.Tools.resolve("tinymce.util.VK"),el=function(e,t,n,r){return rl(e,t,ls(n),r)},tl=function(e,t,n,r){return rl(e,t,us(n),r)},nl=function(e,t){var n=gs.exact(t,0,t,0);return Qs.toNative(n)},rl=function(e,t,n,r,o){return n.fold(f.none,f.none,(function(e,t){return dn.first(t).map((function(e){return nl(0,e)}))}),(function(n){return At.table(n,t).bind((function(t){var o=lr.noMenu(n);return e.undoManager.transact((function(){r.insertRowsAfter(t,o)})),function(e,t){var n=gt.descendants(t,"tr");return A.last(n).bind((function(e){return xt.descendant(e,"td,th").map((function(e){return nl(0,e)}))}))}(0,t)}))}))},ol=["table","li","dl"],il={handle:function(e,t,n,r){if(e.keyCode===Zs.TAB){var o=Pa(t),i=function(e){var t=ot.name(e);return Ue.eq(e,o)||A.contains(ol,t)},a=t.selection.getRng();if(a.collapsed){var c=$.fromDom(a.startContainer);At.cell(c,i).each((function(o){e.preventDefault(),(e.shiftKey?tl:el)(t,i,o,n,r).each((function(e){t.selection.setRng(e)}))}))}}}},al={response:L.immutable("selection","kill")},cl=function(e){return function(t){return t===e}},sl=cl(38),ll=cl(40),ul={ltr:{isBackward:cl(37),isForward:cl(39)},rtl:{isBackward:cl(39),isForward:cl(37)},isUp:sl,isDown:ll,isNavigation:function(e){return e>=37&&e<=40}},dl={convertToRange:function(e,t){var n=Ss.asLtrRange(e,t);return{start:a.constant($.fromDom(n.startContainer)),soffset:a.constant(n.startOffset),finish:a.constant($.fromDom(n.endContainer)),foffset:a.constant(n.endOffset)}},makeSitus:function(e,t,n,r){return{start:a.constant(fs.on(e,t)),finish:a.constant(fs.on(n,r))}}},fl=Fe.detect().browser.isSafari(),ml=function(e){var t=void 0!==e?e.dom():document,n=t.body.scrollLeft||t.documentElement.scrollLeft,r=t.body.scrollTop||t.documentElement.scrollTop;return Dr(n,r)},pl=function(e,t,n){(void 0!==n?n.dom():document).defaultView.scrollTo(e,t)},gl=function(e,t){fl&&p.isFunction(e.dom().scrollIntoViewIfNeeded)?e.dom().scrollIntoViewIfNeeded(!1):e.dom().scrollIntoView(t)},hl={get:ml,to:pl,by:function(e,t,n){(void 0!==n?n.dom():document).defaultView.scrollBy(e,t)},preserve:function(e,t){var n=ml(e);t();var r=ml(e);n.top()===r.top()&&n.left()===r.left()||pl(n.left(),n.top(),e)},capture:function(e){var t=f.none(),n=function(){t=f.some(ml(e))};return n(),{save:n,restore:function(){t.each((function(t){pl(t.left(),t.top(),e)}))}}},intoView:gl,intoViewIfNeeded:function(e,t){var n=t.dom().getBoundingClientRect(),r=e.dom().getBoundingClientRect();r.top<n.top?gl(e,!0):r.bottom>n.bottom&&gl(e,!1)},setToElement:function(e,t){var n=Lr(t),r=$.fromDom(e.document);pl(n.left(),n.top(),r)},scrollBarWidth:function(){var e=$.fromHtml('<div style="width: 100px; height: 100px; overflow: scroll; position: absolute; top: -9999px;"></div>');zt.after(ft.body(),e);var t=e.dom().offsetWidth-e.dom().clientWidth;return $t.remove(e),t}};function vl(e){return{elementFromPoint:function(t,n){return $.fromPoint($.fromDom(e.document),t,n)},getRect:function(e){return e.dom().getBoundingClientRect()},getRangedRect:function(t,n,r,o){var i=gs.exact(t,n,r,o);return Qs.getFirstRect(e,i).map((function(e){return D.map(e,a.apply)}))},getSelection:function(){return Qs.get(e).map((function(t){return dl.convertToRange(e,t)}))},fromSitus:function(t){var n=gs.relative(t.start(),t.finish());return dl.convertToRange(e,n)},situsFromPoint:function(t,n){return Qs.getAtPoint(e,t,n).map((function(e){return{start:a.constant(fs.on(e.start(),e.soffset())),finish:a.constant(fs.on(e.finish(),e.foffset()))}}))},clearSelection:function(){Qs.clear(e)},setSelection:function(t){Qs.setExact(e,t.start(),t.soffset(),t.finish(),t.foffset())},setRelativeSelection:function(t,n){Qs.setRelative(e,t,n)},selectContents:function(t){Qs.setToElement(e,t)},getInnerHeight:function(){return e.innerHeight},getScrollY:function(){return hl.get($.fromDom(e.document)).top()},scrollBy:function(t,n){hl.by(t,n,$.fromDom(e.document))}}}var bl=function(e,t,n,r,o){return Ue.eq(n,r)?f.none():Gn.identify(n,r,t).bind((function(t){var r=t.boxes().getOr([]);return r.length>0?(o(e,r,t.start(),t.finish()),f.some(al.response(f.some(dl.makeSitus(n,0,n,sn(n))),!0))):f.none()}))},yl={sync:function(e,t,n,r,o,i,a){return Ue.eq(n,o)&&r===i?f.none():xt.closest(n,"td,th",t).bind((function(n){return xt.closest(o,"td,th",t).bind((function(r){return bl(e,t,n,r,a)}))}))},detect:bl,update:function(e,t,n,r,o){return Gn.shiftSelection(r,e,t,o.firstSelectedSelector(),o.lastSelectedSelector()).map((function(e){return o.clear(n),o.selectRange(n,e.boxes(),e.start(),e.finish()),e.boxes()}))}},Cl=L.immutableBag(["left","top","right","bottom"],[]),wl={nu:Cl,moveUp:function(e,t){return Cl({left:e.left(),top:e.top()-t,right:e.right(),bottom:e.bottom()-t})},moveDown:function(e,t){return Cl({left:e.left(),top:e.top()+t,right:e.right(),bottom:e.bottom()+t})},moveBottomTo:function(e,t){var n=e.bottom()-e.top();return Cl({left:e.left(),top:t-n,right:e.right(),bottom:t})},moveTopTo:function(e,t){var n=e.bottom()-e.top();return Cl({left:e.left(),top:t,right:e.right(),bottom:t+n})},getTop:function(e){return e.top()},getBottom:function(e){return e.bottom()},translate:function(e,t,n){return Cl({left:e.left()+t,top:e.top()+n,right:e.right()+t,bottom:e.bottom()+n})},toString:function(e){return"("+e.left()+", "+e.top()+") -> ("+e.right()+", "+e.bottom()+")"}},xl=function(e){return wl.nu({left:e.left,top:e.top,right:e.right,bottom:e.bottom})},kl=function(e,t){return f.some(e.getRect(t))},Tl=function(e,t,n){return ot.isElement(t)?kl(e,t).map(xl):ot.isText(t)?function(e,t,n){return n>=0&&n<sn(t)?e.getRangedRect(t,n,t,n+1):n>0?e.getRangedRect(t,n-1,t,n):f.none()}(e,t,n).map(xl):f.none()},El=function(e,t){return ot.isElement(t)?kl(e,t).map(xl):ot.isText(t)?e.getRangedRect(t,0,t,sn(t)).map(xl):f.none()},Sl=L.immutable("item","mode"),Nl=function(e,t,n,r){var o=void 0!==r?r:Al;return e.property().parent(t).map((function(e){return Sl(e,o)}))},Al=function(e,t,n,r){var o=void 0!==r?r:Rl;return n.sibling(e,t).map((function(e){return Sl(e,o)}))},Rl=function(e,t,n,r){var o=void 0!==r?r:Rl,i=e.property().children(t);return n.first(i).map((function(e){return Sl(e,o)}))},_l=[{current:Nl,next:Al,fallback:f.none()},{current:Al,next:Rl,fallback:f.some(Nl)},{current:Rl,next:Rl,fallback:f.some(Al)}],Il=function(e,t,n,r,o){return o=void 0!==o?o:_l,A.find(o,(function(e){return e.current===n})).bind((function(n){return n.current(e,t,r,n.next).orThunk((function(){return n.fallback.bind((function(n){return Il(e,t,n,r)}))}))}))},Bl={backtrack:Nl,sidestep:Al,advance:Rl,go:Il},Pl={left:function(){return{sibling:function(e,t){return e.query().prevSibling(t)},first:function(e){return e.length>0?f.some(e[e.length-1]):f.none()}}},right:function(){return{sibling:function(e,t){return e.query().nextSibling(t)},first:function(e){return e.length>0?f.some(e[0]):f.none()}}}},Dl=function(e,t,n,r,o,i){return Bl.go(e,t,r,o).bind((function(t){return i(t.item())?f.none():n(t.item())?f.some(t.item()):Dl(e,t.item(),n,t.mode(),o,i)}))},Ol=function(e,t,n,r){return Dl(e,t,n,Bl.sidestep,Pl.left(),r)},Ml=function(e,t,n,r){return Dl(e,t,n,Bl.sidestep,Pl.right(),r)},Ll=function(e,t){return 0===e.property().children(t).length},Fl=function(e,t,n,r){return Ol(e,t,n,r)},jl=function(e,t,n,r){return Ml(e,t,n,r)},Hl={before:function(e,t,n){return Fl(e,t,a.curry(Ll,e),n)},after:function(e,t,n){return jl(e,t,a.curry(Ll,e),n)},seekLeft:Fl,seekRight:jl,walkers:function(){return{left:Pl.left,right:Pl.right}},walk:function(e,t,n,r,o){return Bl.go(e,t,n,r,o)},backtrack:Bl.backtrack,sidestep:Bl.sidestep,advance:Bl.advance},Ul=Cn(),Wl={gather:function(e,t,n){return Hl.gather(Ul,e,t,n)},before:function(e,t){return Hl.before(Ul,e,t)},after:function(e,t){return Hl.after(Ul,e,t)},seekLeft:function(e,t,n){return Hl.seekLeft(Ul,e,t,n)},seekRight:function(e,t,n){return Hl.seekRight(Ul,e,t,n)},walkers:function(){return Hl.walkers()},walk:function(e,t,n,r){return Hl.walk(Ul,e,t,n,r)}},zl=er([{none:[]},{retry:["caret"]}]),ql=function(e,t,n){return Ct.closest(t,ho).fold(a.constant(!1),(function(t){return El(e,t).exists((function(e){return function(e,t){return e.left()<t.left()||Math.abs(t.right()-e.left())<1||e.left()>t.right()}(n,e)}))}))},Vl={point:wl.getTop,adjuster:function(e,t,n,r,o){var i=wl.moveUp(o,5);return Math.abs(n.top()-r.top())<1?zl.retry(i):n.bottom()<o.top()?zl.retry(i):n.bottom()===o.top()?zl.retry(wl.moveUp(o,1)):ql(e,t,o)?zl.retry(wl.translate(i,5,0)):zl.none()},move:wl.moveUp,gather:Wl.before},$l={point:wl.getBottom,adjuster:function(e,t,n,r,o){var i=wl.moveDown(o,5);return Math.abs(n.bottom()-r.bottom())<1?zl.retry(i):n.top()>o.bottom()?zl.retry(i):n.top()===o.bottom()?zl.retry(wl.moveDown(o,1)):ql(e,t,o)?zl.retry(wl.translate(i,5,0)):zl.none()},move:wl.moveDown,gather:Wl.after},Kl=function(e,t,n,r,o){return 0===o?f.some(r):function(e,t,n){return e.elementFromPoint(t,n).filter((function(e){return"table"===ot.name(e)})).isSome()}(e,r.left(),t.point(r))?function(e,t,n,r,o){return Kl(e,t,n,t.move(r,5),o)}(e,t,n,r,o-1):e.situsFromPoint(r.left(),t.point(r)).bind((function(i){return i.start().fold(f.none,(function(i,a){return El(e,i,a).bind((function(a){return t.adjuster(e,i,a,n,r).fold(f.none,(function(r){return Kl(e,t,n,r,o-1)}))})).orThunk((function(){return f.some(r)}))}),f.none)}))},Jl=function(e,t,n){var r=e.move(n,5),o=Kl(t,e,n,r,100).getOr(r);return function(e,t,n){return e.point(t)>n.getInnerHeight()?f.some(e.point(t)-n.getInnerHeight()):e.point(t)<0?f.some(-e.point(t)):f.none()}(e,o,t).fold((function(){return t.situsFromPoint(o.left(),e.point(o))}),(function(n){return t.scrollBy(0,n),t.situsFromPoint(o.left(),e.point(o)-n)}))},Gl={tryUp:a.curry(Jl,Vl),tryDown:a.curry(Jl,$l),ieTryUp:function(e,t){return e.situsFromPoint(t.left(),t.top()-5)},ieTryDown:function(e,t){return e.situsFromPoint(t.left(),t.bottom()+5)},getJumpSize:a.constant(5)},Xl=er([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),Yl=function(e){return xt.closest(e,"tr")},Ql={verify:function(e,t,n,r,o,i,a){return xt.closest(r,"td,th",a).bind((function(n){return xt.closest(t,"td,th",a).map((function(t){return Ue.eq(n,t)?Ue.eq(r,n)&&sn(n)===o?i(t):Xl.none("in same cell"):_n(Yl,[n,t]).fold((function(){return function(e,t,n){var r=e.getRect(t),o=e.getRect(n);return o.right>r.left&&o.left<r.right}(e,t,n)?Xl.success():i(t)}),(function(e){return i(t)}))}))})).getOr(Xl.none("default"))},cata:function(e,t,n,r,o){return e.fold(t,n,r,o)},adt:Xl},Zl={point:L.immutable("element","offset"),delta:L.immutable("element","deltaOffset"),range:L.immutable("element","start","finish"),points:L.immutable("begin","end"),text:L.immutable("element","text")},eu=(L.immutable("ancestor","descendants","element","index"),L.immutable("parent","children","element","index")),tu=function(e,t){return A.findIndex(e,a.curry(Ue.eq,t))},nu=function(e){return Ge.parent(e).bind((function(t){var n=Ge.children(t);return tu(n,e).map((function(r){return eu(t,n,e,r)}))}))},ru=function(e){return"br"===ot.name(e)},ou=function(e,t,n){return t(e,n).bind((function(e){return ot.isText(e)&&0===on.get(e).trim().length?ou(e,t,n):f.some(e)}))},iu=function(e,t,n,r){return function(e,t){return Ge.child(e,t).filter(ru).orThunk((function(){return Ge.child(e,t-1).filter(ru)}))}(t,n).bind((function(t){return r.traverse(t).fold((function(){return ou(t,r.gather,e).map(r.relative)}),(function(e){return nu(e).map((function(e){return fs.on(e.parent(),e.index())}))}))}))},au=function(e,t,n,r){return(ru(t)?function(e,t,n){return n.traverse(t).orThunk((function(){return ou(t,n.gather,e)})).map(n.relative)}(e,t,r):iu(e,t,n,r)).map((function(e){return{start:a.constant(e),finish:a.constant(e)}}))},cu=function(e){return Ql.cata(e,(function(e){return f.none()}),(function(){return f.none()}),(function(e){return f.some(Zl.point(e,0))}),(function(e){return f.some(Zl.point(e,sn(e)))}))},su=Fe.detect(),lu=function(e,t,n,r,o,i){return 0===i?f.none():fu(e,t,n,r,o).bind((function(a){var c=e.fromSitus(a),s=Ql.verify(e,n,r,c.finish(),c.foffset(),o.failure,t);return Ql.cata(s,(function(){return f.none()}),(function(){return f.some(a)}),(function(a){return Ue.eq(n,a)&&0===r?uu(e,n,r,wl.moveUp,o):lu(e,t,a,0,o,i-1)}),(function(a){return Ue.eq(n,a)&&r===sn(a)?uu(e,n,r,wl.moveDown,o):lu(e,t,a,sn(a),o,i-1)}))}))},uu=function(e,t,n,r,o){return Tl(e,t,n).bind((function(t){return du(e,o,r(t,Gl.getJumpSize()))}))},du=function(e,t,n){return su.browser.isChrome()||su.browser.isSafari()||su.browser.isFirefox()||su.browser.isEdge()?t.otherRetry(e,n):su.browser.isIE()?t.ieRetry(e,n):f.none()},fu=function(e,t,n,r,o){return Tl(e,n,r).bind((function(t){return du(e,o,t)}))},mu=function(e,t,n){return function(e,t,n){return e.getSelection().bind((function(r){return au(t,r.finish(),r.foffset(),n).fold((function(){return f.some(Zl.point(r.finish(),r.foffset()))}),(function(o){var i=e.fromSitus(o),a=Ql.verify(e,r.finish(),r.foffset(),i.finish(),i.foffset(),n.failure,t);return cu(a)}))}))}(e,t,n).bind((function(r){return lu(e,t,r.element(),r.offset(),n,20).map(e.fromSitus)}))},pu=function(e,t,n){return Ct.ancestor(e,t,n).isSome()},gu=Fe.detect(),hu=function(e,t,n,r,o){return xt.closest(r,"td,th",t).bind((function(r){return xt.closest(r,"table",t).bind((function(i){return function(e,t){return pu(e,(function(e){return Ge.parent(e).exists((function(e){return Ue.eq(e,t)}))}))}(o,i)?mu(e,t,n).bind((function(e){return xt.closest(e.finish(),"td,th",t).map((function(t){return{start:a.constant(r),finish:a.constant(t),range:a.constant(e)}}))})):f.none()}))}))},vu=function(e,t,n,r,o,i){return gu.browser.isIE()?f.none():i(r,t).orThunk((function(){return hu(e,t,n,r,o).map((function(e){var t=e.range();return al.response(f.some(dl.makeSitus(t.start(),t.soffset(),t.finish(),t.foffset())),!0)}))}))},bu=function(e,t,n,r,o,i,a){return hu(e,n,r,o,i).bind((function(e){return yl.detect(t,n,e.start(),e.finish(),a)}))},yu=function(e,t){return xt.closest(e,"tr",t).bind((function(e){return xt.closest(e,"table",t).bind((function(n){var r=gt.descendants(n,"tr");return Ue.eq(e,r[0])?Wl.seekLeft(n,(function(e){return dn.last(e).isSome()}),t).map((function(e){var t=sn(e);return al.response(f.some(dl.makeSitus(e,t,e,t)),!0)})):f.none()}))}))},Cu=function(e,t){return xt.closest(e,"tr",t).bind((function(e){return xt.closest(e,"table",t).bind((function(n){var r=gt.descendants(n,"tr");return Ue.eq(e,r[r.length-1])?Wl.seekRight(n,(function(e){return dn.first(e).isSome()}),t).map((function(e){return al.response(f.some(dl.makeSitus(e,0,e,0)),!0)})):f.none()}))}))},wu=function(e,t){return xt.closest(e,"td,th",t)},xu={down:{traverse:Ge.nextSibling,gather:Wl.after,relative:fs.before,otherRetry:Gl.tryDown,ieRetry:Gl.ieTryDown,failure:Ql.adt.failedDown},up:{traverse:Ge.prevSibling,gather:Wl.before,relative:fs.before,otherRetry:Gl.tryUp,ieRetry:Gl.ieTryUp,failure:Ql.adt.failedUp}},ku=L.immutable("rows","cols"),Tu={mouse:function(e,t,n,r){var o=function(e,t,n,r){var o=f.none(),i=function(){o=f.none()};return{mousedown:function(e){r.clear(t),o=wu(e.target(),n)},mouseover:function(i){o.each((function(o){r.clear(t),wu(i.target(),n).each((function(i){Gn.identify(o,i,n).each((function(n){var a=n.boxes().getOr([]);(a.length>1||1===a.length&&!Ue.eq(o,i))&&(r.selectRange(t,a,n.start(),n.finish()),e.selectContents(i))}))}))}))},mouseup:function(){o.each(i)}}}(vl(e),t,n,r);return{mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}},keyboard:function(e,t,n,r){var o=vl(e),i=function(){return r.clear(t),f.none()};return{keydown:function(e,c,s,l,u,d){var m=e.raw().which,p=!0===e.raw().shiftKey;return Gn.retrieve(t,r.selectedSelector()).fold((function(){return ul.isDown(m)&&p?a.curry(bu,o,t,n,xu.down,l,c,r.selectRange):ul.isUp(m)&&p?a.curry(bu,o,t,n,xu.up,l,c,r.selectRange):ul.isDown(m)?a.curry(vu,o,n,xu.down,l,c,Cu):ul.isUp(m)?a.curry(vu,o,n,xu.up,l,c,yu):f.none}),(function(e){var n=function(n){return function(){return Eo(n,(function(n){return yl.update(n.rows(),n.cols(),t,e,r)})).fold((function(){return Gn.getEdges(t,r.firstSelectedSelector(),r.lastSelectedSelector()).map((function(e){var n=ul.isDown(m)||d.isForward(m)?fs.after:fs.before;return o.setRelativeSelection(fs.on(e.first(),0),n(e.table())),r.clear(t),al.response(f.none(),!0)}))}),(function(e){return f.some(al.response(f.none(),!0))}))}};return ul.isDown(m)&&p?n([ku(1,0)]):ul.isUp(m)&&p?n([ku(-1,0)]):d.isBackward(m)&&p?n([ku(0,-1),ku(-1,0)]):d.isForward(m)&&p?n([ku(0,1),ku(1,0)]):ul.isNavigation(m)&&!1===p?i:f.none}))()},keyup:function(e,o,i,a,c){return Gn.retrieve(t,r.selectedSelector()).fold((function(){var s=e.raw().which;return!1==(!0===e.raw().shiftKey)?f.none():ul.isNavigation(s)?yl.sync(t,n,o,i,a,c,r.selectRange):f.none()}),f.none)}}}},Eu=function(e,t){A.each(t,(function(t){ii.remove(e,t)}))},Su=function(e){return function(t){ii.add(t,e)}},Nu=function(e){return function(t){Eu(t,e)}},Au={byClass:function(e){var t=Su(e.selected()),n=Nu([e.selected(),e.lastSelected(),e.firstSelected()]),r=function(t){var r=gt.descendants(t,e.selectedSelector());A.each(r,n)};return{clear:r,selectRange:function(n,o,i,a){r(n),A.each(o,t),ii.add(i,e.firstSelected()),ii.add(a,e.lastSelected())},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}},byAttr:function(e){var t=function(t){lt.remove(t,e.selected()),lt.remove(t,e.firstSelected()),lt.remove(t,e.lastSelected())},n=function(t){lt.set(t,e.selected(),"1")},r=function(n){var r=gt.descendants(n,e.selectedSelector());A.each(r,t)};return{clear:r,selectRange:function(t,o,i,a){r(t),A.each(o,n),lt.set(i,e.firstSelected(),"1"),lt.set(a,e.lastSelected(),"1")},selectedSelector:e.selectedSelector,firstSelectedSelector:e.firstSelectedSelector,lastSelectedSelector:e.lastSelectedSelector}}},Ru=function(e){return{get:function(){var t=Pa(e);return Xn(t,Zn.selectedSelector()).fold((function(){return void 0===e.selection.getStart()?nr.none():nr.single(e.selection)}),(function(e){return nr.multiple(e)}))}}},_u=uc.each,Iu={addButtons:function(e){var t=[];function n(t){return function(){e.execCommand(t)}}_u("inserttable tableprops deletetable | cell row column".split(" "),(function(n){"|"===n?t.push({text:"-"}):t.push(e.menuItems[n])})),e.addButton("table",{type:"menubutton",title:"Table",menu:t}),e.addButton("tableprops",{title:"Table properties",onclick:a.curry(Ac,e,!0),icon:"table"}),e.addButton("tabledelete",{title:"Delete table",onclick:n("mceTableDelete")}),e.addButton("tablecellprops",{title:"Cell properties",onclick:n("mceTableCellProps")}),e.addButton("tablemergecells",{title:"Merge cells",onclick:n("mceTableMergeCells")}),e.addButton("tablesplitcells",{title:"Split cell",onclick:n("mceTableSplitCells")}),e.addButton("tableinsertrowbefore",{title:"Insert row before",onclick:n("mceTableInsertRowBefore")}),e.addButton("tableinsertrowafter",{title:"Insert row after",onclick:n("mceTableInsertRowAfter")}),e.addButton("tabledeleterow",{title:"Delete row",onclick:n("mceTableDeleteRow")}),e.addButton("tablerowprops",{title:"Row properties",onclick:n("mceTableRowProps")}),e.addButton("tablecutrow",{title:"Cut row",onclick:n("mceTableCutRow")}),e.addButton("tablecopyrow",{title:"Copy row",onclick:n("mceTableCopyRow")}),e.addButton("tablepasterowbefore",{title:"Paste row before",onclick:n("mceTablePasteRowBefore")}),e.addButton("tablepasterowafter",{title:"Paste row after",onclick:n("mceTablePasteRowAfter")}),e.addButton("tableinsertcolbefore",{title:"Insert column before",onclick:n("mceTableInsertColBefore")}),e.addButton("tableinsertcolafter",{title:"Insert column after",onclick:n("mceTableInsertColAfter")}),e.addButton("tabledeletecol",{title:"Delete column",onclick:n("mceTableDeleteCol")})},addToolbars:function(e){var t=function(e){var t=e.getParam("table_toolbar",za);return""===t||!1===t?[]:p.isString(t)?t.split(/[ ,]/):p.isArray(t)?t:[]}(e);t.length>0&&e.addContextToolbar((function(t){return e.dom.is(t,"table")&&e.getBody().contains(t)}),t.join(" "))}},Bu={addMenuItems:function(e,t){var n=f.none(),r=[],o=[],i=[],c=[],s=function(e){e.disabled(!0)},l=function(e){e.disabled(!1)},u=function(){var e=this;r.push(e),n.fold((function(){s(e)}),(function(t){l(e)}))},d=function(){var e=this;o.push(e),n.fold((function(){s(e)}),(function(t){l(e)}))};e.on("init",(function(){e.on("nodechange",(function(a){var u=f.from(e.dom.getParent(e.selection.getStart(),"th,td"));(n=u.bind((function(e){var n=$.fromDom(e);return At.table(n).map((function(e){return lr.forMenu(t,e,n)}))}))).fold((function(){A.each(r,s),A.each(o,s),A.each(i,s),A.each(c,s)}),(function(e){A.each(r,l),A.each(o,l),A.each(i,(function(t){t.disabled(e.mergable().isNone())})),A.each(c,(function(t){t.disabled(e.unmergable().isNone())}))}))}))}));var m=function(e,t,n,r){var o,i,a,c,s,l=r.getEl().getElementsByTagName("table")[0],u=r.isRtl()||"tl-tr"===r.parent().rel;for(l.nextSibling.innerHTML=t+1+" x "+(n+1),u&&(t=9-t),i=0;i<10;i++)for(o=0;o<10;o++)c=l.rows[i].childNodes[o].firstChild,s=(u?o>=t:o<=t)&&i<=n,e.dom.toggleClass(c,"mce-active",s),s&&(a=c);return a.parentNode},p=!1===function(e){return e.getParam("table_grid",!0,"boolean")}(e)?{text:"Table",icon:"table",context:"table",onclick:a.curry(Ac,e)}:{text:"Table",icon:"table",context:"table",ariaHideMenu:!0,onclick:function(t){t.aria&&(this.parent().hideAll(),t.stopImmediatePropagation(),Ac(e))},onshow:function(){m(e,0,0,this.menu.items()[0])},onhide:function(){var t=this.menu.items()[0].getEl().getElementsByTagName("a");e.dom.removeClass(t,"mce-active"),e.dom.addClass(t[0],"mce-active")},menu:[{type:"container",html:function(){var e="";e='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var t=0;t<10;t++){e+="<tr>";for(var n=0;n<10;n++)e+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(10*t+n)+'" href="#" data-mce-x="'+n+'" data-mce-y="'+t+'"></a></td>';e+="</tr>"}return e+="</table>",e+='<div class="mce-text-center" role="presentation">1 x 1</div>'}(),onPostRender:function(){this.lastX=this.lastY=0},onmousemove:function(t){var n,r,o=t.target;"A"===o.tagName.toUpperCase()&&(n=parseInt(o.getAttribute("data-mce-x"),10),r=parseInt(o.getAttribute("data-mce-y"),10),(this.isRtl()||"tl-tr"===this.parent().rel)&&(n=9-n),n===this.lastX&&r===this.lastY||(m(e,n,r,t.control),this.lastX=n,this.lastY=r))},onclick:function(t){var n=this;"A"===t.target.tagName.toUpperCase()&&(t.preventDefault(),t.stopPropagation(),n.parent().cancel(),e.undoManager.transact((function(){Ec(e,n.lastX+1,n.lastY+1)})),e.addVisual())}}]};function g(t){return function(){e.execCommand(t)}}var h={text:"Table properties",context:"table",onPostRender:u,onclick:a.curry(Ac,e,!0)},v={text:"Delete table",context:"table",onPostRender:u,cmd:"mceTableDelete"},b={text:"Row",context:"table",menu:[{text:"Insert row before",onclick:g("mceTableInsertRowBefore"),onPostRender:d},{text:"Insert row after",onclick:g("mceTableInsertRowAfter"),onPostRender:d},{text:"Delete row",onclick:g("mceTableDeleteRow"),onPostRender:d},{text:"Row properties",onclick:g("mceTableRowProps"),onPostRender:d},{text:"-"},{text:"Cut row",onclick:g("mceTableCutRow"),onPostRender:d},{text:"Copy row",onclick:g("mceTableCopyRow"),onPostRender:d},{text:"Paste row before",onclick:g("mceTablePasteRowBefore"),onPostRender:d},{text:"Paste row after",onclick:g("mceTablePasteRowAfter"),onPostRender:d}]},y={text:"Column",context:"table",menu:[{text:"Insert column before",onclick:g("mceTableInsertColBefore"),onPostRender:d},{text:"Insert column after",onclick:g("mceTableInsertColAfter"),onPostRender:d},{text:"Delete column",onclick:g("mceTableDeleteCol"),onPostRender:d}]},C={separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:g("mceTableCellProps"),onPostRender:d},{text:"Merge cells",onclick:g("mceTableMergeCells"),onPostRender:function(){var e=this;i.push(e),n.fold((function(){s(e)}),(function(t){e.disabled(t.mergable().isNone())}))}},{text:"Split cell",onclick:g("mceTableSplitCells"),onPostRender:function(){var e=this;c.push(e),n.fold((function(){s(e)}),(function(t){e.disabled(t.unmergable().isNone())}))}}]};e.addMenuItem("inserttable",p),e.addMenuItem("tableprops",h),e.addMenuItem("deletetable",v),e.addMenuItem("row",b),e.addMenuItem("column",y),e.addMenuItem("cell",C)}},Pu=function(e,t){return{insertTable:function(t,n){return Ec(e,t,n)},setClipboardRows:function(e){return function(e,t){var n=A.map(e,$.fromDom);t.set(f.from(n))}(e,t)},getClipboardRows:function(){return function(e){return e.get().fold((function(){}),(function(e){return A.map(e,(function(e){return e.dom()}))}))}(t)}}};n.add("table",(function(e){var t=ns(e),n=function(e,t){var n=L.immutableBag(["mousedown","mouseover","mouseup","keyup","keydown"],[]),r=f.none(),o=Au.byAttr(Zn);return e.on("init",(function(i){var c=e.getWin(),s=Pa(e),l=Ma(e),u=Tu.mouse(c,s,l,o),d=Tu.keyboard(c,s,l,o),m=function(t,n){(function(e){return!0===e.raw().shiftKey})(t)&&(n.kill()&&t.kill(),n.selection().each((function(t){var n=gs.relative(t.start(),t.finish()),r=Ss.asLtrRange(c,n);e.selection.setRng(r)})))},p=function(t){var n=v(t);if(n.raw().shiftKey&&ul.isNavigation(n.raw().which)){var r=e.selection.getRng(),o=$.fromDom(r.startContainer),i=$.fromDom(r.endContainer);d.keyup(n,o,r.startOffset,i,r.endOffset).each((function(e){m(n,e)}))}},g=function(n){var r=v(n);t().each((function(e){e.hideBars()}));var o=e.selection.getRng(),i=$.fromDom(e.selection.getStart()),a=$.fromDom(o.startContainer),c=$.fromDom(o.endContainer),s=Wa.directionAt(i).isRtl()?ul.rtl:ul.ltr;d.keydown(r,a,o.startOffset,c,o.endOffset,s).each((function(e){m(r,e)})),t().each((function(e){e.showBars()}))},h=function(e){return e.hasOwnProperty("x")&&e.hasOwnProperty("y")},v=function(e){var t=$.fromDom(e.target),n=function(){e.stopPropagation()},r=function(){e.preventDefault()},o=a.compose(r,n);return{target:a.constant(t),x:a.constant(h(e)?e.x:null),y:a.constant(h(e)?e.y:null),stop:n,prevent:r,kill:o,raw:a.constant(e)}},b=function(e){return 0===e.button},y=function(e){b(e)&&u.mousedown(v(e))},C=function(e){var t;(void 0===(t=e).buttons||0!=(1&t.buttons))&&u.mouseover(v(e))},w=function(e){b(e)&&u.mouseup(v(e))};e.on("mousedown",y),e.on("mouseover",C),e.on("mouseup",w),e.on("keyup",p),e.on("keydown",g),e.on("nodechange",(function(){var t=e.selection,n=$.fromDom(t.getStart()),r=$.fromDom(t.getEnd()),i=At.table(n),c=At.table(r);i.bind((function(e){return c.bind((function(t){return Ue.eq(e,t)?f.some(!0):f.none()}))})).fold((function(){o.clear(s)}),a.noop)})),r=f.some(n({mousedown:y,mouseover:C,mouseup:w,keyup:p,keydown:g}))})),{clear:o.clear,destroy:function(){r.each((function(e){}))}}}(e,t.lazyResize),r=sc(e,t.lazyWire),o=Ru(e),i=Qr(f.none());return _c.registerCommands(e,r,n,o,i),ur.registerEvents(e,o,r,n),Bu.addMenuItems(e,o),Iu.addButtons(e),Iu.addToolbars(e),e.on("PreInit",(function(){e.serializer.addTempAttr(Zn.firstSelected()),e.serializer.addTempAttr(Zn.lastSelected())})),Ja(e)&&e.on("keydown",(function(n){il.handle(n,e,r,t.lazyWire)})),e.on("remove",(function(){t.destroy(),n.destroy()})),Pu(e,i)}))}()},"./node_modules/tinymce/tinymce.js":function(e,t,n){(function(t){!function(){"use strict";var n,r,o,i,a,c,s,l,u,d,f,m,p,g=function(e){return function(){return e}},h=g(!1),v=g(!0),b={noop:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},noarg:function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e()}},compose:function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e(t.apply(null,arguments))}},constant:g,identity:function(e){return e},tripleEquals:function(e,t){return e===t},curry:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=new Array(arguments.length-1),o=1;o<arguments.length;o++)r[o-1]=arguments[o];return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var o=new Array(arguments.length),i=0;i<o.length;i++)o[i]=arguments[i];var a=r.concat(o);return e.apply(null,a)}},not:function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return!e.apply(null,arguments)}},die:function(e){return function(){throw new Error(e)}},apply:function(e){return e()},call:function(e){e()},never:h,always:v},y=b.never,C=b.always,w=function(){return x},x=function(){var e=function(e){return e.isNone()},t=function(e){return e()},n=function(e){return e},r={fold:function(e,t){return e()},is:y,isSome:y,isNone:C,getOr:n,getOrThunk:t,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},or:n,orThunk:t,map:w,ap:w,each:function(){},bind:w,flatten:w,exists:y,forall:C,filter:w,equals:e,equals_:e,toArray:function(){return[]},toString:b.constant("none()")};return Object.freeze&&Object.freeze(r),r}(),k=function(e){var t=function(){return e},n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:C,isNone:y,getOr:t,getOrThunk:t,getOrDie:t,or:n,orThunk:n,map:function(t){return k(t(e))},ap:function(t){return t.fold(w,(function(t){return k(t(e))}))},each:function(t){t(e)},bind:r,flatten:t,exists:r,forall:r,filter:function(t){return t(e)?o:x},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(y,(function(t){return n(e,t)}))},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return o},T={some:k,none:w,from:function(e){return null==e?x:k(e)}},E=function(e){return function(t){return function(e){if(null===e)return"null";var t=typeof e;return"object"===t&&Array.prototype.isPrototypeOf(e)?"array":"object"===t&&String.prototype.isPrototypeOf(e)?"string":t}(t)===e}},S={isString:E("string"),isObject:E("object"),isArray:E("array"),isNull:E("null"),isBoolean:E("boolean"),isUndefined:E("undefined"),isFunction:E("function"),isNumber:E("number")},N=void 0===(n=Array.prototype.indexOf)?function(e,t){return D(e,t)}:function(e,t){return n.call(e,t)},A=function(e,t){return N(e,t)>-1},R=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o,e)}return r},_=function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n,e)},I=function(e,t){for(var n=e.length-1;n>=0;n--)t(e[n],n,e)},B=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r,e)&&n.push(i)}return n},P=function(e,t){for(var n=0,r=e.length;n<r;n++)if(t(e[n],n,e))return T.some(n);return T.none()},D=function(e,t){for(var n=0,r=e.length;n<r;++n)if(e[n]===t)return n;return-1},O=Array.prototype.push,M=function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!Array.prototype.isPrototypeOf(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);O.apply(t,e[n])}return t},L=function(e,t){for(var n=0,r=e.length;n<r;++n)if(!0!==t(e[n],n,e))return!1;return!0},F=Array.prototype.slice,j=S.isFunction(Array.from)?Array.from:function(e){return F.call(e)},H={map:R,each:_,eachr:I,partition:function(e,t){for(var n=[],r=[],o=0,i=e.length;o<i;o++){var a=e[o];(t(a,o,e)?n:r).push(a)}return{pass:n,fail:r}},filter:B,groupBy:function(e,t){if(0===e.length)return[];for(var n=t(e[0]),r=[],o=[],i=0,a=e.length;i<a;i++){var c=e[i],s=t(c);s!==n&&(r.push(o),o=[]),n=s,o.push(c)}return 0!==o.length&&r.push(o),r},indexOf:function(e,t){var n=N(e,t);return-1===n?T.none():T.some(n)},foldr:function(e,t,n){return I(e,(function(e){n=t(n,e)})),n},foldl:function(e,t,n){return _(e,(function(e){n=t(n,e)})),n},find:function(e,t){for(var n=0,r=e.length;n<r;n++){var o=e[n];if(t(o,n,e))return T.some(o)}return T.none()},findIndex:P,flatten:M,bind:function(e,t){var n=R(e,t);return M(n)},forall:L,exists:function(e,t){return P(e,t).isSome()},contains:A,equal:function(e,t){return e.length===t.length&&L(e,(function(e,n){return e===t[n]}))},reverse:function(e){var t=F.call(e,0);return t.reverse(),t},chunk:function(e,t){for(var n=[],r=0;r<e.length;r+=t){var o=e.slice(r,r+t);n.push(o)}return n},difference:function(e,t){return B(e,(function(e){return!A(t,e)}))},mapToObject:function(e,t){for(var n={},r=0,o=e.length;r<o;r++){var i=e[r];n[String(i)]=t(i,r)}return n},pure:function(e){return[e]},sort:function(e,t){var n=F.call(e,0);return n.sort(t),n},range:function(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n},head:function(e){return 0===e.length?T.none():T.some(e[0])},last:function(e){return 0===e.length?T.none():T.some(e[e.length-1])},from:j},U="undefined"!=typeof window?window:Function("return this;")(),W=function(e,t){for(var n=null!=t?t:U,r=0;r<e.length&&null!=n;++r)n=n[e[r]];return n},z=function(e,t){var n=e.split(".");return W(n,t)},q={getOrDie:function(e,t){var n=function(e,t){return z(e,t)}(e,t);if(null==n)throw e+" not available on this browser";return n}},V=function(){return q.getOrDie("URL")},$={createObjectURL:function(e){return V().createObjectURL(e)},revokeObjectURL:function(e){V().revokeObjectURL(e)}},K=navigator,J=K.userAgent,G=function(e){return"matchMedia"in window&&matchMedia(e).matches};u=/Android/.test(J),o=(o=!(r=/WebKit/.test(J))&&/MSIE/gi.test(J)&&/Explorer/gi.test(K.appName))&&/MSIE (\w+)\./.exec(J)[1],i=-1!==J.indexOf("Trident/")&&(-1!==J.indexOf("rv:")||-1!==K.appName.indexOf("Netscape"))&&11,a=-1!==J.indexOf("Edge/")&&!o&&!i&&12,o=o||i||a,c=!r&&!i&&/Gecko/.test(J),s=-1!==J.indexOf("Mac"),l=/(iPad|iPhone)/.test(J),d="FormData"in window&&"FileReader"in window&&"URL"in window&&!!$.createObjectURL,f=G("only screen and (max-device-width: 480px)")&&(u||l),m=G("only screen and (min-width: 800px)")&&(u||l),p=-1!==J.indexOf("Windows Phone"),a&&(r=!1);var X,Y,Q,Z,ee,te,ne,re,oe,ie,ae,ce,se,le,ue,de,fe,me,pe,ge={opera:!1,webkit:r,ie:o,gecko:c,mac:s,iOS:l,android:u,contentEditable:!l||d||parseInt(J.match(/AppleWebKit\/(\d*)/)[1],10)>=534,transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",caretAfter:8!==o,range:window.getSelection&&"Range"in window,documentMode:o&&!a?document.documentMode||7:10,fileApi:d,ceFalse:!1===o||o>8,cacheSuffix:null,container:null,overrideViewPort:null,experimentalShadowDom:!1,canHaveCSP:!1===o||o>11,desktop:!f&&!m,windowsPhone:p},he=window.Promise?window.Promise:function(){function e(e,t){return function(){e.apply(t,arguments)}}var n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=function(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],u(t,e(a,this),e(c,this))},o=r.immediateFn||"function"==typeof t&&t||function(e){setTimeout(e,1)};function i(e){var t=this;null!==this._state?o((function(){var n=t._state?e.onFulfilled:e.onRejected;if(null!==n){var r;try{r=n(t._value)}catch(t){return void e.reject(t)}e.resolve(r)}else(t._state?e.resolve:e.reject)(t._value)})):this._deferreds.push(e)}function a(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if("function"==typeof n)return void u(e(n,t),e(a,this),e(c,this))}this._state=!0,this._value=t,s.call(this)}catch(e){c.call(this,e)}}function c(e){this._state=!1,this._value=e,s.call(this)}function s(){for(var e=0,t=this._deferreds.length;e<t;e++)i.call(this,this._deferreds[e]);this._deferreds=null}function l(e,t,n,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r}function u(e,t,n){var r=!1;try{e((function(e){r||(r=!0,t(e))}),(function(e){r||(r=!0,n(e))}))}catch(e){if(r)return;r=!0,n(e)}}return r.prototype.catch=function(e){return this.then(null,e)},r.prototype.then=function(e,t){var n=this;return new r((function(r,o){i.call(n,new l(e,t,r,o))}))},r.all=function(){var e=Array.prototype.slice.call(1===arguments.length&&n(arguments[0])?arguments[0]:arguments);return new r((function(t,n){if(0===e.length)return t([]);var r=e.length;function o(i,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void c.call(a,(function(e){o(i,e)}),n)}e[i]=a,0==--r&&t(e)}catch(e){n(e)}}for(var i=0;i<e.length;i++)o(i,e[i])}))},r.resolve=function(e){return e&&"object"==typeof e&&e.constructor===r?e:new r((function(t){t(e)}))},r.reject=function(e){return new r((function(t,n){n(e)}))},r.race=function(e){return new r((function(t,n){for(var r=0,o=e.length;r<o;r++)e[r].then(t,n)}))},r}(),ve=function(e,t){return"number"!=typeof t&&(t=0),setTimeout(e,t)},be=function(e,t){return"number"!=typeof t&&(t=1),setInterval(e,t)},ye=function(e,t){var n,r;return(r=function(){var r=arguments;clearTimeout(n),n=ve((function(){e.apply(this,r)}),t)}).stop=function(){clearTimeout(n)},r},Ce={requestAnimationFrame:function(e,t){X?X.then(e):X=new he((function(e){t||(t=document.body),function(e,t){var n,r=window.requestAnimationFrame,o=["ms","moz","webkit"];for(n=0;n<o.length&&!r;n++)r=window[o[n]+"RequestAnimationFrame"];r||(r=function(e){window.setTimeout(e,0)}),r(e,t)}(e,t)})).then(e)},setTimeout:ve,setInterval:be,setEditorTimeout:function(e,t,n){return ve((function(){e.removed||t()}),n)},setEditorInterval:function(e,t,n){var r;return r=be((function(){e.removed?clearInterval(r):t()}),n)},debounce:ye,throttle:ye,clearInterval:function(e){return clearInterval(e)},clearTimeout:function(e){return clearTimeout(e)}},we=/^(?:mouse|contextmenu)|click/,xe={keyLocation:1,layerX:1,layerY:1,returnValue:1,webkitMovementX:1,webkitMovementY:1,keyIdentifier:1},ke=function(){return!1},Te=function(){return!0},Ee=function(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r||!1):e.attachEvent&&e.attachEvent("on"+t,n)},Se=function(e,t,n,r){e.removeEventListener?e.removeEventListener(t,n,r||!1):e.detachEvent&&e.detachEvent("on"+t,n)},Ne=function(e,t){var n,r=t||{};for(n in e)xe[n]||(r[n]=e[n]);if(r.target||(r.target=r.srcElement||document),ge.experimentalShadowDom&&(r.target=function(e,t){var n,r=t;return(n=e.path)&&n.length>0&&(r=n[0]),e.composedPath&&(n=e.composedPath())&&n.length>0&&(r=n[0]),r}(e,r.target)),e&&we.test(e.type)&&void 0===e.pageX&&void 0!==e.clientX){var o=r.target.ownerDocument||document,i=o.documentElement,a=o.body;r.pageX=e.clientX+(i&&i.scrollLeft||a&&a.scrollLeft||0)-(i&&i.clientLeft||a&&a.clientLeft||0),r.pageY=e.clientY+(i&&i.scrollTop||a&&a.scrollTop||0)-(i&&i.clientTop||a&&a.clientTop||0)}return r.preventDefault=function(){r.isDefaultPrevented=Te,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},r.stopPropagation=function(){r.isPropagationStopped=Te,e&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0)},r.stopImmediatePropagation=function(){r.isImmediatePropagationStopped=Te,r.stopPropagation()},!1===function(e){return e.isDefaultPrevented===Te||e.isDefaultPrevented===ke}(r)&&(r.isDefaultPrevented=ke,r.isPropagationStopped=ke,r.isImmediatePropagationStopped=ke),void 0===r.metaKey&&(r.metaKey=!1),r},Ae=function(e,t,n){var r=e.document,o={type:"ready"};if(n.domLoaded)t(o);else{var i=function(){return"complete"===r.readyState||"interactive"===r.readyState&&r.body},a=function(){n.domLoaded||(n.domLoaded=!0,t(o))},c=function(){i()&&(Se(r,"readystatechange",c),a())},s=function(){try{r.documentElement.doScroll("left")}catch(e){return void Ce.setTimeout(s)}a()};!r.addEventListener||ge.ie&&ge.ie<11?(Ee(r,"readystatechange",c),r.documentElement.doScroll&&e.self===e.top&&s()):i()?a():Ee(e,"DOMContentLoaded",a),Ee(e,"load",a)}},Re=function(){var e,t,n,r,o,i=this,a={};t="mce-data-"+(+new Date).toString(32),r="onmouseenter"in document.documentElement,n="onfocusin"in document.documentElement,o={mouseenter:"mouseover",mouseleave:"mouseout"},e=1,i.domLoaded=!1,i.events=a;var c=function(e,t){var n,r,o,i,c=a[t];if(n=c&&c[e.type])for(r=0,o=n.length;r<o;r++)if((i=n[r])&&!1===i.func.call(i.scope,e)&&e.preventDefault(),e.isImmediatePropagationStopped())return};i.bind=function(s,l,u,d){var f,m,p,g,h,v,b,y=window,C=function(e){c(Ne(e||y.event),f)};if(s&&3!==s.nodeType&&8!==s.nodeType){for(s[t]?f=s[t]:(f=e++,s[t]=f,a[f]={}),d=d||s,p=(l=l.split(" ")).length;p--;)v=C,h=b=!1,"DOMContentLoaded"===(g=l[p])&&(g="ready"),i.domLoaded&&"ready"===g&&"complete"===s.readyState?u.call(d,Ne({type:g})):(r||(h=o[g])&&(v=function(e){var t,n;if(t=e.currentTarget,(n=e.relatedTarget)&&t.contains)n=t.contains(n);else for(;n&&n!==t;)n=n.parentNode;n||((e=Ne(e||y.event)).type="mouseout"===e.type?"mouseleave":"mouseenter",e.target=t,c(e,f))}),n||"focusin"!==g&&"focusout"!==g||(b=!0,h="focusin"===g?"focus":"blur",v=function(e){(e=Ne(e||y.event)).type="focus"===e.type?"focusin":"focusout",c(e,f)}),(m=a[f][g])?"ready"===g&&i.domLoaded?u({type:g}):m.push({func:u,scope:d}):(a[f][g]=m=[{func:u,scope:d}],m.fakeName=h,m.capture=b,m.nativeHandler=v,"ready"===g?Ae(s,v,i):Ee(s,h||g,v,b)));return s=m=0,u}},i.unbind=function(e,n,r){var o,c,s,l,u,d;if(!e||3===e.nodeType||8===e.nodeType)return i;if(o=e[t]){if(d=a[o],n){for(s=(n=n.split(" ")).length;s--;)if(c=d[u=n[s]]){if(r)for(l=c.length;l--;)if(c[l].func===r){var f=c.nativeHandler,m=c.fakeName,p=c.capture;(c=c.slice(0,l).concat(c.slice(l+1))).nativeHandler=f,c.fakeName=m,c.capture=p,d[u]=c}r&&0!==c.length||(delete d[u],Se(e,c.fakeName||u,c.nativeHandler,c.capture))}}else{for(u in d)c=d[u],Se(e,c.fakeName||u,c.nativeHandler,c.capture);d={}}for(u in d)return i;delete a[o];try{delete e[t]}catch(n){e[t]=null}}return i},i.fire=function(e,n,r){var o;if(!e||3===e.nodeType||8===e.nodeType)return i;(r=Ne(null,r)).type=n,r.target=e;do{(o=e[t])&&c(r,o),e=e.parentNode||e.ownerDocument||e.defaultView||e.parentWindow}while(e&&!r.isPropagationStopped());return i},i.clean=function(e){var n,r,o=i.unbind;if(!e||3===e.nodeType||8===e.nodeType)return i;if(e[t]&&o(e),e.getElementsByTagName||(e=e.document),e&&e.getElementsByTagName)for(o(e),n=(r=e.getElementsByTagName("*")).length;n--;)(e=r[n])[t]&&o(e);return i},i.destroy=function(){a={}},i.cancel=function(e){return e&&(e.preventDefault(),e.stopImmediatePropagation()),!1}};Re.Event=new Re,Re.Event.bind(window,"ready",(function(){}));var _e="sizzle"+-new Date,Ie=window.document,Be=0,Pe=0,De=mt(),Oe=mt(),Me=mt(),Le=function(e,t){return e===t&&(ce=!0),0},Fe="undefined",je=1<<31,He={}.hasOwnProperty,Ue=[],We=Ue.pop,ze=Ue.push,qe=Ue.push,Ve=Ue.slice,$e=Ue.indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(this[t]===e)return t;return-1},Ke="[\\x20\\t\\r\\n\\f]",Je="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",Ge="\\["+Ke+"*("+Je+")(?:"+Ke+"*([*^$|!~]?=)"+Ke+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+Je+"))|)"+Ke+"*\\]",Xe=":("+Je+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+Ge+")*)|.*)\\)|)",Ye=new RegExp("^"+Ke+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Ke+"+$","g"),Qe=new RegExp("^"+Ke+"*,"+Ke+"*"),Ze=new RegExp("^"+Ke+"*([>+~]|"+Ke+")"+Ke+"*"),et=new RegExp("="+Ke+"*([^\\]'\"]*?)"+Ke+"*\\]","g"),tt=new RegExp(Xe),nt=new RegExp("^"+Je+"$"),rt={ID:new RegExp("^#("+Je+")"),CLASS:new RegExp("^\\.("+Je+")"),TAG:new RegExp("^("+Je+"|[*])"),ATTR:new RegExp("^"+Ge),PSEUDO:new RegExp("^"+Xe),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+Ke+"*(even|odd|(([+-]|)(\\d*)n|)"+Ke+"*(?:([+-]|)"+Ke+"*(\\d+)|))"+Ke+"*\\)|)","i"),bool:new RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:new RegExp("^"+Ke+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+Ke+"*((?:-\\d)?\\d*)"+Ke+"*\\)|)(?=[^-]|$)","i")},ot=/^(?:input|select|textarea|button)$/i,it=/^h\d$/i,at=/^[^{]+\{\s*\[native \w/,ct=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,st=/[+~]/,lt=/'|\\/g,ut=new RegExp("\\\\([\\da-f]{1,6}"+Ke+"?|("+Ke+")|.)","ig"),dt=function(e,t,n){var r="0x"+t-65536;return r!=r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)};try{qe.apply(Ue=Ve.call(Ie.childNodes),Ie.childNodes),Ue[Ie.childNodes.length].nodeType}catch(e){qe={apply:Ue.length?function(e,t){ze.apply(e,Ve.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}var ft=function(e,t,n,r){var o,i,a,c,s,l,u,d,f,m;if((t?t.ownerDocument||t:Ie)!==le&&se(t),n=n||[],!e||"string"!=typeof e)return n;if(1!==(c=(t=t||le).nodeType)&&9!==c)return[];if(de&&!r){if(o=ct.exec(e))if(a=o[1]){if(9===c){if(!(i=t.getElementById(a))||!i.parentNode)return n;if(i.id===a)return n.push(i),n}else if(t.ownerDocument&&(i=t.ownerDocument.getElementById(a))&&pe(t,i)&&i.id===a)return n.push(i),n}else{if(o[2])return qe.apply(n,t.getElementsByTagName(e)),n;if((a=o[3])&&Q.getElementsByClassName)return qe.apply(n,t.getElementsByClassName(a)),n}if(Q.qsa&&(!fe||!fe.test(e))){if(d=u=_e,f=t,m=9===c&&e,1===c&&"object"!==t.nodeName.toLowerCase()){for(l=ne(e),(u=t.getAttribute("id"))?d=u.replace(lt,"\\$&"):t.setAttribute("id",d),d="[id='"+d+"'] ",s=l.length;s--;)l[s]=d+wt(l[s]);f=st.test(e)&&yt(t.parentNode)||t,m=l.join(",")}if(m)try{return qe.apply(n,f.querySelectorAll(m)),n}catch(e){}finally{u||t.removeAttribute("id")}}}return oe(e.replace(Ye,"$1"),t,n,r)};function mt(){var e=[];return function t(n,r){return e.push(n+" ")>Z.cacheLength&&delete t[e.shift()],t[n+" "]=r}}function pt(e){return e[_e]=!0,e}function gt(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||je)-(~e.sourceIndex||je);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function ht(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function vt(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function bt(e){return pt((function(t){return t=+t,pt((function(n,r){for(var o,i=e([],n.length,t),a=i.length;a--;)n[o=i[a]]&&(n[o]=!(r[o]=n[o]))}))}))}function yt(e){return e&&typeof e.getElementsByTagName!==Fe&&e}for(Y in Q=ft.support={},te=ft.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},se=ft.setDocument=function(e){var t,n=e?e.ownerDocument||e:Ie,r=n.defaultView;return n!==le&&9===n.nodeType&&n.documentElement?(le=n,ue=n.documentElement,de=!te(n),r&&r!==function(e){try{return e.top}catch(e){}return null}(r)&&(r.addEventListener?r.addEventListener("unload",(function(){se()}),!1):r.attachEvent&&r.attachEvent("onunload",(function(){se()}))),Q.attributes=!0,Q.getElementsByTagName=!0,Q.getElementsByClassName=at.test(n.getElementsByClassName),Q.getById=!0,Z.find.ID=function(e,t){if(typeof t.getElementById!==Fe&&de){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},Z.filter.ID=function(e){var t=e.replace(ut,dt);return function(e){return e.getAttribute("id")===t}},Z.find.TAG=Q.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!==Fe)return t.getElementsByTagName(e)}:function(e,t){var n,r=[],o=0,i=t.getElementsByTagName(e);if("*"===e){for(;n=i[o++];)1===n.nodeType&&r.push(n);return r}return i},Z.find.CLASS=Q.getElementsByClassName&&function(e,t){if(de)return t.getElementsByClassName(e)},me=[],fe=[],Q.disconnectedMatch=!0,fe=fe.length&&new RegExp(fe.join("|")),me=me.length&&new RegExp(me.join("|")),t=at.test(ue.compareDocumentPosition),pe=t||at.test(ue.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},Le=t?function(e,t){if(e===t)return ce=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r||(1&(r=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!Q.sortDetached&&t.compareDocumentPosition(e)===r?e===n||e.ownerDocument===Ie&&pe(Ie,e)?-1:t===n||t.ownerDocument===Ie&&pe(Ie,t)?1:ae?$e.call(ae,e)-$e.call(ae,t):0:4&r?-1:1)}:function(e,t){if(e===t)return ce=!0,0;var r,o=0,i=e.parentNode,a=t.parentNode,c=[e],s=[t];if(!i||!a)return e===n?-1:t===n?1:i?-1:a?1:ae?$e.call(ae,e)-$e.call(ae,t):0;if(i===a)return gt(e,t);for(r=e;r=r.parentNode;)c.unshift(r);for(r=t;r=r.parentNode;)s.unshift(r);for(;c[o]===s[o];)o++;return o?gt(c[o],s[o]):c[o]===Ie?-1:s[o]===Ie?1:0},n):le},ft.matches=function(e,t){return ft(e,null,null,t)},ft.matchesSelector=function(e,t){if((e.ownerDocument||e)!==le&&se(e),t=t.replace(et,"='$1']"),Q.matchesSelector&&de&&(!me||!me.test(t))&&(!fe||!fe.test(t)))try{var n=(void 0).call(e,t);if(n||Q.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){}return ft(t,le,null,[e]).length>0},ft.contains=function(e,t){return(e.ownerDocument||e)!==le&&se(e),pe(e,t)},ft.attr=function(e,t){(e.ownerDocument||e)!==le&&se(e);var n=Z.attrHandle[t.toLowerCase()],r=n&&He.call(Z.attrHandle,t.toLowerCase())?n(e,t,!de):void 0;return void 0!==r?r:Q.attributes||!de?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},ft.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ft.uniqueSort=function(e){var t,n=[],r=0,o=0;if(ce=!Q.detectDuplicates,ae=!Q.sortStable&&e.slice(0),e.sort(Le),ce){for(;t=e[o++];)t===e[o]&&(r=n.push(o));for(;r--;)e.splice(n[r],1)}return ae=null,e},ee=ft.getText=function(e){var t,n="",r=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=ee(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[r++];)n+=ee(t);return n},(Z=ft.selectors={cacheLength:50,createPseudo:pt,match:rt,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(ut,dt),e[3]=(e[3]||e[4]||e[5]||"").replace(ut,dt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ft.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ft.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return rt.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&tt.test(n)&&(t=ne(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(ut,dt).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=De[e+" "];return t||(t=new RegExp("(^|"+Ke+")"+e+"("+Ke+"|$)"))&&De(e,(function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==Fe&&e.getAttribute("class")||"")}))},ATTR:function(e,t,n){return function(r){var o=ft.attr(r,e);return null==o?"!="===t:!t||(o+="","="===t?o===n:"!="===t?o!==n:"^="===t?n&&0===o.indexOf(n):"*="===t?n&&o.indexOf(n)>-1:"$="===t?n&&o.slice(-n.length)===n:"~="===t?(" "+o+" ").indexOf(n)>-1:"|="===t&&(o===n||o.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,o){var i="nth"!==e.slice(0,3),a="last"!==e.slice(-4),c="of-type"===t;return 1===r&&0===o?function(e){return!!e.parentNode}:function(t,n,s){var l,u,d,f,m,p,g=i!==a?"nextSibling":"previousSibling",h=t.parentNode,v=c&&t.nodeName.toLowerCase(),b=!s&&!c;if(h){if(i){for(;g;){for(d=t;d=d[g];)if(c?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;p=g="only"===e&&!p&&"nextSibling"}return!0}if(p=[a?h.firstChild:h.lastChild],a&&b){for(m=(l=(u=h[_e]||(h[_e]={}))[e]||[])[0]===Be&&l[1],f=l[0]===Be&&l[2],d=m&&h.childNodes[m];d=++m&&d&&d[g]||(f=m=0)||p.pop();)if(1===d.nodeType&&++f&&d===t){u[e]=[Be,m,f];break}}else if(b&&(l=(t[_e]||(t[_e]={}))[e])&&l[0]===Be)f=l[1];else for(;(d=++m&&d&&d[g]||(f=m=0)||p.pop())&&((c?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++f||(b&&((d[_e]||(d[_e]={}))[e]=[Be,f]),d!==t)););return(f-=o)===r||f%r==0&&f/r>=0}}},PSEUDO:function(e,t){var n,r=Z.pseudos[e]||Z.setFilters[e.toLowerCase()]||ft.error("unsupported pseudo: "+e);return r[_e]?r(t):r.length>1?(n=[e,e,"",t],Z.setFilters.hasOwnProperty(e.toLowerCase())?pt((function(e,n){for(var o,i=r(e,t),a=i.length;a--;)e[o=$e.call(e,i[a])]=!(n[o]=i[a])})):function(e){return r(e,0,n)}):r}},pseudos:{not:pt((function(e){var t=[],n=[],r=re(e.replace(Ye,"$1"));return r[_e]?pt((function(e,t,n,o){for(var i,a=r(e,null,o,[]),c=e.length;c--;)(i=a[c])&&(e[c]=!(t[c]=i))})):function(e,o,i){return t[0]=e,r(t,null,i,n),!n.pop()}})),has:pt((function(e){return function(t){return ft(e,t).length>0}})),contains:pt((function(e){return e=e.replace(ut,dt),function(t){return(t.textContent||t.innerText||ee(t)).indexOf(e)>-1}})),lang:pt((function(e){return nt.test(e||"")||ft.error("unsupported lang: "+e),e=e.replace(ut,dt).toLowerCase(),function(t){var n;do{if(n=de?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(e){var t=window.location&&window.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===ue},focus:function(e){return e===le.activeElement&&(!le.hasFocus||le.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!Z.pseudos.empty(e)},header:function(e){return it.test(e.nodeName)},input:function(e){return ot.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:bt((function(){return[0]})),last:bt((function(e,t){return[t-1]})),eq:bt((function(e,t,n){return[n<0?n+t:n]})),even:bt((function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e})),odd:bt((function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e})),lt:bt((function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e})),gt:bt((function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e}))}}).pseudos.nth=Z.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Z.pseudos[Y]=ht(Y);for(Y in{submit:!0,reset:!0})Z.pseudos[Y]=vt(Y);function Ct(){}function wt(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function xt(e,t,n){var r=t.dir,o=n&&"parentNode"===r,i=Pe++;return t.first?function(t,n,i){for(;t=t[r];)if(1===t.nodeType||o)return e(t,n,i)}:function(t,n,a){var c,s,l=[Be,i];if(a){for(;t=t[r];)if((1===t.nodeType||o)&&e(t,n,a))return!0}else for(;t=t[r];)if(1===t.nodeType||o){if((c=(s=t[_e]||(t[_e]={}))[r])&&c[0]===Be&&c[1]===i)return l[2]=c[2];if(s[r]=l,l[2]=e(t,n,a))return!0}}}function kt(e){return e.length>1?function(t,n,r){for(var o=e.length;o--;)if(!e[o](t,n,r))return!1;return!0}:e[0]}function Tt(e,t,n,r,o){for(var i,a=[],c=0,s=e.length,l=null!=t;c<s;c++)(i=e[c])&&(n&&!n(i,r,o)||(a.push(i),l&&t.push(c)));return a}function Et(e,t,n,r,o,i){return r&&!r[_e]&&(r=Et(r)),o&&!o[_e]&&(o=Et(o,i)),pt((function(i,a,c,s){var l,u,d,f=[],m=[],p=a.length,g=i||function(e,t,n){for(var r=0,o=t.length;r<o;r++)ft(e,t[r],n);return n}(t||"*",c.nodeType?[c]:c,[]),h=!e||!i&&t?g:Tt(g,f,e,c,s),v=n?o||(i?e:p||r)?[]:a:h;if(n&&n(h,v,c,s),r)for(l=Tt(v,m),r(l,[],c,s),u=l.length;u--;)(d=l[u])&&(v[m[u]]=!(h[m[u]]=d));if(i){if(o||e){if(o){for(l=[],u=v.length;u--;)(d=v[u])&&l.push(h[u]=d);o(null,v=[],l,s)}for(u=v.length;u--;)(d=v[u])&&(l=o?$e.call(i,d):f[u])>-1&&(i[l]=!(a[l]=d))}}else v=Tt(v===a?v.splice(p,v.length):v),o?o(null,a,v,s):qe.apply(a,v)}))}function St(e){for(var t,n,r,o=e.length,i=Z.relative[e[0].type],a=i||Z.relative[" "],c=i?1:0,s=xt((function(e){return e===t}),a,!0),l=xt((function(e){return $e.call(t,e)>-1}),a,!0),u=[function(e,n,r){return!i&&(r||n!==ie)||((t=n).nodeType?s(e,n,r):l(e,n,r))}];c<o;c++)if(n=Z.relative[e[c].type])u=[xt(kt(u),n)];else{if((n=Z.filter[e[c].type].apply(null,e[c].matches))[_e]){for(r=++c;r<o&&!Z.relative[e[r].type];r++);return Et(c>1&&kt(u),c>1&&wt(e.slice(0,c-1).concat({value:" "===e[c-2].type?"*":""})).replace(Ye,"$1"),n,c<r&&St(e.slice(c,r)),r<o&&St(e=e.slice(r)),r<o&&wt(e))}u.push(n)}return kt(u)}Ct.prototype=Z.filters=Z.pseudos,Z.setFilters=new Ct,ne=ft.tokenize=function(e,t){var n,r,o,i,a,c,s,l=Oe[e+" "];if(l)return t?0:l.slice(0);for(a=e,c=[],s=Z.preFilter;a;){for(i in n&&!(r=Qe.exec(a))||(r&&(a=a.slice(r[0].length)||a),c.push(o=[])),n=!1,(r=Ze.exec(a))&&(n=r.shift(),o.push({value:n,type:r[0].replace(Ye," ")}),a=a.slice(n.length)),Z.filter)!(r=rt[i].exec(a))||s[i]&&!(r=s[i](r))||(n=r.shift(),o.push({value:n,type:i,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?ft.error(e):Oe(e,c).slice(0)},re=ft.compile=function(e,t){var n,r=[],o=[],i=Me[e+" "];if(!i){for(t||(t=ne(e)),n=t.length;n--;)(i=St(t[n]))[_e]?r.push(i):o.push(i);(i=Me(e,function(e,t){var n=t.length>0,r=e.length>0,o=function(o,i,a,c,s){var l,u,d,f=0,m="0",p=o&&[],g=[],h=ie,v=o||r&&Z.find.TAG("*",s),b=Be+=null==h?1:Math.random()||.1,y=v.length;for(s&&(ie=i!==le&&i);m!==y&&null!=(l=v[m]);m++){if(r&&l){for(u=0;d=e[u++];)if(d(l,i,a)){c.push(l);break}s&&(Be=b)}n&&((l=!d&&l)&&f--,o&&p.push(l))}if(f+=m,n&&m!==f){for(u=0;d=t[u++];)d(p,g,i,a);if(o){if(f>0)for(;m--;)p[m]||g[m]||(g[m]=We.call(c));g=Tt(g)}qe.apply(c,g),s&&!o&&g.length>0&&f+t.length>1&&ft.uniqueSort(c)}return s&&(Be=b,ie=h),p};return n?pt(o):o}(o,r))).selector=e}return i},oe=ft.select=function(e,t,n,r){var o,i,a,c,s,l="function"==typeof e&&e,u=!r&&ne(e=l.selector||e);if(n=n||[],1===u.length){if((i=u[0]=u[0].slice(0)).length>2&&"ID"===(a=i[0]).type&&Q.getById&&9===t.nodeType&&de&&Z.relative[i[1].type]){if(!(t=(Z.find.ID(a.matches[0].replace(ut,dt),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(i.shift().value.length)}for(o=rt.needsContext.test(e)?0:i.length;o--&&(a=i[o],!Z.relative[c=a.type]);)if((s=Z.find[c])&&(r=s(a.matches[0].replace(ut,dt),st.test(i[0].type)&&yt(t.parentNode)||t))){if(i.splice(o,1),!(e=r.length&&wt(i)))return qe.apply(n,r),n;break}}return(l||re(e,u))(r,t,!de,n,st.test(e)&&yt(t.parentNode)||t),n},Q.sortStable=_e.split("").sort(Le).join("")===_e,Q.detectDuplicates=!!ce,se(),Q.sortDetached=!0;var Nt=Array.isArray,At=function(e,t,n){var r,o;if(!e)return 0;if(n=n||e,void 0!==e.length){for(r=0,o=e.length;r<o;r++)if(!1===t.call(n,e[r],r,e))return 0}else for(r in e)if(e.hasOwnProperty(r)&&!1===t.call(n,e[r],r,e))return 0;return 1},Rt=function(e,t,n){var r,o;for(r=0,o=e.length;r<o;r++)if(t.call(n,e[r],r,e))return r;return-1},_t={isArray:Nt,toArray:function(e){var t,n,r=e;if(!Nt(e))for(r=[],t=0,n=e.length;t<n;t++)r[t]=e[t];return r},each:At,map:function(e,t){var n=[];return At(e,(function(r,o){n.push(t(r,o,e))})),n},filter:function(e,t){var n=[];return At(e,(function(r,o){t&&!t(r,o,e)||n.push(r)})),n},indexOf:function(e,t){var n,r;if(e)for(n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},reduce:function(e,t,n,r){var o=0;for(arguments.length<3&&(n=e[0]);o<e.length;o++)n=t.call(r,n,e[o],o);return n},findIndex:Rt,find:function(e,t,n){var r=Rt(e,t,n);if(-1!==r)return e[r]},last:function(e){return e[e.length-1]}},It=/^\s*|\s*$/g,Bt=function(e){return null==e?"":(""+e).replace(It,"")},Pt=function(e,t){return t?!("array"!==t||!_t.isArray(e))||typeof e===t:void 0!==e},Dt=function(e,t,n,r){r=r||this,e&&(n&&(e=e[n]),_t.each(e,(function(e,o){if(!1===t.call(r,e,o,n))return!1;Dt(e,t,n,r)})))},Ot={trim:Bt,isArray:_t.isArray,is:Pt,toArray:_t.toArray,makeMap:function(e,t,n){var r;for(t=t||",","string"==typeof(e=e||[])&&(e=e.split(t)),n=n||{},r=e.length;r--;)n[e[r]]={};return n},each:_t.each,map:_t.map,grep:_t.filter,inArray:_t.indexOf,hasOwn:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},extend:function(e,t){for(var n,r,o,i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];var c,s=arguments;for(n=1,r=s.length;n<r;n++)for(o in t=s[n])t.hasOwnProperty(o)&&void 0!==(c=t[o])&&(e[o]=c);return e},create:function(e,t,n){var r,o,i,a,c,s=0;if(e=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(e),i=e[3].match(/(^|\.)(\w+)$/i)[2],!(o=this.createNS(e[3].replace(/\.\w+$/,""),n))[i]){if("static"===e[2])return o[i]=t,void(this.onCreate&&this.onCreate(e[2],e[3],o[i]));t[i]||(t[i]=function(){},s=1),o[i]=t[i],this.extend(o[i].prototype,t),e[5]&&(r=this.resolve(e[5]).prototype,a=e[5].match(/\.(\w+)$/i)[1],c=o[i],o[i]=s?function(){return r[a].apply(this,arguments)}:function(){return this.parent=r[a],c.apply(this,arguments)},o[i].prototype[i]=o[i],this.each(r,(function(e,t){o[i].prototype[t]=r[t]})),this.each(t,(function(e,t){r[t]?o[i].prototype[t]=function(){return this.parent=r[t],e.apply(this,arguments)}:t!==i&&(o[i].prototype[t]=e)}))),this.each(t.static,(function(e,t){o[i][t]=e}))}},walk:Dt,createNS:function(e,t){var n,r;for(t=t||window,e=e.split("."),n=0;n<e.length;n++)t[r=e[n]]||(t[r]={}),t=t[r];return t},resolve:function(e,t){var n,r;for(t=t||window,n=0,r=(e=e.split(".")).length;n<r&&(t=t[e[n]]);n++);return t},explode:function(e,t){return!e||Pt(e,"array")?e:_t.map(e.split(t||","),Bt)},_addCacheSuffix:function(e){var t=ge.cacheSuffix;return t&&(e+=(-1===e.indexOf("?")?"?":"&")+t),e}},Mt=document,Lt=Array.prototype.push,Ft=Array.prototype.slice,jt=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,Ht=Re.Event,Ut=Ot.makeMap("children,contents,next,prev"),Wt=function(e){return void 0!==e},zt=function(e){return"string"==typeof e},qt=function(e,t){var n,r,o;for(o=(t=t||Mt).createElement("div"),n=t.createDocumentFragment(),o.innerHTML=e;r=o.firstChild;)n.appendChild(r);return n},Vt=function(e,t,n,r){var o;if(zt(t))t=qt(t,an(e[0]));else if(t.length&&!t.nodeType){if(t=en.makeArray(t),r)for(o=t.length-1;o>=0;o--)Vt(e,t[o],n,r);else for(o=0;o<t.length;o++)Vt(e,t[o],n,r);return e}if(t.nodeType)for(o=e.length;o--;)n.call(e[o],t);return e},$t=function(e,t){return e&&t&&-1!==(" "+e.className+" ").indexOf(" "+t+" ")},Kt=function(e,t,n){var r,o;return t=en(t)[0],e.each((function(){n&&r===this.parentNode?o.appendChild(this):(r=this.parentNode,o=t.cloneNode(!1),this.parentNode.insertBefore(o,this),o.appendChild(this))})),e},Jt=Ot.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"," "),Gt=Ot.makeMap("checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected"," "),Xt={for:"htmlFor",class:"className",readonly:"readOnly"},Yt={float:"cssFloat"},Qt={},Zt={},en=function(e,t){return new en.fn.init(e,t)},tn=/^\s*|\s*$/g,nn=function(e){return null==e?"":(""+e).replace(tn,"")},rn=function(e,t){var n,r,o,i;if(e)if(void 0===(n=e.length)){for(r in e)if(e.hasOwnProperty(r)&&(i=e[r],!1===t.call(i,r,i)))break}else for(o=0;o<n&&(i=e[o],!1!==t.call(i,o,i));o++);return e},on=function(e,t){var n=[];return rn(e,(function(e,r){t(r,e)&&n.push(r)})),n},an=function(e){return e?9===e.nodeType?e:e.ownerDocument:Mt};en.fn=en.prototype={constructor:en,selector:"",context:null,length:0,init:function(e,t){var n,r;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if(t&&t.nodeType)this.context=t;else{if(t)return en(e).attr(t);this.context=t=document}if(zt(e)){if(this.selector=e,!(n="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:jt.exec(e)))return en(t).find(e);if(n[1])for(r=qt(e,an(t)).firstChild;r;)Lt.call(this,r),r=r.nextSibling;else{if(!(r=an(t).getElementById(n[2])))return this;if(r.id!==n[2])return this.find(e);this.length=1,this[0]=r}}else this.add(e,!1);return this},toArray:function(){return Ot.toArray(this)},add:function(e,t){var n,r;if(zt(e))return this.add(en(e));if(!1!==t)for(n=en.unique(this.toArray().concat(en.makeArray(e))),this.length=n.length,r=0;r<n.length;r++)this[r]=n[r];else Lt.apply(this,en.makeArray(e));return this},attr:function(e,t){var n,r=this;if("object"==typeof e)rn(e,(function(e,t){r.attr(e,t)}));else{if(!Wt(t)){if(r[0]&&1===r[0].nodeType){if((n=Qt[e])&&n.get)return n.get(r[0],e);if(Gt[e])return r.prop(e)?e:void 0;null===(t=r[0].getAttribute(e,2))&&(t=void 0)}return t}this.each((function(){var n;if(1===this.nodeType){if((n=Qt[e])&&n.set)return void n.set(this,t);null===t?this.removeAttribute(e,2):this.setAttribute(e,t,2)}}))}return r},removeAttr:function(e){return this.attr(e,null)},prop:function(e,t){var n=this;if("object"==typeof(e=Xt[e]||e))rn(e,(function(e,t){n.prop(e,t)}));else{if(!Wt(t))return n[0]&&n[0].nodeType&&e in n[0]?n[0][e]:t;this.each((function(){1===this.nodeType&&(this[e]=t)}))}return n},css:function(e,t){var n,r,o=this,i=function(e){return e.replace(/-(\D)/g,(function(e,t){return t.toUpperCase()}))},a=function(e){return e.replace(/[A-Z]/g,(function(e){return"-"+e}))};if("object"==typeof e)rn(e,(function(e,t){o.css(e,t)}));else if(Wt(t))e=i(e),"number"!=typeof t||Jt[e]||(t=t.toString()+"px"),o.each((function(){var n=this.style;if((r=Zt[e])&&r.set)r.set(this,t);else{try{this.style[Yt[e]||e]=t}catch(e){}null!==t&&""!==t||(n.removeProperty?n.removeProperty(a(e)):n.removeAttribute(e))}}));else{if(n=o[0],(r=Zt[e])&&r.get)return r.get(n);if(!n.ownerDocument.defaultView)return n.currentStyle?n.currentStyle[i(e)]:"";try{return n.ownerDocument.defaultView.getComputedStyle(n,null).getPropertyValue(a(e))}catch(e){return}}return o},remove:function(){for(var e,t=this.length;t--;)e=this[t],Ht.clean(e),e.parentNode&&e.parentNode.removeChild(e);return this},empty:function(){for(var e,t=this.length;t--;)for(e=this[t];e.firstChild;)e.removeChild(e.firstChild);return this},html:function(e){var t;if(Wt(e)){t=this.length;try{for(;t--;)this[t].innerHTML=e}catch(n){en(this[t]).empty().append(e)}return this}return this[0]?this[0].innerHTML:""},text:function(e){var t;if(Wt(e)){for(t=this.length;t--;)"innerText"in this[t]?this[t].innerText=e:this[0].textContent=e;return this}return this[0]?this[0].innerText||this[0].textContent:""},append:function(){return Vt(this,arguments,(function(e){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.appendChild(e)}))},prepend:function(){return Vt(this,arguments,(function(e){(1===this.nodeType||this.host&&1===this.host.nodeType)&&this.insertBefore(e,this.firstChild)}),!0)},before:function(){var e=this;return e[0]&&e[0].parentNode?Vt(e,arguments,(function(e){this.parentNode.insertBefore(e,this)})):e},after:function(){var e=this;return e[0]&&e[0].parentNode?Vt(e,arguments,(function(e){this.parentNode.insertBefore(e,this.nextSibling)}),!0):e},appendTo:function(e){return en(e).append(this),this},prependTo:function(e){return en(e).prepend(this),this},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){return Kt(this,e)},wrapAll:function(e){return Kt(this,e,!0)},wrapInner:function(e){return this.each((function(){en(this).contents().wrapAll(e)})),this},unwrap:function(){return this.parent().each((function(){en(this).replaceWith(this.childNodes)}))},clone:function(){var e=[];return this.each((function(){e.push(this.cloneNode(!0))})),en(e)},addClass:function(e){return this.toggleClass(e,!0)},removeClass:function(e){return this.toggleClass(e,!1)},toggleClass:function(e,t){var n=this;return"string"!=typeof e?n:(-1!==e.indexOf(" ")?rn(e.split(" "),(function(){n.toggleClass(this,t)})):n.each((function(n,r){var o,i;(i=$t(r,e))!==t&&(o=r.className,i?r.className=nn((" "+o+" ").replace(" "+e+" "," ")):r.className+=o?" "+e:e)})),n)},hasClass:function(e){return $t(this[0],e)},each:function(e){return rn(this,e)},on:function(e,t){return this.each((function(){Ht.bind(this,e,t)}))},off:function(e,t){return this.each((function(){Ht.unbind(this,e,t)}))},trigger:function(e){return this.each((function(){"object"==typeof e?Ht.fire(this,e.type,e):Ht.fire(this,e)}))},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},slice:function(){return new en(Ft.apply(this,arguments))},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},find:function(e){var t,n,r=[];for(t=0,n=this.length;t<n;t++)en.find(e,this[t],r);return en(r)},filter:function(e){return en("function"==typeof e?on(this.toArray(),(function(t,n){return e(n,t)})):en.filter(e,this.toArray()))},closest:function(e){var t=[];return e instanceof en&&(e=e[0]),this.each((function(n,r){for(;r;){if("string"==typeof e&&en(r).is(e)){t.push(r);break}if(r===e){t.push(r);break}r=r.parentNode}})),en(t)},offset:function(e){var t,n,r,o,i=0,a=0;return e?this.css(e):((t=this[0])&&(r=(n=t.ownerDocument).documentElement,t.getBoundingClientRect&&(i=(o=t.getBoundingClientRect()).left+(r.scrollLeft||n.body.scrollLeft)-r.clientLeft,a=o.top+(r.scrollTop||n.body.scrollTop)-r.clientTop)),{left:i,top:a})},push:Lt,sort:[].sort,splice:[].splice},Ot.extend(en,{extend:Ot.extend,makeArray:function(e){return(t=e)&&t===t.window||e.nodeType?[e]:Ot.toArray(e);var t},inArray:function(e,t){var n;if(t.indexOf)return t.indexOf(e);for(n=t.length;n--;)if(t[n]===e)return n;return-1},isArray:Ot.isArray,each:rn,trim:nn,grep:on,find:ft,expr:ft.selectors,unique:ft.uniqueSort,text:ft.getText,contains:ft.contains,filter:function(e,t,n){var r=t.length;for(n&&(e=":not("+e+")");r--;)1!==t[r].nodeType&&t.splice(r,1);return t=1===t.length?en.find.matchesSelector(t[0],e)?[t[0]]:[]:en.find.matches(e,t)}});var cn=function(e,t,n){var r=[],o=e[t];for("string"!=typeof n&&n instanceof en&&(n=n[0]);o&&9!==o.nodeType;){if(void 0!==n){if(o===n)break;if("string"==typeof n&&en(o).is(n))break}1===o.nodeType&&r.push(o),o=o[t]}return r},sn=function(e,t,n,r){var o=[];for(r instanceof en&&(r=r[0]);e;e=e[t])if(!n||e.nodeType===n){if(void 0!==r){if(e===r)break;if("string"==typeof r&&en(e).is(r))break}o.push(e)}return o},ln=function(e,t,n){for(e=e[t];e;e=e[t])if(e.nodeType===n)return e;return null};rn({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return cn(e,"parentNode")},next:function(e){return ln(e,"nextSibling",1)},prev:function(e){return ln(e,"previousSibling",1)},children:function(e){return sn(e.firstChild,"nextSibling",1)},contents:function(e){return Ot.toArray(("iframe"===e.nodeName?e.contentDocument||e.contentWindow.document:e).childNodes)}},(function(e,t){en.fn[e]=function(n){var r=[];return this.each((function(){var e=t.call(r,this,n,r);e&&(en.isArray(e)?r.push.apply(r,e):r.push(e))})),this.length>1&&(Ut[e]||(r=en.unique(r)),0===e.indexOf("parents")&&(r=r.reverse())),r=en(r),n?r.filter(n):r}})),rn({parentsUntil:function(e,t){return cn(e,"parentNode",t)},nextUntil:function(e,t){return sn(e,"nextSibling",1,t).slice(1)},prevUntil:function(e,t){return sn(e,"previousSibling",1,t).slice(1)}},(function(e,t){en.fn[e]=function(n,r){var o=[];return this.each((function(){var e=t.call(o,this,n,o);e&&(en.isArray(e)?o.push.apply(o,e):o.push(e))})),this.length>1&&(o=en.unique(o),0!==e.indexOf("parents")&&"prevUntil"!==e||(o=o.reverse())),o=en(o),r?o.filter(r):o}})),en.fn.is=function(e){return!!e&&this.filter(e).length>0},en.fn.init.prototype=en.fn,en.overrideDefaults=function(e){var t,n=function(r,o){return t=t||e(),0===arguments.length&&(r=t.element),o||(o=t.context),new n.fn.init(r,o)};return en.extend(n,this),n};var un=function(e,t,n){rn(n,(function(n,r){e[n]=e[n]||{},e[n][t]=r}))};ge.ie&&ge.ie<8&&(un(Qt,"get",{maxlength:function(e){var t=e.maxLength;if(2147483647!==t)return t},size:function(e){var t=e.size;if(20!==t)return t},class:function(e){return e.className},style:function(e){var t=e.style.cssText;if(0!==t.length)return t}}),un(Qt,"set",{class:function(e,t){e.className=t},style:function(e,t){e.style.cssText=t}})),ge.ie&&ge.ie<9&&(Yt.float="styleFloat",un(Zt,"set",{opacity:function(e,t){var n=e.style;null===t||""===t?n.removeAttribute("filter"):(n.zoom=1,n.filter="alpha(opacity="+100*t+")")}})),en.attrHooks=Qt,en.cssHooks=Zt;var dn,fn=function(e){var t,n=!1;return function(){return n||(n=!0,t=e.apply(null,arguments)),t}},mn=function(){return pn(0,0)},pn=function(e,t){return{major:e,minor:t}},gn={nu:pn,detect:function(e,t){var n=String(t).toLowerCase();return 0===e.length?mn():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return pn(r(1),r(2))}(e,n)},unknown:mn},hn=function(e,t){return function(){return t===e}},vn=function(e){var t=e.current;return{current:t,version:e.version,isEdge:hn("Edge",t),isChrome:hn("Chrome",t),isIE:hn("IE",t),isOpera:hn("Opera",t),isFirefox:hn("Firefox",t),isSafari:hn("Safari",t)}},bn={unknown:function(){return vn({current:void 0,version:gn.unknown()})},nu:vn,edge:b.constant("Edge"),chrome:b.constant("Chrome"),ie:b.constant("IE"),opera:b.constant("Opera"),firefox:b.constant("Firefox"),safari:b.constant("Safari")},yn=function(e,t){return function(){return t===e}},Cn=function(e){var t=e.current;return{current:t,version:e.version,isWindows:yn("Windows",t),isiOS:yn("iOS",t),isAndroid:yn("Android",t),isOSX:yn("OSX",t),isLinux:yn("Linux",t),isSolaris:yn("Solaris",t),isFreeBSD:yn("FreeBSD",t)}},wn={unknown:function(){return Cn({current:void 0,version:gn.unknown()})},nu:Cn,windows:b.constant("Windows"),ios:b.constant("iOS"),android:b.constant("Android"),linux:b.constant("Linux"),osx:b.constant("OSX"),solaris:b.constant("Solaris"),freebsd:b.constant("FreeBSD")},xn=function(e,t){var n=String(t).toLowerCase();return H.find(e,(function(e){return e.search(n)}))},kn=function(e,t){return xn(e,t).map((function(e){var n=gn.detect(e.versionRegexes,t);return{current:e.name,version:n}}))},Tn=function(e,t){return xn(e,t).map((function(e){var n=gn.detect(e.versionRegexes,t);return{current:e.name,version:n}}))},En=function(e,t){return-1!==e.indexOf(t)},Sn=function(e){return e.replace(/^\s+|\s+$/g,"")},Nn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,An=function(e){return function(t){return En(t,e)}},Rn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return En(e,"edge/")&&En(e,"chrome")&&En(e,"safari")&&En(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Nn],search:function(e){return En(e,"chrome")&&!En(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return En(e,"msie")||En(e,"trident")}},{name:"Opera",versionRegexes:[Nn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:An("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:An("firefox")},{name:"Safari",versionRegexes:[Nn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(En(e,"safari")||En(e,"mobile/"))&&En(e,"applewebkit")}}],_n=[{name:"Windows",search:An("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return En(e,"iphone")||En(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:An("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:An("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:An("linux"),versionRegexes:[]},{name:"Solaris",search:An("sunos"),versionRegexes:[]},{name:"FreeBSD",search:An("freebsd"),versionRegexes:[]}],In={browsers:b.constant(Rn),oses:b.constant(_n)},Bn=function(e){var t=In.browsers(),n=In.oses(),r=kn(t,e).fold(bn.unknown,bn.nu),o=Tn(n,e).fold(wn.unknown,wn.nu),i=function(e,t,n){var r=e.isiOS()&&!0===/ipad/i.test(n),o=e.isiOS()&&!r,i=e.isAndroid()&&3===e.version.major,a=e.isAndroid()&&4===e.version.major,c=r||i||a&&!0===/mobile/i.test(n),s=e.isiOS()||e.isAndroid(),l=s&&!c,u=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n);return{isiPad:b.constant(r),isiPhone:b.constant(o),isTablet:b.constant(c),isPhone:b.constant(l),isTouch:b.constant(s),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:b.constant(u)}}(o,r,e);return{browser:r,os:o,deviceType:i}},Pn={detect:fn((function(){var e=navigator.userAgent;return Bn(e)}))},Dn=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:b.constant(e)}},On={fromHtml:function(e,t){var n=(t||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||n.childNodes.length>1)throw console.error("HTML does not have a single root node",e),"HTML must have a single root node";return Dn(n.childNodes[0])},fromTag:function(e,t){var n=(t||document).createElement(e);return Dn(n)},fromText:function(e,t){var n=(t||document).createTextNode(e);return Dn(n)},fromDom:Dn,fromPoint:function(e,t,n){return T.from(e.dom().elementFromPoint(t,n)).map(Dn)}},Mn=8,Ln=9,Fn=1,jn=3,Hn=function(e){return e.dom().nodeName.toLowerCase()},Un=function(e){return e.dom().nodeType},Wn=function(e){return function(t){return Un(t)===e}},zn=Wn(Fn),qn=Wn(jn),Vn=Wn(Ln),$n={name:Hn,type:Un,value:function(e){return e.dom().nodeValue},isElement:zn,isText:qn,isDocument:Vn,isComment:function(e){return Un(e)===Mn||"#comment"===Hn(e)}},Kn=void 0===(dn=Object.keys)?function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}:dn,Jn=function(e,t){for(var n=Kn(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i,e)}},Gn=function(e,t){var n={};return Jn(e,(function(r,o){var i=t(r,o,e);n[i.k]=i.v})),n},Xn=function(e,t){var n=[];return Jn(e,(function(e,r){n.push(t(e,r))})),n},Yn=function(e){return Xn(e,(function(e){return e}))},Qn={bifilter:function(e,t){var n={},r={};return Jn(e,(function(e,o){(t(e,o)?n:r)[o]=e})),{t:n,f:r}},each:Jn,map:function(e,t){return Gn(e,(function(e,n,r){return{k:n,v:t(e,n,r)}}))},mapToArray:Xn,tupleMap:Gn,find:function(e,t){for(var n=Kn(e),r=0,o=n.length;r<o;r++){var i=n[r],a=e[i];if(t(a,i,e))return T.some(a)}return T.none()},keys:Kn,values:Yn,size:function(e){return Yn(e).length}},Zn=function(e,t,n){if(!(S.isString(n)||S.isBoolean(n)||S.isNumber(n)))throw console.error("Invalid call to Attr.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},er=function(e,t,n){Zn(e.dom(),t,n)},tr=function(e,t){var n=e.dom().getAttribute(t);return null===n?void 0:n},nr=function(e,t){var n=e.dom();return!(!n||!n.hasAttribute)&&n.hasAttribute(t)},rr={clone:function(e){return H.foldl(e.dom().attributes,(function(e,t){return e[t.name]=t.value,e}),{})},set:er,setAll:function(e,t){var n=e.dom();Qn.each(t,(function(e,t){Zn(n,t,e)}))},get:tr,has:nr,remove:function(e,t){e.dom().removeAttribute(t)},hasNone:function(e){var t=e.dom().attributes;return null==t||0===t.length},transfer:function(e,t,n){$n.isElement(e)&&$n.isElement(t)&&H.each(n,(function(n){!function(e,t,n){nr(e,n)&&!nr(t,n)&&er(t,n,tr(e,n))}(e,t,n)}))}},or=fn((function(){return ir(On.fromDom(document))})),ir=function(e){var t=e.dom().body;if(null==t)throw"Body is not available yet";return On.fromDom(t)},ar={body:or,getBody:ir,inBody:function(e){var t=$n.isText(e)?e.dom().parentNode:e.dom();return null!=t&&t.ownerDocument.body.contains(t)}},cr=function(e){return void 0!==e.style},sr=function(e,t,n){if(!S.isString(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);cr(e)&&e.style.setProperty(t,n)},lr=function(e,t){return cr(e)?e.style.getPropertyValue(t):""},ur=function(e,t){var n=e.dom(),r=lr(n,t);return T.from(r).filter((function(e){return e.length>0}))},dr=function(e,t){var n=e.dom();Qn.each(t,(function(e,t){sr(n,t,e)}))},fr=function(e,t){var n=e.dom(),r=window.getComputedStyle(n).getPropertyValue(t),o=""!==r||ar.inBody(e)?r:lr(n,t);return null===o?void 0:o},mr=ur,pr=function(e){return e.slice(0).sort()},gr={sort:pr,reqMessage:function(e,t){throw new Error("All required keys ("+pr(e).join(", ")+") were not specified. Specified keys were: "+pr(t).join(", ")+".")},unsuppMessage:function(e){throw new Error("Unsupported keys for object: "+pr(e).join(", "))},validateStrArr:function(e,t){if(!S.isArray(t))throw new Error("The "+e+" fields must be an array. Was: "+t+".");H.each(t,(function(t){if(!S.isString(t))throw new Error("The value "+t+" in the "+e+" fields was not a string.")}))},invalidTypeMessage:function(e,t){throw new Error("All values need to be of type: "+t+". Keys ("+pr(e).join(", ")+") were not.")},checkDupes:function(e){var t=pr(e);H.find(t,(function(e,n){return n<t.length-1&&e===t[n+1]})).each((function(e){throw new Error("The field: "+e+" occurs more than once in the combined fields: ["+t.join(", ")+"].")}))}},hr={immutable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(e.length!==t.length)throw new Error('Wrong number of arguments to struct. Expected "['+e.length+']", got '+t.length+" arguments");var r={};return H.each(e,(function(e,n){r[e]=b.constant(t[n])})),r}},immutableBag:function(e,t){var n=e.concat(t);if(0===n.length)throw new Error("You must specify at least one required or optional field.");return gr.validateStrArr("required",e),gr.validateStrArr("optional",t),gr.checkDupes(n),function(r){var o=Qn.keys(r);H.forall(e,(function(e){return H.contains(o,e)}))||gr.reqMessage(e,o);var i=H.filter(o,(function(e){return!H.contains(n,e)}));i.length>0&&gr.unsuppMessage(i);var a={};return H.each(e,(function(e){a[e]=b.constant(r[e])})),H.each(t,(function(e){a[e]=b.constant(Object.prototype.hasOwnProperty.call(r,e)?T.some(r[e]):T.none())})),a}}},vr=function(e,t){var n=[],r=function(e){return n.push(e),t(e)},o=t(e);do{o=o.bind(r)}while(o.isSome());return n},br=function(){return q.getOrDie("Node")},yr=function(e,t,n){return 0!=(e.compareDocumentPosition(t)&n)},Cr=function(e,t){return yr(e,t,br().DOCUMENT_POSITION_CONTAINED_BY)},wr=Fn,xr=Ln,kr=function(e){return e.nodeType!==wr&&e.nodeType!==xr||0===e.childElementCount},Tr={all:function(e,t){var n=void 0===t?document:t.dom();return kr(n)?[]:H.map(n.querySelectorAll(e),On.fromDom)},is:function(e,t){var n=e.dom();if(n.nodeType!==wr)return!1;if(void 0!==n.matches)return n.matches(t);if(void 0!==n.msMatchesSelector)return n.msMatchesSelector(t);if(void 0!==n.webkitMatchesSelector)return n.webkitMatchesSelector(t);if(void 0!==n.mozMatchesSelector)return n.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},one:function(e,t){var n=void 0===t?document:t.dom();return kr(n)?T.none():T.from(n.querySelector(e)).map(On.fromDom)}},Er=function(e,t){return e.dom()===t.dom()},Sr=Pn.detect().browser.isIE()?function(e,t){return Cr(e.dom(),t.dom())}:function(e,t){var n=e.dom(),r=t.dom();return n!==r&&n.contains(r)},Nr={eq:Er,isEqualNode:function(e,t){return e.dom().isEqualNode(t.dom())},member:function(e,t){return H.exists(t,b.curry(Er,e))},contains:Sr,is:Tr.is},Ar=function(e){return On.fromDom(e.dom().ownerDocument)},Rr=function(e){var t=e.dom();return T.from(t.parentNode).map(On.fromDom)},_r=function(e){var t=e.dom();return T.from(t.previousSibling).map(On.fromDom)},Ir=function(e){var t=e.dom();return T.from(t.nextSibling).map(On.fromDom)},Br=function(e){var t=e.dom();return H.map(t.childNodes,On.fromDom)},Pr=function(e,t){var n=e.dom().childNodes;return T.from(n[t]).map(On.fromDom)},Dr=hr.immutable("element","offset"),Or={owner:Ar,defaultView:function(e){var t=e.dom().ownerDocument.defaultView;return On.fromDom(t)},documentElement:function(e){var t=Ar(e);return On.fromDom(t.dom().documentElement)},parent:Rr,findIndex:function(e){return Rr(e).bind((function(t){var n=Br(t);return H.findIndex(n,(function(t){return Nr.eq(e,t)}))}))},parents:function(e,t){for(var n=S.isFunction(t)?t:b.constant(!1),r=e.dom(),o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,a=On.fromDom(i);if(o.push(a),!0===n(a))break;r=i}return o},siblings:function(e){return Rr(e).map(Br).map((function(t){return H.filter(t,(function(t){return!Nr.eq(e,t)}))})).getOr([])},prevSibling:_r,offsetParent:function(e){var t=e.dom();return T.from(t.offsetParent).map(On.fromDom)},prevSiblings:function(e){return H.reverse(vr(e,_r))},nextSibling:Ir,nextSiblings:function(e){return vr(e,Ir)},children:Br,child:Pr,firstChild:function(e){return Pr(e,0)},lastChild:function(e){return Pr(e,e.dom().childNodes.length-1)},childNodesCount:function(e){return e.dom().childNodes.length},hasChildNodes:function(e){return e.dom().hasChildNodes()},leaf:function(e,t){var n=Br(e);return n.length>0&&t<n.length?Dr(n[t],0):Dr(e,t)}},Mr=Pn.detect().browser,Lr=function(e){return H.find(e,$n.isElement)},Fr={getPos:function(e,t,n){var r,o,i=0,a=0,c=e.ownerDocument;if(n=n||e,t){if(n===e&&t.getBoundingClientRect&&"static"===fr(On.fromDom(e),"position"))return{x:i=(o=t.getBoundingClientRect()).left+(c.documentElement.scrollLeft||e.scrollLeft)-c.documentElement.clientLeft,y:a=o.top+(c.documentElement.scrollTop||e.scrollTop)-c.documentElement.clientTop};for(r=t;r&&r!==n&&r.nodeType;)i+=r.offsetLeft||0,a+=r.offsetTop||0,r=r.offsetParent;for(r=t.parentNode;r&&r!==n&&r.nodeType;)i-=r.scrollLeft||0,a-=r.scrollTop||0,r=r.parentNode;a+=function(e){return Mr.isFirefox()&&"table"===$n.name(e)?Lr(Or.children(e)).filter((function(e){return"caption"===$n.name(e)})).bind((function(e){return Lr(Or.nextSiblings(e)).map((function(t){var n=t.dom().offsetTop,r=e.dom().offsetTop,o=e.dom().offsetHeight;return n<=r?-o:0}))})).getOr(0):0}(On.fromDom(t))}return{x:i,y:a}}},jr=function(e){var t=T.none(),n=[],r=function(e){o()?a(e):n.push(e)},o=function(){return t.isSome()},i=function(e){H.each(e,a)},a=function(e){t.each((function(t){setTimeout((function(){e(t)}),0)}))};return e((function(e){t=T.some(e),i(n),n=[]})),{get:r,map:function(e){return jr((function(t){r((function(n){t(e(n))}))}))},isReady:o}},Hr={nu:jr,pure:function(e){return jr((function(t){t(e)}))}},Ur=function(e){return function(){var t=Array.prototype.slice.call(arguments),n=this;setTimeout((function(){e.apply(n,t)}),0)}},Wr=function(e){var t=function(t){e(Ur(t))};return{map:function(e){return Wr((function(n){t((function(t){var r=e(t);n(r)}))}))},bind:function(e){return Wr((function(n){t((function(t){e(t).get(n)}))}))},anonBind:function(e){return Wr((function(n){t((function(t){e.get(n)}))}))},toLazy:function(){return Hr.nu(t)},get:t}},zr={nu:Wr,pure:function(e){return Wr((function(t){t(e)}))}},qr=function(e,t){return t((function(t){var n=[],r=0;0===e.length?t([]):H.each(e,(function(o,i){o.get(function(o){return function(i){n[o]=i,++r>=e.length&&t(n)}}(i))}))}))},Vr=function(e){return qr(e,zr.nu)},$r={par:Vr,mapM:function(e,t){var n=H.map(e,t);return Vr(n)},compose:function(e,t){return function(n){return t(n).bind(e)}}},Kr=function(e){return{is:function(t){return e===t},isValue:b.always,isError:b.never,getOr:b.constant(e),getOrThunk:b.constant(e),getOrDie:b.constant(e),or:function(t){return Kr(e)},orThunk:function(t){return Kr(e)},fold:function(t,n){return n(e)},map:function(t){return Kr(t(e))},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOption:function(){return T.some(e)}}},Jr=function(e){return{is:b.never,isValue:b.never,isError:b.always,getOr:b.identity,getOrThunk:function(e){return e()},getOrDie:function(){return b.die(String(e))()},or:function(e){return e},orThunk:function(e){return e()},fold:function(t,n){return t(e)},map:function(t){return Jr(e)},each:b.noop,bind:function(t){return Jr(e)},exists:b.never,forall:b.always,toOption:T.none}},Gr={value:Kr,error:Jr};function Xr(e,t){var n=e,r=function(e,n,r,o){var i,a;if(e){if(!o&&e[n])return e[n];if(e!==t){if(i=e[r])return i;for(a=e.parentNode;a&&a!==t;a=a.parentNode)if(i=a[r])return i}}};this.current=function(){return n},this.next=function(e){return n=r(n,"firstChild","nextSibling",e)},this.prev=function(e){return n=r(n,"lastChild","previousSibling",e)},this.prev2=function(e){return n=function(e,n,r,o){var i,a,c;if(e){if(i=e[r],t&&i===t)return;if(i){if(!o)for(c=i[n];c;c=c[n])if(!c[n])return c;return i}if((a=e.parentNode)&&a!==t)return a}}(n,"lastChild","previousSibling",e)}}var Yr,Qr,Zr,eo=function(e){var t;return function(n){return(t=t||H.mapToObject(e,b.constant(!0))).hasOwnProperty($n.name(n))}},to=eo(["h1","h2","h3","h4","h5","h6"]),no=eo(["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"]),ro=function(e){return $n.isElement(e)&&!no(e)},oo=function(e){return $n.isElement(e)&&"br"===$n.name(e)},io=eo(["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"]),ao=eo(["ul","ol","dl"]),co=eo(["li","dd","dt"]),so=eo(["area","base","basefont","br","col","frame","hr","img","input","isindex","link","meta","param","embed","source","wbr","track"]),lo=eo(["thead","tbody","tfoot"]),uo=eo(["td","th"]),fo=function(e){return function(t){return!!t&&t.nodeType===e}},mo=fo(1),po=function(e){var t=e.toLowerCase().split(" ");return function(e){var n,r;if(e&&e.nodeType)for(r=e.nodeName.toLowerCase(),n=0;n<t.length;n++)if(r===t[n])return!0;return!1}},go=function(e){return function(t){if(mo(t)){if(t.contentEditable===e)return!0;if(t.getAttribute("data-mce-contenteditable")===e)return!0}return!1}},ho=fo(3),vo=fo(8),bo=fo(9),yo=po("br"),Co=go("true"),wo=go("false"),xo={isText:ho,isElement:mo,isComment:vo,isDocument:bo,isBr:yo,isContentEditableTrue:Co,isContentEditableFalse:wo,matchNodeNames:po,hasPropValue:function(e,t){return function(n){return mo(n)&&n[e]===t}},hasAttribute:function(e,t){return function(t){return mo(t)&&t.hasAttribute(e)}},hasAttributeValue:function(e,t){return function(n){return mo(n)&&n.getAttribute(e)===t}},matchStyleValues:function(e,t){var n=t.toLowerCase().split(" ");return function(t){var r;if(mo(t))for(r=0;r<n.length;r++){var o=t.ownerDocument.defaultView.getComputedStyle(t,null);if((o?o.getPropertyValue(e):null)===n[r])return!0}return!1}},isBogus:function(e){return mo(e)&&e.hasAttribute("data-mce-bogus")},isBogusAll:function(e){return mo(e)&&"all"===e.getAttribute("data-mce-bogus")},isTable:function(e){return mo(e)&&"TABLE"===e.tagName}},ko=function(e){return e&&"SPAN"===e.tagName&&"bookmark"===e.getAttribute("data-mce-type")},To=function(e,t){var n,r=t.childNodes;if(!xo.isElement(t)||!ko(t)){for(n=r.length-1;n>=0;n--)To(e,r[n]);if(!1===xo.isDocument(t)){if(xo.isText(t)&&t.nodeValue.length>0){var o=Ot.trim(t.nodeValue).length;if(e.isBlock(t.parentNode)||o>0)return;if(0===o&&function(e){var t=e.previousSibling&&"SPAN"===e.previousSibling.nodeName,n=e.nextSibling&&"SPAN"===e.nextSibling.nodeName;return t&&n}(t))return}else if(xo.isElement(t)&&(1===(r=t.childNodes).length&&ko(r[0])&&t.parentNode.insertBefore(r[0],t),r.length||so(On.fromDom(t))))return;e.remove(t)}return t}},Eo={trimNode:To},So=Ot.makeMap,No=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Ao=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Ro=/[<>&\"\']/g,_o=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,Io={128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"};Qr={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},Zr={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"};var Bo=function(e,t){var n,r,o,i={};if(e){for(e=e.split(","),t=t||10,n=0;n<e.length;n+=2)r=String.fromCharCode(parseInt(e[n],t)),Qr[r]||(o="&"+e[n+1]+";",i[r]=o,i[o]=r);return i}};Yr=Bo("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32);var Po=function(e,t){return e.replace(t?No:Ao,(function(e){return Qr[e]||e}))},Do=function(e,t){return e.replace(t?No:Ao,(function(e){return e.length>1?"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";":Qr[e]||"&#"+e.charCodeAt(0)+";"}))},Oo=function(e,t,n){return n=n||Yr,e.replace(t?No:Ao,(function(e){return Qr[e]||n[e]||e}))},Mo={encodeRaw:Po,encodeAllRaw:function(e){return(""+e).replace(Ro,(function(e){return Qr[e]||e}))},encodeNumeric:Do,encodeNamed:Oo,getEncodeFunc:function(e,t){var n=Bo(t)||Yr,r=So(e.replace(/\+/g,","));return r.named&&r.numeric?function(e,t){return e.replace(t?No:Ao,(function(e){return void 0!==Qr[e]?Qr[e]:void 0!==n[e]?n[e]:e.length>1?"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";":"&#"+e.charCodeAt(0)+";"}))}:r.named?t?function(e,t){return Oo(e,t,n)}:Oo:r.numeric?Do:Po},decode:function(e){return e.replace(_o,(function(e,t){return t?(t="x"===t.charAt(0).toLowerCase()?parseInt(t.substr(1),16):parseInt(t,10))>65535?(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t))):Io[t]||String.fromCharCode(t):Zr[e]||Yr[e]||function(e){var t;return(t=On.fromTag("div").dom()).innerHTML=e,t.textContent||t.innerText||e}(e)}))}},Lo={},Fo={},jo=Ot.makeMap,Ho=Ot.each,Uo=Ot.extend,Wo=Ot.explode,zo=Ot.inArray,qo=function(e,t){return(e=Ot.trim(e))?e.split(t||" "):[]},Vo=function(e){var t,n,r,o,i,a,c={},s=function(e,n,r){var o,i,a,s=function(e,t){var n,r,o={};for(n=0,r=e.length;n<r;n++)o[e[n]]=t||{};return o};for(n=n||"","string"==typeof(r=r||[])&&(r=qo(r)),o=(e=qo(e)).length;o--;)a={attributes:s(i=qo([t,n].join(" "))),attributesOrder:i,children:s(r,Fo)},c[e[o]]=a},l=function(e,t){var n,r,o,i;for(n=(e=qo(e)).length,t=qo(t);n--;)for(r=c[e[n]],o=0,i=t.length;o<i;o++)r.attributes[t[o]]={},r.attributesOrder.push(t[o])};return Lo[e]?Lo[e]:(t="id accesskey class dir lang style tabindex title role",n="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",r="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment","html4"!==e&&(t+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",n+=" article aside details dialog figure header footer hgroup section nav",r+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"),"html5-strict"!==e&&(t+=" xml:lang",r=[r,a="acronym applet basefont big font strike tt"].join(" "),Ho(qo(a),(function(e){s(e,"",r)})),n=[n,i="center dir isindex noframes"].join(" "),o=[n,r].join(" "),Ho(qo(i),(function(e){s(e,"",o)}))),o=o||[n,r].join(" "),s("html","manifest","head body"),s("head","","base command link meta noscript script style title"),s("title hr noscript br"),s("base","href target"),s("link","href rel media hreflang type sizes hreflang"),s("meta","name http-equiv content charset"),s("style","media type scoped"),s("script","src async defer type charset"),s("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",o),s("address dt dd div caption","",o),s("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",r),s("blockquote","cite",o),s("ol","reversed start type","li"),s("ul","","li"),s("li","value",o),s("dl","","dt dd"),s("a","href target rel media hreflang type",r),s("q","cite",r),s("ins del","cite datetime",o),s("img","src sizes srcset alt usemap ismap width height"),s("iframe","src name width height",o),s("embed","src type width height"),s("object","data type typemustmatch name usemap form width height",[o,"param"].join(" ")),s("param","name value"),s("map","name",[o,"area"].join(" ")),s("area","alt coords shape href target rel media hreflang type"),s("table","border","caption colgroup thead tfoot tbody tr"+("html4"===e?" col":"")),s("colgroup","span","col"),s("col","span"),s("tbody thead tfoot","","tr"),s("tr","","td th"),s("td","colspan rowspan headers",o),s("th","colspan rowspan headers scope abbr",o),s("form","accept-charset action autocomplete enctype method name novalidate target",o),s("fieldset","disabled form name",[o,"legend"].join(" ")),s("label","form for",r),s("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),s("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value","html4"===e?o:r),s("select","disabled form multiple name required size","option optgroup"),s("optgroup","disabled label","option"),s("option","disabled label selected value"),s("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),s("menu","type label",[o,"li"].join(" ")),s("noscript","",o),"html4"!==e&&(s("wbr"),s("ruby","",[r,"rt rp"].join(" ")),s("figcaption","",o),s("mark rt rp summary bdi","",r),s("canvas","width height",o),s("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[o,"track source"].join(" ")),s("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[o,"track source"].join(" ")),s("picture","","img source"),s("source","src srcset type media sizes"),s("track","kind src srclang label default"),s("datalist","",[r,"option"].join(" ")),s("article section nav aside header footer","",o),s("hgroup","","h1 h2 h3 h4 h5 h6"),s("figure","",[o,"figcaption"].join(" ")),s("time","datetime",r),s("dialog","open",o),s("command","type label icon disabled checked radiogroup command"),s("output","for form name",r),s("progress","value max",r),s("meter","value min max low high optimum",r),s("details","open",[o,"summary"].join(" ")),s("keygen","autofocus challenge disabled form keytype name")),"html5-strict"!==e&&(l("script","language xml:space"),l("style","xml:space"),l("object","declare classid code codebase codetype archive standby align border hspace vspace"),l("embed","align name hspace vspace"),l("param","valuetype type"),l("a","charset name rev shape coords"),l("br","clear"),l("applet","codebase archive code object alt name width height align hspace vspace"),l("img","name longdesc align border hspace vspace"),l("iframe","longdesc frameborder marginwidth marginheight scrolling align"),l("font basefont","size color face"),l("input","usemap align"),l("select","onchange"),l("textarea"),l("h1 h2 h3 h4 h5 h6 div p legend caption","align"),l("ul","type compact"),l("li","type"),l("ol dl menu dir","compact"),l("pre","width xml:space"),l("hr","align noshade size width"),l("isindex","prompt"),l("table","summary width frame rules cellspacing cellpadding align bgcolor"),l("col","width align char charoff valign"),l("colgroup","width align char charoff valign"),l("thead","align char charoff valign"),l("tr","align char charoff valign bgcolor"),l("th","axis align char charoff valign nowrap bgcolor width height"),l("form","accept"),l("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),l("tfoot","align char charoff valign"),l("tbody","align char charoff valign"),l("area","nohref"),l("body","background bgcolor text link vlink alink")),"html4"!==e&&(l("input button select textarea","autofocus"),l("input textarea","placeholder"),l("a","download"),l("link script img","crossorigin"),l("iframe","sandbox seamless allowfullscreen")),Ho(qo("a form meter progress dfn"),(function(e){c[e]&&delete c[e].children[e]})),delete c.caption.children.table,delete c.script,Lo[e]=c,c)},$o=function(e,t){var n;return e&&(n={},"string"==typeof e&&(e={"*":e}),Ho(e,(function(e,r){n[r]=n[r.toUpperCase()]="map"===t?jo(e,/[, ]/):Wo(e,/[, ]/)}))),n};function Ko(e){var t,n,r,o,i,a,c,s,l,u,d,f,m,p={},g={},h=[],v={},b={},y=function(t,n,r){var o=e[t];return o?o=jo(o,/[, ]/,jo(o.toUpperCase(),/[, ]/)):(o=Lo[t])||(o=jo(n," ",jo(n.toUpperCase()," ")),o=Uo(o,r),Lo[t]=o),o};r=Vo((e=e||{}).schema),!1===e.verify_html&&(e.valid_elements="*[*]"),t=$o(e.valid_styles),n=$o(e.invalid_styles,"map"),s=$o(e.valid_classes,"map"),o=y("whitespace_elements","pre script noscript style textarea video audio iframe object code"),i=y("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),a=y("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),c=y("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls"),u=y("non_empty_elements","td th iframe video audio object script pre code",a),d=y("move_caret_before_on_enter_elements","table",u),f=y("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside nav figure"),l=y("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",f),m=y("text_inline_elements","span strong b em i font strike u var cite dfn code mark q sup sub samp"),Ho((e.special||"script noscript noframes noembed title style textarea xmp").split(" "),(function(e){b[e]=new RegExp("</"+e+"[^>]*>","gi")}));var C=function(e){return new RegExp("^"+e.replace(/([?+*])/g,".$1")+"$")},w=function(e){var t,n,r,o,i,a,c,s,l,u,d,f,m,g,v,b,y,w,x,k=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)\])?$/,T=/^([!\-])?(\w+[\\:]:\w+|[^=:<]+)?(?:([=:<])(.*))?$/,E=/[*?+]/;if(e)for(e=qo(e,","),p["@"]&&(b=p["@"].attributes,y=p["@"].attributesOrder),t=0,n=e.length;t<n;t++)if(i=k.exec(e[t])){if(g=i[1],l=i[2],v=i[3],s=i[5],a={attributes:f={},attributesOrder:m=[]},"#"===g&&(a.paddEmpty=!0),"-"===g&&(a.removeEmpty=!0),"!"===i[4]&&(a.removeEmptyAttrs=!0),b){for(w in b)f[w]=b[w];m.push.apply(m,y)}if(s)for(r=0,o=(s=qo(s,"|")).length;r<o;r++)if(i=T.exec(s[r])){if(c={},d=i[1],u=i[2].replace(/[\\:]:/g,":"),g=i[3],x=i[4],"!"===d&&(a.attributesRequired=a.attributesRequired||[],a.attributesRequired.push(u),c.required=!0),"-"===d){delete f[u],m.splice(zo(m,u),1);continue}g&&("="===g&&(a.attributesDefault=a.attributesDefault||[],a.attributesDefault.push({name:u,value:x}),c.defaultValue=x),":"===g&&(a.attributesForced=a.attributesForced||[],a.attributesForced.push({name:u,value:x}),c.forcedValue=x),"<"===g&&(c.validValues=jo(x,"?"))),E.test(u)?(a.attributePatterns=a.attributePatterns||[],c.pattern=C(u),a.attributePatterns.push(c)):(f[u]||m.push(u),f[u]=c)}b||"@"!==l||(b=f,y=m),v&&(a.outputName=l,p[v]=a),E.test(l)?(a.pattern=C(l),h.push(a)):p[l]=a}},x=function(e){p={},h=[],w(e),Ho(r,(function(e,t){g[t]=e.children}))},k=function(e){var t=/^(~)?(.+)$/;e&&(Lo.text_block_elements=Lo.block_elements=null,Ho(qo(e,","),(function(e){var n=t.exec(e),r="~"===n[1],o=r?"span":"div",i=n[2];if(g[i]=g[o],v[i]=o,r||(l[i.toUpperCase()]={},l[i]={}),!p[i]){var a=p[o];delete(a=Uo({},a)).removeEmptyAttrs,delete a.removeEmpty,p[i]=a}Ho(g,(function(e,t){e[o]&&(g[t]=e=Uo({},g[t]),e[i]=e[o])}))})))},T=function(t){var n=/^([+\-]?)(\w+)\[([^\]]+)\]$/;Lo[e.schema]=null,t&&Ho(qo(t,","),(function(e){var t,r,o=n.exec(e);o&&(r=o[1],t=r?g[o[2]]:g[o[2]]={"#comment":{}},t=g[o[2]],Ho(qo(o[3],"|"),(function(e){"-"===r?delete t[e]:t[e]={}})))}))},E=function(e){var t,n=p[e];if(n)return n;for(t=h.length;t--;)if((n=h[t]).pattern.test(e))return n};return e.valid_elements?x(e.valid_elements):(Ho(r,(function(e,t){p[t]={attributes:e.attributes,attributesOrder:e.attributesOrder},g[t]=e.children})),"html5"!==e.schema&&Ho(qo("strong/b em/i"),(function(e){e=qo(e,"/"),p[e[1]].outputName=e[0]})),Ho(qo("ol ul sub sup blockquote span font a table tbody tr strong em b i"),(function(e){p[e]&&(p[e].removeEmpty=!0)})),Ho(qo("p h1 h2 h3 h4 h5 h6 th td pre div address caption li"),(function(e){p[e].paddEmpty=!0})),Ho(qo("span"),(function(e){p[e].removeEmptyAttrs=!0}))),k(e.custom_elements),T(e.valid_children),w(e.extended_valid_elements),T("+ol[ul|ol],+ul[ul|ol]"),Ho({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},(function(e,t){p[t]&&(p[t].parentsRequired=qo(e))})),e.invalid_elements&&Ho(Wo(e.invalid_elements),(function(e){p[e]&&delete p[e]})),E("span")||w("span[!data-mce-type|*]"),{children:g,elements:p,getValidStyles:function(){return t},getValidClasses:function(){return s},getBlockElements:function(){return l},getInvalidStyles:function(){return n},getShortEndedElements:function(){return a},getTextBlockElements:function(){return f},getTextInlineElements:function(){return m},getBoolAttrs:function(){return c},getElementRule:E,getSelfClosingElements:function(){return i},getNonEmptyElements:function(){return u},getMoveCaretBeforeOnEnterElements:function(){return d},getWhiteSpaceElements:function(){return o},getSpecialElements:function(){return b},isValidChild:function(e,t){var n=g[e.toLowerCase()];return!(!n||!n[t.toLowerCase()])},isValid:function(e,t){var n,r,o=E(e);if(o){if(!t)return!0;if(o.attributes[t])return!0;if(n=o.attributePatterns)for(r=n.length;r--;)if(n[r].pattern.test(e))return!0}return!1},getCustomElements:function(){return v},addValidElements:w,setValidElements:x,addCustomElements:k,addValidChildren:T}}var Jo=function(e,t,n,r){var o=function(e){return(e=parseInt(e,10).toString(16)).length>1?e:"0"+e};return"#"+o(t)+o(n)+o(r)};function Go(e,t){var n,r,o,i,a=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,c=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,s=/\s*([^:]+):\s*([^;]+);?/g,l=/\s+$/,u={};for(e=e||{},t&&(o=t.getValidStyles(),i=t.getInvalidStyles()),r="\\\" \\' \\; \\: ; : \ufeff".split(" "),n=0;n<r.length;n++)u[r[n]]="\ufeff"+n,u["\ufeff"+n]=r[n];return{toHex:function(e){return e.replace(a,Jo)},parse:function(t){var r,o,i,d,f,m,p,g,h={},v=e.url_converter,b=e.url_converter_scope||this,y=function(e,t,r){var o,i,a,c;if((o=h[e+"-top"+t])&&(i=h[e+"-right"+t])&&(a=h[e+"-bottom"+t])&&(c=h[e+"-left"+t])){var s=[o,i,a,c];for(n=s.length-1;n--&&s[n]===s[n+1];);n>-1&&r||(h[e+t]=-1===n?s[0]:s.join(" "),delete h[e+"-top"+t],delete h[e+"-right"+t],delete h[e+"-bottom"+t],delete h[e+"-left"+t])}},C=function(e){var t,n=h[e];if(n){for(t=(n=n.split(" ")).length;t--;)if(n[t]!==n[0])return!1;return h[e]=n[0],!0}},w=function(e){return d=!0,u[e]},x=function(e,t){return d&&(e=e.replace(/\uFEFF[0-9]/g,(function(e){return u[e]}))),t||(e=e.replace(/\\([\'\";:])/g,"$1")),e},k=function(e){return String.fromCharCode(parseInt(e.slice(1),16))},T=function(e){return e.replace(/\\[0-9a-f]+/gi,k)},E=function(t,n,r,o,i,a){if(i=i||a)return"'"+(i=x(i)).replace(/\'/g,"\\'")+"'";if(n=x(n||r||o),!e.allow_script_urls){var c=n.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(c))return"";if(!e.allow_svg_data_urls&&/^data:image\/svg/i.test(c))return""}return v&&(n=v.call(b,n,"style")),"url('"+n.replace(/\'/g,"\\'")+"')"};if(t){for(t=(t=t.replace(/[\u0000-\u001F]/g,"")).replace(/\\[\"\';:\uFEFF]/g,w).replace(/\"[^\"]+\"|\'[^\']+\'/g,(function(e){return e.replace(/[;:]/g,w)}));r=s.exec(t);)if(s.lastIndex=r.index+r[0].length,o=r[1].replace(l,"").toLowerCase(),i=r[2].replace(l,""),o&&i){if(o=T(o),i=T(i),-1!==o.indexOf("\ufeff")||-1!==o.indexOf('"'))continue;if(!e.allow_script_urls&&("behavior"===o||/expression\s*\(|\/\*|\*\//.test(i)))continue;"font-weight"===o&&"700"===i?i="bold":"color"!==o&&"background-color"!==o||(i=i.toLowerCase()),i=(i=i.replace(a,Jo)).replace(c,E),h[o]=d?x(i,!0):i}y("border","",!0),y("border","-width"),y("border","-color"),y("border","-style"),y("padding",""),y("margin",""),f="border",p="border-style",g="border-color",C(m="border-width")&&C(p)&&C(g)&&(h[f]=h[m]+" "+h[p]+" "+h[g],delete h[m],delete h[p],delete h[g]),"medium none"===h.border&&delete h.border,"none"===h["border-image"]&&delete h["border-image"]}return h},serialize:function(e,t){var n,r,a="",c=function(t){var n,r,i,c;if(n=o[t])for(r=0,i=n.length;r<i;r++)t=n[r],(c=e[t])&&(a+=(a.length>0?" ":"")+t+": "+c+";")},s=function(e,t){var n;return!((n=i["*"])&&n[e]||(n=i[t])&&n[e])};if(t&&o)c("*"),c(t);else for(n in e)!(r=e[n])||i&&!s(n,t)||(a+=(a.length>0?" ":"")+n+": "+r+";");return a}}}var Xo=Ot.each,Yo=Ot.grep,Qo=ge.ie,Zo=/^([a-z0-9],?)+$/i,ei=/^[ \t\r\n]*$/,ti=function(e,t,n){var r={},o=t.keep_values,i={set:function(e,r,o){t.url_converter&&(r=t.url_converter.call(t.url_converter_scope||n(),r,o,e[0])),e.attr("data-mce-"+o,r).attr(o,r)},get:function(e,t){return e.attr("data-mce-"+t)||e.attr(t)}};return r={style:{set:function(e,t){null===t||"object"!=typeof t?(o&&e.attr("data-mce-style",t),e.attr("style",t)):e.css(t)},get:function(t){var n=t.attr("data-mce-style")||t.attr("style");return n=e.serialize(e.parse(n),t[0].nodeName)}}},o&&(r.href=r.src=i),r},ni=function(e,t){var n=t.attr("style"),r=e.serialize(e.parse(n),t[0].nodeName);r||(r=null),t.attr("data-mce-style",r)},ri=function(e,t){var n,r,o=0;if(e)for(n=e.nodeType,e=e.previousSibling;e;e=e.previousSibling)r=e.nodeType,(!t||3!==r||r!==n&&e.nodeValue.length)&&(o++,n=r);return o};function oi(e,t){var n,r=this;void 0===t&&(t={});var o={},i=window,a={},c=0,s=function(e,t){var n,r=0,o={};n=(t=t||{}).maxLoadTime||5e3;var i=function(t){e.getElementsByTagName("head")[0].appendChild(t)},a=function(t,a,c){var s,l,u,d,f=function(){for(var e=d.passed,t=e.length;t--;)e[t]();d.status=2,d.passed=[],d.failed=[]},m=function(){for(var e=d.failed,t=e.length;t--;)e[t]();d.status=3,d.passed=[],d.failed=[]},p=function(e,t){e()||((new Date).getTime()-u<n?Ce.setTimeout(t):m())},g=function(){p((function(){for(var t,n,r=e.styleSheets,o=r.length;o--;)if((n=(t=r[o]).ownerNode?t.ownerNode:t.owningElement)&&n.id===s.id)return f(),!0}),g)},h=function(){p((function(){try{var e=l.sheet.cssRules;return f(),!!e}catch(e){}}),h)};if(t=Ot._addCacheSuffix(t),o[t]?d=o[t]:(d={passed:[],failed:[]},o[t]=d),a&&d.passed.push(a),c&&d.failed.push(c),1!==d.status)if(2!==d.status)if(3!==d.status){if(d.status=1,(s=e.createElement("link")).rel="stylesheet",s.type="text/css",s.id="u"+r++,s.async=!1,s.defer=!1,u=(new Date).getTime(),"onload"in s&&!((v=navigator.userAgent.match(/WebKit\/(\d*)/))&&parseInt(v[1],10)<536))s.onload=g,s.onerror=m;else{if(navigator.userAgent.indexOf("Firefox")>0)return(l=e.createElement("style")).textContent='@import "'+t+'"',h(),void i(l);g()}var v;i(s),s.href=t}else m();else f()},c=function(e){return zr.nu((function(t){a(e,b.compose(t,b.constant(Gr.value(e))),b.compose(t,b.constant(Gr.error(e))))}))},s=function(e){return e.fold(b.identity,b.identity)};return{load:a,loadAll:function(e,t,n){$r.par(H.map(e,c)).get((function(e){var r=H.partition(e,(function(e){return e.isValue()}));r.fail.length>0?n(r.fail.map(s)):t(r.pass.map(s))}))}}}(e),l=[],u=t.schema?t.schema:Ko({}),d=Go({url_converter:t.url_converter,url_converter_scope:t.url_converter_scope},t.schema),f=t.ownEvents?new Re(t.proxy):Re.Event,m=u.getBlockElements(),p=en.overrideDefaults((function(){return{context:e,element:z.getRoot()}})),g=function(t){if(t&&e&&"string"==typeof t){var n=e.getElementById(t);return n&&n.id!==t?e.getElementsByName(t)[1]:n}return t},h=function(e){return"string"==typeof e&&(e=g(e)),p(e)},v=function(e,t,r){var o,i,a=h(e);return a.length&&(i=(o=n[t])&&o.get?o.get(a,t):a.attr(t)),void 0===i&&(i=r||""),i},y=function(e){var t=g(e);return t?t.attributes:[]},C=function(e,r,o){var i,a;""===o&&(o=null);var c=h(e);i=c.attr(r),c.length&&((a=n[r])&&a.set?a.set(c,o,r):c.attr(r,o),i!==o&&t.onSetAttrib&&t.onSetAttrib({attrElm:c,attrName:r,attrValue:o}))},w=function(){return t.root_element||e.body},x=function(t,n){return Fr.getPos(e.body,g(t),n)},k=function(e,t,n){var r=h(e);return n?r.css(t):("float"===(t=t.replace(/-(\D)/g,(function(e,t){return t.toUpperCase()})))&&(t=ge.ie&&ge.ie<12?"styleFloat":"cssFloat"),r[0]&&r[0].style?r[0].style[t]:void 0)},T=function(e){var t,n;return e=g(e),t=k(e,"width"),n=k(e,"height"),-1===t.indexOf("px")&&(t=0),-1===n.indexOf("px")&&(n=0),{w:parseInt(t,10)||e.offsetWidth||e.clientWidth,h:parseInt(n,10)||e.offsetHeight||e.clientHeight}},E=function(e,t){var n;if(!e)return!1;if(!Array.isArray(e)){if("*"===t)return 1===e.nodeType;if(Zo.test(t)){var r=t.toLowerCase().split(/,/),o=e.nodeName.toLowerCase();for(n=r.length-1;n>=0;n--)if(r[n]===o)return!0;return!1}if(e.nodeType&&1!==e.nodeType)return!1}var i=Array.isArray(e)?e:[e];return ft(t,i[0].ownerDocument||i[0],null,i).length>0},S=function(e,t,n,r){var o,i=[],a=g(e);for(r=void 0===r,n=n||("BODY"!==w().nodeName?w().parentNode:null),Ot.is(t,"string")&&(o=t,t="*"===t?function(e){return 1===e.nodeType}:function(e){return E(e,o)});a&&a!==n&&a.nodeType&&9!==a.nodeType;){if(!t||"function"==typeof t&&t(a)){if(!r)return[a];i.push(a)}a=a.parentNode}return r?i:null},N=function(e,t,n){var r=t;if(e)for("string"==typeof t&&(r=function(e){return E(e,t)}),e=e[n];e;e=e[n])if("function"==typeof r&&r(e))return e;return null},A=function(e,t,n){var o,i="string"==typeof e?g(e):e;if(!i)return!1;if(Ot.isArray(i)&&(i.length||0===i.length))return o=[],Xo(i,(function(e,r){e&&("string"==typeof e&&(e=g(e)),o.push(t.call(n,e,r)))})),o;var a=n||r;return t.call(a,i)},R=function(e,t){h(e).each((function(e,n){Xo(t,(function(e,t){C(n,t,e)}))}))},_=function(e,t){var n=h(e);Qo?n.each((function(e,n){if(!1!==n.canHaveHTML){for(;n.firstChild;)n.removeChild(n.firstChild);try{n.innerHTML="<br>"+t,n.removeChild(n.firstChild)}catch(e){en("<div></div>").html("<br>"+t).contents().slice(1).appendTo(n)}return t}})):n.html(t)},I=function(t,n,r,o,i){return A(t,(function(t){var a="string"==typeof n?e.createElement(n):n;return R(a,r),o&&("string"!=typeof o&&o.nodeType?a.appendChild(o):"string"==typeof o&&_(a,o)),i?a:t.appendChild(a)}))},B=function(t,n,r){return I(e.createElement(t),t,n,r,!0)},P=Mo.decode,D=Mo.encodeAllRaw,O=function(e,t){var n=h(e);return t?n.each((function(){for(var e;e=this.firstChild;)3===e.nodeType&&0===e.data.length?this.removeChild(e):this.parentNode.insertBefore(e,this)})).remove():n.remove(),n.length>1?n.toArray():n[0]},M=function(e,t,n){h(e).toggleClass(t,n).each((function(){""===this.className&&en(this).attr("class",null)}))},L=function(e,t,n){return A(t,(function(t){return Ot.is(t,"array")&&(e=e.cloneNode(!0)),n&&Xo(Yo(t.childNodes),(function(t){e.appendChild(t)})),t.parentNode.replaceChild(e,t)}))},F=function(){return e.createRange()},j=function(n,r,o,a){if(Ot.isArray(n)){for(var c=n.length;c--;)n[c]=j(n[c],r,o,a);return n}return!t.collect||n!==e&&n!==i||l.push([n,r,o,a]),f.bind(n,r,o,a||z)},U=function(t,n,r){var o;if(Ot.isArray(t)){for(o=t.length;o--;)t[o]=U(t[o],n,r);return t}if(l&&(t===e||t===i))for(o=l.length;o--;){var a=l[o];t!==a[0]||n&&n!==a[1]||r&&r!==a[2]||f.unbind(a[0],a[1],a[2])}return f.unbind(t,n,r)},W=function(e){if(e&&xo.isElement(e)){var t=e.getAttribute("data-mce-contenteditable");return t&&"inherit"!==t?t:"inherit"!==e.contentEditable?e.contentEditable:null}return null},z={doc:e,settings:t,win:i,files:a,stdMode:!0,boxModel:!0,styleSheetLoader:s,boundEvents:l,styles:d,schema:u,events:f,isBlock:function(e){if("string"==typeof e)return!!m[e];if(e){var t=e.nodeType;if(t)return!(1!==t||!m[e.nodeName])}return!1},$:p,$$:h,root:null,clone:function(t,n){if(!Qo||1!==t.nodeType||n)return t.cloneNode(n);if(!n){var r=e.createElement(t.nodeName);return Xo(y(t),(function(e){C(r,e.nodeName,v(t,e.nodeName))})),r}return null},getRoot:w,getViewPort:function(e){var t=e||i,n=t.document,r=n.documentElement;return{x:t.pageXOffset||r.scrollLeft,y:t.pageYOffset||r.scrollTop,w:t.innerWidth||r.clientWidth,h:t.innerHeight||r.clientHeight}},getRect:function(e){var t,n;return e=g(e),t=x(e),n=T(e),{x:t.x,y:t.y,w:n.w,h:n.h}},getSize:T,getParent:function(e,t,n){var r=S(e,t,n,!1);return r&&r.length>0?r[0]:null},getParents:S,get:g,getNext:function(e,t){return N(e,t,"nextSibling")},getPrev:function(e,t){return N(e,t,"previousSibling")},select:function(n,r){return ft(n,g(r)||t.root_element||e,[])},is:E,add:I,create:B,createHTML:function(e,t,n){var r,o="";for(r in o+="<"+e,t)t.hasOwnProperty(r)&&null!==t[r]&&void 0!==t[r]&&(o+=" "+r+'="'+D(t[r])+'"');return void 0!==n?o+">"+n+"</"+e+">":o+" />"},createFragment:function(t){var n,r=e.createElement("div"),o=e.createDocumentFragment();for(t&&(r.innerHTML=t);n=r.firstChild;)o.appendChild(n);return o},remove:O,setStyle:function(e,n,r){var o=h(e).css(n,r);t.update_styles&&ni(d,o)},getStyle:k,setStyles:function(e,n){var r=h(e).css(n);t.update_styles&&ni(d,r)},removeAllAttribs:function(e){return A(e,(function(e){var t,n=e.attributes;for(t=n.length-1;t>=0;t--)e.removeAttributeNode(n.item(t))}))},setAttrib:C,setAttribs:R,getAttrib:v,getPos:x,parseStyle:function(e){return d.parse(e)},serializeStyle:function(e,t){return d.serialize(e,t)},addStyle:function(t){var n,r;if(z!==oi.DOM&&e===document){if(o[t])return;o[t]=!0}(r=e.getElementById("mceDefaultStyles"))||((r=e.createElement("style")).id="mceDefaultStyles",r.type="text/css",(n=e.getElementsByTagName("head")[0]).firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r)),r.styleSheet?r.styleSheet.cssText+=t:r.appendChild(e.createTextNode(t))},loadCSS:function(t){var n;z===oi.DOM||e!==document?(t||(t=""),n=e.getElementsByTagName("head")[0],Xo(t.split(","),(function(e){var t;e=Ot._addCacheSuffix(e),a[e]||(a[e]=!0,t=B("link",{rel:"stylesheet",href:e}),n.appendChild(t))}))):oi.DOM.loadCSS(t)},addClass:function(e,t){h(e).addClass(t)},removeClass:function(e,t){M(e,t,!1)},hasClass:function(e,t){return h(e).hasClass(t)},toggleClass:M,show:function(e){h(e).show()},hide:function(e){h(e).hide()},isHidden:function(e){return"none"===h(e).css("display")},uniqueId:function(e){return(e||"mce_")+c++},setHTML:_,getOuterHTML:function(e){var t="string"==typeof e?g(e):e;return xo.isElement(t)?t.outerHTML:en("<div></div>").append(en(t).clone()).html()},setOuterHTML:function(e,t){h(e).each((function(){try{if("outerHTML"in this)return void(this.outerHTML=t)}catch(e){}O(en(this).html(t),!0)}))},decode:P,encode:D,insertAfter:function(e,t){var n=g(t);return A(e,(function(e){var t,r;return t=n.parentNode,(r=n.nextSibling)?t.insertBefore(e,r):t.appendChild(e),e}))},replace:L,rename:function(e,t){var n;return e.nodeName!==t.toUpperCase()&&(n=B(t),Xo(y(e),(function(t){C(n,t.nodeName,v(e,t.nodeName))})),L(n,e,!0)),n||e},findCommonAncestor:function(e,t){for(var n,r=e;r;){for(n=t;n&&r!==n;)n=n.parentNode;if(r===n)break;r=r.parentNode}return!r&&e.ownerDocument?e.ownerDocument.documentElement:r},toHex:function(e){return d.toHex(Ot.trim(e))},run:A,getAttribs:y,isEmpty:function(e,t){var n,r,o,i,a,c,s=0;if(e=e.firstChild){a=new Xr(e,e.parentNode),t=t||(u?u.getNonEmptyElements():null),i=u?u.getWhiteSpaceElements():{};do{if(o=e.nodeType,xo.isElement(e)){var l=e.getAttribute("data-mce-bogus");if(l){e=a.next("all"===l);continue}if(c=e.nodeName.toLowerCase(),t&&t[c]){if("br"===c){s++,e=a.next();continue}return!1}for(n=(r=y(e)).length;n--;)if("name"===(c=r[n].nodeName)||"data-mce-bookmark"===c)return!1}if(8===o)return!1;if(3===o&&!ei.test(e.nodeValue))return!1;if(3===o&&e.parentNode&&i[e.parentNode.nodeName]&&ei.test(e.nodeValue))return!1;e=a.next()}while(e)}return s<=1},createRng:F,nodeIndex:ri,split:function(e,t,n){var r,o,i,a=F();if(e&&t)return a.setStart(e.parentNode,ri(e)),a.setEnd(t.parentNode,ri(t)),r=a.extractContents(),(a=F()).setStart(t.parentNode,ri(t)+1),a.setEnd(e.parentNode,ri(e)+1),o=a.extractContents(),(i=e.parentNode).insertBefore(Eo.trimNode(z,r),e),n?i.insertBefore(n,e):i.insertBefore(t,e),i.insertBefore(Eo.trimNode(z,o),e),O(e),n||t},bind:j,unbind:U,fire:function(e,t,n){return f.fire(e,t,n)},getContentEditable:W,getContentEditableParent:function(e){for(var t=w(),n=null;e&&e!==t&&null===(n=W(e));e=e.parentNode);return n},destroy:function(){if(l)for(var e=l.length;e--;){var t=l[e];f.unbind(t[0],t[1],t[2])}ft.setDocument&&ft.setDocument()},isChildOf:function(e,t){for(;e;){if(t===e)return!0;e=e.parentNode}return!1},dumpRng:function(e){return"startContainer: "+e.startContainer.nodeName+", startOffset: "+e.startOffset+", endContainer: "+e.endContainer.nodeName+", endOffset: "+e.endOffset}};return n=ti(d,t,(function(){return z})),z}!function(e){e.DOM=e(document),e.nodeIndex=ri}(oi||(oi={}));var ii=oi,ai=ii.DOM,ci=Ot.each,si=Ot.grep,li=function(e){return"function"==typeof e},ui=function(){var e={},t=[],n={},r=[],o=0;this.isDone=function(t){return 2===e[t]},this.markDone=function(t){e[t]=2},this.add=this.load=function(r,o,i,a){void 0===e[r]&&(t.push(r),e[r]=0),o&&(n[r]||(n[r]=[]),n[r].push({success:o,failure:a,scope:i||this}))},this.remove=function(t){delete e[t],delete n[t]},this.loadQueue=function(e,n,r){this.loadScripts(t,e,n,r)},this.loadScripts=function(t,i,a,c){var s,l=[],u=function(e,t){ci(n[t],(function(t){li(t[e])&&t[e].call(t.scope)})),n[t]=void 0};r.push({success:i,failure:c,scope:a||this}),(s=function(){var n=si(t);if(t.length=0,ci(n,(function(t){2!==e[t]?3!==e[t]?1!==e[t]&&(e[t]=1,o++,function(e,t,n){var r,o,i=ai,a=function(){i.remove(o),r&&(r.onreadystatechange=r.onload=r=null),t()};o=i.uniqueId(),(r=document.createElement("script")).id=o,r.type="text/javascript",r.src=Ot._addCacheSuffix(e),"onreadystatechange"in r?r.onreadystatechange=function(){/loaded|complete/.test(r.readyState)&&a()}:r.onload=a,r.onerror=function(){li(n)?n():"undefined"!=typeof console&&console.log&&console.log("Failed to load script: "+e)},(document.getElementsByTagName("head")[0]||document.body).appendChild(r)}(t,(function(){e[t]=2,o--,u("success",t),s()}),(function(){e[t]=3,o--,l.push(t),u("failure",t),s()}))):u("failure",t):u("success",t)})),!o){var i=r.slice(0);r.length=0,ci(i,(function(e){0===l.length?li(e.success)&&e.success.call(e.scope):li(e.failure)&&e.failure.call(e.scope,l)}))}})()}};ui.ScriptLoader=new ui;var di=Ot.each;function fi(){var e=this,t=[],n={},r={},o=[],i=function(e){var t;return r[e]&&(t=r[e].dependencies),t||[]},a=function(e,t){return"object"==typeof t?t:"string"==typeof e?{prefix:"",resource:t,suffix:""}:{prefix:e.prefix,resource:t,suffix:e.suffix}},c=function(e,t,n){var r=i(name);di(r,(function(t){var n=a(e,t);s(n.resource,n,void 0,void 0)})),t&&(n?t.call(n):t.call(ui))},s=function(e,t,o,i,a){if(!n[e]){var s="string"==typeof t?t:t.prefix+t.resource+t.suffix;0!==s.indexOf("/")&&-1===s.indexOf("://")&&(s=fi.baseURL+"/"+s),n[e]=s.substring(0,s.lastIndexOf("/")),r[e]?c(t,o,i):ui.ScriptLoader.add(s,(function(){return c(t,o,i)}),i,a)}};return{items:t,urls:n,lookup:r,_listeners:o,get:function(e){if(r[e])return r[e].instance},dependencies:i,requireLangPack:function(e,t){var r=fi.language;if(r&&!1!==fi.languageLoad){if(t)if(-1!==(t=","+t+",").indexOf(","+r.substr(0,2)+","))r=r.substr(0,2);else if(-1===t.indexOf(","+r+","))return;ui.ScriptLoader.add(n[e]+"/langs/"+r+".js")}},add:function(e,n,i){t.push(n),r[e]={instance:n,dependencies:i};var a=H.partition(o,(function(t){return t.name===e}));return o=a.fail,di(a.pass,(function(e){e.callback()})),n},remove:function(e){delete n[e],delete r[e]},createUrl:a,addComponents:function(t,n){var r=e.urls[t];di(n,(function(e){ui.ScriptLoader.add(r+"/"+e)}))},load:s,waitFor:function(e,t){r.hasOwnProperty(e)?t():o.push({name:e,callback:t})}}}!function(e){e.PluginManager=e(),e.ThemeManager=e()}(fi||(fi={}));var mi=function(e){return"\ufeff"===e},pi="\ufeff",gi=function(e){return e.replace(new RegExp("\ufeff","g"),"")},hi=xo.isElement,vi=xo.isText,bi=function(e){return vi(e)&&(e=e.parentNode),hi(e)&&e.hasAttribute("data-mce-caret")},yi=function(e){return vi(e)&&mi(e.data)},Ci=function(e){return bi(e)||yi(e)},wi=function(e){return e.firstChild!==e.lastChild||!xo.isBr(e.firstChild)},xi=function(e){var t=e.container();return e&&xo.isText(t)&&t.data.charAt(e.offset())===pi},ki=function(e){var t=e.container();return e&&xo.isText(t)&&t.data.charAt(e.offset()-1)===pi},Ti=function(e,t,n){var r,o,i;return(r=t.ownerDocument.createElement(e)).setAttribute("data-mce-caret",n?"before":"after"),r.setAttribute("data-mce-bogus","all"),r.appendChild(((i=document.createElement("br")).setAttribute("data-mce-bogus","1"),i)),o=t.parentNode,n?o.insertBefore(r,t):t.nextSibling?o.insertBefore(r,t.nextSibling):o.appendChild(r),r},Ei=function(e){return vi(e)&&e.data[0]===pi},Si=function(e){return vi(e)&&e.data[e.data.length-1]===pi},Ni=function(e){return e&&e.hasAttribute("data-mce-caret")?(t=e.getElementsByTagName("br"),n=t[t.length-1],xo.isBogus(n)&&n.parentNode.removeChild(n),e.removeAttribute("data-mce-caret"),e.removeAttribute("data-mce-bogus"),e.removeAttribute("style"),e.removeAttribute("_moz_abspos"),e):null;var t,n},Ai=xo.isContentEditableTrue,Ri=xo.isContentEditableFalse,_i=xo.isBr,Ii=xo.isText,Bi=xo.matchNodeNames("script style textarea"),Pi=xo.matchNodeNames("img input textarea hr iframe video audio object"),Di=xo.matchNodeNames("table"),Oi=Ci,Mi=function(e){return!Oi(e)&&(Ii(e)?!Bi(e.parentNode):Pi(e)||_i(e)||Di(e)||Li(e))},Li=function(e){return!1===function(e){return xo.isElement(e)&&"true"===e.getAttribute("unselectable")}(e)&&Ri(e)},Fi=function(e,t){return Mi(e)&&function(e,t){for(e=e.parentNode;e&&e!==t;e=e.parentNode){if(Li(e))return!1;if(Ai(e))return!0}return!0}(e,t)},ji=Math.round,Hi=function(e){return e?{left:ji(e.left),top:ji(e.top),bottom:ji(e.bottom),right:ji(e.right),width:ji(e.width),height:ji(e.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0}},Ui=function(e,t){return e=Hi(e),t?e.right=e.left:(e.left=e.left+e.width,e.right=e.left),e.width=0,e},Wi=function(e,t,n){return e>=0&&e<=Math.min(t.height,n.height)/2},zi=function(e,t){return e.bottom-e.height/2<t.top||!(e.top>t.bottom)&&Wi(t.top-e.bottom,e,t)},qi=function(e,t){return e.top>t.bottom||!(e.bottom<t.top)&&Wi(t.bottom-e.top,e,t)},Vi=function(e,t){return t.left>e.left&&t.right<e.right?0:t.left<e.left?t.left-e.left:t.right-e.right},$i=function(e,t){return t.top>e.top&&t.bottom<e.bottom?0:t.top<e.top?t.top-e.top:t.bottom-e.bottom},Ki=function(e){var t=e.startContainer,n=e.startOffset;return t.hasChildNodes()&&e.endOffset===n+1?t.childNodes[n]:null},Ji=function(e,t){return 1===e.nodeType&&e.hasChildNodes()&&(t>=e.childNodes.length&&(t=e.childNodes.length-1),e=e.childNodes[t]),e},Gi=new RegExp("[̀-ͯ҃-҇҈-҉֑-ֽֿׁ-ׂׄ-ׇׅؐ-ًؚ-ٰٟۖ-ۜ۟-ۤۧ-۪ۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣣ-ंऺ़ु-ै्॑-ॗॢ-ॣঁ়াু-ৄ্ৗৢ-ৣਁ-ਂ਼ੁ-ੂੇ-ੈੋ-੍ੑੰ-ੱੵઁ-ં઼ુ-ૅે-ૈ્ૢ-ૣଁ଼ାିୁ-ୄ୍ୖୗୢ-ୣஂாீ்ௗఀా-ీె-ైొ-్ౕ-ౖౢ-ౣಁ಼ಿೂೆೌ-್ೕ-ೖೢ-ೣഁാു-ൄ്ൗൢ-ൣ්ාි-ුූෟัิ-ฺ็-๎ັິ-ູົ-ຼ່-ໍ༘-ཱ༹༙༵༷-ཾྀ-྄྆-྇ྍ-ྗྙ-ྼ࿆ိ-ူဲ-့္-်ွ-ှၘ-ၙၞ-ၠၱ-ၴႂႅ-ႆႍႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒ-ᝓᝲ-ᝳ឴-឵ិ-ួំ៉-៓៝᠋-᠍ᢩᤠ-ᤢᤧ-ᤨᤲ᤹-᤻ᨗ-ᨘᨛᩖᩘ-ᩞ᩠ᩢᩥ-ᩬᩳ-᩿᩼᪰-᪽᪾ᬀ-ᬃ᬴ᬶ-ᬺᬼᭂ᭫-᭳ᮀ-ᮁᮢ-ᮥᮨ-ᮩ᮫-ᮭ᯦ᯨ-ᯩᯭᯯ-ᯱᰬ-ᰳᰶ-᰷᳐-᳔᳒-᳢᳠-᳨᳭᳴᳸-᳹᷀-᷵᷼-᷿‌-‍⃐-⃜⃝-⃠⃡⃢-⃤⃥-⃰⳯-⵿⳱ⷠ-〪ⷿ-〭〮-゙〯-゚꙯꙰-꙲ꙴ-꙽ꚞ-ꚟ꛰-꛱ꠂ꠆ꠋꠥ-ꠦ꣄꣠-꣱ꤦ-꤭ꥇ-ꥑꦀ-ꦂ꦳ꦶ-ꦹꦼꧥꨩ-ꨮꨱ-ꨲꨵ-ꨶꩃꩌꩼꪰꪲ-ꪴꪷ-ꪸꪾ-꪿꫁ꫬ-ꫭ꫶ꯥꯨ꯭ﬞ︀-️︠-︯ﾞ-ﾟ]"),Xi=function(e){return"string"==typeof e&&e.charCodeAt(0)>=768&&Gi.test(e)},Yi=[].slice,Qi=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=Yi.call(arguments);return r.length-1>=e.length?e.apply(this,r.slice(1)):function(){var e=r.concat([].slice.call(arguments));return Qi.apply(this,e)}},Zi={constant:function(e){return function(){return e}},negate:function(e){return function(t){return!e(t)}},and:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Yi.call(arguments);return function(e){for(var t=0;t<n.length;t++)if(!n[t](e))return!1;return!0}},or:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Yi.call(arguments);return function(e){for(var t=0;t<n.length;t++)if(n[t](e))return!0;return!1}},curry:Qi,compose:function(e,t){return function(n){return e(t(n))}},noop:function(){}},ea=function(e,t){for(var n=[],r=0;r<e.length;r++){var o=e[r];if(!o.isSome())return T.none();n.push(o.getOrDie())}return T.some(t.apply(null,n))},ta=xo.isElement,na=Mi,ra=xo.matchStyleValues("display","block table"),oa=xo.matchStyleValues("float","left right"),ia=Zi.and(ta,na,Zi.negate(oa)),aa=Zi.negate(xo.matchStyleValues("white-space","pre pre-line pre-wrap")),ca=xo.isText,sa=xo.isBr,la=ii.nodeIndex,ua=Ji,da=function(e){return"createRange"in e?e.createRange():ii.DOM.createRng()},fa=function(e){return e&&/[\r\n\t ]/.test(e)},ma=function(e){return!!e.setStart&&!!e.setEnd},pa=function(e){var t,n=e.startContainer,r=e.startOffset;return!!(fa(e.toString())&&aa(n.parentNode)&&xo.isText(n)&&(t=n.data,fa(t[r-1])||fa(t[r+1])))},ga=function(e){return 0===e.left&&0===e.right&&0===e.top&&0===e.bottom},ha=function(e){var t,n;return t=(n=e.getClientRects()).length>0?Hi(n[0]):Hi(e.getBoundingClientRect()),!ma(e)&&sa(e)&&ga(t)?function(e){var t,n=e.ownerDocument,r=da(n),o=n.createTextNode(" "),i=e.parentNode;return i.insertBefore(o,e),r.setStart(o,0),r.setEnd(o,1),t=Hi(r.getBoundingClientRect()),i.removeChild(o),t}(e):ga(t)&&ma(e)?function(e){var t=e.startContainer,n=e.endContainer,r=e.startOffset,o=e.endOffset;if(t===n&&xo.isText(n)&&0===r&&1===o){var i=e.cloneRange();return i.setEndAfter(n),ha(i)}return null}(e):t},va=function(e,t){var n=Ui(e,t);return n.width=1,n.right=n.left+1,n},ba=function(e){var t,n,r=[],o=function(e){var t,n;0!==e.height&&(r.length>0&&(t=e,n=r[r.length-1],t.left===n.left&&t.top===n.top&&t.bottom===n.bottom&&t.right===n.right)||r.push(e))},i=function(e,t){var n=da(e.ownerDocument);if(t<e.data.length){if(Xi(e.data[t]))return r;if(Xi(e.data[t-1])&&(n.setStart(e,t),n.setEnd(e,t+1),!pa(n)))return o(va(ha(n),!1)),r}t>0&&(n.setStart(e,t-1),n.setEnd(e,t),pa(n)||o(va(ha(n),!1))),t<e.data.length&&(n.setStart(e,t),n.setEnd(e,t+1),pa(n)||o(va(ha(n),!0)))};if(ca(e.container()))return i(e.container(),e.offset()),r;if(ta(e.container()))if(e.isAtEnd())n=ua(e.container(),e.offset()),ca(n)&&i(n,n.data.length),ia(n)&&!sa(n)&&o(va(ha(n),!1));else{if(n=ua(e.container(),e.offset()),ca(n)&&i(n,0),ia(n)&&e.isAtEnd())return o(va(ha(n),!1)),r;t=ua(e.container(),e.offset()-1),ia(t)&&!sa(t)&&(ra(t)||ra(n)||!ia(n))&&o(va(ha(t),!1)),ia(n)&&o(va(ha(n),!0))}return r};function ya(e,t,n){var r=function(){return n||(n=ba(ya(e,t))),n};return{container:Zi.constant(e),offset:Zi.constant(t),toRange:function(){var n;return(n=da(e.ownerDocument)).setStart(e,t),n.setEnd(e,t),n},getClientRects:r,isVisible:function(){return r().length>0},isAtStart:function(){return ca(e),0===t},isAtEnd:function(){return ca(e)?t>=e.data.length:t>=e.childNodes.length},isEqual:function(n){return n&&e===n.container()&&t===n.offset()},getNode:function(n){return ua(e,n?t-1:t)}}}!function(e){e.fromRangeStart=function(t){return e(t.startContainer,t.startOffset)},e.fromRangeEnd=function(t){return e(t.endContainer,t.endOffset)},e.after=function(t){return e(t.parentNode,la(t)+1)},e.before=function(t){return e(t.parentNode,la(t))},e.isAbove=function(e,t){return ea([H.head(t.getClientRects()),H.last(e.getClientRects())],zi).getOr(!1)},e.isBelow=function(e,t){return ea([H.last(t.getClientRects()),H.head(e.getClientRects())],qi).getOr(!1)},e.isAtStart=function(e){return!!e&&e.isAtStart()},e.isAtEnd=function(e){return!!e&&e.isAtEnd()},e.isTextPosition=function(e){return!!e&&xo.isText(e.container())},e.isElementPosition=function(t){return!1===e.isTextPosition(t)}}(ya||(ya={}));var Ca,wa=ya,xa=xo.isElement,ka=xo.isText,Ta=function(e){var t=e.parentNode;t&&t.removeChild(e)},Ea=function(e,t){0===t.length?Ta(e):e.nodeValue=t},Sa=function(e){var t=gi(e);return{count:e.length-t.length,text:t}},Na=function(e,t){return _a(e),t},Aa=function(e,t){return ka(e)&&t.container()===e?function(e,t){var n=Sa(e.data.substr(0,t.offset())),r=Sa(e.data.substr(t.offset())),o=n.text+r.text;return o.length>0?(Ea(e,o),wa(e,t.offset()-n.count)):t}(e,t):Na(e,t)},Ra=function(e,t){return t.container()===e.parentNode?function(e,t){var n=t.container(),r=H.indexOf(H.from(n.childNodes),e).map((function(e){return e<t.offset()?wa(n,t.offset()-1):t})).getOr(t);return _a(e),r}(e,t):Na(e,t)},_a=function(e){if(xa(e)&&Ci(e)&&(wi(e)?e.removeAttribute("data-mce-caret"):Ta(e)),ka(e)){var t=gi(function(e){try{return e.nodeValue}catch(e){return""}}(e));Ea(e,t)}},Ia={removeAndReposition:function(e,t){return wa.isTextPosition(t)?Aa(e,t):Ra(e,t)},remove:_a},Ba=function(e){return wa.isTextPosition(e)?0===e.offset():Mi(e.getNode())},Pa=function(e){if(wa.isTextPosition(e)){var t=e.container();return e.offset()===t.data.length}return Mi(e.getNode(!0))},Da=function(e,t){return!wa.isTextPosition(e)&&!wa.isTextPosition(t)&&e.getNode()===t.getNode(!0)},Oa=function(e,t,n){return e?!Da(t,n)&&(r=t,!(!wa.isTextPosition(r)&&xo.isBr(r.getNode())))&&Pa(t)&&Ba(n):!Da(n,t)&&Ba(t)&&Pa(n);var r},Ma=function(e,t,n){var r=Bs(t);return T.from(e?r.next(n):r.prev(n))},La=function(e,t){var n=e?t.firstChild:t.lastChild;return xo.isText(n)?T.some(wa(n,e?0:n.data.length)):n?Mi(n)?T.some(e?wa.before(n):function(e){return xo.isBr(e)?wa.before(e):wa.after(e)}(n)):function(e,t,n){var r=e?wa.before(n):wa.after(n);return Ma(e,t,r)}(e,t,n):T.none()},Fa={fromPosition:Ma,nextPosition:b.curry(Ma,!0),prevPosition:b.curry(Ma,!1),navigate:function(e,t,n){return Ma(e,t,n).bind((function(r){return as(n,r,t)&&Oa(e,n,r)?Ma(e,t,r):T.some(r)}))},positionIn:La,firstPositionIn:b.curry(La,!0),lastPositionIn:b.curry(La,!1)},ja=xo.isContentEditableTrue,Ha=xo.isContentEditableFalse,Ua=function(e,t,n,r,o){return t._selectionOverrides.showCaret(e,n,r,o)},Wa=function(e,t){return e.fire("BeforeObjectSelected",{target:t}).isDefaultPrevented()?null:function(e){var t=e.ownerDocument.createRange();return t.selectNode(e),t}(t)},za=function(e,t,n){var r=ms(1,e.getBody(),t),o=wa.fromRangeStart(r),i=o.getNode();if(Ha(i))return Ua(1,e,i,!o.isAtEnd(),!1);var a=o.getNode(!0);if(Ha(a))return Ua(1,e,a,!1,!1);var c=e.dom.getParent(o.getNode(),(function(e){return Ha(e)||ja(e)}));return Ha(c)?Ua(1,e,c,!1,n):null},qa=function(e,t,n){if(!t||!t.collapsed)return t;var r=za(e,t,n);return r||t};!function(e){e[e.Br=0]="Br",e[e.Block=1]="Block",e[e.Wrap=2]="Wrap",e[e.Eol=3]="Eol"}(Ca||(Ca={}));var Va,$a=function(e,t){return e===Va.Backwards?t.reverse():t},Ka=function(e,t,n){return e===Va.Forwards?t.next(n):t.prev(n)},Ja=function(e,t,n,r){return xo.isBr(r.getNode(t===Va.Forwards))?Ca.Br:!1===as(n,r)?Ca.Block:Ca.Wrap},Ga=function(e,t,n,r){for(var o,i=Bs(n),a=r,c=[];a&&(o=Ka(t,i,a));){if(xo.isBr(o.getNode(!1)))return t===Va.Forwards?{positions:$a(t,c).concat([o]),breakType:Ca.Br,breakAt:T.some(o)}:{positions:$a(t,c),breakType:Ca.Br,breakAt:T.some(o)};if(o.isVisible()){if(e(a,o)){var s=Ja(0,t,a,o);return{positions:$a(t,c),breakType:s,breakAt:T.some(o)}}c.push(o),a=o}else a=o}return{positions:$a(t,c),breakType:Ca.Eol,breakAt:T.none()}},Xa=function(e,t,n,r){return t(n,r).breakAt.map((function(r){var o=t(n,r).positions;return e===Va.Backwards?o.concat(r):[r].concat(o)})).getOr([])},Ya=function(e,t){return H.foldl(e,(function(e,n){return e.fold((function(){return T.some(n)}),(function(r){return ea([H.head(r.getClientRects()),H.head(n.getClientRects())],(function(e,o){var i=Math.abs(t-e.left);return Math.abs(t-o.left)<=i?n:r})).or(e)}))}),T.none())},Qa=function(e,t){return H.head(t.getClientRects()).bind((function(t){return Ya(e,t.left)}))},Za=b.curry(Ga,ya.isAbove,-1),ec=b.curry(Ga,ya.isBelow,1),tc=b.curry(Xa,-1,Za),nc=b.curry(Xa,1,ec),rc=function(e,t){return Tr.all(t,e)},oc=function(e,t,n,r,o){var i=rc(On.fromDom(n),"td,th").map((function(e){return e.dom()}));return function(e,t,n){return H.foldl(e,(function(e,r){return e.fold((function(){return T.some(r)}),(function(e){var o=Math.sqrt(Math.abs(e.x-t)+Math.abs(e.y-n)),i=Math.sqrt(Math.abs(r.x-t)+Math.abs(r.y-n));return T.some(i<o?r:e)}))}),T.none())}(H.filter(function(e,t){return H.bind(t,(function(t){var n=function(e,t){return{left:e.left-t,top:e.top-t,right:e.right+2*t,bottom:e.bottom+2*t,width:e.width+t,height:e.height+t}}(t.getBoundingClientRect(),-1);return[{x:n.left,y:e(n),cell:t},{x:n.right,y:e(n),cell:t}]}))}(e,i),(function(e){return t(e,o)})),r,o).map((function(e){return e.cell}))},ic=b.curry(oc,(function(e){return e.bottom}),(function(e,t){return e.y<t})),ac=b.curry(oc,(function(e){return e.top}),(function(e,t){return e.y>t})),cc=function(e,t){return H.head(t.getClientRects()).bind((function(t){return ic(e,t.left,t.top)})).bind((function(e){return Qa((n=e,Fa.lastPositionIn(n).map((function(e){return Za(n,e).positions.concat(e)})).getOr([])),t);var n}))},sc=function(e,t){return H.last(t.getClientRects()).bind((function(t){return ac(e,t.left,t.top)})).bind((function(e){return Qa((n=e,Fa.firstPositionIn(n).map((function(e){return[e].concat(ec(n,e).positions)})).getOr([])),t);var n}))},lc=function(e){for(var t=0,n=0,r=e;r&&r.nodeType;)t+=r.offsetLeft||0,n+=r.offsetTop||0,r=r.offsetParent;return{x:t,y:n}},uc=function(e,t,n){var r,o,i,a,c=e.dom,s=c.getRoot(),l=0;if(!function(e,t,n){var r={elm:t,alignToTop:n};return e.fire("scrollIntoView",r),r.isDefaultPrevented()}(e,t,n)&&xo.isElement(t)){if(!1===n&&(l=t.offsetHeight),"BODY"!==s.nodeName){var u=e.selection.getScrollContainer();if(u)return r=lc(t).y-lc(u).y+l,a=u.clientHeight,void((r<(i=u.scrollTop)||r+25>i+a)&&(u.scrollTop=r<i?r:r-a+25))}o=c.getViewPort(e.getWin()),r=c.getPos(t).y+l,i=o.y,a=o.h,(r<o.y||r+25>i+a)&&e.getWin().scrollTo(0,r<i?r:r-a+25)}},dc=function(e,t){H.head(ya.fromRangeStart(t).getClientRects()).each((function(t){var n,r,o=function(e){if(e.inline)return e.getBody().getBoundingClientRect();var t=e.getWin();return{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight,width:t.innerWidth,height:t.innerHeight}}(e),i={x:Vi(n=o,r=t),y:$i(n,r)};!function(e,t,n){e.inline?(e.getBody().scrollLeft+=t,e.getBody().scrollTop+=n):e.getWin().scrollBy(t,n)}(e,0!==i.x?i.x>0?i.x+4:i.x-4:0,0!==i.y?i.y>0?i.y+4:i.y-4:0)}))},fc=function(e,t,n){var r=e.getParam(t,n);if(-1!==r.indexOf("=")){var o=e.getParam(t,"","hash");return o.hasOwnProperty(e.id)?o[e.id]:n}return r},mc=function(e){return e.getParam("iframe_attrs",{})},pc=function(e){return e.getParam("doctype","<!DOCTYPE html>")},gc=function(e){return e.getParam("document_base_url","")},hc=function(e){return fc(e,"body_id","tinymce")},vc=function(e){return fc(e,"body_class","")},bc=function(e){return e.getParam("content_security_policy","")},yc=function(e){return e.getParam("br_in_pre",!0)},Cc=function(e){if(e.getParam("force_p_newlines",!1))return"p";var t=e.getParam("forced_root_block","p");return!1===t?"":t},wc=function(e){return e.getParam("forced_root_block_attrs",{})},xc=function(e){return e.getParam("br_newline_selector",".mce-toc h2,figcaption,caption")},kc=function(e){return e.getParam("no_newline_selector","")},Tc=function(e){return e.getParam("keep_styles",!0)},Ec=function(e){return e.getParam("end_container_on_empty_block",!1)},Sc=function(e){return Ot.explode(e.getParam("font_size_style_values",""))},Nc=function(e){return Ot.explode(e.getParam("font_size_classes",""))},Ac=function(e,t){Or.parent(e).each((function(n){n.dom().insertBefore(t.dom(),e.dom())}))},Rc=function(e,t){e.dom().appendChild(t.dom())},_c={before:Ac,after:function(e,t){Or.nextSibling(e).fold((function(){Or.parent(e).each((function(e){Rc(e,t)}))}),(function(e){Ac(e,t)}))},prepend:function(e,t){Or.firstChild(e).fold((function(){Rc(e,t)}),(function(n){e.dom().insertBefore(t.dom(),n.dom())}))},append:Rc,appendAt:function(e,t,n){Or.child(e,n).fold((function(){Rc(e,t)}),(function(e){Ac(e,t)}))},wrap:function(e,t){Ac(e,t),Rc(t,e)}},Ic=Pn.detect().browser,Bc=function(){return Ic.isIE()||Ic.isEdge()||Ic.isFirefox()},Pc=function(e,t){e.selection.setRng(t),dc(e,t)},Dc=function(e,t,n){var r=e(t,n);return r.breakType===Ca.Wrap&&0===r.positions.length?r.breakAt.map((function(n){return e(t,n).breakAt.isNone()})).getOr(!0):r.breakAt.isNone()},Oc=Zi.curry(Dc,Za),Mc=Zi.curry(Dc,ec),Lc=function(e,t,n,r){var o=e.selection.getRng(),i=t?1:-1;if(Bc()&&function(e,t,n){var r=wa.fromRangeStart(t);return Fa.positionIn(!e,n).map((function(e){return e.isEqual(r)})).getOr(!1)}(t,o,n)){var a=Ua(i,e,n,!t,!0);return Pc(e,a),!0}return!1},Fc=function(e,t){var n=t.getNode(e);return xo.isElement(n)&&"TABLE"===n.nodeName?T.some(n):T.none()},jc=function(e,t,n){var r=Fc(!!t,n),o=!1===t;r.fold((function(){return Pc(e,n.toRange())}),(function(r){return Fa.positionIn(o,e.getBody()).filter((function(e){return e.isEqual(n)})).fold((function(){return Pc(e,n.toRange())}),(function(o){return function(e,t,n,r){var o=Cc(t);o?t.undoManager.transact((function(){var r=On.fromTag(o);rr.setAll(r,wc(t)),_c.append(r,On.fromTag("br")),e?_c.after(On.fromDom(n),r):_c.before(On.fromDom(n),r);var i=t.dom.createRng();i.setStart(r.dom(),0),i.setEnd(r.dom(),0),Pc(t,i)})):Pc(t,r.toRange())}(t,e,r,n)}))}))},Hc=function(e,t,n,r){var o=e.selection.getRng(),i=wa.fromRangeStart(o),a=e.getBody();if(!t&&Oc(r,i)){var c=function(e,t,n){return cc(t,n).orThunk((function(){return H.head(n.getClientRects()).bind((function(n){return Ya(tc(e,wa.before(t)),n.left)}))})).getOr(wa.before(t))}(a,n,i);return jc(e,t,c),!0}return!(!t||!Mc(r,i))&&(c=function(e,t,n){return sc(t,n).orThunk((function(){return H.head(n.getClientRects()).bind((function(n){return Ya(nc(e,wa.after(t)),n.left)}))})).getOr(wa.after(t))}(a,n,i),jc(e,t,c),!0)},Uc=function(e,t){return function(){return T.from(e.dom.getParent(e.selection.getNode(),"td,th")).bind((function(n){return T.from(e.dom.getParent(n,"table")).map((function(n){return Lc(e,t,n)}))})).getOr(!1)}},Wc=function(e,t){return function(){return T.from(e.dom.getParent(e.selection.getNode(),"td,th")).bind((function(n){return T.from(e.dom.getParent(n,"table")).map((function(r){return Hc(e,t,r,n)}))})).getOr(!1)}},zc=function(e){var t=e,n=function(){return t};return{get:n,set:function(e){t=e},clone:function(){return zc(n())}}},qc=xo.isContentEditableFalse,Vc=function(e,t,n){var r,o,i,a,c,s=Ui(t.getBoundingClientRect(),n);return"BODY"===e.tagName?(r=e.ownerDocument.documentElement,o=e.scrollLeft||r.scrollLeft,i=e.scrollTop||r.scrollTop):(c=e.getBoundingClientRect(),o=e.scrollLeft-c.left,i=e.scrollTop-c.top),s.left+=o,s.right+=o,s.top+=i,s.bottom+=i,s.width=1,(a=t.offsetWidth-t.clientWidth)>0&&(n&&(a*=-1),s.left+=a,s.right+=a),s},$c=function(e,t,n){var r,o,i=zc(T.none()),a=function(){!function(e){var t,n,r,o,i;for(t=en("*[contentEditable=false]",e),o=0;o<t.length;o++)r=(n=t[o]).previousSibling,Si(r)&&(1===(i=r.data).length?r.parentNode.removeChild(r):r.deleteData(i.length-1,1)),r=n.nextSibling,Ei(r)&&(1===(i=r.data).length?r.parentNode.removeChild(r):r.deleteData(0,1))}(e),o&&(Ia.remove(o),o=null),i.get().each((function(e){en(e.caret).remove(),i.set(T.none())})),clearInterval(r)},c=function(){r=Ce.setInterval((function(){n()?en("div.mce-visual-caret",e).toggleClass("mce-visual-caret-hidden"):en("div.mce-visual-caret",e).addClass("mce-visual-caret-hidden")}),500)};return{show:function(n,r){var s,l;if(a(),function(e){return xo.isElement(e)&&/^(TD|TH)$/i.test(e.tagName)}(r))return null;if(!t(r))return o=function(e,t){var n,r,o;if(r=e.ownerDocument.createTextNode(pi),o=e.parentNode,t){if(n=e.previousSibling,vi(n)){if(Ci(n))return n;if(Si(n))return n.splitText(n.data.length-1)}o.insertBefore(r,e)}else{if(n=e.nextSibling,vi(n)){if(Ci(n))return n;if(Ei(n))return n.splitText(1),n}e.nextSibling?o.insertBefore(r,e.nextSibling):o.appendChild(r)}return r}(r,n),l=r.ownerDocument.createRange(),qc(o.nextSibling)?(l.setStart(o,0),l.setEnd(o,0)):(l.setStart(o,1),l.setEnd(o,1)),l;o=Ti("p",r,n),s=Vc(e,r,n),en(o).css("top",s.top);var u=en('<div class="mce-visual-caret" data-mce-bogus="all"></div>').css(s).appendTo(e)[0];return i.set(T.some({caret:u,element:r,before:n})),i.get().each((function(e){n&&en(e.caret).addClass("mce-visual-caret-before")})),c(),(l=r.ownerDocument.createRange()).setStart(o,0),l.setEnd(o,0),l},hide:a,getCss:function(){return".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}"},reposition:function(){i.get().each((function(t){var n=Vc(e,t.element,t.before);en(t.caret).css(n)}))},destroy:function(){return Ce.clearInterval(r)}}},Kc=function(e){return qc(e)||xo.isTable(e)&&Bc()},Jc=xo.isContentEditableFalse,Gc=xo.matchStyleValues("display","block table table-cell table-caption list-item"),Xc=Ci,Yc=bi,Qc=Zi.curry,Zc=xo.isElement,es=Mi,ts=function(e){return e>0},ns=function(e){return e<0},rs=function(e,t){for(var n;n=e(t);)if(!Yc(n))return n;return null},os=function(e,t,n,r,o){var i=new Xr(e,r);if(ns(t)){if((Jc(e)||Yc(e))&&n(e=rs(i.prev,!0)))return e;for(;e=rs(i.prev,o);)if(n(e))return e}if(ts(t)){if((Jc(e)||Yc(e))&&n(e=rs(i.next,!0)))return e;for(;e=rs(i.next,o);)if(n(e))return e}return null},is=function(e,t){for(;e&&e!==t;){if(Gc(e))return e;e=e.parentNode}return null},as=function(e,t,n){return is(e.container(),n)===is(t.container(),n)},cs=function(e,t){var n,r;return t?(n=t.container(),r=t.offset(),Zc(n)?n.childNodes[r+e]:null):null},ss=function(e,t){var n=t.ownerDocument.createRange();return e?(n.setStartBefore(t),n.setEndBefore(t)):(n.setStartAfter(t),n.setEndAfter(t)),n},ls=function(e,t,n){return is(t,e)===is(n,e)},us=function(e,t,n){var r,o;for(o=e?"previousSibling":"nextSibling";n&&n!==t;){if(r=n[o],Xc(r)&&(r=r[o]),Jc(r)){if(ls(t,r,n))return r;break}if(es(r))break;n=n.parentNode}return null},ds=Qc(ss,!0),fs=Qc(ss,!1),ms=function(e,t,n){var r,o,i,a,c=Qc(us,!0,t),s=Qc(us,!1,t);if(o=n.startContainer,i=n.startOffset,bi(o)){if(Zc(o)||(o=o.parentNode),"before"===(a=o.getAttribute("data-mce-caret"))&&(r=o.nextSibling,Kc(r)))return ds(r);if("after"===a&&(r=o.previousSibling,Kc(r)))return fs(r)}if(!n.collapsed)return n;if(xo.isText(o)){if(Xc(o)){if(1===e){if(r=s(o))return ds(r);if(r=c(o))return fs(r)}if(-1===e){if(r=c(o))return fs(r);if(r=s(o))return ds(r)}return n}if(Si(o)&&i>=o.data.length-1)return 1===e&&(r=s(o))?ds(r):n;if(Ei(o)&&i<=1)return-1===e&&(r=c(o))?fs(r):n;if(i===o.data.length)return(r=s(o))?ds(r):n;if(0===i)return(r=c(o))?fs(r):n}return n},ps=function(e,t){var n=cs(e,t);return Jc(n)&&!xo.isBogusAll(n)},gs=function(e,t){return xo.isTable(cs(e,t))},hs=function(e,t){return T.from(cs(e?0:-1,t)).filter(Jc)},vs=function(e,t,n){var r=ms(e,t,n);return-1===e?ya.fromRangeStart(r):ya.fromRangeEnd(r)},bs=Qc(ps,0),ys=Qc(ps,-1),Cs=Qc(gs,0),ws=Qc(gs,-1);!function(e){e[e.Backwards=-1]="Backwards",e[e.Forwards=1]="Forwards"}(Va||(Va={}));var xs=xo.isContentEditableFalse,ks=xo.isText,Ts=xo.isElement,Es=xo.isBr,Ss=Mi,Ns=function(e){return Pi(e)||function(e){return!!Li(e)&&!0!==_t.reduce(e.getElementsByTagName("*"),(function(e,t){return e||Ai(t)}),!1)}(e)},As=Fi,Rs=function(e,t){return e.hasChildNodes()&&t<e.childNodes.length?e.childNodes[t]:null},_s=function(e,t){if(ts(e)){if(Ss(t.previousSibling)&&!ks(t.previousSibling))return wa.before(t);if(ks(t))return wa(t,0)}if(ns(e)){if(Ss(t.nextSibling)&&!ks(t.nextSibling))return wa.after(t);if(ks(t))return wa(t,t.data.length)}return ns(e)?Es(t)?wa.before(t):wa.after(t):wa.before(t)},Is=function(e,t,n){var r,o,i,a,c;if(!Ts(n)||!t)return null;if(t.isEqual(wa.after(n))&&n.lastChild){if(c=wa.after(n.lastChild),ns(e)&&Ss(n.lastChild)&&Ts(n.lastChild))return Es(n.lastChild)?wa.before(n.lastChild):c}else c=t;var s=c.container(),l=c.offset();if(ks(s)){if(ns(e)&&l>0)return wa(s,--l);if(ts(e)&&l<s.length)return wa(s,++l);r=s}else{if(ns(e)&&l>0&&(o=Rs(s,l-1),Ss(o)))return!Ns(o)&&(i=os(o,e,As,o))?ks(i)?wa(i,i.data.length):wa.after(i):ks(o)?wa(o,o.data.length):wa.before(o);if(ts(e)&&l<s.childNodes.length&&(o=Rs(s,l),Ss(o)))return Es(o)&&n.lastChild===o?null:function(e,t){var n;return!!xo.isBr(e)&&!!(n=Is(1,wa.after(e),t))&&!as(wa.before(e),wa.before(n),t)}(o,n)?Is(e,wa.after(o),n):!Ns(o)&&(i=os(o,e,As,o))?ks(i)?wa(i,0):wa.before(i):ks(o)?wa(o,0):wa.after(o);r=o||c.getNode()}return(ts(e)&&c.isAtEnd()||ns(e)&&c.isAtStart())&&(r=os(r,e,Zi.constant(!0),n,!0),As(r,n))?_s(e,r):(o=os(r,e,As,n),!(a=_t.last(_t.filter(function(e,t){for(var n=[];e&&e!==t;)n.push(e),e=e.parentNode;return n}(s,n),xs)))||o&&a.contains(o)?o?_s(e,o):null:c=ts(e)?wa.after(a):wa.before(a))},Bs=function(e){return{next:function(t){return Is(Va.Forwards,t,e)},prev:function(t){return Is(Va.Backwards,t,e)}}},Ps=function(e){return Ot.grep(e.childNodes,(function(e){return"LI"===e.nodeName}))},Ds=function(e){return e&&e.firstChild&&e.firstChild===e.lastChild&&function(e){return" "===e.data||xo.isBr(e)}(e.firstChild)},Os=function(e){return e.length>0&&(!(t=e[e.length-1]).firstChild||Ds(t))?e.slice(0,-1):e;var t},Ms=function(e,t){var n=e.getParent(t,e.isBlock);return n&&"LI"===n.nodeName?n:null},Ls=function(e,t){var n=wa.after(e),r=Bs(t).prev(n);return r?r.toRange():null},Fs=function(e,t,n){var r=e.parentNode;return Ot.each(t,(function(t){r.insertBefore(t,e)})),function(e,t){var n=wa.before(e),r=Bs(t).next(n);return r?r.toRange():null}(e,n)},js=function(e,t){var n=t.firstChild,r=t.lastChild;return n&&"meta"===n.name&&(n=n.next),r&&"mce_marker"===r.attr("id")&&(r=r.prev),function(e,t){var n=e.getNonEmptyElements();return t&&(t.isEmpty(n)||function(e,t){return e.getBlockElements()[t.name]&&function(e){return e.firstChild&&e.firstChild===e.lastChild}(t)&&function(e){return"br"===e.name||" "===e.value}(t.firstChild)}(e,t))}(e,r)&&(r=r.prev),!(!n||n!==r||"ul"!==n.name&&"ol"!==n.name)},Hs=function(e,t,n,r){var o=function(e,t,n){var r=t.serialize(n);return function(e){var t=e.firstChild,n=e.lastChild;return t&&"META"===t.nodeName&&t.parentNode.removeChild(t),n&&"mce_marker"===n.id&&n.parentNode.removeChild(n),e}(e.createFragment(r))}(t,e,r),i=Ms(t,n.startContainer),a=Os(Ps(o.firstChild)),c=t.getRoot(),s=function(e){var r=wa.fromRangeStart(n),o=Bs(t.getRoot()),a=1===e?o.prev(r):o.next(r);return!a||Ms(t,a.getNode())!==i};return s(1)?Fs(i,a,c):s(2)?function(e,t,n,r){return r.insertAfter(t.reverse(),e),Ls(t[0],n)}(i,a,c,t):function(e,t,n,r){var o=function(e,t){var n=t.cloneRange(),r=t.cloneRange();return n.setStartBefore(e),r.setEndAfter(e),[n.cloneContents(),r.cloneContents()]}(e,r),i=e.parentNode;return i.insertBefore(o[0],e),Ot.each(t,(function(t){i.insertBefore(t,e)})),i.insertBefore(o[1],e),i.removeChild(e),Ls(t[t.length-1],n)}(i,a,c,n)},Us=function(e,t){return!!Ms(e,t)},Ws=xo.isText,zs=xo.isBogus,qs=ii.nodeIndex,Vs=function(e){var t=e.parentNode;return zs(t)?Vs(t):t},$s=function(e){return e?_t.reduce(e.childNodes,(function(e,t){return zs(t)&&"BR"!==t.nodeName?e=e.concat($s(t)):e.push(t),e}),[]):[]},Ks=function(e){return function(t){return e===t}},Js=function(e){return(Ws(e)?"text()":e.nodeName.toLowerCase())+"["+function(e){var t,n,r;return t=$s(Vs(e)),n=_t.findIndex(t,Ks(e),e),t=t.slice(0,n+1),r=_t.reduce(t,(function(e,n,r){return Ws(n)&&Ws(t[r-1])&&e++,e}),0),t=_t.filter(t,xo.matchNodeNames(e.nodeName)),(n=_t.findIndex(t,Ks(e),e))-r}(e)+"]"},Gs=function(e,t){var n,r,o,i,a,c=[];return n=t.container(),r=t.offset(),Ws(n)?o=function(e,t){for(;(e=e.previousSibling)&&Ws(e);)t+=e.data.length;return t}(n,r):(r>=(i=n.childNodes).length?(o="after",r=i.length-1):o="before",n=i[r]),c.push(Js(n)),a=function(e,t,n){var r=[];for(t=t.parentNode;!(t===e||n&&n(t));t=t.parentNode)r.push(t);return r}(e,n),a=_t.filter(a,Zi.negate(xo.isBogus)),(c=c.concat(_t.map(a,(function(e){return Js(e)})))).reverse().join("/")+","+o},Xs=function(e,t){var n,r,o;return t?(n=t.split(","),t=n[0].split("/"),o=n.length>1?n[1]:"before",(r=_t.reduce(t,(function(e,t){return(t=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(t))?("text()"===t[1]&&(t[1]="#text"),function(e,t,n){var r=$s(e);return r=_t.filter(r,(function(e,t){return!Ws(e)||!Ws(r[t-1])})),(r=_t.filter(r,xo.matchNodeNames(t)))[n]}(e,t[1],parseInt(t[2],10))):null}),e))?Ws(r)?function(e,t){for(var n,r=e,o=0;Ws(r);){if(n=r.data.length,t>=o&&t<=o+n){e=r,t-=o;break}if(!Ws(r.nextSibling)){e=r,t=n;break}o+=n,r=r.nextSibling}return Ws(e)&&t>e.data.length&&(t=e.data.length),wa(e,t)}(r,parseInt(o,10)):(o="after"===o?qs(r)+1:qs(r),wa(r.parentNode,o)):null):null},Ys=xo.isContentEditableFalse,Qs=function(e,t,n,r,o){var i,a=r[o?"startContainer":"endContainer"],c=r[o?"startOffset":"endOffset"],s=[],l=0,u=e.getRoot();for(xo.isText(a)?s.push(n?function(e,t,n){var r,o;for(o=e(t.data.slice(0,n)).length,r=t.previousSibling;r&&xo.isText(r);r=r.previousSibling)o+=e(r.data).length;return o}(t,a,c):c):(c>=(i=a.childNodes).length&&i.length&&(l=1,c=Math.max(0,i.length-1)),s.push(e.nodeIndex(i[c],n)+l));a&&a!==u;a=a.parentNode)s.push(e.nodeIndex(a,n));return s},Zs=function(e){xo.isText(e)&&0===e.data.length&&e.parentNode.removeChild(e)},el=function(e,t,n){var r=0;return Ot.each(e.select(t),(function(e){if("all"!==e.getAttribute("data-mce-bogus"))return e!==n&&void r++})),r},tl=function(e,t){var n,r,o,i=t?"start":"end";n=e[i+"Container"],r=e[i+"Offset"],xo.isElement(n)&&"TR"===n.nodeName&&(n=(o=n.childNodes)[Math.min(t?r:r-1,o.length-1)])&&(r=t?0:n.childNodes.length,e["set"+(t?"Start":"End")](n,r))},nl=function(e){return tl(e,!0),tl(e,!1),e},rl=function(e,t){var n;if(xo.isElement(e)&&(e=Ji(e,t),Ys(e)))return e;if(Ci(e)){if(xo.isText(e)&&bi(e)&&(e=e.parentNode),n=e.previousSibling,Ys(n))return n;if(n=e.nextSibling,Ys(n))return n}},ol=function(e,t,n){var r=n.getNode(),o=r?r.nodeName:null,i=n.getRng();if(Ys(r)||"IMG"===o)return{name:o,index:el(n.dom,o,r)};var a=function(e){return rl(e.startContainer,e.startOffset)||rl(e.endContainer,e.endOffset)}(i);return a?{name:o=a.tagName,index:el(n.dom,o,a)}:function(e,t,n,r){var o=t.dom,i={};return i.start=Qs(o,e,n,r,!0),t.isCollapsed()||(i.end=Qs(o,e,n,r,!1)),i}(e,n,t,i)},il=function(e,t,n){var r={"data-mce-type":"bookmark",id:t,style:"overflow:hidden;line-height:0px"};return n?e.create("span",r,"&#xFEFF;"):e.create("span",r)},al=function(e,t){var n=e.dom,r=e.getRng(),o=n.uniqueId(),i=e.isCollapsed(),a=e.getNode(),c=a.nodeName;if("IMG"===c)return{name:c,index:el(n,c,a)};var s=nl(r.cloneRange());if(!i){s.collapse(!1);var l=il(n,o+"_end",t);s.insertNode(l),Zs(l.nextSibling)}(r=nl(r)).collapse(!0);var u=il(n,o+"_start",t);return r.insertNode(u),Zs(u.previousSibling),e.moveToBookmark({id:o,keep:1}),{id:o}},cl={getBookmark:function(e,t,n){return 2===t?ol(gi,n,e):3===t?function(e){var t=e.getRng();return{start:Gs(e.dom.getRoot(),wa.fromRangeStart(t)),end:Gs(e.dom.getRoot(),wa.fromRangeEnd(t))}}(e):t?function(e){return{rng:e.getRng()}}(e):al(e,!1)},getUndoBookmark:b.curry(ol,b.identity,!0),getPersistentBookmark:al},sl=function(e){return xo.isElement(e)&&"_mce_caret"===e.id},ll=function(e,t){for(;t&&t!==e;){if("_mce_caret"===t.id)return t;t=t.parentNode}return null},ul=function(e,t){return!e.isBlock(t)||t.innerHTML||ge.ie||(t.innerHTML='<br data-mce-bogus="1" />'),t},dl=function(e,t){return Fa.lastPositionIn(e).fold((function(){return!1}),(function(e){return t.setStart(e.container(),e.offset()),t.setEnd(e.container(),e.offset()),!0}))},fl=function(e,t,n){return!(!function(e){return!1===e.hasChildNodes()}(t)||!ll(e,t)||(function(e,t){var n=e.ownerDocument.createTextNode(pi);e.appendChild(n),t.setStart(n,0),t.setEnd(n,0)}(t,n),0))},ml=function(e,t,n,r){var o,i,a,c,s=n[t?"start":"end"],l=e.getRoot();if(s){for(a=s[0],i=l,o=s.length-1;o>=1;o--){if(c=i.childNodes,fl(l,i,r))return!0;if(s[o]>c.length-1)return!!fl(l,i,r)||dl(i,r);i=c[s[o]]}3===i.nodeType&&(a=Math.min(s[0],i.nodeValue.length)),1===i.nodeType&&(a=Math.min(s[0],i.childNodes.length)),t?r.setStart(i,a):r.setEnd(i,a)}return!0},pl=function(e){return xo.isText(e)&&e.data.length>0},gl=function(e,t,n){var r,o,i,a,c,s,l=e.get(n.id+"_"+t),u=n.keep;if(l){if(r=l.parentNode,"start"===t?(u?l.hasChildNodes()?(r=l.firstChild,o=1):pl(l.nextSibling)?(r=l.nextSibling,o=0):pl(l.previousSibling)?(r=l.previousSibling,o=l.previousSibling.data.length):(r=l.parentNode,o=e.nodeIndex(l)+1):o=e.nodeIndex(l),c=r,s=o):(u?l.hasChildNodes()?(r=l.firstChild,o=1):pl(l.previousSibling)?(r=l.previousSibling,o=l.previousSibling.data.length):(r=l.parentNode,o=e.nodeIndex(l)):o=e.nodeIndex(l),c=r,s=o),!u){for(a=l.previousSibling,i=l.nextSibling,Ot.each(Ot.grep(l.childNodes),(function(e){xo.isText(e)&&(e.nodeValue=e.nodeValue.replace(/\uFEFF/g,""))}));l=e.get(n.id+"_"+t);)e.remove(l,!0);a&&i&&a.nodeType===i.nodeType&&xo.isText(a)&&!ge.opera&&(o=a.nodeValue.length,a.appendData(i.nodeValue),e.remove(i),c=a,s=o)}return T.some(wa(c,s))}return T.none()},hl=function(e,t){var n=e.dom;if(t){if(function(e){return Ot.isArray(e.start)}(t))return function(e,t){var n=e.createRng();return ml(e,!0,t,n)&&ml(e,!1,t,n)?T.some(n):T.none()}(n,t);if(function(e){return"string"==typeof e.start}(t))return T.some(function(e,t){var n,r;return n=e.createRng(),r=Xs(e.getRoot(),t.start),n.setStart(r.container(),r.offset()),r=Xs(e.getRoot(),t.end),n.setEnd(r.container(),r.offset()),n}(n,t));if(function(e){return e.hasOwnProperty("id")}(t))return function(e,t){var n,r,o=gl(e,"start",t),i=gl(e,"end",t);return ea([o,(n=i,r=o,n.isSome()?n:r)],(function(t,n){var r=e.createRng();return r.setStart(ul(e,t.container()),t.offset()),r.setEnd(ul(e,n.container()),n.offset()),r}))}(n,t);if(function(e){return e.hasOwnProperty("name")}(t))return function(e,t){return T.from(e.select(t.name)[t.index]).map((function(t){var n=e.createRng();return n.selectNode(t),n}))}(n,t);if(function(e){return e.hasOwnProperty("rng")}(t))return T.some(t.rng)}return T.none()},vl={getBookmark:function(e,t,n){return cl.getBookmark(e,t,n)},moveToBookmark:function(e,t){hl(e,t).each((function(t){e.setRng(t)}))},isBookmarkNode:function(e){return xo.isElement(e)&&"SPAN"===e.tagName&&"bookmark"===e.getAttribute("data-mce-type")}},bl=Ot.each,yl=function(e){this.compare=function(t,n){if(t.nodeName!==n.nodeName)return!1;var r=function(t){var n={};return bl(e.getAttribs(t),(function(r){var o=r.nodeName.toLowerCase();0!==o.indexOf("_")&&"style"!==o&&0!==o.indexOf("data-")&&(n[o]=e.getAttrib(t,o))})),n},o=function(e,t){var n,r;for(r in e)if(e.hasOwnProperty(r)){if(void 0===(n=t[r]))return!1;if(e[r]!==n)return!1;delete t[r]}for(r in t)if(t.hasOwnProperty(r))return!1;return!0};return!(!o(r(t),r(n))||!o(e.parseStyle(e.getAttrib(t,"style")),e.parseStyle(e.getAttrib(n,"style")))||vl.isBookmarkNode(t)||vl.isBookmarkNode(n))}},Cl=function(e,t){H.each(t,(function(t){_c.before(e,t)}))},wl=function(e,t){H.each(t,(function(t){_c.append(e,t)}))},xl=function(e){var t=e.dom();null!==t.parentNode&&t.parentNode.removeChild(t)},kl={empty:function(e){e.dom().textContent="",H.each(Or.children(e),(function(e){xl(e)}))},remove:xl,unwrap:function(e){var t=Or.children(e);t.length>0&&Cl(e,t),xl(e)}},Tl=function(e,t){var n=function(t){return e(t)?T.from(t.dom().nodeValue):T.none()},r=Pn.detect().browser,o=r.isIE()&&10===r.version.major?function(e){try{return n(e)}catch(e){return T.none()}}:n;return{get:function(n){if(!e(n))throw new Error("Can only get "+t+" value of a "+t+" node");return o(n).getOr("")},getOption:o,set:function(n,r){if(!e(n))throw new Error("Can only set raw "+t+" value of a "+t+" node");n.dom().nodeValue=r}}}($n.isText,"text"),El=function(e){return Tl.get(e)},Sl=function(e){var t=rc(e,"br"),n=H.filter(function(e){for(var t=[],n=e.dom();n;)t.push(On.fromDom(n)),n=n.lastChild;return t}(e).slice(-1),oo);t.length===n.length&&H.each(n,kl.remove)},Nl=function(e){kl.empty(e),_c.append(e,On.fromHtml('<br data-mce-bogus="1">'))},Al=function(e){Or.lastChild(e).each((function(t){Or.prevSibling(t).each((function(n){no(e)&&oo(t)&&no(n)&&kl.remove(t)}))}))},Rl=Ot.makeMap;function _l(e){var t,n,r,o,i,a=[];return t=(e=e||{}).indent,n=Rl(e.indent_before||""),r=Rl(e.indent_after||""),o=Mo.getEncodeFunc(e.entity_encoding||"raw",e.entities),i="html"===e.element_format,{start:function(e,c,s){var l,u,d,f;if(t&&n[e]&&a.length>0&&(f=a[a.length-1]).length>0&&"\n"!==f&&a.push("\n"),a.push("<",e),c)for(l=0,u=c.length;l<u;l++)d=c[l],a.push(" ",d.name,'="',o(d.value,!0),'"');a[a.length]=!s||i?">":" />",s&&t&&r[e]&&a.length>0&&(f=a[a.length-1]).length>0&&"\n"!==f&&a.push("\n")},end:function(e){var n;a.push("</",e,">"),t&&r[e]&&a.length>0&&(n=a[a.length-1]).length>0&&"\n"!==n&&a.push("\n")},text:function(e,t){e.length>0&&(a[a.length]=t?e:o(e))},cdata:function(e){a.push("<![CDATA[",e,"]]>")},comment:function(e){a.push("\x3c!--",e,"--\x3e")},pi:function(e,n){n?a.push("<?",e," ",o(n),"?>"):a.push("<?",e,"?>"),t&&a.push("\n")},doctype:function(e){a.push("<!DOCTYPE",e,">",t?"\n":"")},reset:function(){a.length=0},getContent:function(){return a.join("").replace(/\n$/,"")}}}function Il(e,t){void 0===t&&(t=Ko());var n=_l(e);return(e=e||{}).validate=!("validate"in e)||e.validate,{serialize:function(r){var o,i;i=e.validate,o={3:function(e){n.text(e.value,e.raw)},8:function(e){n.comment(e.value)},7:function(e){n.pi(e.name,e.value)},10:function(e){n.doctype(e.value)},4:function(e){n.cdata(e.value)},11:function(e){if(e=e.firstChild)do{a(e)}while(e=e.next)}},n.reset();var a=function(e){var r,c,s,l,u,d,f,m,p,g=o[e.type];if(g)g(e);else{if(r=e.name,c=e.shortEnded,s=e.attributes,i&&s&&s.length>1&&((d=[]).map={},p=t.getElementRule(e.name))){for(f=0,m=p.attributesOrder.length;f<m;f++)(l=p.attributesOrder[f])in s.map&&(u=s.map[l],d.map[l]=u,d.push({name:l,value:u}));for(f=0,m=s.length;f<m;f++)(l=s[f].name)in d.map||(u=s.map[l],d.map[l]=u,d.push({name:l,value:u}));s=d}if(n.start(e.name,s,c),!c){if(e=e.firstChild)do{a(e)}while(e=e.next);n.end(r)}}};return 1!==r.type||e.inner?o[11](r):a(r),n.getContent()}}}var Bl=function(e){var t=wa.fromRangeStart(e),n=wa.fromRangeEnd(e),r=e.commonAncestorContainer;return Fa.fromPosition(!1,r,n).map((function(o){return!as(t,n,r)&&as(t,o,r)?function(e,t,n,r){var o=document.createRange();return o.setStart(e,t),o.setEnd(n,r),o}(t.container(),t.offset(),o.container(),o.offset()):e})).getOr(e)},Pl=function(e){return e.collapsed?e:Bl(e)},Dl=xo.matchNodeNames("td th"),Ol=function(e,t,n){var r,o,i,a,c,s,l,u,d,f,m,p,g=e.schema.getTextInlineElements(),h=e.selection,v=e.dom;if(/^ | $/.test(t)&&(t=function(e){var t,n,r;t=h.getRng(),n=t.startContainer,r=t.startOffset;var o=function(e){return n[e]&&3===n[e].nodeType};return 3===n.nodeType&&(r>0?e=e.replace(/^&nbsp;/," "):o("previousSibling")||(e=e.replace(/^ /,"&nbsp;")),r<n.length?e=e.replace(/&nbsp;(<br>|)$/," "):o("nextSibling")||(e=e.replace(/(&nbsp;| )(<br>|)$/,"&nbsp;"))),e}(t)),r=e.parser,p=n.merge,o=Il({validate:e.settings.validate},e.schema),m='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;&#x200B;</span>',s={content:t,format:"html",selection:!0,paste:n.paste},(s=e.fire("BeforeSetContent",s)).isDefaultPrevented())e.fire("SetContent",{content:s.content,format:"html",selection:!0,paste:n.paste});else{-1===(t=s.content).indexOf("{$caret}")&&(t+="{$caret}"),t=t.replace(/\{\$caret\}/,m);var b=(u=h.getRng()).startContainer||(u.parentElement?u.parentElement():null),y=e.getBody();b===y&&h.isCollapsed()&&v.isBlock(y.firstChild)&&function(t){return t&&!e.schema.getShortEndedElements()[t.nodeName]}(y.firstChild)&&v.isEmpty(y.firstChild)&&((u=v.createRng()).setStart(y.firstChild,0),u.setEnd(y.firstChild,0),h.setRng(u)),h.isCollapsed()||(e.selection.setRng(Pl(e.selection.getRng())),e.getDoc().execCommand("Delete",!1,null),function(){var e,n,r;n=(e=h.getRng()).startContainer,r=e.startOffset,3===n.nodeType&&e.collapsed&&(" "===n.data[r]?(n.deleteData(r,1),/[\u00a0| ]$/.test(t)||(t+=" ")):" "===n.data[r-1]&&(n.deleteData(r-1,1),/[\u00a0| ]$/.test(t)||(t=" "+t)))}());var C,w={context:(i=h.getNode()).nodeName.toLowerCase(),data:n.data,insert:!0};if(c=r.parse(t,w),!0===n.paste&&js(e.schema,c)&&Us(v,i))return u=Hs(o,v,e.selection.getRng(),c),e.selection.setRng(u),void e.fire("SetContent",s);if(function(e){for(var t=e;t=t.walk();)1===t.type&&t.attr("data-mce-fragment","1")}(c),"mce_marker"===(d=c.lastChild).attr("id"))for(l=d,d=d.prev;d;d=d.walk(!0))if(3===d.type||!v.isBlock(d.name)){e.schema.isValidChild(d.parent.name,"span")&&d.parent.insert(l,d,"br"===d.name);break}if(e._selectionOverrides.showBlockCaretContainer(i),w.invalid){for(h.setContent(m),i=h.getNode(),a=e.getBody(),9===i.nodeType?i=d=a:d=i;d!==a;)i=d,d=d.parentNode;t=i===a?a.innerHTML:v.getOuterHTML(i),t=o.serialize(r.parse(t.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,(function(){return o.serialize(c)})))),i===a?v.setHTML(a,t):v.setOuterHTML(i,t)}else t=o.serialize(c),function(e,t,n){if("all"===n.getAttribute("data-mce-bogus"))n.parentNode.insertBefore(e.dom.createFragment(t),n);else{var r=n.firstChild,o=n.lastChild;!r||r===o&&"BR"===r.nodeName?e.dom.setHTML(n,t):e.selection.setContent(t)}}(e,t,i);!function(){if(p){var t=e.getBody(),n=new yl(v);Ot.each(v.select("*[data-mce-fragment]"),(function(e){for(var r=e.parentNode;r&&r!==t;r=r.parentNode)g[e.nodeName.toLowerCase()]&&n.compare(r,e)&&v.remove(e,!0)}))}}(),function(t){var n,r,o;if(t){if(h.scrollIntoView(t),n=function(t){for(var n=e.getBody();t&&t!==n;t=t.parentNode)if("false"===e.dom.getContentEditable(t))return t;return null}(t))return v.remove(t),void h.select(n);u=v.createRng(),(d=t.previousSibling)&&3===d.nodeType?(u.setStart(d,d.nodeValue.length),ge.ie||(f=t.nextSibling)&&3===f.nodeType&&(d.appendData(f.data),f.parentNode.removeChild(f))):(u.setStartBefore(t),u.setEndBefore(t)),r=v.getParent(t,v.isBlock),v.remove(t),r&&v.isEmpty(r)&&(e.$(r).empty(),u.setStart(r,0),u.setEnd(r,0),Dl(r)||function(e){return!!e.getAttribute("data-mce-fragment")}(r)||!(o=function(t){var n=wa.fromRangeStart(t);if(n=Bs(e.getBody()).next(n))return n.toRange()}(u))?v.add(r,v.create("br",{"data-mce-bogus":"1"})):(u=o,v.remove(r))),h.setRng(u)}}(v.get("mce_marker")),C=e.getBody(),Ot.each(C.getElementsByTagName("*"),(function(e){e.removeAttribute("data-mce-fragment")})),function(e,t){T.from(e.getParent(t,"td,th")).map(On.fromDom).each(Al)}(e.dom,e.selection.getStart()),e.fire("SetContent",s),e.addVisual()}},Ml={insertAtCaret:function(e,t){var n=function(e){var t;return"string"!=typeof e?(t=Ot.extend({paste:e.paste,data:{paste:e.paste}},e),{content:e.content,details:t}):{content:e,details:{}}}(t);Ol(e,n.content,n.details)}};function Ll(e,t,n,r,o){return e(n,r)?T.some(n):S.isFunction(o)&&o(n)?T.none():t(n,r,o)}var Fl=function(e,t,n){for(var r=e.dom(),o=S.isFunction(n)?n:b.constant(!1);r.parentNode;){r=r.parentNode;var i=On.fromDom(r);if(t(i))return T.some(i);if(o(i))break}return T.none()},jl=function(e,t){return H.find(e.dom().childNodes,b.compose(t,On.fromDom)).map(On.fromDom)},Hl=function(e,t){var n=function(e){for(var r=0;r<e.childNodes.length;r++){if(t(On.fromDom(e.childNodes[r])))return T.some(On.fromDom(e.childNodes[r]));var o=n(e.childNodes[r]);if(o.isSome())return o}return T.none()};return n(e.dom())},Ul={first:function(e){return Hl(ar.body(),e)},ancestor:Fl,closest:function(e,t,n){return Ll((function(e){return t(e)}),Fl,e,t,n)},sibling:function(e,t){var n=e.dom();return n.parentNode?jl(On.fromDom(n.parentNode),(function(n){return!Nr.eq(e,n)&&t(n)})):T.none()},child:jl,descendant:Hl},Wl=hr.immutable("sections","settings"),zl=Pn.detect(),ql=zl.deviceType.isTouch(),Vl=["lists","autolink","autosave"],$l={theme:"mobile"},Kl=function(e){var t=S.isArray(e)?e.join(" "):e,n=H.map(S.isString(t)?t.split(" "):[],Sn);return H.filter(n,(function(e){return e.length>0}))},Jl=function(e,t){var n=Qn.bifilter(t,(function(t,n){return H.contains(e,n)}));return Wl(n.t,n.f)},Gl=function(e,t){return e.sections().hasOwnProperty(t)},Xl=function(e,t){var n=t.external_plugins?t.external_plugins:{};return e&&e.external_plugins?Ot.extend({},e.external_plugins,n):n},Yl=function(e,t,n,r){var o=Kl(n.forced_plugins),i=Kl(r.plugins),a=function(e,t){return[].concat(Kl(e)).concat(Kl(t))}(o,e&&Gl(t,"mobile")?function(e){return H.filter(e,b.curry(H.contains,Vl))}(i):i);return Ot.extend(r,{plugins:a.join(" ")})},Ql=function(e,t,n,r){var o=Jl(["mobile"],r),i=Ot.extend(t,n,o.settings(),function(e,t){var n=t.settings().inline;return e&&Gl(t,"mobile")&&!n}(e,o)?function(e,t,n){var r=e.sections(),o=r.hasOwnProperty(t)?r[t]:{};return Ot.extend({},n,o)}(o,"mobile",$l):{},{validate:!0,content_editable:o.settings().inline,external_plugins:Xl(n,o.settings())});return Yl(e,o,n,i)},Zl=function(e,t,n){return T.from(t.settings[n]).filter(e)},eu=b.curry(Zl,S.isString),tu=function(e,t,n,r){var o,i=t in e.settings?e.settings[t]:n;return"hash"===r?function(e){var t={};return"string"==typeof e?H.each(e.indexOf("=")>0?e.split(/[;,](?![^=;,]*(?:[;,]|$))/):e.split(","),(function(e){var n=e.split("=");n.length>1?t[Ot.trim(n[0])]=Ot.trim(n[1]):t[Ot.trim(n[0])]=Ot.trim(n)})):t=e,t}(i):"string"===r?Zl(S.isString,e,t).getOr(n):"number"===r?Zl(S.isNumber,e,t).getOr(n):"boolean"===r?Zl(S.isBoolean,e,t).getOr(n):"object"===r?Zl(S.isObject,e,t).getOr(n):"array"===r?Zl(S.isArray,e,t).getOr(n):"string[]"===r?Zl((o=S.isString,function(e){return S.isArray(e)&&H.forall(e,o)}),e,t).getOr(n):"function"===r?Zl(S.isFunction,e,t).getOr(n):i},nu=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,ru=function(e,t){var n=t.container(),r=t.offset();return e?yi(n)?xo.isText(n.nextSibling)?wa(n.nextSibling,0):wa.after(n):xi(t)?wa(n,r+1):t:yi(n)?xo.isText(n.previousSibling)?wa(n.previousSibling,n.previousSibling.data.length):wa.before(n):ki(t)?wa(n,r-1):t},ou=b.curry(ru,!0),iu=b.curry(ru,!1),au={isInlineTarget:function(e,t){var n=eu(e,"inline_boundaries_selector").getOr("a[href],code");return Tr.is(On.fromDom(t),n)},findRootInline:function(e,t,n){var r=function(e,t,n){return H.filter(ii.DOM.getParents(n.container(),"*",t),e)}(e,t,n);return T.from(r[r.length-1])},isRtl:function(e){return"rtl"===ii.DOM.getStyle(e,"direction",!0)||(t=e.textContent,nu.test(t));var t},isAtZwsp:function(e){return xi(e)||ki(e)},normalizePosition:ru,normalizeForwards:ou,normalizeBackwards:iu,hasSameParentBlock:function(e,t,n){var r=is(t,e),o=is(n,e);return r&&r===o}},cu=function(e,t){return Nr.contains(e,t)?Ul.closest(t,(function(e){return io(e)||co(e)}),function(e){return function(t){return Nr.eq(e,On.fromDom(t.dom().parentNode))}}(e)):T.none()},su=function(e){e.dom.isEmpty(e.getBody())&&(e.setContent(""),function(e){var t=e.getBody(),n=t.firstChild&&e.dom.isBlock(t.firstChild)?t.firstChild:t;e.selection.setCursorLocation(n,0)}(e))},lu=function(e,t,n){return ea([Fa.firstPositionIn(n),Fa.lastPositionIn(n)],(function(r,o){var i=au.normalizePosition(!0,r),a=au.normalizePosition(!1,o),c=au.normalizePosition(!1,t);return e?Fa.nextPosition(n,c).map((function(e){return e.isEqual(a)&&t.isEqual(i)})).getOr(!1):Fa.prevPosition(n,c).map((function(e){return e.isEqual(i)&&t.isEqual(a)})).getOr(!1)})).getOr(!0)},uu=function(e,t,n){return Ul.ancestor(e,(function(e){return Tr.is(e,t)}),n)},du=uu,fu=function(e,t){return Tr.one(t,e)},mu=function(e,t,n){return Ll(Tr.is,uu,e,t,n)},pu=function(e,t,n){return du(e,t,n).isSome()},gu=function(e,t){return xo.isText(t)&&/^[ \t\r\n]*$/.test(t.data)&&!1===function(e,t){var n=On.fromDom(e),r=On.fromDom(t);return pu(r,"pre,code",b.curry(Nr.eq,n))}(e,t)},hu=function(e,t){return Mi(t)&&!1===gu(e,t)||function(e){return xo.isElement(e)&&"A"===e.nodeName&&e.hasAttribute("name")}(t)||vu(t)},vu=xo.hasAttribute("data-mce-bookmark"),bu=xo.hasAttribute("data-mce-bogus"),yu=xo.hasAttributeValue("data-mce-bogus","all"),Cu=function(e){return function(e){var t,n,r=0;if(hu(e,e))return!1;if(!(n=e.firstChild))return!0;t=new Xr(n,e);do{if(yu(n))n=t.next(!0);else if(bu(n))n=t.next();else if(xo.isBr(n))r++,n=t.next();else{if(hu(e,n))return!1;n=t.next()}}while(n);return r<=1}(e.dom())},wu=hr.immutable("block","position"),xu=hr.immutable("from","to"),ku=function(e,t){var n=On.fromDom(e),r=On.fromDom(t.container());return cu(n,r).map((function(e){return wu(e,t)}))},Tu=function(e,t,n){var r=ku(e,wa.fromRangeStart(n)),o=r.bind((function(n){return Fa.fromPosition(t,e,n.position()).bind((function(n){return ku(e,n).map((function(n){return function(e,t,n){return xo.isBr(n.position().getNode())&&!1===Cu(n.block())?Fa.positionIn(!1,n.block().dom()).bind((function(r){return r.isEqual(n.position())?Fa.fromPosition(t,e,r).bind((function(t){return ku(e,t)})):T.some(n)})).getOr(n):n}(e,t,n)}))}))}));return ea([r,o],xu).filter((function(e){return function(e){return!1===Nr.eq(e.from().block(),e.to().block())}(e)&&function(e){return Or.parent(e.from().block()).bind((function(t){return Or.parent(e.to().block()).filter((function(e){return Nr.eq(t,e)}))})).isSome()}(e)&&function(e){return!1===xo.isContentEditableFalse(e.from().block())&&!1===xo.isContentEditableFalse(e.to().block())}(e)}))},Eu=function(e,t,n){return n.collapsed?Tu(e,t,n):T.none()},Su=function(e,t,n){return Nr.contains(t,e)?Or.parents(e,(function(e){return n(e)||Nr.eq(e,t)})).slice(0,-1):[]},Nu=function(e,t){return Su(e,t,b.constant(!1))},Au=Nu,Ru=function(e,t){return[e].concat(Nu(e,t))},_u=function(e){var t=function(e){var t=Or.children(e);return H.findIndex(t,no).fold((function(){return t}),(function(e){return t.slice(0,e)}))}(e);return H.each(t,(function(e){kl.remove(e)})),t},Iu=function(e,t){Fa.positionIn(e,t.dom()).each((function(e){var t=e.getNode();xo.isBr(t)&&kl.remove(On.fromDom(t))}))},Bu=function(e,t){var n=Ru(t,e);return H.find(n.reverse(),Cu).each(kl.remove)},Pu=function(e,t){return Nr.contains(t,e)?Or.parent(e).bind((function(n){return Nr.eq(n,t)?T.some(e):function(e,t){var n=Or.parents(t,(function(t){return Nr.eq(t,e)}));return T.from(n[n.length-2])}(t,e)})):T.none()},Du=function(e,t,n){if(Cu(n))return kl.remove(n),Cu(t)&&Nl(t),Fa.firstPositionIn(t.dom());Iu(!0,t),Iu(!1,n);var r=_u(t);return Pu(t,n).fold((function(){Bu(e,t);var o=Fa.lastPositionIn(n.dom());return H.each(r,(function(e){_c.append(n,e)})),o}),(function(o){var i=Fa.prevPosition(n.dom(),wa.before(o.dom()));return H.each(r,(function(e){_c.before(o,e)})),Bu(e,t),i}))},Ou=function(e,t,n,r){return t?Du(e,r,n):Du(e,n,r)},Mu=function(e,t){var n,r=On.fromDom(e.getBody());return(n=Eu(r.dom(),t,e.selection.getRng()).bind((function(e){return Ou(r,t,e.from().block(),e.to().block())}))).each((function(t){e.selection.setRng(t.toRange())})),n.isSome()},Lu=function(e,t){var n=On.fromDom(t),r=b.curry(Nr.eq,e);return Ul.ancestor(n,uo,r).isSome()},Fu=function(e,t){var n=Fa.prevPosition(e.dom(),wa.fromRangeStart(t)).isNone(),r=Fa.nextPosition(e.dom(),wa.fromRangeEnd(t)).isNone();return!function(e,t){return Lu(e,t.startContainer)||Lu(e,t.endContainer)}(e,t)&&n&&r},ju=function(e){var t=On.fromDom(e.getBody()),n=e.selection.getRng();return Fu(t,n)?function(e){return e.setContent(""),e.selection.setCursorLocation(),!0}(e):function(e,t){var n=t.getRng();return ea([cu(e,On.fromDom(n.startContainer)),cu(e,On.fromDom(n.endContainer))],(function(r,o){return!1===Nr.eq(r,o)&&(n.deleteContents(),Ou(e,!0,r,o).each((function(e){t.setRng(e.toRange())})),!0)})).getOr(!1)}(t,e.selection)},Hu=function(e,t){return!e.selection.isCollapsed()&&ju(e)},Uu=function(e){if(!S.isArray(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],n={};return H.each(e,(function(r,o){var i=Qn.keys(r);if(1!==i.length)throw new Error("one and only one name per case");var a=i[0],c=r[a];if(void 0!==n[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!S.isArray(c))throw new Error("case arguments must be an array");t.push(a),n[a]=function(){var n=arguments.length;if(n!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+n);for(var r=new Array(n),i=0;i<r.length;i++)r[i]=arguments[i];var s=function(e){var n=Qn.keys(e);if(t.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+n.join(","));if(!H.forall(t,(function(e){return H.contains(n,e)})))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+t.join(", "));return e[a].apply(null,r)};return{fold:function(){if(arguments.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+arguments.length);var t=arguments[o];return t.apply(null,r)},match:s,log:function(e){console.log(e,{constructors:t,constructor:a,params:r})}}}})),n},Wu=Uu([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),zu=function(e,t,n,r){var o=r.getNode(!1===t);return cu(On.fromDom(e),On.fromDom(n.getNode())).map((function(e){return Cu(e)?Wu.remove(e.dom()):Wu.moveToElement(o)})).orThunk((function(){return T.some(Wu.moveToElement(o))}))},qu=function(e,t,n){return Fa.fromPosition(t,e,n).bind((function(r){return function(e){return uo(On.fromDom(e))||co(On.fromDom(e))}(r.getNode())?T.none():function(e,t,n,r){var o=function(t){return ro(On.fromDom(t))&&!as(n,r,e)};return hs(!t,n).fold((function(){return hs(t,r).fold(b.constant(!1),o)}),o)}(e,t,n,r)?T.none():t&&xo.isContentEditableFalse(r.getNode())?zu(e,t,n,r):!1===t&&xo.isContentEditableFalse(r.getNode(!0))?zu(e,t,n,r):t&&ys(n)?T.some(Wu.moveToPosition(r)):!1===t&&bs(n)?T.some(Wu.moveToPosition(r)):T.none()}))},Vu=function(e,t,n){return function(e,t){var n=t.getNode(!1===e),r=e?"after":"before";return xo.isElement(n)&&n.getAttribute("data-mce-caret")===r}(t,n)?function(e,t){return e&&xo.isContentEditableFalse(t.nextSibling)?T.some(Wu.moveToElement(t.nextSibling)):!1===e&&xo.isContentEditableFalse(t.previousSibling)?T.some(Wu.moveToElement(t.previousSibling)):T.none()}(t,n.getNode(!1===t)).fold((function(){return qu(e,t,n)}),T.some):qu(e,t,n).bind((function(t){return function(e,t,n){return n.fold((function(e){return T.some(Wu.remove(e))}),(function(e){return T.some(Wu.moveToElement(e))}),(function(n){return as(t,n,e)?T.none():T.some(Wu.moveToPosition(n))}))}(e,n,t)}))},$u=function(e,t){return function(e,t){var n=e.container(),r=e.offset();return!1===wa.isTextPosition(e)&&n===t.parentNode&&r>wa.before(t).offset()}(t,e)?wa(t.container(),t.offset()-1):t},Ku=function(e){return Mi(e.previousSibling)?T.some(function(e){return xo.isText(e)?wa(e,e.data.length):wa.after(e)}(e.previousSibling)):e.previousSibling?Fa.lastPositionIn(e.previousSibling):T.none()},Ju=function(e){return Mi(e.nextSibling)?T.some(function(e){return xo.isText(e)?wa(e,0):wa.before(e)}(e.nextSibling)):e.nextSibling?Fa.firstPositionIn(e.nextSibling):T.none()},Gu=function(e,t){return Ku(t).orThunk((function(){return Ju(t)})).orThunk((function(){return function(e,t){var n=wa.before(t.previousSibling?t.previousSibling:t.parentNode);return Fa.prevPosition(e,n).fold((function(){return Fa.nextPosition(e,wa.after(t))}),T.some)}(e,t)}))},Xu=function(e,t){return Ju(t).orThunk((function(){return Ku(t)})).orThunk((function(){return function(e,t){return Fa.nextPosition(e,wa.after(t)).fold((function(){return Fa.prevPosition(e,wa.before(t))}),T.some)}(e,t)}))},Yu=function(e,t,n){return function(e,t,n){return e?Xu(t,n):Gu(t,n)}(e,t,n).map(b.curry($u,n))},Qu=function(e,t,n){n.fold((function(){e.focus()}),(function(n){e.selection.setRng(n.toRange(),t)}))},Zu=function(e,t){return t&&e.schema.getBlockElements().hasOwnProperty($n.name(t))},ed=function(e){if(Cu(e)){var t=On.fromHtml('<br data-mce-bogus="1">');return kl.empty(e),_c.append(e,t),T.some(wa.before(t.dom()))}return T.none()},td=function(e,t,n){var r,o=Yu(t,e.getBody(),n.dom()),i=Ul.ancestor(n,b.curry(Zu,e),(r=e.getBody(),function(e){return e.dom()===r})),a=function(e,t){return ea([Or.prevSibling(e),Or.nextSibling(e),t],(function(t,n,r){var o,i=t.dom(),a=n.dom();return xo.isText(i)&&xo.isText(a)?(o=i.data.length,i.appendData(a.data),kl.remove(n),kl.remove(e),r.container()===a?wa(i,o):r):(kl.remove(e),r)})).orThunk((function(){return kl.remove(e),t}))}(n,o);e.dom.isEmpty(e.getBody())?(e.setContent(""),e.selection.setCursorLocation()):i.bind(ed).fold((function(){Qu(e,t,a)}),(function(n){Qu(e,t,T.some(n))}))},nd=function(e,t){return function(e,t,n){var r=ms(t?1:-1,e,n),o=wa.fromRangeStart(r);return!1===t&&ys(o)?T.some(Wu.remove(o.getNode(!0))):t&&bs(o)?T.some(Wu.remove(o.getNode())):Vu(e,t,o)}(e.getBody(),t,e.selection.getRng()).map((function(n){return n.fold(function(e,t){return function(n){return e._selectionOverrides.hideFakeCaret(),td(e,t,On.fromDom(n)),!0}}(e,t),function(e,t){return function(n){var r=t?wa.before(n):wa.after(n);return e.selection.setRng(r.toRange()),!0}}(e,t),function(e){return function(t){return e.selection.setRng(t.toRange()),!0}}(e))})).getOr(!1)},rd=function(e,t){var n,r=e.selection.getNode();return!!xo.isContentEditableFalse(r)&&(n=On.fromDom(e.getBody()),H.each(rc(n,".mce-offscreen-selection"),kl.remove),td(e,t,On.fromDom(e.selection.getNode())),su(e),!0)},od=function(e,t){return e.selection.isCollapsed()?nd(e,t):rd(e,t)},id=function(e){var t,n=function(e,t){for(;t&&t!==e;){if(xo.isContentEditableTrue(t)||xo.isContentEditableFalse(t))return t;t=t.parentNode}return null}(e.getBody(),e.selection.getNode());return xo.isContentEditableTrue(n)&&e.dom.isBlock(n)&&e.dom.isEmpty(n)&&(t=e.dom.create("br",{"data-mce-bogus":"1"}),e.dom.setHTML(n,""),n.appendChild(t),e.selection.setRng(wa.before(t).toRange())),!0},ad=xo.isText,cd=function(e){return ad(e)&&e.data[0]===pi},sd=function(e){return ad(e)&&e.data[e.data.length-1]===pi},ld=function(e){return e.ownerDocument.createTextNode(pi)},ud=function(e,t){return e?function(e){if(ad(e.previousSibling))return sd(e.previousSibling)?e.previousSibling:(e.previousSibling.appendData(pi),e.previousSibling);if(ad(e))return cd(e)?e:(e.insertData(0,pi),e);var t=ld(e);return e.parentNode.insertBefore(t,e),t}(t):function(e){if(ad(e.nextSibling))return cd(e.nextSibling)?e.nextSibling:(e.nextSibling.insertData(0,pi),e.nextSibling);if(ad(e))return sd(e)?e:(e.appendData(pi),e);var t=ld(e);return e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t),t}(t)},dd=b.curry(ud,!0),fd=b.curry(ud,!1),md=function(e,t){return xo.isText(e.container())?ud(t,e.container()):ud(t,e.getNode())},pd=function(e,t){var n=t.get();return n&&e.container()===n&&yi(n)},gd=function(e,t){return t.fold((function(t){Ia.remove(e.get());var n=dd(t);return e.set(n),T.some(wa(n,n.length-1))}),(function(t){return Fa.firstPositionIn(t).map((function(t){if(pd(t,e))return wa(e.get(),1);Ia.remove(e.get());var n=md(t,!0);return e.set(n),wa(n,1)}))}),(function(t){return Fa.lastPositionIn(t).map((function(t){if(pd(t,e))return wa(e.get(),e.get().length-1);Ia.remove(e.get());var n=md(t,!1);return e.set(n),wa(n,n.length-1)}))}),(function(t){Ia.remove(e.get());var n=fd(t);return e.set(n),T.some(wa(n,1))}))},hd=function(e,t){for(var n=0;n<e.length;n++){var r=e[n].apply(null,t);if(r.isSome())return r}return T.none()},vd=Uu([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),bd=function(e,t){var n=is(t,e);return n||e},yd=function(e,t,n){var r=au.normalizeForwards(n),o=bd(t,r.container());return au.findRootInline(e,o,r).fold((function(){return Fa.nextPosition(o,r).bind(b.curry(au.findRootInline,e,o)).map((function(e){return vd.before(e)}))}),T.none)},Cd=function(e,t){return null===ll(e,t)},wd=function(e,t,n){return au.findRootInline(e,t,n).filter(b.curry(Cd,t))},xd=function(e,t,n){var r=au.normalizeBackwards(n);return wd(e,t,r).bind((function(e){return Fa.prevPosition(e,r).isNone()?T.some(vd.start(e)):T.none()}))},kd=function(e,t,n){var r=au.normalizeForwards(n);return wd(e,t,r).bind((function(e){return Fa.nextPosition(e,r).isNone()?T.some(vd.end(e)):T.none()}))},Td=function(e,t,n){var r=au.normalizeBackwards(n),o=bd(t,r.container());return au.findRootInline(e,o,r).fold((function(){return Fa.prevPosition(o,r).bind(b.curry(au.findRootInline,e,o)).map((function(e){return vd.after(e)}))}),T.none)},Ed=function(e){return!1===au.isRtl(Nd(e))},Sd=function(e,t,n){return hd([yd,xd,kd,Td],[e,t,n]).filter(Ed)},Nd=function(e){return e.fold(b.identity,b.identity,b.identity,b.identity)},Ad=function(e){return e.fold(b.constant("before"),b.constant("start"),b.constant("end"),b.constant("after"))},Rd=function(e){return e.fold(vd.before,vd.before,vd.after,vd.after)},_d=function(e,t,n,r,o,i){return ea([au.findRootInline(t,n,r),au.findRootInline(t,n,o)],(function(t,r){return t!==r&&au.hasSameParentBlock(n,t,r)?vd.after(e?t:r):i})).getOr(i)},Id=function(e,t){return e.fold(b.constant(!0),(function(e){return r=t,!(Ad(n=e)===Ad(r)&&Nd(n)===Nd(r));var n,r}))},Bd=function(e,t){return e?t.fold(b.compose(T.some,vd.start),T.none,b.compose(T.some,vd.after),T.none):t.fold(T.none,b.compose(T.some,vd.before),T.none,b.compose(T.some,vd.end))},Pd=function(e,t,n,r){var o=au.normalizePosition(e,r),i=Sd(t,n,o);return Sd(t,n,o).bind(b.curry(Bd,e)).orThunk((function(){return function(e,t,n,r,o){var i=au.normalizePosition(e,o);return Fa.fromPosition(e,n,i).map(b.curry(au.normalizePosition,e)).fold((function(){return r.map(Rd)}),(function(o){return Sd(t,n,o).map(b.curry(_d,e,t,n,i,o)).filter(b.curry(Id,r))})).filter(Ed)}(e,t,n,i,r)}))},Dd=Sd,Od=Pd,Md=(b.curry(Pd,!1),b.curry(Pd,!0),Rd),Ld=function(e){return e.fold(vd.start,vd.start,vd.end,vd.end)},Fd=function(e){return S.isFunction(e.selection.getSel().modify)},jd=function(e,t,n){var r=e?1:-1;return t.setRng(wa(n.container(),n.offset()+r).toRange()),t.getSel().modify("move",e?"forward":"backward","word"),!0},Hd=function(e,t){var n=t.selection.getRng(),r=e?wa.fromRangeEnd(n):wa.fromRangeStart(n);return!!Fd(t)&&(e&&xi(r)?jd(!0,t.selection,r):!(e||!ki(r))&&jd(!1,t.selection,r))},Ud=function(e,t){var n=e.dom.createRng();n.setStart(t.container(),t.offset()),n.setEnd(t.container(),t.offset()),e.selection.setRng(n)},Wd=function(e){return!1!==e.settings.inline_boundaries},zd=function(e,t){e?t.setAttribute("data-mce-selected","inline-boundary"):t.removeAttribute("data-mce-selected")},qd=function(e,t,n){return gd(t,n).map((function(t){return Ud(e,t),n}))},Vd=function(e,t,n){return function(){return!!Wd(t)&&Hd(e,t)}},$d={move:function(e,t,n){return function(){return!!Wd(e)&&function(e,t,n){var r=e.getBody(),o=wa.fromRangeStart(e.selection.getRng()),i=b.curry(au.isInlineTarget,e);return Od(n,i,r,o).bind((function(n){return qd(e,t,n)}))}(e,t,n).isSome()}},moveNextWord:b.curry(Vd,!0),movePrevWord:b.curry(Vd,!1),setupSelectedState:function(e){var t=zc(null),n=b.curry(au.isInlineTarget,e);return e.on("NodeChange",(function(r){Wd(e)&&(function(e,t,n){var r=H.filter(t.select('*[data-mce-selected="inline-boundary"]'),e),o=H.filter(n,e);H.each(H.difference(r,o),b.curry(zd,!1)),H.each(H.difference(o,r),b.curry(zd,!0))}(n,e.dom,r.parents),function(e,t){if(e.selection.isCollapsed()&&!0!==e.composing&&t.get()){var n=wa.fromRangeStart(e.selection.getRng());wa.isTextPosition(n)&&!1===au.isAtZwsp(n)&&(Ud(e,Ia.removeAndReposition(t.get(),n)),t.set(null))}}(e,t),function(e,t,n,r){if(t.selection.isCollapsed()){var o=H.filter(r,e);H.each(o,(function(r){var o=wa.fromRangeStart(t.selection.getRng());Dd(e,t.getBody(),o).bind((function(e){return qd(t,n,e)}))}))}}(n,e,t,r.parents))})),t},setCaretPosition:Ud},Kd=function(e,t){return function(n){return gd(t,n).map((function(t){return $d.setCaretPosition(e,t),!0})).getOr(!1)}},Jd=function(e,t,n,r){var o=e.getBody(),i=b.curry(au.isInlineTarget,e);e.undoManager.ignore((function(){e.selection.setRng(function(e,t){var n=document.createRange();return n.setStart(e.container(),e.offset()),n.setEnd(t.container(),t.offset()),n}(n,r)),e.execCommand("Delete"),Dd(i,o,wa.fromRangeStart(e.selection.getRng())).map(Ld).map(Kd(e,t))})),e.nodeChanged()},Gd=function(e,t,n,r){var o=function(e,t){var n=is(t,e);return n||e}(e.getBody(),r.container()),i=b.curry(au.isInlineTarget,e),a=Dd(i,o,r);return a.bind((function(e){return n?e.fold(b.constant(T.some(Ld(e))),T.none,b.constant(T.some(Md(e))),T.none):e.fold(T.none,b.constant(T.some(Md(e))),T.none,b.constant(T.some(Ld(e))))})).map(Kd(e,t)).getOrThunk((function(){var c=Fa.navigate(n,o,r),s=c.bind((function(e){return Dd(i,o,e)}));return a.isSome()&&s.isSome()?au.findRootInline(i,o,r).map((function(t){return!!function(e){return ea([Fa.firstPositionIn(e),Fa.lastPositionIn(e)],(function(t,n){var r=au.normalizePosition(!0,t),o=au.normalizePosition(!1,n);return Fa.nextPosition(e,r).map((function(e){return e.isEqual(o)})).getOr(!0)})).getOr(!0)}(t)&&(td(e,n,On.fromDom(t)),!0)})).getOr(!1):s.bind((function(o){return c.map((function(o){return n?Jd(e,t,r,o):Jd(e,t,o,r),!0}))})).getOr(!1)}))},Xd=function(e,t,n){if(e.selection.isCollapsed()&&function(e){return!1!==e.settings.inline_boundaries}(e)){var r=wa.fromRangeStart(e.selection.getRng());return Gd(e,t,n,r)}return!1},Yd=hr.immutable("start","end"),Qd=hr.immutable("rng","table","cells"),Zd=Uu([{removeTable:["element"]},{emptyCells:["cells"]}]),ef=function(e,t){return mu(On.fromDom(e),"td,th",t)},tf=function(e,t){return du(e,"table",t)},nf=function(e){return!1===Nr.eq(e.start(),e.end())},rf=function(e,t){return tf(e.start(),t).bind((function(n){return tf(e.end(),t).bind((function(e){return Nr.eq(n,e)?T.some(n):T.none()}))}))},of=function(e){return rc(e,"td,th")},af=function(e,t){var n=ef(t.startContainer,e),r=ef(t.endContainer,e);return t.collapsed?T.none():ea([n,r],Yd).fold((function(){return n.fold((function(){return r.bind((function(t){return tf(t,e).bind((function(e){return H.head(of(e)).map((function(e){return Yd(e,t)}))}))}))}),(function(t){return tf(t,e).bind((function(e){return H.last(of(e)).map((function(e){return Yd(t,e)}))}))}))}),(function(t){return cf(e,t)?T.none():function(e,t){return tf(e.start(),t).bind((function(t){return H.last(of(t)).map((function(t){return Yd(e.start(),t)}))}))}(t,e)}))},cf=function(e,t){return rf(t,e).isSome()},sf=function(e,t){var n=function(e){return b.curry(Nr.eq,e)}(e);return function(e,t){var n=ef(e.startContainer,t),r=ef(e.endContainer,t);return ea([n,r],Yd).filter(nf).filter((function(e){return cf(t,e)})).orThunk((function(){return af(t,e)}))}(t,n).bind((function(e){return function(e,t){return rf(e,t).map((function(t){return Qd(e,t,of(t))}))}(e,n)}))},lf=function(e,t){return H.findIndex(e,(function(e){return Nr.eq(e,t)}))},uf=function(e){return function(e){return ea([lf(e.cells(),e.rng().start()),lf(e.cells(),e.rng().end())],(function(t,n){return e.cells().slice(t,n+1)}))}(e).map((function(t){var n=e.cells();return t.length===n.length?Zd.removeTable(e.table()):Zd.emptyCells(t)}))},df=function(e,t){return sf(e,t).bind(uf)},ff=function(e){var t=[];if(e)for(var n=0;n<e.rangeCount;n++)t.push(e.getRangeAt(n));return t},mf=ff,pf=function(e){return H.bind(e,(function(e){var t=Ki(e);return t?[On.fromDom(t)]:[]}))},gf=function(e){return ff(e).length>1},hf=function(e){return H.filter(pf(e),uo)},vf=function(e){return rc(e,"td[data-mce-selected],th[data-mce-selected]")},bf=function(e,t){var n=vf(t),r=hf(e);return n.length>0?n:r},yf=bf,Cf=function(e){return bf(mf(e.selection.getSel()),On.fromDom(e.getBody()))},wf=function(e,t){return H.each(t,Nl),e.selection.setCursorLocation(t[0].dom(),0),!0},xf=function(e,t){return td(e,!1,t),!0},kf=function(e,t,n,r){return Ef(t,r).fold((function(){return function(e,t,n){return df(t,n).map((function(t){return t.fold(b.curry(xf,e),b.curry(wf,e))}))}(e,t,n)}),(function(t){return function(e,t){return Sf(e,t)}(e,t)})).getOr(!1)},Tf=function(e,t){return H.find(Ru(t,e),uo)},Ef=function(e,t){return H.find(Ru(t,e),(function(e){return"caption"===$n.name(e)}))},Sf=function(e,t){return Nl(t),e.selection.setCursorLocation(t.dom(),0),T.some(!0)},Nf=function(e,t,n,r,o){return Fa.navigate(n,e.getBody(),o).bind((function(i){return function(e,t,n,r){return Fa.firstPositionIn(e.dom()).bind((function(o){return Fa.lastPositionIn(e.dom()).map((function(e){return t?n.isEqual(o)&&r.isEqual(e):n.isEqual(e)&&r.isEqual(o)}))})).getOr(!0)}(r,n,o,i)?function(e,t){return Sf(e,t)}(e,r):function(e,t,n){return Ef(e,On.fromDom(n.getNode())).map((function(e){return!1===Nr.eq(e,t)}))}(t,r,i)})).or(T.some(!0))},Af=function(e,t,n,r){var o=wa.fromRangeStart(e.selection.getRng());return Tf(n,r).bind((function(r){return Cu(r)?Sf(e,r):function(e,t,n,r,o){return Fa.navigate(n,e.getBody(),o).bind((function(e){return Tf(t,On.fromDom(e.getNode())).map((function(e){return!1===Nr.eq(e,r)}))}))}(e,n,t,r,o)}))},Rf=function(e,t,n){var r=On.fromDom(e.getBody());return Ef(r,n).fold((function(){return Af(e,t,r,n)}),(function(n){return function(e,t,n,r){var o=wa.fromRangeStart(e.selection.getRng());return Cu(r)?Sf(e,r):Nf(e,n,t,r,o)}(e,t,r,n)})).getOr(!1)},_f=function(e,t){var n=On.fromDom(e.selection.getStart(!0)),r=Cf(e);return e.selection.isCollapsed()&&0===r.length?Rf(e,t,n):function(e,t){var n=On.fromDom(e.getBody()),r=e.selection.getRng(),o=Cf(e);return 0!==o.length?wf(e,o):kf(e,n,r,t)}(e,n)},If=function(e,t){e.getDoc().execCommand(t,!1,null)},Bf={deleteCommand:function(e){od(e,!1)||Xd(e,!1)||Mu(e,!1)||_f(e)||Hu(e,!1)||(If(e,"Delete"),su(e))},forwardDeleteCommand:function(e){od(e,!0)||Xd(e,!0)||Mu(e,!0)||_f(e)||Hu(e,!0)||If(e,"ForwardDelete")}},Pf=function(e){return function(t,n){return T.from(n).map(On.fromDom).filter($n.isElement).bind((function(n){return function(e,t,n){var r=function(t){return mr(t,e)};return Ul.closest(On.fromDom(n),(function(e){return r(e).isSome()}),(function(e){return Nr.eq(On.fromDom(t),e)})).bind(r)}(e,t,n.dom()).or(function(e,t){return T.from(ii.DOM.getStyle(t,e,!0))}(e,n.dom()))})).getOr("")}},Df={getFontSize:Pf("font-size"),getFontFamily:b.compose((function(e){return e.replace(/[\'\"\\]/g,"").replace(/,\s+/g,",")}),Pf("font-family")),toPt:function(e,t){return/[0-9.]+px$/.test(e)?function(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}(72*parseInt(e,10)/96,t||0)+"pt":e}},Of=function(e){return Fa.firstPositionIn(e.getBody()).map((function(e){var t=e.container();return xo.isText(t)?t.parentNode:t}))},Mf=function(e){return T.from(e.selection.getRng()).bind((function(t){return function(e,t){return e.startContainer===t&&0===e.startOffset}(t,e.getBody())?T.none():T.from(e.selection.getStart(!0))}))},Lf=function(e,t){var n=parseInt(t,10);if(n>=1&&n<=7){var r=Sc(e),o=Nc(e);return o?o[n-1]||t:r[n-1]||t}return t},Ff=function(e,t){e.formatter.toggle("fontname",{value:Lf(e,t)}),e.nodeChanged()},jf=function(e){return Mf(e).fold((function(){return Of(e).map((function(t){return Df.getFontFamily(e.getBody(),t)})).getOr("")}),(function(t){return Df.getFontFamily(e.getBody(),t)}))},Hf=function(e,t){e.formatter.toggle("fontsize",{value:Lf(e,t)}),e.nodeChanged()},Uf=function(e){return Mf(e).fold((function(){return Of(e).map((function(t){return Df.getFontSize(e.getBody(),t)})).getOr("")}),(function(t){return Df.getFontSize(e.getBody(),t)}))},Wf={isEq:function(e,t){return e&&t&&e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset}},zf=function(e,t,n){return null!==function(e,t,n){for(;e&&e!==t;){if(n(e))return e;e=e.parentNode}return null}(e,t,n)},qf=function(e,t,n){return zf(e,t,(function(e){return e.nodeName===n}))},Vf=function(e){return e&&"TABLE"===e.nodeName},$f=function(e){return e&&/^(TD|TH|CAPTION)$/.test(e.nodeName)},Kf=function(e,t){return Ci(e)&&!1===zf(e,t,sl)},Jf=function(e,t,n){for(var r=new Xr(t,e.getParent(t.parentNode,e.isBlock)||e.getRoot());t=r[n?"prev":"next"]();)if(xo.isBr(t))return!0},Gf=function(e,t,n,r,o){var i,a,c,s,l=e.getRoot(),u=e.schema.getNonEmptyElements();if(c=e.getParent(o.parentNode,e.isBlock)||l,r&&xo.isBr(o)&&t&&e.isEmpty(c))return T.some(ya(o.parentNode,e.nodeIndex(o)));for(i=new Xr(o,c);s=i[r?"prev":"next"]();){if("false"===e.getContentEditableParent(s)||Kf(s,l))return T.none();if(xo.isText(s)&&s.nodeValue.length>0)return!1===qf(s,l,"A")?T.some(ya(s,r?s.nodeValue.length:0)):T.none();if(e.isBlock(s)||u[s.nodeName.toLowerCase()])return T.none();a=s}return n&&a?T.some(ya(a,0)):T.none()},Xf=function(e,t,n,r){var o,i,a,c,s,l,u,d=e.getRoot(),f=!1;if(o=r[(n?"start":"end")+"Container"],i=r[(n?"start":"end")+"Offset"],u=xo.isElement(o)&&i===o.childNodes.length,s=e.schema.getNonEmptyElements(),l=n,Ci(o))return T.none();if(xo.isElement(o)&&i>o.childNodes.length-1&&(l=!1),xo.isDocument(o)&&(o=d,i=0),o===d){if(l&&(c=o.childNodes[i>0?i-1:0])){if(Ci(c))return T.none();if(s[c.nodeName]||Vf(c))return T.none()}if(o.hasChildNodes()){if(i=Math.min(!l&&i>0?i-1:i,o.childNodes.length-1),o=o.childNodes[i],i=xo.isText(o)&&u?o.data.length:0,!t&&o===d.lastChild&&Vf(o))return T.none();if(function(e,t){for(;t&&t!==e;){if(xo.isContentEditableFalse(t))return!0;t=t.parentNode}return!1}(d,o)||Ci(o))return T.none();if(o.hasChildNodes()&&!1===Vf(o)){c=o,a=new Xr(o,d);do{if(xo.isContentEditableFalse(c)||Ci(c)){f=!1;break}if(xo.isText(c)&&c.nodeValue.length>0){i=l?0:c.nodeValue.length,o=c,f=!0;break}if(s[c.nodeName.toLowerCase()]&&!$f(c)){i=e.nodeIndex(c),o=c.parentNode,l||i++,f=!0;break}}while(c=l?a.next():a.prev())}}}return t&&(xo.isText(o)&&0===i&&Gf(e,u,t,!0,o).each((function(e){o=e.container(),i=e.offset(),f=!0})),xo.isElement(o)&&((c=o.childNodes[i])||(c=o.childNodes[i-1]),!c||!xo.isBr(c)||function(e,t){return e.previousSibling&&e.previousSibling.nodeName===t}(c,"A")||Jf(e,c,!1)||Jf(e,c,!0)||Gf(e,u,t,!0,c).each((function(e){o=e.container(),i=e.offset(),f=!0})))),l&&!t&&xo.isText(o)&&i===o.nodeValue.length&&Gf(e,u,t,!1,o).each((function(e){o=e.container(),i=e.offset(),f=!0})),f?T.some(ya(o,i)):T.none()},Yf={normalize:function(e,t){var n=t.collapsed,r=t.cloneRange(),o=ya.fromRangeStart(t);return Xf(e,n,!0,r).each((function(e){n&&ya.isAbove(o,e)||r.setStart(e.container(),e.offset())})),n||Xf(e,n,!1,r).each((function(e){r.setEnd(e.container(),e.offset())})),n&&r.collapse(!0),Wf.isEq(t,r)?T.none():T.some(r)}},Qf=function(e,t,n){var r=e.create("span",{},"&nbsp;");n.parentNode.insertBefore(r,n),t.scrollIntoView(r),e.remove(r)},Zf=function(e,t,n,r){var o=e.createRng();r?(o.setStartBefore(n),o.setEndBefore(n)):(o.setStartAfter(n),o.setEndAfter(n)),t.setRng(o)},em=function(e,t){var n,r,o=e.selection,i=e.dom,a=o.getRng();Yf.normalize(i,a).each((function(e){a.setStart(e.startContainer,e.startOffset),a.setEnd(e.endContainer,e.endOffset)}));var c=a.startOffset,s=a.startContainer;if(1===s.nodeType&&s.hasChildNodes()){var l=c>s.childNodes.length-1;s=s.childNodes[Math.min(c,s.childNodes.length-1)]||s,c=l&&3===s.nodeType?s.nodeValue.length:0}var u=i.getParent(s,i.isBlock),d=u?i.getParent(u.parentNode,i.isBlock):null,f=d?d.nodeName.toUpperCase():"",m=t&&t.ctrlKey;"LI"!==f||m||(u=d),s&&3===s.nodeType&&c>=s.nodeValue.length&&(function(e,t,n){for(var r,o=new Xr(t,n),i=e.getNonEmptyElements();r=o.next();)if(i[r.nodeName.toLowerCase()]||r.length>0)return!0}(e.schema,s,u)||(n=i.create("br"),a.insertNode(n),a.setStartAfter(n),a.setEndAfter(n),r=!0)),n=i.create("br"),a.insertNode(n),Qf(i,o,n),Zf(i,o,n,r),e.undoManager.add()},tm=function(e,t){var n=On.fromTag("br");_c.before(On.fromDom(t),n),e.undoManager.add()},nm=function(e,t){rm(e.getBody(),t)||_c.after(On.fromDom(t),On.fromTag("br"));var n=On.fromTag("br");_c.after(On.fromDom(t),n),Qf(e.dom,e.selection,n.dom()),Zf(e.dom,e.selection,n.dom(),!1),e.undoManager.add()},rm=function(e,t){return n=wa.after(t),!!xo.isBr(n.getNode())||Fa.nextPosition(e,wa.after(t)).map((function(e){return xo.isBr(e.getNode())})).getOr(!1);var n},om=function(e){return e&&"A"===e.nodeName&&"href"in e},im=function(e){return e.fold(b.constant(!1),om,om,b.constant(!1))},am=function(e,t){t.fold(b.noop,b.curry(tm,e),b.curry(nm,e),b.noop)},cm={insert:function(e,t){var n=function(e){var t=b.curry(au.isInlineTarget,e),n=wa.fromRangeStart(e.selection.getRng());return Dd(t,e.getBody(),n).filter(im)}(e);n.isSome()?n.each(b.curry(am,e)):em(e,t)}},sm=Uu([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),lm=(sm.before,sm.on,sm.after,function(e){return e.fold(b.identity,b.identity,b.identity)}),um=Uu([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),dm=hr.immutable("start","soffset","finish","foffset"),fm={domRange:um.domRange,relative:um.relative,exact:um.exact,exactFromRange:function(e){return um.exact(e.start(),e.soffset(),e.finish(),e.foffset())},range:dm,getWin:function(e){var t=function(e){return e.match({domRange:function(e){return On.fromDom(e.startContainer)},relative:function(e,t){return lm(e)},exact:function(e,t,n,r){return e}})}(e);return Or.defaultView(t)}},mm=Pn.detect().browser,pm=function(e,t){var n=$n.isText(t)?El(t).length:Or.children(t).length+1;return e>n?n:e<0?0:e},gm=function(e){return fm.range(e.start(),pm(e.soffset(),e.start()),e.finish(),pm(e.foffset(),e.finish()))},hm=function(e,t){return Nr.contains(e,t)||Nr.eq(e,t)},vm=function(e){return function(t){return hm(e,t.start())&&hm(e,t.finish())}},bm=function(e){return!0===e.inline||mm.isIE()},ym=function(e){return fm.range(On.fromDom(e.startContainer),e.startOffset,On.fromDom(e.endContainer),e.endOffset)},Cm=function(e){var t=e.getSelection();return(t&&0!==t.rangeCount?T.from(t.getRangeAt(0)):T.none()).map(ym)},wm=function(e){var t=Or.defaultView(e);return Cm(t.dom()).filter(vm(e))},xm=function(e,t){return T.from(t).filter(vm(e)).map(gm)},km=function(e){var t=document.createRange();try{return t.setStart(e.start().dom(),e.soffset()),t.setEnd(e.finish().dom(),e.foffset()),T.some(t)}catch(e){return T.none()}},Tm=function(e){return(e.bookmark?e.bookmark:T.none()).bind(b.curry(xm,On.fromDom(e.getBody()))).bind(km)},Em={store:function(e){var t=bm(e)?wm(On.fromDom(e.getBody())):T.none();e.bookmark=t.isSome()?t:e.bookmark},storeNative:function(e,t){var n=On.fromDom(e.getBody()),r=(bm(e)?T.from(t):T.none()).map(ym).filter(vm(n));e.bookmark=r.isSome()?r:e.bookmark},readRange:Cm,restore:function(e){Tm(e).each((function(t){e.selection.setRng(t)}))},getRng:Tm,getBookmark:wm,validate:xm},Sm=function(e,t){var n=e.settings,r=e.dom,o=e.selection,i=e.formatter,a=/[a-z%]+$/i.exec(n.indentation)[0],c=parseInt(n.indentation,10),s=e.getParam("indent_use_margin",!1);e.queryCommandState("InsertUnorderedList")||e.queryCommandState("InsertOrderedList")||(n.forced_root_block||r.getParent(o.getNode(),r.isBlock)||i.apply("div"),H.each(o.getSelectedBlocks(),(function(e){return function(e,t,n,r,o,i){if("false"!==e.getContentEditable(i)&&"LI"!==i.nodeName){var a=n?"margin":"padding";if(a="TABLE"===i.nodeName?"margin":a,a+="rtl"===e.getStyle(i,"direction",!0)?"Right":"Left","outdent"===t){var c=Math.max(0,parseInt(i.style[a]||0,10)-r);e.setStyle(i,a,c?c+o:"")}else c=parseInt(i.style[a]||0,10)+r+o,e.setStyle(i,a,c)}}(r,t,s,c,a,e)})))},Nm=Ot.each,Am=Ot.extend,Rm=Ot.map,_m=Ot.inArray;function Im(e){var t,n,r,o,i={state:{},exec:{},value:{}},a=e.settings;e.on("PreInit",(function(){t=e.dom,n=e.selection,a=e.settings,r=e.formatter}));var c=function(t){var n;if(!e.quirks.isHidden()&&!e.removed){if(t=t.toLowerCase(),n=i.state[t])return n(t);try{return e.getDoc().queryCommandState(t)}catch(e){}return!1}},s=function(e,t){t=t||"exec",Nm(e,(function(e,n){Nm(n.toLowerCase().split(","),(function(n){i[t][n]=e}))}))},l=function(t,n,r){t=t.toLowerCase(),i.value[t]=function(){return n.call(r||e)}};Am(this,{execCommand:function(t,n,r,o){var a,c,s=!1;if(!e.removed){if(/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(t)||o&&o.skip_focus?Em.restore(e):e.focus(),(o=e.fire("BeforeExecCommand",{command:t,ui:n,value:r})).isDefaultPrevented())return!1;if(c=t.toLowerCase(),a=i.exec[c])return a(c,n,r),e.fire("ExecCommand",{command:t,ui:n,value:r}),!0;if(Nm(e.plugins,(function(o){if(o.execCommand&&o.execCommand(t,n,r))return e.fire("ExecCommand",{command:t,ui:n,value:r}),s=!0,!1})),s)return s;if(e.theme&&e.theme.execCommand&&e.theme.execCommand(t,n,r))return e.fire("ExecCommand",{command:t,ui:n,value:r}),!0;try{s=e.getDoc().execCommand(t,n,r)}catch(e){}return!!s&&(e.fire("ExecCommand",{command:t,ui:n,value:r}),!0)}},queryCommandState:c,queryCommandValue:function(t){var n;if(!e.quirks.isHidden()&&!e.removed){if(t=t.toLowerCase(),n=i.value[t])return n(t);try{return e.getDoc().queryCommandValue(t)}catch(e){}}},queryCommandSupported:function(t){if(t=t.toLowerCase(),i.exec[t])return!0;try{return e.getDoc().queryCommandSupported(t)}catch(e){}return!1},addCommands:s,addCommand:function(t,n,r){t=t.toLowerCase(),i.exec[t]=function(t,o,i,a){return n.call(r||e,o,i,a)}},addQueryStateHandler:function(t,n,r){t=t.toLowerCase(),i.state[t]=function(){return n.call(r||e)}},addQueryValueHandler:l,hasCustomCommand:function(e){return e=e.toLowerCase(),!!i.exec[e]}});var u=function(t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=null),e.getDoc().execCommand(t,n,r)},d=function(e){return r.match(e)},f=function(t,n){r.toggle(t,n?{value:n}:void 0),e.nodeChanged()},m=function(e){o=n.getBookmark(e)},p=function(){n.moveToBookmark(o)};s({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){e.undoManager.add()},"Cut,Copy,Paste":function(t){var n,r=e.getDoc();try{u(t)}catch(e){n=!0}if("paste"!==t||r.queryCommandEnabled(t)||(n=!0),n||!r.queryCommandSupported(t)){var o=e.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");ge.mac&&(o=o.replace(/Ctrl\+/g,"⌘+")),e.notificationManager.open({text:o,type:"error"})}},unlink:function(){if(n.isCollapsed()){var t=e.dom.getParent(e.selection.getStart(),"a");t&&e.dom.remove(t,!0)}else r.remove("link")},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone":function(e){var t=e.substring(7);"full"===t&&(t="justify"),Nm("left,center,right,justify".split(","),(function(e){t!==e&&r.remove("align"+e)})),"none"!==t&&f("align"+t)},"InsertUnorderedList,InsertOrderedList":function(e){var r,o;u(e),(r=t.getParent(n.getNode(),"ol,ul"))&&(o=r.parentNode,/^(H[1-6]|P|ADDRESS|PRE)$/.test(o.nodeName)&&(m(),t.split(o,r),p()))},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(e){f(e)},"ForeColor,HiliteColor":function(e,t,n){f(e,n)},FontName:function(t,n,r){Ff(e,r)},FontSize:function(t,n,r){Hf(e,r)},RemoveFormat:function(e){r.remove(e)},mceBlockQuote:function(){f("blockquote")},FormatBlock:function(e,t,n){return f(n||"p")},mceCleanup:function(){var t=n.getBookmark();e.setContent(e.getContent()),n.moveToBookmark(t)},mceRemoveNode:function(t,r,o){var i=o||n.getNode();i!==e.getBody()&&(m(),e.dom.remove(i,!0),p())},mceSelectNodeDepth:function(r,o,i){var a=0;t.getParent(n.getNode(),(function(e){if(1===e.nodeType&&a++===i)return n.select(e),!1}),e.getBody())},mceSelectNode:function(e,t,r){n.select(r)},mceInsertContent:function(t,n,r){Ml.insertAtCaret(e,r)},mceInsertRawHTML:function(t,r,o){var i=e.getContent();n.setContent("tiny_mce_marker"),e.setContent(i.replace(/tiny_mce_marker/g,(function(){return o})))},mceToggleFormat:function(e,t,n){f(n)},mceSetContent:function(t,n,r){e.setContent(r)},"Indent,Outdent":function(t){Sm(e,t)},mceRepaint:function(){},InsertHorizontalRule:function(){e.execCommand("mceInsertContent",!1,"<hr />")},mceToggleVisualAid:function(){e.hasVisual=!e.hasVisual,e.addVisual()},mceReplaceContent:function(t,r,o){e.execCommand("mceInsertContent",!1,o.replace(/\{\$selection\}/g,n.getContent({format:"text"})))},mceInsertLink:function(e,o,i){var a;"string"==typeof i&&(i={href:i}),a=t.getParent(n.getNode(),"a"),i.href=i.href.replace(" ","%20"),a&&i.href||r.remove("link"),i.href&&r.apply("link",i,a)},selectAll:function(){var e=t.getParent(n.getStart(),xo.isContentEditableTrue);if(e){var r=t.createRng();r.selectNodeContents(e),n.setRng(r)}},delete:function(){Bf.deleteCommand(e)},forwardDelete:function(){Bf.forwardDeleteCommand(e)},mceNewDocument:function(){e.setContent("")},InsertLineBreak:function(t,n,r){return cm.insert(e,r),!0}}),s({"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(e){var o="align"+e.substring(7),i=n.isCollapsed()?[t.getParent(n.getNode(),t.isBlock)]:n.getSelectedBlocks(),a=Rm(i,(function(e){return!!r.matchNode(e,o)}));return-1!==_m(a,!0)},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(e){return d(e)},mceBlockQuote:function(){return d("blockquote")},Outdent:function(){var e;if(a.inline_styles){if((e=t.getParent(n.getStart(),t.isBlock))&&parseInt(e.style.paddingLeft,10)>0)return!0;if((e=t.getParent(n.getEnd(),t.isBlock))&&parseInt(e.style.paddingLeft,10)>0)return!0}return c("InsertUnorderedList")||c("InsertOrderedList")||!a.inline_styles&&!!t.getParent(n.getNode(),"BLOCKQUOTE")},"InsertUnorderedList,InsertOrderedList":function(e){var r=t.getParent(n.getNode(),"ul,ol");return r&&("insertunorderedlist"===e&&"UL"===r.tagName||"insertorderedlist"===e&&"OL"===r.tagName)}},"state"),s({Undo:function(){e.undoManager.undo()},Redo:function(){e.undoManager.redo()}}),l("FontName",(function(){return jf(e)}),this),l("FontSize",(function(){return Uf(e)}),this)}var Bm=Ot.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend"," "),Pm=function(e){var t,n,r=this,o={},i=function(){return!1},a=function(){return!0};t=(e=e||{}).scope||r,n=e.toggleEvent||i;var c=function(e,t,a,c){var s,l,u;if(!1===t&&(t=i),t)for(t={func:t},c&&Ot.extend(t,c),u=(l=e.toLowerCase().split(" ")).length;u--;)e=l[u],(s=o[e])||(s=o[e]=[],n(e,!0)),a?s.unshift(t):s.push(t);return r},s=function(e,t){var i,a,c,s,l;if(e)for(i=(s=e.toLowerCase().split(" ")).length;i--;){if(e=s[i],a=o[e],!e){for(c in o)n(c,!1),delete o[c];return r}if(a){if(t)for(l=a.length;l--;)a[l].func===t&&(a=a.slice(0,l).concat(a.slice(l+1)),o[e]=a);else a.length=0;a.length||(n(e,!1),delete o[e])}}else{for(e in o)n(e,!1);o={}}return r};r.fire=function(n,r){var c,l,u,d;if(n=n.toLowerCase(),(r=r||{}).type=n,r.target||(r.target=t),r.preventDefault||(r.preventDefault=function(){r.isDefaultPrevented=a},r.stopPropagation=function(){r.isPropagationStopped=a},r.stopImmediatePropagation=function(){r.isImmediatePropagationStopped=a},r.isDefaultPrevented=i,r.isPropagationStopped=i,r.isImmediatePropagationStopped=i),e.beforeFire&&e.beforeFire(r),c=o[n])for(l=0,u=c.length;l<u;l++){if((d=c[l]).once&&s(n,d.func),r.isImmediatePropagationStopped())return r.stopPropagation(),r;if(!1===d.func.call(t,r))return r.preventDefault(),r}return r},r.on=c,r.off=s,r.once=function(e,t,n){return c(e,t,n,{once:!0})},r.has=function(e){return e=e.toLowerCase(),!(!o[e]||0===o[e].length)}};Pm.isNative=function(e){return!!Bm[e.toLowerCase()]};var Dm,Om=function(e){return e._eventDispatcher||(e._eventDispatcher=new Pm({scope:e,toggleEvent:function(t,n){Pm.isNative(t)&&e.toggleNativeEvent&&e.toggleNativeEvent(t,n)}})),e._eventDispatcher},Mm={fire:function(e,t,n){if(this.removed&&"remove"!==e)return t;if(t=Om(this).fire(e,t,n),!1!==n&&this.parent)for(var r=this.parent();r&&!t.isPropagationStopped();)r.fire(e,t,!1),r=r.parent();return t},on:function(e,t,n){return Om(this).on(e,t,n)},off:function(e,t){return Om(this).off(e,t)},once:function(e,t){return Om(this).once(e,t)},hasEventListeners:function(e){return Om(this).has(e)}},Lm=function(e,t){var n=rr.get(e,t);return void 0===n||""===n?[]:n.split(" ")},Fm=Lm,jm=function(e,t,n){var r=Lm(e,t).concat([n]);rr.set(e,t,r.join(" "))},Hm=function(e,t,n){var r=H.filter(Lm(e,t),(function(e){return e!==n}));r.length>0?rr.set(e,t,r.join(" ")):rr.remove(e,t)},Um=function(e){return Fm(e,"class")},Wm=function(e,t){return jm(e,"class",t)},zm=function(e,t){return Hm(e,"class",t)},qm=Um,Vm=Wm,$m=zm,Km=function(e,t){H.contains(Um(e),t)?zm(e,t):Wm(e,t)},Jm=function(e){return void 0!==e.dom().classList},Gm=function(e,t){return Jm(e)&&e.dom().classList.contains(t)},Xm={add:function(e,t){Jm(e)?e.dom().classList.add(t):Vm(e,t)},remove:function(e,t){Jm(e)?e.dom().classList.remove(t):$m(e,t),function(e){0===(Jm(e)?e.dom().classList:qm(e)).length&&rr.remove(e,"class")}(e)},toggle:function(e,t){return Jm(e)?e.dom().classList.toggle(t):Km(e,t)},toggler:function(e,t){var n=Jm(e),r=e.dom().classList;return function(e,t,n){var r=n||!1,o=function(){t(),r=!0},i=function(){e(),r=!1};return{on:o,off:i,toggle:function(){(r?i:o)()},isOn:function(){return r}}}((function(){n?r.remove(t):$m(e,t)}),(function(){n?r.add(t):Vm(e,t)}),Gm(e,t))},has:Gm},Ym=function(e,t){return e.fire("PreProcess",t)},Qm=function(e,t){return e.fire("PostProcess",t)},Zm=function(e){return e.fire("remove")},ep=function(e,t){return e.fire("SwitchMode",{mode:t})},tp=function(e,t,n,r){e.fire("ObjectResizeStart",{target:t,width:n,height:r})},np=function(e,t,n,r){e.fire("ObjectResized",{target:t,width:n,height:r})},rp=function(e,t,n){try{e.getDoc().execCommand(t,!1,n)}catch(e){}},op=function(e,t){!function(e,t,n){Xm.has(e,t)&&!1===n?Xm.remove(e,t):n&&Xm.add(e,t)}(On.fromDom(e.getBody()),"mce-content-readonly",t),t?(e.selection.controlSelection.hideResizeRect(),e.readonly=!0,e.getBody().contentEditable="false"):(e.readonly=!1,e.getBody().contentEditable="true",rp(e,"StyleWithCSS",!1),rp(e,"enableInlineTableEditing",!1),rp(e,"enableObjectResizing",!1),e.focus(),e.nodeChanged())},ip=function(e){return e.readonly?"readonly":"design"},ap=ii.DOM,cp=function(e,t){return"selectionchange"===t?e.getDoc():!e.inline&&/^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(t)?e.getDoc().documentElement:e.settings.event_root?(e.eventRoot||(e.eventRoot=ap.select(e.settings.event_root)[0]),e.eventRoot):e.getBody()},sp=function(e,t,n){!function(e){return!e.hidden&&!e.readonly}(e)?function(e){return!0===e.readonly}(e)&&n.preventDefault():e.fire(t,n)},lp=function(e,t){var n,r;if(e.delegates||(e.delegates={}),!e.delegates[t]&&!e.removed)if(n=cp(e,t),e.settings.event_root){if(Dm||(Dm={},e.editorManager.on("removeEditor",(function(){var t;if(!e.editorManager.activeEditor&&Dm){for(t in Dm)e.dom.unbind(cp(e,t));Dm=null}}))),Dm[t])return;r=function(n){for(var r=n.target,o=e.editorManager.get(),i=o.length;i--;){var a=o[i].getBody();(a===r||ap.isChildOf(r,a))&&sp(o[i],t,n)}},Dm[t]=r,ap.bind(n,t,r)}else r=function(n){sp(e,t,n)},ap.bind(n,t,r),e.delegates[t]=r},up={bindPendingEventDelegates:function(){var e=this;Ot.each(e._pendingNativeEvents,(function(t){lp(e,t)}))},toggleNativeEvent:function(e,t){"focus"!==e&&"blur"!==e&&(t?this.initialized?lp(this,e):this._pendingNativeEvents?this._pendingNativeEvents.push(e):this._pendingNativeEvents=[e]:this.initialized&&(this.dom.unbind(cp(this,e),e,this.delegates[e]),delete this.delegates[e]))},unbindAllNativeEvents:function(){var e,t=this.getBody(),n=this.dom;if(this.delegates){for(e in this.delegates)this.dom.unbind(cp(this,e),e,this.delegates[e]);delete this.delegates}!this.inline&&t&&n&&(t.onload=null,n.unbind(this.getWin()),n.unbind(this.getDoc())),n&&(n.unbind(t),n.unbind(this.getContainer()))}},dp=up=Ot.extend({},Mm,up),fp=Ot.each,mp=Ot.explode,pp={f9:120,f10:121,f11:122},gp=Ot.makeMap("alt,ctrl,shift,meta,access");function hp(e){var t={},n=[],r=function(e){var t,n,r={};for(n in fp(mp(e,"+"),(function(e){e in gp?r[e]=!0:/^[0-9]{2,}$/.test(e)?r.keyCode=parseInt(e,10):(r.charCode=e.charCodeAt(0),r.keyCode=pp[e]||e.toUpperCase().charCodeAt(0))})),t=[r.keyCode],gp)r[n]?t.push(n):r[n]=!1;return r.id=t.join(","),r.access&&(r.alt=!0,ge.mac?r.ctrl=!0:r.shift=!0),r.meta&&(ge.mac?r.meta=!0:(r.ctrl=!0,r.meta=!1)),r},o=function(t,n,o,i){var a;return(a=Ot.map(mp(t,">"),r))[a.length-1]=Ot.extend(a[a.length-1],{func:o,scope:i||e}),Ot.extend(a[0],{desc:e.translate(n),subpatterns:a.slice(1)})},i=function(e,t){return!!t&&t.ctrl===e.ctrlKey&&t.meta===e.metaKey&&t.alt===e.altKey&&t.shift===e.shiftKey&&!!(e.keyCode===t.keyCode||e.charCode&&e.charCode===t.charCode)&&(e.preventDefault(),!0)},a=function(e){return e.func?e.func.call(e.scope):null};e.on("keyup keypress keydown",(function(e){!function(e){return e.altKey||e.ctrlKey||e.metaKey}(e)&&!function(e){return"keydown"===e.type&&e.keyCode>=112&&e.keyCode<=123}(e)||e.isDefaultPrevented()||(fp(t,(function(t){if(i(e,t))return n=t.subpatterns.slice(0),"keydown"===e.type&&a(t),!0})),i(e,n[0])&&(1===n.length&&"keydown"===e.type&&a(n[0]),n.shift()))})),this.add=function(n,r,i,a){var c;return c=i,"string"==typeof i?i=function(){e.execCommand(c,!1,null)}:Ot.isArray(c)&&(i=function(){e.execCommand(c[0],c[1],c[2])}),fp(mp(Ot.trim(n.toLowerCase())),(function(e){var n=o(e,r,i,a);t[n.id]=n})),!0},this.remove=function(e){var n=o(e);return!!t[n.id]&&(delete t[n.id],!0)}}var vp=function(e){var t=void 0!==e?e.dom():document;return T.from(t.activeElement).map(On.fromDom)},bp=function(e){var t=Or.owner(e).dom();return e.dom()===t.activeElement},yp=function(e){return vp(Or.owner(e)).filter((function(t){return e.dom().contains(t.dom())}))},Cp=function(e,t){return function(e){return e.collapsed?T.from(Ji(e.startContainer,e.startOffset)).map(On.fromDom):T.none()}(t).bind((function(t){return lo(t)?T.some(t):!1===Nr.contains(e,t)?T.some(e):T.none()}))},wp=function(e,t){Cp(On.fromDom(e.getBody()),t).bind((function(e){return Fa.firstPositionIn(e.dom())})).fold((function(){e.selection.normalize()}),(function(t){return e.selection.setRng(t.toRange())}))},xp=function(e){if(e.setActive)try{e.setActive()}catch(t){e.focus()}else e.focus()},kp=function(e){var t,n=e.getBody();return n&&(t=On.fromDom(n),bp(t)||yp(t).isSome())},Tp=function(e){return e.inline?kp(e):function(e){return e.iframeElement&&bp(On.fromDom(e.iframeElement))}(e)},Ep=function(e){return e.editorManager.setActive(e)},Sp=function(e,t){e.removed||(t?Ep(e):function(e){var t=e.selection,n=e.settings.content_editable,r=e.getBody(),o=t.getRng();e.quirks.refreshContentEditable();var i=function(e,t){return e.dom.getParent(t,(function(t){return"true"===e.dom.getContentEditable(t)}))}(e,t.getNode());if(e.$.contains(r,i))return xp(i),wp(e,o),void Ep(e);void 0!==e.bookmark&&!1===Tp(e)&&Em.getRng(e).each((function(t){e.selection.setRng(t),o=t})),n||(ge.opera||xp(r),e.getWin().focus()),(ge.gecko||n)&&(xp(r),wp(e,o)),Ep(e)}(e))},Np=Tp,Ap=function(e,t){return t.dom()[e]},Rp=function(e,t){return parseInt(fr(t,e),10)},_p=b.curry(Ap,"clientWidth"),Ip=b.curry(Ap,"clientHeight"),Bp=b.curry(Rp,"margin-top"),Pp=b.curry(Rp,"margin-left"),Dp={isXYInContentArea:function(e,t,n){var r=On.fromDom(e.getBody()),o=e.inline?r:Or.documentElement(r),i=function(e,t,n,r){var o=function(e){return e.dom().getBoundingClientRect()}(t);return{x:n-(e?o.left+t.dom().clientLeft+Pp(t):0),y:r-(e?o.top+t.dom().clientTop+Bp(t):0)}}(e.inline,o,t,n);return function(e,t,n){var r=_p(e),o=Ip(e);return t>=0&&n>=0&&t<=r&&n<=o}(o,i.x,i.y)},isEditorAttachedToDom:function(e){return function(e){return T.from(e).map(On.fromDom)}(e.inline?e.getBody():e.getContentAreaContainer()).map((function(e){return Nr.contains(Or.owner(e),e)})).getOr(!1)}};function Op(e){var t=[],n=function(){var t,n=e.theme;return n&&n.getNotificationManagerImpl?n.getNotificationManagerImpl():{open:t=function(){throw new Error("Theme did not provide a NotificationManager implementation.")},close:t,reposition:t,getArgs:t}},r=function(){t.length>0&&n().reposition(t)},o=function(e){H.findIndex(t,(function(t){return t===e})).each((function(e){t.splice(e,1)}))},i=function(i){if(!e.removed&&Dp.isEditorAttachedToDom(e))return H.find(t,(function(e){return t=n().getArgs(e),r=i,!(t.type!==r.type||t.text!==r.text||t.progressBar||t.timeout||r.progressBar||r.timeout);var t,r})).getOrThunk((function(){e.editorManager.setActive(e);var a=n().open(i,(function(){o(a),r()}));return function(e){t.push(e)}(a),r(),a}))};return function(e){e.on("SkinLoaded",(function(){var t=e.settings.service_message;t&&i({text:t,type:"warning",timeout:0,icon:""})})),e.on("ResizeEditor ResizeWindow",(function(){Ce.requestAnimationFrame(r)})),e.on("remove",(function(){H.each(t,(function(e){n().close(e)}))}))}(e),{open:i,close:function(){T.from(t[0]).each((function(e){n().close(e),o(e),r()}))},getNotifications:function(){return t}}}function Mp(e){var t=[],n=function(){var t,n=e.theme;return n&&n.getWindowManagerImpl?n.getWindowManagerImpl():{open:t=function(){throw new Error("Theme did not provide a WindowManager implementation.")},alert:t,confirm:t,close:t,getParams:t,setParams:t}},r=function(e,t){return function(){return t?t.apply(e,arguments):void 0}},o=function(n){t.push(n),function(t){e.fire("OpenWindow",{win:t})}(n)},i=function(n){H.findIndex(t,(function(e){return e===n})).each((function(r){t.splice(r,1),function(t){e.fire("CloseWindow",{win:t})}(n),0===t.length&&e.focus()}))},a=function(){return T.from(t[t.length-1])};return e.on("remove",(function(){H.each(t.slice(0),(function(e){n().close(e)}))})),{windows:t,open:function(t,r){e.editorManager.setActive(e),Em.store(e);var a=n().open(t,r,i);return o(a),a},alert:function(e,t,a){var c=n().alert(e,r(a||this,t),i);o(c)},confirm:function(e,t,a){var c=n().confirm(e,r(a||this,t),i);o(c)},close:function(){a().each((function(e){n().close(e),i(e)}))},getParams:function(){return a().map(n().getParams).getOr(null)},setParams:function(e){a().each((function(t){n().setParams(t,e)}))},getWindows:function(){return t}}}var Lp=fi.PluginManager,Fp=function(e,t){var n=function(e,t){for(var n in Lp.urls)if(Lp.urls[n]+"/plugin"+t+".js"===e)return n;return null}(t,e.suffix);return n?"Failed to load plugin: "+n+" from url "+t:"Failed to load plugin url: "+t},jp=function(e,t){e.notificationManager.open({type:"error",text:t})},Hp=function(e,t){e._skinLoaded?jp(e,t):e.on("SkinLoaded",(function(){jp(e,t)}))},Up={pluginLoadError:function(e,t){Hp(e,Fp(e,t))},uploadError:function(e,t){Hp(e,"Failed to upload image: "+t)},displayError:Hp,initError:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=window.console;r&&(r.error?r.error.apply(r,arguments):r.log.apply(r,arguments))}},Wp=fi.PluginManager,zp=fi.ThemeManager;function qp(){return new(q.getOrDie("XMLHttpRequest"))}function Vp(e,t){var n={},r=function(e,n,r,o){var i,a;(i=new qp).open("POST",t.url),i.withCredentials=t.credentials,i.upload.onprogress=function(e){o(e.loaded/e.total*100)},i.onerror=function(){r("Image upload failed due to a XHR Transport error. Code: "+i.status)},i.onload=function(){var e,o,a;i.status<200||i.status>=300?r("HTTP Error: "+i.status):(e=JSON.parse(i.responseText))&&"string"==typeof e.location?n((o=t.basePath,a=e.location,o?o.replace(/\/$/,"")+"/"+a.replace(/^\//,""):a)):r("Invalid JSON: "+i.responseText)},(a=new FormData).append("file",e.blob(),e.filename()),i.send(a)},o=function(e,t){return{url:t,blobInfo:e,status:!0}},i=function(e,t){return{url:"",blobInfo:e,status:!1,error:t}},a=function(e,t){Ot.each(n[e],(function(e){e(t)})),delete n[e]},c=function(r,c){return r=Ot.grep(r,(function(t){return!e.isUploaded(t.blobUri())})),he.all(Ot.map(r,(function(r){return e.isPending(r.blobUri())?function(e){var t=e.blobUri();return new he((function(e){n[t]=n[t]||[],n[t].push(e)}))}(r):function(t,n,r){return e.markPending(t.blobUri()),new he((function(c){var s;try{var l=function(){s&&s.close()};n(t,(function(n){l(),e.markUploaded(t.blobUri(),n),a(t.blobUri(),o(t,n)),c(o(t,n))}),(function(n){l(),e.removeFailed(t.blobUri()),a(t.blobUri(),i(t,n)),c(i(t,n))}),(function(e){e<0||e>100||(s||(s=r()),s.progressBar.value(e))}))}catch(e){c(i(t,e.message))}}))}(r,t.handler,c)})))};return t=Ot.extend({credentials:!1,handler:r},t),{upload:function(e,n){return t.url||t.handler!==r?c(e,n):new he((function(e){e([])}))}}}function $p(e,t){return new(q.getOrDie("Blob"))(e,t)}function Kp(){return new(q.getOrDie("FileReader"))}function Jp(e){return new(q.getOrDie("Uint8Array"))(e)}var Gp=function(e){return q.getOrDie("atob")(e)},Xp=function(e){var t,n;return e=decodeURIComponent(e).split(","),(n=/data:([^;]+)/.exec(e[0]))&&(t=n[1]),{type:t,data:e[1]}},Yp=function(e){return 0===e.indexOf("blob:")?function(e){return new he((function(t,n){var r=function(){n("Cannot convert "+e+" to Blob. Resource might not exist or is inaccessible.")};try{var o=new qp;o.open("GET",e,!0),o.responseType="blob",o.onload=function(){200===this.status?t(this.response):r()},o.onerror=r,o.send()}catch(e){r()}}))}(e):0===e.indexOf("data:")?(t=e,new he((function(e){var n,r,o;t=Xp(t);try{n=Gp(t.data)}catch(t){return void e(new $p([]))}for(r=new Jp(n.length),o=0;o<r.length;o++)r[o]=n.charCodeAt(o);e(new $p([r],{type:t.type}))}))):null;var t},Qp=function(e){return new he((function(t){var n=new Kp;n.onloadend=function(){t(n.result)},n.readAsDataURL(e)}))},Zp=Xp,eg=0,tg=function(e){return(e||"blobid")+eg++},ng=function(e,t,n,r){var o,i;0!==t.src.indexOf("blob:")?(o=Zp(t.src).data,(i=e.findFirst((function(e){return e.base64()===o})))?n({image:t,blobInfo:i}):Yp(t.src).then((function(r){i=e.create(tg(),r,o),e.add(i),n({image:t,blobInfo:i})}),(function(e){r(e)}))):(i=e.getByUri(t.src))?n({image:t,blobInfo:i}):Yp(t.src).then((function(r){Qp(r).then((function(a){o=Zp(a).data,i=e.create(tg(),r,o),e.add(i),n({image:t,blobInfo:i})}))}),(function(e){r(e)}))},rg=function(e){return e?e.getElementsByTagName("img"):[]},og=0,ig={uuid:function(e){return e+og+++(t=function(){return Math.round(4294967295*Math.random()).toString(36)},"s"+(new Date).getTime().toString(36)+t()+t()+t());var t}};function ag(e){var t,n,r,o,i,a=function(){var e=[],t=Zi.constant,n=function(e){var n,r,o;if(!e.blob||!e.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");return n=e.id||ig.uuid("blobid"),r=e.name||n,{id:t(n),name:t(r),filename:t(r+"."+(o=e.blob.type,{"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png"}[o.toLowerCase()]||"dat")),blob:t(e.blob),base64:t(e.base64),blobUri:t(e.blobUri||$.createObjectURL(e.blob)),uri:t(e.uri)}},r=function(e){return o((function(t){return t.id()===e}))},o=function(t){return _t.filter(e,t)[0]};return{create:function(e,t,r,o){return n("object"==typeof e?e:{id:e,name:o,blob:t,base64:r})},add:function(t){r(t.id())||e.push(t)},get:r,getByUri:function(e){return o((function(t){return t.blobUri()===e}))},findFirst:o,removeByUri:function(t){e=_t.filter(e,(function(e){return e.blobUri()!==t||($.revokeObjectURL(e.blobUri()),!1)}))},destroy:function(){_t.each(e,(function(e){$.revokeObjectURL(e.blobUri())})),e=[]}}}(),c=e.settings,s=(r={},o=function(e,t){return{status:e,resultUri:t}},{hasBlobUri:i=function(e){return e in r},getResultUri:function(e){var t=r[e];return t?t.resultUri:null},isPending:function(e){return!!i(e)&&1===r[e].status},isUploaded:function(e){return!!i(e)&&2===r[e].status},markPending:function(e){r[e]=o(1,null)},markUploaded:function(e,t){r[e]=o(2,t)},removeFailed:function(e){delete r[e]},destroy:function(){r={}}}),l=function(t){return function(n){return e.selection?t(n):[]}},u=function(e,t,n){var r=0;do{-1!==(r=e.indexOf(t,r))&&(e=e.substring(0,r)+n+e.substr(r+t.length),r+=n.length-t.length+1)}while(-1!==r);return e},d=function(e,t,n){return e=u(e,'src="'+t+'"','src="'+n+'"'),e=u(e,'data-mce-src="'+t+'"','data-mce-src="'+n+'"')},f=function(t,n){_t.each(e.undoManager.data,(function(e){"fragmented"===e.type?e.fragments=_t.map(e.fragments,(function(e){return d(e,t,n)})):e.content=d(e.content,t,n)}))},m=function(){return e.notificationManager.open({text:e.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0})},p=function(n){return t||(t=Vp(s,{url:c.images_upload_url,basePath:c.images_upload_base_path,credentials:c.images_upload_credentials,handler:c.images_upload_handler})),v().then(l((function(r){var o;return o=_t.map(r,(function(e){return e.blobInfo})),t.upload(o,m).then(l((function(t){var o=_t.map(t,(function(t,n){var o=r[n].image;return t.status&&!1!==e.settings.images_replace_blob_uris?function(t,n){a.removeByUri(t.src),f(t.src,n),e.$(t).attr({src:c.images_reuse_filename?n+"?"+(new Date).getTime():n,"data-mce-src":e.convertURL(n,"src")})}(o,t.url):t.error&&Up.uploadError(e,t.error),{element:o,status:t.status}}));return n&&n(o),o})))})))},g=function(e){if(!1!==c.automatic_uploads)return p(e)},h=function(e){return!c.images_dataimg_filter||c.images_dataimg_filter(e)},v=function(){return n||(n=function(e,t){var n={};return{findAll:function(r,o){var i;o||(o=Zi.constant(!0)),i=_t.filter(rg(r),(function(t){var n=t.src;return!!ge.fileApi&&!t.hasAttribute("data-mce-bogus")&&!t.hasAttribute("data-mce-placeholder")&&!(!n||n===ge.transparentSrc)&&(0===n.indexOf("blob:")?!e.isUploaded(n):0===n.indexOf("data:")&&o(t))}));var a=_t.map(i,(function(e){if(n[e.src])return new he((function(t){n[e.src].then((function(n){if("string"==typeof n)return n;t({image:e,blobInfo:n.blobInfo})}))}));var r=new he((function(n,r){ng(t,e,n,r)})).then((function(e){return delete n[e.image.src],e})).catch((function(t){return delete n[e.src],t}));return n[e.src]=r,r}));return he.all(a)}}}(s,a)),n.findAll(e.getBody(),h).then(l((function(t){return t=_t.filter(t,(function(t){return"string"!=typeof t||(Up.displayError(e,t),!1)})),_t.each(t,(function(e){f(e.image.src,e.blobInfo.blobUri()),e.image.src=e.blobInfo.blobUri(),e.image.removeAttribute("data-mce-src")})),t})))},b=function(t){return t.replace(/src="(blob:[^"]+)"/g,(function(t,n){var r=s.getResultUri(n);if(r)return'src="'+r+'"';var o=a.getByUri(n);return o||(o=_t.reduce(e.editorManager.get(),(function(e,t){return e||t.editorUpload&&t.editorUpload.blobCache.getByUri(n)}),null)),o?'src="data:'+o.blob().type+";base64,"+o.base64()+'"':t}))};return e.on("setContent",(function(){!1!==e.settings.automatic_uploads?g():v()})),e.on("RawSaveContent",(function(e){e.content=b(e.content)})),e.on("getContent",(function(e){e.source_view||"raw"===e.format||(e.content=b(e.content))})),e.on("PostRender",(function(){e.parser.addNodeFilter("img",(function(e){_t.each(e,(function(e){var t=e.attr("src");if(!a.getByUri(t)){var n=s.getResultUri(t);n&&e.attr("src",n)}}))}))})),{blobCache:a,uploadImages:p,uploadImagesAuto:g,scanForImages:v,destroy:function(){a.destroy(),s.destroy(),n=t=null}}}var cg=function(e,t){return e.hasOwnProperty(t.nodeName)},sg=function(e,t){return!!xo.isText(t)||!!xo.isElement(t)&&!cg(e,t)&&!vl.isBookmarkNode(t)},lg=function(e,t){if(xo.isText(t)){if(0===t.nodeValue.length)return!0;if(/^\s+$/.test(t.nodeValue)&&(!t.nextSibling||cg(e,t.nextSibling)))return!0}return!1},ug=function(e){var t,n,r,o,i,a,c,s,l,u,d,f=e.settings,m=e.dom,p=e.selection,g=e.schema,h=g.getBlockElements(),v=p.getStart(),b=e.getBody();if(d=f.forced_root_block,v&&xo.isElement(v)&&d&&(u=b.nodeName.toLowerCase(),g.isValidChild(u,d.toLowerCase())&&!function(e,t,n){return H.exists(Au(On.fromDom(n),On.fromDom(t)),(function(t){return cg(e,t.dom())}))}(h,b,v))){for(n=(t=p.getRng()).startContainer,r=t.startOffset,o=t.endContainer,i=t.endOffset,l=Np(e),v=b.firstChild;v;)if(sg(h,v)){if(lg(h,v)){c=v,v=v.nextSibling,m.remove(c);continue}a||(a=m.create(d,e.settings.forced_root_block_attrs),v.parentNode.insertBefore(a,v),s=!0),c=v,v=v.nextSibling,a.appendChild(c)}else a=null,v=v.nextSibling;s&&l&&(t.setStart(n,r),t.setEnd(o,i),p.setRng(t),e.nodeChanged())}},dg=function(e){e.settings.forced_root_block&&e.on("NodeChange",b.curry(ug,e))};function fg(e){var t,n=[];"onselectionchange"in e.getDoc()||e.on("NodeChange Click MouseUp KeyUp Focus",(function(n){var r,o;o={startContainer:(r=e.selection.getRng()).startContainer,startOffset:r.startOffset,endContainer:r.endContainer,endOffset:r.endOffset},"nodechange"!==n.type&&Wf.isEq(o,t)||e.fire("SelectionChange"),t=o})),e.on("contextmenu",(function(){e.fire("SelectionChange")})),e.on("SelectionChange",(function(){var t=e.selection.getStart(!0);!t||!ge.range&&e.selection.isCollapsed()||!function(t){var r,o;if((o=e.$(t).parentsUntil(e.getBody()).add(t)).length===n.length){for(r=o.length;r>=0&&o[r]===n[r];r--);if(-1===r)return n=o,!0}return n=o,!1}(t)&&e.dom.isChildOf(t,e.getBody())&&e.nodeChanged({selectionChange:!0})})),e.on("MouseUp",(function(t){t.isDefaultPrevented()||("IMG"===e.selection.getNode().nodeName?Ce.setEditorTimeout(e,(function(){e.nodeChanged()})):e.nodeChanged())})),this.nodeChanged=function(t){var n,r,o,i=e.selection;e.initialized&&i&&!e.settings.disable_nodechange&&!e.readonly&&(o=e.getBody(),(n=i.getStart(!0)||o).ownerDocument===e.getDoc()&&e.dom.isChildOf(n,o)||(n=o),r=[],e.dom.getParent(n,(function(e){if(e===o)return!0;r.push(e)})),(t=t||{}).element=n,t.parents=r,e.fire("NodeChange",t))}}var mg,pg=function(e){var t,n,r,o;return o=e.getBoundingClientRect(),n=(t=e.ownerDocument).documentElement,r=t.defaultView,{top:o.top+r.pageYOffset-n.clientTop,left:o.left+r.pageXOffset-n.clientLeft}},gg=function(e,t){return function(e,t,n){return{pageX:n.left-e.left+t.left,pageY:n.top-e.top+t.top}}(function(e){return e.inline?pg(e.getBody()):{left:0,top:0}}(e),function(e){var t=e.getBody();return e.inline?{left:t.scrollLeft,top:t.scrollTop}:{left:0,top:0}}(e),function(e,t){if(t.target.ownerDocument!==e.getDoc()){var n=pg(e.getContentAreaContainer()),r=function(e){var t=e.getBody(),n=e.getDoc().documentElement,r={left:t.scrollLeft,top:t.scrollTop},o={left:t.scrollLeft||n.scrollLeft,top:t.scrollTop||n.scrollTop};return e.inline?r:o}(e);return{left:t.pageX-n.left+r.left,top:t.pageY-n.top+r.top}}return{left:t.pageX,top:t.pageY}}(e,t))},hg=xo.isContentEditableFalse,vg=xo.isContentEditableTrue,bg=function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},yg=function(e,t){return function(n){if(function(e){return 0===e.button}(n)){var r=_t.find(t.dom.getParents(n.target),Zi.or(hg,vg));if(c=t.getBody(),hg(s=r)&&s!==c){var o=t.dom.getPos(r),i=t.getBody(),a=t.getDoc().documentElement;e.element=r,e.screenX=n.screenX,e.screenY=n.screenY,e.maxX=(t.inline?i.scrollWidth:a.offsetWidth)-2,e.maxY=(t.inline?i.scrollHeight:a.offsetHeight)-2,e.relX=n.pageX-o.x,e.relY=n.pageY-o.y,e.width=r.offsetWidth,e.height=r.offsetHeight,e.ghost=function(e,t,n,r){var o=t.cloneNode(!0);e.dom.setStyles(o,{width:n,height:r}),e.dom.setAttrib(o,"data-mce-selected",null);var i=e.dom.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return e.dom.setStyles(i,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:r}),e.dom.setStyles(o,{margin:0,boxSizing:"border-box"}),i.appendChild(o),i}(t,r,e.width,e.height)}}var c,s}},Cg=function(e,t){return function(n){if(e.dragging&&function(e,t,n){return t!==n&&!e.dom.isChildOf(t,n)&&!hg(t)}(t,(c=t.selection,3===(s=c.getSel().getRangeAt(0).startContainer).nodeType?s.parentNode:s),e.element)){var r=(i=e.element,(a=i.cloneNode(!0)).removeAttribute("data-mce-selected"),a),o=t.fire("drop",{targetClone:r,clientX:n.clientX,clientY:n.clientY});o.isDefaultPrevented()||(r=o.targetClone,t.undoManager.transact((function(){bg(e.element),t.insertContent(t.dom.getOuterHTML(r)),t._selectionOverrides.hideFakeCaret()})))}var i,a,c,s;wg(e)}},wg=function(e){e.dragging=!1,e.element=null,bg(e.ghost)},xg=function(e){var t,n,r,o,i,a,c={};t=ii.DOM,a=document,n=yg(c,e),r=function(e,t){var n=Ce.throttle((function(e,n){t._selectionOverrides.hideFakeCaret(),t.selection.placeCaretAt(e,n)}),0);return function(r){var o,i,a=Math.max(Math.abs(r.screenX-e.screenX),Math.abs(r.screenY-e.screenY));if(function(e){return e.element}(e)&&!e.dragging&&a>10){if(t.fire("dragstart",{target:e.element}).isDefaultPrevented())return;e.dragging=!0,t.focus()}if(e.dragging){var c=function(e,t){return{pageX:t.pageX-e.relX,pageY:t.pageY+5}}(e,gg(t,r));o=e.ghost,i=t.getBody(),o.parentNode!==i&&i.appendChild(o),function(e,t,n,r,o,i){var a=0,c=0;e.style.left=t.pageX+"px",e.style.top=t.pageY+"px",t.pageX+n>o&&(a=t.pageX+n-o),t.pageY+r>i&&(c=t.pageY+r-i),e.style.width=n-a+"px",e.style.height=r-c+"px"}(e.ghost,c,e.width,e.height,e.maxX,e.maxY),n(r.clientX,r.clientY)}}}(c,e),o=Cg(c,e),i=function(e,t){return function(){wg(e),e.dragging&&t.fire("dragend")}}(c,e),e.on("mousedown",n),e.on("mousemove",r),e.on("mouseup",o),t.bind(a,"mousemove",r),t.bind(a,"mouseup",i),e.on("remove",(function(){t.unbind(a,"mousemove",r),t.unbind(a,"mouseup",i)}))},kg=function(e){xg(e),function(e){e.on("drop",(function(t){var n=void 0!==t.clientX?e.getDoc().elementFromPoint(t.clientX,t.clientY):null;(hg(n)||hg(e.dom.getContentEditableParent(n)))&&t.preventDefault()}))}(e)},Tg=function(e){return _t.reduce(e,(function(e,t){return e.concat(function(e){var t=function(t){return _t.map(t,(function(t){return(t=Hi(t)).node=e,t}))};if(xo.isElement(e))return t(e.getClientRects());if(xo.isText(e)){var n=e.ownerDocument.createRange();return n.setStart(e,0),n.setEnd(e,e.data.length),t(n.getClientRects())}}(t))}),[])};!function(e){e[e.Up=-1]="Up",e[e.Down=1]="Down"}(mg||(mg={}));var Eg=function(e,t,n,r,o,i){var a,c,s=0,l=[],u=function(r){var i,a,u;for(u=Tg([r]),-1===e&&(u=u.reverse()),i=0;i<u.length;i++)if(a=u[i],!n(a,c)){if(l.length>0&&t(a,_t.last(l))&&s++,a.line=s,o(a))return!0;l.push(a)}};return(c=_t.last(i.getClientRects()))?(u(a=i.getNode()),function(e,t,n,r){for(;r=os(r,e,Fi,t);)if(n(r))return}(e,r,u,a),l):l},Sg=b.curry(Eg,mg.Up,zi,qi),Ng=b.curry(Eg,mg.Down,qi,zi),Ag=function(e){return function(t){return function(e,t){return t.line>e}(e,t)}},Rg=function(e){return function(t){return function(e,t){return t.line===e}(e,t)}},_g=xo.isContentEditableFalse,Ig=os,Bg=function(e,t){return Math.abs(e.left-t)},Pg=function(e,t){return Math.abs(e.right-t)},Dg=function(e,t){return e>=t.left&&e<=t.right},Og=function(e,t){return _t.reduce(e,(function(e,n){var r,o;return r=Math.min(Bg(e,t),Pg(e,t)),o=Math.min(Bg(n,t),Pg(n,t)),Dg(t,n)?n:Dg(t,e)?e:o===r&&_g(n.node)?n:o<r?n:e}))},Mg=function(e,t,n,r){for(;r=Ig(r,e,Fi,t);)if(n(r))return},Lg=function(e,t,n){var r,o=Tg(function(e){return _t.filter(_t.toArray(e.getElementsByTagName("*")),Kc)}(e)),i=_t.filter(o,(function(e){return n>=e.top&&n<=e.bottom}));return(r=Og(i,t))&&(r=Og(function(e,t){var n=[],r=function(e,r){var o;return o=_t.filter(Tg([r]),(function(n){return!e(n,t)})),n=n.concat(o),0===o.length};return n.push(t),Mg(mg.Up,e,b.curry(r,zi),t.node),Mg(mg.Down,e,b.curry(r,qi),t.node),n}(e,r),t))&&Kc(r.node)?function(e,t){return{node:e.node,before:Bg(e,t)<Pg(e,t)}}(r,t):null},Fg=function(e,t,n){return!n.collapsed&&H.foldl(n.getClientRects(),(function(n,r){return n||function(e,t,n){return t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom}(r,e,t)}),!1)},jg=function(e,t){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},throttle:function(){var r=arguments;null===n&&(n=setTimeout((function(){e.apply(null,r),n=null,r=null}),t))}}},Hg=function(e){var t=jg((function(){if(!e.removed&&e.selection.getRng().collapsed){var t=qa(e,e.selection.getRng(),!1);e.selection.setRng(t)}}),0);e.on("focus",(function(){t.throttle()})),e.on("blur",(function(){t.cancel()}))},Ug={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,modifierPressed:function(e){return e.shiftKey||e.ctrlKey||e.altKey||this.metaKeyPressed(e)},metaKeyPressed:function(e){return ge.mac?e.metaKey:e.ctrlKey&&!e.altKey}},Wg=xo.isContentEditableTrue,zg=xo.isContentEditableFalse,qg=ys,Vg=bs,$g=function(e,t){for(var n=e.getBody();t&&t!==n;){if(Wg(t)||zg(t))return t;t=t.parentNode}return null},Kg=function(e){var t,n,r=e.getBody(),o=$c(e.getBody(),(function(t){return e.dom.isBlock(t)}),(function(){return Np(e)})),i="sel-"+e.dom.uniqueId(),a=function(t){t&&e.selection.setRng(t)},c=function(){return e.selection.getRng()},s=function(t,n,r,i){return void 0===i&&(i=!0),e.fire("ShowCaret",{target:n,direction:t,before:r}).isDefaultPrevented()?null:(i&&e.selection.scrollIntoView(n,-1===t),o.show(r,n))},l=function(e,t){return t=ms(e,r,t),-1===e?wa.fromRangeStart(t):wa.fromRangeEnd(t)},u=function(e){return Ci(e)||Ei(e)||Si(e)},d=function(e){return u(e.startContainer)||u(e.endContainer)},f=function(n,r){var o,a,c,u,f,m,g,h,v,b,y=e.$,C=e.dom;if(!n)return null;if(n.collapsed){if(!d(n))if(!1===r){if(h=l(-1,n),Kc(h.getNode(!0)))return s(-1,h.getNode(!0),!1,!1);if(Kc(h.getNode()))return s(-1,h.getNode(),!h.isAtEnd(),!1)}else{if(h=l(1,n),Kc(h.getNode()))return s(1,h.getNode(),!h.isAtEnd(),!1);if(Kc(h.getNode(!0)))return s(1,h.getNode(!0),!1,!1)}return null}return u=n.startContainer,f=n.startOffset,m=n.endOffset,3===u.nodeType&&0===f&&zg(u.parentNode)&&(u=u.parentNode,f=C.nodeIndex(u),u=u.parentNode),1!==u.nodeType?null:(m===f+1&&(o=u.childNodes[f]),zg(o)?(v=b=o.cloneNode(!0),(g=e.fire("ObjectSelected",{target:o,targetClone:v})).isDefaultPrevented()?null:(a=fu(On.fromDom(e.getBody()),"#"+i).fold((function(){return y([])}),(function(e){return y([e.dom()])})),v=g.targetClone,0===a.length&&(a=y('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>').attr("id",i)).appendTo(e.getBody()),n=e.dom.createRng(),v===b&&ge.ie?(a.empty().append('<p style="font-size: 0" data-mce-bogus="all"> </p>').append(v),n.setStartAfter(a[0].firstChild.firstChild),n.setEndAfter(v)):(a.empty().append(" ").append(v).append(" "),n.setStart(a[0].firstChild,1),n.setEnd(a[0].lastChild,0)),a.css({top:C.getPos(o,e.getBody()).y}),a[0].focus(),(c=e.selection.getSel()).removeAllRanges(),c.addRange(n),H.each(rc(On.fromDom(e.getBody()),"*[data-mce-selected]"),(function(e){rr.remove(e,"data-mce-selected")})),o.setAttribute("data-mce-selected","1"),t=o,p(),n)):null)},m=function(){t&&t.removeAttribute("data-mce-selected"),fu(On.fromDom(e.getBody()),"#"+i).each(kl.remove),t=null},p=function(){o.hide()};return ge.ceFalse&&(function(){e.on("mouseup",(function(t){var n=c();n.collapsed&&Dp.isXYInContentArea(e,t.clientX,t.clientY)&&a(za(e,n,!1))})),e.on("click",(function(t){var n;(n=$g(e,t.target))&&(zg(n)&&(t.preventDefault(),e.focus()),Wg(n)&&e.dom.isChildOf(n,e.selection.getNode())&&m())})),e.on("blur NewBlock",(function(){m()})),e.on("ResizeWindow FullscreenStateChanged",(function(){return o.reposition()}));var n=function(t,n){var r,o,i=e.dom.getParent(t,e.dom.isBlock),a=e.dom.getParent(n,e.dom.isBlock);return!(!i||!e.dom.isChildOf(i,a)||!1!==zg($g(e,i)))||i&&(r=i,o=a,!(e.dom.getParent(r,e.dom.isBlock)===e.dom.getParent(o,e.dom.isBlock)))&&function(e){var t=Bs(e);if(!e.firstChild)return!1;var n=wa.before(e.firstChild),r=t.next(n);return r&&!Vg(r)&&!qg(r)}(i)};!function(e){var t=!1;e.on("touchstart",(function(){t=!1})),e.on("touchmove",(function(){t=!0})),e.on("touchend",(function(n){var r=$g(e,n.target);zg(r)&&(t||(n.preventDefault(),f(Wa(e,r))))}))}(e),e.on("mousedown",(function(t){var o,i=t.target;if((i===r||"HTML"===i.nodeName||e.dom.isChildOf(i,r))&&!1!==Dp.isXYInContentArea(e,t.clientX,t.clientY))if(o=$g(e,i))zg(o)?(t.preventDefault(),f(Wa(e,o))):(m(),Wg(o)&&t.shiftKey||Fg(t.clientX,t.clientY,e.selection.getRng())||(p(),e.selection.placeCaretAt(t.clientX,t.clientY)));else if(!1===Kc(i)){m(),p();var c=Lg(r,t.clientX,t.clientY);if(c&&!n(t.target,c.node)){t.preventDefault();var l=s(1,c.node,c.before,!1);e.getBody().focus(),a(l)}}})),e.on("keypress",(function(t){Ug.modifierPressed(t)||(t.keyCode,zg(e.selection.getNode())&&t.preventDefault())})),e.on("getSelectionRange",(function(e){var n=e.range;if(t){if(!t.parentNode)return void(t=null);(n=n.cloneRange()).selectNode(t),e.range=n}})),e.on("setSelectionRange",(function(e){var t;(t=f(e.range,e.forward))&&(e.range=t)})),e.on("AfterSetSelectionRange",(function(t){var n,r=t.range;d(r)||p(),n=r.startContainer.parentNode,e.dom.hasClass(n,"mce-offscreen-selection")||m()})),e.on("copy",(function(t){var n,r=t.clipboardData;if(!t.isDefaultPrevented()&&t.clipboardData&&!ge.ie){var o=(n=e.dom.get(i))?n.getElementsByTagName("*")[0]:n;o&&(t.preventDefault(),r.clearData(),r.setData("text/html",o.outerHTML),r.setData("text/plain",o.outerText))}})),kg(e),Hg(e)}(),(n=e.contentStyles).push(o.getCss()),n.push(".mce-content-body .mce-offscreen-selection {position: absolute;left: -9999999999px;max-width: 1000000px;}.mce-content-body *[contentEditable=false] {cursor: default;}.mce-content-body *[contentEditable=true] {cursor: text;}")),{showCaret:s,showBlockCaretContainer:function(t){t.hasAttribute("data-mce-caret")&&(Ni(t),a(c()),e.selection.scrollIntoView(t[0]))},hideFakeCaret:p,destroy:function(){o.destroy(),t=null}}},Jg=function(e){return 0===e.indexOf("data-")||0===e.indexOf("aria-")},Gg=function(e){return e.replace(/<!--|-->/g,"")},Xg=function(e,t){return!e.allow_html_data_urls&&(/^data:image\//i.test(t)?!1===e.allow_svg_data_urls&&/^data:image\/svg\+xml/i.test(t):/^data:/i.test(t))},Yg=function(e,t,n){var r,o,i,a,c=1;for(a=e.getShortEndedElements(),(i=/<([!?\/])?([A-Za-z0-9\-_\:\.]+)((?:\s+[^"\'>]+(?:(?:"[^"]*")|(?:\'[^\']*\')|[^>]*))*|\/|\s+)>/g).lastIndex=r=n;o=i.exec(t);){if(r=i.lastIndex,"/"===o[1])c--;else if(!o[1]){if(o[2]in a)continue;c++}if(0===c)break}return r};function Qg(e,t){void 0===t&&(t=Ko());var n=function(){};!1!==(e=e||{}).fix_self_closing&&(e.fix_self_closing=!0);var r=e.comment?e.comment:n,o=e.cdata?e.cdata:n,i=e.text?e.text:n,a=e.start?e.start:n,c=e.end?e.end:n,s=e.pi?e.pi:n,l=e.doctype?e.doctype:n;return{parse:function(n){var u,d,f,m,p,g,h,v,b,y,C,w,x,k,T,E,S,N,A,R,_,I,B,P,D,O,M,L,F,j=0,H=[],U=0,W=Mo.decode,z=Ot.makeMap("src,href,data,background,formaction,poster,xlink:href"),q=/((java|vb)script|mhtml):/i,V=function(e){var t,n;for(t=H.length;t--&&H[t].name!==e;);if(t>=0){for(n=H.length-1;n>=t;n--)(e=H[n]).valid&&c(e.name);H.length=t}},$=function(t,n,r,o,i){var a,c;if(r=(n=n.toLowerCase())in C?n:W(r||o||i||""),x&&!v&&!1===Jg(n)){if(!(a=N[n])&&A){for(c=A.length;c--&&!(a=A[c]).pattern.test(n););-1===c&&(a=null)}if(!a)return;if(a.validValues&&!(r in a.validValues))return}if(z[n]&&!e.allow_script_urls){var s=r.replace(/[\s\u0000-\u001F]+/g,"");try{s=decodeURIComponent(s)}catch(e){s=unescape(s)}if(q.test(s))return;if(Xg(e,s))return}v&&(n in z||0===n.indexOf("on"))||(m.map[n]=r,m.push({name:n,value:r}))};for(D=new RegExp("<(?:(?:!--([\\w\\W]*?)--\x3e)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:!DOCTYPE([\\w\\W]*?)>)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)>)|(?:([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>))","g"),O=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g,y=t.getShortEndedElements(),P=e.self_closing_elements||t.getSelfClosingElements(),C=t.getBoolAttrs(),x=e.validate,b=e.remove_internals,F=e.fix_self_closing,M=t.getSpecialElements(),B=n+">";u=D.exec(B);){if(j<u.index&&i(W(n.substr(j,u.index-j))),d=u[6])":"===(d=d.toLowerCase()).charAt(0)&&(d=d.substr(1)),V(d);else if(d=u[7]){if(u.index+u[0].length>n.length){i(W(n.substr(u.index))),j=u.index+u[0].length;continue}if(":"===(d=d.toLowerCase()).charAt(0)&&(d=d.substr(1)),w=d in y,F&&P[d]&&H.length>0&&H[H.length-1].name===d&&V(d),!x||(k=t.getElementRule(d))){if(T=!0,x&&(N=k.attributes,A=k.attributePatterns),(S=u[8])?((v=-1!==S.indexOf("data-mce-type"))&&b&&(T=!1),(m=[]).map={},S.replace(O,$)):(m=[]).map={},x&&!v){if(R=k.attributesRequired,_=k.attributesDefault,I=k.attributesForced,k.removeEmptyAttrs&&!m.length&&(T=!1),I)for(p=I.length;p--;)h=(E=I[p]).name,"{$uid}"===(L=E.value)&&(L="mce_"+U++),m.map[h]=L,m.push({name:h,value:L});if(_)for(p=_.length;p--;)(h=(E=_[p]).name)in m.map||("{$uid}"===(L=E.value)&&(L="mce_"+U++),m.map[h]=L,m.push({name:h,value:L}));if(R){for(p=R.length;p--&&!(R[p]in m.map););-1===p&&(T=!1)}if(E=m.map["data-mce-bogus"]){if("all"===E){j=Yg(t,n,D.lastIndex),D.lastIndex=j;continue}T=!1}}T&&a(d,m,w)}else T=!1;if(f=M[d]){f.lastIndex=j=u.index+u[0].length,(u=f.exec(n))?(T&&(g=n.substr(j,u.index-j)),j=u.index+u[0].length):(g=n.substr(j),j=n.length),T&&(g.length>0&&i(g,!0),c(d)),D.lastIndex=j;continue}w||(S&&S.indexOf("/")===S.length-1?T&&c(d):H.push({name:d,valid:T}))}else(d=u[1])?(">"===d.charAt(0)&&(d=" "+d),e.allow_conditional_comments||"[if"!==d.substr(0,3).toLowerCase()||(d=" "+d),r(d)):(d=u[2])?o(Gg(d)):(d=u[3])?l(d):(d=u[4])&&s(d,u[5]);j=u.index+u[0].length}for(j<n.length&&i(W(n.substr(j))),p=H.length-1;p>=0;p--)(d=H[p]).valid&&c(d.name)}}}!function(e){e.findEndTag=Yg}(Qg||(Qg={}));var Zg=Qg,eh=function(e,t){var n,r,o,i,a,c=t,s=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g,l=e.schema;for(c=function(e,t){var n=new RegExp(["\\s?("+e.join("|")+')="[^"]+"'].join("|"),"gi");return t.replace(n,"")}(e.getTempAttrs(),c),a=l.getShortEndedElements();i=s.exec(c);)r=s.lastIndex,o=i[0].length,n=a[i[1]]?r:Zg.findEndTag(l,c,r),c=c.substring(0,r-o)+c.substring(n),s.lastIndex=r-o;return gi(c)},th={trimExternal:eh,trimInternal:eh},nh=0,rh=2,oh=1,ih=function(e,t){var n=e.length+t.length+2,r=new Array(n),o=new Array(n),i=function(n,r,o,a,s){var l=c(n,r,o,a);if(null===l||l.start===r&&l.diag===r-a||l.end===n&&l.diag===n-o)for(var u=n,d=o;u<r||d<a;)u<r&&d<a&&e[u]===t[d]?(s.push([0,e[u]]),++u,++d):r-n>a-o?(s.push([2,e[u]]),++u):(s.push([1,t[d]]),++d);else{i(n,l.start,o,l.start-l.diag,s);for(var f=l.start;f<l.end;++f)s.push([0,e[f]]);i(l.end,r,l.end-l.diag,a,s)}},a=function(n,r,o,i){for(var a=n;a-r<i&&a<o&&e[a]===t[a-r];)++a;return function(e,t,n){return{start:e,end:t,diag:n}}(n,a,r)},c=function(n,i,c,s){var l=i-n,u=s-c;if(0===l||0===u)return null;var d,f,m,p,g,h=l-u,v=u+l,b=(v%2==0?v:v+1)/2;for(r[1+b]=n,o[1+b]=i+1,d=0;d<=b;++d){for(f=-d;f<=d;f+=2){for(m=f+b,f===-d||f!==d&&r[m-1]<r[m+1]?r[m]=r[m+1]:r[m]=r[m-1]+1,g=(p=r[m])-n+c-f;p<i&&g<s&&e[p]===t[g];)r[m]=++p,++g;if(h%2!=0&&h-d<=f&&f<=h+d&&o[m-h]<=r[m])return a(o[m-h],f+n-c,i,s)}for(f=h-d;f<=h+d;f+=2){for(m=f+b-h,f===h-d||f!==h+d&&o[m+1]<=o[m-1]?o[m]=o[m+1]-1:o[m]=o[m-1],g=(p=o[m]-1)-n+c-f;p>=n&&g>=c&&e[p]===t[g];)o[m]=p--,g--;if(h%2==0&&-d<=f&&f<=d&&o[m]<=r[m+h])return a(o[m],f+n-c,i,s)}}},s=[];return i(0,e.length,0,t.length,s),s},ah=function(e){return xo.isElement(e)?e.outerHTML:xo.isText(e)?Mo.encodeRaw(e.data,!1):xo.isComment(e)?"\x3c!--"+e.data+"--\x3e":""},ch=function(e,t,n){var r=function(e){var t,n,r;for(r=document.createElement("div"),t=document.createDocumentFragment(),e&&(r.innerHTML=e);n=r.firstChild;)t.appendChild(n);return t}(t);if(e.hasChildNodes()&&n<e.childNodes.length){var o=e.childNodes[n];o.parentNode.insertBefore(r,o)}else e.appendChild(r)},sh=function(e){return _t.filter(_t.map(e.childNodes,ah),(function(e){return e.length>0}))},lh=function(e,t){var n=_t.map(t.childNodes,ah);return function(e,t){var n=0;_t.each(e,(function(e){e[0]===nh?n++:e[0]===oh?(ch(t,e[1],n),n++):e[0]===rh&&function(e,t){if(e.hasChildNodes()&&t<e.childNodes.length){var n=e.childNodes[t];n.parentNode.removeChild(n)}}(t,n)}))}(ih(n,e),t),t},uh=function(e,t){var n=(t||document).createElement("div");return n.innerHTML=e,Or.children(On.fromDom(n))},dh=function(e){return e.dom().innerHTML},fh=dh,mh=function(e,t){var n=Or.owner(e).dom(),r=On.fromDom(n.createDocumentFragment()),o=uh(t,n);wl(r,o),kl.empty(e),_c.append(e,r)},ph=zc(T.none()),gh=function(e){return{type:"fragmented",fragments:e,content:"",bookmark:null,beforeBookmark:null}},hh=function(e){return{type:"complete",fragments:null,content:e,bookmark:null,beforeBookmark:null}},vh=function(e){return"fragmented"===e.type?e.fragments.join(""):e.content},bh=function(e){var t=On.fromTag("body",ph.get().getOrThunk((function(){var e=document.implementation.createHTMLDocument("undo");return ph.set(T.some(e)),e})));return mh(t,vh(e)),H.each(rc(t,"*[data-mce-bogus]"),kl.unwrap),fh(t)},yh={createFragmentedLevel:gh,createCompleteLevel:hh,createFromEditor:function(e){var t,n,r;return t=sh(e.getBody()),-1!==(n=(r=H.bind(t,(function(t){var n=th.trimInternal(e.serializer,t);return n.length>0?[n]:[]}))).join("")).indexOf("</iframe>")?gh(r):hh(n)},applyToEditor:function(e,t,n){"fragmented"===t.type?lh(t.fragments,e.getBody()):e.setContent(t.content,{format:"raw"}),e.selection.moveToBookmark(n?t.beforeBookmark:t.bookmark)},isEq:function(e,t){return!(!e||!t)&&(!!function(e,t){return vh(e)===vh(t)}(e,t)||function(e,t){return bh(e)===bh(t)}(e,t))}};function Ch(e){var t,n,r=this,o=0,i=[],a=0,c=function(){return 0===a},s=function(e){c()&&(r.typing=e)},l=function(t){e.setDirty(t)},u=function(e){s(!1),r.add({},e)},d=function(){r.typing&&(s(!1),r.add())};return e.on("init",(function(){r.add()})),e.on("BeforeExecCommand",(function(e){var t=e.command;"Undo"!==t&&"Redo"!==t&&"mceRepaint"!==t&&(d(),r.beforeChange())})),e.on("ExecCommand",(function(e){var t=e.command;"Undo"!==t&&"Redo"!==t&&"mceRepaint"!==t&&u(e)})),e.on("ObjectResizeStart Cut",(function(){r.beforeChange()})),e.on("SaveContent ObjectResized blur",u),e.on("DragEnd",u),e.on("KeyUp",(function(t){var o=t.keyCode;t.isDefaultPrevented()||((o>=33&&o<=36||o>=37&&o<=40||45===o||t.ctrlKey)&&(u(),e.nodeChanged()),46!==o&&8!==o||e.nodeChanged(),n&&r.typing&&!1===yh.isEq(yh.createFromEditor(e),i[0])&&(!1===e.isDirty()&&(l(!0),e.fire("change",{level:i[0],lastLevel:null})),e.fire("TypingUndo"),n=!1,e.nodeChanged()))})),e.on("KeyDown",(function(e){var t=e.keyCode;if(!e.isDefaultPrevented())if(t>=33&&t<=36||t>=37&&t<=40||45===t)r.typing&&u(e);else{var o=e.ctrlKey&&!e.altKey||e.metaKey;!(t<16||t>20)||224===t||91===t||r.typing||o||(r.beforeChange(),s(!0),r.add({},e),n=!0)}})),e.on("MouseDown",(function(e){r.typing&&u(e)})),e.on("input",(function(e){e.inputType&&("insertReplacementText"===e.inputType||function(e){return"insertText"===e.inputType&&null===e.data}(e))&&u(e)})),e.addShortcut("meta+z","","Undo"),e.addShortcut("meta+y,meta+shift+z","","Redo"),e.on("AddUndo Undo Redo ClearUndos",(function(t){t.isDefaultPrevented()||e.nodeChanged()})),r={data:i,typing:!1,beforeChange:function(){c()&&(t=cl.getUndoBookmark(e.selection))},add:function(n,r){var a,s,u,d=e.settings;if(u=yh.createFromEditor(e),n=n||{},n=Ot.extend(n,u),!1===c()||e.removed)return null;if(s=i[o],e.fire("BeforeAddUndo",{level:n,lastLevel:s,originalEvent:r}).isDefaultPrevented())return null;if(s&&yh.isEq(s,n))return null;if(i[o]&&(i[o].beforeBookmark=t),d.custom_undo_redo_levels&&i.length>d.custom_undo_redo_levels){for(a=0;a<i.length-1;a++)i[a]=i[a+1];i.length--,o=i.length}n.bookmark=cl.getUndoBookmark(e.selection),o<i.length-1&&(i.length=o+1),i.push(n),o=i.length-1;var f={level:n,lastLevel:s,originalEvent:r};return e.fire("AddUndo",f),o>0&&(l(!0),e.fire("change",f)),n},undo:function(){var t;return r.typing&&(r.add(),r.typing=!1,s(!1)),o>0&&(t=i[--o],yh.applyToEditor(e,t,!0),l(!0),e.fire("undo",{level:t})),t},redo:function(){var t;return o<i.length-1&&(t=i[++o],yh.applyToEditor(e,t,!1),l(!0),e.fire("redo",{level:t})),t},clear:function(){i=[],o=0,r.typing=!1,r.data=i,e.fire("ClearUndos")},hasUndo:function(){return o>0||r.typing&&i[0]&&!yh.isEq(yh.createFromEditor(e),i[0])},hasRedo:function(){return o<i.length-1&&!r.typing},transact:function(e){return d(),r.beforeChange(),r.ignore(e),r.add()},ignore:function(e){try{a++,e()}finally{a--}},extra:function(t,n){var a,c;r.transact(t)&&(c=i[o].bookmark,a=i[o-1],yh.applyToEditor(e,a,!0),r.transact(n)&&(i[o-1].beforeBookmark=c))}}}var wh=function(e){return e&&/^(IMG)$/.test(e.nodeName)},xh=function(e){return e&&3===e.nodeType&&/^([\t \r\n]+|)$/.test(e.nodeValue)},kh=function(e,t,n){return"color"!==n&&"backgroundColor"!==n||(t=e.toHex(t)),"fontWeight"===n&&700===t&&(t="bold"),"fontFamily"===n&&(t=t.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),""+t},Th={isInlineBlock:wh,moveStart:function(e,t,n){var r,o,i,a=n.startOffset,c=n.startContainer;if((n.startContainer!==n.endContainer||!wh(n.startContainer.childNodes[n.startOffset]))&&1===c.nodeType)for(a<(i=c.childNodes).length?r=new Xr(c=i[a],e.getParent(c,e.isBlock)):(r=new Xr(c=i[i.length-1],e.getParent(c,e.isBlock))).next(!0),o=r.current();o;o=r.next())if(3===o.nodeType&&!xh(o))return n.setStart(o,0),void t.setRng(n)},getNonWhiteSpaceSibling:function(e,t,n){if(e)for(t=t?"nextSibling":"previousSibling",e=n?e:e[t];e;e=e[t])if(1===e.nodeType||!xh(e))return e},isTextBlock:function(e,t){return t.nodeType&&(t=t.nodeName),!!e.schema.getTextBlockElements()[t.toLowerCase()]},isValid:function(e,t,n){return e.schema.isValidChild(t,n)},isWhiteSpaceNode:xh,replaceVars:function(e,t){return"string"!=typeof e?e=e(t):t&&(e=e.replace(/%(\w+)/g,(function(e,n){return t[n]||e}))),e},isEq:function(e,t){return t=t||"",e=""+((e=e||"").nodeName||e),t=""+(t.nodeName||t),e.toLowerCase()===t.toLowerCase()},normalizeStyleValue:kh,getStyle:function(e,t,n){return kh(e,e.getStyle(t,n),n)},getTextDecoration:function(e,t){var n;return e.getParent(t,(function(t){return(n=e.getStyle(t,"text-decoration"))&&"none"!==n})),n},getParents:function(e,t,n){return e.getParents(t,n,e.getRoot())}},Eh=vl.isBookmarkNode,Sh=Th.getParents,Nh=Th.isWhiteSpaceNode,Ah=Th.isTextBlock,Rh=function(e,t){for(void 0===t&&(t=3===e.nodeType?e.length:e.childNodes.length);e&&e.hasChildNodes();)(e=e.childNodes[t])&&(t=3===e.nodeType?e.length:e.childNodes.length);return{node:e,offset:t}},_h=function(e){return"BR"===e.nodeName&&e.getAttribute("data-mce-bogus")&&!e.nextSibling},Ih=function(e,t){for(var n=t;n;){if(1===n.nodeType&&e.getContentEditable(n))return"false"===e.getContentEditable(n)?n:t;n=n.parentNode}return t},Bh=function(e,t,n,r){var o,i,a=n.nodeValue;return void 0===r&&(r=e?a.length:0),e?-1===(o=(o=a.lastIndexOf(" ",r))>(i=a.lastIndexOf(" ",r))?o:i)||t||o++:(o=a.indexOf(" ",r),i=a.indexOf(" ",r),o=-1!==o&&(-1===i||o<i)?o:i),o},Ph=function(e,t,n,r,o,i){var a,c,s,l;if(3===n.nodeType){if(-1!==(s=Bh(o,i,n,r)))return{container:n,offset:s};l=n}for(a=new Xr(n,e.getParent(n,e.isBlock)||t);c=a[o?"prev":"next"]();)if(3===c.nodeType){if(l=c,-1!==(s=Bh(o,i,c)))return{container:c,offset:s}}else if(e.isBlock(c))break;if(l)return{container:l,offset:r=o?0:l.length}},Dh=function(e,t,n,r,o){var i,a,c,s;for(3===r.nodeType&&0===r.nodeValue.length&&r[o]&&(r=r[o]),i=Sh(e,r),a=0;a<i.length;a++)for(c=0;c<t.length;c++)if(!("collapsed"in(s=t[c])&&s.collapsed!==n.collapsed)&&e.is(i[a],s.selector))return i[a];return r},Oh=function(e,t,n,r){var o,i=e.dom,a=i.getRoot();if(t[0].wrapper||(o=i.getParent(n,t[0].block,a)),!o){var c=i.getParent(n,"LI,TD,TH");o=i.getParent(3===n.nodeType?n.parentNode:n,(function(t){return t!==a&&Ah(e,t)}),c)}if(o&&t[0].wrapper&&(o=Sh(i,o,"ul,ol").reverse()[0]||o),!o)for(o=n;o[r]&&!i.isBlock(o[r])&&(o=o[r],!Th.isEq(o,"br")););return o||n},Mh=function(e,t,n,r,o,i,a){var c,s,l,u,d;if(c=s=a?n:o,u=a?"previousSibling":"nextSibling",d=e.getRoot(),3===c.nodeType&&!Nh(c)&&(a?r>0:i<c.nodeValue.length))return c;for(;;){if(!t[0].block_expand&&e.isBlock(s))return s;for(l=s[u];l;l=l[u])if(!Eh(l)&&!Nh(l)&&!_h(l))return s;if(s===d||s.parentNode===d){c=s;break}s=s.parentNode}return c},Lh=function(e,t,n,r){var o,i=t.startContainer,a=t.startOffset,c=t.endContainer,s=t.endOffset,l=e.dom;return 1===i.nodeType&&i.hasChildNodes()&&3===(i=Ji(i,a)).nodeType&&(a=0),1===c.nodeType&&c.hasChildNodes()&&3===(c=Ji(c,t.collapsed?s:s-1)).nodeType&&(s=c.nodeValue.length),i=Ih(l,i),c=Ih(l,c),(Eh(i.parentNode)||Eh(i))&&3===(i=(i=Eh(i)?i:i.parentNode).nextSibling||i).nodeType&&(a=0),(Eh(c.parentNode)||Eh(c))&&3===(c=(c=Eh(c)?c:c.parentNode).previousSibling||c).nodeType&&(s=c.length),n[0].inline&&(t.collapsed&&((o=Ph(l,e.getBody(),i,a,!0,r))&&(i=o.container,a=o.offset),(o=Ph(l,e.getBody(),c,s,!1,r))&&(c=o.container,s=o.offset)),c=r?c:function(e,t){var n=Rh(e,t);if(n.node){for(;n.node&&0===n.offset&&n.node.previousSibling;)n=Rh(n.node.previousSibling);n.node&&n.offset>0&&3===n.node.nodeType&&" "===n.node.nodeValue.charAt(n.offset-1)&&n.offset>1&&(e=n.node).splitText(n.offset-1)}return e}(c,s)),(n[0].inline||n[0].block_expand)&&(n[0].inline&&3===i.nodeType&&0!==a||(i=Mh(l,n,i,a,c,s,!0)),n[0].inline&&3===c.nodeType&&s!==c.nodeValue.length||(c=Mh(l,n,i,a,c,s,!1))),n[0].selector&&!1!==n[0].expand&&!n[0].inline&&(i=Dh(l,n,t,i,"previousSibling"),c=Dh(l,n,t,c,"nextSibling")),(n[0].block||n[0].selector)&&(i=Oh(e,n,i,"previousSibling"),c=Oh(e,n,c,"nextSibling"),n[0].block&&(l.isBlock(i)||(i=Mh(l,n,i,a,c,s,!0)),l.isBlock(c)||(c=Mh(l,n,i,a,c,s,!1)))),1===i.nodeType&&(a=l.nodeIndex(i),i=i.parentNode),1===c.nodeType&&(s=l.nodeIndex(c)+1,c=c.parentNode),{startContainer:i,startOffset:a,endContainer:c,endOffset:s}},Fh=Th.isEq,jh=function(e,t,n){var r=e.formatter.get(n);if(r)for(var o=0;o<r.length;o++)if(!1===r[o].inherit&&e.dom.is(t,r[o].selector))return!0;return!1},Hh=function(e,t,n,r){var o=e.dom.getRoot();return t!==o&&(t=e.dom.getParent(t,(function(t){return!!jh(e,t,n)||t.parentNode===o||!!zh(e,t,n,r,!0)})),zh(e,t,n,r))},Uh=function(e,t,n){return!!Fh(t,n.inline)||!!Fh(t,n.block)||(n.selector?1===t.nodeType&&e.is(t,n.selector):void 0)},Wh=function(e,t,n,r,o,i){var a,c,s,l=n[r];if(n.onmatch)return n.onmatch(t,n,r);if(l)if(void 0===l.length){for(a in l)if(l.hasOwnProperty(a)){if(c="attributes"===r?e.getAttrib(t,a):Th.getStyle(e,t,a),o&&!c&&!n.exact)return;if((!o||n.exact)&&!Fh(c,Th.normalizeStyleValue(e,Th.replaceVars(l[a],i),a)))return}}else for(s=0;s<l.length;s++)if("attributes"===r?e.getAttrib(t,l[s]):Th.getStyle(e,t,l[s]))return n;return n},zh=function(e,t,n,r,o){var i,a,c,s,l=e.formatter.get(n),u=e.dom;if(l&&t)for(a=0;a<l.length;a++)if(i=l[a],Uh(e.dom,t,i)&&Wh(u,t,i,"attributes",o,r)&&Wh(u,t,i,"styles",o,r)){if(s=i.classes)for(c=0;c<s.length;c++)if(!e.dom.hasClass(t,s[c]))return;return i}},qh={matchNode:zh,matchName:Uh,match:function(e,t,n,r){var o;return r?Hh(e,r,t,n):(r=e.selection.getNode(),!!Hh(e,r,t,n)||!((o=e.selection.getStart())===r||!Hh(e,o,t,n)))},matchAll:function(e,t,n){var r,o=[],i={};return r=e.selection.getStart(),e.dom.getParent(r,(function(r){var a,c;for(a=0;a<t.length;a++)c=t[a],!i[c]&&zh(e,r,c,n)&&(i[c]=!0,o.push(c))}),e.dom.getRoot()),o},canApply:function(e,t){var n,r,o,i,a,c=e.formatter.get(t),s=e.dom;if(c)for(n=e.selection.getStart(),r=Th.getParents(s,n),i=c.length-1;i>=0;i--){if(!(a=c[i].selector)||c[i].defaultBlock)return!0;for(o=r.length-1;o>=0;o--)if(s.is(r[o],a))return!0}return!1},matchesUnInheritedFormatSelector:jh},Vh=function(e,t){return e.splitText(t)},$h={split:function(e){var t=e.startContainer,n=e.startOffset,r=e.endContainer,o=e.endOffset;return t===r&&xo.isText(t)?n>0&&n<t.nodeValue.length&&(t=(r=Vh(t,n)).previousSibling,o>n?(t=r=Vh(r,o-=n).previousSibling,o=r.nodeValue.length,n=0):o=0):(xo.isText(t)&&n>0&&n<t.nodeValue.length&&(t=Vh(t,n),n=0),xo.isText(r)&&o>0&&o<r.nodeValue.length&&(o=(r=Vh(r,o).previousSibling).nodeValue.length)),{startContainer:t,startOffset:n,endContainer:r,endOffset:o}}},Kh=pi,Jh=function(e){return function(e){for(var t=[];e;){if(3===e.nodeType&&e.nodeValue!==Kh||e.childNodes.length>1)return[];1===e.nodeType&&t.push(e),e=e.firstChild}return t}(e).length>0},Gh=function(e){var t;if(e)for(e=(t=new Xr(e,e)).current();e;e=t.next())if(3===e.nodeType)return e;return null},Xh=function(e){var t=On.fromTag("span");return rr.setAll(t,{id:"_mce_caret","data-mce-bogus":"1","data-mce-type":"format-caret"}),e&&_c.append(t,On.fromText(Kh)),t},Yh=function(e,t,n,r){var o,i,a;o=t.getRng(!0),i=e.getParent(n,e.isBlock),Jh(n)?(!1!==r&&(o.setStartBefore(n),o.setEndBefore(n)),e.remove(n)):(a=function(e){var t=Gh(e);return t&&t.nodeValue.charAt(0)===Kh&&t.deleteData(0,1),t}(n),o.startContainer===a&&o.startOffset>0&&o.setStart(a,o.startOffset-1),o.endContainer===a&&o.endOffset>0&&o.setEnd(a,o.endOffset-1),e.remove(n,!0)),i&&e.isEmpty(i)&&Nl(On.fromDom(i)),t.setRng(o)},Qh=function(e,t,n,r,o){if(r)Yh(t,n,r,o);else if(!(r=ll(e,n.getStart())))for(;r=t.get("_mce_caret");)Yh(t,n,r,!1)},Zh=function(e,t,n){var r=e.dom,o=r.getParent(n,Zi.curry(Th.isTextBlock,e));o&&r.isEmpty(o)?n.parentNode.replaceChild(t,n):(Sl(On.fromDom(n)),r.isEmpty(n)?n.parentNode.replaceChild(t,n):r.insertAfter(t,n))},ev=function(e,t){return e.appendChild(t),t},tv=function(e,t){var n=H.foldr(e,(function(e,t){return ev(e,t.cloneNode(!1))}),t);return ev(n,n.ownerDocument.createTextNode(Kh))},nv=function(e){var t=e.dom,n=e.selection,r=e.getBody();e.on("mouseup keydown",(function(e){!function(e,t,n,r){Qh(e,t,n,null,!1),8===r&&n.isCollapsed()&&n.getStart().innerHTML===Kh&&Qh(e,t,n,ll(e,n.getStart())),37!==r&&39!==r||Qh(e,t,n,ll(e,n.getStart()))}(r,t,n,e.keyCode)}))},rv=function(e,t){return e.schema.getTextInlineElements().hasOwnProperty($n.name(t))&&!sl(t.dom())&&!xo.isBogus(t.dom())},ov={},iv=_t.filter,av=_t.each;!function(e,t){var n=ov[e];n||(ov[e]=n=[]),ov[e].push(t)}("pre",(function(e){var t,n,r=e.selection.getRng();t=xo.matchNodeNames("pre"),r.collapsed||(n=e.selection.getSelectedBlocks(),av(iv(iv(n,t),(function(e){return t(e.previousSibling)&&-1!==_t.indexOf(n,e.previousSibling)})),(function(e){var t,n;t=e.previousSibling,en(n=e).remove(),en(t).append("<br><br>").append(n.childNodes)})))}));var cv=function(e,t){av(ov[e],(function(e){e(t)}))},sv=Ot.each,lv={walk:function(e,t,n){var r,o,i,a,c,s,l,u=t.startContainer,d=t.startOffset,f=t.endContainer,m=t.endOffset;if((l=e.select("td[data-mce-selected],th[data-mce-selected]")).length>0)sv(l,(function(e){n([e])}));else{var p,g,h,v=function(e){var t;return 3===(t=e[0]).nodeType&&t===u&&d>=t.nodeValue.length&&e.splice(0,1),t=e[e.length-1],0===m&&e.length>0&&t===f&&3===t.nodeType&&e.splice(e.length-1,1),e},b=function(e,t,n){for(var r=[];e&&e!==n;e=e[t])r.push(e);return r},y=function(e,t){do{if(e.parentNode===t)return e;e=e.parentNode}while(e)},C=function(e,t,r){var o=r?"nextSibling":"previousSibling";for(c=(a=e).parentNode;a&&a!==t;a=c)c=a.parentNode,(s=b(a===e?a:a[o],o)).length&&(r||s.reverse(),n(v(s)))};if(1===u.nodeType&&u.hasChildNodes()&&(u=u.childNodes[d]),1===f.nodeType&&f.hasChildNodes()&&(g=m,h=(p=f).childNodes,--g>h.length-1?g=h.length-1:g<0&&(g=0),f=h[g]||p),u===f)return n(v([u]));for(r=e.findCommonAncestor(u,f),a=u;a;a=a.parentNode){if(a===f)return C(u,r,!0);if(a===r)break}for(a=f;a;a=a.parentNode){if(a===u)return C(f,r);if(a===r)break}o=y(u,r)||u,i=y(f,r)||f,C(u,o,!0),(s=b(o===u?o:o.nextSibling,"nextSibling",i===f?i.nextSibling:i)).length&&n(v(s)),C(f,i)}}},uv=/^(src|href|style)$/,dv=Ot.each,fv=Th.isEq,mv=function(e){return/^(TH|TD)$/.test(e.nodeName)},pv=function(e,t,n){var r,o,i;return r=t[n?"startContainer":"endContainer"],o=t[n?"startOffset":"endOffset"],xo.isElement(r)&&(i=r.childNodes.length-1,!n&&o&&o--,r=r.childNodes[o>i?i:o]),xo.isText(r)&&n&&o>=r.nodeValue.length&&(r=new Xr(r,e.getBody()).next()||r),xo.isText(r)&&!n&&0===o&&(r=new Xr(r,e.getBody()).prev()||r),r},gv=function(e,t,n,r){var o=e.create(n,r);return t.parentNode.insertBefore(o,t),o.appendChild(t),o},hv=function(e,t,n,r){return!(t=Th.getNonWhiteSpaceSibling(t,n,r))||"BR"===t.nodeName||e.isBlock(t)},vv=function(e,t,n,r,o){var i,a,c,s=e.dom;if(!function(e,t,n){return!!fv(t,n.inline)||!!fv(t,n.block)||(n.selector?xo.isElement(t)&&e.is(t,n.selector):void 0)}(s,r,t)&&!function(e,t){return t.links&&"A"===e.tagName}(r,t))return!1;if("all"!==t.remove)for(dv(t.styles,(function(e,i){e=Th.normalizeStyleValue(s,Th.replaceVars(e,n),i),"number"==typeof i&&(i=e,o=0),(t.remove_similar||!o||fv(Th.getStyle(s,o,i),e))&&s.setStyle(r,i,""),c=1})),c&&""===s.getAttrib(r,"style")&&(r.removeAttribute("style"),r.removeAttribute("data-mce-style")),dv(t.attributes,(function(e,t){var i;if(e=Th.replaceVars(e,n),"number"==typeof t&&(t=e,o=0),!o||fv(s.getAttrib(o,t),e)){if("class"===t&&(e=s.getAttrib(r,t))&&(i="",dv(e.split(/\s+/),(function(e){/mce\-\w+/.test(e)&&(i+=(i?" ":"")+e)})),i))return void s.setAttrib(r,t,i);"class"===t&&r.removeAttribute("className"),uv.test(t)&&r.removeAttribute("data-mce-"+t),r.removeAttribute(t)}})),dv(t.classes,(function(e){e=Th.replaceVars(e,n),o&&!s.hasClass(o,e)||s.removeClass(r,e)})),a=s.getAttribs(r),i=0;i<a.length;i++){var l=a[i].nodeName;if(0!==l.indexOf("_")&&0!==l.indexOf("data-"))return!1}return"none"!==t.remove?(function(e,t,n){var r,o=t.parentNode,i=e.dom,a=e.settings.forced_root_block;n.block&&(a?o===i.getRoot()&&(n.list_block&&fv(t,n.list_block)||dv(Ot.grep(t.childNodes),(function(t){Th.isValid(e,a,t.nodeName.toLowerCase())?r?r.appendChild(t):(r=gv(i,t,a),i.setAttribs(r,e.settings.forced_root_block_attrs)):r=0}))):i.isBlock(t)&&!i.isBlock(o)&&(hv(i,t,!1)||hv(i,t.firstChild,!0,1)||t.insertBefore(i.create("br"),t.firstChild),hv(i,t,!0)||hv(i,t.lastChild,!1,1)||t.appendChild(i.create("br")))),n.selector&&n.inline&&!fv(n.inline,t)||i.remove(t,1)}(e,r,t),!0):void 0},bv={removeFormat:vv,remove:function(e,t,n,r,o){var i,a,c=e.formatter.get(t),s=c[0],l=!0,u=e.dom,d=e.selection,f=function(r){var i=function(e,t,n,r,o){var i;return dv(Th.getParents(e.dom,t.parentNode).reverse(),(function(t){var a;i||"_start"===t.id||"_end"===t.id||(a=qh.matchNode(e,t,n,r,o))&&!1!==a.split&&(i=t)})),i}(e,r,t,n,o);return function(e,t,n,r,o,i,a,c){var s,l,u,d,f,m,p=e.dom;if(n){for(m=n.parentNode,s=r.parentNode;s&&s!==m;s=s.parentNode){for(l=p.clone(s,!1),f=0;f<t.length;f++)if(vv(e,t[f],c,l,l)){l=0;break}l&&(u&&l.appendChild(u),d||(d=l),u=l)}!i||a.mixed&&p.isBlock(n)||(r=p.split(n,r)),u&&(o.parentNode.insertBefore(u,o),d.appendChild(o))}return r}(e,c,i,r,r,!0,s,n)},m=function(t){var r,o,i,a,d;if(xo.isElement(t)&&u.getContentEditable(t)&&(a=l,l="true"===u.getContentEditable(t),d=!0),r=Ot.grep(t.childNodes),l&&!d)for(o=0,i=c.length;o<i&&!vv(e,c[o],n,t,t);o++);if(s.deep&&r.length){for(o=0,i=r.length;o<i;o++)m(r[o]);d&&(l=a)}},p=function(e){var t=u.get(e?"_start":"_end"),n=t[e?"firstChild":"lastChild"];return vl.isBookmarkNode(n)&&(n=n[e?"firstChild":"lastChild"]),xo.isText(n)&&0===n.data.length&&(n=e?t.previousSibling||t.nextSibling:t.nextSibling||t.previousSibling),u.remove(t,!0),n},g=function(t){var n,r,o=t.commonAncestorContainer;if(t=Lh(e,t,c,!0),s.split){if((n=pv(e,t,!0))!==(r=pv(e,t))){if(/^(TR|TH|TD)$/.test(n.nodeName)&&n.firstChild&&(n="TR"===n.nodeName?n.firstChild.firstChild||n:n.firstChild||n),o&&/^T(HEAD|BODY|FOOT|R)$/.test(o.nodeName)&&mv(r)&&r.firstChild&&(r=r.firstChild||r),u.isChildOf(n,r)&&n!==r&&!u.isBlock(r)&&!mv(n)&&!mv(r))return n=gv(u,n,"span",{id:"_start","data-mce-type":"bookmark"}),f(n),void(n=p(!0));n=gv(u,n,"span",{id:"_start","data-mce-type":"bookmark"}),r=gv(u,r,"span",{id:"_end","data-mce-type":"bookmark"}),f(n),f(r),n=p(!0),r=p()}else n=r=f(n);t.startContainer=n.parentNode?n.parentNode:n,t.startOffset=u.nodeIndex(n),t.endContainer=r.parentNode?r.parentNode:r,t.endOffset=u.nodeIndex(r)+1}lv.walk(u,t,(function(t){dv(t,(function(t){m(t),xo.isElement(t)&&"underline"===e.dom.getStyle(t,"text-decoration")&&t.parentNode&&"underline"===Th.getTextDecoration(u,t.parentNode)&&vv(e,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:"underline"}},null,t)}))}))};if(r)r.nodeType?((a=u.createRng()).setStartBefore(r),a.setEndAfter(r),g(a)):g(r);else if("false"!==u.getContentEditable(d.getNode()))d.isCollapsed()&&s.inline&&!u.select("td[data-mce-selected],th[data-mce-selected]").length?function(e,t,n,r){var o,i,a,c,s,l,u,d=e.dom,f=e.selection,m=[],p=f.getRng();for(o=p.startContainer,i=p.startOffset,s=o,3===o.nodeType&&(i!==o.nodeValue.length&&(c=!0),s=s.parentNode);s;){if(qh.matchNode(e,s,t,n,r)){l=s;break}s.nextSibling&&(c=!0),m.push(s),s=s.parentNode}if(l)if(c){a=f.getBookmark(),p.collapse(!0);var g=Lh(e,p,e.formatter.get(t),!0);g=$h.split(g),e.formatter.remove(t,n,g),f.moveToBookmark(a)}else{u=ll(e.getBody(),l);var h=Xh(!1).dom(),v=tv(m,h);Zh(e,h,u||l),Yh(d,f,u,!1),f.setCursorLocation(v,1),d.isEmpty(l)&&d.remove(l)}}(e,t,n,o):(i=cl.getPersistentBookmark(e.selection,!0),g(d.getRng()),d.moveToBookmark(i),s.inline&&qh.match(e,t,n,d.getStart())&&Th.moveStart(u,d,d.getRng()),e.nodeChanged());else{r=d.getNode();for(var h=0,v=c.length;h<v&&(!c[h].ceFalseOverride||!vv(e,c[h],n,r,r));h++);}}},yv=Ot.each,Cv=function(e){return e&&1===e.nodeType&&!vl.isBookmarkNode(e)&&!sl(e)&&!xo.isBogus(e)},wv=function(e,t){var n;for(n=e;n;n=n[t]){if(3===n.nodeType&&0!==n.nodeValue.length)return e;if(1===n.nodeType&&!vl.isBookmarkNode(n))return n}return e},xv=function(e,t,n){var r,o,i=new yl(e);if(t&&n&&(t=wv(t,"previousSibling"),n=wv(n,"nextSibling"),i.compare(t,n))){for(r=t.nextSibling;r&&r!==n;)o=r,r=r.nextSibling,t.appendChild(o);return e.remove(n),Ot.each(Ot.grep(n.childNodes),(function(e){t.appendChild(e)})),t}return n},kv=function(e,t,n){yv(e.childNodes,(function(e){Cv(e)&&(t(e)&&n(e),e.hasChildNodes()&&kv(e,t,n))}))},Tv=function(e,t){return b.curry((function(t,n){return!(!n||!Th.getStyle(e,n,t))}),t)},Ev=function(e,t,n){return b.curry((function(t,n,r){e.setStyle(r,t,n),""===r.getAttribute("style")&&r.removeAttribute("style"),Sv(e,r)}),t,n)},Sv=function(e,t){"SPAN"===t.nodeName&&0===e.getAttribs(t).length&&e.remove(t,!0)},Nv=function(e,t){var n;1===t.nodeType&&t.parentNode&&1===t.parentNode.nodeType&&(n=Th.getTextDecoration(e,t.parentNode),e.getStyle(t,"color")&&n?e.setStyle(t,"text-decoration",n):e.getStyle(t,"text-decoration")===n&&e.setStyle(t,"text-decoration",null))},Av=function(e,t,n,r){yv(t,(function(t){yv(e.dom.select(t.inline,r),(function(r){Cv(r)&&bv.removeFormat(e,t,n,r,t.exact?r:null)})),function(e,t,n){if(t.clear_child_styles){var r=t.links?"*:not(a)":"*";yv(e.select(r,n),(function(n){Cv(n)&&yv(t.styles,(function(t,r){e.setStyle(n,r,"")}))}))}}(e.dom,t,r)}))},Rv=function(e,t,n,r){(t.styles.color||t.styles.textDecoration)&&(Ot.walk(r,b.curry(Nv,e),"childNodes"),Nv(e,r))},_v=function(e,t,n,r){t.styles&&t.styles.backgroundColor&&kv(r,Tv(e,"fontSize"),Ev(e,"backgroundColor",Th.replaceVars(t.styles.backgroundColor,n)))},Iv=function(e,t,n,r){"sub"!==t.inline&&"sup"!==t.inline||(kv(r,Tv(e,"fontSize"),Ev(e,"fontSize","")),e.remove(e.select("sup"===t.inline?"sub":"sup",r),!0))},Bv=function(e,t,n,r){r&&!1!==t.merge_siblings&&(r=xv(e,Th.getNonWhiteSpaceSibling(r),r),r=xv(e,r,Th.getNonWhiteSpaceSibling(r,!0)))},Pv=function(e,t,n,r,o){qh.matchNode(e,o.parentNode,n,r)&&bv.removeFormat(e,t,r,o)||t.merge_with_parents&&e.dom.getParent(o.parentNode,(function(i){if(qh.matchNode(e,i,n,r))return bv.removeFormat(e,t,r,o),!0}))},Dv=Ot.each,Ov=function(e,t,n,r){var o,i,a=e.formatter.get(t),c=a[0],s=!r&&e.selection.isCollapsed(),l=e.dom,u=e.selection,d=function(e,t){if(t=t||c,e){if(t.onformat&&t.onformat(e,t,n,r),Dv(t.styles,(function(t,r){l.setStyle(e,r,Th.replaceVars(t,n))})),t.styles){var o=l.getAttrib(e,"style");o&&e.setAttribute("data-mce-style",o)}Dv(t.attributes,(function(t,r){l.setAttrib(e,r,Th.replaceVars(t,n))})),Dv(t.classes,(function(t){t=Th.replaceVars(t,n),l.hasClass(e,t)||l.addClass(e,t)}))}},f=function(e,t){var n=!1;return!!c.selector&&(Dv(e,(function(e){if(!("collapsed"in e&&e.collapsed!==s))return l.is(t,e.selector)&&!sl(t)?(d(t,e),n=!0,!1):void 0})),n)},m=function(r,o,i,s){var l,u,m=[],p=!0;l=c.inline||c.block,u=r.create(l),d(u),lv.walk(r,o,(function(o){var i,g=function(o){var h,v,b,y;if(y=p,h=o.nodeName.toLowerCase(),v=o.parentNode.nodeName.toLowerCase(),1===o.nodeType&&r.getContentEditable(o)&&(y=p,p="true"===r.getContentEditable(o),b=!0),Th.isEq(h,"br"))return i=0,void(c.block&&r.remove(o));if(c.wrapper&&qh.matchNode(e,o,t,n))i=0;else{if(p&&!b&&c.block&&!c.wrapper&&Th.isTextBlock(e,h)&&Th.isValid(e,v,l))return o=r.rename(o,l),d(o),m.push(o),void(i=0);if(c.selector){var C=f(a,o);if(!c.inline||C)return void(i=0)}!p||b||!Th.isValid(e,l,h)||!Th.isValid(e,v,l)||!s&&3===o.nodeType&&1===o.nodeValue.length&&65279===o.nodeValue.charCodeAt(0)||sl(o)||c.inline&&r.isBlock(o)?(i=0,Dv(Ot.grep(o.childNodes),g),b&&(p=y),i=0):(i||(i=r.clone(u,!1),o.parentNode.insertBefore(i,o),m.push(i)),i.appendChild(o))}};Dv(o,g)})),!0===c.links&&Dv(m,(function(e){var t=function(e){"A"===e.nodeName&&d(e,c),Dv(Ot.grep(e.childNodes),t)};t(e)})),Dv(m,(function(o){var i,s=function(e){var t=!1;return Dv(e.childNodes,(function(e){if(function(e){return e&&1===e.nodeType&&!vl.isBookmarkNode(e)&&!sl(e)&&!xo.isBogus(e)}(e))return t=e,!1})),t};i=function(e){var t=0;return Dv(e.childNodes,(function(e){Th.isWhiteSpaceNode(e)||vl.isBookmarkNode(e)||t++})),t}(o),!(m.length>1)&&r.isBlock(o)||0!==i?(c.inline||c.wrapper)&&(c.exact||1!==i||(o=function(e){var t,n;return(t=s(e))&&!vl.isBookmarkNode(t)&&qh.matchName(r,t,c)&&(n=r.clone(t,!1),d(n),r.replace(n,e,!0),r.remove(t,1)),n||e}(o)),Av(e,a,n,o),Pv(e,c,t,n,o),_v(r,c,n,o),Iv(r,c,n,o),Bv(r,c,n,o)):r.remove(o,1)}))};if("false"!==l.getContentEditable(u.getNode())){if(c){if(r)r.nodeType?f(a,r)||((i=l.createRng()).setStartBefore(r),i.setEndAfter(r),m(l,Lh(e,i,a),0,!0)):m(l,r,0,!0);else if(s&&c.inline&&!l.select("td[data-mce-selected],th[data-mce-selected]").length)!function(e,t,n){var r,o,i,a,c,s,l=e.selection;a=(r=l.getRng(!0)).startOffset,s=r.startContainer.nodeValue,(o=ll(e.getBody(),l.getStart()))&&(i=Gh(o));var u=/[^\s\u00a0\u00ad\u200b\ufeff]/;s&&a>0&&a<s.length&&u.test(s.charAt(a))&&u.test(s.charAt(a-1))?(c=l.getBookmark(),r.collapse(!0),r=Lh(e,r,e.formatter.get(t)),r=$h.split(r),e.formatter.apply(t,n,r),l.moveToBookmark(c)):(o&&i.nodeValue===Kh?e.formatter.apply(t,n,o):(i=(o=function(e,t){return e.importNode(t,!0)}(e.getDoc(),Xh(!0).dom())).firstChild,r.insertNode(o),a=1,e.formatter.apply(t,n,o)),l.setCursorLocation(i,a))}(e,t,n);else{var p=e.selection.getNode();e.settings.forced_root_block||!a[0].defaultBlock||l.getParent(p,l.isBlock)||Ov(e,a[0].defaultBlock),e.selection.setRng(Pl(e.selection.getRng())),o=cl.getPersistentBookmark(e.selection,!0),m(l,Lh(e,u.getRng(),a)),c.styles&&Rv(l,c,n,p),u.moveToBookmark(o),Th.moveStart(l,u,u.getRng()),e.nodeChanged()}cv(t,e)}}else{r=u.getNode();for(var g=0,h=a.length;g<h;g++)if(a[g].ceFalseOverride&&l.is(r,a[g].selector))return void d(r,a[g])}},Mv={applyFormat:Ov},Lv=Ot.each,Fv={formatChanged:function(e,t,n,r,o){null===t.get()&&function(e,t){var n={};e.set({}),t.on("NodeChange",(function(r){var o=Th.getParents(t.dom,r.element),i={};o=Ot.grep(o,(function(e){return 1===e.nodeType&&!e.getAttribute("data-mce-bogus")})),Lv(e.get(),(function(e,r){Lv(o,(function(a){return t.formatter.matchNode(a,r,{},e.similar)?(n[r]||(Lv(e,(function(e){e(!0,{node:a,format:r,parents:o})})),n[r]=e),i[r]=e,!1):!qh.matchesUnInheritedFormatSelector(t,a,r)&&void 0}))})),Lv(n,(function(e,t){i[t]||(delete n[t],Lv(e,(function(e){e(!1,{node:r.element,format:t,parents:o})})))}))}))}(t,e),function(e,t,n,r){var o=e.get();Lv(t.split(","),(function(e){o[e]||(o[e]=[],o[e].similar=r),o[e].push(n)})),e.set(o)}(t,n,r,o)}},jv={get:function(e){var t={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"left"},inherit:!1,preview:!1,defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size",defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"justify"},inherit:!1,defaultBlock:"div",preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all"},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all"}],italic:[{inline:"em",remove:"all"},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all"}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all"}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:!0},{inline:"strike",remove:"all"}],forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:1,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:function(){return!0},onformat:function(t,n,r){Ot.each(r,(function(n,r){e.setAttrib(t,r,n)}))}},removeformat:[{selector:"b,strong,em,i,font,u,strike,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return Ot.each("p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp".split(/\s/),(function(e){t[e]={block:e,remove:"all"}})),t}},Hv=Ot.each,Uv=ii.DOM,Wv=function(e,t){var n,r,o,i=t&&t.schema||Ko({}),a=function(e){var t;return r="string"==typeof e?{name:e,classes:[],attrs:{}}:e,function(e,t){t.classes.length&&Uv.addClass(e,t.classes.join(" ")),Uv.setAttribs(e,t.attrs)}(t=Uv.create(r.name),r),t},c=function(e,t,n){var r,o,s,l=t.length>0&&t[0],u=l&&l.name;if(s=function(e,t){var n="string"!=typeof e?e.nodeName.toLowerCase():e,r=i.getElementRule(n),o=r&&r.parentsRequired;return!(!o||!o.length)&&(t&&-1!==Ot.inArray(o,t)?t:o[0])}(e,u))u===s?(o=t[0],t=t.slice(1)):o=s;else if(l)o=t[0],t=t.slice(1);else if(!n)return e;return o&&(r=a(o)).appendChild(e),n&&(r||(r=Uv.create("div")).appendChild(e),Ot.each(n,(function(t){var n=a(t);r.insertBefore(n,e)}))),c(r,t,o&&o.siblings)};return e&&e.length?(r=e[0],n=a(r),(o=Uv.create("div")).appendChild(c(n,e.slice(1),r.siblings)),o):""},zv=function(e){var t,n={classes:[],attrs:{}};return"*"!==(e=n.selector=Ot.trim(e))&&(t=e.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,(function(e,t,r,o,i){switch(t){case"#":n.attrs.id=r;break;case".":n.classes.push(r);break;case":":-1!==Ot.inArray("checked disabled enabled read-only required".split(" "),r)&&(n.attrs[r]=r)}if("["===o){var a=i.match(/([\w\-]+)(?:\=\"([^\"]+))?/);a&&(n.attrs[a[1]]=a[2])}return""}))),n.name=t||"div",n},qv=function(e){return e&&"string"==typeof e?(e=(e=e.split(/\s*,\s*/)[0]).replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),Ot.map(e.split(/(?:>|\s+(?![^\[\]]+\]))/),(function(e){var t=Ot.map(e.split(/(?:~\+|~|\+)/),zv),n=t.pop();return t.length&&(n.siblings=t),n})).reverse()):[]},Vv={getCssText:function(e,t){var n,r,o,i,a,c,s="";if(!1===(c=e.settings.preview_styles))return"";"string"!=typeof c&&(c="font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow");var l=function(e){return e.replace(/%(\w+)/g,"")};if("string"==typeof t){if(!(t=e.formatter.get(t)))return;t=t[0]}return"preview"in t&&!1===(c=t.preview)?"":(n=t.block||t.inline||"span",(i=qv(t.selector)).length?(i[0].name||(i[0].name=n),n=t.selector,r=Wv(i,e)):r=Wv([n],e),o=Uv.select(n,r)[0]||r.firstChild,Hv(t.styles,(function(e,t){(e=l(e))&&Uv.setStyle(o,t,e)})),Hv(t.attributes,(function(e,t){(e=l(e))&&Uv.setAttrib(o,t,e)})),Hv(t.classes,(function(e){e=l(e),Uv.hasClass(o,e)||Uv.addClass(o,e)})),e.fire("PreviewFormats"),Uv.setStyles(r,{position:"absolute",left:-65535}),e.getBody().appendChild(r),a=Uv.getStyle(e.getBody(),"fontSize",!0),a=/px$/.test(a)?parseInt(a,10):0,Hv(c.split(" "),(function(t){var n=Uv.getStyle(o,t,!0);if(!("background-color"===t&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(n)&&(n=Uv.getStyle(e.getBody(),t,!0),"#ffffff"===Uv.toHex(n).toLowerCase())||"color"===t&&"#000000"===Uv.toHex(n).toLowerCase())){if("font-size"===t&&/em|%$/.test(n)){if(0===a)return;n=parseFloat(n)/(/%$/.test(n)?100:1)*a+"px"}"border"===t&&n&&(s+="padding:0 2px;"),s+=t+":"+n+";"}})),e.fire("AfterPreviewFormats"),Uv.remove(r),s)},parseSelector:qv,selectorToHtml:function(e,t){return Wv(qv(e),t)}},$v={toggle:function(e,t,n,r,o){var i=t.get(n);!qh.match(e,n,r,o)||"toggle"in i[0]&&!i[0].toggle?Mv.applyFormat(e,n,r,o):bv.remove(e,n,r,o)}},Kv={setup:function(e){e.addShortcut("meta+b","","Bold"),e.addShortcut("meta+i","","Italic"),e.addShortcut("meta+u","","Underline");for(var t=1;t<=6;t++)e.addShortcut("access+"+t,"",["FormatBlock",!1,"h"+t]);e.addShortcut("access+7","",["FormatBlock",!1,"p"]),e.addShortcut("access+8","",["FormatBlock",!1,"div"]),e.addShortcut("access+9","",["FormatBlock",!1,"address"])}};function Jv(e){var t=function(e){var t={},n=function(e,r){e&&("string"!=typeof e?Ot.each(e,(function(e,t){n(t,e)})):(r=r.length?r:[r],Ot.each(r,(function(e){void 0===e.deep&&(e.deep=!e.selector),void 0===e.split&&(e.split=!e.selector||e.inline),void 0===e.remove&&e.selector&&!e.inline&&(e.remove="none"),e.selector&&e.inline&&(e.mixed=!0,e.block_expand=!0),"string"==typeof e.classes&&(e.classes=e.classes.split(/\s+/))})),t[e]=r))};return n(jv.get(e.dom)),n(e.settings.formats),{get:function(e){return e?t[e]:t},register:n,unregister:function(e){return e&&t[e]&&delete t[e],t}}}(e),n=zc(null);return Kv.setup(e),nv(e),{get:t.get,register:t.register,unregister:t.unregister,apply:b.curry(Mv.applyFormat,e),remove:b.curry(bv.remove,e),toggle:b.curry($v.toggle,e,t),match:b.curry(qh.match,e),matchAll:b.curry(qh.matchAll,e),matchNode:b.curry(qh.matchNode,e),canApply:b.curry(qh.canApply,e),formatChanged:b.curry(Fv.formatChanged,e,n),getCssText:b.curry(Vv.getCssText,e)}}var Gv=function(e){return function(){for(var t=new Array(arguments.length),n=0;n<t.length;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<t.length;o++){var i=t[o];for(var a in i)i.hasOwnProperty(a)&&(r[a]=e(r[a],i[a]))}return r}},Xv=Gv((function(e,t){return S.isObject(e)&&S.isObject(t)?Xv(e,t):t})),Yv=Gv((function(e,t){return t})),Qv={deepMerge:Xv,merge:Yv},Zv={register:function(e,t,n){e.addAttributeFilter("data-mce-tabindex",(function(e,t){for(var n,r=e.length;r--;)(n=e[r]).attr("tabindex",n.attributes.map["data-mce-tabindex"]),n.attr(t,null)})),e.addAttributeFilter("src,href,style",(function(e,r){for(var o,i,a=e.length,c="data-mce-"+r,s=t.url_converter,l=t.url_converter_scope;a--;)void 0!==(i=(o=e[a]).attributes.map[c])?(o.attr(r,i.length>0?i:null),o.attr(c,null)):(i=o.attributes.map[r],"style"===r?i=n.serializeStyle(n.parseStyle(i),o.name):s&&(i=s.call(l,i,r,o.name)),o.attr(r,i.length>0?i:null))})),e.addAttributeFilter("class",(function(e){for(var t,n,r=e.length;r--;)(n=(t=e[r]).attr("class"))&&(n=t.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),t.attr("class",n.length>0?n:null))})),e.addAttributeFilter("data-mce-type",(function(e,t,n){for(var r,o=e.length;o--;)"bookmark"!==(r=e[o]).attributes.map["data-mce-type"]||n.cleanup||r.remove()})),e.addNodeFilter("noscript",(function(e){for(var t,n=e.length;n--;)(t=e[n].firstChild)&&(t.value=Mo.decode(t.value))})),e.addNodeFilter("script,style",(function(e,n){for(var r,o,i,a=e.length,c=function(e){return e.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")};a--;)o=(r=e[a]).firstChild?r.firstChild.value:"","script"===n?((i=r.attr("type"))&&r.attr("type","mce-no/type"===i?null:i.replace(/^mce\-/,"")),"xhtml"===t.element_format&&o.length>0&&(r.firstChild.value="// <![CDATA[\n"+c(o)+"\n// ]]>")):"xhtml"===t.element_format&&o.length>0&&(r.firstChild.value="\x3c!--\n"+c(o)+"\n--\x3e")})),e.addNodeFilter("#comment",(function(e){for(var t,n=e.length;n--;)0===(t=e[n]).value.indexOf("[CDATA[")?(t.name="#cdata",t.type=4,t.value=t.value.replace(/^\[CDATA\[|\]\]$/g,"")):0===t.value.indexOf("mce:protected ")&&(t.name="#text",t.type=3,t.raw=!0,t.value=unescape(t.value).substr(14))})),e.addNodeFilter("xml:namespace,input",(function(e,t){for(var n,r=e.length;r--;)7===(n=e[r]).type?n.remove():1===n.type&&("input"!==t||"type"in n.attributes.map||n.attr("type","text"))})),e.addAttributeFilter("data-mce-type",(function(t){H.each(t,(function(t){"format-caret"===t.attr("data-mce-type")&&(t.isEmpty(e.schema.getNonEmptyElements())?t.remove():t.unwrap())}))})),e.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-type,data-mce-resize",(function(e,t){for(var n=e.length;n--;)e[n].attr(t,null)}))},trimTrailingBr:function(e){var t,n,r=function(e){return e&&"br"===e.name};r(t=e.lastChild)&&r(n=t.prev)&&(t.remove(),n.remove())}},eb={process:function(e,t,n){return function(e,t){return e&&e.hasEventListeners("PreProcess")&&!t.no_events}(e,n)?function(e,t,n){var r,o,i,a=e.dom;return t=t.cloneNode(!0),(r=document.implementation).createHTMLDocument&&(o=r.createHTMLDocument(""),Ot.each("BODY"===t.nodeName?t.childNodes:[t],(function(e){o.body.appendChild(o.importNode(e,!0))})),t="BODY"!==t.nodeName?o.body.firstChild:o.body,i=a.doc,a.doc=o),Ym(e,Qv.merge(n,{node:t})),i&&(a.doc=i),t}(e,t,n):t}},tb=function(e,t,n){e.addNodeFilter("font",(function(e){H.each(e,(function(e){var r=t.parse(e.attr("style")),o=e.attr("color"),i=e.attr("face"),a=e.attr("size");o&&(r.color=o),i&&(r["font-family"]=i),a&&(r["font-size"]=n[parseInt(e.attr("size"),10)-1]),e.name="span",e.attr("style",t.serialize(r)),function(e,t){H.each(t,(function(t){e.attr(t,null)}))}(e,["color","face","size"])}))}))},nb=function(e,t){var n=Go();t.convert_fonts_to_spans&&tb(e,n,Ot.explode(t.font_size_legacy_values)),function(e,t){e.addNodeFilter("strike",(function(e){H.each(e,(function(e){var n=t.parse(e.attr("style"));n["text-decoration"]="line-through",e.name="span",e.attr("style",t.serialize(n))}))}))}(e,n)},rb={register:function(e,t){t.inline_styles&&nb(e,t)}},ob=/^[ \t\r\n]*$/,ib={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},ab=function(e,t,n){var r,o,i=n?"lastChild":"firstChild",a=n?"prev":"next";if(e[i])return e[i];if(e!==t){if(r=e[a])return r;for(o=e.parent;o&&o!==t;o=o.parent)if(r=o[a])return r}},cb=function(){function e(e,t){this.name=e,this.type=t,1===t&&(this.attributes=[],this.attributes.map={})}return e.create=function(t,n){var r,o;if(r=new e(t,ib[t]||1),n)for(o in n)r.attr(o,n[o]);return r},e.prototype.replace=function(e){return e.parent&&e.remove(),this.insert(e,this),this.remove(),this},e.prototype.attr=function(e,t){var n,r;if("string"!=typeof e){for(r in e)this.attr(r,e[r]);return this}if(n=this.attributes){if(void 0!==t){if(null===t){if(e in n.map)for(delete n.map[e],r=n.length;r--;)if(n[r].name===e)return n=n.splice(r,1),this;return this}if(e in n.map){for(r=n.length;r--;)if(n[r].name===e){n[r].value=t;break}}else n.push({name:e,value:t});return n.map[e]=t,this}return n.map[e]}},e.prototype.clone=function(){var t,n,r,o,i,a=new e(this.name,this.type);if(r=this.attributes){for((i=[]).map={},t=0,n=r.length;t<n;t++)"id"!==(o=r[t]).name&&(i[i.length]={name:o.name,value:o.value},i.map[o.name]=o.value);a.attributes=i}return a.value=this.value,a.shortEnded=this.shortEnded,a},e.prototype.wrap=function(e){return this.parent.insert(e,this),e.append(this),this},e.prototype.unwrap=function(){var e,t;for(e=this.firstChild;e;)t=e.next,this.insert(e,this,!0),e=t;this.remove()},e.prototype.remove=function(){var e=this.parent,t=this.next,n=this.prev;return e&&(e.firstChild===this?(e.firstChild=t,t&&(t.prev=null)):n.next=t,e.lastChild===this?(e.lastChild=n,n&&(n.next=null)):t.prev=n,this.parent=this.next=this.prev=null),this},e.prototype.append=function(e){var t;return e.parent&&e.remove(),(t=this.lastChild)?(t.next=e,e.prev=t,this.lastChild=e):this.lastChild=this.firstChild=e,e.parent=this,e},e.prototype.insert=function(e,t,n){var r;return e.parent&&e.remove(),r=t.parent||this,n?(t===r.firstChild?r.firstChild=e:t.prev.next=e,e.prev=t.prev,e.next=t,t.prev=e):(t===r.lastChild?r.lastChild=e:t.next.prev=e,e.next=t.next,e.prev=t,t.next=e),e.parent=r,e},e.prototype.getAll=function(e){var t,n=[];for(t=this.firstChild;t;t=ab(t,this))t.name===e&&n.push(t);return n},e.prototype.empty=function(){var e,t,n;if(this.firstChild){for(e=[],n=this.firstChild;n;n=ab(n,this))e.push(n);for(t=e.length;t--;)(n=e[t]).parent=n.firstChild=n.lastChild=n.next=n.prev=null}return this.firstChild=this.lastChild=null,this},e.prototype.isEmpty=function(e,t,n){var r,o,i=this.firstChild;if(t=t||{},i)do{if(1===i.type){if(i.attributes.map["data-mce-bogus"])continue;if(e[i.name])return!1;for(r=i.attributes.length;r--;)if("name"===(o=i.attributes[r].name)||0===o.indexOf("data-mce-bookmark"))return!1}if(8===i.type)return!1;if(3===i.type&&!ob.test(i.value))return!1;if(3===i.type&&i.parent&&t[i.parent.name]&&ob.test(i.value))return!1;if(n&&n(i))return!1}while(i=ab(i,this));return!0},e.prototype.walk=function(e){return ab(this,null,e)},e}(),sb=function(e,t,n,r){(e.padd_empty_with_br||t.insert)&&n[r.name]?r.empty().append(new cb("br",1)).shortEnded=!0:r.empty().append(new cb("#text",3)).value=" "},lb=function(e){return ub(e,"#text")&&" "===e.firstChild.value},ub=function(e,t){return e&&e.firstChild&&e.firstChild===e.lastChild&&e.firstChild.name===t},db=function(e,t,n,r){return r.isEmpty(t,n,(function(t){return function(e,t){var n=e.getElementRule(t.name);return n&&n.paddEmpty}(e,t)}))},fb=function(e,t){return e&&(t[e.name]||"br"===e.name)},mb=function(e,t){var n=e.schema;t.remove_trailing_brs&&e.addNodeFilter("br",(function(e,r,o){var i,a,c,s,l,u,d,f,m=e.length,p=Ot.extend({},n.getBlockElements()),g=n.getNonEmptyElements(),h=n.getNonEmptyElements();for(p.body=1,i=0;i<m;i++)if(c=(a=e[i]).parent,p[a.parent.name]&&a===c.lastChild){for(l=a.prev;l;){if("span"!==(u=l.name)||"bookmark"!==l.attr("data-mce-type")){if("br"!==u)break;if("br"===u){a=null;break}}l=l.prev}a&&(a.remove(),db(n,g,h,c)&&(d=n.getElementRule(c.name))&&(d.removeEmpty?c.remove():d.paddEmpty&&sb(t,o,p,c)))}else{for(s=a;c&&c.firstChild===s&&c.lastChild===s&&(s=c,!p[c.name]);)c=c.parent;s===c&&!0!==t.padd_empty_with_br&&((f=new cb("#text",3)).value=" ",a.replace(f))}})),e.addAttributeFilter("href",(function(e){var n,r,o,i=e.length;if(!t.allow_unsafe_link_target)for(;i--;)"a"===(n=e[i]).name&&"_blank"===n.attr("target")&&n.attr("rel",(r=n.attr("rel"),o=void 0,o=r?Ot.trim(r):"",/\b(noopener)\b/g.test(o)?o:function(e){return e.split(" ").filter((function(e){return e.length>0})).concat(["noopener"]).sort().join(" ")}(o)))})),t.allow_html_in_named_anchor||e.addAttributeFilter("id,name",(function(e){for(var t,n,r,o,i=e.length;i--;)if("a"===(o=e[i]).name&&o.firstChild&&!o.attr("href")){r=o.parent,t=o.lastChild;do{n=t.prev,r.insert(t,o),t=n}while(t)}})),t.fix_list_elements&&e.addNodeFilter("ul,ol",(function(e){for(var t,n,r=e.length;r--;)if("ul"===(n=(t=e[r]).parent).name||"ol"===n.name)if(t.prev&&"li"===t.prev.name)t.prev.append(t);else{var o=new cb("li",1);o.attr("style","list-style-type: none"),t.wrap(o)}})),t.validate&&n.getValidClasses()&&e.addAttributeFilter("class",(function(e){for(var t,r,o,i,a,c,s,l=e.length,u=n.getValidClasses();l--;){for(r=(t=e[l]).attr("class").split(" "),a="",o=0;o<r.length;o++)i=r[o],s=!1,(c=u["*"])&&c[i]&&(s=!0),c=u[t.name],!s&&c&&c[i]&&(s=!0),s&&(a&&(a+=" "),a+=i);a.length||(a=null),t.attr("class",a)}}))},pb=Ot.makeMap,gb=Ot.each,hb=Ot.explode,vb=Ot.extend;function bb(e,t){void 0===t&&(t=Ko());var n={},r=[],o={},i={};(e=e||{}).validate=!("validate"in e)||e.validate,e.root_name=e.root_name||"body";var a=function(e){var t,a,c;a in n&&((c=o[a])?c.push(e):o[a]=[e]),t=r.length;for(;t--;)(a=r[t].name)in e.attributes.map&&((c=i[a])?c.push(e):i[a]=[e]);return e},c={schema:t,addAttributeFilter:function(e,t){gb(hb(e),(function(e){var n;for(n=0;n<r.length;n++)if(r[n].name===e)return void r[n].callbacks.push(t);r.push({name:e,callbacks:[t]})}))},getAttributeFilters:function(){return[].concat(r)},addNodeFilter:function(e,t){gb(hb(e),(function(e){var r=n[e];r||(n[e]=r=[]),r.push(t)}))},getNodeFilters:function(){var e=[];for(var t in n)n.hasOwnProperty(t)&&e.push({name:t,callbacks:n[t]});return e},filterNode:a,parse:function(c,s){var l,u,d,f,m,p,g,h,v,b,y,C=[];s=s||{},o={},i={},v=vb(pb("script,style,head,html,body,title,meta,param"),t.getBlockElements());var w=t.getNonEmptyElements(),x=t.children,k=e.validate,T="forced_root_block"in s?s.forced_root_block:e.forced_root_block,E=t.getWhiteSpaceElements(),S=/^[ \t\r\n]+/,N=/[ \t\r\n]+$/,A=/[ \t\r\n]+/g,R=/^[ \t\r\n]+$/,_=function(e,t){var r,i=new cb(e,t);return e in n&&((r=o[e])?r.push(i):o[e]=[i]),i},I=function(e){var n,r,o,i,a=t.getBlockElements();for(n=e.prev;n&&3===n.type;){if((o=n.value.replace(N,"")).length>0)return void(n.value=o);if(r=n.next){if(3===r.type&&r.value.length){n=n.prev;continue}if(!a[r.name]&&"script"!==r.name&&"style"!==r.name){n=n.prev;continue}}i=n.prev,n.remove(),n=i}};l=Zg({validate:k,allow_script_urls:e.allow_script_urls,allow_conditional_comments:e.allow_conditional_comments,self_closing_elements:function(e){var t,n={};for(t in e)"li"!==t&&"p"!==t&&(n[t]=e[t]);return n}(t.getSelfClosingElements()),cdata:function(e){y.append(_("#cdata",4)).value=e},text:function(e,t){var n;b||(e=e.replace(A," "),fb(y.lastChild,v)&&(e=e.replace(S,""))),0!==e.length&&((n=_("#text",3)).raw=!!t,y.append(n).value=e)},comment:function(e){y.append(_("#comment",8)).value=e},pi:function(e,t){y.append(_(e,7)).value=t,I(y)},doctype:function(e){y.append(_("#doctype",10)).value=e,I(y)},start:function(e,n,o){var a,c,s,l,u;if(s=k?t.getElementRule(e):{}){for((a=_(s.outputName||e,1)).attributes=n,a.shortEnded=o,y.append(a),(u=x[y.name])&&x[a.name]&&!u[a.name]&&C.push(a),c=r.length;c--;)(l=r[c].name)in n.map&&((g=i[l])?g.push(a):i[l]=[a]);v[e]&&I(a),o||(y=a),!b&&E[e]&&(b=!0)}},end:function(n){var r,o,i,a,c;if(o=k?t.getElementRule(n):{}){if(v[n]&&!b){if((r=y.firstChild)&&3===r.type)if((i=r.value.replace(S,"")).length>0)r.value=i,r=r.next;else for(a=r.next,r.remove(),r=a;r&&3===r.type;)i=r.value,a=r.next,(0===i.length||R.test(i))&&(r.remove(),r=a),r=a;if((r=y.lastChild)&&3===r.type)if((i=r.value.replace(N,"")).length>0)r.value=i,r=r.prev;else for(a=r.prev,r.remove(),r=a;r&&3===r.type;)i=r.value,a=r.prev,(0===i.length||R.test(i))&&(r.remove(),r=a),r=a}if(b&&E[n]&&(b=!1),o.removeEmpty&&db(t,w,E,y)&&!y.attributes.map.name&&!y.attr("id"))return c=y.parent,v[y.name]?y.empty().remove():y.unwrap(),void(y=c);o.paddEmpty&&(lb(y)||db(t,w,E,y))&&sb(e,s,v,y),y=y.parent}}},t);var B=y=new cb(s.context||e.root_name,11);if(l.parse(c),k&&C.length&&(s.context?s.invalid=!0:function(e){var n,r,o,i,c,s,l,u,d,f,m,p,g,h,v,b;for(p=pb("tr,td,th,tbody,thead,tfoot,table"),f=t.getNonEmptyElements(),m=t.getWhiteSpaceElements(),g=t.getTextBlockElements(),h=t.getSpecialElements(),n=0;n<e.length;n++)if((r=e[n]).parent&&!r.fixed)if(g[r.name]&&"li"===r.parent.name){for(v=r.next;v&&g[v.name];)v.name="li",v.fixed=!0,r.parent.insert(v,r.parent),v=v.next;r.unwrap(r)}else{for(i=[r],o=r.parent;o&&!t.isValidChild(o.name,r.name)&&!p[o.name];o=o.parent)i.push(o);if(o&&i.length>1){for(i.reverse(),c=s=a(i[0].clone()),d=0;d<i.length-1;d++){for(t.isValidChild(s.name,i[d].name)?(l=a(i[d].clone()),s.append(l)):l=s,u=i[d].firstChild;u&&u!==i[d+1];)b=u.next,l.append(u),u=b;s=l}db(t,f,m,c)?o.insert(r,i[0],!0):(o.insert(c,i[0],!0),o.insert(r,c)),o=i[0],(db(t,f,m,o)||ub(o,"br"))&&o.empty().remove()}else if(r.parent){if("li"===r.name){if((v=r.prev)&&("ul"===v.name||"ul"===v.name)){v.append(r);continue}if((v=r.next)&&("ul"===v.name||"ul"===v.name)){v.insert(r,v.firstChild,!0);continue}r.wrap(a(new cb("ul",1)));continue}t.isValidChild(r.parent.name,"div")&&t.isValidChild("div",r.name)?r.wrap(a(new cb("div",1))):h[r.name]?r.empty().remove():r.unwrap()}}}(C)),T&&("body"===B.name||s.isRootContent)&&function(){var n,r,o=B.firstChild,i=function(e){e&&((o=e.firstChild)&&3===o.type&&(o.value=o.value.replace(S,"")),(o=e.lastChild)&&3===o.type&&(o.value=o.value.replace(N,"")))};if(t.isValidChild(B.name,T.toLowerCase())){for(;o;)n=o.next,3===o.type||1===o.type&&"p"!==o.name&&!v[o.name]&&!o.attr("data-mce-type")?r?r.append(o):((r=_(T,1)).attr(e.forced_root_block_attrs),B.insert(r,o),r.append(o)):(i(r),r=null),o=n;i(r)}}(),!s.invalid){for(h in o){for(g=n[h],m=(u=o[h]).length;m--;)u[m].parent||u.splice(m,1);for(d=0,f=g.length;d<f;d++)g[d](u,h,s)}for(d=0,f=r.length;d<f;d++)if((g=r[d]).name in i){for(m=(u=i[g.name]).length;m--;)u[m].parent||u.splice(m,1);for(m=0,p=g.callbacks.length;m<p;m++)g.callbacks[m](u,g.name,s)}}return B}};return mb(c,e),rb.register(c,e),c}var yb=function(e,t,n){-1===Ot.inArray(t,n)&&(e.addAttributeFilter(n,(function(e,t){for(var n=e.length;n--;)e[n].attr(t,null)})),t.push(n))},Cb=function(e,t,n){var r=gi(n.getInner?t.innerHTML:e.getOuterHTML(t));return n.selection?r:Ot.trim(r)},wb=function(e,t,n,r){var o=r.selection?Qv.merge({forced_root_block:!1},r):r,i=e.parse(n,o);return Zv.trimTrailingBr(i),i},xb=function(e,t,n,r,o){return function(e,t,n){return!t.no_events&&e?Qm(e,Qv.merge(t,{content:n})).content:n}(e,o,function(e,t,n){return Il(e,t).serialize(n)}(t,n,r))};function kb(e,t){var n=function(e,t){var n,r,o,i=["data-mce-selected"];return n=t&&t.dom?t.dom:ii.DOM,r=t&&t.schema?t.schema:Ko(e),e.entity_encoding=e.entity_encoding||"named",e.remove_trailing_brs=!("remove_trailing_brs"in e)||e.remove_trailing_brs,o=bb(e,r),Zv.register(o,e,n),{schema:r,addNodeFilter:o.addNodeFilter,addAttributeFilter:o.addAttributeFilter,serialize:function(i,a){var c=Qv.merge({format:"html"},a||{}),s=eb.process(t,i,c),l=Cb(n,s,c),u=wb(o,n,l,c);return"tree"===c.format?u:xb(t,e,r,u,c)},addRules:function(e){r.addValidElements(e)},setRules:function(e){r.setValidElements(e)},addTempAttr:b.curry(yb,o,i),getTempAttrs:function(){return i}}}(e,t);return{schema:n.schema,addNodeFilter:n.addNodeFilter,addAttributeFilter:n.addAttributeFilter,serialize:n.serialize,addRules:n.addRules,setRules:n.setRules,addTempAttr:n.addTempAttr,getTempAttrs:n.getTempAttrs}}function Tb(e){return{getBookmark:b.curry(vl.getBookmark,e),moveToBookmark:b.curry(vl.moveToBookmark,e)}}!function(e){e.isBookmarkNode=vl.isBookmarkNode}(Tb||(Tb={}));var Eb=Tb,Sb=xo.isContentEditableFalse,Nb=xo.isContentEditableTrue,Ab=function(e,t){var n,r,o,i,a,c,s,l,u,d,f,m,p,g,h,v,b,y=t.dom,C=Ot.each,w=t.getDoc(),x=document,k=Math.abs,T=Math.round,E=t.getBody();i={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]};var S=".mce-content-body";t.contentStyles.push(S+" div.mce-resizehandle {position: absolute;border: 1px solid black;box-sizing: content-box;background: #FFF;width: 7px;height: 7px;z-index: 10000}"+S+" .mce-resizehandle:hover {background: #000}"+S+" img[data-mce-selected],"+S+" hr[data-mce-selected] {outline: 1px solid black;resize: none}"+S+" .mce-clonedresizable {position: absolute;"+(ge.gecko?"":"outline: 1px dashed black;")+"opacity: .5;filter: alpha(opacity=50);z-index: 10000}"+S+" .mce-resize-helper {background: #555;background: rgba(0,0,0,0.75);border-radius: 3px;border: 1px;color: white;display: none;font-family: sans-serif;font-size: 12px;white-space: nowrap;line-height: 14px;margin: 5px 10px;padding: 5px;position: absolute;z-index: 10001}");var N=function(e){return e&&("IMG"===e.nodeName||t.dom.is(e,"figure.image"))},A=function(e){var n=e.target;(function(e,t){return N(e.target)&&!Fg(e.clientX,e.clientY,t)})(e,t.selection.getRng())&&!e.isDefaultPrevented()&&(e.preventDefault(),t.selection.select(n))},R=function(e){return t.dom.is(e,"figure.image")?e.querySelector("img"):e},_=function(e){var n=t.settings.object_resizing;return!1!==n&&!ge.iOS&&("string"!=typeof n&&(n="table,img,figure.image,div"),"false"!==e.getAttribute("data-mce-resize")&&e!==t.getBody()&&Tr.is(On.fromDom(e),n))},I=function(e){var i,C,w,x;i=e.screenX-c,C=e.screenY-s,g=i*a[2]+d,h=C*a[3]+f,g=g<5?5:g,h=h<5?5:h,(N(n)&&!1!==t.settings.resize_img_proportional?!Ug.modifierPressed(e):Ug.modifierPressed(e)||N(n)&&a[2]*a[3]!=0)&&(k(i)>k(C)?(h=T(g*m),g=T(h/m)):(g=T(h/m),h=T(g*m))),y.setStyles(R(r),{width:g,height:h}),w=(w=a.startPos.x+i)>0?w:0,x=(x=a.startPos.y+C)>0?x:0,y.setStyles(o,{left:w,top:x,display:"block"}),o.innerHTML=g+" &times; "+h,a[2]<0&&r.clientWidth<=g&&y.setStyle(r,"left",l+(d-g)),a[3]<0&&r.clientHeight<=h&&y.setStyle(r,"top",u+(f-h)),(i=E.scrollWidth-v)+(C=E.scrollHeight-b)!=0&&y.setStyles(o,{left:w-i,top:x-C}),p||(tp(t,n,d,f),p=!0)},B=function(){p=!1;var e=function(e,r){r&&(n.style[e]||!t.schema.isValid(n.nodeName.toLowerCase(),e)?y.setStyle(R(n),e,r):y.setAttrib(R(n),e,r))};e("width",g),e("height",h),y.unbind(w,"mousemove",I),y.unbind(w,"mouseup",B),x!==w&&(y.unbind(x,"mousemove",I),y.unbind(x,"mouseup",B)),y.remove(r),y.remove(o),P(n),np(t,n,g,h),y.setAttrib(n,"style",y.getAttrib(n,"style")),t.nodeChanged()},P=function(e){var p,k,T,S,N;D(),L(),p=y.getPos(e,E),l=p.x,u=p.y,N=e.getBoundingClientRect(),k=N.width||N.right-N.left,T=N.height||N.bottom-N.top,n!==e&&(n=e,g=h=0),S=t.fire("ObjectSelected",{target:e}),_(e)&&!S.isDefaultPrevented()?C(i,(function(e,t){var i;(i=y.get("mceResizeHandle"+t))&&y.remove(i),i=y.add(E,"div",{id:"mceResizeHandle"+t,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+t+"-resize; margin:0; padding:0"}),ge.ie&&(i.contentEditable=!1),y.bind(i,"mousedown",(function(t){t.stopImmediatePropagation(),t.preventDefault(),function(t){c=t.screenX,s=t.screenY,d=R(n).clientWidth,f=R(n).clientHeight,m=f/d,a=e,e.startPos={x:k*e[0]+l,y:T*e[1]+u},v=E.scrollWidth,b=E.scrollHeight,r=n.cloneNode(!0),y.addClass(r,"mce-clonedresizable"),y.setAttrib(r,"data-mce-bogus","all"),r.contentEditable=!1,r.unSelectabe=!0,y.setStyles(r,{left:l,top:u,margin:0}),r.removeAttribute("data-mce-selected"),E.appendChild(r),y.bind(w,"mousemove",I),y.bind(w,"mouseup",B),x!==w&&(y.bind(x,"mousemove",I),y.bind(x,"mouseup",B)),o=y.add(E,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},d+" &times; "+f)}(t)})),e.elm=i,y.setStyles(i,{left:k*e[0]+l-i.offsetWidth/2,top:T*e[1]+u-i.offsetHeight/2})})):D(),n.setAttribute("data-mce-selected","1")},D=function(){var e,t;for(e in L(),n&&n.removeAttribute("data-mce-selected"),i)(t=y.get("mceResizeHandle"+e))&&(y.unbind(t),y.remove(t))},O=function(n){var r,o=function(e,t){if(e)do{if(e===t)return!0}while(e=e.parentNode)};p||t.removed||(C(y.select("img[data-mce-selected],hr[data-mce-selected]"),(function(e){e.removeAttribute("data-mce-selected")})),r="mousedown"===n.type?n.target:e.getNode(),o(r=y.$(r).closest("table,img,figure.image,hr")[0],E)&&(F(),o(e.getStart(!0),r)&&o(e.getEnd(!0),r))?P(r):D())},M=function(e){return Sb(function(e,t){for(;t&&t!==e;){if(Nb(t)||Sb(t))return t;t=t.parentNode}return null}(t.getBody(),e))},L=function(){for(var e in i){var t=i[e];t.elm&&(y.unbind(t.elm),delete t.elm)}},F=function(){try{t.getDoc().execCommand("enableObjectResizing",!1,!1)}catch(e){}};return t.on("init",(function(){F(),ge.ie&&ge.ie>=11&&(t.on("mousedown click",(function(e){var n=e.target,r=n.nodeName;p||!/^(TABLE|IMG|HR)$/.test(r)||M(n)||(2!==e.button&&t.selection.select(n,"TABLE"===r),"mousedown"===e.type&&t.nodeChanged())})),t.dom.bind(E,"mscontrolselect",(function(e){var n=function(e){Ce.setEditorTimeout(t,(function(){t.selection.select(e)}))};if(M(e.target))return e.preventDefault(),void n(e.target);/^(TABLE|IMG|HR)$/.test(e.target.nodeName)&&(e.preventDefault(),"IMG"===e.target.tagName&&n(e.target))})));var e=Ce.throttle((function(e){t.composing||O(e)}));t.on("nodechange ResizeEditor ResizeWindow drop FullscreenStateChanged",e),t.on("keyup compositionend",(function(t){n&&"TABLE"===n.nodeName&&e(t)})),t.on("hide blur",D),t.on("contextmenu",A)})),t.on("remove",L),{isResizable:_,showResizeRect:P,hideResizeRect:D,updateResizeRect:O,destroy:function(){n=r=null}}},Rb=function(e){return xo.isContentEditableTrue(e)||xo.isContentEditableFalse(e)},_b={fromPoint:function(e,t,n){var r,o,i=n;if(i.caretPositionFromPoint)(o=i.caretPositionFromPoint(e,t))&&((r=n.createRange()).setStart(o.offsetNode,o.offset),r.collapse(!0));else if(n.caretRangeFromPoint)r=n.caretRangeFromPoint(e,t);else if(i.body.createTextRange){r=i.body.createTextRange();try{r.moveToPoint(e,t),r.collapse(!0)}catch(o){r=function(e,t,n){var r,o,i;if(r=n.elementFromPoint(e,t),o=n.body.createTextRange(),r&&"HTML"!==r.tagName||(r=n.body),o.moveToElementText(r),(i=(i=Ot.toArray(o.getClientRects())).sort((function(e,n){return(e=Math.abs(Math.max(e.top-t,e.bottom-t)))-(n=Math.abs(Math.max(n.top-t,n.bottom-t)))}))).length>0){t=(i[0].bottom+i[0].top)/2;try{return o.moveToPoint(e,t),o.collapse(!0),o}catch(e){}}return null}(e,t,n)}return function(e,t){var n=e&&e.parentElement?e.parentElement():null;return xo.isContentEditableFalse(function(e,t,n){for(;e&&e!==t;){if(n(e))return e;e=e.parentNode}return null}(n,t,Rb))?null:e}(r,n.body)}return r}},Ib=function(e,t){return H.map(t,(function(t){var n=e.fire("GetSelectionRange",{range:t});return n.range!==t?n.range:t}))},Bb=function(e,t){return On.fromDom(e.dom().cloneNode(t))},Pb=function(e){return Bb(e,!0)},Db=function(e){return Bb(e,!1)},Ob=Pb,Mb=function(e,t){var n=(t||document).createDocumentFragment();return H.each(e,(function(e){n.appendChild(e.dom())})),On.fromDom(n)},Lb=function(e){var t=e.startContainer,n=e.startOffset;return xo.isText(t)?0===n?T.some(On.fromDom(t)):T.none():T.from(t.childNodes[n]).map(On.fromDom)},Fb=function(e){var t=e.endContainer,n=e.endOffset;return xo.isText(t)?n===t.data.length?T.some(On.fromDom(t)):T.none():T.from(t.childNodes[n-1]).map(On.fromDom)},jb=function(e){return Or.firstChild(e).fold(b.constant([e]),(function(t){return[e].concat(jb(t))}))},Hb=function(e){return Or.lastChild(e).fold(b.constant([e]),(function(t){return"br"===$n.name(t)?Or.prevSibling(t).map((function(t){return[e].concat(Hb(t))})).getOr([]):[e].concat(Hb(t))}))},Ub=function(e,t,n,r){var o=n,i=new Xr(n,o),a=e.schema.getNonEmptyElements();do{if(3===n.nodeType&&0!==Ot.trim(n.nodeValue).length)return void(r?t.setStart(n,0):t.setEnd(n,n.nodeValue.length));if(a[n.nodeName]&&!/^(TD|TH)$/.test(n.nodeName))return void(r?t.setStartBefore(n):"BR"===n.nodeName?t.setEndBefore(n):t.setEndAfter(n));if(ge.ie&&ge.ie<11&&e.isBlock(n)&&e.isEmpty(n))return void(r?t.setStart(n,0):t.setEnd(n,0))}while(n=r?i.next():i.prev());"BODY"===o.nodeName&&(r?t.setStart(o,0):t.setEnd(o,o.childNodes.length))},Wb=hr.immutable("element","width","rows"),zb=hr.immutable("element","cells"),qb=hr.immutable("x","y"),Vb=function(e,t){var n=parseInt(rr.get(e,t),10);return isNaN(n)?1:n},$b=function(e,t,n){var r=e.rows();return!!(r[n]?r[n].cells():[])[t]},Kb=function(e){return H.foldl(e,(function(e,t){return t.cells().length>e?t.cells().length:e}),0)},Jb=function(e,t){for(var n=e.rows(),r=0;r<n.length;r++)for(var o=n[r].cells(),i=0;i<o.length;i++)if(Nr.eq(o[i],t))return T.some(qb(i,r));return T.none()},Gb=function(e,t,n,r,o){for(var i=[],a=e.rows(),c=n;c<=o;c++){var s=a[c].cells(),l=t<r?s.slice(t,r+1):s.slice(r,t+1);i.push(zb(a[c].element(),l))}return i},Xb=function(e){var t=Wb(Db(e),0,[]);return H.each(rc(e,"tr"),(function(e,n){H.each(rc(e,"td,th"),(function(r,o){!function(e,t,n,r,o){for(var i=Vb(o,"rowspan"),a=Vb(o,"colspan"),c=e.rows(),s=n;s<n+i;s++){c[s]||(c[s]=zb(Ob(r),[]));for(var l=t;l<t+a;l++)c[s].cells()[l]=s===n&&l===t?o:Db(o)}}(t,function(e,t,n){for(;$b(e,t,n);)t++;return t}(t,o,n),n,e,r)}))})),Wb(t.element(),Kb(t.rows()),t.rows())},Yb=function(e){return function(e,t){var n=Db(e.element()),r=On.fromTag("tbody");return wl(r,t),_c.append(n,r),n}(e,function(e){return H.map(e.rows(),(function(e){var t=H.map(e.cells(),(function(e){var t=Ob(e);return rr.remove(t,"colspan"),rr.remove(t,"rowspan"),t})),n=Db(e.element());return wl(n,t),n}))}(e))},Qb=function(e,t,n){return Jb(e,t).bind((function(t){return Jb(e,n).map((function(n){return function(e,t,n){var r=t.x(),o=t.y(),i=n.x(),a=n.y(),c=o<a?Gb(e,r,o,i,a):Gb(e,r,a,i,o);return Wb(e.element(),Kb(c),c)}(e,t,n)}))}))},Zb=function(e,t){return H.find(e,(function(e){return"li"===$n.name(e)&&function(e,t){return ea([Lb(t),Fb(t)],(function(t,n){var r=H.find(jb(e),b.curry(Nr.eq,t)),o=H.find(Hb(e),b.curry(Nr.eq,n));return r.isSome()&&o.isSome()})).getOr(!1)}(e,t)})).fold(b.constant([]),(function(t){return function(e){return H.find(e,(function(e){return"ul"===$n.name(e)||"ol"===$n.name(e)}))}(e).map((function(e){return[On.fromTag("li"),On.fromTag($n.name(e))]})).getOr([])}))},ey=function(e,t){var n=On.fromDom(t.commonAncestorContainer),r=Ru(n,e),o=H.filter(r,(function(e){return ro(e)||to(e)})),i=Zb(r,t),a=o.concat(i.length?i:function(e){return co(e)?Or.parent(e).filter(ao).fold(b.constant([]),(function(t){return[e,t]})):ao(e)?[e]:[]}(n));return H.map(a,Db)},ty=function(){return Mb([])},ny=function(e,t){return n=On.fromDom(t.cloneContents()),r=ey(e,t),o=H.foldl(r,(function(e,t){return _c.append(t,e),t}),n),r.length>0?Mb([o]):o;var n,r,o},ry=function(e,t){return(n=e,r=t[0],du(r,"table",b.curry(Nr.eq,n))).bind((function(e){var n=t[0],r=t[t.length-1],o=Xb(e);return Qb(o,n,r).map((function(e){return Mb([Yb(e)])}))})).getOrThunk(ty);var n,r},oy=function(e,t){var n=yf(t,e);return n.length>0?ry(e,n):function(e,t){return t.length>0&&t[0].collapsed?ty():ny(e,t[0])}(e,t)},iy=function(e,t){var n,r=e.selection.getRng(),o=e.dom.create("body"),i=e.selection.getSel(),a=Ib(e,mf(i));if((t=t||{}).get=!0,t.format=t.format||"html",t.selection=!0,(t=e.fire("BeforeGetContent",t)).isDefaultPrevented())return e.fire("GetContent",t),t.content;if("text"===t.format)return e.selection.isCollapsed()?"":gi(r.text||(i.toString?i.toString():""));r.cloneContents?(n=t.contextual?oy(On.fromDom(e.getBody()),a).dom():r.cloneContents())&&o.appendChild(n):void 0!==r.item||void 0!==r.htmlText?(o.innerHTML="<br>"+(r.item?r.item(0).outerHTML:r.htmlText),o.removeChild(o.firstChild)):o.innerHTML=r.toString(),t.getInner=!0;var c=e.selection.serializer.serialize(o,t);return"tree"===t.format?c:(t.content=e.selection.isCollapsed()?"":c,e.fire("GetContent",t),t.content)},ay=function(e,t,n){var r,o,i,a=e.selection.getRng(),c=e.getDoc();if((n=n||{format:"html"}).set=!0,n.selection=!0,n.content=t,n.no_events||!(n=e.fire("BeforeSetContent",n)).isDefaultPrevented()){if(t=n.content,a.insertNode){t+='<span id="__caret">_</span>',a.startContainer===c&&a.endContainer===c?c.body.innerHTML=t:(a.deleteContents(),0===c.body.childNodes.length?c.body.innerHTML=t:a.createContextualFragment?a.insertNode(a.createContextualFragment(t)):(o=c.createDocumentFragment(),i=c.createElement("div"),o.appendChild(i),i.outerHTML=t,a.insertNode(o))),r=e.dom.get("__caret"),(a=c.createRange()).setStartBefore(r),a.setEndBefore(r),e.selection.setRng(a),e.dom.remove("__caret");try{e.selection.setRng(a)}catch(e){}}else a.item&&(c.execCommand("Delete",!1,null),a=e.getRng()),/^\s+/.test(t)?(a.pasteHTML('<span id="__mce_tmp">_</span>'+t),e.dom.remove("__mce_tmp")):a.pasteHTML(t);n.no_events||e.fire("SetContent",n)}else e.fire("SetContent",n)},cy=function(e,t,n,r,o){var i=n?t.startContainer:t.endContainer,a=n?t.startOffset:t.endOffset;return T.from(i).map(On.fromDom).map((function(e){return r&&t.collapsed?e:Or.child(e,o(e,a)).getOr(e)})).bind((function(e){return $n.isElement(e)?T.some(e):Or.parent(e)})).map((function(e){return e.dom()})).getOr(e)},sy=function(e,t,n){return cy(e,t,!0,n,(function(e,t){return Math.min(Or.childNodesCount(e),t)}))},ly=function(e,t,n){return cy(e,t,!1,n,(function(e,t){return t>0?t-1:t}))},uy=function(e,t){for(var n=e;e&&xo.isText(e)&&0===e.length;)e=t?e.nextSibling:e.previousSibling;return e||n},dy=Ot.each,fy=function(e){return!!e.select},my=function(e){return!(!e||!e.ownerDocument)&&Nr.contains(On.fromDom(e.ownerDocument),On.fromDom(e))},py=function(e,t,n,r){var o,i,a,c,s,l=function(e,t){return ay(r,e,t)},u=function(e){var t=f();t.collapse(!!e),m(t)},d=function(){return t.getSelection?t.getSelection():t.document.selection},f=function(){var n,o,i,s,l=function(e,t,n){try{return t.compareBoundaryPoints(e,n)}catch(e){return-1}};if(!t)return null;if(null==(s=t.document))return null;if(void 0!==r.bookmark&&!1===Np(r)){var u=Em.getRng(r);if(u.isSome())return u.map((function(e){return Ib(r,[e])[0]})).getOr(s.createRange())}try{(n=d())&&(o=n.rangeCount>0?n.getRangeAt(0):n.createRange?n.createRange():s.createRange())}catch(e){}return(o=Ib(r,[o])[0])||(o=s.createRange?s.createRange():s.body.createTextRange()),o.setStart&&9===o.startContainer.nodeType&&o.collapsed&&(i=e.getRoot(),o.setStart(i,0),o.setEnd(i,0)),a&&c&&(0===l(o.START_TO_START,o,a)&&0===l(o.END_TO_END,o,a)?o=c:(a=null,c=null)),o},m=function(e,t){var n,o;if(function(e){return!!e&&(!!fy(e)||my(e.startContainer)&&my(e.endContainer))}(e)){var i=fy(e)?e:null;if(i){c=null;try{i.select()}catch(e){}}else{if(n=d(),e=r.fire("SetSelectionRange",{range:e,forward:t}).range,n){c=e;try{n.removeAllRanges(),n.addRange(e)}catch(e){}!1===t&&n.extend&&(n.collapse(e.endContainer,e.endOffset),n.extend(e.startContainer,e.startOffset)),a=n.rangeCount>0?n.getRangeAt(0):null}e.collapsed||e.startContainer!==e.endContainer||!n.setBaseAndExtent||ge.ie||e.endOffset-e.startOffset<2&&e.startContainer.hasChildNodes()&&(o=e.startContainer.childNodes[e.startOffset])&&"IMG"===o.tagName&&(n.setBaseAndExtent(e.startContainer,e.startOffset,e.endContainer,e.endOffset),n.anchorNode===e.startContainer&&n.focusNode===e.endContainer||n.setBaseAndExtent(o,0,o,1)),r.fire("AfterSetSelectionRange",{range:e,forward:t})}}},p=function(){var t,n,r=d();return!(r&&r.anchorNode&&r.focusNode)||((t=e.createRng()).setStart(r.anchorNode,r.anchorOffset),t.collapse(!0),(n=e.createRng()).setStart(r.focusNode,r.focusOffset),n.collapse(!0),t.compareBoundaryPoints(t.START_TO_START,n)<=0)},g={bookmarkManager:null,controlSelection:null,dom:e,win:t,serializer:n,editor:r,collapse:u,setCursorLocation:function(t,n){var o=e.createRng();t?(o.setStart(t,n),o.setEnd(t,n),m(o),u(!1)):(Ub(e,o,r.getBody(),!0),m(o))},getContent:function(e){return iy(r,e)},setContent:l,getBookmark:function(e,t){return o.getBookmark(e,t)},moveToBookmark:function(e){return o.moveToBookmark(e)},select:function(t,n){return function(e,t,n){return T.from(t).map((function(t){var r=e.nodeIndex(t),o=e.createRng();return o.setStart(t.parentNode,r),o.setEnd(t.parentNode,r+1),n&&(Ub(e,o,t,!0),Ub(e,o,t,!1)),o}))}(e,t,n).each(m),t},isCollapsed:function(){var e=f(),t=d();return!(!e||e.item)&&(e.compareEndPoints?0===e.compareEndPoints("StartToEnd",e):!t||e.collapsed)},isForward:p,setNode:function(t){return l(e.getOuterHTML(t)),t},getNode:function(){return e=r.getBody(),(t=f())?(o=t.startContainer,i=t.endContainer,a=t.startOffset,c=t.endOffset,n=t.commonAncestorContainer,!t.collapsed&&(o===i&&c-a<2&&o.hasChildNodes()&&(n=o.childNodes[a]),3===o.nodeType&&3===i.nodeType&&(o=o.length===a?uy(o.nextSibling,!0):o.parentNode,i=0===c?uy(i.previousSibling,!1):i.parentNode,o&&o===i))?o:n&&3===n.nodeType?n.parentNode:n):e;var e,t,n,o,i,a,c},getSel:d,setRng:m,getRng:f,getStart:function(e){return sy(r.getBody(),f(),e)},getEnd:function(e){return ly(r.getBody(),f(),e)},getSelectedBlocks:function(t,n){return function(e,t,n,r){var o,i,a=[];if(i=e.getRoot(),n=e.getParent(n||sy(i,t,!1),e.isBlock),r=e.getParent(r||ly(i,t,!1),e.isBlock),n&&n!==i&&a.push(n),n&&r&&n!==r){o=n;for(var c=new Xr(n,i);(o=c.next())&&o!==r;)e.isBlock(o)&&a.push(o)}return r&&n!==r&&r!==i&&a.push(r),a}(e,f(),t,n)},normalize:function(){var t=f();if(!gf(d())){var n=Yf.normalize(e,t);return n.each((function(e){m(e,p())})),n.getOr(t)}return t},selectorChanged:function(t,n){var o;return s||(s={},o={},r.on("NodeChange",(function(t){var n=t.element,r=e.getParents(n,null,e.getRoot()),i={};dy(s,(function(t,n){dy(r,(function(a){if(e.is(a,n))return o[n]||(dy(t,(function(e){e(!0,{node:a,selector:n,parents:r})})),o[n]=t),i[n]=t,!1}))})),dy(o,(function(e,t){i[t]||(delete o[t],dy(e,(function(e){e(!1,{node:n,selector:t,parents:r})})))}))}))),s[t]||(s[t]=[]),s[t].push(n),g},getScrollContainer:function(){for(var t,n=e.getRoot();n&&"BODY"!==n.nodeName;){if(n.scrollHeight>n.clientHeight){t=n;break}n=n.parentNode}return t},scrollIntoView:function(e,t){return uc(r,e,t)},placeCaretAt:function(e,t){return m(_b.fromPoint(e,t,r.getDoc()))},getBoundingClientRect:function(){var e=f();return e.collapsed?wa.fromRangeStart(e).getClientRects()[0]:e.getBoundingClientRect()},destroy:function(){t=a=c=null,i.destroy()}};return o=Eb(g),i=Ab(g,r),g.bookmarkManager=o,g.controlSelection=i,g},gy=xo.isContentEditableFalse,hy=Ki,vy=ys,by=bs,yy=function(e,t){for(;t=e(t);)if(t.isVisible())return t;return t},Cy=function(e,t,n,r){var o,i,a,c,s=e===Va.Forwards,l=s?by:vy;return!r.collapsed&&(o=hy(r),gy(o))?Ua(e,t,o,e===Va.Backwards,!0):(c=function(e){return bi(e.startContainer)}(r),l(i=vs(e,t.getBody(),r))?Wa(t,i.getNode(!s)):(i=n(i))?l(i)?Ua(e,t,i.getNode(!s),s,!0):l(a=n(i))&&function(e,t){var n=as(e,t);return!(n||!xo.isBr(e.getNode()))||n}(i,a)?Ua(e,t,a.getNode(!s),s,!0):c?qa(t,i.toRange(),!0):null:c?r:null)},wy=function(e,t,n,r){var o,i,a,c,s,l,u,d,f;if(f=hy(r),o=vs(e,t.getBody(),r),i=n(t.getBody(),Ag(1),o),a=_t.filter(i,Rg(1)),s=_t.last(o.getClientRects()),(by(o)||Cs(o))&&(f=o.getNode()),(vy(o)||ws(o))&&(f=o.getNode(!0)),!s)return null;if(l=s.left,(c=Og(a,l))&&gy(c.node))return u=Math.abs(l-c.left),d=Math.abs(l-c.right),Ua(e,t,c.node,u<d,!0);if(f){var m=function(e,t,n,r){var o,i,a,c,s,l,u=Bs(t),d=[],f=0,m=function(e){return _t.last(e.getClientRects())};1===e?(o=u.next,i=qi,a=zi,c=wa.after(r)):(o=u.prev,i=zi,a=qi,c=wa.before(r)),l=m(c);do{if(c.isVisible()&&!a(s=m(c),l)){if(d.length>0&&i(s,_t.last(d))&&f++,(s=Hi(s)).position=c,s.line=f,n(s))return d;d.push(s)}}while(c=o(c));return d}(e,t.getBody(),Ag(1),f);if(c=Og(_t.filter(m,Rg(1)),l))return qa(t,c.position.toRange(),!0);if(c=_t.last(_t.filter(m,Rg(0))))return qa(t,c.position.toRange(),!0)}},xy=function(e,t,n){var r,o,i=Bs(e.getBody()),a=Zi.curry(yy,i.next),c=Zi.curry(yy,i.prev);if(n.collapsed&&e.settings.forced_root_block){if(!(r=e.dom.getParent(n.startContainer,"PRE")))return;(1===t?a(wa.fromRangeStart(n)):c(wa.fromRangeStart(n)))||(o=function(e){var t=e.dom.create(e.settings.forced_root_block);return(!ge.ie||ge.ie>=11)&&(t.innerHTML='<br data-mce-bogus="1">'),t}(e),1===t?e.$(r).after(o):e.$(r).before(o),e.selection.select(o,!0),e.selection.collapse())}},ky=function(e,t){return function(){var n=function(e,t){var n,r=Bs(e.getBody()),o=Zi.curry(yy,r.next),i=Zi.curry(yy,r.prev),a=t?Va.Forwards:Va.Backwards,c=t?o:i,s=e.selection.getRng();return(n=Cy(a,e,c,s))?n:(n=xy(e,a,s))||null}(e,t);return!!n&&(e.selection.setRng(n),!0)}},Ty=function(e,t){return function(){var n=function(e,t){var n,r=t?1:-1,o=t?Ng:Sg,i=e.selection.getRng();return(n=wy(r,e,o,i))?n:(n=xy(e,r,i))||null}(e,t);return!!n&&(e.selection.setRng(n),!0)}},Ey=function(e,t){return H.bind(function(e){return H.map(e,(function(e){return Qv.merge({shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0,action:b.noop},e)}))}(e),(function(e){return function(e,t){return t.keyCode===e.keyCode&&t.shiftKey===e.shiftKey&&t.altKey===e.altKey&&t.ctrlKey===e.ctrlKey&&t.metaKey===e.metaKey}(e,t)?[e]:[]}))},Sy=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,r)}},Ny=function(e,t){return H.find(Ey(e,t),(function(e){return e.action()}))},Ay=function(e,t){e.on("keydown",(function(n){!1===n.isDefaultPrevented()&&function(e,t,n){var r=Pn.detect().os;Ny([{keyCode:Ug.RIGHT,action:ky(e,!0)},{keyCode:Ug.LEFT,action:ky(e,!1)},{keyCode:Ug.UP,action:Ty(e,!1)},{keyCode:Ug.DOWN,action:Ty(e,!0)},{keyCode:Ug.RIGHT,action:Uc(e,!0)},{keyCode:Ug.LEFT,action:Uc(e,!1)},{keyCode:Ug.UP,action:Wc(e,!1)},{keyCode:Ug.DOWN,action:Wc(e,!0)},{keyCode:Ug.RIGHT,action:$d.move(e,t,!0)},{keyCode:Ug.LEFT,action:$d.move(e,t,!1)},{keyCode:Ug.RIGHT,ctrlKey:!r.isOSX(),altKey:r.isOSX(),action:$d.moveNextWord(e,t)},{keyCode:Ug.LEFT,ctrlKey:!r.isOSX(),altKey:r.isOSX(),action:$d.movePrevWord(e,t)}],n).each((function(e){n.preventDefault()}))}(e,t,n)}))},Ry=function(e){return 1===Or.children(e).length},_y=function(e,t,n,r){var o=b.curry(rv,t),i=H.map(H.filter(r,o),(function(e){return e.dom()}));if(0===i.length)td(t,e,n);else{var a=function(e,t){var n=Xh(!1),r=tv(t,n.dom());return _c.before(On.fromDom(e),n),kl.remove(On.fromDom(e)),wa(r,0)}(n.dom(),i);t.selection.setRng(a.toRange())}},Iy=function(e,t){var n=On.fromDom(e.getBody()),r=On.fromDom(e.selection.getStart()),o=H.filter(function(e,t){var n=Ru(t,e);return H.findIndex(n,no).fold(b.constant(n),(function(e){return n.slice(0,e)}))}(n,r),Ry);return H.last(o).map((function(n){var r=wa.fromRangeStart(e.selection.getRng());return!!lu(t,r,n.dom())&&(_y(t,e,n,o),!0)})).getOr(!1)},By=function(e,t){return!!e.selection.isCollapsed()&&Iy(e,t)},Py=function(e,t){e.on("keydown",(function(n){!1===n.isDefaultPrevented()&&function(e,t,n){Ny([{keyCode:Ug.BACKSPACE,action:Sy(od,e,!1)},{keyCode:Ug.DELETE,action:Sy(od,e,!0)},{keyCode:Ug.BACKSPACE,action:Sy(Xd,e,t,!1)},{keyCode:Ug.DELETE,action:Sy(Xd,e,t,!0)},{keyCode:Ug.BACKSPACE,action:Sy(Hu,e,!1)},{keyCode:Ug.DELETE,action:Sy(Hu,e,!0)},{keyCode:Ug.BACKSPACE,action:Sy(Mu,e,!1)},{keyCode:Ug.DELETE,action:Sy(Mu,e,!0)},{keyCode:Ug.BACKSPACE,action:Sy(_f,e,!1)},{keyCode:Ug.DELETE,action:Sy(_f,e,!0)},{keyCode:Ug.BACKSPACE,action:Sy(By,e,!1)},{keyCode:Ug.DELETE,action:Sy(By,e,!0)}],n).each((function(e){n.preventDefault()}))}(e,t,n)})),e.on("keyup",(function(t){!1===t.isDefaultPrevented()&&function(e,t){Ny([{keyCode:Ug.BACKSPACE,action:Sy(id,e)},{keyCode:Ug.DELETE,action:Sy(id,e)}],t)}(e,t)}))},Dy=function(e){return T.from(e.dom.getParent(e.selection.getStart(!0),e.dom.isBlock))},Oy=function(e,t){var n,r,o,i=t,a=e.dom,c=e.schema.getMoveCaretBeforeOnEnterElements();if(t){if(/^(LI|DT|DD)$/.test(t.nodeName)){var s=function(e){for(;e;){if(1===e.nodeType||3===e.nodeType&&e.data&&/[\r\n\s]/.test(e.data))return e;e=e.nextSibling}}(t.firstChild);s&&/^(UL|OL|DL)$/.test(s.nodeName)&&t.insertBefore(a.doc.createTextNode(" "),t.firstChild)}if(o=a.createRng(),t.normalize(),t.hasChildNodes()){for(n=new Xr(t,t);r=n.current();){if(xo.isText(r)){o.setStart(r,0),o.setEnd(r,0);break}if(c[r.nodeName.toLowerCase()]){o.setStartBefore(r),o.setEndBefore(r);break}i=r,r=n.next()}r||(o.setStart(i,0),o.setEnd(i,0))}else xo.isBr(t)?t.nextSibling&&a.isBlock(t.nextSibling)?(o.setStartBefore(t),o.setEndBefore(t)):(o.setStartAfter(t),o.setEndAfter(t)):(o.setStart(t,0),o.setEnd(t,0));e.selection.setRng(o),a.remove(void 0),e.selection.scrollIntoView(t)}},My=function(e,t){var n,r,o=e.getRoot();for(n=t;n!==o&&"false"!==e.getContentEditable(n);)"true"===e.getContentEditable(n)&&(r=n),n=n.parentNode;return n!==o?r:o},Ly=Dy,Fy=function(e){return Dy(e).fold(b.constant(""),(function(e){return e.nodeName.toUpperCase()}))},jy=function(e){return Dy(e).filter((function(e){return co(On.fromDom(e))})).isSome()},Hy=function(e,t){return e&&e.parentNode&&e.parentNode.nodeName===t},Uy=function(e){return e&&/^(OL|UL|LI)$/.test(e.nodeName)},Wy=function(e){var t=e.parentNode;return/^(LI|DT|DD)$/.test(t.nodeName)?t:e},zy=function(e,t,n){for(var r=e[n?"firstChild":"lastChild"];r&&!xo.isElement(r);)r=r[n?"nextSibling":"previousSibling"];return r===t},qy=function(e,t,n,r,o){var i=e.dom,a=e.selection.getRng();if(n!==e.getBody()){var c;Uy(c=n)&&Uy(c.parentNode)&&(o="LI");var s=o?t(o):i.create("BR");if(zy(n,r,!0)&&zy(n,r,!1))Hy(n,"LI")?i.insertAfter(s,Wy(n)):i.replace(s,n);else if(zy(n,r,!0))Hy(n,"LI")?(i.insertAfter(s,Wy(n)),s.appendChild(i.doc.createTextNode(" ")),s.appendChild(n)):n.parentNode.insertBefore(s,n);else if(zy(n,r,!1))i.insertAfter(s,Wy(n));else{n=Wy(n);var l=a.cloneRange();l.setStartAfter(r),l.setEndAfter(n);var u=l.extractContents();"LI"===o&&function(e,t){return e.firstChild&&e.firstChild.nodeName===t}(u,"LI")?(s=u.firstChild,i.insertAfter(u,n)):(i.insertAfter(u,n),i.insertAfter(s,n))}i.remove(r),Oy(e,s)}},Vy=function(e){e.innerHTML='<br data-mce-bogus="1">'},$y=function(e,t){return e.nodeName===t||e.previousSibling&&e.previousSibling.nodeName===t},Ky=function(e,t){return t&&e.isBlock(t)&&!/^(TD|TH|CAPTION|FORM)$/.test(t.nodeName)&&!/^(fixed|absolute)/i.test(t.style.position)&&"true"!==e.getContentEditable(t)},Jy=function(e,t,n){return!1===xo.isText(t)?n:e?1===n&&t.data.charAt(n-1)===pi?0:n:n===t.data.length-1&&t.data.charAt(n)===pi?t.data.length:n},Gy=function(e,t){var n,r,o=e.getRoot();for(n=t;n!==o&&"false"!==e.getContentEditable(n);)"true"===e.getContentEditable(n)&&(r=n),n=n.parentNode;return n!==o?r:o},Xy=function(e,t){var n=Cc(e);n&&n.toLowerCase()===t.tagName.toLowerCase()&&e.dom.setAttribs(t,wc(e))},Yy=function(e,t){var n,r,o,i,a,c,s,l,u,d,f,m,p,g=e.dom,h=e.schema,v=h.getNonEmptyElements(),b=e.selection.getRng(),y=function(t){var n,i,c,s=o,l=h.getTextInlineElements();if(t||"TABLE"===d||"HR"===d?(n=g.create(t||m),Xy(e,n)):n=a.cloneNode(!1),c=n,!1===Tc(e))g.setAttrib(n,"style",null),g.setAttrib(n,"class",null);else do{if(l[s.nodeName]){if(sl(s))continue;i=s.cloneNode(!1),g.setAttrib(i,"id",""),n.hasChildNodes()?(i.appendChild(n.firstChild),n.appendChild(i)):(c=i,n.appendChild(i))}}while((s=s.parentNode)&&s!==r);return Vy(c),n},C=function(e){var t,n,r,c;if(c=Jy(e,o,i),xo.isText(o)&&(e?c>0:c<o.nodeValue.length))return!1;if(o.parentNode===a&&p&&!e)return!0;if(e&&xo.isElement(o)&&o===a.firstChild)return!0;if($y(o,"TABLE")||$y(o,"HR"))return p&&!e||!p&&e;for(t=new Xr(o,a),xo.isText(o)&&(e&&0===c?t.prev():e||c!==o.nodeValue.length||t.next());n=t.current();){if(xo.isElement(n)){if(!n.getAttribute("data-mce-bogus")&&(r=n.nodeName.toLowerCase(),v[r]&&"br"!==r))return!1}else if(xo.isText(n)&&!/^[ \t\r\n]*$/.test(n.nodeValue))return!1;e?t.prev():t.next()}return!0},w=function(){s=/^(H[1-6]|PRE|FIGURE)$/.test(d)&&"HGROUP"!==f?y(m):y(),Ec(e)&&Ky(g,u)&&g.isEmpty(a)?s=g.split(u,a):g.insertAfter(s,a),Oy(e,s)};Yf.normalize(g,b).each((function(e){b.setStart(e.startContainer,e.startOffset),b.setEnd(e.endContainer,e.endOffset)})),o=b.startContainer,i=b.startOffset,m=Cc(e),c=t.shiftKey,xo.isElement(o)&&o.hasChildNodes()&&(p=i>o.childNodes.length-1,o=o.childNodes[Math.min(i,o.childNodes.length-1)]||o,i=p&&xo.isText(o)?o.nodeValue.length:0),(r=Gy(g,o))&&((m&&!c||!m&&c)&&(o=function(e,t,n,r,o){var i,a,c,s,l,u,d=t||"P",f=e.dom,m=Gy(f,r);if(!(a=f.getParent(r,f.isBlock))||!Ky(f,a)){if(u=(a=a||m)===e.getBody()||function(e){return e&&/^(TD|TH|CAPTION)$/.test(e.nodeName)}(a)?a.nodeName.toLowerCase():a.parentNode.nodeName.toLowerCase(),!a.hasChildNodes())return i=f.create(d),Xy(e,i),a.appendChild(i),n.setStart(i,0),n.setEnd(i,0),i;for(s=r;s.parentNode!==a;)s=s.parentNode;for(;s&&!f.isBlock(s);)c=s,s=s.previousSibling;if(c&&e.schema.isValidChild(u,d.toLowerCase())){for(i=f.create(d),Xy(e,i),c.parentNode.insertBefore(i,c),s=c;s&&!f.isBlock(s);)l=s.nextSibling,i.appendChild(s),s=l;n.setStart(r,o),n.setEnd(r,o)}}return r}(e,m,b,o,i)),a=g.getParent(o,g.isBlock),u=a?g.getParent(a.parentNode,g.isBlock):null,d=a?a.nodeName.toUpperCase():"","LI"!==(f=u?u.nodeName.toUpperCase():"")||t.ctrlKey||(a=u,u=u.parentNode,d=f),/^(LI|DT|DD)$/.test(d)&&g.isEmpty(a)?qy(e,y,u,a,m):m&&a===e.getBody()||(m=m||"P",bi(a)?(s=Ni(a),g.isEmpty(a)&&Vy(a),Oy(e,s)):C()?w():C(!0)?(s=a.parentNode.insertBefore(y(),a),Oy(e,$y(a,"HR")?s:a)):((n=function(e){var t=e.cloneRange();return t.setStart(e.startContainer,Jy(!0,e.startContainer,e.startOffset)),t.setEnd(e.endContainer,Jy(!1,e.endContainer,e.endOffset)),t}(b).cloneRange()).setEndAfter(a),function(e){do{xo.isText(e)&&(e.nodeValue=e.nodeValue.replace(/^[\r\n]+/,"")),e=e.firstChild}while(e)}(l=n.extractContents()),s=l.firstChild,g.insertAfter(l,a),function(e,t,n){var r,o=n,i=[];if(o){for(;o=o.firstChild;){if(e.isBlock(o))return;xo.isElement(o)&&!t[o.nodeName.toLowerCase()]&&i.push(o)}for(r=i.length;r--;)!(o=i[r]).hasChildNodes()||o.firstChild===o.lastChild&&""===o.firstChild.nodeValue?e.remove(o):(a=o)&&"A"===a.nodeName&&0===Ot.trim(gi(a.innerText||a.textContent)).length&&e.remove(o);var a}}(g,v,s),function(e,t){var n;t.normalize(),(n=t.lastChild)&&!/^(left|right)$/gi.test(e.getStyle(n,"float",!0))||e.add(t,"br")}(g,a),g.isEmpty(a)&&Vy(a),s.normalize(),g.isEmpty(s)?(g.remove(s),w()):Oy(e,s)),g.setAttrib(s,"id",""),e.fire("NewBlock",{newBlock:s})))},Qy=function(e,t){return Ly(e).filter((function(e){return t.length>0&&Tr.is(On.fromDom(e),t)})).isSome()},Zy=function(e){return Qy(e,xc(e))},eC=function(e){return Qy(e,kc(e))},tC=Uu([{br:[]},{block:[]},{none:[]}]),nC=function(e,t){return eC(e)},rC=function(e){return function(t,n){return""===Cc(t)===e}},oC=function(e){return function(t,n){return jy(t)===e}},iC=function(e,t){return function(n,r){return Fy(n)===e.toUpperCase()===t}},aC=function(e){return iC("pre",e)},cC=function(e){return function(t,n){return yc(t)===e}},sC=function(e,t){return Zy(e)},lC=function(e,t){return t},uC=function(e){var t=Cc(e),n=My(e.dom,e.selection.getStart());return n&&e.schema.isValidChild(n.nodeName,t||"P")},dC=function(e,t){return function(n,r){return H.foldl(e,(function(e,t){return e&&t(n,r)}),!0)?T.some(t):T.none()}},fC=function(e,t){return hd([dC([nC],tC.none()),dC([iC("summary",!0)],tC.br()),dC([aC(!0),cC(!1),lC],tC.br()),dC([aC(!0),cC(!1)],tC.block()),dC([aC(!0),cC(!0),lC],tC.block()),dC([aC(!0),cC(!0)],tC.br()),dC([oC(!0),lC],tC.br()),dC([oC(!0)],tC.block()),dC([rC(!0),lC,uC],tC.block()),dC([rC(!0)],tC.br()),dC([sC],tC.br()),dC([rC(!1),lC],tC.br()),dC([uC],tC.block())],[e,t.shiftKey]).getOr(tC.none())},mC=function(e,t){fC(e,t).fold((function(){cm.insert(e,t)}),(function(){Yy(e,t)}),b.noop)},pC=function(e){e.on("keydown",(function(t){t.keyCode===Ug.ENTER&&function(e,t){var n;t.isDefaultPrevented()||(t.preventDefault(),(n=e.undoManager).typing&&(n.typing=!1,n.add()),e.undoManager.transact((function(){!1===e.selection.isCollapsed()&&e.execCommand("Delete"),mC(e,t)})))}(e,t)}))},gC=function(e,t,n){return!!function(e,t){return hC(e)&&xo.isText(t.container())}(n,t)&&(function(e,t){var n=t.container(),r=t.offset();n.insertData(r," "),e.selection.setCursorLocation(n,r+1)}(e,t),!0)},hC=function(e){return e.fold(b.constant(!1),b.constant(!0),b.constant(!0),b.constant(!1))},vC=function(e){return!!e.selection.isCollapsed()&&function(e){var t=b.curry(au.isInlineTarget,e),n=wa.fromRangeStart(e.selection.getRng());return Dd(t,e.getBody(),n).map(b.curry(gC,e,n)).getOr(!1)}(e)},bC=function(e){e.on("keydown",(function(t){!1===t.isDefaultPrevented()&&function(e,t){Ny([{keyCode:Ug.SPACEBAR,action:Sy(vC,e)}],t).each((function(e){t.preventDefault()}))}(e,t)}))},yC=function(e,t){t.hasAttribute("data-mce-caret")&&(Ni(t),function(e){e.selection.setRng(e.selection.getRng())}(e),e.selection.scrollIntoView(t))},CC=function(e,t){var n=function(e){return fu(On.fromDom(e.getBody()),"*[data-mce-caret]").fold(b.constant(null),(function(e){return e.dom()}))}(e);if(n)return"compositionstart"===t.type?(t.preventDefault(),t.stopPropagation(),void yC(e,n)):void(wi(n)&&(yC(e,n),e.undoManager.add()))},wC=function(e){e.on("keyup compositionstart",b.curry(CC,e))},xC=function(e){var t=$d.setupSelectedState(e);wC(e),Ay(e,t),Py(e,t),pC(e),bC(e)};function kC(e){var t,n,r,o=Ot.each,i=Ug.BACKSPACE,a=Ug.DELETE,c=e.dom,s=e.selection,l=e.settings,u=e.parser,d=ge.gecko,f=ge.ie,m=ge.webkit,p=f?"Text":"URL",g=function(t,n){try{e.getDoc().execCommand(t,!1,n)}catch(e){}},h=function(e){return e.isDefaultPrevented()},v=function(){e.shortcuts.add("meta+a",null,"SelectAll")},b=function(){e.on("keydown",(function(e){if(!h(e)&&e.keyCode===i&&s.isCollapsed()&&0===s.getRng().startOffset){var t=s.getNode().previousSibling;if(t&&t.nodeName&&"table"===t.nodeName.toLowerCase())return e.preventDefault(),!1}}))},y=function(){e.inline||(e.contentStyles.push("body {min-height: 150px}"),e.on("click",(function(t){var n;if("HTML"===t.target.nodeName){if(ge.ie>11)return void e.getBody().focus();n=e.selection.getRng(),e.getBody().focus(),e.selection.setRng(n),e.selection.normalize(),e.nodeChanged()}})))};return e.on("keydown",(function(t){var n,r,o,i,a;if(!h(t)&&t.keyCode===Ug.BACKSPACE&&(r=(n=s.getRng()).startContainer,o=n.startOffset,i=c.getRoot(),a=r,n.collapsed&&0===o)){for(;a&&a.parentNode&&a.parentNode.firstChild===a&&a.parentNode!==i;)a=a.parentNode;"BLOCKQUOTE"===a.tagName&&(e.formatter.toggle("blockquote",null,a),(n=c.createRng()).setStart(r,0),n.setEnd(r,0),s.setRng(n))}})),t=function(e){var t=c.create("body"),n=e.cloneContents();return t.appendChild(n),s.serializer.serialize(t,{format:"html"})},e.on("keydown",(function(n){var r,o,s=n.keyCode;if(!h(n)&&(s===a||s===i)){if(r=e.selection.isCollapsed(),o=e.getBody(),r&&!c.isEmpty(o))return;if(!r&&!function(n){var r=t(n),o=c.createRng();return o.selectNode(e.getBody()),r===t(o)}(e.selection.getRng()))return;n.preventDefault(),e.setContent(""),o.firstChild&&c.isBlock(o.firstChild)?e.selection.setCursorLocation(o.firstChild,0):e.selection.setCursorLocation(o,0),e.nodeChanged()}})),ge.windowsPhone||e.on("keyup focusin mouseup",(function(e){Ug.modifierPressed(e)||s.normalize()}),!0),m&&(e.settings.content_editable||c.bind(e.getDoc(),"mousedown mouseup",(function(t){var n;if(t.target===e.getDoc().documentElement)if(n=s.getRng(),e.getBody().focus(),"mousedown"===t.type){if(Ci(n.startContainer))return;s.placeCaretAt(t.clientX,t.clientY)}else s.setRng(n)})),e.on("click",(function(t){var n=t.target;/^(IMG|HR)$/.test(n.nodeName)&&"false"!==c.getContentEditableParent(n)&&(t.preventDefault(),e.selection.select(n),e.nodeChanged()),"A"===n.nodeName&&c.hasClass(n,"mce-item-anchor")&&(t.preventDefault(),s.select(n))})),l.forced_root_block&&e.on("init",(function(){g("DefaultParagraphSeparator",l.forced_root_block)})),e.on("init",(function(){e.dom.bind(e.getBody(),"submit",(function(e){e.preventDefault()}))})),b(),u.addNodeFilter("br",(function(e){for(var t=e.length;t--;)"Apple-interchange-newline"===e[t].attr("class")&&e[t].remove()})),ge.iOS?(e.inline||e.on("keydown",(function(){document.activeElement===document.body&&e.getWin().focus()})),y(),e.on("click",(function(e){var t=e.target;do{if("A"===t.tagName)return void e.preventDefault()}while(t=t.parentNode)})),e.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")):v()),ge.ie>=11&&(y(),b()),ge.ie&&(v(),g("AutoUrlDetect",!1),e.on("dragstart",(function(t){!function(t){var n,r;t.dataTransfer&&(e.selection.isCollapsed()&&"IMG"===t.target.tagName&&s.select(t.target),(n=e.selection.getContent()).length>0&&(r="data:text/mce-internal,"+escape(e.id)+","+escape(n),t.dataTransfer.setData(p,r)))}(t)})),e.on("drop",(function(t){if(!h(t)){var n=function(e){var t;return e.dataTransfer&&(t=e.dataTransfer.getData(p))&&t.indexOf("data:text/mce-internal,")>=0?(t=t.substr("data:text/mce-internal,".length).split(","),{id:unescape(t[0]),html:unescape(t[1])}):null}(t);if(n&&n.id!==e.id){t.preventDefault();var r=_b.fromPoint(t.x,t.y,e.getDoc());s.setRng(r),o=n.html,i=!0,e.queryCommandSupported("mceInsertClipboardContent")?e.execCommand("mceInsertClipboardContent",!1,{content:o,internal:i}):e.execCommand("mceInsertContent",!1,o)}}var o,i}))),d&&(e.on("keydown",(function(t){if(!h(t)&&t.keyCode===i){if(!e.getBody().getElementsByTagName("hr").length)return;if(s.isCollapsed()&&0===s.getRng().startOffset){var n=s.getNode(),r=n.previousSibling;if("HR"===n.nodeName)return c.remove(n),void t.preventDefault();r&&r.nodeName&&"hr"===r.nodeName.toLowerCase()&&(c.remove(r),t.preventDefault())}}})),Range.prototype.getClientRects||e.on("mousedown",(function(t){if(!h(t)&&"HTML"===t.target.nodeName){var n=e.getBody();n.blur(),Ce.setEditorTimeout(e,(function(){n.focus()}))}})),n=function(){var t=c.getAttribs(s.getStart().cloneNode(!1));return function(){var n=s.getStart();n!==e.getBody()&&(c.setAttrib(n,"style",null),o(t,(function(e){n.setAttributeNode(e.cloneNode(!0))})))}},r=function(){return!s.isCollapsed()&&c.getParent(s.getStart(),c.isBlock)!==c.getParent(s.getEnd(),c.isBlock)},e.on("keypress",(function(t){var o;if(!h(t)&&(8===t.keyCode||46===t.keyCode)&&r())return o=n(),e.getDoc().execCommand("delete",!1,null),o(),t.preventDefault(),!1})),c.bind(e.getDoc(),"cut",(function(t){var o;!h(t)&&r()&&(o=n(),Ce.setEditorTimeout(e,(function(){o()})))})),l.readonly||e.on("BeforeExecCommand MouseDown",(function(){g("StyleWithCSS",!1),g("enableInlineTableEditing",!1),l.object_resizing||g("enableObjectResizing",!1)})),e.on("SetContent ExecCommand",(function(e){"setcontent"!==e.type&&"mceInsertLink"!==e.command||o(c.select("a"),(function(e){var t=e.parentNode,n=c.getRoot();if(t.lastChild===e){for(;t&&!c.isBlock(t);){if(t.parentNode.lastChild!==t||t===n)return;t=t.parentNode}c.add(t,"br",{"data-mce-bogus":1})}}))})),e.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}"),ge.mac&&e.on("keydown",(function(t){!Ug.metaKeyPressed(t)||t.shiftKey||37!==t.keyCode&&39!==t.keyCode||(t.preventDefault(),e.selection.getSel().modify("move",37===t.keyCode?"backward":"forward","lineboundary"))})),b()),{refreshContentEditable:function(){},isHidden:function(){var t;return!d||e.removed?0:!(t=e.selection.getSel())||!t.rangeCount||0===t.rangeCount}}}var TC=function(e){return xo.isElement(e)&&io(On.fromDom(e))},EC=function(e){e.on("click",(function(t){3===t.detail&&function(e){var t=e.selection.getRng(),n=ya.fromRangeStart(t),r=ya.fromRangeEnd(t);if(ya.isElementPosition(n)){var o=n.container();TC(o)&&Fa.firstPositionIn(o).each((function(e){return t.setStart(e.container(),e.offset())}))}ya.isElementPosition(r)&&(o=n.container(),TC(o)&&Fa.lastPositionIn(o).each((function(e){return t.setEnd(e.container(),e.offset())}))),e.selection.setRng(Pl(t))}(e)}))},SC=function(e){!function(e){e.on("click",(function(t){e.dom.getParent(t.target,"details")&&t.preventDefault()}))}(e),function(e){e.parser.addNodeFilter("details",(function(e){H.each(e,(function(e){e.attr("data-mce-open",e.attr("open")),e.attr("open","open")}))})),e.serializer.addNodeFilter("details",(function(e){H.each(e,(function(e){var t=e.attr("data-mce-open");e.attr("open",S.isString(t)?t:null),e.attr("data-mce-open",null)}))}))}(e)},NC=ii.DOM,AC=function(e){e.bindPendingEventDelegates(),e.initialized=!0,e.fire("init"),e.focus(!0),e.nodeChanged({initial:!0}),e.execCallback("init_instance_callback",e),function(e){e.settings.auto_focus&&Ce.setEditorTimeout(e,(function(){var t;(t=!0===e.settings.auto_focus?e:e.editorManager.get(e.settings.auto_focus)).destroyed||t.focus()}),100)}(e)},RC=function(e,t){var n,r,o=e.settings,i=e.getElement(),a=e.getDoc();o.inline||(e.getElement().style.visibility=e.orgVisibility),t||o.content_editable||(a.open(),a.write(e.iframeHTML),a.close()),o.content_editable&&(e.on("remove",(function(){var e=this.getBody();NC.removeClass(e,"mce-content-body"),NC.removeClass(e,"mce-edit-focus"),NC.setAttrib(e,"contentEditable",null)})),NC.addClass(i,"mce-content-body"),e.contentDocument=a=o.content_document||document,e.contentWindow=o.content_window||window,e.bodyElement=i,o.content_document=o.content_window=null,o.root_name=i.nodeName.toLowerCase()),(n=e.getBody()).disabled=!0,e.readonly=o.readonly,e.readonly||(e.inline&&"static"===NC.getStyle(n,"position",!0)&&(n.style.position="relative"),n.contentEditable=e.getParam("content_editable_state",!0)),n.disabled=!1,e.editorUpload=ag(e),e.schema=Ko(o),e.dom=ii(a,{keep_values:!0,url_converter:e.convertURL,url_converter_scope:e,hex_colors:o.force_hex_style_colors,class_filter:o.class_filter,update_styles:!0,root_element:e.inline?e.getBody():null,collect:o.content_editable,schema:e.schema,onSetAttrib:function(t){e.fire("SetAttrib",t)}}),e.parser=function(e){var t=bb(e.settings,e.schema);return t.addAttributeFilter("src,href,style,tabindex",(function(t,n){for(var r,o,i,a=t.length,c=e.dom;a--;)if(o=(r=t[a]).attr(n),i="data-mce-"+n,!r.attributes.map[i]){if(0===o.indexOf("data:")||0===o.indexOf("blob:"))continue;"style"===n?((o=c.serializeStyle(c.parseStyle(o),r.name)).length||(o=null),r.attr(i,o),r.attr(n,o)):"tabindex"===n?(r.attr(i,o),r.attr(n,null)):r.attr(i,e.convertURL(o,n,r.name))}})),t.addNodeFilter("script",(function(e){for(var t,n,r=e.length;r--;)0!==(n=(t=e[r]).attr("type")||"no/type").indexOf("mce-")&&t.attr("type","mce-"+n)})),t.addNodeFilter("#cdata",(function(e){for(var t,n=e.length;n--;)(t=e[n]).type=8,t.name="#comment",t.value="[CDATA["+t.value+"]]"})),t.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",(function(t){for(var n,r=t.length,o=e.schema.getNonEmptyElements();r--;)(n=t[r]).isEmpty(o)&&0===n.getAll("br").length&&(n.append(new cb("br",1)).shortEnded=!0)})),t}(e),e.serializer=kb(o,e),e.selection=py(e.dom,e.getWin(),e.serializer,e),e.formatter=Jv(e),e.undoManager=Ch(e),e._nodeChangeDispatcher=new fg(e),e._selectionOverrides=Kg(e),SC(e),EC(e),xC(e),dg(e),e.fire("PreInit"),o.browser_spellcheck||o.gecko_spellcheck||(a.body.spellcheck=!1,NC.setAttrib(n,"spellcheck","false")),e.quirks=kC(e),e.fire("PostRender"),o.directionality&&(n.dir=o.directionality),o.nowrap&&(n.style.whiteSpace="nowrap"),o.protect&&e.on("BeforeSetContent",(function(e){Ot.each(o.protect,(function(t){e.content=e.content.replace(t,(function(e){return"\x3c!--mce:protected "+escape(e)+"--\x3e"}))}))})),e.on("SetContent",(function(){e.addVisual(e.getBody())})),e.load({initial:!0,format:"html"}),e.startContent=e.getContent({format:"raw"}),e.on("compositionstart compositionend",(function(t){e.composing="compositionstart"===t.type})),e.contentStyles.length>0&&(r="",Ot.each(e.contentStyles,(function(e){r+=e+"\r\n"})),e.dom.addStyle(r)),function(e){return e.inline?NC.styleSheetLoader:e.dom.styleSheetLoader}(e).loadAll(e.contentCSS,(function(t){AC(e)}),(function(t){AC(e)})),o.content_style&&function(e,t){var n=On.fromDom(e.getDoc().head),r=On.fromTag("style");rr.set(r,"type","text/css"),_c.append(r,On.fromText(t)),_c.append(n,r)}(e,o.content_style)},_C=ii.DOM,IC=function(e){var t="number"==typeof e?e+"px":e;return t||""},BC=function(e,t){var n=e.editorManager.translate("Rich Text Area. Press ALT-F9 for menu. Press ALT-F10 for toolbar. Press ALT-0 for help"),r=function(e,t,n,r){var o=On.fromTag("iframe");return rr.setAll(o,r),rr.setAll(o,{id:e+"_ifr",frameBorder:"0",allowTransparency:"true",title:t}),dr(o,{width:"100%",height:IC(n),display:"block"}),o}(e.id,n,t.height,mc(e)).dom();r.onload=function(){r.onload=null,e.fire("load")};var o=function(e,t){if(document.domain!==window.location.hostname&&ge.ie&&ge.ie<12){var n=ig.uuid("mce");e[n]=function(){RC(e)};var r='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinymce.get("'+e.id+'");document.write(ed.iframeHTML);document.close();ed.'+n+"(true);})()";return _C.setAttrib(t,"src",r),!0}return!1}(e,r);return e.contentAreaContainer=t.iframeContainer,e.iframeElement=r,e.iframeHTML=function(e){var t,n,r;return r=pc(e)+"<html><head>",gc(e)!==e.documentBaseUrl&&(r+='<base href="'+e.documentBaseURI.getURI()+'" />'),r+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />',t=hc(e),n=vc(e),bc(e)&&(r+='<meta http-equiv="Content-Security-Policy" content="'+bc(e)+'" />'),r+='</head><body id="'+t+'" class="mce-content-body '+n+'" data-id="'+e.id+'"><br></body></html>'}(e),_C.add(t.iframeContainer,r),o},PC=function(e,t){var n=BC(e,t);t.editorContainer&&(_C.get(t.editorContainer).style.display=e.orgDisplay,e.hidden=_C.isHidden(t.editorContainer)),e.getElement().style.display="none",_C.setAttrib(e.id,"aria-hidden","true"),n||RC(e)},DC=ii.DOM,OC=function(e,t,n){var r,o,i=Wp.get(n);if(r=Wp.urls[n]||e.documentBaseUrl.replace(/\/$/,""),n=Ot.trim(n),i&&-1===Ot.inArray(t,n)){if(Ot.each(Wp.dependencies(n),(function(n){OC(e,t,n)})),e.plugins[n])return;o=new i(e,r,e.$),e.plugins[n]=o,o.init&&(o.init(e,r),t.push(n))}},MC=function(e){return e.replace(/^\-/,"")},LC=function(e){return{editorContainer:e,iframeContainer:e}},FC=function(e){var t=e.getElement();return e.inline?LC(null):function(e){var t=DC.create("div");return DC.insertAfter(t,e),LC(t)}(t)},jC=function(e){var t=e.settings,n=e.getElement();return e.orgDisplay=n.style.display,S.isString(t.theme)?function(e){var t,n,r,o,i,a=e.settings,c=e.getElement();return t=a.width||DC.getStyle(c,"width")||"100%",n=a.height||DC.getStyle(c,"height")||c.offsetHeight,r=a.min_height||100,(o=/^[0-9\.]+(|px)$/i).test(""+t)&&(t=Math.max(parseInt(t,10),100)),o.test(""+n)&&(n=Math.max(parseInt(n,10),r)),i=e.theme.renderUI({targetNode:c,width:t,height:n,deltaWidth:a.delta_width,deltaHeight:a.delta_height}),a.content_editable||(n=(i.iframeHeight||n)+("number"==typeof n?i.deltaHeight||0:""))<r&&(n=r),i.height=n,i}(e):S.isFunction(t.theme)?function(e){var t,n=e.getElement();return(t=e.settings.theme(e,n)).editorContainer.nodeType&&(t.editorContainer.id=t.editorContainer.id||e.id+"_parent"),t.iframeContainer&&t.iframeContainer.nodeType&&(t.iframeContainer.id=t.iframeContainer.id||e.id+"_iframecontainer"),t.height=t.iframeHeight?t.iframeHeight:n.offsetHeight,t}(e):FC(e)},HC=function(e){var t,n=e.settings,r=e.getElement();return e.rtl=n.rtl_ui||e.editorManager.i18n.rtl,e.editorManager.i18n.setCode(n.language),n.aria_label=n.aria_label||DC.getAttrib(r,"aria-label",e.getLang("aria.rich_text_area")),e.fire("ScriptsLoaded"),function(e){var t,n=e.settings.theme;S.isString(n)?(e.settings.theme=MC(n),t=zp.get(n),e.theme=new t(e,zp.urls[n]),e.theme.init&&e.theme.init(e,zp.urls[n]||e.documentBaseUrl.replace(/\/$/,""),e.$)):e.theme={}}(e),function(e){var t=[];Ot.each(e.settings.plugins.split(/[ ,]/),(function(n){OC(e,t,MC(n))}))}(e),t=jC(e),e.editorContainer=t.editorContainer?t.editorContainer:null,n.content_css&&Ot.each(Ot.explode(n.content_css),(function(t){e.contentCSS.push(e.documentBaseURI.toAbsolute(t))})),n.content_editable?RC(e):PC(e,t)},UC=ii.DOM,WC=function(e){return"-"===e.charAt(0)},zC=function(e,t){var n=ui.ScriptLoader;!function(e,t,n,r){var o=t.settings,i=o.theme;if(S.isString(i)){if(!WC(i)&&!zp.urls.hasOwnProperty(i)){var a=o.theme_url;a?zp.load(i,t.documentBaseURI.toAbsolute(a)):zp.load(i,"themes/"+i+"/theme"+n+".js")}e.loadQueue((function(){zp.waitFor(i,r)}))}else r()}(n,e,t,(function(){!function(e,t){var n=t.settings;n.language&&"en"!==n.language&&!n.language_url&&(n.language_url=t.editorManager.baseURL+"/langs/"+n.language+".js"),n.language_url&&!t.editorManager.i18n.data[n.language]&&e.add(n.language_url)}(n,e),function(e,t){Ot.isArray(e.plugins)&&(e.plugins=e.plugins.join(" ")),Ot.each(e.external_plugins,(function(t,n){Wp.load(n,t),e.plugins+=" "+n})),Ot.each(e.plugins.split(/[ ,]/),(function(e){if((e=Ot.trim(e))&&!Wp.urls[e])if(WC(e)){e=e.substr(1,e.length);var n=Wp.dependencies(e);Ot.each(n,(function(e){var n={prefix:"plugins/",resource:e,suffix:"/plugin"+t+".js"};e=Wp.createUrl(n,e),Wp.load(e.resource,e)}))}else Wp.load(e,{prefix:"plugins/",resource:e,suffix:"/plugin"+t+".js"})}))}(e.settings,t),n.loadQueue((function(){e.removed||HC(e)}),e,(function(t){Up.pluginLoadError(e,t[0]),e.removed||HC(e)}))}))},qC=function(e){var t=e.settings,n=e.id,r=function(){UC.unbind(window,"ready",r),e.render()};if(Re.Event.domLoaded){if(e.getElement()&&ge.contentEditable){t.inline?e.inline=!0:(e.orgVisibility=e.getElement().style.visibility,e.getElement().style.visibility="hidden");var o=e.getElement().form||UC.getParent(n,"form");o&&(e.formElement=o,t.hidden_input&&!/TEXTAREA|INPUT/i.test(e.getElement().nodeName)&&(UC.insertAfter(UC.create("input",{type:"hidden",name:n}),n),e.hasHiddenInput=!0),e.formEventDelegate=function(t){e.fire(t.type,t)},UC.bind(o,"submit reset",e.formEventDelegate),e.on("reset",(function(){e.setContent(e.startContent,{format:"raw"})})),!t.submit_patch||o.submit.nodeType||o.submit.length||o._mceOldSubmit||(o._mceOldSubmit=o.submit,o.submit=function(){return e.editorManager.triggerSave(),e.setDirty(!1),o._mceOldSubmit(o)})),e.windowManager=Mp(e),e.notificationManager=Op(e),"xml"===t.encoding&&e.on("GetContent",(function(e){e.save&&(e.content=UC.encode(e.content))})),t.add_form_submit_trigger&&e.on("submit",(function(){e.initialized&&e.save()})),t.add_unload_trigger&&(e._beforeUnload=function(){!e.initialized||e.destroyed||e.isHidden()||e.save({format:"raw",no_events:!0,set_dirty:!1})},e.editorManager.on("BeforeUnload",e._beforeUnload)),e.editorManager.add(e),zC(e,e.suffix)}}else UC.bind(window,"ready",r)},VC=function(e,t,n){var r=e.sidebars?e.sidebars:[];r.push({name:t,settings:n}),e.sidebars=r},$C=Ot.each,KC=Ot.trim,JC="source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),GC={ftp:21,http:80,https:443,mailto:25},XC=function(e,t){var n,r,o=this;if(e=KC(e),n=(t=o.settings=t||{}).base_uri,/^([\w\-]+):([^\/]{2})/i.test(e)||/^\s*#/.test(e))o.source=e;else{var i=0===e.indexOf("//");0!==e.indexOf("/")||i||(e=(n&&n.protocol||"http")+"://mce_host"+e),/^[\w\-]*:?\/\//.test(e)||(r=t.base_uri?t.base_uri.path:new XC(document.location.href).directory,""==t.base_uri.protocol?e="//mce_host"+o.toAbsPath(r,e):(e=/([^#?]*)([#?]?.*)/.exec(e),e=(n&&n.protocol||"http")+"://mce_host"+o.toAbsPath(r,e[1])+e[2])),e=e.replace(/@@/g,"(mce_at)"),e=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(e),$C(JC,(function(t,n){var r=e[n];r&&(r=r.replace(/\(mce_at\)/g,"@@")),o[t]=r})),n&&(o.protocol||(o.protocol=n.protocol),o.userInfo||(o.userInfo=n.userInfo),o.port||"mce_host"!==o.host||(o.port=n.port),o.host&&"mce_host"!==o.host||(o.host=n.host),o.source=""),i&&(o.protocol="")}};XC.prototype={setPath:function(e){e=/^(.*?)\/?(\w+)?$/.exec(e),this.path=e[0],this.directory=e[1],this.file=e[2],this.source="",this.getURI()},toRelative:function(e){var t;if("./"===e)return e;if("mce_host"!==(e=new XC(e,{base_uri:this})).host&&this.host!==e.host&&e.host||this.port!==e.port||this.protocol!==e.protocol&&""!==e.protocol)return e.getURI();var n=this.getURI(),r=e.getURI();return n===r||"/"===n.charAt(n.length-1)&&n.substr(0,n.length-1)===r?n:(t=this.toRelPath(this.path,e.path),e.query&&(t+="?"+e.query),e.anchor&&(t+="#"+e.anchor),t)},toAbsolute:function(e,t){return(e=new XC(e,{base_uri:this})).getURI(t&&this.isSameOrigin(e))},isSameOrigin:function(e){if(this.host==e.host&&this.protocol==e.protocol){if(this.port==e.port)return!0;var t=GC[this.protocol];if(t&&(this.port||t)==(e.port||t))return!0}return!1},toRelPath:function(e,t){var n,r,o,i=0,a="";if(e=(e=e.substring(0,e.lastIndexOf("/"))).split("/"),n=t.split("/"),e.length>=n.length)for(r=0,o=e.length;r<o;r++)if(r>=n.length||e[r]!==n[r]){i=r+1;break}if(e.length<n.length)for(r=0,o=n.length;r<o;r++)if(r>=e.length||e[r]!==n[r]){i=r+1;break}if(1===i)return t;for(r=0,o=e.length-(i-1);r<o;r++)a+="../";for(r=i-1,o=n.length;r<o;r++)a+=r!==i-1?"/"+n[r]:n[r];return a},toAbsPath:function(e,t){var n,r,o,i=0,a=[];for(r=/\/$/.test(t)?"/":"",e=e.split("/"),t=t.split("/"),$C(e,(function(e){e&&a.push(e)})),e=a,n=t.length-1,a=[];n>=0;n--)0!==t[n].length&&"."!==t[n]&&(".."!==t[n]?i>0?i--:a.push(t[n]):i++);return 0!==(o=(n=e.length-i)<=0?a.reverse().join("/"):e.slice(0,n).join("/")+"/"+a.reverse().join("/")).indexOf("/")&&(o="/"+o),r&&o.lastIndexOf("/")!==o.length-1&&(o+=r),o},getURI:function(e){var t;return this.source&&!e||(t="",e||(this.protocol?t+=this.protocol+"://":t+="//",this.userInfo&&(t+=this.userInfo+"@"),this.host&&(t+=this.host),this.port&&(t+=":"+this.port)),this.path&&(t+=this.path),this.query&&(t+="?"+this.query),this.anchor&&(t+="#"+this.anchor),this.source=t),this.source}},XC.parseDataUri=function(e){var t,n;return e=decodeURIComponent(e).split(","),(n=/data:([^;]+)/.exec(e[0]))&&(t=n[1]),{type:t,data:e[1]}},XC.getDocumentBaseUrl=function(e){var t;return t=0!==e.protocol.indexOf("http")&&"file:"!==e.protocol?e.href:e.protocol+"//"+e.host+e.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(t)&&(t=t.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(t)||(t+="/")),t};var YC=function(e,t,n){var r;if(t.format=t.format?t.format:"html",t.get=!0,t.getInner=!0,t.no_events||e.fire("BeforeGetContent",t),"raw"===t.format)r=Ot.trim(th.trimExternal(e.serializer,n.innerHTML));else if("text"===t.format)r=gi(n.innerText||n.textContent);else{if("tree"===t.format)return e.serializer.serialize(n,t);r=function(e,t){var n=Cc(e),r=new RegExp("^(<"+n+"[^>]*>(&nbsp;|&#160;|\\s| |<br \\/>|)<\\/"+n+">[\r\n]*|<br \\/>[\r\n]*)$");return t.replace(r,"")}(e,e.serializer.serialize(n,t))}return"text"!==t.format?t.content=Ot.trim(r):t.content=r,t.no_events||e.fire("GetContent",t),t.content},QC=function(e,t){t(e),e.firstChild&&QC(e.firstChild,t),e.next&&QC(e.next,t)},ZC=function(e,t,n){var r=function(e,t,n){var r={},o={},i=[];for(var a in n.firstChild&&QC(n.firstChild,(function(n){H.each(e,(function(e){e.name===n.name&&(r[e.name]?r[e.name].nodes.push(n):r[e.name]={filter:e,nodes:[n]})})),H.each(t,(function(e){"string"==typeof n.attr(e.name)&&(o[e.name]?o[e.name].nodes.push(n):o[e.name]={filter:e,nodes:[n]})}))})),r)r.hasOwnProperty(a)&&i.push(r[a]);for(var c in o)o.hasOwnProperty(c)&&i.push(o[c]);return i}(e,t,n);H.each(r,(function(e){H.each(e.filter.callbacks,(function(t){t(e.nodes,e.filter.name,{})}))}))},ew=function(e){return e instanceof cb},tw=function(e,t){e.dom.setHTML(e.getBody(),t),function(e){Np(e)&&Fa.firstPositionIn(e.getBody()).each((function(t){var n=t.getNode(),r=xo.isTable(n)?Fa.firstPositionIn(n).getOr(t):t;e.selection.setRng(r.toRange())}))}(e)},nw=function(e,t,n){return void 0===n&&(n={}),n.format=n.format?n.format:"html",n.set=!0,n.content=ew(t)?"":t,ew(t)||n.no_events||(e.fire("BeforeSetContent",n),t=n.content),T.from(e.getBody()).fold(b.constant(t),(function(r){return ew(t)?function(e,t,n,r){ZC(e.parser.getNodeFilters(),e.parser.getAttributeFilters(),n);var o=Il({validate:e.validate},e.schema).serialize(n);return r.content=Ot.trim(o),tw(e,r.content),r.no_events||e.fire("SetContent",r),n}(e,0,t,n):function(e,t,n,r){var o,i;return 0===n.length||/^\s+$/.test(n)?(i='<br data-mce-bogus="1">',"TABLE"===t.nodeName?n="<tr><td>"+i+"</td></tr>":/^(UL|OL)$/.test(t.nodeName)&&(n="<li>"+i+"</li>"),(o=Cc(e))&&e.schema.isValidChild(t.nodeName.toLowerCase(),o.toLowerCase())?(n=i,n=e.dom.createHTML(o,e.settings.forced_root_block_attrs,n)):n||(n='<br data-mce-bogus="1">'),tw(e,n),e.fire("SetContent",r)):("raw"!==r.format&&(n=Il({validate:e.validate},e.schema).serialize(e.parser.parse(n,{isRootContent:!0,insert:!0}))),r.content=Ot.trim(n),tw(e,r.content),r.no_events||e.fire("SetContent",r)),r.content}(e,r,t,n)}))},rw=ii.DOM,ow=function(e){return T.from(e).each((function(e){return e.destroy()}))},iw=function(e){if(!e.removed){var t=e._selectionOverrides,n=e.editorUpload,r=e.getBody(),o=e.getElement();r&&e.save(),e.removed=!0,e.unbindAllNativeEvents(),e.hasHiddenInput&&o&&rw.remove(o.nextSibling),!e.inline&&r&&function(e){rw.setStyle(e.id,"display",e.orgDisplay)}(e),Zm(e),e.editorManager.remove(e),rw.remove(e.getContainer()),ow(t),ow(n),e.destroy()}},aw=function(e,t){var n=e.selection,r=e.dom;e.destroyed||(t||e.removed?(t||(e.editorManager.off("beforeunload",e._beforeUnload),e.theme&&e.theme.destroy&&e.theme.destroy(),ow(n),ow(r)),function(e){var t=e.formElement;t&&(t._mceOldSubmit&&(t.submit=t._mceOldSubmit,t._mceOldSubmit=null),rw.unbind(t,"submit reset",e.formEventDelegate))}(e),function(e){e.contentAreaContainer=e.formElement=e.container=e.editorContainer=null,e.bodyElement=e.contentDocument=e.contentWindow=null,e.iframeElement=e.targetElm=null,e.selection&&(e.selection=e.selection.win=e.selection.dom=e.selection.dom.doc=null)}(e),e.destroyed=!0):e.remove())},cw=ii.DOM,sw=Ot.extend,lw=Ot.each,uw=Ot.resolve,dw=ge.ie,fw=function(e,t,n){var r=this,o=r.documentBaseUrl=n.documentBaseURL,i=n.baseURI;t=function(e,t,n,r,o){var i=function(e,t,n){return{id:e,theme:"modern",delta_width:0,delta_height:0,popup_css:"",plugins:"",document_base_url:t,add_form_submit_trigger:!0,submit_patch:!0,add_unload_trigger:!0,convert_urls:!0,relative_urls:!0,remove_script_host:!0,object_resizing:!0,doctype:"<!DOCTYPE html>",visual:!0,font_size_style_values:"xx-small,x-small,small,medium,large,x-large,xx-large",font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",forced_root_block:"p",hidden_input:!0,render_ui:!0,indentation:"30px",inline_styles:!0,convert_fonts_to_spans:!0,indent:"simple",indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist",entity_encoding:"named",url_converter:n.convertURL,url_converter_scope:n,ie7_compat:!0}}(t,n,e);return Ql(ql,i,r,o)}(r,e,o,n.defaultSettings,t),r.settings=t,fi.language=t.language||"en",fi.languageLoad=t.language_load,fi.baseURL=n.baseURL,r.id=e,r.setDirty(!1),r.plugins={},r.documentBaseURI=new XC(t.document_base_url,{base_uri:i}),r.baseURI=i,r.contentCSS=[],r.contentStyles=[],r.shortcuts=new hp(r),r.loadedCSS={},r.editorCommands=new Im(r),r.suffix=n.suffix,r.editorManager=n,r.inline=t.inline,r.buttons={},r.menuItems={},t.cache_suffix&&(ge.cacheSuffix=t.cache_suffix.replace(/^[\?\&]+/,"")),!1===t.override_viewport&&(ge.overrideViewPort=!1),n.fire("SetupEditor",{editor:r}),r.execCallback("setup",r),r.$=en.overrideDefaults((function(){return{context:r.inline?r.getBody():r.getDoc(),element:r.getBody()}}))};fw.prototype={render:function(){qC(this)},focus:function(e){Sp(this,e)},hasFocus:function(){return Np(this)},execCallback:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r,o=this,i=o.settings[e];if(i)return o.callbackLookup&&(r=o.callbackLookup[e])&&(i=r.func,r=r.scope),"string"==typeof i&&(r=(r=i.replace(/\.\w+$/,""))?uw(r):0,i=uw(i),o.callbackLookup=o.callbackLookup||{},o.callbackLookup[e]={func:i,scope:r}),i.apply(r||o,Array.prototype.slice.call(arguments,1))},translate:function(e){if(e&&Ot.is(e,"string")){var t=this.settings.language||"en",n=this.editorManager.i18n;e=n.data[t+"."+e]||e.replace(/\{\#([^\}]+)\}/g,(function(e,r){return n.data[t+"."+r]||"{#"+r+"}"}))}return this.editorManager.translate(e)},getLang:function(e,t){return this.editorManager.i18n.data[(this.settings.language||"en")+"."+e]||(void 0!==t?t:"{#"+e+"}")},getParam:function(e,t,n){return tu(this,e,t,n)},nodeChanged:function(e){this._nodeChangeDispatcher.nodeChanged(e)},addButton:function(e,t){var n=this;t.cmd&&(t.onclick=function(){n.execCommand(t.cmd)}),t.stateSelector&&void 0===t.active&&(t.active=!1),t.text||t.icon||(t.icon=e),n.buttons=n.buttons,t.tooltip=t.tooltip||t.title,n.buttons[e]=t},addSidebar:function(e,t){return VC(this,e,t)},addMenuItem:function(e,t){var n=this;t.cmd&&(t.onclick=function(){n.execCommand(t.cmd)}),n.menuItems=n.menuItems,n.menuItems[e]=t},addContextToolbar:function(e,t){var n,r=this;r.contextToolbars=r.contextToolbars||[],"string"==typeof e&&(n=e,e=function(e){return r.dom.is(e,n)}),r.contextToolbars.push({id:ig.uuid("mcet"),predicate:e,items:t})},addCommand:function(e,t,n){this.editorCommands.addCommand(e,t,n)},addQueryStateHandler:function(e,t,n){this.editorCommands.addQueryStateHandler(e,t,n)},addQueryValueHandler:function(e,t,n){this.editorCommands.addQueryValueHandler(e,t,n)},addShortcut:function(e,t,n,r){this.shortcuts.add(e,t,n,r)},execCommand:function(e,t,n,r){return this.editorCommands.execCommand(e,t,n,r)},queryCommandState:function(e){return this.editorCommands.queryCommandState(e)},queryCommandValue:function(e){return this.editorCommands.queryCommandValue(e)},queryCommandSupported:function(e){return this.editorCommands.queryCommandSupported(e)},show:function(){this.hidden&&(this.hidden=!1,this.inline?this.getBody().contentEditable=!0:(cw.show(this.getContainer()),cw.hide(this.id)),this.load(),this.fire("show"))},hide:function(){var e=this.getDoc();this.hidden||(dw&&e&&!this.inline&&e.execCommand("SelectAll"),this.save(),this.inline?(this.getBody().contentEditable=!1,this===this.editorManager.focusedEditor&&(this.editorManager.focusedEditor=null)):(cw.hide(this.getContainer()),cw.setStyle(this.id,"display",this.orgDisplay)),this.hidden=!0,this.fire("hide"))},isHidden:function(){return!!this.hidden},setProgressState:function(e,t){this.fire("ProgressState",{state:e,time:t})},load:function(e){var t,n=this.getElement();return this.removed?"":n?((e=e||{}).load=!0,t=this.setContent(void 0!==n.value?n.value:n.innerHTML,e),e.element=n,e.no_events||this.fire("LoadContent",e),e.element=n=null,t):void 0},save:function(e){var t,n,r=this,o=r.getElement();if(o&&r.initialized&&!r.removed)return(e=e||{}).save=!0,e.element=o,e.content=r.getContent(e),e.no_events||r.fire("SaveContent",e),"raw"===e.format&&r.fire("RawSaveContent",e),t=e.content,/TEXTAREA|INPUT/i.test(o.nodeName)?o.value=t:(r.inline||(o.innerHTML=t),(n=cw.getParent(r.id,"form"))&&lw(n.elements,(function(e){if(e.name===r.id)return e.value=t,!1}))),e.element=o=null,!1!==e.set_dirty&&r.setDirty(!1),t},setContent:function(e,t){return nw(this,e,t)},getContent:function(e){return function(e,t){return void 0===t&&(t={}),T.from(e.getBody()).fold(b.constant("tree"===t.format?new cb("body",11):""),(function(n){return YC(e,t,n)}))}(this,e)},insertContent:function(e,t){t&&(e=sw({content:e},t)),this.execCommand("mceInsertContent",!1,e)},isDirty:function(){return!this.isNotDirty},setDirty:function(e){var t=!this.isNotDirty;this.isNotDirty=!e,e&&e!==t&&this.fire("dirty")},setMode:function(e){!function(e,t){t!==ip(e)&&(e.initialized?op(e,"readonly"===t):e.on("init",(function(){op(e,"readonly"===t)})),ep(e,t))}(this,e)},getContainer:function(){return this.container||(this.container=cw.get(this.editorContainer||this.id+"_parent")),this.container},getContentAreaContainer:function(){return this.contentAreaContainer},getElement:function(){return this.targetElm||(this.targetElm=cw.get(this.id)),this.targetElm},getWin:function(){var e;return this.contentWindow||(e=this.iframeElement)&&(this.contentWindow=e.contentWindow),this.contentWindow},getDoc:function(){var e;return this.contentDocument||(e=this.getWin())&&(this.contentDocument=e.document),this.contentDocument},getBody:function(){var e=this.getDoc();return this.bodyElement||(e?e.body:null)},convertURL:function(e,t,n){var r=this.settings;return r.urlconverter_callback?this.execCallback("urlconverter_callback",e,n,!0,t):!r.convert_urls||n&&"LINK"===n.nodeName||0===e.indexOf("file:")||0===e.length?e:r.relative_urls?this.documentBaseURI.toRelative(e):e=this.documentBaseURI.toAbsolute(e,r.remove_script_host)},addVisual:function(e){var t,n=this,r=n.settings,o=n.dom;e=e||n.getBody(),void 0===n.hasVisual&&(n.hasVisual=r.visual),lw(o.select("table,a",e),(function(e){var i;switch(e.nodeName){case"TABLE":return t=r.visual_table_class||"mce-item-table",void((i=o.getAttrib(e,"border"))&&"0"!==i||!n.hasVisual?o.removeClass(e,t):o.addClass(e,t));case"A":return void(o.getAttrib(e,"href")||(i=o.getAttrib(e,"name")||e.id,t=r.visual_anchor_class||"mce-item-anchor",i&&n.hasVisual?o.addClass(e,t):o.removeClass(e,t)))}})),n.fire("VisualAid",{element:e,hasVisual:n.hasVisual})},remove:function(){iw(this)},destroy:function(e){aw(this,e)},uploadImages:function(e){return this.editorUpload.uploadImages(e)},_scanForImages:function(){return this.editorUpload.scanForImages()}},sw(fw.prototype,dp);var mw,pw,gw,hw={isEditorUIElement:function(e){return-1!==e.className.toString().indexOf("mce-")}},vw=function(e,t){var n=Pn.detect().browser;n.isIE()||n.isEdge()?function(e){e.on("focusout",(function(){Em.store(e)}))}(e):function(e,t){e.on("mouseup touchend",(function(e){t.throttle()}))}(e,t),e.on("keyup nodechange",(function(t){(function(e){return"nodechange"===e.type&&e.selectionChange})(t)||Em.store(e)}))},bw=function(e){var t=jg((function(){Em.store(e)}),0);e.inline&&function(e,t){var n=function(){t.throttle()};ii.DOM.bind(document,"mouseup",n),e.on("remove",(function(){ii.DOM.unbind(document,"mouseup",n)}))}(e,t),e.on("init",(function(){vw(e,t)})),e.on("remove",(function(){t.cancel()}))},yw=ii.DOM,Cw=function(e){return hw.isEditorUIElement(e)},ww=function(e,t){var n=e?e.settings.custom_ui_selector:"";return null!==yw.getParent(t,(function(t){return Cw(t)||!!n&&e.dom.is(t,n)}))},xw=function(e,t){var n=t.editor;bw(n),n.on("focusin",(function(){var t=e.focusedEditor;t!==this&&(t&&t.fire("blur",{focusedEditor:this}),e.setActive(this),e.focusedEditor=this,this.fire("focus",{blurredEditor:t}),this.focus(!0))})),n.on("focusout",(function(){var t=this;Ce.setEditorTimeout(t,(function(){var n=e.focusedEditor;ww(t,function(){try{return document.activeElement}catch(e){return document.body}}())||n!==t||(t.fire("blur",{focusedEditor:null}),e.focusedEditor=null)}))})),mw||(mw=function(t){var n,r=e.activeEditor;n=t.target,r&&n.ownerDocument===document&&(n===document.body||ww(r,n)||e.focusedEditor!==r||(r.fire("blur",{focusedEditor:null}),e.focusedEditor=null))},yw.bind(document,"focusin",mw))},kw=function(e,t){e.focusedEditor===t.editor&&(e.focusedEditor=null),e.activeEditor||(yw.unbind(document,"focusin",mw),mw=null)},Tw=function(e){e.on("AddEditor",b.curry(xw,e)),e.on("RemoveEditor",b.curry(kw,e))},Ew={},Sw="en",Nw={setCode:function(e){e&&(Sw=e,this.rtl=!!this.data[e]&&"rtl"===this.data[e]._dir)},getCode:function(){return Sw},rtl:!1,add:function(e,t){var n=Ew[e];for(var r in n||(Ew[e]=n={}),t)n[r]=t[r];this.setCode(e)},translate:function(e){var t=Ew[Sw]||{},n=function(e){return Ot.is(e,"function")?Object.prototype.toString.call(e):r(e)?"":""+e},r=function(e){return""===e||null===e||Ot.is(e,"undefined")},o=function(e){return e=n(e),Ot.hasOwn(t,e)?n(t[e]):e};if(r(e))return"";if(Ot.is(e,"object")&&Ot.hasOwn(e,"raw"))return n(e.raw);if(Ot.is(e,"array")){var i=e.slice(1);e=o(e[0]).replace(/\{([0-9]+)\}/g,(function(e,t){return Ot.hasOwn(i,t)?n(i[t]):e}))}return o(e).replace(/{context:\w+}$/,"")},data:Ew},Aw=ii.DOM,Rw=Ot.explode,_w=Ot.each,Iw=Ot.extend,Bw=0,Pw=!1,Dw=[],Ow=[],Mw=function(e){_w(gw.get(),(function(t){"scroll"===e.type?t.fire("ScrollWindow",e):t.fire("ResizeWindow",e)}))},Lw=function(e){e!==Pw&&(e?en(window).on("resize scroll",Mw):en(window).off("resize scroll",Mw),Pw=e)},Fw=function(e){var t=Ow;delete Dw[e.id];for(var n=0;n<Dw.length;n++)if(Dw[n]===e){Dw.splice(n,1);break}return Ow=H.filter(Ow,(function(t){return e!==t})),gw.activeEditor===e&&(gw.activeEditor=Ow.length>0?Ow[0]:null),gw.focusedEditor===e&&(gw.focusedEditor=null),t.length!==Ow.length};gw={defaultSettings:{},$:en,majorVersion:"4",minorVersion:"7.12",releaseDate:"2018-05-03",editors:Dw,i18n:Nw,activeEditor:null,settings:{},setup:function(){var e,t,n,r,o="";if(t=XC.getDocumentBaseUrl(document.location),/^[^:]+:\/\/\/?[^\/]+\//.test(t)&&(t=t.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(t)||(t+="/")),n=window.tinymce||window.tinyMCEPreInit)e=n.base||n.baseURL,o=n.suffix;else{for(var i=document.getElementsByTagName("script"),a=0;a<i.length;a++){var c=(r=i[a].src).substring(r.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(r)){-1!==c.indexOf(".min")&&(o=".min"),e=r.substring(0,r.lastIndexOf("/"));break}}!e&&document.currentScript&&(-1!==(r=document.currentScript.src).indexOf(".min")&&(o=".min"),e=r.substring(0,r.lastIndexOf("/")))}this.baseURL=new XC(t).toAbsolute(e),this.documentBaseURL=t,this.baseURI=new XC(this.baseURL),this.suffix=o,Tw(this)},overrideDefaults:function(e){var t,n;(t=e.base_url)&&(this.baseURL=new XC(this.documentBaseURL).toAbsolute(t.replace(/\/+$/,"")),this.baseURI=new XC(this.baseURL)),n=e.suffix,e.suffix&&(this.suffix=n),this.defaultSettings=e;var r=e.plugin_base_urls;for(var o in r)fi.PluginManager.urls[o]=r[o]},init:function(e){var t,n,r=this;n=Ot.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option tbody tfoot thead tr script noscript style textarea video audio iframe object menu"," ");var o=function(e){var t=e.id;return t||(t=(t=e.name)&&!Aw.get(t)?e.name:Aw.uniqueId(),e.setAttribute("id",t)),t},i=function(e,t){return t.constructor===RegExp?t.test(e.className):Aw.hasClass(e,t)},a=function(e){t=e},c=function(){var t,s=0,l=[],u=function(e,n,o){var i=new fw(e,n,r);l.push(i),i.on("init",(function(){++s===t.length&&a(l)})),i.targetElm=i.targetElm||o,i.render()};Aw.unbind(window,"ready",c),function(t){var n=e[t];n&&n.apply(r,Array.prototype.slice.call(arguments,2))}("onpageload"),t=en.unique(function(e){var t,n=[];if(ge.ie&&ge.ie<11)return Up.initError("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/"),[];if(e.types)return _w(e.types,(function(e){n=n.concat(Aw.select(e.selector))})),n;if(e.selector)return Aw.select(e.selector);if(e.target)return[e.target];switch(e.mode){case"exact":(t=e.elements||"").length>0&&_w(Rw(t),(function(e){var t;(t=Aw.get(e))?n.push(t):_w(document.forms,(function(t){_w(t.elements,(function(t){t.name===e&&(e="mce_editor_"+Bw++,Aw.setAttrib(t,"id",e),n.push(t))}))}))}));break;case"textareas":case"specific_textareas":_w(Aw.select("textarea"),(function(t){e.editor_deselector&&i(t,e.editor_deselector)||e.editor_selector&&!i(t,e.editor_selector)||n.push(t)}))}return n}(e)),e.types?_w(e.types,(function(n){Ot.each(t,(function(t){return!Aw.is(t,n.selector)||(u(o(t),Iw({},e,n),t),!1)}))})):(Ot.each(t,(function(e){var t;(t=r.get(e.id))&&t.initialized&&!(t.getContainer()||t.getBody()).parentNode&&(Fw(t),t.unbindAllNativeEvents(),t.destroy(!0),t.removed=!0,t=null)})),0===(t=Ot.grep(t,(function(e){return!r.get(e.id)}))).length?a([]):_w(t,(function(t){!function(e,t){return e.inline&&t.tagName.toLowerCase()in n}(e,t)?u(o(t),e,t):Up.initError("Could not initialize inline editor on invalid inline target element",t)})))};return r.settings=e,Aw.bind(window,"ready",c),new he((function(e){t?e(t):a=function(t){e(t)}}))},get:function(e){return 0===arguments.length?Ow.slice(0):S.isString(e)?H.find(Ow,(function(t){return t.id===e})).getOr(null):S.isNumber(e)&&Ow[e]?Ow[e]:null},add:function(e){var t=this;return Dw[e.id]===e?e:(null===t.get(e.id)&&("length"!==e.id&&(Dw[e.id]=e),Dw.push(e),Ow.push(e)),Lw(!0),t.activeEditor=e,t.fire("AddEditor",{editor:e}),pw||(pw=function(){t.fire("BeforeUnload")},Aw.bind(window,"beforeunload",pw)),e)},createEditor:function(e,t){return this.add(new fw(e,t,this))},remove:function(e){var t,n,r=this;if(e)return S.isString(e)?(e=e.selector||e,void _w(Aw.select(e),(function(e){(n=r.get(e.id))&&r.remove(n)}))):(n=e,S.isNull(r.get(n.id))?null:(Fw(n)&&r.fire("RemoveEditor",{editor:n}),0===Ow.length&&Aw.unbind(window,"beforeunload",pw),n.remove(),Lw(Ow.length>0),n));for(t=Ow.length-1;t>=0;t--)r.remove(Ow[t])},execCommand:function(e,t,n){var r=this.get(n);switch(e){case"mceAddEditor":return this.get(n)||new fw(n,this.settings,this).render(),!0;case"mceRemoveEditor":return r&&r.remove(),!0;case"mceToggleEditor":return r?(r.isHidden()?r.show():r.hide(),!0):(this.execCommand("mceAddEditor",0,n),!0)}return!!this.activeEditor&&this.activeEditor.execCommand(e,t,n)},triggerSave:function(){_w(Ow,(function(e){e.save()}))},addI18n:function(e,t){Nw.add(e,t)},translate:function(e){return Nw.translate(e)},setActive:function(e){var t=this.activeEditor;this.activeEditor!==e&&(t&&t.fire("deactivate",{relatedTarget:e}),e.fire("activate",{relatedTarget:t})),this.activeEditor=e}},Iw(gw,Mm),gw.setup();var jw=gw;function Hw(e){return{walk:function(t,n){return lv.walk(e,t,n)},split:$h.split,normalize:function(t){return Yf.normalize(e,t).fold(b.constant(!1),(function(e){return t.setStart(e.startContainer,e.startOffset),t.setEnd(e.endContainer,e.endOffset),!0}))}}}!function(e){e.compareRanges=Wf.isEq,e.getCaretRangeFromPoint=_b.fromPoint,e.getSelectedNode=Ki,e.getNode=Ji}(Hw||(Hw={}));var Uw,Ww,zw=Hw,qw=Math.min,Vw=Math.max,$w=Math.round,Kw=function(e,t,n){var r,o,i,a,c,s;return r=t.x,o=t.y,i=e.w,a=e.h,c=t.w,s=t.h,"b"===(n=(n||"").split(""))[0]&&(o+=s),"r"===n[1]&&(r+=c),"c"===n[0]&&(o+=$w(s/2)),"c"===n[1]&&(r+=$w(c/2)),"b"===n[3]&&(o-=a),"r"===n[4]&&(r-=i),"c"===n[3]&&(o-=$w(a/2)),"c"===n[4]&&(r-=$w(i/2)),Jw(r,o,i,a)},Jw=function(e,t,n,r){return{x:e,y:t,w:n,h:r}},Gw={inflate:function(e,t,n){return Jw(e.x-t,e.y-n,e.w+2*t,e.h+2*n)},relativePosition:Kw,findBestRelativePosition:function(e,t,n,r){var o,i;for(i=0;i<r.length;i++)if((o=Kw(e,t,r[i])).x>=n.x&&o.x+o.w<=n.w+n.x&&o.y>=n.y&&o.y+o.h<=n.h+n.y)return r[i];return null},intersect:function(e,t){var n,r,o,i;return n=Vw(e.x,t.x),r=Vw(e.y,t.y),o=qw(e.x+e.w,t.x+t.w),i=qw(e.y+e.h,t.y+t.h),o-n<0||i-r<0?null:Jw(n,r,o-n,i-r)},clamp:function(e,t,n){var r,o,i,a,c,s,l,u,d,f;return c=e.x,s=e.y,l=e.x+e.w,u=e.y+e.h,d=t.x+t.w,f=t.y+t.h,r=Vw(0,t.x-c),o=Vw(0,t.y-s),i=Vw(0,l-d),a=Vw(0,u-f),c+=r,s+=o,n&&(l+=r,u+=o,c-=i,s-=a),Jw(c,s,(l-=i)-c,(u-=a)-s)},create:Jw,fromClientRect:function(e){return Jw(e.left,e.top,e.width,e.height)}},Xw={},Yw={add:function(e,t){Xw[e.toLowerCase()]=t},has:function(e){return!!Xw[e.toLowerCase()]},get:function(e){var t=e.toLowerCase(),n=Xw.hasOwnProperty(t)?Xw[t]:null;if(null===n)throw new Error("Could not find module for type: "+e);return n},create:function(e,t){var n;if("string"==typeof e?(t=t||{}).type=e:e=(t=e).type,e=e.toLowerCase(),!(n=Xw[e]))throw new Error("Could not find control by type: "+e);return(n=new n(t)).type=e,n}},Qw=Ot.each,Zw=Ot.extend,ex=function(){};ex.extend=Uw=function(e){var t,n,r,o=this.prototype,i=function(){var e,t,n,r=this;if(!Ww&&(r.init&&r.init.apply(r,arguments),t=r.Mixins))for(e=t.length;e--;)(n=t[e]).init&&n.init.apply(r,arguments)},a=function(){return this},c=function(e,t){return function(){var n,r=this,i=r._super;return r._super=o[e],n=t.apply(r,arguments),r._super=i,n}};for(n in Ww=!0,t=new this,Ww=!1,e.Mixins&&(Qw(e.Mixins,(function(t){for(var n in t)"init"!==n&&(e[n]=t[n])})),o.Mixins&&(e.Mixins=o.Mixins.concat(e.Mixins))),e.Methods&&Qw(e.Methods.split(","),(function(t){e[t]=a})),e.Properties&&Qw(e.Properties.split(","),(function(t){var n="_"+t;e[t]=function(e){return void 0!==e?(this[n]=e,this):this[n]}})),e.Statics&&Qw(e.Statics,(function(e,t){i[t]=e})),e.Defaults&&o.Defaults&&(e.Defaults=Zw({},o.Defaults,e.Defaults)),e)"function"==typeof(r=e[n])&&o[n]?t[n]=c(n,r):t[n]=r;return i.prototype=t,i.constructor=i,i.extend=Uw,i};var tx=Math.min,nx=Math.max,rx=Math.round,ox=function(e,t){var n,r,o,i;if(t=t||'"',null===e)return"null";if("string"==(o=typeof e))return r="\bb\tt\nn\ff\rr\"\"''\\\\",t+e.replace(/([\u0080-\uFFFF\x00-\x1f\"\'\\])/g,(function(e,o){return'"'===t&&"'"===e?e:(n=r.indexOf(o))+1?"\\"+r.charAt(n+1):(e=o.charCodeAt().toString(16),"\\u"+"0000".substring(e.length)+e)}))+t;if("object"===o){if(e.hasOwnProperty&&"[object Array]"===Object.prototype.toString.call(e)){for(n=0,r="[";n<e.length;n++)r+=(n>0?",":"")+ox(e[n],t);return r+"]"}for(i in r="{",e)e.hasOwnProperty(i)&&(r+="function"!=typeof e[i]?(r.length>1?","+t:t)+i+t+":"+ox(e[i],t):"");return r+"}"}return""+e},ix={serialize:ox,parse:function(e){try{return JSON.parse(e)}catch(e){}}},ax={callbacks:{},count:0,send:function(e){var t=this,n=ii.DOM,r=void 0!==e.count?e.count:t.count,o="tinymce_jsonp_"+r;t.callbacks[r]=function(i){n.remove(o),delete t.callbacks[r],e.callback(i)},n.add(n.doc.body,"script",{id:o,src:e.url,type:"text/javascript"}),t.count++}},cx={send:function(e){var t,n=0,r=function(){!e.async||4===t.readyState||n++>1e4?(e.success&&n<1e4&&200===t.status?e.success.call(e.success_scope,""+t.responseText,t,e):e.error&&e.error.call(e.error_scope,n>1e4?"TIMED_OUT":"GENERAL",t,e),t=null):setTimeout(r,10)};if(e.scope=e.scope||this,e.success_scope=e.success_scope||e.scope,e.error_scope=e.error_scope||e.scope,e.async=!1!==e.async,e.data=e.data||"",cx.fire("beforeInitialize",{settings:e}),t=new qp){if(t.overrideMimeType&&t.overrideMimeType(e.content_type),t.open(e.type||(e.data?"POST":"GET"),e.url,e.async),e.crossDomain&&(t.withCredentials=!0),e.content_type&&t.setRequestHeader("Content-Type",e.content_type),e.requestheaders&&Ot.each(e.requestheaders,(function(e){t.setRequestHeader(e.key,e.value)})),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),(t=cx.fire("beforeSend",{xhr:t,settings:e}).xhr).send(e.data),!e.async)return r();setTimeout(r,10)}}};Ot.extend(cx,Mm);var sx=Ot.extend,lx=function(e){this.settings=sx({},e),this.count=0};lx.sendRPC=function(e){return(new lx).send(e)},lx.prototype={send:function(e){var t=e.error,n=e.success;(e=sx(this.settings,e)).success=function(r,o){void 0===(r=ix.parse(r))&&(r={error:"JSON Parse error."}),r.error?t.call(e.error_scope||e.scope,r.error,o):n.call(e.success_scope||e.scope,r.result)},e.error=function(n,r){t&&t.call(e.error_scope||e.scope,n,r)},e.data=ix.serialize({id:e.id||"c"+this.count++,method:e.method,params:e.params}),e.content_type="application/json",cx.send(e)}};var ux=window.localStorage,dx=jw,fx={geom:{Rect:Gw},util:{Promise:he,Delay:Ce,Tools:Ot,VK:Ug,URI:XC,Class:ex,EventDispatcher:Pm,Observable:Mm,I18n:Nw,XHR:cx,JSON:ix,JSONRequest:lx,JSONP:ax,LocalStorage:ux,Color:function(e){var t={},n=0,r=0,o=0,i=function(e){var i;return"object"==typeof e?"r"in e?(n=e.r,r=e.g,o=e.b):"v"in e&&function(e,t,i){var a,c,s,l;if(e=(parseInt(e,10)||0)%360,t=parseInt(t,10)/100,i=parseInt(i,10)/100,t=nx(0,tx(t,1)),i=nx(0,tx(i,1)),0!==t){switch(a=e/60,s=(c=i*t)*(1-Math.abs(a%2-1)),l=i-c,Math.floor(a)){case 0:n=c,r=s,o=0;break;case 1:n=s,r=c,o=0;break;case 2:n=0,r=c,o=s;break;case 3:n=0,r=s,o=c;break;case 4:n=s,r=0,o=c;break;case 5:n=c,r=0,o=s;break;default:n=r=o=0}n=rx(255*(n+l)),r=rx(255*(r+l)),o=rx(255*(o+l))}else n=r=o=rx(255*i)}(e.h,e.s,e.v):(i=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)[^\)]*\)/gi.exec(e))?(n=parseInt(i[1],10),r=parseInt(i[2],10),o=parseInt(i[3],10)):(i=/#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(e))?(n=parseInt(i[1],16),r=parseInt(i[2],16),o=parseInt(i[3],16)):(i=/#([0-F])([0-F])([0-F])/gi.exec(e))&&(n=parseInt(i[1]+i[1],16),r=parseInt(i[2]+i[2],16),o=parseInt(i[3]+i[3],16)),n=n<0?0:n>255?255:n,r=r<0?0:r>255?255:r,o=o<0?0:o>255?255:o,t};return e&&i(e),t.toRgb=function(){return{r:n,g:r,b:o}},t.toHsv=function(){return function(e,t,n){var r,o,i,a;return o=0,(i=tx(e/=255,tx(t/=255,n/=255)))===(a=nx(e,nx(t,n)))?{h:0,s:0,v:100*(o=i)}:(r=(a-i)/a,o=a,{h:rx(60*((e===i?3:n===i?1:5)-(e===i?t-n:n===i?e-t:n-e)/(a-i))),s:rx(100*r),v:rx(100*o)})}(n,r,o)},t.toHex=function(){var e=function(e){return(e=parseInt(e,10).toString(16)).length>1?e:"0"+e};return"#"+e(n)+e(r)+e(o)},t.parse=i,t}},dom:{EventUtils:Re,Sizzle:ft,DomQuery:en,TreeWalker:Xr,DOMUtils:ii,ScriptLoader:ui,RangeUtils:zw,Serializer:kb,ControlSelection:Ab,BookmarkManager:Eb,Selection:py,Event:Re.Event},html:{Styles:Go,Entities:Mo,Node:cb,Schema:Ko,SaxParser:Zg,DomParser:bb,Writer:_l,Serializer:Il},ui:{Factory:Yw},Env:ge,AddOnManager:fi,Formatter:Jv,UndoManager:Ch,EditorCommands:Im,WindowManager:Mp,NotificationManager:Op,EditorObservable:dp,Shortcuts:hp,Editor:fw,FocusManager:hw,EditorManager:jw,DOM:ii.DOM,ScriptLoader:ui.ScriptLoader,PluginManager:fi.PluginManager,ThemeManager:fi.ThemeManager,trim:Ot.trim,isArray:Ot.isArray,is:Ot.is,toArray:Ot.toArray,makeMap:Ot.makeMap,each:Ot.each,map:Ot.map,grep:Ot.grep,inArray:Ot.inArray,extend:Ot.extend,create:Ot.create,walk:Ot.walk,createNS:Ot.createNS,resolve:Ot.resolve,explode:Ot.explode,_addCacheSuffix:Ot._addCacheSuffix,isOpera:ge.opera,isWebKit:ge.webkit,isIE:ge.ie,isGecko:ge.gecko,isMac:ge.mac},mx=dx=Ot.extend(dx,fx);!function(e){window.tinymce=e,window.tinyMCE=e}(mx),function(t){try{e.exports=t}catch(e){}}(mx)}()}).call(this,n("./node_modules/timers-browserify/main.js").setImmediate)},"./node_modules/webpack/buildin/global.js":function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},"./node_modules/window-or-global/lib/index.js":function(e,t,n){"use strict";(function(t){e.exports="object"==typeof self&&self.self===self&&self||"object"==typeof t&&t.global===t&&t||this}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./src/editor-plugins/aeTable/css/editor-content.scss":function(e,t,n){var r,o=0,i=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/aeTable/css/editor-content.scss"),a={hmr:!0};a.insertInto=function(){return window.document.getElementById("wysiwygTextarea_ifr").contentDocument.head},"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(t.locals=i.locals),t.use=t.ref=function(){return o++||(r=n("./node_modules/style-loader/lib/addStyles.js")(i,a)),t},t.unuse=t.unref=function(){o>0&&!--o&&(r(),r=null)}},"./src/editor-plugins/confcharmap/charmap.css":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/confcharmap/charmap.css");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/draggable/draggable.css":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/draggable/draggable.css");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/insert-files/insert-files.css":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/insert-files/insert-files.css");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/insertwiki/insert-wiki-markup.css":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/insertwiki/insert-wiki-markup.css");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/iosediting/iosediting.css":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/iosediting/iosediting.css");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/propertypanel/css/property-panel.css":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/propertypanel/css/property-panel.css");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/editor-plugins/status-macro/editor.scss":function(e,t,n){var r=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./src/editor-plugins/status-macro/editor.scss");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./src/helpers/browser.js":function(e,t,n){"use strict";(function(e){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,"a",(function(){return o}));var o=function(){function t(n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n?this.userAgent=n:e.window&&(this.userAgent=e.window.navigator.userAgent)}var n,o,i;return n=t,(o=[{key:"isFirefox",value:function(){return-1!==this.userAgent.indexOf("Firefox/")}},{key:"notFirefox",value:function(){return!this.isFirefox()}},{key:"isMSEdge",value:function(){return-1!==this.userAgent.indexOf("Edge/")}},{key:"notMSEdge",value:function(){return!this.isMSEdge()}},{key:"isIE",value:function(){return-1!==this.userAgent.indexOf("MSIE")||-1!==this.userAgent.indexOf("Trident/")||this.isMSEdge()}},{key:"notIE",value:function(){return!this.isIE()}},{key:"isChrome",value:function(){return-1!==this.userAgent.indexOf("Chrome/")}},{key:"notChrome",value:function(){return!this.isChrome()}},{key:"isSafari",value:function(){return-1!==this.userAgent.indexOf("Safari/")&&-1===this.userAgent.indexOf("Chrome/")}},{key:"notSafari",value:function(){return!this.isSafari()}},{key:"isPhantom",value:function(){return-1!==this.userAgent.indexOf("PhantomJS")}},{key:"notPhantom",value:function(){return!this.isPhantom()}},{key:"version",value:function(){if(this.isIE()){var e=this.userAgent.match(/MSIE\s([\d.]+)/)||this.userAgent.match(/rv:([\d.]+)/)||this.userAgent.match(/Edge\/([\d.]+)/);return parseInt(e[1])}return this.isChrome()?parseInt(this.userAgent.match(/Chrome\/([\d.]+)/)[1]):this.isSafari()?parseInt(this.userAgent.match(/Version\/([\d.]+)/)[1]):this.isFirefox()?parseInt(this.userAgent.match(/Firefox\/([\d.]+)/)[1]):void 0}},{key:"friendlyName",value:function(){return this.isMSEdge()?"MSEdge":this.isIE()?"IE":this.isChrome()?"Chrome":this.isSafari()?"Safari":this.isFirefox()?"Firefox":void 0}}])&&r(n.prototype,o),i&&r(n,i),t}()}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./src/index.js":function(e,t,n){"use strict";n.r(t);var r=n("./node_modules/window-or-global/lib/index.js"),o=n.n(r);n("./node_modules/tinymce/tinymce.js"),n("./node_modules/tinymce/plugins/table/index.js"),n("./node_modules/tinymce/plugins/lists/index.js"),n("./node_modules/tinymce/plugins/paste/index.js");function i(e){for(var t=e.split("."),n=window[t.shift()];void 0!==n&&t.length;)n=n[t.shift()];return n}r.tinymce.confluenceEditorVersion="0.74.1";var a=n("confluence.web.resources:jquery/require('jquery')"),c=n.n(a);function s(e,t,n){return"function"==typeof n?c()(o.a).bind(e,t,n):c()(o.a).bind(e,t)}function l(e,t){return c()(o.a).unbind(e,t)}function u(e,t){return c()(o.a).trigger(e,t)}var d="confluence.spa.editor";var f=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.value=t,this.valueOf=this.toString=this.toJSON=function(){return n.value}},m=function(e){return new f(e)},p=n("confluence.web.resources:ajs/require('ajs')"),g=n.n(p);function h(e){if(0==c()(e).closest("td").length)return!0;for(var t=e.parentNode;"td"!=t.nodeName.toLowerCase();){if(c()(t).prevAll().contents().filter((function(){return 3==this.nodeType})).length)return!1;t=t.parentNode}return!0}function v(e,t,n){if(t.compareEndPoints){var r=e.getBody().createTextRange();return r.moveToElementText(n),r.collapse(1),0===t.compareEndPoints("StartToStart",r)&&h(n)}if(!e.selection.getSel().isCollapsed)return!1;var o,i=t.startContainer;return 3==i.nodeType?!i.previousSibling&&0===t.startOffset&&h(i):c()(i).is("p:first-child")?0===t.startOffset:c()(i).is(".wysiwyg-macro-body")?1==t.startOffset&&(3==(o=t.startContainer.childNodes[0]).nodeType&&"\n"==o.nodeValue):void 0}function b(e,t,n){if(t.compareEndPoints){var r=e.getBody().createTextRange();return r.moveToElementText(n),r.collapse(0),0===t.compareEndPoints("EndToEnd",r)}if(!e.selection.getSel().isCollapsed)return!1;var o=t.endContainer;if(3==o.nodeType)return o.wholeText.length==t.endOffset;var i=o.childNodes[t.endOffset];return c()(i).is(":last-child")}function y(e,t,n){var o=e.dom.create("p",0,r.tinymce.Env.ie?"&nbsp;":'<br data-mce-bogus="1" />');n?t.after(o):t.before(o),e.selection.select(o,!0),e.selection.collapse()}function C(){var e=r.tinymce.activeEditor;r.tinymce.Env.ie&&e.on("KeyPress",(function(t){var n=e.selection,o=n.getNode();if(13==t.keyCode&&"P"==o.nodeName&&e.dom.is(o,":first-child")&&r.tinymce.confluence.MacroUtils.isInMacro(o)){var i=e.dom.create("p","&#x200b");return e.dom.insertAfter(i,o),n.select(i,1),n.collapse(),r.tinymce.dom.Event.cancel(t)}})),r.tinymce.Env.gecko&&e.on("KeyPress",(function(t){if(t.charCode==c.a.ui.keyCode.SPACE){var n=e.selection.getNode(),r=c()(n).closest("a"),o=e.selection.getRng();r.length&&b(e,e.selection.getRng(),n)&&(o.setStartAfter(r[0]),o.setEndAfter(r[0]),e.selection.setRng(o),e.selection.collapse())}})),e.on("KeyPress",(function(t){if(13==t.keyCode&&!t.shiftKey){var n=e.selection.getNode(),o=c()(n).closest("pre");if(o.length&&!r.tinymce.confluence.MacroUtils.isInMacro(o)&&b(e,e.selection.getRng(),n))return y(e,o,!0),r.tinymce.dom.Event.cancel(t);var i=c()(n).closest("blockquote");if(i.length){var a=c()(n).closest("p");if(a.is(":first-child")&&v(e,e.selection.getRng(),n))return y(e,i,!1),r.tinymce.dom.Event.cancel(t);if(a.is(":last-child")&&function(e){var t=e.contents();if(!t.length)return!0;if(1==t.length){if(t.is("br"))return!0;if("&nbsp;"==t.html()||160==t.text().charCodeAt(0))return!0;if(3==t[0].nodeType&&t[0].nodeValue==g.a.Rte.HIDDEN_CHAR)return!0}return!1}(a))return e.dom.remove(a[0],!1),y(e,i,!0),r.tinymce.dom.Event.cancel(t)}}return!0}),!0)}var w=function(e){var t=o.a.document.querySelector("meta[name=ajs-enabled-dark-features]");if(t){var n=t.content.split(",");return n.indexOf(e)>-1&&-1===n.indexOf("".concat(e,".disable"))}},x=function(e){return c()("<br>").add(e.contents())},k=function(e){return(e.nodeType===Node.ELEMENT_NODE||e.nodeType===Node.TEXT_NODE)&&c.a.trim(e.textContent)},T=function(e){var t=!1;return e.parent().contents().each((function(){if(k(this))return this===e[0]&&(t=!0,!1)})),t},E=function(e){var t=e.attr("style"),n=c()("<p></p>").append(e.contents());t&&n.attr("style",t),e.replaceWith(n)},S=function(e){var t=e.prev("p");t.length?(t.append(x(e)),e.remove()):T(e)?E(e):e.replaceWith(x(e))},N=function(e,t){var n=c()('<table class="wysiwyg-macro" data-macro-name="'.concat(e,'" data-macro-body-type="RICH_TEXT">')+'<tbody><tr><td class="wysiwyg-macro-body"></td></tr></tbody></table>');return n.find(".wysiwyg-macro-body").append(t),n},A=function(e){return""===e.text()},R=E,_=[function(e){e.find(".expand-container").replaceWith((function(){var e=c()(this).find(".expand-content").first().contents();return e.length?N("expand",e):""}))},function(e){e.find("span:empty").remove()},function(e){e.find("p + br").remove()},function(e){var t=!1;e.find("div:not(.content-wrapper)").each((function(){var e=c()(this);A(e)?(e.remove(),t=!0):e.find("div, p, pre").length?e.replaceWith(e.contents()):(t?R(e):S(e),t=!1)}))}];var I={repair:function(e){var t=c()("<div></div>").html(e);return _.forEach((function(e){e(t)})),t.html()}},B=[{repair:function(e){var t=/(<td.*<\/td>)<br class="Apple-interchange-newline">/.exec(e);return t?'<table class="confluenceTable"><tbody><tr>'.concat(t[1],"</tr></tbody></table>"):e}},{repair:function(e){var t=/(<tr.*<\/tr>)<br class="Apple-interchange-newline">/.exec(e);return t?'<table class="confluenceTable"><tbody>'.concat(t[1],"</tbody></table>"):e}}],P=function(e){return e?(B.forEach((function(t){e=t.repair(e)})),e):e},D={apply:function(e){return e=function(e){return w("editor.advanced.paste.disable")?e:I.repair(e)}(e=P(e))},repair:P},O=n("confluence.web.resources:meta/require('confluence/meta')"),M=n.n(O).a,L=function(e){e.parentNode.removeChild(e)},F=function(e){return function(t){var n=t.classList;n.remove.apply(n,e),""===t.className&&t.removeAttribute("class")}},j=function(e,t,n){r.tinymce.util.Tools.each(e.querySelectorAll(t),n)},H=function(e){var t;j(e,"img:not([data-emoticon-name]):not(.editor-inline-macro):not(.confluence-embedded-image):not(.template-constiable)",(t=["confluence-embedded-image","confluence-external-resource"],function(e){var n=e.classList;n.add.apply(n,t)}))},U=function(e){j(e,"span.Apple-style-span",F(["Apple-style-span"]))},W=function(e){j(e,"br.Apple-interchange-newline",L)},z=function(e){j(e,"meta",L)},q=function(e,t){j(e,"ul.inline-task-list > li[data-inline-task-id]",(function(n){var o,i,a=n.getAttribute("data-inline-task-id");r.tinymce.util.Tools.grep(t.querySelectorAll('li[data-inline-task-id="'.concat(a,'"]')),(i=e,o=function(e){return function(e,t){for(;e;){if(t===e)return!0;e=e.parentNode}return!1}(e,i)},function(e){return!o(e)})).length>0&&n.setAttribute("data-inline-task-id","")}))},V=function(e){var t;j(e,".mceSelected",F(["mceSelected"])),j(e,"[data-mce-selected]",(t=["data-mce-selected"],function(e){e.removeAttribute(t)}))},$=function(e){var t=M.get("base-url");j(e,"a:not([data-base-url='".concat(t,"'])[data-base-url]"),(function(e){for(var n=e.attributes.href?e.attributes.href.value:t;e.attributes.length>0;)e.removeAttribute(e.attributes[0].name);e.setAttribute("href",n)}))};var K={apply:function(e,t){H(e),U(e),W(e),z(e),q(e,t),V(e),$(e)}},J=function(e,t){return"<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?c()(e,t||r.document):c()("<div>".concat(e,"</div>"),t||r.document).contents()},G=function(e,t){e.is("ul.inline-task-list")?t.each((function(){var e=c()(this);e.attr("data-inline-task-id")||e.attr("data-inline-task-id","")})):t.removeAttr("data-inline-task-id").removeAttr("data-pasted-task")},X=function(e){var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;return r.tinymce.isIE?"LI"===t.nodeName&&0===t.childNodes.length:"LI"===t.nodeName&&1===t.childNodes.length&&"BR"===t.firstChild.nodeName},Y=function(e,t){if(!t.collapsed||0!=t.startOffset)return!1;var n=c()(t.startContainer).closest("ol, ul",e.getBody());if(0===n.length)return!1;var o=new r.tinymce.dom.TreeWalker(t.startContainer,n[0]).prev(!0);return void 0===o||c()(o).is("li")},Q=function(e){var t=e.filter("ol,ul").length;return e.length===t},Z=function(e,t,n){var r;return ee.forEach((function(o){if(o.shouldInsert(e,t,n))return r=o,!1})),r},ee=[{shouldInsert:function(e,t,n){var r=X(t);return(r=r&&Q(n))&&n.children("li").length>0},insert:function(e,t,n){var r=c()(3===t.startContainer.nodeType?t.startContainer.parentNode:t.startContainer),o=n.children();e.undoManager.beforeChange(),e.undoManager.add(),G(r.parent(),o),r.replaceWith(o),e.selection.select(o.last()[0],!0),e.selection.collapse(),e.undoManager.add()}},{shouldInsert:function(e,t,n){var r=Y(e,t);return(r=r&&Q(n))&&n.children("li").length>0},insert:function(e,t,n){var r=c()(t.startContainer).closest("li",e.getBody()),o=n.children();e.undoManager.beforeChange(),e.undoManager.add(),G(r.parent(),o),r.before(o),e.selection.select(r[0],!0),e.selection.collapse(!0),e.undoManager.add()}},{shouldInsert:function(e,t,n){return function(e,t){if(!t.collapsed)return!1;if(3===t.startContainer.nodeType&&t.startOffset!=t.startContainer.nodeValue.length)return!1;if(1===t.startContainer.nodeType&&t.startOffset!=t.startContainer.childNodes.length)return!1;var n=c()(t.startContainer).closest("ol, ul",e.getBody());if(0===n.length)return!1;var o=new r.tinymce.dom.TreeWalker(t.startContainer,n[0]).next(!0);return void 0===o||c()(o).is("li")}(e,t)&&n.length===n.filter("ol,ul").length&&n.children("li").length>0},insert:function(e,t,n){var r=c()(t.startContainer).closest("li",e.getBody()),o=n.children();e.undoManager.beforeChange(),e.undoManager.add(),G(r.parent(),o),r.after(o),e.selection.select(o.last()[0],!0),e.selection.collapse(!1),e.undoManager.add()}},{shouldInsert:function(e,t,n){var r=n.length>1;return r=(r=(r=r&&!X(t))&&Y(e,t))&&function(e){var t=e.filter("ol,ul"),n=e[e.length-1];return 1===t.length&&t[0]===n}(n)},insert:function(e,t,n){var r=c()(t.startContainer).closest("li",e.getBody());e.undoManager.beforeChange(),e.undoManager.add(),G(r.parent(),n.children("li"));var o=c()("<li></li>").append(n);r.before(o),e.undoManager.add()}},{shouldInsert:function(e,t,n){return!t.collapsed&&(!!c()(t.commonAncestorContainer).is("table.confluenceTable > tbody, table.confluenceTable > tbody > tr")&&n.is("table:not(.wysiwyg-macro)"))},insert:function(e,t,n){var r=n.children("tbody").length>0?n.children("tbody").children("tr"):n.children("tr"),o=r.children("td, th"),i=c()(".mceSelected",e.getDoc()),a=i.parent();function s(e,t){for(var n=e.shift(),r=t.shift();n&&r;n=e.shift(),r=t.shift())c()(r).html(c()(n).html())}if(e.undoManager.beforeChange(),e.undoManager.add(),1===a.length)s(c.a.makeArray(o),c.a.makeArray(i));else for(var l=c.a.makeArray(r),u=c.a.makeArray(a),d=l.shift(),f=u.shift();d&&f;d=l.shift(),f=u.shift())s(c.a.makeArray(c()(d).children()),c.a.makeArray(c()(f).children()));e.selection.setRng(t),e.undoManager.add()}},{shouldInsert:function(e,t,n){var r=c()(t.startContainer).closest("td.confluenceTd, th.confluenceTh",".mceContent");if(0===r.length)return!1;var o=r.closest("table.confluenceTable",".mceContent");if(0!==o.length&&0!==o.children("tbody").length){if(!n.is("table:not(.wysiwyg-macro)"))return!1;var i=!1;return o.find("*[colspan], *[rowspan]").each((function(e,t){if(c()(t).attr("rowspan")>1||c()(t).attr("colspan")>1)return i=!0,!1})),!i}},insert:function(e,t,n){var o=c()(t.startContainer).closest("td.confluenceTd, th.confluenceTh",".mceContent"),i=o.closest("table.confluenceTable",".mceContent"),a=n.children("tbody").length>0?n.children("tbody").children("tr"):n.children("tr"),s=i.children("tbody").children("tr"),l=a.length,u=a.first().children("td, th").length,d=s.length,f=s.first().children("td, th").length,m=o.parent().index(),p=o.index();e.undoManager.beforeChange(),e.undoManager.add();var g=p+u-f,h=m+l-d;g=g<0?0:g,h=h<0?0:h,s.each((function(e,t){for(var n=c()(t),o=n.children().last(),i=0;i<g;i++)n.append(o.clone().html(r.tinymce.isIE?"":"<br/>"))}));for(var v=s.last(),b=0;b<h;b++){for(var y=c()("<tr></tr>").insertAfter(v),C=0;C<f+g;C++)y.append('<td class="confluenceTd">'.concat(r.tinymce.isIE?"":"<br/>","</td>"));v=y}var w=[];i.children("tbody").children("tr").slice(m).each((function(e,t){w.push(c.a.makeArray(c()(t).children("th, td").slice(p)))}));var x=[];a.each((function(e,t){x.push(c.a.makeArray(c()(t).children("th, td")))}));for(var k=x.shift(),T=w.shift();k&&T;k=x.shift(),T=w.shift())for(var E=k.shift(),S=T.shift();E&&S;E=k.shift(),S=T.shift())c()(S).html(c()(E).html());e.selection.select(o[0],1),e.selection.collapse(!0),e.undoManager.add()}},{shouldInsert:function(e,t){return c()(t.startContainer).closest("[data-macro-body-type='PLAIN_TEXT']").length>0},insert:function(e,t,n){n.raw&&e.selection.setContent(n.raw())}},{shouldInsert:function(e,t,n){var r=c()(t.startContainer).closest("table").length>0,o=1===n.length&&n.is("table.wysiwyg-macro");return r&&o},insert:function(e,t,n){e.execCommand("mceInsertContent",!1,n[0].outerHTML)}},{shouldInsert:function(e,t,n){var r=c()(t.startContainer).closest("table").is("table.wysiwyg-macro"),o=1===n.length&&n.is("table.confluenceTable");return r&&o},insert:function(e,t,n){e.execCommand("mceInsertContent",!1,n[0].outerHTML)}}],te={insert:function(e,t,n,r){var o,i,a,c=e.selection.getRng(!0),s=(o=e,i=t.content,a={content:i,format:"html",selection:!0},o.fire("BeforeSetContent",a),a.content),l=J(s,e.getDoc());l.raw=!!n&&function(){return n};var u=Z(e,c,l);u?(u.insert(e,c,l),e.fire("SetContent",{content:s,format:"html",selection:!0}),e.addVisual()):(e.selection.isCollapsed()||e.undoManager.ignore((function(){e.execCommand("mceDelete",!1,null,{skip_undo:!0})})),t.wasProcessed=!0,e.execCommand("mceInsertContent",!1,t,{skip_undo:r}))},parse:J};function ne(e,t,n,r){return"function"==typeof r?c()(e).bind(t,n,r):c()(e).bind(t,n)}function re(e,t,n){return c()(e).unbind(t,n)}function oe(e,t,n){return c()(e).trigger(t,n)}function ie(e){var t={repair:D.repair,parse:te.parse},n=null;function o(e){return(e||"").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(?:\r\n|\r|\n)/g,"<br />")}e.on("PastePreProcess",(function(e){e.content=D.apply(e.content),oe(r.document,"prePaste",[t,e]),r.tinymce.Env.ie&&(n=function(e){var t=c()("<pre>".concat(e.content||"","</pre>"))[0];return o(t.innerText||t.textContent)}(e))})),e.on("PastePostProcess",(function(n){K.apply(n.node,e.getBody()),oe(r.document,"postPaste",[t,n])})),e.on("BeforeExecCommand",(function(t){var r=t.command,o=t.value;"mceInsertContent"===r&&o&&!0===o.paste&&!o.wasProcessed&&(t.preventDefault(),te.insert(e,o,n,!1))})),e.on("paste",(function(e){if(n=null,!r.tinymce.Env.ie){var t=o(e.clipboardData.getData("text/plain"));n=t}}),!0)}var ae,ce,se=[],le={};function ue(e){var t='<span class="text-placeholder">'.concat(ae,"</span>"),n=c()("<div></div>").append(t);e&&n.find(".text-placeholder").html(e),r.tinymce.activeEditor.execCommand("mceInsertContent",!1,n.html())}function de(e){var t=r.tinymce.activeEditor,n=c()(t.getBody()),o=ae,i=e.parentElement;"LI"===i.nodeName&&(o=ce);var a=t.dom.create("span",{id:"placeholder-cursor"},"&nbsp;");i.replaceChild(a,e);var s=n.find("#placeholder-cursor")[0];t.selection.select(s.firstChild),t.dom.remove(s,!1),t.execCommand("mceInsertContent",!1,o)}function fe(){return[].concat(se)}function me(e){return le[e]}r.tinymce.Env.ie?(ae="\ufeff{$caret}",ce="<p>{$caret}</p>"):ce=ae=r.tinymce.Env.webKit?"\ufeff{$caret}<br>":"\ufeff{$caret}";var pe={insertTextPlaceHolder:ue,removePlaceholder:de,addPlaceholderType:function(e){e&&e.type&&(se.push(e),le[e.type]=e)},getPlaceholderTypes:fe,getPlaceholderType:me};function ge(){return r.AJS.Rte}var he={"editor.autocomplete.macros.header.text":"\u5b8f\u5efa\u8bae","editor.autocomplete.macros.dialog.browse":"\u6253\u5f00\u5b8f\u6d4f\u89c8\u5668","editor.autocomplete.macros.error.load.header":"\u83b7\u53d6\u5b8f\u8be6\u60c5\u5931\u8d25","editor.autocomplete.macros.error.load.retrylink":"\u91cd\u8bd5","editor.autocomplete.links.header.text":"\u94fe\u63a5\u5efa\u8bae","editor.autocomplete.links.dialog.search":"\u641c\u7d22&lsquo;{0}&rsquo;","editor.autocomplete.links.dialog.search.no.text":"\u641c\u7d22","editor.autocomplete.links.web.link":"\u63d2\u5165\u7f51\u7ad9\u94fe\u63a5","editor.autocomplete.links.create.link":"\u63d2\u5165\u94fe\u63a5\u4ee5\u521b\u5efa\u9875\u9762","editor.autocomplete.file.header.text":"\u6587\u4ef6\u5efa\u8bae","editor.autocomplete.media.header.text":"\u5a92\u4f53\u5efa\u8bae","editor.autocomplete.media.files.dialog.browse":"\u6253\u5f00\u6587\u4ef6\u5e93","editor.autocomplete.media.macros.dialog.browse":"\u63d2\u5165\u5176\u5b83\u5a92\u4f53","editor.autoformat.sampletext.firstcell":"\u9996\u4e2a\u5355\u5143\u683c","editor.autoformat.sampletext.heading":"\u6807\u9898","calendar3.helptip.learn.more":"calendar3.helptip.learn.more","tinymce.confluence.placeholder.inline.tasks":"\u5728\u6b64\u8f93\u5165\u4efb\u52a1\uff0c\u7528\u0022@+\u4eba\u540d\u0022\u5c06\u4efb\u52a1\u5206\u6d3e\u5e76\u7528\u0022//\u0022\u9009\u62e9\u5230\u671f\u65e5","tinymce.confluence.files":"\u6587\u4ef6","tinymce.confluence.conf_file_desc":"\u63d2\u5165\u6587\u4ef6\u548c\u56fe\u7247","tinymce.confluence.conf_file_shortcut":"Ctrl+M","tinymce.confluence.conf_wikimarkup_conversion_errors":"Wiki\u6807\u8bb0\u8f6c\u6362\u9519\u8bef","tinymce.confluence.conf_wikimarkup_timeout":"\u670d\u52a1\u5668\u5904\u7406wiki\u6807\u8bb0\u65f6\u95f4\u8fc7\u957f\uff0c\u4e5f\u8bb8\u662f\u5076\u53d1\u95ee\u9898\uff0c\u53ef\u4ee5\u7a0d\u540e\u518d\u8bd5\u3002","tinymce.confluence.conf_wikimarkup_info_title":"\u5728\u4e0b\u9762\u8f93\u5165wiki\u6807\u8bb0\u8bed\u8a00\uff0cConfluence\u5c06\u8f6c\u6362\u5185\u5bb9\u6210\u4e3a\u7f16\u8f91\u5668\u683c\u5f0f\u5e76\u63d2\u5165\u5230\u9875\u9762\u4e2d\u3002","tinymce.confluence.conf_wikimarkup.insert.label":"\u63d2\u5165","tinymce.confluence.conf_wikimarkup_preview_label":"\u9884\u89c8","editor.minor.edit":"\u901a\u77e5\u5173\u6ce8\u4eba","property.panel.textplaceholder.display.default":"\u6587\u672c","property.panel.textplaceholder.display.default.tooltip":"\u5f53\u7528\u6237\u8f93\u5165\u65f6\uff0c\u5f15\u5bfc\u6027\u6587\u5b57\u5c06\u88ab\u7a7a\u5185\u5bb9\u66ff\u6362\u3002","property.panel.textplaceholder.remove":"\u5220\u9664","editor.shared.draft.done.desc":"\u4fdd\u5b58\u8349\u7a3f\u5e76\u9009\u62e9\u7f16\u8f91\u5668\u3002","editor.change.comment":"\u53d8\u66f4\u4e86\u4ec0\u4e48?","tinymce.tablepicker.insert_table_title":"\u63d2\u5165\u8868\u683c","com.atlassian.confluence.extra.team-calendars.calendar.helptip.close":"com.atlassian.confluence.extra.team-calendars.calendar.helptip.close","comment.notification.enable":"\u5173\u6ce8\u6b64\u9875\u9762"},ve=function(e){var t=he[e];return void 0!==t?t:e};function be(){return{name:"textplaceholder",canHandleElement:function(e){return e.hasClass("text-placeholder")},handle:function(e){if("click"===e.e.type||"mouseup"===e.e.type){var t,n=fe(),o=e.containerEl,i=o.getAttribute("data-placeholder-type"),a=[],s=d("default",ve("property.panel.textplaceholder.display.default"),ve("property.panel.textplaceholder.display.default.tooltip"));s.selected=!i,a.push(s);for(var l=0,u=n.length;l<u;l++)t=n[l],a.push(d(t.type,t.label,t.tooltip));a.push(null),a.push({className:"text-placeholder-property-panel-remove-button",text:ve("property.panel.textplaceholder.remove"),click:function(){r.Confluence.PropertyPanel.destroy(),de(o)}}),r.Confluence.PropertyPanel.createFromButtonModel("textplaceholder",o,a,{anchorIframe:ge().getEditorFrame()})}function d(e,t,n){return{className:"text-placeholder-property-panel-type-item text-placeholder-property-panel-type-".concat(e),text:t,tooltip:n,selected:i===e,click:function(){!function(e){"default"===e?o.removeAttribute("data-placeholder-type"):o.setAttribute("data-placeholder-type",e);var t=c()(".text-placeholder-property-panel-type-".concat(e));t.parent().find(".text-placeholder-property-panel-type-item").removeClass("selected"),t.addClass("selected")}(e)}}}}}}function ye(){var e='<style type="text/css">.wiki-content .text-placeholder { display: inline; }</style>',t='<style type="text/css">.wiki-content .text-placeholder { display: inline-block; }</style>',n={click:!1,keypress:!0},o=r.tinymce.VK,i=r.tinymce.dom.Event,a="template"===M.get("content-type");function s(e){u("cursor-target-refresh"),c()("#rte-button-insert-placeholder").click((function(e){e.preventDefault(),ue()})),e.on("KeyDown",(function(t){if(13===t.keyCode&&!t.shiftKey){var n=e.selection.getNode(),o=c()(n).closest(".text-placeholder");if(o.length&&b(e,e.selection.getRng(),n))return y(e,o,!0),r.tinymce.dom.Event.cancel(t)}}),!0)}var l={UL:!0,OL:!0,LI:!0,TABLE:!0,TBODY:!0};function d(e){return!l[e.nodeName]}function f(e){function t(){var t=f();t&&e.selection.select(t)}function a(e){e.off("KeyDown",s),e.off("KeyPress",l),e.off("Click",l)}function s(t){var n=f();return t.keyCode===o.LEFT||t.keyCode===o.UP?(function(e,t){for(var n,r=t.previousSibling;t&&!r;)r=(t=t.parentNode).previousSibling;if(r){for(n=r;!d(n)&&n.lastChild;)n=n.lastChild;e.selection.select(n.lastChild||n),e.selection.collapse(!1),e.selection.normalize()}}(e,n),i.cancel(t)):t.keyCode===o.RIGHT||t.keyCode===o.DOWN?(function(e,t){for(var n,r=t.nextSibling;t&&!r;)r=(t=t.parentNode).nextSibling;if(r){for(n=r;!d(n)&&n.firstChild;)n=n.firstChild;e.selection.select(n.firstChild||n),e.selection.collapse(!0),e.selection.normalize()}}(e,n),i.cancel(t)):t.keyCode===o.BACKSPACE||t.keyCode===o.DELETE?(de(n),i.cancel(t)):void 0}function l(e){if(!r.tinymce.Env.gecko||e.isChar||"keypress"!==e.type){var t,o,i,a=f();if(a){var s=a.getAttribute("data-placeholder-type");t=s,o=e.type,i=me(t),c.a.extend({},n,i&&i.activation)[o]&&(de(a),u("editor.text-placeholder.activated",{placeholderType:s||"",triggerEvent:e}))}}}function f(){var t=c()(e.getBody()).find(".text-placeholder.selected");return t.length?t[0]:(a(e),null)}e.on("NodeChange",(function(n){var r=n.element,o=c()(r).closest(".text-placeholder");c()(e.getBody()).find(".text-placeholder.selected").not(o).removeClass("selected"),o.length?(o.hasClass("selected")||(o.addClass("selected"),function(e){e.on("KeyDown",s,!0),e.on("KeyPress",l,!0),e.on("Click",l,!0)}(e)),setTimeout(t,0)):a(e)}),!0)}return{init:function(n){n.on("init",(function(){(a?s:f)(n),function(n){var o=c()(n.getDoc()).find("head");r.tinymce.Env.ie?o.append(e):o.append(t)}(n)}))},getInfo:function(){return{longname:"Text Placeholder Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}}}var Ce=M.get("context-path");function we(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var xe,ke=0,Te={updateNode:function(e,t){var n=r.tinymce.activeEditor,o=c()(e,n.getDoc()),i="confluence.update-node-".concat(ke++);u("synchrony.stop",{id:i});var a=Te.prepareNodeForUpdate(o);return Te.replaceNode(o,t).fail(a).always((function(){u("synchrony.start",{id:i})})).promise()},storeNodeState:function(e,t){for(var n,r={},o=0,i=t.length;o<i;o++)n=t[o],r[n]=e.attr(n);return function(){for(var t in r)e.attr(t,r[t])}},prepareNodeForUpdate:function(e){var t=null;return e.is("img")&&(t=Te.storeNodeState(e,["width","height","src","class"]),e.addClass("image-hotswap").attr({src:"".concat(Ce,"/images/border/spacer.gif"),width:e.attr("width"),height:e.attr("height")})),t},replaceNode:function(e,t){var n=Te.getDoc(),r=c()(t,n),o=c()(e,n),i="confluence.replace-node-".concat(ke++);return u("synchrony.stop",{id:i}),c.a.Deferred((function(){var e=this;r.is("img")?(r[0].onload=function(){this.onload=null,e.resolve(this)},c.a.browser.opera&&(r[0].src=r.attr("src")),n.createDocumentFragment().appendChild(r[0])):e.resolve(r[0])})).always((function(){u("synchrony.start",{id:i})})).done((function(e){o.replaceWith(e)})).promise()},replaceSelection:function(e){var t=r.tinymce.activeEditor,n=t.selection.getRng(!0),o=t.getDoc().createRange(),i=c()(e).clone(!0,!1)[0];n.deleteContents(),3===n.startContainer.nodeType&&""===n.startContainer.nodeValue&&(n.startContainer.nodeValue=ge().HIDDEN_CHAR),n.insertNode(i);var a=t.getDoc().createTextNode(ge().HIDDEN_CHAR);t.dom.insertAfter(a,i);var s=a;return o.setStartBefore(s),o.setEndAfter(s),o.collapse(!1),t.selection.setRng(o),i},normalize:function(e){var t,n,o,i=r.tinymce.activeEditor,a=i.selection.getRng(!0),c=[];e&&e.childNodes&&(r.tinymce.isWebKit?t=a:r.tinymce.isGecko&&(t=a.cloneRange(),((n={startIndex:we(e.childNodes).indexOf(a.startContainer),startOffset:t.startOffset,endIndex:we(e.childNodes).indexOf(a.endContainer),endOffset:t.endOffset}).startIndex>-1||n.endIndex>-1)&&(c=function(e){var t=[],n=0;return Array.prototype.forEach.call(e.childNodes,(function(e,r){var o={},i=t[r-1]||{};o.isTextNode=3===e.nodeType,o.textNodesBefore=(o.isTextNode&&i.isTextNode?1:0)+~~i.textNodesBefore,o.precedingTextLength=n,n=o.isTextNode?n+e.nodeValue.length:0,t.push(o)})),t}(e))),e.normalize(),r.tinymce.isGecko&&((o=c[n.startIndex])&&(n.newStartIndex=n.startIndex-o.textNodesBefore,n.newStartOffset=n.startOffset+o.precedingTextLength,t.setStart(e.childNodes[n.newStartIndex],n.newStartOffset)),(o=c[n.endIndex])&&(n.newEndIndex=n.endIndex-o.textNodesBefore,n.newEndOffset=n.endOffset+o.precedingTextLength,t.setEnd(e.childNodes[n.newEndIndex],n.newEndOffset))),t&&i.selection.setRng(t))},getDoc:function(){return c.a.browser.mozilla||c.a.browser.opera?document:r.tinymce.activeEditor.getDoc()},isolateSelectedRange:function(){var e,t=r.tinymce.activeEditor,n=Te.getDoc(),o=t.selection,i=o.getRng(!0),a=i.startContainer,s=i.startOffset,l=i.endContainer,u=i.endOffset;if(i.collapsed)return i;function d(e,r,o){var i=t.dom.getParent(e,t.dom.isBlock);i||(i=t.getBody());var a=function(e,t,r,o){var i,a,s=null,l=null,u=o?"nextSibling":"previousSibling";if(!(i=0===t)&&o&&(i=3===e.nodeType?t===e.length:t===e.childNodes.length),i)for(s=e[u],l=e;null===s;){if(l===r)return;if(l.parentNode===r)break;s=(l=l.parentNode)[u]}else 3===e.nodeType?(a=e.data,e.data=a.slice(t),s=n.createTextNode(a.slice(0,t)),l=e,c()(s).insertBefore(l),o&&(a=l,l=s,s=a)):s=(l=e.childNodes[t-(o?1:0)])[u];return[l,s]}(e,r,i,o);return a?a[1]?function(e,t,n,r){for(var o,i,a,s;t!==n&&t.parentNode!==n;){if(o=(i=t.parentNode).cloneNode(!1),r)for(c()(o).insertAfter(i),a=e;a;)s=a.nextSibling,o.appendChild(a),a=s;else for(c()(o).insertBefore(i),a=i.firstChild;a!==t;)s=a.nextSibling,o.appendChild(a),a=s;e=o,t=i}return t}(a[1],a[0],i,o):a[0]:void 0}a===l&&(e=u-s);var f=d(a,s);f&&i.setStartBefore(f),a!==i.startContainer&&(u=e||u);var m=d(l,u,!0);return m&&i.setEndAfter(m),o.setRng(i),i}},Ee=Te;var Se=function(){var e,t=r.tinymce.activeEditor,n=Ae();t.focus();var o=t.selection.getRng();e=o.cloneRange&&"function"==typeof o.cloneRange?o.cloneRange():o.duplicate&&o.duplicate()||o,xe={scrollX:n.scrollX,scrollY:n.scrollY,range:e}},Ne=function(){var e=r.tinymce.activeEditor.selection,t=r.tinymce.activeEditor.getWin();xe&&(Re(xe),t.focus(),e.setRng(xe.range)),xe=null},Ae=function(){var e=r.tinymce.DOM.getViewPort(r.tinymce.activeEditor.getWin());return{scrollX:e.x,scrollY:e.y}},Re=function(e){e&&r.tinymce.activeEditor.getWin().scrollTo(e.scrollX,e.scrollY)},_e={storeBookmark:Se,restoreBookmark:Ne,getScroll:Ae,restoreScroll:Re};function Ie(){var e=M.get("content-id");return+e||(e=M.get("page-id")),+e||(e="0"),e}function Be(e){return c()(e).hasClass("wysiwyg-macro")}function Pe(e,t){var n;if(e.macro&&e.contentId)n={type:"POST",url:"".concat(Ce,"/rest/tinymce/1/macro/placeholder"),contentType:"application/json; charset=utf-8",data:c.a.toJSON(e),dataType:"text"};else{if(!e.url||!e.type)throw new Error("illegal argument received: ".concat(e));n=e}var o,i=c.a.Deferred(),a=r.tinymce.activeEditor;if(!t){var s="macro-".concat((new Date).getTime());o=a.dom.create("span",{id:s}),a.selection.setNode(o),t=o=a.dom.select("#".concat(s))[0],i.fail((function(){c()(o).remove()}))}return c.a.extend(n,{timeout:this.DEFAULT_INSERT_MACRO_TIMEOUT}),g.a.Editor.UI.setButtonsState(!1),c.a.ajax(n).done((function(e){function n(e){return e&&e.parentNode}"<"!==e[0]&&(e=document.createTextNode(e)),n(t)?Ee.updateNode(t,e).done((function(t){i.resolve(t,e)})).fail(i.reject):i.rejectWith(this,arguments)})).fail((function(e,t,n){i.rejectWith(this,arguments)})),i.done((function(e,t){g.a.Editor.UI.setButtonsState(!0),Be(e)&&/P|H\d/.test(e.parentNode.nodeName)&&a.dom.split(e.parentNode,e),function(e){var t=r.tinymce.activeEditor,n=t.getDoc(),o=t.selection.getRng(!0);if(Be(e)){!r.tinymce.isIE&&c()("p, pre",e).each((function(e,t){0===t.childNodes.length&&t.appendChild(n.createElement("br"))}));var i=t.dom.select(".wysiwyg-macro-body",e)[0].firstChild;i&&(o.setStart(i,0),o.setEnd(i,0))}else o.setStartAfter(e),o.setEndAfter(e);t.selection.setRng(o)}(e),a.nodeChanged(),ge().showElement(e),a.selection.onSetContent.dispatch(a.selection,{content:t,format:"html"}),r.tinymce.activeEditor.undoManager.add(),u("macro-browser.macro-inserted")})).fail((function(){g.a.Editor.UI.setButtonsState(!0)})),i.promise()}var De={DEFAULT_INSERT_MACRO_TIMEOUT:5e3,insertMacro:Pe,isInMacro:function(e){return(e.jquery?e:c()(e)).closest(".wysiwyg-macro").length>0},updateMacro:function(e,t,n,r){return Pe({contentId:Ie(),macro:{name:n,params:e,body:t||""}},r)}},Oe=De;var Me={storedRange:null,bookmark:null,getCurrentNode:function(){return c()(r.tinymce.activeEditor.selection.getNode())},isMacroDiv:function(e){return c()(e).hasClass("wysiwyg-macro")},isMacroTag:function(e){var t=c()(e);return t.hasClass("wysiwyg-macro")||t.hasClass("editor-inline-macro")},isBodylessMacro:function(e){return c()(e).hasClass("editor-inline-macro")},isMacroWithBody:function(e){return c()(e).hasClass("wysiwyg-macro")},isMacroStartTag:function(e){return c()(e).hasClass("wysiwyg-macro-starttag")},isMacroEndTag:function(e){return c()(e).hasClass("wysiwyg-macro-endtag")},isMacroBody:function(e){return c()(e).hasClass("wysiwyg-macro-body")},hasMacroBody:function(e){return"true"==c()(e).attr("macrohasbody")},getNestingMacros:function(e){var t=c()(e||Me.getCurrentNode()),n=[];return t.parents(".wysiwyg-macro").each((function(e,t){n.push(c()(t).attr("data-macro-name"))})),n},logMCESelection:function(e){r.tinymce.activeEditor.selection},getSelectedMacro:function(){var e=Me.getCurrentNode();return Me.isMacroDiv(e)?e:Oe.isInMacro(e)},openMacro:function(e){g.a.MacroBrowser.open({selectedMacro:e,onComplete:Me.macroBrowserComplete,onCancel:Me.macroBrowserCancel})},editMacro:function(e){var t=c()(e);Me.editedMacroDiv=t[0];var n=r.tinymce.activeEditor.serializer.serialize(t.clone()[0],{forced_root_block:!1});r.tinymce.activeEditor.selection.select(t[0]),Se(),c.a.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"".concat(Ce,"/rest/tinymce/1/macro/definition"),data:c.a.toJSON({contentId:Ie(),macroHtml:n}),dataType:"text",success:function(e){Me.openMacro(c.a.secureEvalJSON(e))}})},macroBrowserToolbarButtonClicked:function(e){var t=r.tinymce.activeEditor,n=Me.getCurrentNode();Se();var o=c.a.extend({presetMacroName:null,nestingMacros:Me.getNestingMacros(n),onComplete:Me.macroBrowserComplete,onCancel:Me.macroBrowserCancel,mode:"insert",selectedHtml:"",selectedText:""},e);if((!e||e&&!e.ignoreEditorSelection)&&(o.selectedHtml=t.selection.getContent(),o.selectedText=t.selection.getContent({format:"text"})),"function"!=typeof g.a.MacroBrowser.Model.addMacro)return g.a.MacroBrowser.open(o);var i=o.presetMacroMetadata&&o.presetMacroMetadata.macroName||o.presetMacroName,a=g.a.MacroBrowser.getMacroMetadata(i);a?(o.presetMacroMetadata=o.presetMacroMetadata||a,g.a.MacroBrowser.open(o)):g.a.MacroBrowser.Rest.fetchMacroMetadataDetails({id:o.presetMacroName,successCallback:function(e){e&&e.details?(g.a.MacroBrowser.Model.addMacro(e.details),o.presetMacroMetadata=g.a.MacroBrowser.getMacroMetadata(o.presetMacroName),s("reset.complete",(function e(){g.a.MacroBrowser.open(o),l("reset.complete",e)})),u("reset.rte")):g.a.MacroBrowser.open(o)},errorCallback:function(e){console.log("AJS.MacroBrowser.Rest.fetchMacroMetadataDetails ERROR",e)}})},macroBrowserComplete:function(e){var t={contentId:M.get("content-id")||"0",macro:{name:e.name,params:e.params,defaultParameterValue:e.defaultParameterValue,body:e.bodyHtml}};Ne(),Me.editedMacroDiv?(Oe.insertMacro(t,Me.editedMacroDiv),delete Me.editedMacroDiv):Oe.insertMacro(t)},macroBrowserCancel:function(){Ne(),Me.editedMacroDiv=null,Me.editedMacro=null}},Le=Me;function Fe(e){return e&&3===e.nodeType&&0===e.nodeValue.length}var je={isCursorAtStartOf:function(e,t){return t.collapsed&&this.isRangeAtStartOf(e,t)},isRangeAtStartOf:function(e,t){if(!t||!t.startContainer)throw new Error("range is invalid. received: ".concat(t));if(!e||!e.nodeType)throw new Error("context is invalid. received: ".concat(e));var n,o=t.startContainer;if(3===o.nodeType){if(0!==t.startOffset)return!1;n=o}else if(void 0===(n=o.childNodes[t.startOffset])&&o.childNodes.length>0)return!1;var i,a=new r.tinymce.dom.TreeWalker(n,e);do{i=a.prev(!0)}while(Fe(i));return void 0===i},isCursorAtEndOf:function(e,t){return t.collapsed&&this.isRangeAtEndOf(e,t)},isRangeAtEndOf:function(e,t){if(!t||!t.endContainer)throw new Error("range is invalid. received: ".concat(t));if(!e||!e.nodeType)throw new Error("container is invalid. received: ".concat(e));var n,o=t.endContainer;if(3===o.nodeType){if(t.endOffset!=o.nodeValue.length)return!1;n=o}else n=o.childNodes[0===t.endOffset?t.endOffset:t.endOffset-1];var i,a=new r.tinymce.dom.TreeWalker(n,e);do{i=a.next(!0)}while(Fe(i));return void 0===i||"BR"===i.nodeName&&void 0===a.next(!0)},setCursorAtStartOfContents:function(e){if(!e)throw new Error("element is required.");if(1!==e.nodeType&&3!==e.nodeType)throw new Error("invalid argument: expected a DOM element or text node, got: ".concat(e));var t=r.tinymce.activeEditor,n=t.dom.createRng();["br","img"].includes(e.nodeName.toLowerCase())?(n.setStartBefore(e),n.setEndBefore(e),t.selection.setRng(n)):(t.selection.select(e,!0),t.selection.collapse(!0))}},He=je;n("./src/editor-plugins/propertypanel/css/property-panel.css");var Ue=function(){var e=r.Confluence.PropertyPanel,t=[];return s("add-handler.property-panel",(function(e,n){n&&t.push(n)})),{init:function(n){var o,i=function(){return!!e.current},a=function(o,a){var s={focusedEl:a,focusedNodeName:a.nodeName&&a.nodeName.toLowerCase(),ed:n,e:c.a.extend({},o)},l=function(e){if(e.is("img"))return e[0];var t=e.closest("a,table,.wysiwyg-macro,.editor-inline-macro,.text-placeholder");return t.length?t[0]:""}(c()(a)),d=!!c()(a).closest("table:not(.wysiwyg-macro,.editor-inline-macro)").length,f=!!c()(".toolbar-contextual").length;if(s.containerEl=l,u("user-blurred-rte-element",s),l&&!function(e){return"click"==e.type&&(e.which?3===e.which:e.button?2==e.button:void 0)}(o)&&!i()&&e.shouldCreate)for(var m=0,p=t.length;m<p;m++)if(t[m].canHandleElement(c()(l))){if(f||!d)return t[m].handle(s);!function(e){ne(r.document,"shown.contextToolbar",(function(){e.handle(s)}))}(t[m])}};function d(e,t){a(e,t.elem)}function f(t,n){i()&&(!n.containerEl||e.current.hasAnchorChanged(n.containerEl)?e.destroy():u("same-anchor.property-panel"))}function m(){setTimeout((function(){ge().bindScroll("property-panel",(function(){e.destroy()}))}),0),c()(n.getDoc()).bind("keydown.property-panel.escape",(function(t){27===t.keyCode&&i()&&e.destroy()}))}function p(){ge().unbindScroll("property-panel"),c()(n.getDoc()).unbind("keydown.property-panel.escape")}r.tinymce.Env.ie&&n.on("MouseDown",(function(e){o&&o.unbind("mouseup.IEDragHandlesWorkaround"),(o=c()(e.target)).filter("img, table").bind("mouseup.IEDragHandlesWorkaround",(function(){a(n,e,e.target)}))})),n.on("Click",(function(e){a(e,e.target)})),n.on("KeyUp",(function(e){27!==e.keyCode&&a(e,n.selection.getNode())}),!0),n.on("ContextMenu",(function(){e.destroy()})),s("trigger.property-panel",d),s("user-blurred-rte-element",f),s("created.property-panel",m),s("destroyed.property-panel",p),n.on("Remove",(function(){l("trigger.property-panel",d),l("user-blurred-rte-element",f),l("created.property-panel",m),l("destroyed.property-panel",p)}))},getInfo:function(){return{longname:"Image, Link and Macro Property Panels",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}};n("./src/editor-plugins/confcharmap/charmap.css");function We(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var ze=/^\u200b?(\[)$/;function qe(e){return e.dom.getParent(e.selection.getStart(),"UL,OL")}function Ve(e){return!(!e||"ul"!==e.nodeName.toLowerCase()||!e.classList.contains("inline-task-list"))}function $e(e){return e&&"ul"===e.nodeName.toLowerCase()&&!Ve(e)}function Ke(e){e&&e.classList.contains("inline-task-list")&&(e.classList.remove("inline-task-list"),0===e.classList.length&&e.removeAttribute("class"),e.removeAttribute("data-inline-tasks-content-id"),Array.prototype.slice.call(e.children).forEach((function(e){e.removeAttribute("data-inline-task-id"),e.classList.remove("checked"),e.style.backgroundImage=""})))}function Je(){return!("true"===(e=M.get("use-inline-tasks"))||!0===e)&&"page"!==M.get("content-type")&&"blogpost"!==M.get("content-type")&&"template"!==M.get("content-type");var e}var Ge=function(){var e=M.get("content-type");return M.get("collaborative-content")&&("page"===e||"blogpost"===e)};var Xe,Ye={},Qe=0,Ze=function(){Object(r.clearTimeout)(Xe),Xe=Object(r.setTimeout)(nt,6e4);r.tinymce.activeEditor.on("ExecCommand",(function(e){var t,n="mceToggleFormat"===e.command?(t=e.value).charAt(0).toUpperCase()+t.slice(1):e.command;tt(rt[n])})),r.tinymce.activeEditor.on("KeyPress",(function(){tt("keys")})),r.tinymce.activeEditor.on("KeyUp",(function(e){46===e.keyCode?tt("delete",Qe):8===e.keyCode&&tt("backspace",Qe),Qe=r.tinymce.activeEditor.selection.getContent().length})),r.tinymce.activeEditor.on("MouseUp",(function(){Qe=r.tinymce.activeEditor.selection.getContent().length})),r.tinymce.activeEditor.on("PastePostProcess",(function(e){var t=e&&e.node?e.node.innerText||e.node.textContent:"";tt("paste",t.length)})),r.tinymce.activeEditor.on("Remove",(function(){nt(),Object(r.clearTimeout)(Xe)}))},et=function(){o.a.addEventListener("beforeunload",(function(){nt()}))},tt=function(e,t){if(e&&(Ye[e]?Ye[e]++:Ye[e]=1,t)){var n="".concat(e,"Size");Ye[n]?Ye[n]+=t:Ye[n]=t}},nt=function e(){Ye.pageID=M.get("page-id"),Ye.editorVersion=m("0.74.1"),u("analytics",{name:"confluence.editor.action",data:Ye}),Ye={},Object(r.clearTimeout)(Xe),Xe=Object(r.setTimeout)(e,6e4)},rt={Bold:"bold",confCharmap:"insert.symbol",confMonospace:"monospace",confTableRowToggleHeading:"table.row.toggle.heading",confTableColumnToggleHeading:"table.column.toggle.heading",confTableSelectionToggleHighlight:"table.selection.toggle.highlight",ForeColor:"foreground.color",FormatBlock:"format.block",Indent:"indent",InsertHorizontalRule:"insert.horizontal.rule",InsertOrderedList:"insert.ordered.list",InsertUnorderedList:"insert.unordered.list",InsertWikiMarkup:"insert.wiki.markup",Italic:"italic",JustifyCenter:"justify.center",JustifyLeft:"justify.left",JustifyRight:"justify.right",mceConfimage:"insert.files.images",mceConflink:"insert.link",mceConfMacroBrowser:"open.other.macros.browser",mceEmotion:"insert.emoticon",mceTableCopyRow:"table.copy.row",mceTableCutRow:"table.cut.row",mceTableDelete:"table.delete",mceTableDeleteCol:"table.delete.column",mceTableDeleteRow:"table.delete.row",mceTableInsertColAfter:"table.insert.column.after",mceTableInsertColBefore:"table.insert.column.before",mceTableInsertRowAfter:"table.insert.row.after",mceTableInsertRowBefore:"table.insert.row.before",mceTableMergeCells:"table.merge.cells",mceTablePasteRowBefore:"table.paste.row.before",mceTableSplitCells:"table.split.cells",mcePageLayoutsToolbar:"page.layouts.toolbar.toggle",mcePageLayoutAddSection:"page.layouts.toolbar.add.section",mcePageLayoutRemoveSection:"page.layouts.toolbar.remove.section",mcePageLayoutMoveSectionDown:"page.layouts.toolbar.movedown.section",mcePageLayoutMoveSectionUp:"page.layouts.toolbar.moveup.section",mcePageLayoutChangeSection:"page.layouts.toolbar.change.section",mceConfShortcutDialog:"open.help.dialog",mceSearchReplaceToolbar:"search.replace.toolbar.toggle",mceConfSearchClose:"search.replace.toolbar.close",mceConfSearch:"search",mceConfReplace:"replace",mceConfReplaceAll:"replace.all",Outdent:"outdent",Redo:"redo",Strikethrough:"strikethrough",subscript:"subscript",superscript:"superscript",Underline:"underline",Undo:"undo",InsertInlineTaskList:"insert.inline.tasklist",InsertInlineTaskListNoToggle:"insert.inline.tasklist.no.toggle"},ot=tt;var it=function(e){e.addCommand("confInsertTable",(function(t,n){!function(e,t,n,o){var i,a,c,s,l,u=r.tinymce.Env,d=u.ie&&u.ie<10?"&nbsp;":'<br data-mce-bogus="1">';for(c='<table id="__mce" class="confluenceTable"><tbody>',i=0;i<n;i++){var f=0===i&&o,m=f?"confluenceTh":"confluenceTd";for(c+="<tr>",a=0;a<t;a++)c+=f?"<th class=".concat(m,">").concat(d,"</th>"):"<td class=".concat(m,">").concat(d,"</td>");c+="</tr>"}c+="</tbody></table>",e.undoManager.transact((function(){e.insertContent(c),s=e.dom.get("__mce"),e.dom.setAttrib(s,"id",null),e.$("tr",s).each((function(t,n){e.fire("newrow",{node:n}),e.$("th,td",n).each((function(t,n){l=l||n,e.fire("newcell",{node:n})}))})),e.dom.setAttribs(s,e.settings.table_default_attributes||{}),e.dom.setStyles(s,e.settings.table_default_styles||{})})),e.selection.select(l,!0),e.selection.collapse(!0)}(e,n.cols,n.rows,n.heading),ot("insert.table")})),e.addCommand("mceInsertTable",(function(){r.tinymce.execCommand("confInsertTable",!1,{rows:4,cols:3,heading:!0})}))};function at(){return c()("#table-highlight-group").attr("data-highlight-colour")||""}function ct(e,t,n){if(t.length){for(var r=function(e,t){var n=c()(e.selection.getNode());return!!n.length&&(n[0]===t[0]||!!n.closest(t).length)}(e,t),o=t[0],i=o.ownerDocument.createElement(n),a=o.attributes,s=0,l=a.length;s<l;s++){var u=a[s];i.setAttribute(u.nodeName,u.nodeValue)}for(;o.hasChildNodes();)i.appendChild(o.firstChild);return o.parentNode.replaceChild(i,o),r&&(e.selection.select(i,!0),e.selection.collapse()),c()(i)}}var st={convertToNormalCells:function(e,t){t.filter("th").each((function(){var t=c()(this);(t=ct(e,t,"td")).removeClass("confluenceTh"),t.addClass("confluenceTd")}))},convertToHeadingCells:function(e,t){t.filter("td").each((function(){var t=c()(this);(t=ct(e,t,"th")).removeClass("confluenceTd"),t.addClass("confluenceTh")}))},areCellsHeadings:function(e){var t=e.filter("th").length;return e.length===t},isColumnHeading:function(e,t){var n=c()(e).children("tbody").children("tr");return 1!==n.length&&n.children().filter("th:nth-child(".concat(t,")")).length===n.length},areCellsHighlighted:function(e){var t=e.filter("td[data-highlight-colour],th[data-highlight-colour]"),n=t.length;return e.length===n&&function(e){var t,n,r=at();for(t=0,n=e.length;t<n;t++)if((e.eq(t).attr("data-highlight-colour")||"")!==r)return!1;return!0}(t)},isColumnHighlighted:function(e,t){var n=c()(e).children("tbody").children("tr").children("th,td").nthCol(t),r=n.filter("td[data-highlight-colour],th[data-highlight-colour]").length;if(n.length!==r)return!1;for(var o=n.eq(0).attr("data-highlight-colour"),i=1,a=n.length;i<a;i++)if(o!==n.eq(i).attr("data-highlight-colour"))return!1;return!0},getSelectedHighlightColour:at},lt=0,ut=1;function dt(e){var t=0;e.find(">tbody >tr").each((function(){var e=0;c()(this).find(">th,>td").each((function(){var t=c()(this);t.attr("colspan")?e+=parseInt(t.attr("colspan")):e++})),e>t&&(t=e)}));var n=e.find(">colgroup"),r=n.find("col"),o=r.length;if(o!==t){var i=n.length>0;if(i||(n=c()("<colgroup>")),t>o)for(var a=0;a<t-o;a++){var s=c()("<col>");n.append(s)}else for(var l=0;l<o-t;l++)r.last().remove();return i||e.prepend(n),n}}function ft(e,t,n){var o=e.find(">colgroup>col");0===o.length&&(dt(e),o=e.find(">colgroup>col"));for(var i,a,s,l=o.length,u=e.find(">thead>tr,>tbody>tr,>tr"),d=0;d<u.length;d++)if(l===u.eq(d).find(">th, >td").length){i=u.eq(d);break}if(i)a=i.find(">th, >td");else{var f=c()("<tr>");(s=c()("<tfoot>")).append(f);for(var m=0;m<l;m++)f.append(c()("<td>"));e.append(s),a=f.find(">td")}for(var p=e.outerWidth()-1,g=[],h=[],v=0;v<l;v++){var b=a.eq(v),y=b[0].getBoundingClientRect(),C=t?"".concat(y.width/p*100,"%"):b.outerWidth();g[v]=C,h[v]=y}var w=0;r.tinymce.activeEditor&&(w=r.tinymce.activeEditor.getWin().pageXOffset);for(var x=0;x<l;x++)o.eq(x).attr("data-resize-pixel",h[x].width).attr("data-resize-percent",h[x].width/p*100).attr("data-offset-left",h[x].left+w).attr("data-offset-right",h[x].right+w).removeAttr("data-mce-style"),(!n||x===n.index()&&x===n.next().index())&&o.eq(x).css({width:g[x]});s&&s.remove(),e.removeAttr("data-mce-style")}function mt(e,t,n){var r={},o=!1,i=t.find("body");return n.each((function(){var t=c()(this);Ct(t)&&t.find("th, td").each((function(){if(!r[t]){var n=c()(this),a=n.offset().left+n.innerWidth();Math.abs(a-parseInt(e.attr("data-offset-right")))<=lt&&(r[t]=!0,o=!0,function(e,t){c()('<div contenteditable="false" class="resize-alignment-bar">').css({top:gt(e[0],i[0]),left:t,height:e.height()}).appendTo(i)}(t,a))}}))})),o}function pt(e){e.find(".resize-alignment-bar").remove()}function gt(e,t){return parseInt(e.getBoundingClientRect().top-t.getBoundingClientRect().top,10)}var ht=function(e){var t={$doc:c()(r.document)},n=this,o=n.data("uuid");if(!n.data("initialized")){o||(o=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return"".concat(e()+e(),"-").concat(e(),"-").concat(e(),"-").concat(e(),"-").concat(e()).concat(e()).concat(e())}(),n.data("uuid",o)),e=c.a.extend(t,e||{});var i,a,s,l,d,f,m,p,g,h,v=29,b=e.$doc,y=e.editor,C=b.find("body"),x=!1,k=-1,T=!1,E=7,S=c()('<div contenteditable="false" class="synchrony-exclude" id="resize-indicator">'),N=c()('<div contenteditable="false" class="synchrony-exclude resize-width-holder" unselectable="on">'),A=!1,R=4,_=function(){S.remove(),n.removeClass("active-resizable"),A=!1,m=void 0,l=null,d=null,C.attr("data-table-resizing",!1)},I=function(e){b.find("#resize-indicator").length>0?S=b.find("#resize-indicator"):S.appendTo(C),n.addClass("active-resizable"),S.css({top:gt(n[0],C[0]),left:e,height:n.height()}),A=!0},B=function(e){C.outerWidth(!0)!==C[0].scrollWidth&&(e&&bt(n),C.find("#".concat(o,"-holder")).length||(N.css("width",n.width()+parseInt(c()(y.getBody()).css("margin-right"))),N.attr("id","".concat(o,"-holder")),n.after(N)))};return n.on("mousemove.table-resizable".concat(o),"th, td",(function(e){if(!x&&!(c()(this).parents("table.confluenceTable").length>1||wt(n)&&w("confluence.table.resizable.hide-indicator-on-fluid"))){dt(n);var t,r=c()(this),o=r.offset().left,a=Math.round(S.outerWidth()/2),s=r.index(),l=r.parent().children();k=-1;var u=r.closest("tr").index();if(r.closest("table.confluenceTable tr").prevAll("tr").each((function(){var e=c()(this),t=e.index();e.children("td, th").each((function(){if(r.offset().left>c()(this).offset().left){var e=parseInt(c()(this).attr("colspan")),n=parseInt(c()(this).attr("rowspan"));e&&n?t+n>u&&(s+=e):n&&t+n>u&&(s+=1)}}))})),T=!1,e.pageX-r.offset().left<r.outerWidth()/2){if(0===(s-=1)&&r.prev().hasClass("numberingColumn"))return;if(s<0){T=!0;var d=l.eq(0);d.attr("colspan")?k+=parseInt(d.attr("colspan")):k++}else for(var m=0;m<=s;m++){var p=l.eq(m);p.attr("colspan")?k+=parseInt(p.attr("colspan")):k++}t=T?o+r.outerWidth()-a:o-a}else{if(0===s&&r.hasClass("numberingColumn"))return;for(var g=0;g<=s;g++){var h=l.eq(g);h.attr("colspan")?k+=parseInt(h.attr("colspan")):k++}t=o+r.outerWidth()-a}i=r.closest("table").find("col").eq(k),function(){if(Math.abs(f-t)<=1)if(A){if(Math.abs(e.pageX-t-a)<=R)return;_()}else{if(!(Math.abs(e.pageX-t-a)<=R))return;I(t)}else Math.abs(e.pageX-t-a)<=R?I(t):_()}(),f=t,Ct(n)&&B()}})),n.on("mousedown.table-resizable".concat(o),(function(e){D(e)})),n.on("mouseout.table-resizable".concat(o),(function(){x||_()})),b.on("keypress.table-resizable".concat(o),(function(){A&&_()})),b.on("mousemove.table-resizable".concat(o),(function(e){x&&(u("synchrony.stop",{id:"confluence.table-resize-plugin"}),P(e.pageX-a,!0,e),e.preventDefault())})),b.on("mouseup.table-resizable".concat(o),(function(){x&&(n[0].releaseCapture&&n[0].releaseCapture(),x=!1,_(),pt(b),bt(n),i&&i.width()!==s&&(wt(n)&&n.addClass("relative-table"),u("analytics",{name:"confluence.table.resize.from.".concat(h),data:{pageId:M.get("page-id")}})),yt(n)&&vt(n),Ct(n)&&B(!0),y&&(y.undoManager.add(),u("synchrony.start",{id:"confluence.table-resize-plugin"})))})),n.data("initialized",!0),this}function P(e,t,r){s||(s=i.width()),i.attr("data-mce-style")&&i.removeAttr("data-mce-style");var o=!1;if(p){var a=e-p,u=n.parent().width(),f=n.width()/u*100;yt(n)&&f>99.9&&a>1&&(o=!0,!d&&(d=i.width()+i.next().width()));var h=Math.abs(Math.abs(e)-Math.abs(p));if(h>=E&&(m=!1),m&&h<E)return}var y=s+e;if(y<v&&(y=v),i.width(y),(o||l)&&(i.next().width(d-y),!l&&(l=r.pageX)),l&&l>r.pageX&&(l=null),ft(n,!1,i),!T&&t&&(S.css({display:"block",top:gt(n[0],C[0]),left:parseInt(i.attr("data-offset-right"))-1,height:n.height()}),Ct(n))){var w=mt(i,b,g)||function(e,t,n){var r;return Math.abs(parseInt(e.next().attr("data-resize-pixel"))-parseInt(e.attr("data-resize-pixel")))<=ut&&(r=!0,n.find(".resizable-align-right").remove(),c()('<div contenteditable="false" class="resize-alignment-bar resizable-align-right">').css({height:t.height(),top:gt(t[0],n[0]),left:parseInt(e.next().attr("data-offset-right"))-1}).appendTo(n).clone().css({left:parseInt(e.attr("data-offset-left"))-1}).appendTo(n)),Math.abs(parseInt(e.prev().attr("data-resize-pixel"))-parseInt(e.attr("data-resize-pixel")))<=ut&&(r=!0,c()('<div contenteditable="false" class="resize-alignment-bar">').css({height:t.height(),top:gt(t[0],n[0]),left:parseInt(e.prev().attr("data-offset-right"))-1}).appendTo(n).clone().css({left:parseInt(e.prev().attr("data-offset-left"))-1}).appendTo(n)),r}(i,n,C);w&&(m=!0),!w&&pt(C)}p=Math.abs(e)}function D(e){i&&A&&(h=Ct(n)?"fixed":yt(n)?"relative":"fluid",x=!0,ft(n),n.updateTableModeInToolbar(),w("confluence.table.resizable.relative.keep.width")&&i.next().length||n.css({width:""}),a=e.pageX,n[0].setCapture&&n[0].setCapture(),b.find("body").attr("data-table-resizing",!0),s=parseInt(i.width(),10),g=function(e){var t=e.nextAll(".confluenceTable").first(),n=e.prevAll(".confluenceTable").first();return c.a.merge(n,t)}(n),e.preventDefault())}},vt=function(e){var t=e.parent().width(),n=e.width()/t*100;return n>100&&(n=100),e.css({width:"".concat(n,"%")}).attr("data-resize-percent",n),function(e){ft(e,!0)}(e),e},bt=function(e){return e.parent("body").find("#".concat(e.data("uuid"),"-holder")).remove(),e},yt=function(e){return e.hasClass("relative-table")},Ct=function(e){return e.hasClass("fixed-table")},wt=function(e){return!yt(e)&&!Ct(e)},xt=function(e){var t={$doc:c()(r.document)},n=(e=c.a.extend(t,e||{})).$doc,o=this.data("uuid");return n.find("#resize-indicator").remove(),this.off("mousemove.table-resizable".concat(o)),this.off("mouseout.table-resizable".concat(o)),this.off("mousedown.table-resizable".concat(o)),n.off("keypress.table-resizable".concat(o)),n.off("mousemove.table-resizable".concat(o)),n.off("mouseup.table-resizable".concat(o)),this.data("initialized",!1),this},kt=function(){return bt(c()(this)).removeClass("relative-table fixed-table").removeAttr("style").find(">colgroup").remove(),this},Tt=function(){var e=c()(this);return bt(e),function(e){return ft(e),e}(e).css("width","").removeClass("relative-table").addClass("fixed-table"),this},Et=function(){var e=r.tinymce.activeEditor;if(this.parent().closest("table.confluenceTable").length)return c()("#table-mode-picker .dropdown-text").text(e.translate("table.responsive")),void c()("#table-mode-picker .aui-dd-parent").addClass("disabled");c()("#table-mode-picker .aui-dd-parent").removeClass("disabled"),Ct(this)?c()("#table-mode-picker .dropdown-text").text(e.translate("table.fixed_width")):c()("#table-mode-picker .dropdown-text").text(e.translate("table.responsive"))},St=function(e,t,n){if(n||n.content){var r=c()("<div/>").append(n.content);r.find("table.confluenceTable.relative-table, table.confluenceTable.relative-table > colgroup > col").each((function(){var e;(e=c()(this)).data("resize-percent")?e.css({width:"".concat(e.data("resize-percent"),"%")}):e.attr("style",e.data("mce-style"))})),n.content=r.html()}},Nt=function(e){c.a.fn.tableResizable=ht,c.a.fn.removeTableResizable=xt,c.a.fn.toggleFluidColumnWidth=kt,c.a.fn.toggleFixedColumnWidth=Tt,c.a.fn.updateTableModeInToolbar=Et,e.on("init",(function(){!function(e){var t=c()(e.getWin().document),n=function(){t.find("table.confluenceTable").each((function(){c()(this).removeTableResizable({$doc:t})}))};function o(){n(),t.find("#resize-indicator").remove(),t.find(".resize-width-holder").remove(),c()(e.getBody()).removeAttr("data-table-resizing")}e.on("Change",(function(){var n=e.selection.getNode(),r=c()(n).parent().closest("table.confluenceTable").not("table.confluenceTable table.confluenceTable");r.is(".confluenceTable")&&r.removeTableResizable({$doc:t}).tableResizable({$doc:t,editor:e,force:!0})})),s("confluence.editor.on.save",o),e.on("Remove",(function(){l("confluence.editor.on.save",o)})),t.on("mousemove","table.confluenceTable",(function(){var n=c()(this);n.parents("table.confluenceTable").length||n.data("initialized")||n.tableResizable({$doc:t,editor:e})})),r.tinymce.isWebKit&&c()(r.document).bind("prePaste",St),r.tinymce.Env.ie&&c()('<style type="text/css"></style>').html(".confluenceTable td, .confluenceTable th {overflow: hidden !important;}.confluenceTable .content-wrapper {overflow-x : visible !important}").appendTo(t.find("head"))}(e)}))},At=function(e){function t(t){var r,o,i=function(t){return e.getLang(t)},a={red:i("table.cell_color_red"),grey:i("table.cell_color_grey"),green:i("table.cell_color_green"),blue:i("table.cell_color_blue"),yellow:i("table.cell_color_yellow")};n(t),st.getSelectedHighlightColour()&&(r=st.getSelectedHighlightColour(),o=i("table.cell_background_color").replace("{0}",a[r]),t.attr("data-highlight-colour",r),t.attr("title",o),t.children().attr("title",""),t.addClass("highlight-".concat(r)))}function n(e){var t,n,r;for(t=0,n=e.length;t<n;t++)(r=e.eq(t)).attr("data-highlight-colour")&&r.removeAttr("data-highlight-colour"),r.attr("title")&&r.removeAttr("title"),r[0].className=r[0].className.replace(/( |^)highlight(-\w+)+/g,"")}e.on("init",(function(){var o=function(e){return c()(e.selection.getNode()).closest("th.confluenceTh,td.confluenceTd")},i=function(e){var t=c()(e.getBody()).find("th.confluenceTh[data-mce-selected],td.confluenceTd[data-mce-selected]");return t.length?t:o(e)},a=function(e){return 0===e.find("tbody > tr > td").length};function s(e){return c()(e).parents("table").is(".confluenceTable")}function l(t){if(9===t.keyCode){var n=e.selection.getNode();if(s(n)&&!function(t){var n=e.dom.getParent(t,"UL,OL,TR").tagName;return"UL"===n||"OL"===n}(n)){var r=t.shiftKey?"mceTableMoveCaretToPrevCell":"mceTableMoveCaretToNextCell";return e.execCommand(r),t.preventDefault(),!1}}}e.addCommand("confTableRowToggleHeading",(function(){var t=function(e){var t=c()(e.getBody()).find("td[data-mce-selected],th[data-mce-selected]");t.length||(t=c()(e.selection.getNode()));for(var n=t.closest("tr"),r=n.parent(),o=r.is("tbody")?n.parent().parent():r;0!==n.length&&!o.is(".confluenceTable");)n=o.closest("tr"),o=(r=n.parent()).is("tbody")?n.parent().parent():r;return n}(this),n=t.children("td,th"),r=0;st.areCellsHeadings(n)?(a(t.closest("table"))||(n=n.filter((function(){var e=c()(this),t=e.closest("table");return r+=e.attr("colspan")||1,!st.isColumnHeading(t,r)}))),st.convertToNormalCells(e,n)):st.convertToHeadingCells(e,n)})),e.addCommand("confTableColumnToggleHeading",(function(){var t=function(e){var t=c()([]);return e.each((function(){var e=c()(this),n=e.index()+1,r=e.closest("table.confluenceTable").children("tbody").children("tr");t=t.add(r.children().nthCol(n))})),t}(i(this));st.areCellsHeadings(t)?(a(t.closest("table"))||(t=t.filter((function(){var e=c()(this).parent("tr").children(),t=e.filter("th");return e.length!==t.length}))),st.convertToNormalCells(e,t)):st.convertToHeadingCells(e,t)})),e.addCommand("confTableSelectionToggleHighlight",(function(e,r){var o=r&&r.alwaysHighlight,a=i(this);st.areCellsHighlighted(a)&&!o||c()("#table-highlight-group").attr("data-remove-highlight")?n(a):t(a)})),(r.tinymce.isIE8||w("confluence-table-enhancements.auto-row"))&&e.on("KeyDown",(function(t){function n(t,n){var r=e.selection.getRng(!0),o=r.startContainer;if(r.collapsed){var i=function(e,t,n){for(;e!=t;){if(e[n])return!1;e=e.parentNode}return!0}(o,t,n);return 3===o.nodeType?i&&r.startOffset==("nextSibling"==n?o.length:0):o==t?r.startOffset==("nextSibling"==n?o.childNodes.length-1:0):i}return!1}if((37===t.keyCode||39===t.keyCode)&&!t.shiftKey){var i=o(this);if(i.length){var a=i[0];if(37===t.keyCode&&n(a,"previousSibling")&&(s=e.selection.getNode(),c()(s).parents("table").first().find("tr:first-child").children().first()[0]!=s))return e.execCommand("mceTableMoveCaretToPrevCell"),r.tinymce.dom.Event.cancel(t);if(39===t.keyCode&&n(a,"nextSibling")&&!function(){var t=e.selection.getNode();return c()(t).parents("table").first().find("tr:last-child").children().last()[0]==t}())return e.execCommand("mceTableMoveCaretToNextCell"),r.tinymce.dom.Event.cancel(t)}}var s})),e.on("KeyDown",(function(t){l(t),function(t){if(t.altKey&&(38===t.keyCode||40===t.keyCode)){var n=e.selection.getRng(!0),r=c()(n.startContainer).closest("td.confluenceTd, th.confluenceTh",".mceContent");if(0!==r.length){e.execCommand(38===t.keyCode?"mceTableInsertRowBefore":"mceTableInsertRowAfter");var o=r.parent()[38===t.keyCode?"prev":"next"]().find("td:first-child")[0],i=c()(o);i.hasClass("numberingColumn")&&(o=i.next()[0]),n.setStart(o,0),n.setEnd(o,0),e.selection.setRng(n),t.preventDefault()}}}(t)})),w("confluence-table-enhancements.auto-row")&&(e.on("Click",(function(){var t=o(this);t.hasClass("numberingColumn")&&!t.hasClass("confluenceTh")&&e.execCommand("mceTableMoveCaretToNextCell")})),e.on("KeyDown",(function(t){if((38===t.keyCode||40===t.keyCode)&&s()&&o(this).hasClass("numberingColumn"))return e.execCommand("mceTableMoveCaretToNextCell"),t.preventDefault(),!1}),!0))})),w("confluence-table-enhancements.auto-row")&&e.on("init",(function(){c()(e.getBody()).find(".confluenceTd.numberingColumn").attr("contenteditable","false")}))},Rt=function(e){var t,n,r=/([\+\-]?\d*)[nN]([\+\-]?\d*)/;e.fn.nthCol=function(o){var i,a,c,s,l,u,d,f,m;return c={multiplier:0,offset:0},"even"===(i=o)?i="2n":"odd"===i?i="2n+1":/^\d*$/.test(i)&&(i="0n+".concat(i)),null!==(a=r.exec(i))&&(c.multiplier=a[1]-0,c.offset=a[2]-0),n=c,s=this,d=[],f=0,m=[],e.each(s,(function(e,t){var n=0,r=0,o=t.rowSpan||1,i=t.colSpan||1;for(t.parentNode!==l&&((l=t.parentNode).parentNode!==u&&(u=l.parentNode,d=[]),f=0,void 0===d[l.rowIndex]&&(d[l.rowIndex]=[])),n=0;n<d[l.rowIndex].length+1;n+=1)if(void 0===d[l.rowIndex][n]){f=n;break}for(m[e]=f,n=l.rowIndex;n<l.rowIndex+o;n+=1)for(void 0===d[n]&&(d[n]=[]),r=f;r<f+i;r+=1)d[n][r]=!0})),t=m,e(this).filter((function(e){return r=t[e]-(n.offset-1),0===n.multiplier?0===r:r%n.multiplier==0&&r/n.multiplier>=0;var r}))}},_t=n("./src/editor-plugins/aeTable/css/editor-content.scss"),It=n.n(_t),Bt=function(){var e=r.tinymce.each,t=r.AJS.storageManager;Rt(c.a);var n,o=t("atlassian.editor","tables"),i=1,a=10,s=8;function l(e,t){return parseInt(e.getAttribute(t)||1)}function u(t,o,u){var d,f,m,p,g,h=o.dom;C();var v,b;function y(e,t){return(e=e.cloneNode(t)).removeAttribute("id"),t&&D()&&e.removeChild(e.children[0]),e}function C(){var n=0;d=[],e(["thead","tbody","tfoot"],(function(r){var o=h.select("> ".concat(r," > tr"),t);e(o,(function(t,o){o+=n,e(h.select("> td, > th",t),(function(e,t){var n,i;if(d[o])for(;d[o][t];)t++;var a=l(e,"rowspan"),c=l(e,"colspan");for(i=o;i<o+a;i++)for(d[i]||(d[i]=[]),n=t;n<t+c;n++)d[i][n]={part:r,real:i==o&&n==t,elm:e,rowspan:a,colspan:c}}))})),n+=o.length}))}function w(e,t){var n=d[t];if(n)return n[e]}function x(e,t,n){e&&(1===(n=parseInt(n))?e.removeAttribute(t,1):e.setAttribute(t,n,1))}function k(e){return e&&e.elm&&(e.elm.hasAttribute("data-mce-selected")||e==p)}function T(){var n=[];return e(t.rows,(function(t){e(t.cells,(function(e){if(e&&e.hasAttribute("data-mce-selected")||e==p.elm)return n.push(t),!1}))})),n}function E(t){var n;return r.tinymce.walk(t,(function(o){var i;if(3===o.nodeType)return e(h.getParents(o.parentNode,null,t).reverse(),(function(e){e=y(e,!1),n?i&&i.appendChild(e):n=i=e,i=e})),i&&(i.innerHTML=r.tinymce.isIE?"&nbsp;":'<br data-mce-bogus="1" />'),!1}),"childNodes"),x(t=y(t,!1),"rowSpan",1),x(t,"colSpan",1),n?t.appendChild(n):r.tinymce.isIE||(t.innerHTML='<br data-mce-bogus="1" />'),c()(t).attr("contenteditable","true").removeClass("numberingColumn"),t}function S(){var n=h.createRng();if(e(h.select("tr",t),(function(e){0===e.cells.length&&h.remove(e)})),0===h.select("tr",t).length)return n.setStartAfter(t),n.setEndAfter(t),u.setRng(n),void h.remove(t);e(h.select("thead,tbody,tfoot",t),(function(e){0===e.rows.length&&h.remove(e)})),function(){var e;C();var t=d[Math.min(d.length-1,f.y)];t&&(e=t[Math.min(t.length-1,f.x)].elm)&&(n=e,r.tinymce.isIE9||r.tinymce.isIE10up?(u.setCursorLocation(n,0),u.collapse(!0)):(u.select(n,!0),u.collapse(!0)));var n}()}function N(e,t,n,r){var o,i,a,c,s;for(o=d[t][e].elm.parentNode,a=1;a<=n;a++)if(o=h.getNext(o,"tr")){for(i=e;i>=0;i--)if((s=d[t+a][i].elm).parentNode==o){for(c=1;c<=r;c++)h.insertAfter(E(s),s);break}if(-1==i)for(c=1;c<=r;c++)o.insertBefore(E(o.cells[0]),o.cells[0])}}function A(){e(d,(function(t,n){e(t,(function(e,t){var r,o,i;if(k(e)&&(r=l(e=e.elm,"colspan"),o=l(e,"rowspan"),r>1||o>1)){for(x(e,"rowSpan",1),x(e,"colSpan",1),i=0;i<r-1;i++)h.insertAfter(E(e),e);N(t,n,o-1,r)}}))}))}function R(t){var n,o,i,a,c,s,u,f,m,p,g;for(e(d,(function(r,o){if(e(r,(function(e){if(k(e)&&(e=e.elm,c=e.parentNode,s=y(c,!1),n=o,t))return!1})),t)return!n})),a=0;a<d[0].length;a++)if(d[n][a]&&(o=d[n][a].elm)!=i){if(t){if(n>0&&d[n-1][a]&&(m=l(f=d[n-1][a].elm,"rowSpan"))>1){x(f,"rowSpan",m+1);continue}}else if((m=l(o,"rowspan"))>1){x(o,"rowSpan",m+1);continue}(u=(g=_(a))?h.create("th"):h.create("td")).colSpan=o.colSpan,u.width=o.width,u.innerHTML=r.tinymce.isIE9?"":r.tinymce.isIE?"&nbsp;":'<br data-mce-bogus="1" />',u.className=o.className,g||(h.removeClass(u,r.tinymce.settings.confluence_table_heading_style),h.addClass(u,r.tinymce.settings.confluence_table_cell_style)),p=h.getAttrib(o,"data-highlight-colour"),I(a)?h.setAttrib(u,"data-highlight-colour",p):h.removeClass(u,"highlight-".concat(p)),s.appendChild(u),i=o}s.hasChildNodes()&&(t?c.parentNode.insertBefore(s,c):h.insertAfter(s,c)),P()}function _(e){if(1===d.length)return!1;for(var t=0;t<d.length;t++)if(d[t]&&d[t][e]&&"TH"!==d[t][e].elm.tagName.toUpperCase())return!1;return!0}function I(e){var t=d[0][e].elm.getAttribute("data-highlight-colour");if(null===t)return!1;for(var n=0;n<d.length;n++)if(d[n][e].elm.getAttribute("data-highlight-colour")!==t)return!1;return!0}function B(t){var o,u,f=[];return e(d,(function(n){if(e(n,(function(e,n){if(k(e)&&(o=n,t))return!1})),t)return!o})),(0!=o||!t||!D())&&(e(d,(function(e,d){var m,p;if(e[o]){var g=e[o].elm;if(0===d){var v=c()(g).closest("table"),b=v.find(">colgroup>col").eq(o),y=c()("<col>");t?y.insertBefore(b):y.insertAfter(b),v.hasClass("fixed-table")&&(n&&0!==parseFloat(n)?y.css({width:n}):y.css({width:s+2*a+i}))}if(g!=u){if(p=l(g,"colspan"),m=l(g,"rowspan"),1==p){var C=function(e){var t=h.create(e.tagName);t.colSpan=e.colSpan,t.width=e.width,t.className=e.className,t.innerHTML=r.tinymce.isIE?"&nbsp;":'<br data-mce-bogus="1"/>';var n=h.getAttrib(e,"data-highlight-colour");return n&&h.setAttrib(t,"data-highlight-colour",n),c()(t).attr("contenteditable","true").removeClass("numberingColumn"),t}(g);t?(g.parentNode.insertBefore(C,g),N(o,d,m-1,p)):(h.insertAfter(C,g),N(o,d,m-1,p)),f.push(C)}else x(g,"colSpan",g.colSpan+1);u=g}}})),f)}function P(){if(D()){g=1;var n=0,r=0;e(t.rows,(function(e){e=c()(e),st.areCellsHeadings(e.children())?e.children(":first").addClass("numberingColumn").attr("contenteditable","true"):r>0?r--:(e.children(":first").html(g).attr("contenteditable","false").addClass("numberingColumn"),(n=e.children(":first").attr("rowspan"))>1&&(r=n-1),g++)}))}}function D(){return c()(t.rows[0]).children(":first").hasClass("numberingColumn")}function O(e){if(e){c()(t.rows[0]).children(":first").addClass("numberingColumn");var n=c()(t),r=n.find(">colgroup>col").eq(0),o=c()("<col>");o.insertBefore(r),n.hasClass("fixed-table")&&o.css({width:s+2*a+i})}else c()(t.rows[0]).children(":first").removeClass("numberingColumn"),c()(t).find(">colgroup>col").eq(0).remove()}function M(){var t=[];e(d,(function(n){e(n,(function(n,o){k(n)&&-1===r.tinymce.inArray(t,o)&&(c()(n.elm).closest("table").find(">colgroup>col").eq(o).remove(),e(d,(function(e){if(e[o]){var t=e[o].elm,n=l(t,"colSpan");n>1?x(t,"colSpan",n-1):h.remove(t)}})),t.push(o))}))})),S()}function L(){var t={};return e(d,(function(r){e(r,(function(e,r){k(e)&&(n=c()(e.elm).closest("table").find(">colgroup>col").eq(r).css("width"),0===parseFloat(n)&&(n=e.elm.getBoundingClientRect().width),t[r]||(t[r]=[]))}))})),e(d,(function(n){e(n,(function(e,n){t[n]&&t[n].push(e.elm.innerHTML)}))})),t}function F(e){e&&e.parentNode&&(u.select(e.parentNode),u.collapse(!0))}function j(e,t){var n=w(e.x,e.y).elm,o=void 0===t||t;if((r.tinymce.isGecko||r.tinymce.isIE)&&n.firstChild&&(n=n.firstChild),r.tinymce.isIE9||r.tinymce.isIE10up){var i=u.getRng(1);o?(i.setStart(n,0),i.setEnd(n,0)):(i.setStartAfter(n,0),i.setEndAfter(n,0)),u.setRng(i)}else u.select(n,!0),u.collapse(o)}function H(){var e,t=d[0].length;return f.x==t-1&&f.y==d.length-1||(f.x==t-1&&D()?(e={x:1,y:f.y+1},st.areCellsHeadings(c()(d[e.y][0].elm).parent().children())&&(e.x=0)):e=f.x==t-1?{x:0,y:f.y+1}:{x:f.x+1,y:f.y}),e}function U(){var e,t;return 0==f.x&&0==f.y||(1==f.x&&D()&&f.y>0?(t=f.y-1,e={x:d[t].length-1,y:t}):f.x>0?e={x:f.x-1,y:f.y}:(t=f.y-1,e={x:d[t].length-1,y:t})),e}function W(t){var n;return e(d,(function(r,o){return e(r,(function(e,r){if(e.elm==t)return n={x:r,y:o},!1})),!n})),n}(p=h.select("td[data-mce-selected],th[data-mce-selected]")[0]||c()(u.getStart()).closest(["table.confluenceTable > tbody > tr > th","table.confluenceTable > tbody > tr > td","table.confluenceTable > thead > tr > th","table.confluenceTable > thead > tr > td"].join(","))[0])&&(f=W(p),v=b=0,e(d,(function(t,n){e(t,(function(e,t){var r,o;k(e)&&(e=d[n][t],t>v&&(v=t),n>b&&(b=n),e.real&&(r=e.colspan-1,o=e.rowspan-1,r&&t+r>v&&(v=t+r),o&&n+o>b&&(b=n+o)))}))})),m={x:v,y:b},p=w(f.x,f.y)),r.tinymce.extend(this,{deleteTable:function(){var e=h.createRng();e.setStartAfter(t),e.setEndAfter(t),u.setRng(e),h.remove(t)},split:A,merge:function(t,n,o){var i,a,c,s,l,u,p,g,v;if(t){var b=W(t);c=(i=b.x)+(n-1),s=(a=b.y)+(o-1)}else i=f.x,a=f.y,c=m.x,s=m.y;if(0!=i||!D()){p=w(i,a);var y=w(c,s);if(p&&y&&p.part==y.part){for(A(),C(),x(p=w(i,a).elm,"colSpan",c-i+1),x(p,"rowSpan",s-a+1),u=a;u<=s;u++)for(l=i;l<=c;l++)d[u]&&d[u][l]&&(t=d[u][l].elm)!=p&&(g=r.tinymce.grep(t.childNodes),e(g,(function(e){p.appendChild(e)})),g.length&&(g=r.tinymce.grep(p.childNodes),v=0,e(g,(function(e){"BR"===e.nodeName&&h.getAttrib(e,"data-mce-bogus")&&v++<g.length-1&&p.removeChild(e)}))),h.remove(t));S()}}},insertRow:R,insertCol:B,insertNumCol:function(){var t;D()?(e(d,(function(e){var t=e[0].elm;c()(t).hasClass("numberingColumn")&&null!==t.parentNode&&t.parentNode.removeChild(t)})),O(!1)):(e(d,(function(e){var n=e[0].elm;if(t!=n){var r=E(n);n.parentNode.insertBefore(r,n),n.rowSpan>1&&(r.rowSpan=n.rowSpan),t=n}})),O(!0)),P()},updateNumCol:P,deleteCols:M,deleteRows:function(){var t=T();(r.tinymce.isIE9||r.tinymce.isIE10)&&F(t[0]),e(t.reverse(),(function(t){!function(t){var n,r;e(t.cells,(function(e){var t=l(e,"rowSpan");t>1&&(x(e,"rowSpan",t-1),N((n=W(e)).x,n.y,1,1))})),n=W(t.cells[0]),e(d[n.y],(function(e){var t;(e=e.elm)!=r&&((t=l(e,"rowSpan"))<=1?h.remove(e):x(e,"rowSpan",t-1),r=e)}))}(t)})),S(),P()},cutRows:function(){var e=T();return(r.tinymce.isIE9||r.tinymce.isIE10)&&F(e[0]),h.remove(e),S(),P(),e},copyRows:function(){var t=T();return e(t,(function(e,n){t[n]=y(e,!0)})),t},pasteRows:function(t,n){var r=T(),o=r[n?0:r.length-1],i=o.cells.length;e(d,(function(t){var n;if(i=0,e(t,(function(e){e.real&&(i+=e.colspan),e.elm.parentNode==o&&(n=1)})),n)return!1})),n||t.reverse(),e(t,(function(e){var t,r=e.cells.length;for(c()(e.cells[0]).hasClass("numberingColumn")&&(e.removeChild(e.cells[0]),r--),g=0;g<r;g++)x(t=e.cells[g],"colSpan",1),x(t,"rowSpan",1);for(D()&&(e.insertBefore(e.firstChild.cloneNode(!1),e.firstChild),c()(e.firstChild).addClass("numberingColumn"),r++);i<r;)B(!1),i++;for(g=r;g<i;g++)e.appendChild(E(e.cells[r-1]));n?o.parentNode.insertBefore(e,o):h.insertAfter(e,o)})),P()},getPos:W,setStartCell:function(e){f=W(e)},setEndCell:function(e){var t,n,r,i,a,s,l,u;if(m=W(e),f&&m){t=Math.min(f.x,m.x),n=Math.min(f.y,m.y),a=r=Math.max(f.x,m.x),s=i=Math.max(f.y,m.y);for(var p=n;p<=s;p++)(e=d[p][t]).real||t-(e.colspan-1)<t&&(t-=e.colspan-1);for(var g=t;g<=a;g++)(e=d[n][g]).real||n-(e.rowspan-1)<n&&(n-=e.rowspan-1);for(var h=n;h<=i;h++)for(var v=t;v<=r;v++)(e=d[h][v]).real&&((l=e.colspan-1)&&v+l>a&&(a=v+l),(u=e.rowspan-1)&&h+u>s&&(s=h+u));c()("td[data-mce-selected],th[data-mce-selected]",o.getBody()).removeAttr("data-mce-selected");for(var b=n;b<=s;b++)for(var y=t;y<=a;y++)d[b][y]&&d[b][y].elm.setAttribute("data-mce-selected",1)}},moveCaretToNextCell:function(){var e=H();e||(R(!1),C(),e=H()),j(e)},moveCaretToPrevCell:function(){var e=U();e||(R(!0),C(),f=W(h.getParent(u.getStart(),"th,td")),e=U()),j(e,!1)},cutColumns:function(){var e=L();return M(),e},copyColumns:L,pasteColumns:function(e,t){var n=Object.keys(e);t||n.reverse(),c.a.each(n,(function(n,r){var o=B(t);for(n=0;n<o.length;n++)o[n].innerHTML=e[r][n]||""}))},prepareTableForColPasteAndCheckIfNeedToRepaint:function(t){var n,r,o=t[Object.keys(t)[0]].length,i=!1;if(e(d,(function(t,i){o--,n=i,e(t,(function(e,t){r=t}))})),o>0)for(i=!0,p=w(r,n),g=0;g<o;g++)R(!1);return i},toggleFluidColumnWidth:function(){t&&t.rows&&(c()(t).toggleFluidColumnWidth(),c()("#table-mode-picker .dropdown-text").text(o.translate("table.responsive")))},toggleFixedColumnWidth:function(){t&&t.rows&&(c()(t).toggleFixedColumnWidth(),c()("#table-mode-picker .dropdown-text").text(o.translate("table.fixed_width")))}})}return{init:function(t){var i=!0;function a(e){var n=t.selection;e=e||n.getNode().parentNode;var r=t.dom.getParent(e,"table.confluenceTable");if(r)return new u(r,t,n)}function s(){t.getBody().style.webkitUserSelect="",i&&(c()("td[data-mce-selected],th[data-mce-selected]",t.getBody()).removeAttr("data-mce-selected"),i=!1)}function d(e){for(var n,r=[],i=0;i<e.length;i++)r.push(t.serializer.serialize(e[i]));n="<tr>".concat(r.join("</tr><tr>"),"</tr>"),o.setItem("copied",n,7200)}function f(){var e,n=[],r=o.getItem("copied")||"";return r&&((e=t.getDoc().createElement("div")).innerHTML="<table>".concat(r,"</table>"),n=c()(e).find("tr")),n}function m(e){o.setItem("copiedCols",JSON.stringify(e))}function p(){return JSON.parse(o.getItem("copiedCols"))||{}}t.on("PreProcess",(function(e){var n,r,o,i=t.dom,a=i.select("table",e.node);for(n=a.length;n--;)r=a[n],i.setAttrib(r,"data-mce-style",""),(o=i.getAttrib(r,"width"))&&(i.setStyle(r,"width",o),i.setAttrib(r,"width","")),(o=i.getAttrib(r,"height"))&&(i.setStyle(r,"height",o),i.setAttrib(r,"height",""))})),t.on("init",(function(){if(It.a.use(),t.on("Undo",(function(){i=t.dom.select("td[data-mce-selected], th[data-mce-selected]").length>0})),t.on("KeyUp",(function(){s()})),r.tinymce.isWebKit){t.on("KeyDown",(function(n){var o=r.tinymce.util.VK,i=n.keyCode;function a(e,n,o){var i=e?"previousSibling":"nextSibling",l=t.dom.getParent(n,"tr"),d=l[i];if(d)return u(t,n,d,e),r.tinymce.dom.Event.cancel(o),!0;var f=t.dom.getParent(l,"table"),m=l.parentNode,p=m.nodeName.toLowerCase();if("tbody"===p||p===(e?"tfoot":"thead")){var g=function(e,n,r,o){var i=t.dom.select(">".concat(o),n),a=i.indexOf(r);if(e&&0===a||!e&&a===i.length-1)return function(e,n){var r=e?"thead":"tfoot",o=t.dom.select(">".concat(r),n);return 0!==o.length?o[0]:null}(e,n);if(-1===a){var c="thead"===r.tagName.toLowerCase()?0:i.length-1;return i[c]}return i[a+(e?-1:1)]}(e,f,m,"tbody");if(null!==g)return function(e,n,o,i){var a=c(n,e);return a&&u(t,o,a,e),r.tinymce.dom.Event.cancel(i),!0}(e,g,n,o)}return function(e,n,o,i,l){var u=i[o];if(u)return s(u),!0;var d=t.dom.getParent(i,"td,th");return d?a(e,d,l):(s(c(n,!e)),r.tinymce.dom.Event.cancel(l))}(e,l,i,f,o)}function c(e,n){var r=e&&e[n?"lastChild":"firstChild"];return r&&"BR"===r.nodeName?t.dom.getParent(r,"td,th"):r}function s(e){t.selection.setCursorLocation(e,0)}function u(t,n,r,o){var i=function(t,n){var r=0,o=0;return e(t.children,(function(e,t){if(r+=l(e,"colspan"),o=t,r>n)return!1})),o}(r,function(e){for(var t=0,n=e;n.previousSibling;)t+=l(n=n.previousSibling,"colspan");return t}(t.dom.getParent(n,"td,th"))),a=r.childNodes[i];s(c(a,o)||a)}function d(e){var n,r,o=t.selection.getNode(),i=t.dom.getParent(o,"td,th"),a=t.dom.getParent(e,"td,th");return i&&i!==a&&(n=i,r=a,t.dom.getParent(n,"TABLE")===t.dom.getParent(r,"TABLE"))}if((i==o.UP||i==o.DOWN)&&function(e){var t=e.selection.getNode();return null!==e.dom.getParent(t,"tr")}(t)){var f=t.selection.getNode();setTimeout((function(){d(f)&&a(!n.shiftKey&&i===o.UP,f,n)}),0)}}))}})),t.on("copy",(function(){!0===t.selection.isCollapsed()&&t.getBody().querySelectorAll("th[data-mce-selected],td[data-mce-selected]").length>1&&t.selection.select(t.selection.getNode())}),!0),e({mceTableSplitCells:function(e){e.split()},mceTableMergeCells:function(e){t.dom.select("td[data-mce-selected],th[data-mce-selected]").length&&e.merge()},mceTableInsertRowBefore:function(e){e.insertRow(!0)},mceTableInsertRowAfter:function(e){e.insertRow()},mceTableInsertNumberingCol:function(e){e.insertNumCol()},mceTableUpdateNumberingCol:function(e){e.updateNumCol()},mceAutoWidth:function(e){e.toggleFluidColumnWidth()},mceFixedWidth:function(e){e.toggleFixedColumnWidth()},mceTableInsertColBefore:function(e){n=null,e.insertCol(!0)},mceTableInsertColAfter:function(e){n=null,e.insertCol()},mceTableDeleteCol:function(e){e.deleteCols()},mceTableDeleteRow:function(e){e.deleteRows()},mceTableCutRow:function(e){d(e.cutRows())},mceTableCopyRow:function(e){d(e.copyRows())},mceTablePasteRowBefore:function(e){e.pasteRows(f(),!0)},mceTablePasteRowAfter:function(e){e.pasteRows(f())},mceTableDelete:function(e){e.deleteTable()},mceTableMoveCaretToNextCell:function(e){e.moveCaretToNextCell()},mceTableMoveCaretToPrevCell:function(e){e.moveCaretToPrevCell()},mceTableCopyCol:function(e){m(e.copyColumns())},mceTableCutCol:function(e){m(e.cutColumns())},mceTablePasteColBefore:function(e){var n=p();e.prepareTableForColPasteAndCheckIfNeedToRepaint(n)&&(t.execCommand("mceRepaint"),e=a()),e.pasteColumns(n,!0)},mceTablePasteColAfter:function(e){e.pasteColumns(p(),!1)}},(function(e,n){t.addCommand(n,(function(){var n=a();n&&(e(n),t.execCommand("mceRepaint"),s())}))})),it(t),Nt(t),At(t)}}};n("./src/editor-plugins/iosediting/iosediting.css");var Pt=function(e){return e.replace(/[&"'<>`]/g,(function(e){var t={"<":"&lt;",">":"&gt;","&":"&amp;","'":"&#39;","`":"&#96;"};return"string"==typeof t[e]?t[e]:"&quot;"}))};function Dt(e,t,n){"cl.ly"==e.host?c.a.get("".concat(Ce,"/rest/autoconvert/1.0/cloudappembed?resource=").concat(e.path.substr(1)),(function(e){if(e)switch(e.item_type){case"image":var r=Pt(e.content_url);n(c()('<img class="confluence-embedded-image confluence-external-resource" src="'.concat(r,'" data-image-src="').concat(r,'"/>'))[0]);break;case"bookmark":t.text(e.name),t.attr("href",Pt(e.redirect_url)),n(t)}else n()})):n()}var Ot=function(){s("init.rte",(function(){r.tinymce.plugins.Autoconvert.autoConvert.addHandler(Dt)}))};function Mt(){var e=this,t=function(e,t){return t.anchor&&0!==t.anchor.indexOf("comment-")?"".concat(e,"#").concat(t.anchor.substring(t.anchor.indexOf("-")+1)):e},n=function(n,i,a){if(o(n)){var s,l=function(e){return Ce?e.path.substring(Ce.length+1):e.path.substring(1)}(n),u=decodeURIComponent(l).split("/");n.queryKey=n.queryKey||{},n.queryKey.focusedCommentId?(s="$".concat(n.queryKey.focusedCommentId),s=t(s,n)):n.queryKey.pageId?(s="$".concat(n.queryKey.pageId),s=t(s,n)):"display"===u[0]?s=function(e,n,r){return 2===r.length&&0===r[1].indexOf("~")?n=r[1]:3===r.length?(n="".concat(r[1],":").concat(r[2].replace(/\+/g," ")),n=t(n,e)):4===r.length&&"status"===r[1]?n="$".concat(r[3]):6===r.length&&(n="".concat(r[1],":")+"/".concat(r[2],"/").concat(r[3],"/").concat(r[4],"/").concat(r[5].replace(/\+/g," ")),n=t(n,e)),n}(n,s,u):"spaces"===u[0]?s=(s=(s=e.spaViewPageLinkHandler(u))||e.spaBlogPostLinkHandler(u))?t(s,n):function(e,n,r){return 2!==r.length&&3!==r.length||-1!==r[1].indexOf(".action")||(n="".concat(r[1],":")+"",n=t(n,e)),n}(n,s,u):"users"===u[0]?s=function(e,t,n){return 2===n.length&&"viewuserprofile.action"==n[1]?t="~".concat(e.queryKey.username):2===n.length&&"viewmyprofile.action"==n[1]&&(t="~".concat(M.get("remote-user"))),t}(n,s,u):"pages"===u[0]&&"viewpage.action"===u[1]&&n.queryKey&&n.queryKey.spaceKey&&n.queryKey.title&&(s="".concat(n.queryKey.spaceKey,":").concat(n.queryKey.title.replace(/\+/g," "))),s?(s="[".concat(s,"]"),r.tinymce.plugins.Autoconvert.getHtmlFromWikiMarkup(s,(function(e){a(c()(e).children()[0])}),(function(){a()}))):a()}else a()},o=function(e){var t=!0;return t=t&&e.authority===r.document.location.host,t=t&&(!Ce||0===e.path.indexOf(Ce)),t};this.init=function(){r.tinymce.plugins.Autoconvert.autoConvert.addHandler(n)}}Mt.prototype.spaViewPageLinkHandler=function(e){var t="spaces"===e[0]&&"pages"===e[2],n="edit"===e[3]?e[4]:e[3];if(t&&n)return"$".concat(n)},Mt.prototype.spaBlogPostLinkHandler=function(e){var t="spaces"===e[0]&&"blog"===e[2],n=e[1],r=e[3],o=e[4],i=e[5],a=e[6],c=e[7];if(t&&n&&r&&o&&i&&a&&c)return"".concat(n,":/").concat(r,"/").concat(o,"/").concat(i,"/").concat(c.replace(/\+/g," "))};var Lt=function(){s("init.rte",(new Mt).init)};function Ft(){r.tinymce.plugins.Autoconvert.autoConvert.addHandler((function(e,t,n){if(e.host.match(/google.*/)&&"/url"===e.path&&e.queryKey&&e.queryKey.url){var r=decodeURIComponent(e.queryKey.url);(t=c()(t)).attr("href",r),t.attr("data-mce-href",r),t.text(r),n(t)}else n()}))}var jt=function(){s("init.rte",Ft)},Ht=function(){var e=[],t=function(e){return e.indexOf("%s")>=0?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&").replace("%s","(.*)"):"".concat(e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"(.*)")};r.tinymce.plugins.Autoconvert.autoConvert.addHandler((function(t,n,r){if(t.source===n.text()){for(var o=0;o<e.length;o++){var i=e[o],a=t.source.match(i.regex);if(a){var s=a[1];if(i.defaultAlias){var l=i.defaultAlias.replace(/%s/,s);return void r(c()(n).text(l))}return void r(c()(n).text(s))}}r()}else r()})),setTimeout((function(){c.a.ajax({url:"".concat(Ce,"/rest/autoconvert/latest/shortcutlinkconfigurations"),type:"GET",dataType:"json",success:function(n){e=n.configurations;for(var r=0;r<e.length;r++){var o=e[r];try{o.regex=new RegExp(t(o.expandedValue,o.defaultAlias))}catch(e){console.log("Failed to generated regex for ".concat(o))}}},error:function(e){console.log("Failed to load shortcut link configurations ".concat(e.statusText))}})}),0)},Ut=function(){s("init.rte",Ht)},Wt=function(e,t,n){"www.skitch.com"===e.host||"skitch.com"===e.host?c.a.get("".concat(Ce,"/rest/autoconvert/1.0/skitchembed?url=").concat(e.source),(function(e){e&&e.url?n(c()('<img class="confluence-embedded-image confluence-external-resource" src="'.concat(e.url,'" data-image-src="').concat(e.url,'"/>'))[0]):n()})):n()},zt=function(){s("init.rte",(function(){r.tinymce.plugins.Autoconvert.autoConvert.addHandler(Wt)}))};function qt(){var e=[/youtube-nocookie.com\/embed\/?/,/youtube.com\/watch\?/,/vimeo.com\/[0-9]+/,/maps.google(.[a-z]+)+\/maps/,/[^\.]\.wufoo\.com\/(?:forms|reports)/];r.tinymce.plugins.Autoconvert.autoConvert.addHandler((function(t,n,o){for(var i=decodeURI(t.source),a=0;a<e.length;a++)if(i.match(e[a])){var c={name:"widget",params:{url:i}};return void r.tinymce.plugins.Autoconvert.convertMacroToDom(c,o,o)}o()}))}var Vt=function(){s("init.rte",qt)};function $t(){r.tinymce.plugins.Autoconvert.autoConvert.addHandler((function(e,t,n){if(e.host.match(".*youtu.be.*")){var r=e.path.substr(1),o="http://youtube.com/watch?v=".concat(r);n(c()(t).attr("href",o).html(o))}else n()}))}var Kt=function(){s("init.rte",$t)},Jt={issueKeyOnlyRegEx:/\/(i#)?browse\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+$)/,singleTicketXMLEx:/\/jira\.issueviews:issue-xml\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+)\//,issueKeyWithinRegex:/\/(i#)?browse\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+)(?:\?|#)/,jqlRegEx:/jqlQuery\=([^&]+)/,jqlRegExAlternateFormat:/jql\=([^&]+)/,_getMatchedServerFromLink:function(e,t){var n=null;for(var r in t)if(t.hasOwnProperty(r)){var o=t[r],i=o.url;if("/"!==o.url[o.url.length-1]&&(i+="/"),0===e.indexOf(i)){n=o;break}}return n},pasteHandler:function(e,t,n){var o=g.a.Editor.JiraConnector.servers;if(!o)return n(),null;var i=g.a.Editor.JiraAnalytics,a={},c=Jt._getMatchedServerFromLink(e.source,o),s=null;if(c){var l=Jt.jqlRegEx.exec(e.source)||Jt.jqlRegExAlternateFormat.exec(e.source),u=g.a.JQLHelper.isFilterUrl(e.source),d=Jt.issueKeyOnlyRegEx.exec(e.source)||Jt.issueKeyWithinRegex.exec(e.source);if(d?(d=d[2],i&&(a.type=i.linkTypes.jql)):(d=Jt.singleTicketXMLEx.exec(e.source))&&(d=d[1],i&&(a.type=i.linkTypes.xml)),l)a.is_single_issue=!1,a.type=g.a.JQLHelper.checkQueryType(e.source),s={name:"jira",params:{server:c.name,serverId:c.id,jqlQuery:decodeURIComponent(l[1].replace(/\+/g,"%20"))}};else if(u){var f=e.source;a.is_single_issue=!1,a.type=g.a.JQLHelper.checkQueryType(f),s={name:"jira",params:{server:c.name,serverId:c.id,jqlQuery:g.a.JQLHelper.getFilterFromFilterUrl(f)}}}else d&&(a.is_single_issue=!0,s={name:"jira",params:{server:c.name,serverId:c.id,key:d}})}s?(r.tinymce.plugins.Autoconvert.convertMacroToDom(s,n,n),i&&i.triggerPasteEvent(a)):n()}};var Gt=/^\/(.*?)\/status\/([^\/]+\/?$)/,Xt=/^\/(.*?)\/statuses\/([^\/]+\/?$)/,Yt=function(e,t,n){var o,i,a;e.host.match(/^twitter.com/)?((o=decodeURI(e.path).match(Gt))?i="".concat(e.protocol,"://twitter.com/").concat(o[1],"/status/").concat(o[2]):(o=decodeURI(e.path).match(Xt))&&(i="".concat(e.protocol,"://twitter.com/").concat(o[1],"/statuses/").concat(o[2])),i?(a={name:"widget",params:{url:i}},r.tinymce.plugins.Autoconvert.convertMacroToDom(a,n,n)):n()):n()},Qt=function(){s("init.rte",(function(){return r.tinymce.plugins.Autoconvert.autoConvert.addHandler(Yt)}))};function Zt(){Ot(),Lt(),jt(),Ut(),zt(),Vt(),Kt(),s("init.rte",(function(){r.tinymce.plugins.Autoconvert.autoConvert.addHandler(Jt.pasteHandler)})),Qt()}var en={initializeEditor:function(){r.AJS&&r.AJS.Rte&&r.AJS.Rte.BootstrapManager&&r.AJS.Rte.BootstrapManager.addOnInitCallback((function(){var e=r.tinymce.activeEditor;e&&(window.MutationObserver&&!(r.tinymce.Env.gecko||r.tinymce.Env.webkit||r.tinymce.Env.ie>11)?function(e){new MutationObserver((function(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.addedNodes.length)for(var r=0;r<n.addedNodes.length;r++){if("img"===n.addedNodes[r].localName)return void window.setTimeout(en.pasteFromDataURL,0)}}})).observe(e.getDoc(),{childList:!0,subtree:!0})}(e):function(e){e.on("Paste",(function(e){return!!en.onPaste(e)||(r.tinymce.dom.Event.cancel(e),!1)}))}(e))}))},pasteFromDataURL:function(){var e=c()('img[src^="data:image"]:not(".editor-inline-macro")',r.tinymce.activeEditor.getDoc());c.a.each(e,(function(){var e,t,n,o=this.src;if(w("filestore.direct.upload")&&!w("filestore.direct.upload.force.disable")){var i=o.split(","),a=atob(i[1]),c=a.length;for(t=a.length,e=new Uint8Array(c);c--;)e[c]=a.charCodeAt(c)}else{n="base64",t=3*(e=o.substring(22,o.length)).length/4;for(var s=0,l=e.length-1;"="==e[l];l--)s++;t-=s}r.Confluence.Uploader.upload([en.createUploadFile(e,t,n)])})),e.remove()},onPaste:function(e){return!e||!e.clipboardData||en.pasteFromEvent(e)},showClipboardAccessError:function(){var e=r.tinymce.activeEditor;new r.AJS.Dialog({width:400,closeOnOutsideClick:!0}).addPanel("alert",c()("<div />",{text:e.translate("clipboardaccess.browser.not.supported")})).addButton(e.translate("clipboardaccess.ok"),(function(e){e.remove()})).show().updateHeight()},pasteFromEvent:function(e){if(e&&e.clipboardData){if(e.clipboardData.items){var t=e.clipboardData.items[0];if(!t||"file"!=t.kind)return!0;var n=t.getAsFile(),o=en.createUploadFile(n,n.size);return r.Confluence.Uploader.upload([o]),!1}window.setTimeout((function(e){var t=c()("img[src^='webkit-fake-url://']",r.tinymce.activeEditor.getDoc());t.length&&(t.remove(),e.showClipboardAccessError())}),0,this)}return!0},createUploadFile:function(e,t,n){var r=new Date,o=r.getMonth()+1;return{fileName:"image".concat(r.getFullYear(),"-").concat(o,"-").concat(r.getDate(),"_").concat(r.getHours(),"-").concat(r.getMinutes(),"-").concat(r.getSeconds(),".png"),fileSize:t,slice:function(t,n){return e.slice(t,t+n)},getAsBinary:function(){return e},getData:function(){return e},encoding:n}}};n("./src/editor-plugins/draggable/draggable.css");var tn=function(){var e,t,n,o,i,a,s,l,d,f,m,p,g,h=r.Confluence.PropertyPanel,v="img.confluence-embedded-image,img.editor-inline-macro,table.wysiwyg-macro",b="img",y=10,C=[800,800,400,400,400,300,300,300,300,300,300,300,300,300,300,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100],w="confluence.draggable-plugin";var x="div.innerCell,div.cell",k="body",T="p,h1,h2,h3,h4,h5,h6,blockquote,li,td,th,img",E="li,td,th",S="p,h1,h2,h3,h4,h5,h6,blockquote",N="li,td,th";function A(t){var r=!!o.children(".contentLayout,.contentLayout2").length;function i(){return n.find("#move-indicator")}function a(e){return"move-indicator"===e.attr("id")}function s(e){return r?e.is(x):e.is(k)}function l(e,t,r){return e.is("img")?function(e,t){var r=e.offset();return t+n.scrollLeft()-r.left}(e,t)<e.width()/2:u(e,r)<e.height()/2}function u(e,t){var r=e.offset();return t+n.scrollTop()-r.top}return{positionNear:function(e,r){var d=function(e,r){var d=c()(n[0].elementFromPoint(e,r)),f=!0;if(function(e){if(e.is(T)&&!a(e))return(!e.is("td.wysiwyg-macro-body")||"PLAIN_TEXT"!==e.closest("table").attr("data-macro-body-type"))&&!(e.is("img")&&!t.is("img"));return!1}(d))return{target:d,before:l(d,e,r)};if(s(d)){if(function(e,t){return u(e.children().first(),t)<0}(d=function(e){if(e.is("div.cell"))return e.children("div.innerCell").first();return e}(d),r))d=d.children().first();else if(function(e,t){return function(e,t){var n=u(e,t),r=e.height();return n-r}(e.children().last(),t)>0}(d,r))d=d.children().last(),f=!1;else{if(m=d,i().length>0&&i().parent(m).length>0)return null;d=function(e){var n=t.parent(T);n.length||(n=e.find(T).last());n.length||(n=o.find(T).last());return n}(d),f=!1}return{target:d,before:f}}var m;return null}(e,r);d&&function(e,t){if(a(e))return;var n=i();if(e.is(E)&&e.find(n).length)return;n.length?n.detach():n=c()('<span id="move-indicator">|</span>');!(e=function(e){if(e.is(E)){var t=e.children().first();t.is(S)&&(e=t)}return e}(e)).is("img")&&ge().Cursor.isTextContainerEmpty(e[0])?e.prepend(n):e.is(N)?t?e.prepend(n):e.append(n):t?e.before(n):e.after(n)}(d.target,d.before)},replaceWith:function(t){var n=i();n.length?(t.is(b)&&s(n.parent())&&(t=c()("<p></p>").append(t)),n.replaceWith(t),e.dom.isBlock(t[0])&&t.parent().is("p")&&t.unwrap(),ge().showElement(t),e.selection.select(t[0]),e.selection.collapse(!0)):e.undoManager.undo(),ge().Cursor.fixCursorTargets(e.getBody())},destroy:function(){var t=i();t.length&&(t.remove(),ge().Cursor.fixCursorTargets(e.getBody()))}}}function R(t){if(1===t.which&&t.target===t.currentTarget)if(d)P(t);else{d=c()(t.target),e.selection.select(t.target),t.preventDefault(),n.bind({"mousemove.moveable-zone":B,"mouseup.moveable-zone":P,"keydown.moveable-zone":_,"mouseover.moveable-zone":I});var r,o=d.offset();s=t.pageX,l=t.pageY,i=o.top-l,a=o.left-s,m=!0,f=(r=d).attr("style")||"",d=r}}function _(t){27===t.keyCode&&(p.cancelScrolling(),n.unbind(".moveable-zone"),e.undoManager.undo(),e.selection.select(d[0]),e.selection.collapse(!1),d=null)}function I(){n.find(".mceSelected").removeClass("mceSelected")}function B(n){if(m){if(function(e){var t=Math.abs(s-e.pageX),n=Math.abs(l-e.pageY);return t<y&&n<y}(n))return;Se(),e.undoManager.beforeChange(),e.undoManager.typing=!0,e.undoManager.add(),u("synchrony.stop",{id:w}),(r=e.selection.getSel())&&r.removeAllRanges&&r.removeAllRanges(),d.css({position:"absolute",width:d.css("width"),"max-width":"50%"}),h.current&&h.destroy(),d.detach(),ge().Cursor.fixCursorTargets(e.getBody()),o.append(d),g=A(d),m=!1}var r;n.preventDefault(),d.hide(),function(e,n){var r=C.length;if((n=Math.max(n,0))<r)return void p.scrollUp(C[n]);var o=t.height(),i=Math.max(0,o-n);if(i<r)return void p.scrollDown(C[i]);p.cancelScrolling()}(n.clientX,n.clientY),g.positionNear(n.clientX,n.clientY);var c=Math.min(n.pageY+i,p.scrollHeight()-d.outerHeight()),f=n.pageX+a;d.css({top:c,left:f,opacity:.5}),d.show()}function P(t){n.unbind(".moveable-zone"),p.cancelScrolling(),m?d=null:(t.preventDefault(),d.detach(),d.attr("style",f),g.replaceWith(d),g.destroy(),d=null,g=null,I(),e.undoManager.add(),u("synchrony.start",{id:w}))}return{init:function(r){e=r,r.on("Init",(function(){var e,i,a;t=c()(r.getWin()),n=c()(r.getDoc()),o=c()(r.getBody()),e=c.a.browser.webkit?o:n.find("html"),i=e,a=0,p={scrollUp:function(e){if(a!==-e){a=-e;var t=i.scrollTop()/e*1e3;i.stop(!1,!1),i.animate({scrollTop:0},{duration:t})}},scrollDown:function(e){if(a!==e){var t=i[0].scrollHeight,n=(t-i.scrollTop())/e*1e3;i.stop(!1,!1),i.animate({scrollTop:t},{duration:n})}},cancelScrolling:function(){i.stop(!0,!1)},scrollHeight:function(){return i[0].scrollHeight}},n.delegate(v,{mousedown:R})}))},getInfo:function(){return{longname:"Draggable objects (images, tables, placeholders) around the document via drag and drop",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}}},nn=(n("./src/editor-plugins/insert-files/insert-files.css"),function(){var e,t,n=function(){var e=c()("#wysiwyg").is(":hidden")?c()("#preview"):c()("#wysiwyg");t=e.find("iframe");var n=c()("#header-precursor"),r=c()(o.a).height(),i=n.offset().top+n.height()+c()("#header").height();c()("#content.edit").height(r-i),setTimeout((function(){if(c()("#preview").is(":hidden"))t.height(0).height(e.height());else{c()("#content.edit").height("auto");var n=c()("#savebar-container").height();i+=c()("#editor-precursor").height();t.height(r-i-n-4)}}),1)};return{init:function(t){t.on("Init",(function(){var o,i;c()(t.getBody()).addClass("fullsize");var a=r.tinymce.Env;(a.ie||a.opera)&&(o=t.getWin(),e=c()(o.parent),i=c()(o.parent.document),c()("body").css({overflow:"hidden"}),e.bind("resize.resizeplugin",(function(){n()})),i.bind("messageClose",(function(){setTimeout(n,0)})),i.bind("resize.resizeplugin",(function(e,t){n(t&&t.height)})),i.bind("mode-changed",(function(){n()})),t.on("Change",(function(){n()})),n())}))},getInfo:function(){return{longname:"flex editor to full size plugin",description:"adjusts height of editor so it always occupies the right space in between the toolbars",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}}});var rn=function e(t,n){var i;if(!M.get("remote-user")||!M.get("confluence.prefs.editor.disable.autoformat")){S.prototype={registerHandler:function(e,t){this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push(t)},executeHandlers:function(e,t,n,r){var o=!0;return c.a.each(this.handlers[e]||[],(function(e,i){if(i.handles(t))return o=i.execute(t,n,r),!1})),o}};var a,s=n.editor,l=new S,d=[new N(")",e.regularExpressions._REGEXES_EMOTICON.SMILE,"smile","emotions_dlg.smile","smile.svg"),new N("(",e.regularExpressions._REGEXES_EMOTICON.SAD,"sad","emotions_dlg.sad","sad.svg"),new N("P",e.regularExpressions._REGEXES_EMOTICON.CHEEKY,"cheeky","emotions_dlg.tongue","tongue.svg"),new N("p",e.regularExpressions._REGEXES_EMOTICON.CHEEKY_2,"cheeky","emotions_dlg.tongue","tongue.svg"),new N("D",e.regularExpressions._REGEXES_EMOTICON.LAUGH,"laugh","emotions_dlg.biggrin","biggrin.svg"),new N(")",e.regularExpressions._REGEXES_EMOTICON.WINK,"wink","emotions_dlg.wink","wink.svg"),new N(")",e.regularExpressions._REGEXES_EMOTICON.THUMBS_UP,"thumbs-up","emotions_dlg.thumbs_up","thumbs_up.svg"),new N(")",e.regularExpressions._REGEXES_EMOTICON.THUMBS_DOWN,"thumbs-down","emotions_dlg.thumbs_down","thumbs_down.svg"),new N(")",e.regularExpressions._REGEXES_EMOTICON.INFORMATION,"information","emotions_dlg.information","information.svg"),new N(")",e.regularExpressions._REGEXES_EMOTICON.TICK,"tick","emotions_dlg.check","check.svg"),new N(")",e.regularExpressions._REGEXES_EMOTICON.CROSS,"cross","emotions_dlg.error","error.svg"),new N(")",e.regularExpressions._REGEXES_EMOTICON.WARNING,"warning","emotions_dlg.warning","warning.svg"),new N(")",e.regularExpressions._REGEXES_EMOTICON.PLUS,"plus","emotions_dlg.add","add.svg"),new N(")",e.regularExpressions._REGEXES_EMOTICON.MINUS,"minus","emotions_dlg.forbidden","forbidden.svg"),new N(")",e.regularExpressions._REGEXES_EMOTICON.QUESTION,"question","emotions_dlg.help_16","help_16.svg"),new N(")",e.regularExpressions._REGEXES_EMOTICON.LIGHT_ON,"light-on","emotions_dlg.lightbulb_on","lightbulb_on.svg"),new N(")",e.regularExpressions._REGEXES_EMOTICON.LIGHT_OFF,"light-off","emotions_dlg.lightbulb","lightbulb.svg"),new N(")",e.regularExpressions._REGEXES_EMOTICON.YELLOW_STAR,"yellow-star","emotions_dlg.star_yellow","star_yellow.svg"),new N(")",e.regularExpressions._REGEXES_EMOTICON.YELLOW_STAR_2,"yellow-star","emotions_dlg.star_yellow","star_yellow.svg"),new N(")",e.regularExpressions._REGEXES_EMOTICON.RED_STAR,"red-star","emotions_dlg.star_red","star_red.svg"),new N(")",e.regularExpressions._REGEXES_EMOTICON.GREEN_STAR,"green-star","emotions_dlg.star_green","star_green.svg"),new N(")",e.regularExpressions._REGEXES_EMOTICON.BLUE_STAR,"blue-star","emotions_dlg.star_blue","star_blue.svg"),new N("3",e.regularExpressions._REGEXES_EMOTICON.HEART,"heart","emotions_dlg.heart","heart.svg"),new N("3",e.regularExpressions._REGEXES_EMOTICON.BROKEN_HEAR,"broken-heart","emotions_dlg.broken_heart","broken_heart.svg")],f=[];for(a=0;a<d.length;a++)f[a]=new o.a.Image,f[a].src=d[a].imagePath;for(c.a.each({"*":"bold",_:"italic","~":"subscript","^":"superscript","+":"underline","-":"strikethrough"},(function(e,t){var n=new RegExp("(?:[\\s\\xA0\\u200b\\uFEFF]+|^)(\\".concat(e,"(?=[^\\s").concat(e,"])([^").concat(e,"]*?[^\\s]))$"));l.registerHandler(e.charCodeAt(0),T(n,(function(e){A(t,e[2])}),!0))})),s.formatter.register("code",{inline:"code"}),l.registerHandler("}".charCodeAt(0),T(/(?:[\s\xA0\u200b]+|^)({{(?=[^\s])([^}]*?[^\s])})$/,(function(e){A("code",e[2])}),!0)),a=1;a<=6;a++)!function(e){l.registerHandler(" ".charCodeAt(0),T(new RegExp("^\\u200b?(h".concat(e,"\\.)$")),(function(){s.execCommand("formatBlock",!1,"h".concat(e),{skip_undo:!0})}),!0))}(a);l.registerHandler(" ".charCodeAt(0),T(/^\u200b?(bq\.)$/,(function(){s.execCommand("formatBlock",!1,"blockquote",{skip_undo:!0})}),!0));var m=T(/^\u200b?(\-\-\-\-)$/,(function(){s.execCommand("mceInsertContent",!1,"<hr />",{skip_undo:!0})}),!0);l.registerHandler(" ".charCodeAt(0),m),l.registerHandler(13,m),l.registerHandler(" ".charCodeAt(0),T(/^\u200b?(\#)$/,(function(){s.execCommand("InsertOrderedList")}),!0)),l.registerHandler(" ".charCodeAt(0),T(/^\u200b?(\*)$/,(function(){s.execCommand("InsertUnorderedList")}),!0)),l.registerHandler(" ".charCodeAt(0),T(/^\u200b?(1\.)$/,(function(){s.execCommand("InsertOrderedList")}),!0)),l.registerHandler(" ".charCodeAt(0),T(/^\u200b?(\-)$/,(function(){var e=s.dom;s.execCommand("InsertUnorderedList");var t=e.getParent(s.selection.getNode(),"OL,UL");t&&(e.setStyles(t,{listStyleType:"square"}),t.removeAttribute("data-mce-style"))}),!0)),u("confluence.editor.registerHandlers",{handlerManager:l,createHandler:T,ed:s});var p=T(/((\<\-\-?\>)([^\s-]*))$/,(function(e){s.execCommand("mceInsertContent",!1,"↔"+e[3],{skip_undo:!0})}),!1);l.registerHandler(" ".charCodeAt(0),p),l.registerHandler(13,p);var g=T(/((\-\-?\>)([^\s-]*))$/,(function(e){s.execCommand("mceInsertContent",!1,"→"+e[3],{skip_undo:!0})}),!1);l.registerHandler(" ".charCodeAt(0),g),l.registerHandler(13,g);var h=T(/((\<\-\-?)([^\s-]*))$/,(function(e){s.execCommand("mceInsertContent",!1,"←"+e[3],{skip_undo:!0})}),!1);l.registerHandler(" ".charCodeAt(0),h),l.registerHandler(13,h),l.registerHandler(" ".charCodeAt(0),T(/[^-]*[\s](\-\-\-?)$/,(function(e){var t=2===e[1].length?"–":"—";s.execCommand("mceInsertContent",!1,t,{skip_undo:!0})}),!1));var v=T(/(([^\s-]+)(\-\-\-?)([^\s-]+))$/,(function(e){var t=2===e[3].length?"–":"—";s.execCommand("mceInsertContent",!1,e[2]+t+e[4],{skip_undo:!0})}),!1);l.registerHandler(" ".charCodeAt(0),v),l.registerHandler(13,v),l.registerHandler(13,T(/(^\u200b?\|\|\s*(?:[^|]*\s?\|\|\s?)+$)/,(function(e){var t='<table class="confluenceTable"><tr>',n="",r=!0,o=c()(e[1].slice(2,-2).split("||")).map((function(e){return e=c.a.trim(this),r=r&&""===e,e}));r&&(o[0]=ve("editor.autoformat.sampletext.firstcell"));for(var i=0,a=o.length;i<a;i++)t+='<th class="confluenceTh">'.concat(o[i],"</th>"),n+='<td class="confluenceTd">'.concat(ge().ZERO_WIDTH_WHITESPACE,"</td>");t+="</tr><tr>".concat(n,"</tr></table>"),s.execCommand("mceInsertContent",!1,t,{skip_undo:!0}),s.selection.select(c()(s.selection.getRng(!0).commonAncestorContainer).parents("table").find(r?"th":"td")[0].childNodes[0]),c()(s.selection.getRng().startContainer).parent().closest('[contenteditable="true"]').focus()}),!0)),l.registerHandler(13,T(/(^\u200b?\|\s?(?:[^|]*\s?\|\s?)+$)/,(function(e){var t='<table class="confluenceTable"><tr>',n=!0,r=c()(e[1].slice(1,-1).split("|")).map((function(e){return e=c.a.trim(this),n=n&&""==e,e}));n&&(r[0]=ve("editor.autoformat.sampletext.firstcell"));for(var o=0,i=r.length;o<i;o++)t+='<td class="confluenceTd">'.concat(r[o],"</td>");t+="</tr></table>",s.execCommand("mceInsertContent",!1,t,{skip_undo:!0}),n&&s.selection.select(c()(s.selection.getRng(!0).commonAncestorContainer).parents("table").find("td")[0].childNodes[0]),c()(s.selection.getRng().startContainer).parent().closest('[contenteditable="true"]').focus()}),!0));var b=T(/\b(((https?|ftp):\/\/|(www\.))[\w\.\$\-_\+!\*'\(\),\/\?:@=&%#~;\[\]]+)$/,(function(e){var t=e[3]?e[1]:"http://".concat(e[1]),n=s.dom.create("a",{href:t});n.appendChild(r.document.createTextNode(e[1])),s.execCommand("mceInsertContent",!1,x(n),{skip_undo:!0}),s.getDoc().execCommand("unlink",!1,{})}),!1,"a");l.registerHandler(" ".charCodeAt(0),b),l.registerHandler(13,b);var y=T(/\b((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)$/i,(function(e){var t=s.dom.create("a",{href:"mailto:".concat(e[1])});t.appendChild(r.document.createTextNode(e[1])),s.execCommand("mceInsertContent",!1,x(t),{skip_undo:!0}),s.getDoc().execCommand("unlink",!1,{})}),!1,"a");l.registerHandler(" ".charCodeAt(0),y),l.registerHandler(13,y);var C=function(e,t){var n=T(e,(function(){s.execCommand("mceInsertContent",!1,t,{skip_undo:!0})}),!1);l.registerHandler(" ".charCodeAt(0),n),l.registerHandler(13,n)};C(/(?:\b|^)(jira)$/,"Jira"),C(/(?:\b|^)(bitbucket)$/,"Bitbucket"),C(/(?:\b|^)(atlassian)$/,"Atlassian"),C(/(?:\b|^)(hipchat)$/,"Hipchat"),C(/(?:\b|^)(statuspage)$/,"Statuspage"),C(/(?:\b|^)(sourcetree)$/,"Sourcetree"),C(/(?:\b|^)(trello)$/,"Trello");var w={"]":e.regularExpressions._REGEXES.WIKI_LINK,"}":e.regularExpressions._REGEXES.WIKI_MACRO,"!":e.regularExpressions._REGEXES.WIKI_EMBED};c.a.each(w,(function(e,t){l.registerHandler(e.charCodeAt(0),T(t,(function(t){var n=t[1]+e,o={type:"POST",contentType:"application/json; charset=utf-8",url:"".concat(M.get("context-path"),"/rest/tinymce/1/wikixhtmlconverter"),data:c.a.toJSON({wiki:n,entityId:M.get("content-id"),spaceKey:M.get("space-key"),suppressFirstParagraph:!0}),dataType:"text",timeout:5e3};"}"==e?r.tinymce.confluence.MacroUtils.insertMacro(o):"!"==e?c.a.ajax(o).done((function(e){!n===e?r.tinymce.confluence.ImageUtils.insertImagePlaceholder(e):s.execCommand("mceInsertContent",!1,e,{skip_undo:!0})})):c.a.ajax(o).done((function(e){s.execCommand("mceInsertContent",!1,e,{skip_undo:!0})}))}),!0))})),s.on("KeyPress",(function(e){return l.executeHandlers(E(e),s,e,t)})),s.on("KeyDown",(function(e){if(13===E(e))return l.executeHandlers(13,s,e,t)}),!0);return{getHandlerCount:function(){return Object.keys(l.handlers).length}}}function x(e){return c()("<div>").append(e.cloneNode(!0)).html()}function k(e){var t,n;if(!e||!e.collapsed)throw new Error("range is null or not collapsed");if(t=e.startContainer,n=e.startOffset,1===t.nodeType&&n>0){if(3!==(t=t.childNodes[e.startOffset-1]).nodeType)return"";n=t.nodeValue.length}else if(3!==t.nodeType)return"";for(var r=t.nodeValue.substring(0,n),o=t.previousSibling;o&&3===o.nodeType;o=o.previousSibling)r=o.nodeValue+r;return r}function T(e,t,n,o){return{handles:function(t){var n=t.selection.getRng(!0),r=n.commonAncestorContainer||{};return!!n.collapsed&&(!c()(r).closest("pre,.text-placeholder").length&&((!o||!c()(r).closest(o).length)&&e.test(k(n))))},execute:function(o,a,s){var l,u=1,d=E(a);if(32===d?o.execCommand("mceInsertContent",!1,"&nbsp;"):o.execCommand("mceInsertContent",!1,String.fromCharCode(d)),o.undoManager.transact((function(){var n=o.selection.getRng(!0);"|"==(l=k(n))[l.length-1]&&(l+=" ",u=0);var r=e.exec(l.substring(0,l.length-1)),a=function(e,t,n){var r,o;if(t){3!==t.nodeType&&(n=(t=t.childNodes[n-1]).length);for(var i=t,a=n;i&&3===i.nodeType;i=i.previousSibling){if(-1==a&&(a=i.nodeValue.length),a>e)return{container:i,offset:a-e};if(a==e){for(o=0,r=i.parentNode;i=i.previousSibling;)o++;return{container:r,offset:o}}e-=a,a=-1}return null}}(r[1].length+u,n.commonAncestorContainer,n.startOffset);n.setStart(a.container,a.offset);var s=c()(n.commonAncestorContainer);o.selection.setRng(n),s.closest(".wysiwyg-macro-body").length&&n.toString()==s.text()?(s[0].innerHTML="<br>",o.selection.select(s[0].childNodes[0]),o.selection.collapse(!0)):o.execCommand("delete",!1,{},{skip_undo:!0}),t(r,o.selection.getRng(!0)),i=o.selection.getRng(!0)})),n)return s.preventDefault(),s.stopPropagation(),r.tinymce.dom.Event.cancel(a),ge().showElement(i.startContainer),!1}}}function E(e){return e.which}function S(){this.handlers={}}function N(e,t,n,r,o){var i=e.charCodeAt(0),a="".concat(ge().getResourceUrlPrefix(),"/images/icons/emoticons/").concat(o),c=T(t,(function(){var e=s.dom.createHTML("img",{src:a,alt:s.translate("tinymce.".concat(r)),title:s.translate("tinymce.".concat(r)),border:0,class:"emoticon emoticon-".concat(n),"data-emoticon-name":n});s.execCommand("mceInsertContent",!1,e,{skip_undo:!0})}),!0);this.imagePath=a,l.registerHandler(i,c)}function A(e,t){var n=s.formatter.get(e)[0],o=s.dom.create(n.inline,{style:n.styles});o.appendChild(r.document.createTextNode(t)),s.execCommand("mceInsertContent",!1,"".concat(x(o),"&nbsp;"),{skip_undo:!0})}},on=(rn.regularExpressions={_REGEXES:{WIKI_MACRO:/(?:\s|^)(\{[^{^}]+)$/,WIKI_LINK:/(?:\s|^)(\[[^\[^\]]+)$/,WIKI_EMBED:/(?:\s|^)(![^!]{5,})$/},_REGEXES_EMOTICON:{SMILE:/\B(:-?)$/,SAD:/\B(:-?)$/,CHEEKY:/\B(:-?)$/,CHEEKY_2:/\B(:-?)$/,LAUGH:/\B(:-?)$/,WINK:/\B(;-?)$/,THUMBS_UP:/\B(\(y)$/,THUMBS_DOWN:/\B(\(n)$/,INFORMATION:/\B(\(i)$/,TICK:/\B(\(\/)$/,CROSS:/\B(\(x)$/,WARNING:/\B(\(!)$/,PLUS:/\B(\(\+)$/,MINUS:/\B(\(-)$/,QUESTION:/\B(\(\?)$/,LIGHT_ON:/\B(\(on)$/,LIGHT_OFF:/\B(\(off)$/,YELLOW_STAR:/\B(\(\*)$/,YELLOW_STAR_2:/\B(\(\*y)$/,RED_STAR:/\B(\(\*r)$/,GREEN_STAR:/\B(\(\*g)$/,BLUE_STAR:/\B(\(\*b)$/,HEART:/\B(<)$/,BROKEN_HEAR:/\B(<\/)$/}},"stickyTableHeaders"),an=0,cn={fixedOffset:0,leftOffset:0,marginTop:0,objDocument:o.a.document,objHead:"head",objWindow:o.a,scrollableArea:o.a,cacheHeaderHeight:!1};function sn(e,t){var n=this;n.$el=c()(e),n.el=e,n.id=an++,n.$el.bind("destroyed",c.a.proxy(n.teardown,n)),n.$clonedHeader=null,n.$originalHeader=null,n.cachedHeaderHeight=null,n.isSticky=!1,n.hasBeenSticky=!1,n.leftOffset=null,n.topOffset=null,n.init=function(){n.setOptions(t),n.$el.each((function(){var e=c()(this);e.css("padding",0),n.$originalHeader=c()("thead:first",this),n.$clonedHeader=n.$originalHeader.clone(),e.trigger("clonedHeader.".concat(on),[n.$clonedHeader]),n.$clonedHeader.addClass("tableFloatingHeader"),n.$clonedHeader.css("display","none"),n.$originalHeader.addClass("tableFloatingHeaderOriginal"),n.$originalHeader.after(n.$clonedHeader),n.$printStyle=c()('<style type="text/css" media="print">.tableFloatingHeader{display:none !important;}.tableFloatingHeaderOriginal{position:static !important;}</style>'),n.$head.append(n.$printStyle)})),n.updateWidth(),n.toggleHeaders(),n.bind()},n.destroy=function(){n.$el.unbind("destroyed",n.teardown),n.teardown()},n.teardown=function(){n.isSticky&&n.$originalHeader.css("position","static"),c.a.removeData(n.el,"plugin_".concat(on)),n.unbind(),n.$clonedHeader.remove(),n.$originalHeader.removeClass("tableFloatingHeaderOriginal"),n.$originalHeader.css("visibility","visible"),n.$printStyle.remove(),n.el=null,n.$el=null},n.bind=function(){n.$scrollableArea.on("scroll.".concat(on),n.toggleHeaders),n.isWindowScrolling||(n.$window.on("scroll.".concat(on).concat(n.id),n.setPositionValues),n.$window.on("resize.".concat(on).concat(n.id),n.toggleHeaders)),n.$scrollableArea.on("resize.".concat(on),n.toggleHeaders),n.$scrollableArea.on("resize.".concat(on),n.updateWidth)},n.unbind=function(){n.$scrollableArea.off(".".concat(on),n.toggleHeaders),n.isWindowScrolling||(n.$window.off(".".concat(on).concat(n.id),n.setPositionValues),n.$window.off(".".concat(on).concat(n.id),n.toggleHeaders)),n.$scrollableArea.off(".".concat(on),n.updateWidth)},n.debounce=function(e,t){var n=null;return function(){var r=this,o=arguments;clearTimeout(n),n=setTimeout((function(){e.apply(r,o)}),t)}},n.toggleHeaders=n.debounce((function(){n.$el&&n.$el.each((function(){var e,t=c()(this),r=n.isWindowScrolling?isNaN(n.options.fixedOffset)?n.options.fixedOffset.outerHeight():n.options.fixedOffset:n.$scrollableArea.offset().top+(isNaN(n.options.fixedOffset)?0:n.options.fixedOffset),o=t.offset(),i=n.$scrollableArea.scrollTop()+r,a=n.$scrollableArea.scrollLeft(),s=n.options.cacheHeaderHeight?n.cachedHeaderHeight:n.$clonedHeader.height(),l=n.isWindowScrolling?i>o.top:r>o.top,u=(n.isWindowScrolling?i:0)<o.top+t.height()-s-(n.isWindowScrolling?0:r);l&&u?(e=o.left-a+n.options.leftOffset,n.$originalHeader.css({position:"fixed","margin-top":n.options.marginTop,left:e,"z-index":3}),n.leftOffset=e,n.topOffset=r,n.$clonedHeader.css("display",""),n.isSticky||(n.isSticky=!0,n.updateWidth(),t.trigger("enabledStickiness.".concat(on))),n.setPositionValues()):n.isSticky&&(n.$originalHeader.css("position","static"),n.$clonedHeader.css("display","none"),n.isSticky=!1,n.resetWidth(c()("td,th",n.$clonedHeader),c()("td,th",n.$originalHeader)),t.trigger("disabledStickiness.".concat(on)))}))}),0),n.setPositionValues=n.debounce((function(){var e=n.$window.scrollTop(),t=n.$window.scrollLeft();!n.isSticky||e<0||e+n.$window.height()>n.$document.height()||t<0||t+n.$window.width()>n.$document.width()||n.$originalHeader.css({top:n.topOffset-(n.isWindowScrolling?0:e),left:n.leftOffset-(n.isWindowScrolling?0:t)})}),0),n.updateWidth=n.debounce((function(){if(n.isSticky){n.$originalHeaderCells||(n.$originalHeaderCells=c()("th,td",n.$originalHeader)),n.$clonedHeaderCells||(n.$clonedHeaderCells=c()("th,td",n.$clonedHeader));var e=n.getWidth(n.$clonedHeaderCells);n.setWidth(e,n.$clonedHeaderCells,n.$originalHeaderCells),n.$originalHeader.css("width",n.$clonedHeader.width()),n.options.cacheHeaderHeight&&(n.cachedHeaderHeight=n.$clonedHeader.height())}}),0),n.getWidth=function(e){var t=[];return e.each((function(e){var r,i=c()(this);if("border-box"===i.css("box-sizing")){var a=i[0].getBoundingClientRect();r=a.width?a.width:a.right-a.left}else{if("collapse"===c()("th",n.$originalHeader).css("border-collapse"))if(o.a.getComputedStyle)r=parseFloat(o.a.getComputedStyle(this,null).width);else{var s=parseFloat(i.css("padding-left")),l=parseFloat(i.css("padding-right")),u=parseFloat(i.css("border-width"));r=i.outerWidth()-s-l-u}else r=i.width()}t[e]=r})),t},n.setWidth=function(e,t,n){t.each((function(t){var r=e[t];n.eq(t).css({"min-width":r,"max-width":r})}))},n.resetWidth=function(e,t){e.each((function(e){var n=c()(this);t.eq(e).css({"min-width":n.css("min-width"),"max-width":n.css("max-width")})}))},n.setOptions=function(e){n.options=c.a.extend({},cn,e),n.$window=c()(n.options.objWindow),n.$head=c()(n.options.objHead),n.$document=c()(n.options.objDocument),n.$scrollableArea=c()(n.options.scrollableArea),n.isWindowScrolling=n.$scrollableArea[0]===n.$window[0]},n.updateOptions=function(e){n.setOptions(e),n.unbind(),n.bind(),n.updateWidth(),n.toggleHeaders()},n.init()}c.a.fn[on]=function(e){return this.each((function(){var t=c.a.data(this,"plugin_".concat(on));t?"string"==typeof e?t[e].apply(t):t.updateOptions(e):"destroy"!==e&&c.a.data(this,"plugin_".concat(on),new sn(this,e))}))};var ln=function(e){return!e.parents("table").length>0},un=function(e){return!e.closest(".columnLayout").length>0},dn=function(){return!c()("body").hasClass("theme-documentation")},fn=function(e){var t=c()(e);return dn()&&function(e){return!e.hasClass("stickyTableHeaders")}(t)&&un(t)&&ln(t)&&function(e){return e.find("> thead:first").is(":visible")}(t)&&function(e){return 1===e.find("thead").children().length}(t)&&function(e){return 1===e.find(".confluenceTh").parent().length}(t)&&function(e){return e.find(".confluenceTh").siblings().hasClass("confluenceTh")}(t)},mn=function(e,t){var n=t||c()(window);e.closest(".table-wrap").scroll((function(){n.trigger("scroll.stickyTableHeaders")}))},pn=function(e){c()(e).each((function(){var e=c()(this),t=e.find(".confluenceTh[rowspan]").length>0,n=e.find("> :first-child > :first-child .confluenceTh"),r=n.length&&n.closest("thead").length>0,o=n.length&&0===n.parent().index();if(ln(e)&&un(e)&&!r&&o&&!t){var i=c()("<thead />").append(n.parent());e.prepend(i)}}))},gn=dn,hn=function(e,t){var n=e.filter((function(){return fn(this)}));n.stickyTableHeaders(t).addClass("stickyTableHeaders"),s("sticky-table-headers.change.options",(function(e,t){n.stickyTableHeaders(t)})),mn(n)},vn={initialize:function(){var e=c()(".confluenceTable"),t=c()(window);if(gn()){if(pn(e),window.MutationObserver){var n=document.querySelector("#page");if(!n)return;var r=/sticky|tableFloating|confluenceTh/;new MutationObserver(c.a.debounce((function(e){for(var n,o=!1,i=0,a=e.length;i<a;i++)if(n=e[i].target.className,!r.test(n)){o=!0;break}o&&t.trigger("resize.stickyTableHeaders")}),0)).observe(n,{subtree:!0,attributes:!0,childList:!0})}hn(e,{cacheHeaderHeight:!0})}},setupTable:hn},bn=function(e,t){var n=r.tinymce.activeEditor;if(n){var o=function(e){var t={};return t.objWindow=c()(e.getWin()),t.scrollableArea=t.objWindow,t.objDocument=c()(e.getDoc()),t.objHead=t.objDocument.find("head"),t}(n),i=c.a.extend({},o,t),a=e.filter((function(){return fn(this)}));a.stickyTableHeaders(i).addClass("stickyTableHeaders"),mn(a,i.objWindow)}},yn={initialize:function(){var e=r.tinymce.activeEditor;if(e){var t=c()(e.getBody()).find(".confluenceTable");pn(t),bn(t)}},setupTable:bn};var Cn={init:function(e){var t=r.Confluence.Editor;function n(){if(t.UI.isFormEnabled()&&e.isDirty()&&!t.isEmpty())return e.translate("unsaved.comment.lost")}e.on("Init",(function(){s("beforeunload",n)})),e.on("Remove",(function(){l("beforeunload",n)}))},getInfo:function(){return{longname:"Confluence Leave Comment",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}};var wn={init:function(e){var t=r.Confluence.Editor;function n(){if(t.UI.isFormEnabled()&&e.isDirty()&&!t.isEmpty())return e.translate("unsaved.template.lost")}e.on("Init",(function(){s("beforeunload",n)})),e.on("Remove",(function(){l("beforeunload",n)}))},getInfo:function(){return{longname:"Confluence Leave Template",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}};var xn=function(){return{init:function(e){var t,n=r.Confluence.Editor.Drafts,i=r.Confluence.Editor;function a(){var e,t,n;e=M.get("draft-id"),t=M.get("draft-share-id"),0!==e&&o.a.history&&o.a.history.replaceState&&o.a.history.replaceState(null,"","".concat(Ce,"/pages/resumedraft.action?draftId=").concat(e,"&draftShareId=").concat(t,"&").concat(void 0===(n=o.a.location.search)?"":("?"===n.charAt(0)&&(n=n.substr(1)),n.split("&").filter((function(e){return 0===e.indexOf("username=")||0===e.indexOf("userFullName=")||0===e.indexOf("accessType=")||0===e.indexOf("grantAccess=")||0===e.indexOf("src.")})).join("&")))),i.UI.cancelButton.attr("data-tooltip",ve("editor.shared.draft.done.desc")),i.UI.cancelButton.on("click",(function(){u("analytics",{name:"confluence.editor.done.button.clicked"}),u("analytics",{name:"confluence.editor.close",data:{source:"closeButton",contentId:M.get("content-id"),currentVersion:M.get("page-version")||"null"}})}))}function d(){if(!M.get("has-collaborated")&&r.AJS.Rte.Content.editorHasContentChanged()){M.set("has-collaborated",!0);var e=M.get("remote-user-key"),t=M.get("content-id");c.a.ajax({type:"PUT",url:"".concat(Ce,"/rest/experimental/relation/user/").concat(e,"/collaborator/toContent/").concat(t,"?targetStatus=draft"),error:function(){M.set("has-collaborated",!1)}}),c.a.ajax({type:"DELETE",url:"".concat(Ce,"/rest/experimental/relation/touched/from/user/current/to/content/").concat(t,"?targetStatus=current")}),c.a.ajax({type:"PUT",url:"".concat(Ce,"/rest/experimental/relation/user/").concat(e,"/touched/toContent/").concat(t,"?targetStatus=draft"),error:function(){M.set("has-collaborated",!1)}})}}var f=function(e){return c()("#draft-status").show(),n.bindUnloadMessage(),i.UI.cancelButton.click((function(){M.getBoolean("shared-drafts")||n.save({skipErrorHandler:!0})})),M.getBoolean("shared-drafts")&&a(),setInterval(n.save,+M.get("draft-save-interval")||3e4)};e.on("Init",(function(){s("editor.local.change",d)})),e.on("Remove",(function(){l("editor.local.change",d)})),s("rte-ready",(function(){t=f()})),s("rte-destroyed",(function(){clearInterval(t)}))},getInfo:function(){return{longname:"Confluence Drafts",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}};var kn={init:function(e){e.on("Init",(function(){e.addCommand("mceConfMacroBrowser",r.tinymce.confluence.macrobrowser.macroBrowserToolbarButtonClicked)}))},getInfo:function(){return{longname:"Confluence Macro Browser",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},Tn={init:function(e){e.on("init",(function(){if(M.get("use-watch")){var e={userWatchingOwnContent:M.get("user-watching-own-content")};c()("#rte-savebar-tinymce-plugin-point").append((t=function(e){return ve(e)},'\n    <ul class="toolbar-group toolbar-group-watch-page" id="toolbar-group-watch-page-after-comment">\n        <li class="toolbar-item">\n            <input id="watchPage" name="watchPageAfterComment" value="true" type="checkbox" '.concat(e.userWatchingOwnContent?'checked="checked"':"",'/>\n            <label for="watchPage">').concat(t("comment.notification.enable"),"</label>\n        </li>\n    </ul>\n")))}var t}))},getInfo:function(){return{longname:"Confluence Watch",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},En={init:function(e){var t=function(e){c()(".tablesorter",e.node).each((function(e,t){var n,r,o=c()(t).find("thead");1===o.length&&"THEAD"===(o=o[0]).nodeName&&1===o.childNodes.length&&(r=o.removeChild(o.childNodes[0]),n=c()(t).find("tbody")[0],t.removeChild(o),n.insertBefore(r,n.childNodes[0]))}))};e.on("PastePostProcess",t),e.on("remove",(function(){e.off("PastePostProcess",t)}))},getInfo:function(){return{longname:"ConfluenceSortableTablesPlugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}},Sn={init:function(e){e.on("Init",(function(){e.getBody().classList.add("resizable")}));var t=0;if(!e.getParam("fullscreen_is_enabled")){var n=parseInt(e.getParam("autoresize_min_height",e.getElement().offsetHeight)),o=parseInt(e.getParam("autoresize_max_height",0));e.on("Change SetContent Paste KeyUp Init",i),e.addCommand("mceAutoResize",i)}function i(a){var s=e.getDoc(),l=s.body,u=s.documentElement,d=r.tinymce.DOM,f=n,m=a===Object(a)&&a.forceExec||!1,p=c()(s).height();if(p>n&&(f=p),o&&p>o?(f=o,l.style.overflowY="auto",u.style.overflowY="auto"):(l.style.overflowY="hidden",u.style.overflowY="hidden",l.scrollTop=0),m||f!==t){var g=f-t;d.setStyle(d.get("".concat(e.id,"_ifr")),"height","".concat(f,"px")),t=f,r.tinymce.Env.webkit&&g<0&&i()}}},getInfo:function(){return{longname:"Auto Resize",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/autoresize",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},Nn=function(){function e(e){return e.nodeValue.toLowerCase()}return{search:function(t,n,r,o,i){var a=t.getSel(),c=function e(t){var n=[];if(t.nodeType===Node.TEXT_NODE)n.push(t);else for(var r=t.childNodes,o=0,i=r.length;o<i;++o)n.push.apply(n,e(r[o]));return n}(o);n=n.replace(/\s/g,"").toLowerCase();var s=c.map(e).join("");r=function(e,t,n){var r=e.getRng();if(r.endContainer.nodeValue){var o=n.indexOf(r.endContainer.nodeValue.toLowerCase())+r.endOffset;t=t!==o&&-1!==t?o:t}return t}(t,r,s);var l,u,d,f,m,p=(l=s,u=n,d=r,(m=(f=i)?l.lastIndexOf(u,d-1):l.indexOf(u,d+1))<0&&!f?m=l.indexOf(u):0===m&&0===d&&f&&(m=l.lastIndexOf(u)),m);if(p<0)return[!1,p];var g=function(e,t,n){for(var r,o,i,a,c=0,s=0;s<t.length;s++){if(t[s].nodeType===Node.TEXT_NODE){var l=e+n.length;!o&&t[s].length+c>=l&&(o=t[s],a=l-c),!r&&t[s].length+c>e&&(r=t[s],i=e-c),c+=t[s].length}if(r&&o)return{startNode:r,startIndex:i,endNode:o,endIndex:a}}}(p,c,n),h=document.createRange();return h.setStart(g.startNode,g.startIndex),h.setEnd(g.endNode,g.endIndex),a.removeAllRanges(),a.addRange(h),h.startContainer.parentNode.scrollIntoView(),[!0,p]}}},An=n("./src/helpers/browser.js"),Rn=function(){var e=Nn(),t=new An.a(window.navigator.userAgent),n='<mark data-searching class="find-current">',o=function e(t){var n=t,o=null,i=null,a=null,c=null,s=null,l={initialised:!1,find:function(e,t,n){var r=o.getFindInput().val(),i=a.findText(r,!0,e);i&&t?t():!i&&n&&n()},replace:function(e,t){var n=o.getFindInput(),r=o.getReplaceInput(),i="";r&&(i=r.val());var c=a.replaceText(n.val(),i,!0);c&&e?e():!c&&t&&t()},replaceAll:function(e,t){var n=o.getFindInput(),r=o.getReplaceInput(),i="";r&&(i=r.val());var c=a.replaceAll(n.val(),i);c&&e?e():!c&&t&&t()},focus:function(){o.focusFindTextBox()},isVisible:function(){return null!=o},init:function(){o=e.UI(n,c,s),(i=new e.MarkManager).addListener(o),a=null,a=r.tinymce.Env.ie?new e.implIE(o):new e.impl(o,i),o.getFindInput().focus()},onVisible:function(e){if(null!=e&&e.length>0){var t=o.getFindInput(),n=t.val();t.val(n+e)}o.onVisible()},onHide:function(){c=o.getFindInput().val(),s=o.getReplaceInput().val(),a.destroy(),a=null,o.destroy(),o=null,i.destroy(),i=null},_clearSavedValues:function(){c=null,s=null}};return l};return o.utils={moveCursorToEnd:function(e){if(r.tinymce.Env.ie){var t=e.createTextRange();t.execCommand("SelectAll"),t.move("textedit"),t.select()}else if(r.tinymce.Env.gecko){var n=c()(e).val().length;e.setSelectionRange(n,n)}},createTextRange:function(e,t){return e.selection?e.selection.createRange():t.getBody().createTextRange()}},o.impl=function(n,o){var i=new r.tinymce.html.Writer,a=o,c=-1,s=function n(o,i,s){if(!o)return!1;var l=r.tinymce.activeEditor,u=l.selection,d=l.getWin();function f(){return l.undoManager.ignore((function(){a.markCurrentlySelectedRange()})),!0}function m(){return l.undoManager.ignore((function(){a.removeCurrentMark(!0),r.tinymce.activeEditor.selection.isCollapsed()||r.tinymce.activeEditor.selection.collapse()})),!1}if(a.isCursorAtCurrentMark()&&l.undoManager.ignore((function(){u=a.selectCurrentMark()})),u.isCollapsed()||u.collapse(s),r.tinymce.Env.gecko)return d.find(o,!1,s)?f():i?(u.select(l.getBody(),!1),u.collapse(!s),n(o,!1,s)):m();if(!t.isMSEdge())return d.find(o,!1,s,!0,!1,!1,!1)?f():m();var p=e.search(u,o,c,l.getBody(),s);return c=p[1],p[0]?f():void 0},l=function(e){var t=r.tinymce.activeEditor;i.text(e),t.selection.setContent(i.getContent(),{format:"raw"}),i.reset(),t.selection.collapse(!0)},u={};return u.findText=s,u.replaceText=function(e,t,n){var o=r.tinymce.activeEditor;return a.hasCurrentMark()?(o.undoManager.transact((function(){var e=a.replaceCurrentMark(t);e&&o.selection.select(e)})),s(e,n)):s(e,n)},u.replaceAll=function(n,o){var i=r.tinymce.activeEditor,c=0;return i.undoManager.transact((function(){var s=i.selection,u=i.getWin();if(a.removeCurrentMark(!1),i.execCommand("selectAll"),i.selection.collapse(!0),t.isMSEdge())for(var d=-1;;){var f=e.search(s,n,d,i.getBody(),!1);if(!f[0])break;d=f[1],l(o),c++}else for(;u.find(n,!1,!1,!1,!1,!1,!1);)l(o),c++;if(0===c)r.Confluence.EditorNotification.notify("info",i.translate("searchreplace_dlg.notfound"));else if(1===c)r.Confluence.EditorNotification.notify("success",i.translate("searchreplace_dlg.allreplacedsingular"));else if(c>1){var m=i.translate("searchreplace_dlg.allreplacedplural");r.Confluence.EditorNotification.notify("success",m.replace("{0}",c))}})),c},u.destroy=function(){a=null,i=null},u},o.implIE=function(e){var t={},i=e,a=null,s=new r.tinymce.html.Writer,l=o.utils.createTextRange,u=function e(n,o,i){if(!n)return!1;var s=r.tinymce.activeEditor,l=s.getDoc(),u=t.storedRange=t.storedRange||l.body.createTextRange();if(s.focus(),a&&a.select(),s.selection.collapse(!i),m(),i&&a){var d=l.body.createTextRange();d.moveToElementText(c()("p:first",s.getBody())[0]),u.setEndPoint("StartToStart",d);var p=a.text;p.length&&(p=p.replace(/s+$/,"")).length&&u.moveEnd("character",-p.length);var g=u.text.length;u.moveEnd("word",-1),u.text.length>=g&&u.moveEnd("character",-1),u.select(),u.collapse(!1)}return a=null,u.findText(n,i?-1:1,0)?(u.scrollIntoView(),(u=f(u)).select(),a=u,!0):o?(s.selection.select(r.tinymce.activeEditor.getBody(),!0),s.selection.collapse(!i),e(n,!1,i)):void(t.storedRange=null)},d=function(){m()},f=function(e){var t,o=e.htmlText;return e.pasteHTML(n+o+"</mark>"),i.marked(),(t=r.tinymce.activeEditor).on("Change",d),t.on("BeforeSetContent",d),e},m=function(){!function(){var e=r.tinymce.activeEditor;e.off("Change",d),e.off("BeforeSetContent",d)}();var e=r.tinymce.activeEditor,t=c()("mark",e.getDoc());if(t.length){var n=!1,o=e.selection.getRng(!0).commonAncestorContainer;c()(o).closest("mark").length&&(n=!0),t.each((function(e,t){var n=c()(t);n.contents().each((function(e,t){n.before(t)}))})).remove(),n&&e.execCommand("RemoveFormat")}i.markRemoved()},p=function(){m()};return t.findText=u,t.replaceText=function(e,t,n){var o=r.tinymce.activeEditor;if(a){var i=o.getDoc().createTextNode(t),s=c()("mark",o.getDoc());o.undoManager.transact((function(){s.parent()[0].replaceChild(i,s[0]);var e=o.getDoc().createElement("mark");e.setAttribute("class","current"),e.dataset.searching=!0,i.parentNode.insertBefore(e,i),e.appendChild(o.getDoc().createTextNode(t)),e.parentNode.removeChild(i)}))}return u(e,n)},t.replaceAll=function(e,t){var n=r.tinymce.activeEditor,o=0;return n.undoManager.transact((function(){var i=n.selection,a=n.getDoc();m(),i.select(n.getBody(),!1),i.collapse(!0),n.focus();for(var c=l(a,n);c.findText(e,1,0);)c.scrollIntoView(),c.select(),s.text(t),n.selection.setContent(s.getContent(),{format:"raw"}),s.reset(),o++,c.moveStart("character",t.length);if(0===o)r.Confluence.EditorNotification.notify("info",n.translate("searchreplace_dlg.notfound"));else if(1===o)r.Confluence.EditorNotification.notify("success",n.translate("searchreplace_dlg.allreplacedsingular"));else if(o>1){var u=n.translate("searchreplace_dlg.allreplacedplural");r.Confluence.EditorNotification.notify("success",u.replace("{0}",o))}})),o},t.destroy=function(){r.tinymce.activeEditor.onBeforeGetContent.remove(p),m(),i=null,a=null,s=null},r.tinymce.activeEditor.onBeforeGetContent.add(p),t},o.UI=function(e,t,n){var i=null,a=o.utils.moveCursorToEnd;r.tinymce.activeEditor&&r.tinymce.activeEditor.plugins&&r.tinymce.activeEditor.plugins.customtoolbar&&(i=r.tinymce.activeEditor.plugins.customtoolbar.getToolbarRow(e));var s=function(){var e=c()(".toolbar-find-input",i);return e.length?e:null},l=function(){var e=c()(".toolbar-replace-input",i);return e.length?e:null},u=function(e){if("input"===e.type||"propertychange"===e.type){var t=s(),n=null!=t&&t.val().length>0;f(n),m(n)}},d=function(){var e=s();h(e&&e.val())},f=function(e){e?(r.tinymce.activeEditor.plugins.customtoolbar.enableToolbarButton("search-toolbar-find-next-button"),r.tinymce.activeEditor.plugins.customtoolbar.enableToolbarButton("search-toolbar-find-previous-button")):(r.tinymce.activeEditor.plugins.customtoolbar.disableToolbarButton("search-toolbar-find-next-button"),r.tinymce.activeEditor.plugins.customtoolbar.disableToolbarButton("search-toolbar-find-previous-button"))},m=function(e){var t=s();p().toggleClass("default-action",e&&t.val().length>0)},p=function(){var e=c()(".search-toolbar-find-next-button",i).closest(".aui-button");return e.length?e:null},g=function(e){var t=r.tinymce.activeEditor.plugins.customtoolbar;e?t.enableToolbarButton("search-toolbar-replace-button"):t.disableToolbarButton("search-toolbar-replace-button")},h=function(e){var t=r.tinymce.activeEditor.plugins.customtoolbar;e?t.enableToolbarButton("search-toolbar-replaceall-button"):t.disableToolbarButton("search-toolbar-replaceall-button")},v={};return v.getFindInput=s,v.getReplaceInput=l,v.focusFindTextBox=function(){top.focus(),s().focus()},v.onVisible=function(){var e=s();e.focus(),e.val().length>0&&(a(e[0]),f(!0),h(!0))},v.destroy=function(){},v.marked=function(){g(!0)},v.markRemoved=function(){g(!1)},function(e,t){var n=s(),o=!1;(e&&e.length&&(n.val(e),o=!0),t&&t.length)&&l().val(t);!function(){function e(e,t){if(e)if(r.tinymce.isIE9)e[0].attachEvent("onpropertychange",t);else{var n=r.tinymce.isIE8?"propertychange":"input";e.bind(n,t)}}var t=s();e(t,u),e(t,d),c()(i).focusin((function(){m(!0)})).focusout((function(){m(!1)})),t.focus((function(){m(!0)}))}(),f(o),h(o),g(!1)}(t,n),v},o.MarkManager=function(){var e=null,t=new r.tinymce.html.Writer,o=null,i=[],a=function(){u()},s=function(){if(!e)return null;var t=r.tinymce.activeEditor;return t.selection.select(e[0]),t.selection},l=function(t){h(),(d(e,t)||o&&r.tinymce.activeEditor.selection.getRng(!0).toString()==o)&&(e=null,o=null,c.a.each(i,(function(e,t){t.markRemoved()})))},u=function(){h(),c()("mark",r.tinymce.activeEditor.getDoc()).each((function(e,t){d(c()(t),!1)})),e=null,o=null,c.a.each(i,(function(e,t){t.markRemoved()}))},d=function(e,t){var n=r.tinymce.activeEditor.selection.getRng(!0);if(!e)return!1;var o=function(e,t){if(e.intersectsNode)return e.intersectsNode(t);var n=r.tinymce.activeEditor.getDoc().createRange();return n.selectNodeContents(t),!(e.compareBoundaryPoints(Range.START_TO_END,n)<=0||e.compareBoundaryPoints(Range.END_TO_START,n)>=0)}(n,e[0]),i=null,a=null;if(e.contents().each((function(t,n){e.before(n),i||(i=n),a=n})),o||t){var c=r.tinymce.activeEditor.selection.getRng(!0);c.setStartBefore(i),c.setEndAfter(a),t||c.collapse(!1),r.tinymce.activeEditor.selection.setRng(c)}return e.remove(),!0},f=function(){return!!e||(o?r.tinymce.activeEditor.selection.getRng(!0).toString()==o:void 0)},m=function(){u()},p=function(){h(),c.a.each(i,(function(e,t){t.markRemoved()}))},g=function(e){var t=r.tinymce.activeEditor;t.on("Change",a),t.on("BeforeSetContent",a),e&&(t.on("Click",p),t.on("DblClick",p))},h=function(){var e=r.tinymce.activeEditor;e.off("Change",a),e.off("BeforeSetContent",a),e.off("Click",p),e.off("DblClick",p)},v={markCurrentlySelectedRange:function(){var t=r.tinymce.activeEditor;if(e){var a=t.selection.getBookmark();l(!1),t.selection.moveToBookmark(a)}o=null;var u=t.selection.getRng(!0);e=c()(n+"</mark>",t.getDoc());try{u.surroundContents(e[0]),g(!1)}catch(t){1==t.code&&(o=u.toString(),e=null,g(!0))}c.a.each(i,(function(e,t){t.marked()})),o||s().collapse()}};return v.removeCurrentMark=l,v.removeAllMarks=u,v.selectCurrentMark=s,v.isCursorAtCurrentMark=function(){if(!e)return!1;var t=r.tinymce.activeEditor.selection;t.isCollapsed()||t.collapse();var n=t.getRng(!0);if(3===n.startContainer.nodeType)return n.startContainer.parentNode.normalize(),n.startContainer.nextSibling===e[0]||n.startContainer.previousSibling===e[0];if(1===n.startContainer.nodeType){var o=n.startContainer.childNodes,i=n.startOffset;return i>0&&o[i-1]===e[0]||!!(i+1<o.length&&o[i+1===e[0]])}},v.hasCurrentMark=f,v.replaceCurrentMark=function(n){if(function(n){if(e||!f())return!1;var o=r.tinymce.activeEditor;return o.undoManager.transact((function(){t.text(n),o.selection.setContent(t.getContent(),{format:"raw"}),t.reset()})),o.undoManager.ignore((function(){l(!1)})),!0}(n))return null;if(!e)return null;var o=r.tinymce.activeEditor,i=[];o.undoManager.ignore((function(){e.contents().each((function(e,t){i.push(t)})),l(!1)}));var a=void 0;return o.undoManager.transact((function(){a=c()(i[0]).before(o.getDoc().createTextNode(n))[0].previousSibling;for(var e=i.length-1;e>=0;e--)c()(i[e]).remove()})),a},v.addListener=function(e){i.push(e)},v.destroy=function(){l(!0),r.tinymce.activeEditor.onBeforeGetContent.remove(m)},r.tinymce.activeEditor.onBeforeGetContent.add(m),v},o},_n=function(){ne(r.document,"initContextToolbars.Toolbar",(function(e,t){var n;r.Confluence.Editor.searchToolbar=(n=r.Confluence.Editor,{initContextToolbars:function(e,t){var o=function(e){if(r.tinymce.Env.ie){var t=e.createTextRange();t.execCommand("SelectAll"),t.move("textedit"),t.select()}else if(r.tinymce.Env.gecko){var n=c()(e).val().length;e.setSelectionRange(n,n)}},i=function(e){top.focus(),r.tinymce.activeEditor.plugins.customtoolbar.focusToolbarButton(e)},a=function(){top.focus();var e=c()("#search-toolbar-find-text");e.focus(),o(e[0])},s=function(){top.focus();var e=c()("#search-toolbar-replace-text");e.focus(),o(e[0])},l=function(){if(r.tinymce.Env.ie&&frames.wysiwygTextarea_ifr.focus(),r.tinymce.Env.ie||r.tinymce.Env.gecko){var e=r.tinymce.activeEditor;e.focus(),e.selection.select(e.getBody()),e.selection.collapse(!1),e.focus()}},u=new n.Toolbar.Components.TextBox({id:"search-toolbar-find-text",text:t.translate("searchreplace_dlg.findlabel"),name:"find",keydown:function(e){if(!r.tinymce.isIE8&&(e.ctrlKey||r.tinymce.isMac&&e.metaKey)&&70===e.which)e.preventDefault();else if(13===e.which){e.preventDefault();var t={backwards:!1,onFound:a,onNotFound:a};r.tinymce.activeEditor.undoManager.ignore((function(){r.tinymce.activeEditor.execCommand("mceConfSearch",!1,t,{skip_undo:!0})}))}else 27===e.which&&(e.preventDefault(),r.tinymce.activeEditor.undoManager.ignore((function(){r.tinymce.activeEditor.execCommand("mceSearchReplaceToolbar",!1,!1,{skip_undo:!0})})))},cssClass:"toolbar-find-input"}),d=new n.Toolbar.Components.TextBox({id:"search-toolbar-replace-text",text:t.translate("searchreplace_dlg.replacelabel"),name:"replace",keydown:function(e){if(!r.tinymce.isIE8&&(e.ctrlKey||r.tinymce.isMac&&e.metaKey)&&70===e.which)e.preventDefault();else if(13===e.which){e.preventDefault();var t=r.tinymce.activeEditor.undoManager.ignore((function(){r.tinymce.activeEditor.execCommand("mceConfSearch",!1,{backwards:!1,onFound:s,onNotFound:a},{skip_undo:!0})}));g(s,a,t)}else 27===e.which&&(e.preventDefault(),r.tinymce.activeEditor.undoManager.ignore((function(){r.tinymce.activeEditor.execCommand("mceSearchReplaceToolbar",!1,!1,{skip_undo:!0})})))},cssClass:"toolbar-replace-input"}),f=new n.Toolbar.Components.TextButton({text:t.translate("searchreplace_dlg.findprevious"),click:function(){var e={backwards:!0,onFound:function(){top.focus(),i("search-toolbar-find-previous-button")},onNotFound:a};t.undoManager.ignore((function(){t.execCommand("mceConfSearch",!1,e,{skip_undo:!0})}))},textClass:"search-toolbar-find-previous-button"}),m=new n.Toolbar.Components.TextButton({text:r.tinymce.Env.ie?t.translate("searchreplace_dlg.findlabel"):t.translate("searchreplace_dlg.findnext"),click:function(){var e={backwards:!1,onFound:function(){top.focus(),i("search-toolbar-find-next-button")},onNotFound:a};t.undoManager.ignore((function(){t.execCommand("mceConfSearch",!1,e,{skip_undo:!0})}))},textClass:"search-toolbar-find-next-button"}),p=new n.Toolbar.Components.TextButton({text:t.translate("searchreplace_dlg.replace"),click:function(){g((function(){top.focus(),i("search-toolbar-replace-button")}),a)},textClass:"search-toolbar-replace-button"}),g=function(e,t,n){r.Confluence.Editor.searchManager&&(r.tinymce.activeEditor.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-replace-button")?r.Confluence.Editor.searchManager.replace(e,t):n&&n())},h=new n.Toolbar.Components.TextButton({text:t.translate("searchreplace_dlg.replaceall"),click:function(){var e={onReplaced:l,onNotReplaced:a};t.undoManager.transact((function(){t.execCommand("mceConfReplaceAll",!1,e)}))},textClass:"search-toolbar-replaceall-button"}),v=new n.Toolbar.Components.Button({text:t.translate("searchreplace_dlg.close"),iconClass:"icon aui-icon aui-icon-small aui-iconfont-close-dialog",click:function(){t.undoManager.ignore((function(){t.execCommand("mceConfSearchClose",!1,null)}))}});return{Buttons:[new n.Toolbar.Components.Group([v],{groupClass:"close"}),new n.Toolbar.Components.Group([u,d],{groupClass:"no-separator"}),new n.Toolbar.Components.Group(r.tinymce.Env.ie?[m]:[f,m]),new n.Toolbar.Components.Group([p,h])]}}}).initContextToolbars(e,t)}))};function In(){var e=r.Confluence.Editor,t=null,n=!1,o=function(e){e.preventDefault(),e.stopPropagation()},i=function(e){o(e);var n=e.which;n||(n=e.charCode?e.charCode:e.keyCode),n<48||t.push(n)},a=function(e){var t=c()("#rte-button-searchreplace a");t.length&&(e?t.unbind("click",!1):t.bind("click",!1))},s=function(){if(!n){n=!0;var s,l=c()("#rte-button-searchreplace"),u=!l.hasClass("active"),d=c()("body"),f=!d.hasClass("no-tools")||d.hasClass("no-tools-toolbars-visible");u?(l.addClass("active"),e.searchManager||(e.searchManager=new e.SearchManager("searchreplace")),c()(r.document).trigger("createContextToolbarRow.Toolbar",{id:"searchreplace",buttons:e.searchToolbar.Buttons,topToolbar:!0,editorAdjacent:!0,animate:f,onVisible:function(){var c=function(){var e=r.tinymce.activeEditor;e.off("KeyDown",i),e.off("KeyPress",o),e.off("KeyUp",o);for(var n,a="",c=0;c<t.length;c++)a+=(n=t[c])>65535?(n-=65536,String.fromCharCode(55296+(n>>10),56320+(1023&n))):String.fromCharCode(n);return a.toLowerCase()}();e.searchManager.onVisible(c),a(!0),n=!1,e.searchManager.initialised=!0}}).trigger("enableContextToolbarRow.Toolbar"),s=r.tinymce.activeEditor,t=[],s.on("KeyDown",i),s.on("KeyPress",o),s.on("KeyUp",o),e.searchManager.init(),a(!1)):(l.removeClass("active"),e.searchManager.onHide(),c()(r.document).trigger("removeContextToolbarRow.Toolbar",{id:"searchreplace",animate:f,onHide:function(){c()(r.document).trigger("contextToolbarRowRemoved.Toolbar"),a(!0),n=!1,e.searchManager.initialised=!1}}),a(!1),r.tinymce.Env.gecko||frames.wysiwygTextarea_ifr.focus(),r.tinymce.activeEditor.focus())}};return{init:function(t){t.addCommand("mceSearchReplaceToolbar",(function(){t.undoManager.ignore((function(){s()}))})),t.addCommand("mceConfSearch",(function(n,r){e.searchManager&&((!(r=r||{}).backwards||t.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-find-previous-button"))&&(r.backwards||t.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-find-next-button"))?e.searchManager.find(r.backwards,r.onFound,r.onNotFound):e.searchManager.focus())})),t.addCommand("mceConfReplaceAll",(function(n,r){e.searchManager&&(r=r||{},t.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-replaceall-button")&&e.searchManager.replaceAll(r.onReplaced,r.onNotReplaced))})),t.addCommand("mceConfSearchClose",(function(){e.searchManager&&t.undoManager.ignore((function(){t.execCommand("mceSearchReplaceToolbar",!1,null)}))})),t.addButton("searchreplace",{title:"searchreplace.search_desc",cmd:"mceSearchReplaceToolbar"}),8!=r.tinymce.Env.ie&&t.shortcuts.add("meta+f","searchreplace.search_desc",(function(){e.searchManager&&e.searchManager.isVisible()?e.searchManager.focus():t.undoManager.ignore((function(){t.execCommand("mceSearchReplaceToolbar",!1,!1,{skip_undo:!0})}))}))},getInfo:function(){return{longname:"Search/Replace",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}}function Bn(e){return(Bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Pn="object"===("undefined"==typeof window?"undefined":Bn(window))?window.localStorage:{},Dn=function(e,t){var n=M.get("remote-user")||"",r="".concat(e,".").concat(n,".").concat(t),o=!1,i=/\d+#/,a=function(e){if(!o)return null;var t,n=Pn.getItem("".concat(r,".").concat(e));return(t=i.exec(n))&&(n=n.replace(t[0],""),+new Date>t[0].replace("#",""))?(Pn.removeItem("".concat(r,".").concat(e)),null):n};try{o=Object.keys(Pn).length}catch(e){console.log("Browser does not support localStorage, Confluence.storageManager will not work.")}return{getItem:a,getAllItems:function(){if(!o)return null;var e={};for(var t in Pn)if(Pn.hasOwnProperty(t)&&t.indexOf("".concat(r,"."))>-1){var n=t.split("".concat(r,"."))[1];e[n]=a(n)}return e},doesContain:function(e){return!!a(e)},getItemAsBoolean:function(e){var t=a(e);return"false"!==t&&("true"===t||!!t)},setItem:function(e,t,n){var i;o&&(t=((i=1e3*(n||0))?+new Date+i+"#":"")+t,Pn.setItem("".concat(r,".").concat(e),t))},setItemQuietly:function(e,t,n){try{this.setItem(e,t,n)}catch(n){console.log("Unable to write to localStorage. key: ".concat(e,", value: ").concat(t,", cause: ").concat(n))}},removeItem:function(e){o&&Pn.removeItem("".concat(r,".").concat(e))}}}("confluence","userSettings");function On(e,t){return t?"".concat(e,".").concat(t.replace(/\./g,"-")):e}var Mn,Ln={get:function(e,t,n){var r=On(e,t),o=Dn.getItem(r);return null!==o?JSON.parse(o):void 0!==n?n:null},set:function(e,t,n,r){var o=On(e,t);if(r===n)Dn.removeItem(o);else{Dn.setItem(o,JSON.stringify(r),2592e3)}}},Fn={init:function(e){e.on("init",(function(){var e={contentId:M.get("content-id")},t=c()("#rte-savebar-tinymce-plugin-point");t.append('\n    <span class="minor-edit toolbar-item">\n        <input id="notifyWatchers" name="notifyWatchers" value="true" type="checkbox" checked>\n        <label for="notifyWatchers">\n          <span>'.concat(function(e){return ve(e)}("editor.minor.edit"),"</span>\n        </label>\n    </span>\n"));var n=t[0].querySelector('input[id="notifyWatchers"]'),r=Ln.get("notifyWatchers",e.contentId,!0);null!==r&&(n.checked=r),ne(n,"change",(function(){Ln.set("notifyWatchers",e.contentId,!0,n.checked)}))}))},getInfo:function(){return{longname:"Confluence Notify Watchers",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}};function jn(){u("analytics",{name:"confluence.table.image.insert",data:{pageId:M.get("page-id"),tableMode:Un()}})}function Hn(){return!!c()(Mn.selection.getNode()).closest("table.confluenceTable").length}function Un(){var e=c()(Mn.selection.getNode()).closest("table.confluenceTable");return e.hasClass("fixed-table")?"fixed":e.hasClass("relative-table")?"relative":"fluid"}function Wn(){var e=c()(Mn.getBody()).find("table.confluenceTable");u("analytics",{name:"confluence.table.quality.in.page",data:{pageId:M.get("page-id"),total:e.length,fixed:e.filter(".fixed-table").length,fluid:e.filter(":not(.fixed-table,.relative-table)").length,relative:e.filter(".relative-table").length,nested:e.find("table.confluenceTable").length}})}var zn={init:function(e){function t(e,t){Hn()&&function(e){var t,n;e&&e.name&&e.name.indexOf("confluence.editor.image.resize")>=0&&u("analytics",{name:"confluence.table.img.resize",data:{pageId:M.get("page-id"),tableMode:Un(),isImgBiggerCell:(t=c()(Mn.selection.getNode()),n=t.closest("th, td"),t.width()>n.width())}})}(t)}Mn=e,e.on("ExecCommand",(function(e){switch(e.command){case"mceAutoWidth":case"mceRelativeWidth":case"mceFixedWidth":u("analytics",{name:"confluence.table.mode.to.".concat(Un()),data:{pageId:M.get("page-id")}});break;case"mceTableCopyRow":u("analytics",{name:"confluence.table.row.copy",data:{pageId:M.get("page-id")}});break;case"mceTablePasteRowBefore":case"mceTablePasteRowAfter":u("analytics",{name:"confluence.table.row.paste",data:{pageId:M.get("page-id")}});break;case"mceTableCopyCol":u("analytics",{name:"confluence.table.col.copy",data:{pageId:M.get("page-id")}});break;case"mceTablePasteColBefore":case"mceTablePasteColAfter":u("analytics",{name:"confluence.table.col.paste",data:{pageId:M.get("page-id")}});break;case"mceInsertContent":t=e.value,(n=c()("<div/>").html(t)).find("img").length&&Hn()&&jn(),n.find("table.confluenceTable").length&&u("analytics",{name:"confluence.table.paste",data:{pageId:M.get("page-id")}})}var t,n})),e.on("Init",(function(){e.selection.onSetContent.add((function(e,t){Hn()&&t&&function(e){c()("<div/>").html(e.content).find(".confluence-embedded-image").length&&jn()}(t)}))})),s("analyticsEvent",t),s("rte.safe-save.success",Wn),e.on("Remove",(function(){l("analyticsEvent",t),l("rte.safe-save.success",Wn)}))},getInfo:function(){return{longname:"Table Analytics Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}};function qn(e,t,n){n&&n.node&&c()(".inline-comment-marker",n.node).contents().unwrap()}var Vn={init:function(e){e.on("beforeExecCommand",(function(e){if("Indent"===e.command||"Outdent"===e.command){var t=e.target,n=t.selection.getNode(),r=n.nodeName.toLowerCase();if("li"!==r&&"body"!==r){var o=parseInt(t.dom.getStyle(n,"margin-left")||0,10)+parseInt(t.dom.getStyle(n,"padding-left")||0,10);if(0!==o){var i=t.settings.indentation,a=/[a-z%]+/i.exec(i);t.dom.setStyle(n,"padding-left",""),t.dom.setStyle(n,"margin-left",o+a)}}}}))},getInfo:function(){return{longname:"Confluence Indentation",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},$n=function(e){var t=e.selection.getNode(),n=c()(t).closest("a"),r=e.selection.getRng();n.length&&function(e,t,n){if(!e.selection.getSel().isCollapsed)return!1;if(t.compareEndPoints){var r=e.getBody().createTextRange();return r.moveToElementText(n),r.collapse(0),0===t.compareEndPoints("EndToEnd",r)}var o=t.endContainer;if(3===o.nodeType)return o.wholeText.length==t.endOffset;var i=o.childNodes[t.endOffset];return c()(i).is(":last-child")}(e,e.selection.getRng(),t)&&(r.setStartAfter(n[0]),r.setEndAfter(n[0]),e.selection.setRng(r),e.selection.collapse())},Kn=function(e){var t=e.endOffset;return 3===e.endContainer.nodeType?e.endContainer:e.endContainer.childNodes[t-1]},Jn=function(e,t){if(t&&t.previousSibling&&t.previousSibling.hasChildNodes()){var n=t.previousSibling,r=n.childNodes.length,o=n.childNodes[r-1],i=o.length,a=e.dom.createRng();a.setStart(o,i),a.setEnd(o,i),e.selection.setRng(a)}},Gn={init:function(e){e.on("KeyDown",(function(t){r.tinymce.VK.modifierPressed(t)||32!==t.keyCode||$n(e),r.tinymce.VK.modifierPressed(t)||8!==t.keyCode&&37!==t.keyCode||function(e){if(e.selection.isCollapsed()&&e.selection.selectedRange&&!function(e){return!!e.dom.getParents(e.selection.getNode(),"#autocomplete-search-text").length}(e)){var t=Kn(e.selection.selectedRange);t&&t.nodeValue&&65279===t.nodeValue.charCodeAt(0)&&function(e,t){return 1==t.nodeValue.length&&1==e.selection.getNode().childNodes.length}(e,t)&&e.undoManager.ignore((function(){Jn(e,t),t.parentNode.removeChild(t)}))}}(e)}))}};function Xn(e){for(var t=e.offsetTop;e.offsetParent;)t+=(e=e.offsetParent).offsetTop;return t}function Yn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Qn=new(function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var o=M.get("remote-user")||"";this._namespace="".concat(t,".").concat(o,".").concat(n),this._sessionStorageSupported=!!r.sessionStorage}var t,n,o;return t=e,(n=[{key:"getItem",value:function(e){return this._sessionStorageSupported?r.sessionStorage.getItem("".concat(this._namespace,".").concat(e)):null}},{key:"doesContain",value:function(e){return!!this.getItem(e)}},{key:"setItem",value:function(e,t){if(this._sessionStorageSupported)try{r.sessionStorage.setItem("".concat(this._namespace,".").concat(e),t)}catch(n){console.error("Unable to write to sessionStorage. key: ".concat(e,", value: ").concat(t,", cause: ").concat(n))}}},{key:"removeItem",value:function(e){this._sessionStorageSupported&&r.sessionStorage.removeItem("".concat(this._namespace,".").concat(e))}}])&&Yn(t.prototype,n),o&&Yn(t,o),e}())("atlassian","frontend");function Zn(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var er=function(e){var t=[];return Zn(e).forEach((function(e,n){(function(e,t){var n=t?t.documentElement:r.document.documentElement;if(e&&n){var o=e.getBoundingClientRect(),i=o.top,a=o.bottom,c=n.offsetHeight;return 0<=i&&i<c||0<=a&&a<=c||i<=0&&0<=a&&a>=c}})(e)&&t.push({targetElementIndex:n,visibleBlockEl:e})})),t},tr=function(e){var t=er(e),n=null;return t.some((function(e){return!!function(e,t){var n=t?t.documentElement:r.document.documentElement;if(e&&n){var o=e.getBoundingClientRect().top,i=n.offsetHeight;return 0<=o&&o<i}}(e.visibleBlockEl)&&(n=e,!0)})),!n&&t.length>0?t[0]:n||{targetElementIndex:-1,visibleBlockEl:null}},nr=function(e){var t={targetElementIndexInColumn:-1,columnIndex:-1,visibleBlockEl:null};return Zn(e).some((function(e,n){var r=tr(e.children),o=r.visibleBlockEl,i=r.targetElementIndex;return!!o&&(t.columnIndex=n,t.targetElementIndexInColumn=i,t.visibleBlockEl=o,!0)})),t},rr=function(e){if(!e)return!1;var t=e.children[0];return t&&t.classList.contains("contentLayout2")};var or=function(e){var t=e.contentId,n=e.isInViewPage,i=e.docObject,a=void 0===i?r.document:i,c=e.winObject,s=void 0===c?o.a:c,l=function(e,t){if(!e||0===t)return null;var n={targetElementIndex:-1,offsetBetweenTargetAndCurrentScroll:0,columnLayoutPosition:{columnIndex:-1,rowIndex:-1}};if(rr(e)){var r=e.children[0].children,o=tr(r),i=o.targetElementIndex,a=o.visibleBlockEl;if(a){var c=a.getElementsByClassName("innerCell"),s=nr(c),l=s.columnIndex,u=s.targetElementIndexInColumn,d=s.visibleBlockEl;d&&(n.targetElementIndex=u,n.offsetBetweenTargetAndCurrentScroll=t-Xn(d),n.columnLayoutPosition={rowIndex:i,columnIndex:l})}}else{var f=tr(e.children),m=f.targetElementIndex,p=f.visibleBlockEl;p&&(n.targetElementIndex=m,n.offsetBetweenTargetAndCurrentScroll=t-Xn(p),delete n.columnLayoutPosition)}return-1!==n.targetElementIndex?n:null}(n?a.getElementById("main-content"):a.body,s.pageYOffset);l&&(l.contentId=t,l.isInViewPage=n,Qn.setItem("editor-persit-scroll-position",JSON.stringify(l)))},ir={_saveScrollPosition:function(e){e.getDoc()&&e.getWin()&&or({contentId:Ie(),isInViewPage:!1,docObject:e.getDoc(),winObject:e.getWin()})},_restoreScrollPositionIfNeeded:function(e){e.getDoc()&&e.getWin()&&function(e){var t=e.contentId,n=e.isInViewPage,i=e.docObject,a=void 0===i?r.document:i,c=e.winObject,s=void 0===c?o.a:c,l=Qn.getItem("editor-persit-scroll-position");try{l=JSON.parse(l)}catch(e){0}finally{Qn.removeItem("editor-persit-scroll-position")}if(l&&l.contentId===t&&l.isInViewPage!==n){var u;u=n?a.getElementById("main-content"):a.body;var d,f=l.columnLayoutPosition;if(f){var m=u.children[0].children[f.rowIndex].getElementsByClassName("innerCell")[f.columnIndex];d=m&&m.children[l.targetElementIndex]}else d=u.children[l.targetElementIndex];if(d){var p=Xn(d)+l.offsetBetweenTargetAndCurrentScroll;setTimeout((function(){return s.scrollTo(0,p)}),1)}}}({contentId:Ie(),isInViewPage:!1,docObject:e.getDoc(),winObject:e.getWin()})},init:function(e){var t=M.get("content-type");"page"!==t&&"blogpost"!==t||(s("rte-collab-ready",(function(){ir._restoreScrollPositionIfNeeded(e)})),s("rte-ready",(function(){r.Confluence.Editor.UI.cancelButton.click((function(){return ir._saveScrollPosition(e)})),r.Confluence.Editor.UI.saveButton.click((function(){return ir._saveScrollPosition(e)}))})))},getInfo:function(){return{longname:"Persist scroll position for transition between view page and edit page",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},ar={init:function(e){e.on("init",(function(){e.getBody().classList.add("template-editor")}))}};function cr(e){return e.parentNode&&e.parentNode.childNodes||[]}function sr(e){var t=cr(e);return function(e){var t=!0,n=/TABLE|TH|TD/;return t=(t=(t=!n.test(e.nodeName))&&e.previousSibling?!n.test(e.previousSibling.nodeName):t)&&e.nextSibling?!n.test(e.nextSibling.nodeName):t}(e)&&(function(e){var t=function(e){return e&&e.innerHTML&&(e.innerHTML.replace(/\uFEFF|\u200B/g,"")||"&nbsp;")}(e);return/^&nbsp;$/.test(t)}(e)||t.length>1&&"BR"==t[0].nodeName)}function lr(e,t){e.dom.remove(t)}var ur={offset:function(e){var t=c()(e).offset(),n=c()(r.tinymce.activeEditor.iframeElement),o=n.offset(),i=n[0].contentWindow.document,a=c()(r.tinymce.activeEditor.getBody()),s=c.a.support.boxModel&&i.documentElement.scrollTop||a.scrollTop(),l=c.a.support.boxModel&&i.documentElement.scrollLeft||a.scrollLeft();return{top:t.top-s+o.top,left:t.left-l+o.left}},getSelectedText:function(){var e=r.tinymce.activeEditor.selection;return e.getRng().text||e.getSel()&&e.getSel().toString&&e.getSel().toString()||""},setHtml:function(e){e&&r.tinymce.activeEditor.setContent(e)},getHtml:function(){return"".concat(r.tinymce.activeEditor.getContent())},isEmpty:function(){var e=r.tinymce.activeEditor.getContent().replace("&nbsp;","").replace("<br />","");return"<p></p>"===e.trim()||0===e.length},editorHasContentChanged:function(){return r.tinymce.activeEditor.isDirty()},editorResetContentChanged:function(){r.tinymce.activeEditor.setDirty(!1)},getChildIndex:function(e,t){for(var n=e.childNodes,r=0,o=n.length;r<o;r++)if(n[r]==t)return r;return-1}},dr=function(){void 0!==r.AJS.Rte&&void 0===r.AJS.Rte.Content&&(r.AJS.Rte.Content=ur)};function fr(){r.tinymce.activeEditor.getBody().style.height="auto"}function mr(){return"undefined"!=typeof window?window.location:void 0}function pr(){if(window&&window.require){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return window.require.apply(window,t)}}var gr=function(){s("init.rte",(function(){var e;r.Confluence.EditorNotification={notify:function(t,n,r){var o=pr("aui/flag");void 0!==e&&"true"!==e.getAttribute("aria-hidden")&&e.close(),void 0===r&&(r="error"===t?"manual":"auto"),e=o({type:t,body:n,close:r})}}}))};function hr(){return{component:function(e){var t,n=function(e){0};return e=e||{},e=c.a.extend({},{keypressListener:function(r){if(27===r.keyCode)n(),c()(".aui-dropdown",t.popup.element).is(":visible")||("function"==typeof e.onCancel?e.onCancel():t.hide());else if(13===r.keyCode){if(n(),!c()(".aui-dropdown",t.popup.element).is(":visible"))"textarea"!=(r.target.nodeName&&r.target.nodeName.toLowerCase())&&"function"==typeof e.onSubmit&&setTimeout(e.onSubmit)}},width:865,height:530},e),t=new g.a.Dialog(e),r.document.addEventListener("hideLayer",(function(n,r,o){"popup"==r&&o==t&&"function"==typeof e.onCancel&&e.onCancel()})),t},initialiser:function(e){var t=this;s("show.dialog",(function(e,t){var n,r=M.get("page-id"),o=M.get("space-key"),i=M.get("editor-mode"),a=M.get("new-page");g.a.EventQueue=g.a.EventQueue||[],g.a.EventQueue.push({name:t.dialog.id,properties:(n={},r&&(n.pageid=r),o&&(n.spacekey=o),i&&(n.editormode=i),a&&(n.newpage=a),n)})})),r.document.addEventListener("showLayer",(function(t,n,o){r.Confluence.runBinderComponents(),"popup"==n&&o&&function(t){var n,o=e(t);if(!o.attr("data-lasttab-override")){o.attr("data-tab-default")&&(n=o.attr("data-tab-default"));var i=r.Confluence.storageManager(o.attr("id")),a=i.getItem("last-tab"),c=null!=a?a:n;c&&e(".page-menu-item:visible:eq(".concat(c,") button"),o).click(),o.attr("data-lasttab-bound")||(e(".page-menu-item",o).each((function(t,n){e(n).click((function(){i.setItem("last-tab",t)}))})),o.attr("data-lasttab-bound","true"))}}(o.element)})),g.a.Dialog.prototype.overrideLastTab=function(){e(t.popup.element).attr("data-lasttab-override","true")},g.a.Dialog.prototype.addHelpText=function(n,r){if(n){var o=n;r&&(o=g.a.template(n).fill(r).toString());var i=t.page[t.curpage];i.buttonpanel||i.addButtonPanel();var a=e("<div class='dialog-tip'></div>").html(o);i.buttonpanel.append(a),e("a",a).click((function(){return window.open(t.href,"_blank").focus().opener=null,!1}))}},g.a.Dialog.prototype.getTitle=function(){return e("#".concat(t.id,".dialog-components:visible h2")).text()},g.a.Dialog.prototype.isVisible=function(){return e("#".concat(t.id)).is(":visible")}}}}var vr=function(){var e={Button:function(e){var t=e.text,n=e.tooltip,r=e.triggerText,o=e.iconClass,i=e.click,a=!!e.disabled,s=e.id;this.render=function(){var e=c()('<button type="button"></button>').addClass("aui-button aui-button-subtle").attr("data-tooltip",n||t);if(s&&e.attr("id",s),a&&e.prop("disabled",!0).attr("aria-disabled","true"),e.click((function(){e.prop("disabled")||i()})),o){var l=c()("<span />");l.addClass("icon ".concat(o)),l.text(t),e.append(l)}if(r){var u=c()("<span />");u.addClass("trigger-text"),u.text(r),e.append(u)}return e[0]}},DropDownButton:function(e){var t,n=e.id,r=e.tooltip,o=e.text||"",i=e.iconClass,a=!!e.disabled,s=e.dropDownContent;this.render=function(){var e=c()("<div></div>").addClass("toolbar-item").addClass("toolbar-dropdown").attr("data-tooltip",r);e.attr("id",n);var l=c()("<div/>").addClass("aui-dd-parent"),u=c()("<a href='#'></a>");if(u.addClass("toolbar-trigger").addClass("aui-dd-trigger").addClass("aui-button"),o&&u.append("<span class='dropdown-text'>".concat(o,"</span>")),a&&(e.addClass("disabled"),u.addClass("disabled")),i){var d=c()("<span />");d.addClass("icon ".concat(i)),d.text(o),u.append(d)}var f=c()("<span/>");return f.addClass("icon").addClass("icon-dropdown"),u.append(f),t=c()("<div/>").addClass("hidden").addClass("aui-dropdown"),s&&t.append(s),l.append(u),l.append(t),e.append(l),e[0]}},TextButton:function(e){var t=e.text,n=e.textClass,r=e.click,o=!!e.disabled,i=e.tooltip;this.render=function(){var e=c()('<button type="button"></button>').addClass("aui-button aui-button-subtle").addClass(n).text(t);return i&&e.attr("data-tooltip",i),o&&e.prop("disabled",!0).attr("aria-disabled","true"),e.click((function(){e.prop("disabled")||r()})),e[0]}},TextBox:function(e){var t=e.id,n=e.text,r=e.name,o=e.keydown,i=e.cssClass;this.render=function(){var e=c()("<div></div>").addClass("toolbar-item");e.append(c()('<label for="'.concat(t,'">').concat(n,"</label>")));var a=c()('<input id="'.concat(t,"\" type='text' name=\"").concat(r,'" class="').concat(i,' text" autocomplete="off">'));return a.keydown((function(e){o(e)})),e.append(a),e[0]}},Group:function(e,t){var n=e;this.render=function(){var e=c()("<div></div>");e.addClass("aui-buttons"),t&&(t.id&&e.attr("id",t.id),t.groupClass&&e.addClass(t.groupClass));for(var r=0,o=n.length;r<o;r++)e.append(n[r].render());return e[0]}}};return e.SplitGroup=function(e,t){var n=e,r=t&&t.dropDownOptions||{};this.render=function(){var e=c()("<div></div>");e.addClass("aui-buttons"),t&&(t.id&&e.attr("id",t.id),t.groupClass&&e.addClass(t.groupClass));for(var o=0,i=n.length;o<i;o++)e.append(n[o].render());return e.append(function(){var e=r.id,t=r.disabled,n=r.dropDownContent,o=r.title,i=r.alignment,a=c()("<div></div>").addClass("toolbar-item").addClass("toolbar-dropdown").addClass("toolbar-splitbutton");e&&a.attr("id",e),o&&a.attr({"data-tooltip":o}),i&&a.data("dropdown-alignment",i);var s=c()("<div/>").addClass("aui-dd-parent"),l=c()("<a href='#'></a>");l.addClass("toolbar-trigger aui-dd-trigger aui-button"),t&&(a.addClass("disabled"),l.addClass("disabled"));var u=c()("<span/>");u.addClass("icon").addClass("icon-dropdown"),l.append(u);var d=c()("<div/>").addClass("hidden").addClass("aui-dropdown");return n&&d.append(n),s.append(l),s.append(d),a.append(s),a[0]}()),t&&t.postProcess&&t.postProcess(e),e[0]}},o.a.Confluence.Editor.Toolbar={},o.a.Confluence.Editor.Toolbar.Components=e,e},br=function(){var e,t,n,o,i,a,s,l,u,d,f,m,p,g,h,v,b,y,C={},w=4,x=4,k=15,T=20,E=25,S=17,N=20,A=0,R=!1;function _(){s.css({top:c()("#insert-table-dropdown").outerHeight(!0)}),_=function(){}}function I(){var t;s.hasClass("hidden")||(t=c()(r.tinymce.activeEditor.getDoc()),e.unbind(".atlassian-table-picker"),t.unbind(".atlassian-table-picker"),s.addClass("hidden"),n.addClass("hidden"),a.removeClass("active"))}function B(e,t){e==v&&t==b||(e=Math.max(1,Math.min(k,e)),t=Math.max(1,Math.min(T,t)),g=Math.max(w,e),h=Math.max(x,t),v=e,b=t,l.width(g*E+1),l.height(h*S+N),D(u,g,h),D(f,v,b),D(d,g,1),D(m,v,1),P(),p.text("".concat(v," x ").concat(b)))}function P(){d.toggleClass("hidden",!y),m.toggleClass("hidden",!y)}function D(e,t,n){e.width(E*t+1),e.height(S*n+1)}function O(t){var n=u.offset(),r=n.top-e.scrollTop(),o=n.left-e.scrollLeft(),i=r+u.outerHeight(!0)+A,a=i-S-A,c=o+u.outerWidth(!0)+A,s=c-E-A,l=t.clientY,d=t.clientX,f=g,m=h;d>c?f+=~~((d-c)/E+1):d<s&&(f+=~~((d-s)/E-1)),l>i?m+=~~((l-i)/S+1):l<a&&(m+=~~((l-a)/S-1)),B(f,m)}function M(e){e!=y&&(y=e,P())}function L(e){var n=function(e){var t=~~(e.offsetX||e.originalEvent.layerX),n=~~(e.offsetY||e.originalEvent.layerY),r=1+~~(t/E),o=1+~~(n/S);return r<1||r>k||o<1||o>T?null:{width:r,height:o}}(e);e.preventDefault(),n&&(I(),function(e,n,o){var i,a;0;var s=c()("#tinymce-table-form");s.length?(s.find('input[name="rows"]').val(n),s.find('input[name="cols"]').val(e)):(i=r.AJS.renderTemplate("tableForm",n,e),(a=c()("<div></div>").addClass("hidden")).append(i),t.append(a));c()("#table-heading-checkbox").prop("checked",o),Ne(),r.tinymce.activeEditor.undoManager.beforeChange();var l={cols:e,rows:n,heading:o};r.tinymce.activeEditor.execCommand("confInsertTable",!1,l),a&&a.remove()}(n.width,n.height,y))}function F(e){r.tinymce.Env.ie?(16===e.keyCode&&M(!e.shiftKey),27===e.keyCode&&I()):(0===e.charCode&&M(!e.shiftKey),27===e.keyCode&&0===e.charCode&&I())}function j(){I()}return C.insertTable=L,{bindToControl:function(){e=c()(r.document),t=e.find("body"),o=c()("#insert-table-dropdown"),i=c()("#rte-button-insert-table"),a=o.find(".aui-dd-parent"),s=c()("#table-picker-container"),l=s.find(".table-picker-box"),u=s.find(".picker-cell"),d=s.find(".picker-heading"),f=s.find(".picker-selected-cell"),m=s.find(".picker-selected-heading"),p=l.find(".desc"),n=c()("<div></div>").attr("id","table-picker-backdrop").addClass("hidden").appendTo(o),i.click((function(t){var o;t.preventDefault(),R||(Se(),_(),y=!0,B(1,1),o=c()(r.tinymce.activeEditor.getDoc()),e.bind("mousemove.atlassian-table-picker",O),e.bind("keydown.atlassian-table-picker",F),e.bind("keyup.atlassian-table-picker",F),o.bind("keydown.atlassian-table-picker",F),o.bind("keyup.atlassian-table-picker",F),n.removeClass("hidden"),s.removeClass("hidden"),a.addClass("active"),i.focus())})),n.click(j),f.click(L),m.click(L)},disable:function(){R=!0,o.addClass("disabled")},enable:function(){R=!1,o.removeClass("disabled"),i.attr("data-tooltip",ve("tinymce.tablepicker.insert_table_title"))},close:I,_internal:C}},yr=function(){r.AJS.Rte=ge()||{},r.AJS.Rte.TablePicker=br()};var Cr=[],wr=function(e){e.fn.tipsy.autoBounds2=function(t,n){return function(){var r={},o=e(document).scrollTop()+t,i=e(document).scrollLeft()+t,a=e(this);return n.length>1?(r.ns=n[0],r.ew=n[1]):"e"==n[0]||"w"==n[0]?r.ew=n[0]:r.ns=n[0],a.offset().top<o&&(r.ns="n"),a.offset().left<i&&(r.ew="w"),e(window).width()+e(document).scrollLeft()-(a.offset().left+a.width())<t&&(r.ew="e"),e(window).height()+e(document).scrollTop()-(a.offset().top+a.height())<t&&(r.ns="s"),r.ns?r.ns+(r.ew?r.ew:""):r.ew}}};function xr(){c()(".tipsy").remove()}function kr(){var e=/\+/g;setTimeout((function(){c()("#rte-savebar .aui-button[title]").each((function(){var t=c()(this),n=t.attr("title");if(t.removeAttr("title"),r.tinymce.Env.mac){var o=n.indexOf("(");o>=0&&(n=n.substr(0,o)+n.substr(o).replace(e,""))}t.attr("data-tooltip",n)}))}),0)}function Tr(e,t,n){if("dropdown"===t&&(c()(".tipsy").remove(),n&&n.trigger&&n.trigger.jquery)){var r=n.trigger.data("tipsy");r&&(r.hoverState="out")}}function Er(){var e=r.Confluence.Editor,t="disabled",n=!1;function o(e){var t=function(){e&&e.hide()};ne(r.document,"showLayer",(function(n,o,i){if("dropdown"==o&&i==e){var a=r.tinymce.activeEditor;a.on("Click",t),a.on("KeyUp",t)}})),ne(r.document,"hideLayer",(function(n,o,i){if("dropdown"==o&&i==e){var a=r.tinymce.activeEditor;a.off("Click",t),a.off("KeyUp",t)}}))}function i(e){e.addCallback("show",(function(){e.$.parents(".disabled").length&&e.hide()}))}function a(e,r){if(!n){var o=g(r);c()("#".concat(o)).removeClass(t)}}function u(e,n){var r=g(n);c()("#".concat(r)).addClass(t)}function d(e,r){r?e.closest(".aui-button").prop(t,!0).attr("aria-disabled","true").toggleClass(t,r):n||e.closest(".aui-button").prop(t,!1).removeAttr("aria-disabled").toggleClass(t,r)}function f(e,r,o,i){var a=!!n||e,s=!!n||r,l=!!n||o,u=c()("#toolbar"),d=u.find(".toolbar-item"),f=c()("#insert-menu, #more-menu"),m=c()("#insert-menu, #color-picker-control"),p=c()("#format-dropdown"),g=i||function(){return!0};d.toggleClass(t,a),f.toggleClass(t,a),m.toggleClass(t,a),p.toggleClass(t,!!s),ge().TablePicker[a?"disable":"enable"](),void 0!==l&&u.find("button, input").filter(g).toggleClass(t,l).prop(t,l)}var m,p=function(){return function(e){var n,r=e.element,o=(n=r,n=c()(n).closest("PRE,BLOCKQUOTE,.text-placeholder"),function(e){return n.is(e)}),i=o("BLOCKQUOTE"),a=o("PRE"),s=o(".text-placeholder");if(a)f(!0,c()(r).parents("table").is("[data-macro-body-type='PLAIN_TEXT']"));else if(s)f(!0);else if(i){f(!1),c()("#rte-button-justifyleft, #rte-button-justifycenter, #rte-button-justifyright").toggleClass(t,!0)}else f(!1)}};function g(e){var t="default";return e&&e.id&&(t=e.id),"rte-toolbar-row-".concat(t)}function h(e){return c()("#".concat(e)).length>0}function v(e,t){var n=t.animate;null==n&&(n=!0);var o=function(){c()(this).remove(),oe(r.document,"resize.resizeplugin"),t.onHide&&t.onHide()};clearTimeout(m),m=setTimeout((function(){var e=g(t),r=c()("#".concat(e));n?r.slideUp(400,o):(r.hide(),o.call(r))}),100)}function b(e,t){if(!n){var o=g(t),i=t.animate;if(null==i&&(i=!0),h(o))c()("#".concat(o,":hidden")).slideDown(400,(function(){0}));else{var a=c()("<div></div>").addClass("toolbar-split toolbar-split-row toolbar-contextual");a.attr("id",o),t.editorAdjacent&&a.addClass("editor-adjacent");for(var s=t.topToolbar?c()("#rte-toolbar.aui-toolbar:visible"):c()("#savebar-container .aui-toolbar:visible"),l=0,u=t.buttons.length;l<u;l++){var d=t.buttons[l];a.append(d.render())}if(a.css({display:"none"}),t.editorAdjacent)s.append(a);else{var f=c()(".editor-adjacent",s).filter(":first");f.length?f.before(a):s.append(a)}a.find(".toolbar-dropdown").each((function(){y(this)}));var p=function(){oe(r.document,"resize.resizeplugin"),oe(r.document,"shown.contextToolbar"),t.onVisible&&t.onVisible()};clearTimeout(m),m=setTimeout((function(){i?a.slideDown(400,p):(a.show(),p())}),100)}}}function y(e){var t=c()(e),a=t.dropDown("Standard",{alignment:t.data("dropdown-alignment")||"left"})[0];t.find(".dropdown-item").click((function(e){!function(e){if(!n){var t=e.attr("data-macro-name"),o=e.attr("data-command"),i=e.attr("data-format"),a=e.attr("data-control-id"),c=r.tinymce.activeEditor;t&&Le.macroBrowserToolbarButtonClicked({presetMacroName:t}),o&&c.execCommand(o,!1),i&&c.theme.controlHandlers.formatselect.click.dispatch(i),a&&c.theme.controlHandlers.buttons.click.dispatch(a)}}(c()(this)),a.hide(),e.preventDefault()})),i(a),o(a)}function C(){var e=[];for(var t in{})e.push("hints.".concat(t));var n=function(e){if(!Array.isArray(e))throw new Error("Hints passed in must be an array of strings");var t=Math.floor(Math.random()*e.length);return{getNextHint:function(){var n=e[t];return t=(t+1)%e.length,n}}}(e),o=function(){c()("#rte-savebar .hints-text").html(r.tinymce.activeEditor.translate("tinymce.".concat(n.getNextHint())))};o(),c()("#rte-savebar a.hints-close").click((function(e){c()(this).closest(".toolbar-split").addClass("hidden"),e.preventDefault()})),c()("#rte-savebar a.hints-next").click((function(e){o(),e.preventDefault()}))}return{init:function(t){var n,d;y("#format-dropdown"),y("#more-menu .aui-dd-parent"),y("#insert-menu .aui-dd-parent"),c()("#pagelayout-menu").length&&y("#pagelayout-menu .aui-dd-parent"),c()("#template-menu").length&&y("#template-menu .aui-dd-parent"),function(){var e=c()("#color-picker-control");if(e.length){var t=e.find(".aui-dd-parent"),n=c()("#rte-button-color"),a=n.find(".selected-color"),s=t.dropDown("Standard",{alignment:"left"})[0],l=n.attr("data-color");a.css("background-color","#".concat(l)),e.delegate("a[data-color]","click",(function(e){var t=c()(this),o=t.attr("data-color");e.preventDefault(),t.closest(".disabled").length||(r.tinymce.execCommand("ForeColor",!1,"#".concat(o)),n.attr("data-color",o),a.css("background-color","#".concat(o)))})),i(s),o(s)}}(),ge().TablePicker.bindToControl(r.tinymce.activeEditor,c()("#insert-table-dropdown")),(n=c()("#rte-button-source-mode")).click((function(){n.hasClass("active")?e.changeMode(e.MODE_RICHTEXT):e.changeMode(e.MODE_SOURCE)})),C(),d=t,oe(r.document,"initContextToolbars.Toolbar",d),ne(r.document,"createContextToolbarRow.Toolbar",b),ne(r.document,"removeContextToolbarRow.Toolbar",v),ne(r.document,"enableContextToolbarRow.Toolbar",a),ne(r.document,"disableContextToolbarRow.Toolbar",u);var f=c()("#format-dropdown"),m=f.find("span.dropdown-text");t.on("BeforeExecCommand",(function(e){var n=e.command,r=e.value;if(c.a.each(["pre","blockquote"],(function(){"FormatBlock"==n&&r==this&&(t.formatter.remove("alignleft"),t.formatter.remove("aligncenter"),t.formatter.remove("alignright"))})),c()(t.selection.getNode()).closest("pre,.text-placeholder").length)for(var o=["Bold","Italic","Underline","Strikethrough","InsertUnorderedList","InsertOrderedList","InsertInlineTaskList","InsertInlineTaskListNoToggle","superscript","subscript","mceConfMacroBrowser","mceConfimage","mceConfAttachments","mceEmotion","InsertWikiMarkup","mceConflink","mceInsertTable","mceConfAutocompleteLink"],i=o.length,a=0;a<i;a++)n==o[a]&&e.preventDefault();if("FormatBlock"==n&&"pre"==r&&(t.undoManager.add(),t.execCommand("removeFormat")),"FormatBlock"==n&&"p"==r){var s=f.find(".dropdown-item[data-format='blockquote']").text();m.text()==s&&t.execCommand("FormatBlock",!1,"blockquote")}})),t.on("ExecCommand",(function(e){var t=e.command,n=e.value;if("FormatBlock"==t){var r=f.find(".dropdown-item[data-format='".concat(n,"']"));r.length||(r=f.find(".dropdown-item[data-format='p']")),m.text(r.text())}})),t.on("NodeChange",p()),t.on("init",(function(){var e={};c()(".aui-toolbar").find("[data-control-id]").each((function(n,r){var o=(r=c()(r)).attr("data-control-id");"formatselect"==o?t.theme.controlHandlers[o].state.add((function(e){if("p"==e){var n=t.selection.getNode();c()(n).closest("p").parent().is("blockquote")&&(e="blockquote")}var r=f.find(".dropdown-item[data-format='".concat(e,"']")).text();r&&m.text(r)})):e[o]=r}));var n=t.theme.controlHandlers.buttons;n.state.add((function(t,n,r){var o=e[t];if(o){var i=o.find(".icon-check"),a=o.closest(".toolbar-item");i.length?i.toggleClass("hidden",!r):a.toggleClass(n,r)}})),c()(".aui-toolbar").delegate(".toolbar-item","click",(function(e){var t=c()(this);if(t.hasClass("disabled"))e.preventDefault();else{var r=t.children(".toolbar-trigger[data-control-id]").attr("data-control-id");r&&(n.click.dispatch(r),e.preventDefault())}})),c.a.support.shrinkWrapBlocks=!1,function(){wr(c.a);var e={live:!0,gravity:"n",title:function(){return c()(this).attr("data-tooltip")||""},delayIn:250,delayOut:0},t=c.a.fn.tipsy.autoBounds2(50,"n"),n=c.a.fn.tipsy.autoBounds2(50,"w"),o=c.a.extend({},e,{gravity:t}),i=c.a.extend({},e,{gravity:n}),a=c.a.extend({},e,{gravity:"se"});c()("#rte-toolbar [data-tooltip]:not(.dropdown-item)").tooltip(o),c()("#rte-toolbar .dropdown-item[data-tooltip]").tooltip(i),c()("#rte-savebar [data-tooltip]").tooltip(a),c()("#editor-precursor [data-tooltip]").tooltip(o),c()("#property-panel [data-tooltip]").tooltip(o),ne(r.document,"showLayer",Tr),ne(r.document,"hideLayer",Tr),s("created.property-panel",xr),s("destroyed.property-panel",xr),s("register-contexts.keyboardshortcuts",kr)}()})),t.on("Remove",(function(){re(r.document,"showLayer",Tr),re(r.document,"hideLayer",Tr),l("created.property-panel",xr),l("destroyed.property-panel",xr),l("register-contexts.keyboardshortcuts",kr)}))},toggleToolbarButton:d,disableToolbarButton:function(e){d(c()(".".concat(e.replace(".",""))),!0)},enableToolbarButton:function(e){n||d(c()(".".concat(e.replace(".",""))),!1)},focusToolbarButton:function(e){n||c()(".".concat(e.replace(".",""))).closest(".aui-button").focus()},isToolbarRowEnabled:function(e){var n=g({id:e});return h(n)&&!c()("#".concat(n)).hasClass(t)},getToolbarRow:function(e){var t=g({id:e}),n=c()("#".concat(t));return n.length?n[0]:null},isToolbarButtonEnabled:function(e){return!c()(".".concat(e.replace(".",""))).closest(".aui-button").prop(t)},bindDropdownMenu:y,toggleToolbarButtons:f,disableToolbar:function(e){n=!!e},getInfo:function(){return{longname:"customtoolbar",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com/",version:"1.0"}}}}var Sr=n("./node_modules/querystring-es3/index.js"),Nr=n.n(Sr);function Ar(e){this.message=e.message,this.statusCode=e["status-code"],this.stack=(new Error).stack}Ar.prototype=new Error;var Rr=Ar;function _r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Ir(e,t,n[t])}))}return e}function Ir(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Br=function(e,t){return e.replace(/:([a-zA-Z]+)\?*/g,(function(e,n){var r=t[n];return"string"==typeof r&&-1===r.indexOf("=")?encodeURIComponent(decodeURIComponent(r)):r}))};function Pr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(r){if(r instanceof Rr){if(401===r.statusCode)return e.onUnauthorized&&e.onUnauthorized(),t(r);var o=n[r.statusCode];return o?o(r,t):t(r)}if(r instanceof TypeError)return t(r);throw r}}function Dr(e,t,n){var r=t.body,o=t.callback,i=t.headers,a=t.method,c=t.extraConfig,s=t.responseTransformer,l=r,u=i["Content-Type"];return u||delete i["Content-Type"],u&&-1!==u.indexOf("application/x-www-form-urlencoded")?l=Nr.a.stringify(r):"application/json"===u&&(l=JSON.stringify(r)),fetch(e,{headers:i,credentials:"include",method:a,body:l}).then((function(e){if(!e.ok){var t=e.status;return e.text().then((function(e){throw new Rr({message:e,"status-code":t})}))}return c&&c.ignoreResponseJson?null:204!==e.status?e.json():e})).then((function(t){if(t&&t["status-code"])throw new Rr(t);return o(null,s?s(t,e,n.contextPath,r):t)})).catch(Pr(n,o))}var Or,Mr=(Or={endpoint:null,contextPath:null,onUnauthorized:function(){},extraHeaders:{}},{configure:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Or=_r({},Or,e)},getConfig:function(){return Or},getFullPath:function(e,t){var n=Or.contextPath+e;return t?Br(n,t):n},getExternalServicePath:function(e,t){if("function"!=typeof e)throw"getExternalServicePath expects path to be a function so it can be lazy evaluated";var n=e();return Br(n,t)},get:function(e,t){var n=t.callback,r=t.headers,o=t.responseTransformer;return Dr(e,{callback:n,headers:_r({Accept:"application/json","Content-Type":"application/json"},Or.extraHeaders,r),method:"GET",responseTransformer:o},Or)},post:function(e,t){var n=t.body,r=t.callback,o=t.headers,i=t.extraConfig,a=t.responseTransformer;return Dr(e,{body:n,callback:r,headers:_r({"Content-Type":"application/x-www-form-urlencoded"},Or.extraHeaders,o),method:"POST",extraConfig:i,responseTransformer:a},Or)},put:function(e,t){var n=t.body,r=t.callback,o=t.headers,i=t.responseTransformer;return Dr(e,{body:n,callback:r,headers:_r({Accept:"application/json","Content-Type":"application/json"},Or.extraHeaders,o),method:"PUT",responseTransformer:i},Or)},delete:function(e,t){var n=t.callback,r=t.headers,o=t.extraConfig,i=t.responseTransformer;return Dr(e,{callback:n,headers:_r({Accept:"application/json","Content-Type":"application/json"},Or.extraHeaders,r),method:"DELETE",extraConfig:o,responseTransformer:i},Or)},postLegacyResource:function(e,t){var n=t.body,r=t.callback,o=t.headers,i=t.responseTransformer;return fetch(e,{headers:_r({"Content-Type":"application/x-www-form-urlencoded"},Or.extraHeaders,o),credentials:"include",method:"POST",body:"string"==typeof n?n:Nr.a.stringify(n)}).then((function(e){if(!e.ok)return new Error("Request failed with ".concat(e.status));var t=e.headers.get("content-type");return t&&-1===t.indexOf("text/html")&&-1===t.indexOf("text/plain")?e.json():e.text()})).then((function(t){return t instanceof Error?r(t):r(null,i?i(t,e,Or.contextPath,n):t)})).catch(Pr(Or,r))},fetch:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return fetch(e,t)}))}),Lr={configure:function(e){Mr.configure(e)},getPluginCodeLanguages:function(e){var t=Mr.getFullPath("/plugins/newcode/getlanguages.action");Mr.get(t,{callback:e})},getWikiConfluenceToXhtml:function(e,t){var n=Mr.getFullPath("/rest/tinymce/1/wikixhtmlconverter");Mr.postLegacyResource(n,{body:e,callback:t,headers:{Accept:"text/plain, */*","Content-Type":"application/json; charset=utf-8"}})},getWikiMarkdownToXhtml:function(e,t){var n=Mr.getFullPath("/rest/tinymce/1/markdownxhtmlconverter");Mr.postLegacyResource(n,{body:e,callback:t,headers:{Accept:"text/plain, */*","Content-Type":"application/json; charset=utf-8"}})}};function Fr(){Object(r.redirect)("".concat(Ce,"/login.action?os_destination=").concat(Object(r.location)().pathname.replace(Ce,"")))}Lr.configure({endpoint:("undefined"==typeof window?"http://localhost:8080":"".concat(mr().protocol,"//").concat(mr().host))+Ce,contextPath:Ce,onUnauthorized:Fr});var jr=Lr,Hr=(n("./src/editor-plugins/insertwiki/insert-wiki-markup.css"),function(){return!w("editor.insert-wiki-markdown")}),Ur={HELP_REST_API:"".concat(Ce,"/plugins/tinymce/helplink.action"),WIKI:{CONFLUENCE:{api:jr.getWikiConfluenceToXhtml,val:"CONFLUENCE",label:"confluence.conf_wikimarkup_confluence_label",helpLink:"help.insert.wiki.markup",restApi:"/rest/tinymce/1/wikixhtmlconverter"},MARKDOWN:{api:jr.getWikiMarkdownToXhtml,val:"MARKDOWN",label:"confluence.conf_wikimarkup_markdown_label",helpLink:"help.insert.wiki.markup.markdown",restApi:"/rest/tinymce/1/markdownxhtmlconverter"}}},Wr={dialog:{id:"insert-wiki-markup-dialog",content:"",width:980,height:500,popup:!1,name:"confluence.conf_wikimarkup_desc"},markupEditId:"insert-wiki-textarea",previewAreaId:"insert-wiki-textarea-preview",selectionMenuId:"wiki-parser-selection-tool",serverRequestTimer:300,entityId:M.get("content-id"),spaceKey:M.get("space-key")},zr=null,qr=function(){var e=Ln.get("insert-wiki-markup-dialog.parser","global","CONFLUENCE");return Ur.WIKI[e]},Vr=function(e,t){var n=c()(function(e,t,n){return'\n    <span class="wiki-parser-selector">\n        <form action="#" method="post" id="d" class="aui">\n            <select class="select medium-field" id="wiki-parser-selection-tool" name="wiki-parser-selection-tool" title="wiki parser selector">\n                <option value="'.concat(t.val,'">').concat(e(t.label),"</option>\n                ").concat(Object.keys(n).filter((function(e){return n[e].val!==t.val})).map((function(t){return'<option value="'.concat(n[t].val,'">').concat(e(n[t].label),"</option>")})),"\n            </select>\n        </form>\n    </span>\n")}(e,t,Ur.WIKI));return c()("#insert-wiki-insert-title").append(n),c()("#".concat(Wr.selectionMenuId))},$r=function(){var e=c()("#".concat(Wr.selectionMenuId));return e.length?e.val():qr().val},Kr=function(e){var t={wiki:(e=e||{}).textToConvert,entityId:Wr.entityId,spaceKey:Wr.spaceKey};e.api(JSON.stringify(t),(function(t,n){t?e.errorCallback(t):e.successCallback(n)}))},Jr=function(){var e=c()("#".concat(Wr.markupEditId)).val();c.a.trim(e)?Kr({api:Ur.WIKI[$r()].api,textToConvert:e,successCallback:function(e){zr.html(e)},errorCallback:function(){zr.html(Xr(e))}}):zr.html(e)},Gr=function(){var e,t,n,r=$r();Ln.set("insert-wiki-markup-dialog.parser","global","CONFLUENCE",r),e=r,t=c()("#".concat(Wr.dialog.id)).find(".dialog-help-link"),n=Ur.WIKI[e].helpLink,t.load(Ur.HELP_REST_API,{linkUrlKey:n}),Jr()};function Xr(e){if("string"!=typeof e)return"";var t={"<":"&lt;",">":"&gt;","&":"&amp;","'":"&#39;","`":"&#96;"};return e.replace(/[&"'<>`]/g,(function(e){return"string"==typeof t[e]?t[e]:"&quot;"}))}var Yr={init:function(e,t){var n;Wr.dialog.content=Hr()?'\n    <p id="insert-wiki-info-title">'.concat((n=function(e){return ve(e)})("tinymce.confluence.conf_wikimarkup_info_title"),'</p>\n    <form action=\'#\' method=\'post\' id="insert-wiki-markup-form" class="aui">\n        <h3 class="wiki-title">\n            <span id="insert-wiki-insert-title">').concat(n("tinymce.confluence.conf_wikimarkup.insert.label"),'</span>\n            <span id="insert-wiki-preview-title">').concat(n("tinymce.confluence.conf_wikimarkup_preview_label"),"</span>\n        </h3>\n        <textarea class='monospaceInput textarea' id='insert-wiki-textarea' name='wikitext'/>\x3c!--\n            --\x3e<div class='example-container' id='insert-wiki-textarea-preview'></div>\n    </form>\n"):" \n    <form action='#' method='post' id=\"insert-wiki-markup-form\" class=\"aui\">\n        <textarea class='monospaceInput textarea originalDefault' id='insert-wiki-textarea' name='wikitext'/>\n    </form>\n";var o=function(t){var n,o,i,a=Wr.dialog.id,s=$r();e.windowManager.setBusy(a,!1),r.tinymce.EditorManager.activeEditor.windowManager.close(a),Hr()&&(u("analytics",{name:"insert-wiki-markup-dialog.".concat(s)}),"MARKDOWN"===s&&(n=t,(o=c()(n)).find("img").addClass("confluence-embedded-image"),t=c()("<div>").append(o.clone()).html())),e.execCommand("mceInsertContent",!1,t),i=e,r.tinymce.each(i.dom.select("p > p"),(function(e){try{i.dom.split(e.parentNode,e)}catch(e){}}))},i=function(t,n,o){e.windowManager.setBusy(Wr.dialog.id,!1);var i=function(e,t){return"\n        <p class='warning'>\n            ".concat(e,"\n        </p>\n        <p class='exception-report'>\n            <span class='exceptionMessage'>\n                ").concat(t,"\n            </span>\n        </p>\n")}(e.translate("confluence.conf_wikimarkup_conversion_errors"),"timeout"===n?e.translate("confluence.conf_wikimarkup_timeout"):"".concat(Xr(n||t.message)," : ").concat(Xr(o)));r.tinymce.EditorManager.activeEditor.windowManager.alert(i)};e.addCommand("InsertWikiMarkup",(function(){var n=qr();if(e.windowManager.open(Wr.dialog,{buttons:[{label:"confluence.conf_insert_button_title",action:function(){e.windowManager.setBusy(Wr.dialog.id,!0),Kr({api:Ur.WIKI[$r()].api,successCallback:o,errorCallback:i,textToConvert:c()("#".concat(Wr.markupEditId)).val(),setBusy:!0})}}],plugin_url:t,helpLink:n.helpLink,hintText:"confluence.conf_wikimarkup_hint",cssClass:"insert-wiki-markup-panel"}),Hr()){var r;!function(e){var t=c()("#wysiwygTextarea_ifr").contents().find("head").html(),n=c()("<iframe tabindex='-1' id='insert-wiki-markup-preview' />");c()("#".concat(e)).append(n);var r=n.contents(),o=r[0];o.open(),o.write('\n    <!DOCTYPE html>\n    <html class="insert-wiki-markup-dialog">\n        <head>\n        </head>\n        <body class="wiki-content previewWiki">\n        </body>\n    </html>\n'),o.close(),r.find("head").html(t),zr=r.find("body")}(Wr.previewAreaId),Vr((function(t){return e.translate(t)}),n).on("change",Gr),c()("#".concat(Wr.markupEditId)).on("keydown",(function(){clearTimeout(r),r=setTimeout(Jr,Wr.serverRequestTimer)}))}})),e.addButton("insertwikimarkup",{title:"confluence.conf_wikimarkup_desc",cmd:"InsertWikiMarkup"})},getInfo:function(){return{longname:"InsertWikiMarkip",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com/",version:"1.1"}}};var Qr={fields:{string:{language:function(e,t){var n,o=c()(r.Confluence.Templates.MacroBrowser.macroParameterSelect()),i=c()("select",o);return null==t&&(t={}),t.setValue=function(e){if(0==i.find("option[value='".concat(e,"']")).length){var t=c()("<option/>");t.val(e),t.text(e),i.append(t)}},n=i,jr.getPluginCodeLanguages((function(e,t){if(!e&&t.length){var r=n.val();n.empty(),n.append(c()("<option/>").attr("value","")),t.forEach((function(e){var t=c()("<option />");t.val(e.aliases[0]),t.text(e.friendlyName),n.append(t)})),n.val(r)}})),new r.AJS.MacroBrowser.Field(o,i,t)}}}};function Zr(){var e;function t(){var t=c()("#breadcrumbs");t.detach(),!t.find(".edited-page-title").length&&e.length&&t.append(e),c()("#editor-precursor .cell").prepend(t)}if("comment"!==M.get("content-type")){var n=c()("#quickedit-breadcrumbs");n.length>0&&(c()("#breadcrumbs").detach(),n.attr("id","breadcrumbs"),c()("#breadcrumb-section").append(n)),e=c()(".edited-page-title").parent().detach(),t(),ne(r.document,"mode-changed",(function(n,r){var o;"preview"===r?(o=c()("#breadcrumbs").detach(),e.detach(),c()("#breadcrumb-section").append(o)):"richtext"===r&&t()}))}}var eo={};function to(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function no(e){return(no="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ro,oo,io=function(e){return function(t,n,r){var o=null!=r&&"object"!==no(r),i=null!=r?o?" = ".concat(r):" >":"";console.log("".concat(e," - ").concat(t," : ").concat(n||null).concat(i)),r&&!o&&console.log(r)}},ao=function e(t,n){var o=io("Autocompleter.Control"),i={},a=t.selection,s=a.getRng(!0),l=s.startOffset,u=s.startContainer,d=u.nodeValue,f=n.leadingChar,m=t.getDoc(),p=n.backWords||0,g=n.insertedFromMenu||!1,h=eo[f||"["],v=h&&void 0!==h.preventStartNodes?h.preventStartNodes:"div.code, a[href], img, pre";if(c()("#".concat("autocomplete"),m).length)return o("init","Autocomplete already exists, returning null."),null;i.backWords=p,i.maxResults=n.maxResults||10,null==d&&s.collapsed&&l&&u.childNodes[l-1]&&(l=(d=(u=u.childNodes[l-1]).nodeValue)&&d.length||0);var b="";if(null!=d){b="".concat(d).substring(0,l);for(var y=u.previousSibling;y&&3===y.nodeType;)b=y.nodeValue+b,y=y.previousSibling}var C;if(!p&&b&&!function(e,t){for(var n=0,r=t.length;n<r;n++)if(t[n].test(e))return!0;return!1}(b+f,[/([("'<\(\u201c\u2018]\[|[\ufeff\u200b\u2014\s\xa0].)$/,/(\([^!])$/,/(\/\/)$/]))return o("init","Cursor is in wrong word location to start autocomplete, returning null."),null;if(c()(u).closest(v).length)return o("init","Cursor is in wrong node to start autocomplete, returning null."),null;if(r.Confluence.PropertyPanel&&r.Confluence.PropertyPanel.current&&(r.Confluence.PropertyPanel.shouldCreate=!1,r.Confluence.PropertyPanel.destroy()),f||null!=d||(o("init","No text available for suggestion, range is",s),d=""),i.getContainer=function(){return c()("#".concat("autocomplete"),m)},s.collapsed&&p&&d){var w=function(e,t,n){var r,o;function i(e,t,n){!t.global&&(t=new RegExp(t.source,"g".concat("i".slice(0,t.ignoreCase)).concat("m".slice(0,t.multiLine)))),null==n?n=e.length:n<0&&(n=0);for(var r,o=e.substring(0,n+1),i=-1,a=0;null!=(r=t.exec(o));)i=r.index,t.lastIndex=++a;return i}for(var a=0;a<n;a++)for(t=i(r=e.nodeValue.substring(0,t),/\s+/,t);-1==t;){if(!(o=e.previousSibling)||3!==o.nodeType){a=n;break}e=o,(r=o.nodeValue)&&(t=i(r,/\s+/,r.length))}return{node:e,offset:t+1}}(u,l,p);if(r.tinymce.isIE&&1==p){var x=a.getRng();x.moveStart("character",w.offset-l),x.select()}else{var k=a.getRng(!0);k.setStart(w.node,w.offset),k.setEnd(u,l),a.setRng(k)}}C=a&&a.getNode()&&a.getNode().classList.contains("placeholder-inline-tasks")?"":a.getContent({format:"text"}).replace("\n",""),o("init","suggestionHtml",C);var T,E=function(e,t,n){var o=r.document.createElement(e);return t&&o.setAttribute("id",t),n&&o.appendChild(r.document.createTextNode(n)),o},S=E("span","autocomplete");if(n.classNames)if("string"==typeof n.classNames)(T=S.classList).add.apply(T,to(n.classNames.split(" ")));else if(Array.isArray(n.classNames)){var N;(N=S.classList).add.apply(N,to(n.classNames))}f&&S.appendChild(E("span","autocomplete-trigger",f));var A=E("span","autocomplete-search-text",r.AJS.Rte.HIDDEN_CHAR);S.appendChild(A),a.setNode(c()(S));var R=i.getContainer();i.previousSearchText="",i.settings=h,!1===h.cache||h.cacheManager?!1!==h.cache||h.cacheManager||(h.cacheManager={get:c.a.noop,put:c.a.noop}):h.cacheManager=new r.AJS.Confluence.localStorageCacheManager(h.ch);var _=c()("#".concat("autocomplete-search-text"),i.getContainer()),I=c()(m.createElement("span")).text(C||r.AJS.Rte.HIDDEN_CHAR);_.empty().append(I),a.select(I[0],!0),a.collapse();var B,P,D=function(e,t){if(i.onBeforeKey&&!i.onBeforeKey(t,i.text()))return r.tinymce.dom.Event.cancel(t),o("before","blocked by onBeforeKey: ".concat(t.keyCode)),!1},O=function(e,t){var n=a.getRng(!0),c=i.getContainer(),s=n.startContainer,l=s.parentNode;3===s.nodeType&&(l=l.parentNode);var u=l?l.parentNode:null,d=u?u.parentNode:null,f=l!==c[0]&&u!==c[0]&&d!==c[0];if(27===t.keyCode||f)o("after","dying because of: ".concat(f?"outside search span":"escape pressed")),i.die();else if(i.onAfterKey&&!i.onAfterKey(t,i.text()))return r.tinymce.dom.Event.cancel(t),o("after","blocked by onAfterKey: ".concat(t.keyCode)),!1},M=function(e,t){if(i.onKeyPress&&!i.onKeyPress(t,i.text()))return r.tinymce.dom.Event.cancel(t),o("press","blocked by onKeyPress: ".concat(t.keyCode)),!1},L=function(e,t){i.getContainer()[0]!=t.target.parentNode&&(o("click","Clicked outside of autocomplete, closing."),i.die())};t.onKeyDown.addToTop(D),t.onKeyUp.addToTop(O),t.onKeyPress.addToTop(M),t.onClick.addToTop(L),i.word="",n.keepAlias?o("init","No suggestion based on previous or selected text"):i.word=C,r.AJS.Rte.showElement(R[0]),B=r.tinymce.DOM.getPos(R[0]),P=R.height(),i.left=B.x,i.top=B.y+P,i.text=function(e){var t=c()("#".concat("autocomplete-search-text"),i.getContainer());return null!=e?(t.html(e),this):(e=r.AJS.escapeEntities(t.text())).replace(r.AJS.Rte.HIDDEN_CHAR,"")},i.plainText=function(e){var t=c()("#".concat("autocomplete-search-text"),i.getContainer());return null!=e?(t.text(e),this):(e=t.text()).replace(r.AJS.Rte.HIDDEN_CHAR,"")};var F=function(t,n){var r=i.getContainer();return e.replaceWithTextAndGetRange(r,t,n)};return i.replaceWithSelectedSearchText=function(){var e=i.text();return o("replaceWithSelectedSearchText",e),F(e,!1),e},i.die=function(e){if(i.dying)o("die","Already dying, returning.");else{if(i.dying=!0,r.Confluence.PropertyPanel&&(r.Confluence.PropertyPanel.shouldCreate=!0),i.getContainer().length){o("die","Tearing down autocomplete, cleaning up autocompleter");var a=(e||n.backWords||g?"":i.settings.ch)+i.text();s=F(a,!0)}setTimeout((function(){o("die","Removing autocomplete-control keyboard listeners."),t.onKeyDown.remove(D),t.onKeyUp.remove(O),t.onClick.remove(L),t.onKeyPress.remove(M)}),1),r.AJS.Rte.unbindScroll("autocomplete"),c()(r.document).unbind("click.autocomplete-outside"),this.onDeath&&this.onDeath()}},r.AJS.Rte.bindScroll("autocomplete",(function(e){o("scrolling:",e),r.AJS.Rte.isAnyPartShown(R)?i.onScroll():i.die()})),c()(r.document).bind("click.autocomplete-outside",(function(e){var t=e.srcElement&&"rte-insert-date"===e.srcElement.id;c()(e.target).closest("#autocomplete-dropdown, .aui-datepicker-dialog, .ui-datepicker-header").length||t||i.die()})),r.AJS.Rte.getEditor().onBeforeExecCommand.add((function(e,t){"mceConfSavePage"==t&&i.die()})),i.update=function(e){Se(),F("",!0),this.settings.update(this,e)},i.removeSpan=function(){i.getContainer().remove()},i};ao.removeOrphanedControl=function(){var e=c()(r.AJS.Rte.getEditor().getDoc()),t=e.find("#".concat("autocomplete"));if(!t.length)return null;var n=e.find("#".concat("autocomplete-trigger")).text(),o=e.find("#".concat("autocomplete-search-text")).text();return ao.replaceWithTextAndGetRange(t,o,!1),{leadingChar:n,content:o}},ao.replaceWithTextAndGetRange=function(e,t,n){if(e.length){t=t||"",n=n||!t;var o=r.AJS.Rte.getEditor(),i=e[0].parentNode,a=r.AJS.Rte.Content.getChildIndex(i,e[0]),c=n?1:0,s=o.selection.getRng(!0);return s.setStart(i,a+c),s.setEnd(i,a+1),e.before(t||r.AJS.Rte.HIDDEN_CHAR).remove(),o.selection.setRng(s),s}console.log("replaceWithTextAndGetRange Error: attempting to replace a non-existent element")},io("Autocompleter.Manager");var co=function(e){var t=eo[e.leadingChar];if(e=c.a.extend({minLengthForGetData:t.minLengthForGetData,displayHandler:t.displayHandler,Highlighter:t.Highlighter,classNames:t.autocompleteClassNames},e),!(ro=ao(r.AJS.Rte.getEditor(),e)))return!1;function n(e){return c.a.data(e,"properties")}u("synchrony.stop",{id:"confluence.autocomplete-plugin"});var o,i=c()(r.window).width(),a=function(e){var t,n,a=c()("#autocomplete-dropdown"),s=ro.getContainer();a.length||(a=c()("<div></div>").addClass("aui-dd-parent quick-nav-drop-down").attr("id","autocomplete-dropdown").appendTo("body"));var l=r.AJS.Position.spaceAboveBelow(r.AJS.Rte.getEditorFrame(),s);e.find("ol:has(a.menu-header)").addClass("top-menu-item"),e.find("ol:empty").hide(),a.append(e);var u=r.AJS.Rte.Content.offset(s),d=Math.max(a.width()+u.left-i+10,0),f=u.left-d-0,m=e.outerHeight(!0),p=m+10;o&&(function(e,t){return 1==o?e.above>=t:e.below>=t}(l,p)||(o=null)),o||(o=function(e,t){return e.below>=t?2:e.above>=t?1:e.below>e.above?2:1}(l,p)),(n=a.find(".autocomplete-dropdown-arrow")).length||(n=c()("<div>").addClass("autocomplete-dropdown-arrow").addClass(ro.settings.autocompleteClassNames)),1===o?(n.addClass("autocomplete-dropdown-bottom-arrow").css({top:m-1}),t=u.top-m-10):(n.removeClass("autocomplete-dropdown-bottom-arrow").css("top",""),t=u.top+s.height()+10),n.css({left:d}).appendTo(a),a.css({position:"absolute",top:t,left:f})};oo=r.AJS.inputDrivenDropdown({onShow:function(e){u("rte-autocomplete-on-show",{triggerChar:ro.settings.ch});var t=r.AJS.Rte.getEditorFrame();t&&t.shim&&t.shim.hide(),e.find("a.menu-header").unbind().click((function(e){e.preventDefault(),ro.die()})),this.reset(),ro.settings.selectFirstItem&&e.find("a:not('.menu-header')").length&&r.AJS.dropDown.current.moveDown()},dropdownPlacement:a,onDeath:function(){c()("#autocomplete-dropdown").remove()},ajsDropDownOptions:{selectionHandler:function(e,t){e.preventDefault();var r=n(t[0]);r&&"function"==typeof r.callback?r.callback(ro):"menu-header"!==r.className&&ro.update(r),ro.die()},moveHandler:function(e,t){var n=r.AJS.dropDown.current;e&&e.find("a").is(".menu-header")&&("up"==t?n.moveUp():n.moveDown())},className:"autocomplete ".concat(ro.settings.dropDownClassName),displayHandler:e.displayHandler,Highlighter:e.Highlighter},getDataAndRunCallback:function(e){ro&&ro.settings.getDataAndRunCallback&&ro.settings.getDataAndRunCallback(ro,e,(function(t,n,r,o){t.unshift([{className:"menu-header dropdown-prevent-highlight",href:"#",name:ro.settings.getHeaderText(ro,e)}]),t.push(ro.settings.getAdditionalLinks(ro,e,r)),oo&&oo.show(t,n,o||[n])}))},dropDownDelay:ro.settings.dropDownDelay,minLengthForGetData:ro.settings.minLengthForGetData}),ro.onBeforeKey=function(e,t){return 40===e.keyCode||38===e.keyCode||13===e.keyCode?(r.tinymce.dom.Event.cancel(e),!1):!(27===e.keyCode||9===e.keyCode||8===e.keyCode&&!t)||(this.die(8===e.keyCode),!1)},ro.onKeyPress=function(e){var t=String.fromCharCode(e.which);return 13===e.keyCode?(r.tinymce.dom.Event.cancel(e),!1):(this.settings.endChars.includes(t)&&ro.die(),!0)};var s=e.minLengthForGetData||2,l=new RegExp("\\S{".concat(s,",}"));ro.onAfterKey=function(e,t){if(40===e.keyCode||38===e.keyCode||13===e.keyCode){var n=r.AJS.dropDown.current;return!!n&&(-1==n.getFocusIndex()&&13===e.keyCode?(so(),!0):(e.which||(e.which=e.keyCode),n.moveFocus(e)))}var o=8===e.keyCode&&!t||d(t);return(o||l.test(t))&&oo.change(t,o),!0};var d=function(e){return/[\u4E00-\u9FFF]/gi.test(e)};return ro.onDeath=function(){oo&&(oo.remove(),oo.closing=!0),u("synchrony.start",{id:"confluence.autocomplete-plugin"})},ro.onScroll=function(){oo.dd&&a(oo.dd.$)},ro.getCurrentItem=function(){if(!oo||!oo.dd)return null;var e=oo.dd,t=e.getFocusIndex();return t<0?null:n(e.links[t])},oo.change(ro.text(),"force"),!0},so=function(){ro.die(),ro=null},lo={getInputDrivenDropdown:function(){return oo},triggerListener:function(e,t){if(t.metaKey)return!0;oo&&oo.closing&&(oo=null);var n=String.fromCharCode(t.which);return!oo&&n in eo&&co({leadingChar:n})&&r.tinymce.dom.Event.cancel(t),!0},shortcutFired:function(e,t){var n=t?0:1;return oo&&oo.closing&&(oo=null),oo&&(n=t?0:ro.backWords+1,so()),co({leadingChar:e,backWords:n})},reattach:function(){var e=ao.removeOrphanedControl();e&&lo.shortcutFired(e.leadingChar)}},uo=n("com.atlassian.confluence.restplugin:confluence-rest/require('confluence-rest/confluence-rest')"),fo=n.n(uo),mo=function(e,t){eo[e]=t},po=function(e,t,n){return"<a href='#' class='".concat(t||"","'><span class='icon ").concat(n||"","'></span><span>").concat(e,"</span></a>")},go=function(e,t,n,r,o){var i;if(e.statusMessage)i=[[{html:e.statusMessage,className:"error"}]];else{var a=t?fo.a.REST.makeRestMatrixFromSearchData(e):fo.a.REST.makeRestMatrixFromData(e,r);i=fo.a.REST.convertFromRest(a)}n(i,t,(function(e,t){o&&"function"==typeof o&&o(i,e,t)}))},ho=function(e,t,n,r,o,i,a){var s,l=t(r),u=e.settings.cacheManager,d=u.get(r);l?((s=c.a.ajax({type:"GET",url:l,data:n(e,r),dataType:"json",global:!1,timeout:5e3})).done((function(e){u.put(r,e)})),d?go(d,r,o,i,a):(s.done((function(e){go(e,r,o,i,a)})),s.fail((function(e,t){"timeout"==t&&go({statusMessage:"Timeout",query:r},r,o,i)})))):o([],r)};function vo(e){return(vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}"object"!==vo(o.a.Confluence)&&(o.a.Confluence={}),void 0===o.a.Confluence.Editor&&(o.a.Confluence.Editor={}),o.a.Confluence.Editor.Autocompleter={Settings:eo,log:io,Util:{dropdownLink:po,getRestData:ho},Control:ao,Manager:lo},Object(r.define)("confluence-editor/tinymce3/plugins/autocomplete/autocomplete-manager",(function(){return lo})),Object(r.define)("confluence-editor/tinymce3/plugins/autocomplete/autocomplete-settings",(function(){return{Settings:eo,log:io}}));var bo=function(e){e.onPostRender.add((function(){console.log("Autocomplete enabled, adding keyPress listener"),e.onKeyPress.addToTop(lo.triggerListener),u("ready-editor-autocomplete")})),e.onUndo.add(lo.reattach),e.onRedo.add(lo.reattach)};var yo=n("confluence.web.components:confluence/require('confluence/root')"),Co=function(e){return e?"".concat(Ce,"/rest/prototype/1/search.json"):M.get("remote-user")?"".concat(Ce,"/rest/prototype/1/session/history.json"):null},wo=function(e,t){var n={"max-results":e.maxResults};return t&&(n.query=Object(yo.unescapeEntities)(t),n.search="name",n.preferredSpaceKey=M.get("space-key")),n},xo=function(){return mo("[",{ch:"[",cache:!1,endChars:["]"],dropDownClassName:"autocomplete-links",selectFirstItem:!0,getHeaderText:function(){return ve("editor.autocomplete.links.header.text")},getAdditionalLinks:function(e,t,n){var o;if(t){var i=ve("editor.autocomplete.links.dialog.search");o=r.AJS.format(i,t)}else o=ve("editor.autocomplete.links.dialog.search.no.text");var a=r.Confluence.Editor.LinkBrowser,c=[{className:"search-for",name:o,href:"#",callback:function(e){e.replaceWithSelectedSearchText();var t=a.open({panelKey:a.SEARCH_PANEL});t.doSearch(t.getLocationPresenter().getRawLinkText())}},{className:"dropdown-insert-link",html:po(ve("editor.autocomplete.links.web.link"),"dropdown-prevent-highlight","editor-icon"),callback:function(e){e.replaceWithSelectedSearchText(),a.open({panelKey:a.WEBLINK_PANEL})}}];return n&&n(t,c),c},getDataAndRunCallback:function(e,t,n){ho(e,Co,wo,t,n,"content",(function(e,t,n){var o;t&&(e.length<2||("page"!==(o=e[1][0].restObj).type||o.space.key!=M.get("space-key")||o.title.toLowerCase()!==t.toLowerCase()))&&n.push({className:"insert-create-page-link",html:po(ve("editor.autocomplete.links.create.link"),"dropdown-prevent-highlight","editor-icon"),callback:function(e){var n=Object(yo.unescapeEntities)(t),o=r.Confluence.Link.createLinkToNewPage(n,M.get("space-key"));e.update(o)}})}))},update:function(e,t){t.restObj&&(t=r.Confluence.Link.fromREST(t.restObj)),t.insert()}})},ko=function(e){e.addCommand("mceConfAutocompleteLink",(function(){lo.shortcutFired("[")})),e.addShortcut("meta+shift+k",e.getLang("AutoComplete"),"mceConfAutocompleteLink"),xo()},To=n("com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js/require('confluence-macro-browser/macro-browser')"),Eo=n.n(To);function So(){return{init:function(e){!function(){function e(e){c()("#autocomplete-dropdown .top-menu-item").spin(e)}function t(){Eo.a.reset(),Eo.a.preLoadMacro()}function n(e,t){var n=t.presetMacroMetadata;e.replaceWithSelectedSearchText(),n?Eo.a.hasRequiredParameters(n)||n.alwaysShowConfig?Le.macroBrowserToolbarButtonClicked(t):(Se(),Oe.insertMacro({contentId:M.get("content-id")||"0",macro:{name:n.macroName,body:""}})):Le.macroBrowserToolbarButtonClicked(t)}function r(e){if(e.hidden&&!Eo.a.isHiddenMacroShown(e))return null;var t={className:"autocomplete-macro-".concat(e.macroName),callback:function(t){n(t,{ignoreEditorSelection:!0,presetMacroMetadata:e})}};return e.icon?(t.name=e.title,t.href="#",t.icon=(e.icon.relative?M.get("static-resource-url-prefix"):"")+e.icon.location):t.html=po(e.title),t}mo("{",{ch:"{",cache:!1,endChars:["}",":","{"],dropDownClassName:"autocomplete-macros",dropDownDelay:0,selectFirstItem:!0,getHeaderText:function(){return ve("editor.autocomplete.macros.header.text")},getAdditionalLinks:function(){return[{className:"dropdown-insert-macro",html:po(ve("editor.autocomplete.macros.dialog.browse"),"dropdown-prevent-highlight","editor-icon"),callback:function(e){var t=e.text();n(e,{searchText:t})}}]},getDataAndRunCallback:function(n,o,i){var a=Eo.a.getMetadataPromise(),s=this,l=arguments;function d(e){var t=[];return c()("#macro-insert-list li").each((function(n,o){var i=c()(o),a=e.find((function(e){return e.macroName===i.attr("data-macro-name")}));if(a){var s=r(a);s&&t.push(s)}})),t}function f(e){for(var t=[],o=Eo.a.searchSummaries(e,{keywordsField:"keywordsNoDesc"}),i=0,a=o.length;i<a;i++){var c=r(o[i]);if(c&&t.push(c)==n.maxResults)break}return t}function m(){var t;t=o?f(o):d(Eo.a.metadataList),e(!1),i([t],o)}function p(e){e.preventDefault(),e.stopPropagation(),u("analytics",{name:"autocomplete-macrobrowser.load-retry"}),t(),s.getDataAndRunCallback.apply(s,l)}s.alreadyBinded||(s.alreadyBinded=!0,a.always((function(){m(),s.alreadyBinded=!1})),a.fail((function(){u("analytics",{name:"autocomplete-macrobrowser.fail-to-load"}),g.a.messages.warning("#autocomplete-dropdown ol:nth(1)",{title:ve("editor.autocomplete.macros.error.load.header"),body:"<p><a id='macro-retry-link' href='#'>".concat(ve("editor.autocomplete.macros.error.load.retrylink"),"</a></p>")}),c()("#macro-retry-link").click(p),c()("#autocomplete-dropdown ol").eq(1).show()}))),"pending"===a.state()&&(i([],o),e(!0))},update:function(){throw new Error("All items in the Macro Autocomplete dropdown must have a callback function")}})}()},getInfo:function(){return{longname:"Auto Complete Macro",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}}var No=n("com.atlassian.confluence.editor:attachments-insert-utils-resources/require('confluence-editor/utils/attachments-insert-utils')"),Ao=n.n(No),Ro=n("confluence.web.resources:macro-js-overrides/require('confluence/macro-js-overrides')"),_o=n.n(Ro);function Io(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Bo=function(e){var t=M.get("content-id");return e?"".concat(Ce,"/rest/prototype/1/search.json"):+t?"".concat(Ce,"/rest/prototype/1/content/").concat(t,"/attachments.json"):null},Po=function(e,t){var n=r.AJS.MacroBrowser.getMacroMetadata("view-file")?[]:["image","word","excel","pdf","powerpoint","multimedia"];return t?{type:"attachment",attachmentType:n,search:"name","max-results":e.maxResults,query:t}:{attachmentType:n,"max-results":e.maxResults}},Do=function(){return mo("!",{ch:"!",cache:!1,endChars:["!"],dropDownClassName:"autocomplete-media",selectFirstItem:!0,getHeaderText:function(){return r.AJS.MacroBrowser.getMacroMetadata("view-file")?ve("editor.autocomplete.file.header.text"):ve("editor.autocomplete.media.header.text")},getAdditionalLinks:function(){var e=ve("editor.autocomplete.media.files.dialog.browse");return[{className:"dropdown-insert-image",html:po(e,"dropdown-prevent-highlight","editor-icon"),callback:function(e){e.replaceWithSelectedSearchText(),r.Confluence.Editor.defaultInsertImageDialog()}},{className:"dropdown-insert-macro",html:po(ve("editor.autocomplete.media.macros.dialog.browse"),"dropdown-prevent-highlight","editor-icon"),callback:function(e){e.replaceWithSelectedSearchText(),r.tinymce.confluence.macrobrowser.macroBrowserToolbarButtonClicked({selectedCategory:"media"})}}]},getDataAndRunCallback:function(e,t,n){ho(e,Bo,Po,t,n,"attachment")},update:function(e,t){u("rte-autocomplete-on-insert",{triggerChar:"!",selectedFile:t});var n=t.restObj,o=r.AJS.REST.wikiLink(n),i=n&&n.title||t.name;if("Image"==n.niceType){var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Io(e,t,n[t])}))}return e}({filename:i,contentId:t.ownerId||n.ownerId},o.params);r.tinymce.confluence.ImageUtils.insertFromProperties(a)}else{var c=!!r.AJS.MacroBrowser.getMacroMetadata("view-file"),s=n.contentType,l="VANILLA"!==M.get("confluence-flavour");if(c&&(l&&!(s&&"application/x-shockwave-flash"===s)||s&&("audio/mp3"===s||"video/mp4"===s)||"Multimedia"!==n.niceType)){var d={name:i,page:n.parentTitle,space:n.space?n.space.key:"",date:n.datePath,ownerId:n.ownerId};Ao.a.insertFilePlaceholder(d)}else this._insertFile(i,t,o)}},_insertFile:function(e,t,n){var o;switch(t.restObj.niceType){case"PDF Document":o="viewpdf";break;case"Word Document":o="viewdoc";break;case"Excel Spreadsheet":o="viewxls";break;case"PowerPoint Presentation":o="viewppt";break;case"Multimedia":o="multimedia"}var i={page:n.destination.substring(0,n.destination.indexOf("^")),name:e};_o.a.get("viewdoc").beforeParamsRetrieved(i),i.page||delete i.page;var a={contentId:M.get("content-id")||"0",macro:{name:o,params:i,body:""}};r.tinymce.confluence.MacroUtils.insertMacro(a)}})},Oo=function(){s("init.rte",(function(){s("rte-autocomplete-on-show",(function(e,t){"!"===t.triggerChar&&u("analytics",{name:"confluence.editor.autocomplete.trigger",data:{type:"media"}})})),s("rte-autocomplete-on-insert",(function(e,t){var n;"!"===t.triggerChar&&(n=t.selectedFile)&&n.name&&u("analytics",{name:"confluence.editor.autocomplete.insert",data:{extension:n.name.split(".").pop(),type:"media"}})}))})),s("rte-destroyed",(function(){l("rte-autocomplete-on-insert"),l("rte-autocomplete-on-show")}))},Mo=function(e){e.addCommand("mceConfAutocompleteImage",(function(){lo.shortcutFired("!")})),e.addShortcut("meta+shift+m",e.getLang("AutoComplete"),"mceConfAutocompleteImage"),Do(),Oo()};var Lo=function(){return{initContextToolbars:function(){var e,t,n,o,i,a,s=r.tinymce.activeEditor,l=vr(),u="aui-icon aui-icon-small aui-iconfont-",d=r.AJS.storageManager("atlassian.editor","tables"),f=function(e){var t=s.translate(e),n="".concat(e,"_shortcut"),r=s.translate(n);return r&&r!==n&&(t+=" (".concat(r,")")),t},m={Buttons:[new l.Group([new l.Button({text:f("table.row_before_desc"),iconClass:"".concat(u,"insert-row-before"),click:function(){r.tinymce.execCommand("mceTableInsertRowBefore",!1,"")}}),new l.Button({text:f("table.row_after_desc"),iconClass:"".concat(u,"insert-row-after"),click:function(){r.tinymce.execCommand("mceTableInsertRowAfter",!1,"")}}),new l.Button({text:f("table.delete_row_desc"),iconClass:"".concat(u,"remove-row"),click:function(){r.tinymce.execCommand("mceTableDeleteRow",!1,"")}})]),new l.Group([new l.Button({text:f("table.cut_row_desc"),iconClass:"".concat(u,"cut-table-row"),click:function(){r.tinymce.execCommand("mceTableCutRow",!1,""),s.plugins.customtoolbar.enableToolbarButton("aui-iconfont-paste-table-row")}}),new l.Button({text:f("table.copy_row_desc"),iconClass:"".concat(u,"copy-table-row"),click:function(){r.tinymce.execCommand("mceTableCopyRow",!1,""),s.plugins.customtoolbar.enableToolbarButton("aui-iconfont-paste-table-row")}}),new l.Button({text:f("table.paste_row_before_desc"),iconClass:"".concat(u,"paste-table-row"),click:function(){r.tinymce.execCommand("mceTablePasteRowBefore",!1,"")},disabled:!d.doesContain("copied")})]),new l.Group([new l.Button({text:f("table.col_before_desc"),iconClass:"".concat(u,"insert-column-before"),click:function(){r.tinymce.execCommand("mceTableInsertColBefore",!1,"")}}),new l.Button({text:f("table.col_after_desc"),iconClass:"".concat(u,"insert-column-after"),click:function(){r.tinymce.execCommand("mceTableInsertColAfter",!1,"")}}),new l.Button({text:f("table.delete_col_desc"),iconClass:"".concat(u,"remove-column"),click:function(){r.tinymce.execCommand("mceTableDeleteCol",!1,"")}})]),new l.Group([new l.Button({text:f("table.merge_cells_desc"),iconClass:"".concat(u,"merge-table-cells"),click:function(){r.tinymce.execCommand("mceTableMergeCells",!1,"")}}),new l.Button({text:f("table.split_cells_desc"),iconClass:"".concat(u,"split-merged-table-cells"),click:function(){r.tinymce.execCommand("mceTableSplitCells",!1,"")}})]),new l.Group([new l.Button({text:f("table.row_highlight"),iconClass:"".concat(u,"heading-row"),click:function(){r.tinymce.execCommand("confTableRowToggleHeading",!1),r.tinymce.execCommand("mceTableUpdateNumberingCol",!1)}}),new l.Button({text:f("table.col_highlight"),iconClass:"".concat(u,"heading-column"),click:function(){r.tinymce.execCommand("confTableColumnToggleHeading",!1)}}),new l.Button({text:f("table.numbering_column_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-insert-numbered-column",id:"insert-numbering-column",click:function(){r.tinymce.execCommand("mceTableInsertNumberingCol",!1,"")}})]),new l.SplitGroup([new l.Button({text:f("table.selection_highlight"),iconClass:"".concat(u,"paint-bucket"),click:function(){r.tinymce.execCommand("confTableSelectionToggleHighlight",!1)}})],{id:"table-highlight-group",dropDownOptions:{id:"table-highlight-colour",dropDownContent:(e=c()("<ul/>").addClass("table-highlight-picker"),t=[s.getLang("table.cell_color_grey"),s.getLang("table.cell_color_red"),s.getLang("table.cell_color_green"),s.getLang("table.cell_color_blue"),s.getLang("table.cell_color_yellow"),s.getLang("table.cell_color_clear")],n=[!1,!1,!1,!1,!1,!0],c.a.each(["grey","red","green","blue","yellow",""],(function(r,o){var i=c()("<li/>"),a=c()("<a href='#'></a>");n[r]?a.addClass("remove-highlight").attr("data-remove-highlight",!0):a.addClass("highlight-".concat(o)).attr("data-highlight-colour",o),a.attr("title",t[r]),a.attr("aria-label",t[r]),a.tooltip(),i.append(a),e.append(i)})),e),alignment:"right"},postProcess:function(e){e.attr("data-highlight-colour","grey"),e.addClass("highlight-grey");var t=c()("<span>&nbsp;</span>");t.addClass("highlight-indicator"),e.find(".icon.aui-iconfont-paint-bucket").after(t)}}),new l.Group([new l.Button({text:f("table.del"),iconClass:"".concat(u,"remove-table"),click:function(){r.tinymce.execCommand("mceTableDelete",!1,"")}})])],Events:Cr},p=function(e){var t=c()(e).closest("td,th"),n=c()(".mceSelected",t.closest("table"));!function(e){function t(e,t){return parseInt(e.attr(t),10)}return e.filter((function(){var e=c()(this);return t(e,"rowspan")>1||t(e,"colspan")>1})).length>=1}(t.add(n))?s.plugins.customtoolbar.disableToolbarButton("aui-iconfont-table-split"):s.plugins.customtoolbar.enableToolbarButton("aui-iconfont-table-split")};function g(e){var t=c()(this),n=c()("#table-highlight-group"),r=n.attr("data-highlight-colour"),o=n.attr("data-remove-highlight");r&&(n.removeClass("highlight-".concat(r)),n.removeAttr("data-highlight-colour")),n.removeClass("remove-highlight"),o&&n.removeAttr("data-remove-highlight");var i=t.attr("data-highlight-colour");i&&(n.addClass("highlight-".concat(i)),n.attr("data-highlight-colour",i)),t.attr("data-remove-highlight")&&(n.addClass("remove-highlight"),n.attr("data-remove-highlight",!0)),s.focus(),s.execCommand("confTableSelectionToggleHighlight",!1,{alwaysHighlight:!0}),e.preventDefault()}return s.on("NodeChange",(function(e){var t,n=e.element,i=c()("body"),a=!i.hasClass("no-tools")||i.hasClass("no-tools-toolbars-visible");o||null==n.parentNode||"BODY"===n.nodeName||(o=!0,t=n,c()(t).closest("table:not(.wysiwyg-macro)").length?(oe(r.document,"createContextToolbarRow.Toolbar",{buttons:m.Buttons,topToolbar:!0,animate:a}),oe(r.document,"enableContextToolbarRow.Toolbar",{id:"default"}),function(e){c.a.fn.updateTableModeInToolbar&&c()(e).closest("table").updateTableModeInToolbar()}(n),p(n),function(e){c()(e).closest("table").find(".numberingColumn").length>0?c()("#insert-numbering-column").addClass("active"):c()("#insert-numbering-column").removeClass("active")}(n)):oe(r.document,"disableContextToolbarRow.Toolbar",{animate:a}),o=!1)})),s.on("Undo",(function(){s.nodeChanged()})),s.initialized?c()(r.document).delegate("#table-highlight-colour .aui-dropdown a","click",g):s.on("init",(function(){c()(r.document).delegate("#table-highlight-colour .aui-dropdown a","click",g)})),s.on("Remove",(function(){c()(r.document).undelegate("#table-highlight-colour .aui-dropdown a","click",g)})),m.Buttons.splice(0,0,new l.Group([new l.DropDownButton({id:"table-mode-picker",text:f("table.auto_width"),dropDownContent:(i=c()("<ul/>").addClass("table-mode-list"),a=[{name:f("table.responsive"),mceCmd:"mceAutoWidth",tooltip:f("table.responsive_tooltip")},{name:f("table.fixed_width"),mceCmd:"mceFixedWidth",tooltip:f("table.fixed_width_tooltip")}],c.a.each(a,(function(e,t){var n=c()("<li/>").addClass("dropdown-item").attr("data-tooltip",t.tooltip),o=c()("<a href='#'>".concat(t.name,"</a>")).addClass("item-link");n.on("click",(function(){r.tinymce.execCommand(t.mceCmd,!1,"")})),i.append(n.append(o))})),i)})])),w("confluence-table-enhancements.copy-cut-paste-cols.disabled")||m.Buttons.splice(3,0,new l.Group([new l.Button({text:f("table.col_cut_desc"),iconClass:"".concat(u,"cut-table-column"),click:function(){r.tinymce.execCommand("mceTableCutCol",!1,""),s.plugins.customtoolbar.enableToolbarButton("aui-iconfont-paste-table-column")}}),new l.Button({text:f("table.col_copy_desc"),iconClass:"".concat(u,"copy-table-column"),click:function(){r.tinymce.execCommand("mceTableCopyCol",!1,""),s.plugins.customtoolbar.enableToolbarButton("aui-iconfont-paste-table-column")}}),new l.Button({text:f("table.col_paste_desc"),iconClass:"".concat(u,"paste-table-column"),click:function(){r.tinymce.execCommand("mceTablePasteColBefore",!1,"")},disabled:!d.doesContain("copied")})])),m}}};function Fo(){var e=function(e){this.fileTypes=e};e.prototype.beforeParamsSet=function(e){if(!e.page&&!e.date&&!e.space){var t=M.get("content-type");"page"==t||"blogpost"==t?e.page=r.document.getElementById("content-title").value:"comment"==t&&(e.page=M.get("page-title"))}if(e.date){var n=e.date.split("/");e.page=["",n[2],n[0],n[1],e.page].join("/")}return e.space&&(e.page="".concat(e.space,":").concat(e.page)),e},e.prototype.beforeParamsRetrieved=function(e){if(e.page){var t=e.page.split(":");t.length>1&&(e.space=t[0],e.page=t[1]);var n=e.page.split("/");n.length>1&&(e.date=[n[2],n[3],n[1]].join("/"),e.page=n[4]);var o=M.get("content-type");(("page"==o||"blogpost"==o)&&e.page==r.document.getElementById("content-title").value||"comment"==o&&e.page==M.get("page-title"))&&delete e.page}return e},e.prototype.fields={attachment:function(e){var t={fileTypes:this.fileTypes},n=r.AJS.MacroBrowser.ParameterFields.attachment(e,t);return n.dependencyUpdated=function(e,t){var n,o,i=(n={},o=t.split(":",2),n.spaceKey=2==o.length&&o[0]||M.get("space-key"),n.title=o[o.length-1],0==n.title.indexOf("/")&&(n.postingDay=n.title.substr(1,10),n.title=n.title.substr(12)),n.title==r.document.getElementById("content-title").value&&(n.title=""),n.title||(M.get("new-page")?n.draftId=M.get("content-id"):n.pageId=M.get("page-id")),n);this.getData(i)},n},spacekey:function(e){return r.AJS.MacroBrowser.ParameterFields._hidden(e,{})},date:function(e){return r.AJS.MacroBrowser.ParameterFields._hidden(e,{})},"confluence-content":function(e){return r.AJS.MacroBrowser.ParameterFields["confluence-content"](e,{dependencies:["name"]})}},r.AJS.MacroBrowser.Macros.viewdoc=new e(["doc","docx"]),r.AJS.MacroBrowser.Macros.viewpdf=new e(["pdf"]),r.AJS.MacroBrowser.Macros.viewxls=new e(["xls","xlsx"]),r.AJS.MacroBrowser.Macros.viewppt=new e(["ppt","pptx"]),r.AJS.MacroBrowser.Macros.viewfile={updateSelectedMacro:function(e){var t=e.params[""]||e.params.name;if(t){var n=t.lastIndexOf(".");if(n>0){var r=t.substring(n+1);r&&("doc"==r&&"docx"==r&&(e.name="viewdoc"),"pdf"==r&&(e.name="viewpdf"),"ppt"==r&&"pptx"==r&&(e.name="viewppt"),"xls"==r&&"xlsx"==r&&(e.name="viewxls"))}}}}}n("./src/editor-plugins/status-macro/editor.scss");var jo,Ho,Uo,Wo,zo="macro-placeholder-property-panel-edit-button",qo="status-macro-title first last editable",Vo=13,$o=27,Ko="status",Jo=["Grey","Red","Yellow","Green","Blue"],Go=Jo[0];function Xo(){Yo();var e=r.Confluence.MacroParameterSerializer.deserialize(c()(Ho).attr("data-macro-parameters")),t=!1,n=!1;return e&&Uo&&(t=e.title!==Uo.title,n=e.colour!==Uo.colour),t||n}function Yo(){if(Wo){var e=Zo(Uo)==Wo.val(),t=""===Wo.val();e||t?delete Uo.title:Uo.title=Wo.val()}}function Qo(){if(!jo||!jo.state||"pending"!==jo.state()){Yo();var e={contentId:r.Confluence.Editor.getContentId(),macro:{name:Ko,params:Uo,defaultParameterValue:"",body:""}};(jo=r.tinymce.confluence.MacroUtils.insertMacro(e,Ho)).done((function(e,t){var n;n=Ho=e,r.tinymce.activeEditor.selection.select(n),Se(),r.tinymce.activeEditor.selection.collapse()})).fail((function(e){0}))}}function Zo(e){return e.colour||e.color||Go}function ei(e){var t=c()("<input/>");return t.attr("class",qo),t.keyup((function(e){return e.keyCode!==Vo||(r.Confluence.PropertyPanel.destroy(),!1)})),t.keydown((function(e){return e.keyCode!==$o||(Wo=null,!0)})),t}function ti(e){(Wo=ei()).val(e.find("span.panel-button-text").text()),e.replaceWith(Wo),Wo.select().focus()}function ni(e){var t=function(e){for(var t=0;t<e.length;t++)if(e[t].className.indexOf(zo)>-1)return e[t];return null}(e),n=function(e){Le.editMacro(c()(e))};t.click=function(){r.Confluence.PropertyPanel.destroy(),Xo()?jo.always(n):n(Ho)}}var ri=[function(){var e;function t(){}function n(t){!e&&o.a&&o.a.console&&(e=!0,console.log("Deprecated TinyMCE API call: ".concat(t)))}function i(e,r,o,i){e=e||this;var a=[];r?(this.add=function(t,c,s){function l(n){var a=[];if("string"==typeof o&&(o=o.split(" ")),o&&"function"!=typeof o)for(var s=0;s<o.length;s++)a.push(n[o[s]]);("function"!=typeof o||(a=o(r,n,e)))&&(o||(a=[n]),a.unshift(i||e),!1===t.apply(c||i||e,a)&&n.stopImmediatePropagation())}n("<target>.on".concat(r,".add(..)")),e.on(r,l,s);var u={original:t,patched:l};return a.push(u),l},this.addToTop=function(e,t){this.add(e,t,!0)},this.remove=function(t){return a.forEach((function(n,o){if(n.original===t)return a.splice(o,1),e.off(r,n.patched)})),e.off(r,t)},this.dispatch=function(){return e.fire(r),!0}):this.add=this.addToTop=this.remove=this.dispatch=t}function a(e){function o(t,n){r.tinymce.each(t.split(" "),(function(t){e["on".concat(t)]=new i(e,t,n)}))}function a(e,t,n){return[t.level,n]}function c(e){return function(t,n){if(!n.selection&&!e||n.selection==e)return[n]}}if(!e.controlManager){e.controlManager={buttons:{},setDisabled:function(e,t){n("controlManager.setDisabled(..)"),this.buttons[e]&&this.buttons[e].disabled(t)},setActive:function(e,t){n("controlManager.setActive(..)"),this.buttons[e]&&this.buttons[e].active(t)},onAdd:new i,onPostRender:new i,add:function(e){return e},createButton:l,createColorSplitButton:l,createControl:l,createDropMenu:l,createListBox:l,createMenuButton:l,createSeparator:l,createSplitButton:l,createToolbar:l,createToolbarGroup:l,destroy:t,get:t,setControlType:l},o("PreInit BeforeRenderUI PostRender Load Init Remove Activate Deactivate","editor"),o("Click MouseUp MouseDown DblClick KeyDown KeyUp KeyPress ContextMenu Paste Submit Reset"),o("BeforeExecCommand ExecCommand","command ui value args"),o("PreProcess PostProcess LoadContent SaveContent Change"),o("BeforeSetContent BeforeGetContent SetContent GetContent",c(!1)),o("SetProgressState","state time"),o("VisualAid","element hasVisual"),o("Undo Redo",a),o("NodeChange",(function(t,n){return[e.controlManager,n.element,e.selection.isCollapsed(),n]}));var s=e.addButton;e.addButton=function(t,n){var o,i,a,c;function l(){if(e.controlManager.buttons[t]=this,o)return o.apply(this,arguments)}for(var u in n)"onpostrender"===u.toLowerCase()&&(o=n[u],n.onPostRender=l);return o||(n.onPostRender=l),n.title&&(n.title=(i=n.title,a=[e.settings.language||"en",i].join("."),c=r.tinymce.i18n.translate(a),a!==c?c:r.tinymce.i18n.translate(i))),s.call(this,t,n)},e.on("init",(function(){var t=e.undoManager,n=e.selection;t.onUndo=new i(e,"Undo",a,null,t),t.onRedo=new i(e,"Redo",a,null,t),t.onBeforeAdd=new i(e,"BeforeAddUndo",null,t),t.onAdd=new i(e,"AddUndo",null,t),n.onBeforeGetContent=new i(e,"BeforeGetContent",c(!0),n),n.onGetContent=new i(e,"GetContent",c(!0),n),n.onBeforeSetContent=new i(e,"BeforeSetContent",c(!0),n),n.onSetContent=new i(e,"SetContent",c(!0),n)})),e.on("BeforeRenderUI",(function(){var t=e.windowManager;t.onOpen=new i,t.onClose=new i,t.createInstance=function(e,t,o,i,a,c){return n("windowManager.createInstance(..)"),new(r.tinymce.resolve(e))(t,o,i,a,c)}}))}function l(){var e={};function t(){return l()}return n("editor.controlManager.*"),r.tinymce.each("add addMenu addSeparator collapse createMenu destroy displayColor expand focus getLength hasMenus hideMenu isActive isCollapsed isDisabled isRendered isSelected mark postRender remove removeAll renderHTML renderMenu renderNode renderTo select selectByIndex setActive setAriaProperty setColor setDisabled setSelected setState showMenu update".split(" "),(function(n){e[n]=t})),e}}r.tinymce.util.Dispatcher=i,r.tinymce.onBeforeUnload=new i(r.tinymce,"BeforeUnload"),r.tinymce.onAddEditor=new i(r.tinymce,"AddEditor","editor"),r.tinymce.onRemoveEditor=new i(r.tinymce,"RemoveEditor","editor"),r.tinymce.util.Cookie={get:t,getHash:t,remove:t,set:t,setHash:t},r.tinymce.on("SetupEditor",(function(e){a(e.editor)})),r.tinymce.PluginManager.add("compat3x",a),r.tinymce.addI18n=function(e,t){var n=r.tinymce.util.I18n,o=r.tinymce.each;"string"!=typeof e||-1!==e.indexOf(".")?r.tinymce.is(e,"string")?o(t,(function(t,r){n.data["".concat(e,".").concat(r)]=t})):o(e,(function(e,t){o(e,(function(e,r){o(e,(function(e,o){"common"===r?n.data["".concat(t,".").concat(o)]=e:n.data["".concat(t,".").concat(r,".").concat(o)]=e}))}))})):n.add(e,t)}},function(){s("init.rte",C)},function(){r.tinymce.PluginManager.add("aePaste",ie)},function(){r.tinymce.create("tinymce.plugins.ConfList",{init:function(e){e.editorCommands.addCommands({outdent:function(){var t=e.selection,n=e.dom;function r(t){return(t=n.getParent(t,n.isBlock))&&parseInt(e.dom.getStyle(t,"margin-left")||0,10)+parseInt(e.dom.getStyle(t,"padding-left")||0,10)>0}return r(t.getStart())||r(t.getEnd())||e.queryCommandState("InsertOrderedList")||e.queryCommandState("InsertUnorderedList")||e.queryCommandState("InsertInlineTaskList")}},"state")}}),r.tinymce.PluginManager.add("conflist",r.tinymce.plugins.ConfList)},function(){r.tinymce.PluginManager.add("tasklist",(function(e){var t=function(){var t=qe(e);t&&function(t){var n=e.dom.getParent(t.parentElement,"UL");return t&&"UL"===t.tagName&&n&&n.classList.contains("inline-task-list")&&t!=n}(t)&&function(e){return We(e.childNodes).every((function(e){return e.hasAttribute("data-inline-task-id")}))}(t)&&e.undoManager.ignore((function(){t.classList.add("inline-task-list")}))},n=function(){"page"!==M.get("content-type")&&"blogpost"!==M.get("content-type")&&"template"!==M.get("content-type")||e.undoManager.transact((function(){$e(qe(e))&&(e.execCommand("InsertOrderedList"),Ke(qe(e))),function(e){var t=e.dom.uniqueId();e.execCommand("InsertUnorderedList",!1,{"list-attributes":{"data-task-list-id":t,class:"inline-task-list"},"list-item-attributes":{"data-inline-task-id":""}}),e.dom.select('[data-task-list-id="'.concat(t,'"]')).forEach((function(t){var n=t.querySelectorAll("li")[0];n&&e.dom.isEmpty(t)&&(n.innerHTML="<span class='placeholder-inline-tasks'>".concat(ve("tinymce.confluence.placeholder.inline.tasks"),"</span>"),e.selection.select(n.firstChild,!0)),t.removeAttribute("data-task-list-id")}))}(e)}))};function o(t,n){if(!Je()){var r=n.handlerManager,o=n.createHandler;r.registerHandler("]".charCodeAt(0),o(ze,(function(){e.execCommand("InsertInlineTaskList")}),!0))}}function i(){e.addQueryStateHandler("InsertInlineTaskList",(function(){return Ve(qe(e))})),e.addQueryStateHandler("InsertUnorderedList",(function(){return $e(qe(e))}))}function a(t,n,r){if(Je()){var o=e.dom.createFragment();o.appendChild(r.node),Array.prototype.slice.call(o.querySelectorAll("ul.inline-task-list, ol.inline-task-list")).forEach((function(e){return Ke(e)}))}}e.addCommand("InsertInlineTaskListNoToggle",(function(){Ve(qe(e))||n()})),e.addCommand("InsertInlineTaskList",n),e.on("BeforeExecCommand",(function(t){"InsertUnorderedList"===t.command&&Ve(qe(e))&&!t.value?e.undoManager.ignore((function(){e.execCommand("InsertOrderedList"),Ke(qe(e))})):"InsertOrderedList"!==t.command||t.value||e.undoManager.ignore((function(){Ke(qe(e))}))})),e.on("execCommand",(function(e){"Indent"===e.command&&t()})),e.on("Click",(function(t){var n=t.target;if("LI"===n.tagName){var o=e.dom.getParent(n,"ul,ol");"UL"===o.tagName&&e.dom.hasClass(o,"inline-task-list")&&function(t,n){var o,i;if(r.tinymce.Env.gecko){var a=n.getBoundingClientRect();o=t.pageX-(a.left+r.tinymce.DOM.getViewPort(e.getWin()).x),i=t.pageY-(a.top+r.tinymce.DOM.getViewPort(e.getWin()).y)}else o=t.offsetX,i=t.offsetY;return o>=3&&o<=14&&i>=3&&i<=14}(t,n)&&(e.dom.hasClass(n,"checked")?e.dom.removeClass(n,"checked"):e.dom.addClass(n,"checked"))}})),e.on("KeyUp",(function(t){if(t.keyCode===r.tinymce.util.VK.ENTER&&!t.shiftKey){var n=(o=e.selection.getStart())&&o.tagName&&"LI"===o.tagName.toUpperCase()?o:e.dom.getParent(o,"li");n&&(e.dom.removeClass(n,"checked"),e.dom.hasClass(n.parentNode,"inline-task-list")?n.setAttribute("data-inline-task-id",""):n.removeAttribute("data-inline-task-id"))}var o})),e.on("KeyDown",(function(e){e.shiftKey||e.keyCode!==r.tinymce.util.VK.TAB||r.tinymce.util.VK.metaKeyPressed(e)||t()})),s("confluence.editor.registerHandlers",o),s("rte-ready",i),ne(r.document,"postPaste",a),e.on("Remove",(function(){l("confluence.editor.registerHandlers",o),l("rte-ready",i),re(r.document,"postPaste",a)}))}))},function(){s("init.rte",rn)},function(){r.tinymce.create("tinymce.plugins.DeleteCommandPlugin",{init:function(e){e.addCommand("mceDelete",(function(t,n){(function(){if(r.tinymce.Env.webkit){var t=e.selection.getRng(1);if(t.collapsed)return!1;var n=c()(t.startContainer).closest(".wysiwyg-macro-body",e.getBody())[0];if(n&&He.isRangeAtStartOf(n,t)&&He.isRangeAtEndOf(n,t)){var o=c()(n.firstChild).is("pre")?"pre":"p",i=c()("<".concat(o,"><br data-mce-bogus='1'></").concat(o,">"))[0];return c()(n).html(i),e.selection.select(i,1),!0}}return!1})()||e.getDoc().execCommand("Delete",t,n)}))},getInfo:function(){return{longname:"Delete Command Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("deletecommand",r.tinymce.plugins.DeleteCommandPlugin)},function(){},function(){var e,t,n,i=(e=o.a.Raphael,t=new r.tinymce.util.Dispatcher,n=r.tinymce.Env.ie,{AUIWindowManager:{init:function(e){e.on("init",(function(){e.windowManager=new r.tinymce.AUIWindowManager(e)}))},getInfo:function(){return{longname:"AUIWindowManager",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}},WindowManager:{AUIWindowManager:function(e){var n=this;n.eventDispatcher=t,n.editor=e,n.params={},n.features={},n.modalDialogsStack=[],n.dialogs={},n.count=0},open:function(e,t){var o=this;e=e||{},o.initialiseSettings(e),t=t||{},(t=this.setDefaultParameters(t)).mce_width=e.width,t.mce_height=e.height,t.mce_auto_focus=e.auto_focus,n&&(e.center=!0,e.help=!1,e.dialogWidth="".concat(e.width,"px"),e.dialogHeight="".concat(e.height,"px")),o.features=e,o.params=t,o.eventDispatcher.dispatch("open",{t:o,settings:e,params:t});var i=e.height;e.name&&(i+=56),(t.cancelLink||t.buttons)&&(i+=51),i+=40,e.popup&&(i+=8);var a=e.id||r.tinymce.DOM.uniqueId(),s=(new hr).component({width:e.width,height:i,id:a,onCancel:function(){s.hide().remove()}});e.name&&s.addHeader(this.editor.translate(e.name)),this.createDialogButtons(s,t,a),e.file=e.file||e.url,e.file&&(e.file=e.file),this.createDialogContent(s,e,t,a),t.helpLink&&this.createHelpLink(s,t.helpLink,t.helpName,a),t.hintText&&this.createHintText(s,t.hintText,a);var l={id:a,settings:e,params:t,dialog:s};return this.modalDialogsStack.push(l),this.dialogs[a]=l,this.count++,Se(),s.show(),null!=s.takeFocus&&s.takeFocus(),n&&(c()("#".concat(a)).css("overflow","hidden"),c()("#".concat(a,".").concat(t.cssClass)).css("overflow","hidden")),a},initialiseSettings:function(e){e.width=parseInt(e.width||400,10),e.height=parseInt(e.height||250,10),e.resizable=!1,null==e.popup&&(e.popup=!0),e.popup&&null!=e.content&&(e.popup=!1),e.scrollbars?e.scrollbars="yes":e.scrollbars="no"},createDialogButtons:function(e,t,n){if(t.buttons)for(var o=0;o<t.buttons.length;o++){var i=t.buttons[o];e.addButton(this.editor.translate("".concat(i.label)),i.action)}t.cancelLink&&e.addCancel(this.editor.translate("auiwindowmanager.cancel"),(function(){return r.tinymce.activeEditor.windowManager.close(n)}))},createDialogContent:function(e,t,n,r){var o=this.createContentId(r),i="panel_".concat(o);t.popup?(e.addPanel(i,c()('<iframe id="'.concat(o,'" width="100%" height="').concat(t.height,'px" frameborder="0" name="auidialogiframe" src="').concat(t.file,'" scrolling="').concat(t.scrollbars,'"></iframe>')),n.cssClass),e.takeFocus=function(){c()("#".concat(o)).focus()}):(null==t.content?(e.addPanel(i,c()('<div id="'.concat(o,'"/>')),n.cssClass),c()("#".concat(o)).load(t.file)):e.addPanel(i,c()('<div id="'.concat(o,'">').concat(t.content,"</div>")),n.cssClass),e.takeFocus=function(){var e=c()("#".concat(o,":input"));if(e.length)c()(e[0]).focus();else{var t=c()("#".concat(o," .button-panel button"));t.length&&c()(t[0]).focus()}}),e.gotoPanel(0,0)},createHintText:function(e,t,n){var o=c()("<div></div>").addClass("dialog-tip");o.text(r.tinymce.activeEditor.translate("".concat(t))),c()("#".concat(n," .dialog-button-panel")).append(o)},createHelpLink:function(e,t,n,r){var o=c()("<div></div>").addClass("dialog-help-link");o.load("".concat(Ce,"/plugins/tinymce/helplink.action"),{linkUrlKey:t,linkNameKey:n||""}),c()("#".concat(r," .dialog-components .dialog-title")).prepend(o)},close:function(e,t){var n,o;return"string"==typeof e?n=e:t?n=t:(o=this.modalDialogsStack.pop())&&(n=o.id),this.dialogs[n]&&(this.count--,(o=this.dialogs[n]).dialog.remove(),this.dialogs[n]=null,r.tinymce.activeEditor.focus(),Ne()),!1},alert:function(e,t,n){if("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."!==e){var o,i={content:"<p>".concat(e,"</p>"),width:500,height:160,popup:!1},a={buttons:[{label:"auiwindowmanager.ok",action:function(){r.tinymce.activeEditor.windowManager.toggleOtherDialogs(o,!0),r.tinymce.activeEditor.windowManager.close(o),t&&t.call(n||this)}}],cancelLink:!1,cssClass:"tinymce-auidialog-alert"};o=this.open(i,a),this.toggleOtherDialogs(o,!1)}},createInstance:function(e,t,n,o,i,a){return new(r.tinymce.resolve(e))(t,n,o,i,a)},toggleOtherDialogs:function(e,t){for(var n=0;n<this.modalDialogsStack.length;n++){var r=this.modalDialogsStack[n];r.id!=e&&c()("".concat(r.id," .dialog-button-panel")).toggle(t)}},confirm:function(e,t,n,r){r=r||o.a,t.call(n||this,r.confirm(this._decode(this.editor.translate(e))))},setBusy:function(t,n){var r=this.dialogs[t],o="#".concat(this.createBusyContentId(t)),i="#".concat(this.createContentId(t)),a=c()(i),s=c()(o);if(r)if(n){var l=c()(i);l.hide();var u=l.parent(),d=c()(o,u);d.length||(u.append(c()('<div id="'.concat(o,'" class="spinner"></div>'))),d=c()(o,u),e.spinner(d[0],50,"#666")),c()(".button-panel button",c()("#".concat(t))).each((function(e,t){c()(t).prop("disabled",!0)})),c()(d[0]).show()}else s.length&&s.hide(),c()(".button-panel button",c()("#".concat(t))).each((function(e,t){c()(t).prop("disabled",!1)})),a.show()},logMCESelection:function(e){r.tinymce.activeEditor.selection},setDefaultParameters:function(e){return e.inline=!1,e.cssClass||(e.cssClass="tinymce-auidialog"),0!=e.cancelLink&&(e.cancelLink=!0),e},createContentId:function(e){return"content_".concat(e)},createBusyContentId:function(e){return"content_busy_".concat(e)},resizeBy:function(){}}});r.tinymce.create("tinymce.plugins.AUIWindowManager",i.AUIWindowManager),r.tinymce.create("tinymce.AUIWindowManager:tinymce.WindowManager",i.WindowManager),r.tinymce.PluginManager.add("auiwindowmanager",r.tinymce.plugins.AUIWindowManager)},function(){var e;e=be(),r.Confluence.PropertyPanel.TextPlaceholder=e,s("init.rte",(function(){"template"===M.get("content-type")&&u("add-handler.property-panel",e)})),r.tinymce.create("tinymce.plugins.TextPlaceholderPlugin",ye()),r.tinymce.PluginManager.add("textplaceholders",r.tinymce.plugins.TextPlaceholderPlugin)},function(){r.tinymce.create("tinymce.plugins.EmotionsPlugin",{init:function(e,t){e.addCommand("mceEmotion",(function(){e.windowManager.open({file:"".concat(r.tinymce.settings.editor_plugin_action_base_path,"/emotions.action"),width:190+parseInt(e.getLang("emotions.delta_width",0)),height:125+parseInt(e.getLang("emotions.delta_height",0)),inline:1,id:"insert-emoticon-dialog",name:"emotions_dlg.title"},{plugin_url:t})})),e.addButton("emotions",{title:"emotions.emotions_desc",cmd:"mceEmotion"}),e.on("Click",(function(t){var n,o=t.target;if("IMG"===o.nodeName&&o.classList.contains("emoticon"))return n=e.selection.getRng(!0),(t.offsetX||t.layerX-o.x)<o.width/2?(n.setStartBefore(o),n.setEndBefore(o)):(n.setStartAfter(o),n.setEndAfter(o)),e.selection.setRng(n),e.selection.collapse(),r.tinymce.dom.Event.cancel(t)}))},getInfo:function(){return{longname:"Emotions",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/emotions",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("emotions",r.tinymce.plugins.EmotionsPlugin)},function(){r.tinymce.create("tinymce.plugins.ConfluencePlugin",{init:function(e){e.addCommand("mceConfUnlink",(function(t,n){var o=e.selection,i=n||o.getNode(),a=c()(i);if("A"!==i.nodeName){var s=a.closest("a");if(!s.length)return;i=s[0],a=s}var l,u,d=a.attr("href");if(d||(d="#",a.attr("href",d)),!a.attr("data-linked-resource-id")&&r.Confluence.Link.isExternalLink(d)&&a.text()==(null!=(u=/(.*)[\/]$/.exec(l=d))?u[1]:l)){var f=e.dom.create("span",{class:"nolink"},d);e.dom.replace(f,i,!1)}else o.select(i),a.removeClass("createlink unresolved"),e.execCommand("UnLink")})),e.addButton("confimage",{title:"confluence.confimage_desc",cmd:"mceConfimage"}),e.addButton("conf_macro_browser",{title:"confluence.conf_macro_browser_desc",cmd:"mceConfMacroBrowser"})},getInfo:function(){return{longname:"Confluence TinyMCE Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("confluence",r.tinymce.plugins.ConfluencePlugin)},function(){var e;r.tinymce.create("tinymce.plugins.MacroPlaceHolderPlugin",(e=r.tinymce.util.VK,{init:function(t){var n=this;function o(e){t.on("KeyDown",e),r.tinymce.isGecko&&(t.on("KeyPress",e),t.on("KeyUp",e))}function i(e,t){return e&&1===e.childNodes.length&&c()(e).is(t)&&c()(e.firstChild).is("br")}function a(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;if(!t||!t.parentNode)return!1;for(;t&&!c()(t).is(".wysiwyg-macro-body");){if(t.previousSibling||t.nextSibling)return!1;t=t.parentNode}return!0}t.on("Init",(function(){t.on("SetContent",(function(e){e.selection&&r.tinymce.each(t.dom.select("p > .wysiwyg-macro"),(function(e){var n=t.dom.getParent(e.parentNode,"p");try{t.dom.split(n,e)}catch(e){}}))}))})),t.on("SetContent",(function(){r.tinymce.each(t.dom.select('.wysiwyg-macro[data-macro-body-type="PLAIN_TEXT"] .wysiwyg-macro-body'),(function(e){t.dom.select("pre",e).length||(r.tinymce.isIE?t.dom.setHTML(e,"<pre></pre>"):t.dom.setHTML(e,"<pre><br /></pre>"))}))})),t.on("KeyDown",(function(n){var o=t.selection,i=[e.BACKSPACE,e.DELETE,e.ENTER,e.ESCAPE];if(-1==c.a.inArray(n.keyCode,i)&&!function(t){var n=!1;return 0===t.charCode&&(n=-1!=c.a.inArray(t.keyCode,[e.SHIFT,e.CTRL,e.ALT,e.META])),n}(n)&&!o.isCollapsed()&&!(n.ctrlKey||n.metaKey||!r.tinymce.isMac&&n.altKey)){var a=o.getNode();if(Le.isMacroWithBody(a)){var s=c()(".wysiwyg-macro-body",a);s.length>0&&o.select(s[0],!0)}}})),t.on("DblClick",(function(e){var t=c()(e.target),n=t.closest("[data-macro-name]");if(n.length){if(n.attr("data-macro-body-type"))if(r.tinymce.isIE){if(!t.hasClass("wysiwyg-macro-body")&&!t.hasClass("wysiwyg-macro"))return}else if(t.closest(".wysiwyg-macro-body").length)return;Le.editMacro(n),r.Confluence.PropertyPanel&&r.Confluence.PropertyPanel.current&&r.Confluence.PropertyPanel.destroy()}})),t.addCommand("mceConfRemoveMacro",(function(e){c()(e).remove(),r.tinymce.isGecko&&t.execCommand("mceRepaint",!1)})),n._isCursorInMostNestedElement=a,function(){function e(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;return t.previousSibling&&!t.nextSibling&&i(t,"p, pre")}(r.tinymce.isWebKit||r.tinymce.isGecko)&&o((function(n){if(46===n.keyCode&&e(t.selection.getRng(!0)))return r.tinymce.dom.Event.cancel(n)})),n._isCursorInLastParagraphOrPre=e}(),r.tinymce.isWebKit&&o((function(e){if(8!==e.keyCode&&46!==e.keyCode)return!0;var n=t.selection.getRng(!0),o=3===n.startContainer.nodeType?n.startContainer.parentNode:n.startContainer;return!(function(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;return a(e)&&1===t.childNodes.length&&c()(t.firstChild).is("br")}(n)&&(8!==e.keyCode||!c()(o).is("li")))||r.tinymce.dom.Event.cancel(e)})),function(){function e(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer;return 0===e.startOffset&&c()(t).is(".wysiwyg-macro-body > ul > li")&&1===t.childNodes.length&&c()(t.firstChild).is("br")}r.tinymce.isWebKit&&o((function(n){return 8!==n.keyCode||!e(t.selection.getRng(!0))||(t.execCommand("Outdent"),r.tinymce.dom.Event.cancel(n))})),n._isCursorInsideMacroPlacholderInsideListItemContainingSoloBr=e}(),function(){function e(e){var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer,n=c()(t);return 0===e.startOffset&&i(t,"p, pre")&&n.parent().is("td.wysiwyg-macro-body")&&!t.previousSibling&&t.nextSibling&&i(t.nextSibling,"p, pre")}r.tinymce.isWebKit&&o((function(n){if(46!==n.keyCode)return!0;var o=t.selection.getRng(!0),i=3===o.startContainer.nodeType?o.startContainer.parentNode:o.startContainer,a=c()(i);if(e(o)){var s=i.nextSibling;return a.remove(),t.selection.select(s,!0),r.tinymce.dom.Event.cancel(n)}})),n._isCursorInFirstParagraphWhenThereAreTwoEmptyParagraphs=e}(),function(){function e(e){var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer,n=c()(t);return 0===e.startOffset&&i(t,"p, pre")&&n.parent().is("td.wysiwyg-macro-body")&&!t.nextSibling&&t.previousSibling&&!t.previousSibling.previousSibling&&i(t.previousSibling,"p, pre")}r.tinymce.isWebKit&&o((function(n){if(8!==n.keyCode)return!0;var o=t.selection.getRng(!0),i=3===o.startContainer.nodeType?o.startContainer.parentNode:o.startContainer,a=c()(i);if(e(o)){var s=i.previousSibling;return a.remove(),t.selection.select(s,!0),r.tinymce.dom.Event.cancel(n)}})),n._isCursorInSecondParagraphWhenThereAreTwoEmptyParagraphs=e}(),function(){function e(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer,n=c()(t);return!(!t||e.startOffset>0)&&(Ee.normalize(t),t&&0===e.startOffset&&i(t,"p, pre")&&n.parent().is("td.wysiwyg-macro-body")&&!t.previousSibling&&!t.nextSibling)}(r.tinymce.isWebKit||r.tinymce.isGecko)&&o((function(n){return 8!==n.keyCode&&46!==n.keyCode||(e(t.selection.getRng(!0))?r.tinymce.dom.Event.cancel(n):void 0)})),n._isCursorInSoloParagraphOrPreInsidePlaceholder=e}(),function(){function e(e){return e&&e.parentNode&&"BR"===e.nodeName&&e===e.parentNode.lastChild}function i(t){if(!t.collapsed)return!1;var n=t.startContainer;return n&&0===t.startOffset&&3===n.nodeType&&a(t)&&1===n.nodeValue.length&&!n.previousSibling&&(!n.nextSibling||e(n.nextSibling))}function s(t){if(!t.collapsed)return!1;var n=t.startContainer;return n&&1===t.startOffset&&3===n.nodeType&&a(t)&&1===n.nodeValue.length&&!n.previousSibling&&(!n.nextSibling||e(n.nextSibling))}function l(e){if(!e.collapsed)return!1;var t=e.startContainer;return t&&0===e.startOffset&&1===t.nodeType&&1===t.childNodes.length&&a(e)&&!t.previousSibling&&!t.nextSibling}function u(e){if(!e.collapsed)return!1;var t=e.startContainer;return t&&1===e.startOffset&&1===t.nodeType&&1===t.childNodes.length&&a(e)&&!t.previousSibling&&!t.nextSibling}(r.tinymce.isWebKit||r.tinymce.isGecko)&&o((function(e){if(8!==e.keyCode&&46!==e.keyCode)return!0;var n=t.selection.getRng(!0),o=3===n.startContainer.nodeType?n.startContainer.parentNode:n.startContainer;return!c()(o).closest(".wysiwyg-macro-body").size()||(Ee.normalize(o),!(46===e.keyCode&&(i(n)||l(n))||8===e.keyCode&&(s(n)||u(n)))||(o.lastChild&&!c()(o.lastChild).is("br")&&c()(o).append("<br/>"),c()(o.firstChild).remove(),t.selection.select(o,1),r.tinymce.dom.Event.cancel(e)))})),n._isCursorBehindOnlyCharacterInNestedElement=i,n._isCursorAfterOnlyCharacterInNestedElement=s,n._isCursorBehindOnlyChildInNestedElement=l,n._isCursorAfterOnlyChildInNestedElement=u}(),function(){function e(e){return!e.collapsed&&(0===e.startOffset&&i(e.startContainer,(function(e){return!e.previousSibling}))&&(t=e.endContainer,n=e.endOffset,!!t&&(3===t.nodeType?n===t.nodeValue.length:1===t.nodeType&&(1===t.childNodes.length&&c()(t.firstChild).is("br")?0===n:n===t.childNodes.length)))&&i(e.endContainer,(function(e){return!e.nextSibling})));var t,n}function i(e,t){if(!e)return!1;if(c()(e).is(".wysiwyg-macro-body"))return!0;do{if(!t(e))return!1;e=e.parentNode}while(e&&!c()(e).is(".wysiwyg-macro-body"));return!0}r.tinymce.isWebKit&&o((function(n){if(8!==n.keyCode&&46!==n.keyCode)return!0;var o=t.selection.getRng(!0);if(e(o)){var i=c()(o.startContainer).closest(".wysiwyg-macro-body");if(i.length>0){var a,s=c()(i[0].firstChild).is("pre");return t.undoManager.add(),i.empty(),a=s?c()("<pre><br/></pre>").appendTo(i):c()("<p><br/></p>").appendTo(i),t.selection.select(a[0],!0),r.tinymce.dom.Event.cancel(n)}}return!0})),n._isMacroBodySelected=e}(),function(){function e(e){if(!e.collapsed)return!1;var t=3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer,n=c()(t);return 0===e.startOffset&&i(t,"p")&&n.next().is("table")}r.tinymce.isWebKit&&o((function(n){if(46===n.keyCode&&e(t.selection.getRng(!0)))return r.tinymce.dom.Event.cancel(n)})),n._isCursorInEmptyParagraphPrecedingPlaceholder=e}(),function(){function i(e){return e?3===e.nodeType?e:i(e.firstChild)||i(e.nextSibling):null}function a(e){return e&&"PRE"!==e.nodeName&&"TD"!==e.nodeName?"BR"===e.nodeName?e:a(e.previousSibling)||a(e.parentNode):null}function s(e){var t,n;return c()(e.commonAncestorContainer).closest(".wysiwyg-macro td").length>0&&(a(e.startContainer)||(t=i(function e(t){return!t||c()(t.parentNode).is(".wysiwyg-macro td")?null:c()(t.parentNode).is("p")?t.parentNode:e(t.parentNode)}(e.startContainer)))),(n=c()(e.commonAncestorContainer).closest(".wysiwyg-macro td > pre")).length>0&&(a(e.startContainer)||(t=i(n[0]))),t&&(e=e.cloneRange()).setStart(t,0),e}r.tinymce.isWebKit&&r.tinymce.isMac&&o((function(n){var o=t.selection.getRng();if((n.metaKey||n.ctrlKey)&&n.shiftKey&&n.keyCode===e.LEFT){var i=s(o);if(i!==o)return t.selection.setRng(i),r.tinymce.dom.Event.cancel(n)}})),n._selectTillStart=s}(),t.on("KeyDown",(function(e){if(e.keyCode===r.tinymce.util.VK.TAB){var n=t.selection.getRng(1),o=3===n.startContainer.nodeType?n.startContainer.parentNode:n.startContainer;if(c()(o).is(".wysiwyg-macro-body > pre")){t.undoManager.beforeChange(),t.undoManager.add();var i=t.getDoc().createTextNode("\t");return n.insertNode(i),t.selection.setCursorLocation(i,1),t.undoManager.add(),r.tinymce.dom.Event.cancel(e)}}}))},getInfo:function(){return{longname:"Macro Place Holder plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}})),r.tinymce.PluginManager.add("macroplaceholder",r.tinymce.plugins.MacroPlaceHolderPlugin)},function(){ne(r.document,"initContextToolbars.Toolbar",(function(e){var t,n,o,i;Lo().initContextToolbars(e),(t=r.tinymce,n={},o={},i=function(e,t){var r,o;for(o in n)if(n.hasOwnProperty(o)&&n[o].isEnabled)for(var i=0,a=n[o].events.length;i<a;i++)(r=n[o].events[i]).type.toLowerCase().indexOf(t.type)>-1&&(r.shouldTrigger(e,t)?r.callback.apply(this,[t.target]):r.missed&&r.missed())},{addEventsForComponent:function(e,r){e in n||(n[e]={},n[e].events=[],n[e].isEnabled=!0);for(var a=function(a,c){var s;!(r[a].type in o)&&(o[r[a].type]=!0,t[r[a].type].add(i)),"function"!=typeof r[a].shouldTrigger&&(s=r[a].shouldTrigger,r[a].shouldTrigger=function(e,t){return t.target.tagName.toLowerCase()==s}),n[e].events.push(r[a])},c=0,s=r.length;c<s;c++)a(c)},disableEventsForComponent:function(e){for(var t=0,r=n.length;t<r;t++)if(e in n)return n[e].isEnabled=!1,!0;return!1},enableEventsForComponent:function(e){for(var t=0,r=n.length;t<r;t++)if(e in n)return n[e].isEnabled=!0,!0;return!1}}).addEventsForComponent("TableToolbar",Cr)}))},function(){vr(),yr(),r.tinymce.create("tinymce.plugins.customtoolbar",Er()),r.tinymce.PluginManager.add("customtoolbar",r.tinymce.plugins.customtoolbar)},function(){r.tinymce.create("tinymce.plugins.InsertWikiMarkupPlugin",Yr),r.tinymce.PluginManager.add("insertwikimarkup",r.tinymce.plugins.InsertWikiMarkupPlugin)},function(){r.tinymce.create("tinymce.plugins.PropertyPanel",Ue()),r.tinymce.PluginManager.add("propertypanel",r.tinymce.plugins.PropertyPanel)},function(){},function(){r.tinymce.create("tinymce.plugins.ConfMonospacePlugin",{init:function(e){e.addCommand("confMonospace",(function(){e.formatter.toggle("monospace",void 0)})),e.on("Init",(function(){e.formatter.register({monospace:{inline:"code"}}),e.editorCommands.addCommands({confMonospace:function(){return e.formatter.match("monospace")}},"state")})),e.addButton("monospace",{title:"monospace",cmd:"confMonospace"})},getInfo:function(){return{longname:"Monospace Formatting",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("confmonospace",r.tinymce.plugins.ConfMonospacePlugin)},function(){r.tinymce.create("tinymce.plugins.ConfCharmapPlugin",{init:function(e){e.addCommand("confCharmap",(function(){e.windowManager.open({id:"insert-char-dialog",url:"".concat(r.tinymce.settings.editor_plugin_action_base_path,"/charmap.action"),width:600+parseInt(e.getLang("advanced.charmap_delta_width",0)),height:290+parseInt(e.getLang("advanced.charmap_delta_height",0)),inline:!0,name:"advanced.charmap_desc"})}))},getInfo:function(){return{longname:"Confluence Charmap Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("confcharmap",r.tinymce.plugins.ConfCharmapPlugin)},function(){var e=this,t=".wysiwyg-macro,.placeholder,table";r.tinymce.create("tinymce.plugins.CursorTargetPlugin",{init:function(n){var o=!0,i="ol, ul, p, pre, table, blockquote, div, h1, h2, h3, h4, h5, h6",a=c.a.ui.keyCode;function u(e,n){c()(t,e).each((function(e,r){!function(e,n){var r=c()(e);function o(e){if(0===e.length)throw new Error("no paragraph element specified");Ge()&&e.addClass("auto-cursor-target");var t=e[0];return 0===t.childNodes.length&&(t.innerHTML="<br />"),t}function a(e){return!c()(e).is(i)}function s(e,t){var n=c()("<p/>");if(c()(e.parentNode).is("li, td, th"))for(;e[t]&&a(e[t]);)n["previousSibling"==t?"prepend":"append"](e[t]);return o(n)}(!r.prev().length||r.prev(t).length||c()(e.parentNode).is("li, td, th")&&a(e.previousSibling))&&r.before(s(e,"previousSibling")),(!r.next().length||r.next(".synchrony-container").length||c()(e.parentNode).is("li, td, th")&&a(e.nextSibling))&&r.after(s(e,"nextSibling")),Ge()&&r.next().length&&!r.next().next().length&&f(r.next()[0])&&r.next().addClass("auto-cursor-target"),n&&function(e){function n(e){("BR"===e[0].nodeName||f(e[0]))&&e.replaceWith(o(c()("<p/>")))}var r=e.prev();r.length&&function(e){for(var n=e.prev();n.length&&!n.is(t);){var r=n[0];if("BR"!==r.nodeName&&"P"!==r.nodeName)return!1;n=n.prev()}return!0}(r)&&n(r);var i=e.next();i.length&&function(e){for(var n=e.next();n.length&&!n.is(t);){var r=n[0];if("BR"!==r.nodeName&&"P"!==r.nodeName)return!1;n=n.next()}return!0}(i)&&n(i)}(r)}(r,n)}))}function d(e){return c()("p",e).each((function(e,t){f(t)&&m(t)&&c()(t).attr("data-tag","marked-for-deletion")})),c()("p[data-tag=marked-for-deletion]",e).remove(),e}function f(e){return 1===e.nodeType&&0===e.childNodes.length||function(e){for(var t=0,n=0,r=0,o=e.childNodes.length;r<o;r++){var i=e.childNodes[r];if("BR"===i.nodeName){if(++t>1)return!1}else if(/^[\s|\u00A0]$/.test(i.nodeValue)){if(++n>1)return!1}else if(""!==i.nodeValue)return!1}return!0}(e)}function m(e){if(!e||1!==e.nodeType)return!1;var n=g(e,!1),r=g(e,!0),o=p(n)||c()(n).is(t),i=p(r)||c()(r).is(t),a=p(n)&&p(r);return o&&i&&!a}function p(e){return!e||e.className&&/cell|header|footer/.test(e.className)}function g(e,t){var n=c()(e);do{var r=t?n[0].nextSibling:n[0].previousSibling;if(r)return r;n=n.parent()}while(n.length>0&&!n.is(".cell, .mceContentBody, td, li"));return null}function h(e){var t=e.startContainer;return 3===t.nodeType?!(t.previousSibling&&(3===t.previousSibling.nodeType||c()(t.previousSibling).is("br")))&&0===e.startOffset:1===t.nodeType&&0===e.startOffset}function v(e,t){return t.startContainer==t.endContainer&&1===t.startContainer.nodeType&&function(e,t){var n=t.startOffset;return e||n--,n>=0&&n<t.startContainer.childNodes.length&&"TABLE"===t.startContainer.childNodes[n].nodeName}(e,t)}function b(e){if(!e.collapsed)return!1;if(!function(e){for(var t=/^(TABLE|TR|TD)$/,n=e.startContainer;n&&n;){if(t.test(n.nodeName))return!0;n=n.parentNode}return!1}(e))return!1;var t,n=e.startContainer;if(3===n.nodeType)return t=g(n,!0),e.startOffset==n.nodeValue.length&&(null==t||c()(t).is("br"));if(1===n.nodeType){if(c()(n).is("td, th")&&0===e.startOffset&&n.childNodes.length>0)return c()(n.childNodes[0]).is("br");var r=0===e.startOffset?0:e.startOffset-1;return null==(t=g(n.parentNode.childNodes[r],!0))||c()(t).is("br")}return!1}function y(e){return e&&1===e.childNodes.length&&c()(e.childNodes[0]).is("br")}function C(e,t){return!(!r.tinymce.isWebKit||!v(!1,t))||!(!r.tinymce.isGecko||!(b(t)||m(e)&&0===t.startOffset&&y(e)))}function w(e,t){return!(!r.tinymce.isWebKit||!(v(!0,t)||h(t)&&m(e)||function(e){var t=n.getBody();return!!t.childNodes.length&&e.collapsed&&0===e.startOffset&&t.childNodes[0]==e.startContainer}(t)))||!!(r.tinymce.isGecko&&h(t)&&m(e)&&y(e))}function x(e){var t=e.keyCode;return t!==a.BACKSPACE&&t!==a.DELETE||(n.selection.isCollapsed()?t===a.BACKSPACE&&w(n.selection.getNode(),n.selection.getRng(o))?r.tinymce.dom.Event.cancel(e):t===a.DELETE&&C(n.selection.getNode(),n.selection.getRng(o))&&r.tinymce.dom.Event.cancel(e):u(n.getBody()),!0)}var k=function(){u(n.getBody(),!0)},T=function(e){u(e,!1),r.tinymce.isIE10&&function(e){c()("p, td.confluenceTd, th.confluenceTh",e).each((function(e,t){(function(e){return e&&""===e.innerHTML})(t)&&c()(t).html("<br />")}))}(e)};if(Ge()){var E=function(){T(n.getBody())};s("cursor-target-refresh",E),n.on("Remove",(function(){l("cursor-target-refresh",E)}))}else n.on("SetContent",(function(){var e,t;u(n.getBody()),e=n.getBody(),t=r.tinymce.isIE?"&nbsp;":"<br/>",c()("p, td.confluenceTd, th.confluenceTh",e).each((function(e,n){(function(e){return e&&e.childNodes&&1===e.childNodes.length&&3===e.childNodes[0].nodeType&&e.childNodes[0].nodeValue&&1===e.childNodes[0].nodeValue.length&&160===e.childNodes[0].nodeValue.charCodeAt(0)})(n)&&c()(n).html(t)}))})),n.on("GetContent",(function(e){if(""!==e.content){var t="<div class='root-node'>"+e.content+"</div>",r=d(c()(t)),o=c.a.extend({},e,{getInner:!1}),i=n.serializer.serialize(r[0],o);e.content=i.substring("<div class='root-node'>".length,i.length-"</div>".length)}})),n.on("init",(function(){n.dom.events.bind(n.selection,"SetContent",k),n.dom.events.bind(n.getBody(),"cut",k),s("cursor-target-refresh",k)})),n.on("Remove",(function(){l("cursor-target-refresh",k)})),r.tinymce.isGecko&&n.on("KeyDown",(function(e){e.keyCode!==a.ENTER&&e.keyCode!==a.BACKSPACE&&e.keyCode!==a.DELETE||n.selection.normalize()})),n.on("KeyDown",x),n.on("KeyUp",x),r.tinymce.isGecko&&n.on("KeyPress",x),n.on("Paste",k);c.a.extend(e,{isCursorBeforeAfterTable:v,isCursorTarget:m,_isTextContainerEmpty:f,_removeCollaborativeEditorCursorTargets:function(e){var t=c()("<div>");return t.html(e),t.find("p.auto-cursor-target").each((function(e,t){t.remove()})),t.html()},_processCursorTargets:d,_isCursorAtStartOfContainer:h,_isCursorAtEndOfContainer:function(e){var t=e.startContainer;if(3===t.nodeType)return!(t.nextSibling&&(3===t.nextSibling.nodeType||c()(t.nextSibling).is("br")))&&e.endOffset==t.nodeValue.length;if(1===t.nodeType){var n=t.childNodes[e.startOffset];return!(!c()(n).is("br")||null!=n.nextSibling)||e.endOffset==t.childNodes.length}return!1},_getSiblingWithinBlockDisregardingNesting:g,_doesContainerHaveNestedContent:function e(t){var n,r=c()(t).children();for(n=0;n<r.length;n++)if(!f(r[n])&&(c()(r[n]).contents().filter((function(){return 3===this.nodeType})).length||e(r[n])))return!0;return!1},_addCursorTargetParagraphsToContent:u,_isCursorAtEndOfBottomRightCellInTable:b,_shouldCancelDelete:C,_shouldCancelBackspace:w,_collabEditingCursorTargetRefresh:T}),r.AJS.Rte.Cursor=ge().Cursor||{},c.a.extend(r.AJS.Rte.Cursor,{isTextContainerEmpty:f,fixCursorTargets:u})},getInfo:function(){return{longname:"Cursor Target plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}}),r.tinymce.PluginManager.add("cursorTarget",r.tinymce.plugins.CursorTargetPlugin)},function(){r.tinymce.create("tinymce.plugins.iOSEditing",{init:function(e){r.tinymce.Env.iOS&&setTimeout((function(){c()(e.getBody()).addClass("ios")}),0)},getInfo:function(){return{longname:"iOS Comments Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("iosediting",r.tinymce.plugins.iOSEditing)},function(){r.tinymce.create("tinymce.plugins.aeTable",Bt()),r.tinymce.PluginManager.add("aeTable",r.tinymce.plugins.aeTable)},function(){var e=function(){var e=function(e){var t=this;e.on("Undo",(function(n){t.cleanLinks(e,n)})),this.editor=e,this.weightedHandlers=[],this.handlers=[]};function t(e){for(var n=t.options,r=n.parser[n.strictMode?"strict":"loose"].exec(e),o={},i=14;i--;)o[n.key[i]]=r[i]||"";return o[n.q.name]={},o[n.key[12]].replace(n.q.parser,(function(e,t,r){t&&(o[n.q.name][t]=r)})),o}e.prototype={addHandler:function(e,t){this.weightedHandlers.push({handler:e,weight:t||0}),this.weightedHandlers.sort((function(e,t){return e.weight-t.weight})),this.handlers=[];for(var n=this.weightedHandlers.length,r=0;r<n;r++)this.handlers.push(this.weightedHandlers[r].handler)},cleanLinks:function(e){return c()("a.atlassian-autoconvert",e.getDoc()).removeClass("atlassian-autoconvert"),!0},callHandlers:function(e){var o=0,i=this,a=c()(e),s=c()(e).clone(),l=s.attr("href"),u=t(n(l));function d(e){if(e&&(1!==e.length||!e.attr("href")))return m(e);if(e)o=0,u=t((s=e).attr("href")),f(i.handlers[o],u,s);else{if(!(++o<i.handlers.length))return m(s);f(i.handlers[o],u,s)}}function f(e,t,n){var o,a=d;o=setTimeout((function(){a=function(){0},d()}),r.tinymce.plugins.Autoconvert.callbackTimeout),e(t,n,(function(){clearTimeout(o),a.apply(i,arguments),a=function(){0}}))}function m(e){i.editor.undoManager.beforeChange();var t=i.editor.selection,n=i.editor.selection.getBookmark();a.replaceWith(e),t.moveToBookmark(n),i.editor.undoManager.add()}0!==this.handlers.length&&f(this.handlers[0],u,s)}},e.callbackTimeout=5e3,e.convertMacroToDom=function(e,t,n){var r={macro:e,contentId:M.get("content-id")};c.a.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"".concat(Ce,"/rest/tinymce/1/macro/placeholder"),data:c.a.toJSON(r),dataType:"text",success:t,error:n,timeout:45e3})},e.convertMacroToDomViaWikiText=function(t,n,r){var o=["{",t.name],i=!0;for(var a in t.defaultParameterValue&&(o.push(":",t.defaultParameterValue),i=!1),t.params)i?(o.push(":"),i=!1):o.push("|"),o.push(a,"=",t.params[a]);o.push("}"),e.getHtmlFromWikiMarkup(o.join(""),(function(e){n(c()(e)[0])}),(function(){r()}))},e.getHtmlFromWikiMarkup=function(e,t,n){var r={wiki:e,entityId:M.get("content-id"),spaceKey:M.get("space-key")};c.a.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:"".concat(Ce,"/rest/tinymce/1/wikixhtmlconverter"),data:c.a.toJSON(r),dataType:"text",success:t,error:n,timeout:45e3})},t.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var n=function(e){return e.replace(/^(.*?\/\/[^\/]*?\/.*?)(@)/,"$1%40")},o={init:function(t){var n=new e(t);function o(e,r,o){var i=c()(o.node).children("a");1===i.length&&"A"===i[0].tagName&&i.text()===i.attr("href")&&(i.attr("class","atlassian-autoconvert"),setTimeout((function(){var e=c()("a.atlassian-autoconvert",c()(t.selection.getNode().ownerDocument)).removeClass("atlassian-autoconvert");n.callHandlers(e)}),0))}r.tinymce.plugins.Autoconvert.autoConvert=n,t.on("init",(function(){c()(document).on("postPaste",o),t.addCommand("addAutoconverter",(function(e,t){n.addHandler(t)}))})),t.on("remove",(function(){c()(document).off("postPaste",o)}))},getInfo:function(){return{longname:"Atlassian Autoconvert",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}};return{autoConverter:e,plugin:o}}();r.tinymce.plugins.Autoconvert=e.autoConverter,r.tinymce.create("tinymce.plugins.AutoconvertPlugin",e.plugin),r.tinymce.PluginManager.add("autoconvert",r.tinymce.plugins.AutoconvertPlugin),Zt()},function(){s("rte-ready",en.initializeEditor)},function(){r.tinymce.create("tinymce.plugins.draggable",tn()),r.tinymce.PluginManager.add("draggable",r.tinymce.plugins.draggable)},function(){r.tinymce.create("tinymce.plugins.InsertFiles",{init:function(e){e.addButton("confluence-insert-files",{title:ve("tinymce.confluence.files"),tooltip:"".concat(ve("tinymce.confluence.conf_file_desc")," (").concat(ve("tinymce.confluence.conf_file_shortcut"),")"),cmd:"mceConfimage",className:"insert-files",icon:"aui-icon aui-icon-small aui-iconfont-image",locationGroup:"rte-toolbar-group-files",weight:0})},getInfo:function(){return{longname:"Insert Files",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com/",version:"1.0"}}}),r.tinymce.PluginManager.add("insertfiles",r.tinymce.plugins.InsertFiles)},function(){r.tinymce.create("tinymce.plugins.flextofullsizeplugin",nn()),r.tinymce.PluginManager.add("flextofullsize",r.tinymce.plugins.flextofullsizeplugin)},function(){r.tinymce.create("tinymce.plugins.Referrer",{init:function(e){e.on("Init",(function(){var e=c()("#createpageform"),t=e.find("#originalReferrer");e.length&&!t.val()&&document.referrer&&t.val(document.referrer)}))},getInfo:function(){return{longname:"Confluence Cancel Return Url",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("referrer",r.tinymce.plugins.Referrer)},function(){var e,t;r.tinymce.create("tinymce.plugins.TableContentWrapperPlugin",(e=["img:not(.editor-inline-macro, .emoticon)"].concat(["time.non-editable",".editor-inline-macro","a.confluence-link[data-linked-resource-type='userinfo']"]).concat([".wysiwyg-macro"]).join(","),t="<div class='content-wrapper'>",{init:function(n){function r(){c()(n.dom.select("table.confluenceTable:not(.".concat("wrapped",")"))).each((function(n,r){c()(r).addClass("wrapped").find("> tbody > tr > th, > tbody > tr > td, > thead > tr > th").each((function(n,r){var o=c()(r);!o.find("> .content-wrapper").length&&o.find(e).length&&o.wrapInner(t)}))}))}s("rte-ready",r),n.on("Remove",(function(){l("rte-ready",r)})),n.on("Change",(function(){var r=n.selection;function o(){return r.getBookmark()}function i(e){r.moveToBookmark(e),Se()}var a=r.getNode(),s=c()(a);if(a&&s.closest("table.confluenceTable").not("table.confluenceTable table.confluenceTable").length){!function(e){var t=r.getRng();if(e.is("tr")&&c()(t.startContainer).is("tr")&&t.collapsed){var n=e.find(">td, >th").first(),o=n.find(":first-child:not(.content-wrapper)")[0]||n[0].firstChild;t.setStart(o,0),t.setEnd(o,0),r.setRng(t)}}(s);var l,u=s.closest("table.confluenceTable > tbody > tr > th, table.confluenceTable > tbody > tr > td, table.confluenceTable > thead > tr > th");if(u.find(e).length){var d=u.find("> .content-wrapper");d.length?(l=o(),function(e){for(var t=0;t<e.length;t++)e.eq(t).find("> p, > table, > ul, > ol").length||e.eq(t).wrapInner("<p/>"),t>0&&(e.eq(0).append(e.eq(t).children()),e.eq(t).remove())}(d),i(l)):u.find("> p").length?(l=o(),u.wrapInner(t),i(l)):(l=o(),u.wrapInner("<p/>").wrapInner(t),i(l))}}c()(n.getWin().document).find(".content-wrapper:empty").remove()}))},getInfo:function(){return{longname:"Table Content Wrapper Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}})),r.tinymce.PluginManager.add("tableContentWrapper",r.tinymce.plugins.TableContentWrapperPlugin)},function(){var e;r.tinymce.create("tinymce.plugins.LinkBrowser",(e=r.Confluence.Editor.LinkBrowser,{init:function(t){t.addButton("linkbrowserButton",{title:"confluence.conflink_desc",cmd:"mceConflink",class:"mce_conflink"}),t.addCommand("mceConflink",(function(){e.open({bookmarkManager:_e})})),t.addCommand("mceConfAttachments",(function(){e.open({panelKey:e.ATTACHMENTS_PANEL,bookmarkManager:_e})}))},getInfo:function(){return{longname:"Confluence Link Browser",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}})),r.tinymce.PluginManager.add("linkbrowser",r.tinymce.plugins.LinkBrowser)},function(){r.tinymce.create("tinymce.plugins.ConfluenceVersionComment",{init:function(e){e.on("Init",(function(){var e=M.get("version-comment");c()("#rte-savebar-tinymce-plugin-point").append(function(e,t){return'\n<span class="rte-toolbar-comment toolbar-item">\n    <input id="versionComment" name="versionComment" '.concat(t?'value="'.concat(t,'"'):"",'\n           placeholder="').concat(e("editor.change.comment"),'"\n           class="text" type="text" size="35">\n    <label for="versionComment" class="assistive">').concat(e("editor.change.comment"),"</label>\n</span>\n")}((function(e){return ve(e)}),e))}))},getInfo:function(){return{longname:"Confluence Version Comment",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}}}),r.tinymce.PluginManager.add("confluenceversioncomment",r.tinymce.plugins.ConfluenceVersionComment)},function(){r.tinymce.PluginManager.add("autocomplete",bo)},function(){},function(){r.tinymce.PluginManager.add("autocompletelink",ko)},function(){r.tinymce.create("tinymce.plugins.AutoCompleteMacro",So()),r.tinymce.PluginManager.add("autocompletemacro",r.tinymce.plugins.AutoCompleteMacro)},function(){r.tinymce.PluginManager.add("autocompletemedia",Mo)},function(){w("confluence-table-enhancements.sticky-headers.disabled")||c()(document).ready(vn.initialize),w("confluence-table-enhancements.sticky-headers-editor")&&(s("rte-ready",yn.initialize),s("rte-quick-edit-push-state",yn.initialize),s("rte-quick-edit-push-hash",yn.initialize))},function(){r.tinymce.create("tinymce.plugins.ConfluenceLeaveComment",Cn),r.tinymce.PluginManager.add("confluenceleavecomment",r.tinymce.plugins.ConfluenceLeaveComment)},function(){r.tinymce.create("tinymce.plugins.ConfluenceLeaveTemplate",wn),r.tinymce.PluginManager.add("confluenceleavetemplate",r.tinymce.plugins.ConfluenceLeaveTemplate)},function(){r.Confluence.Editor.SearchManager=Rn(),_n(),r.tinymce.create("tinymce.plugins.AtlassianSearchReplacePlugin",In()),r.tinymce.PluginManager.add("searchreplace",r.tinymce.plugins.AtlassianSearchReplacePlugin)},function(){r.tinymce.create("tinymce.plugins.ConfluenceDrafts",xn()),r.tinymce.PluginManager.add("confluencedrafts",r.tinymce.plugins.ConfluenceDrafts)},function(){var e=function(e){return!!e.querySelector(".contentLayout, .contentLayout2")},t=function(e){return Array.from(e.querySelectorAll(".contentLayout2 .columnLayout.single"))},n=function(e,t){e.undoManager.ignore((function(){t.forEach((function(t){return t.appendChild(function(e){return e.dom.create("div",{class:"pagelayout-delete-stub synchrony-exclude",style:"display:none;",contenteditable:"true"},".")}(e))}))}))},o=function(e,t){var n=Array.from(t.querySelectorAll(".pagelayout-delete-stub"));e.undoManager.ignore((function(){n.forEach((function(e){return e.parentNode.removeChild(e)}))}))};s("rte-ready",(function(){var i=r.tinymce.activeEditor,a=i.getDoc(),c=i.getBody();c.addEventListener("keydown",(function(r){if((8===r.keyCode||46===r.keyCode)&&e(a))if(i.dom.isEmpty(i.getBody()))r.stopImmediatePropagation();else{var o=t(a);o.length>0&&(n(i,o),r.stopImmediatePropagation())}}),!0),c.addEventListener("keyup",(function(t){8!==t.keyCode&&46!==t.keyCode||!e(a)||o(i,a)}),!0),i.on("beforeExecCommand",(function(r){if("delete"===r.command&&e(a)){var o=t(a);o.length>0&&n(i,o)}})),i.on("ExecCommand",(function(t){"delete"===t.command&&e(a)&&o(i,a)})),i.on("BeforeGetContent",(function(){o(i,a)}))}))},function(){},function(){r.tinymce.create("tinymce.plugins.ConfluenceMacroBrowser",kn),r.tinymce.PluginManager.add("confluencemacrobrowser",r.tinymce.plugins.ConfluenceMacroBrowser)},function(){r.Confluence.PropertyPanel.Macro.registerInitHandler((function(e,t,n){var o,i;Ho=e,ni(t),Uo=r.Confluence.MacroParameterSerializer.deserialize(c()(Ho).attr("data-macro-parameters")),Wo=null,t.splice(1,0,(o=(i=Uo).title||Zo(i),{className:qo,text:Pt(o),click:ti}))}),"status"),c.a.each(Jo,(function(e,t){r.Confluence.PropertyPanel.Macro.registerButtonHandler(t,(function(e,n){Uo.colour=t,r.Confluence.PropertyPanel.destroy()}),Ko)})),s("destroyed.property-panel",(function(){Xo()&&Qo()}))},function(){},function(){},function(){},function(){r.AJS.MacroBrowser.Macros.code=Qr},function(){},function(){r.tinymce.create("tinymce.plugins.ConfluenceWatch",Tn),r.tinymce.PluginManager.add("confluencewatch",r.tinymce.plugins.ConfluenceWatch)},function(){r.tinymce.create("tinymce.plugins.ConfluenceSortableTablesPlugin",En),r.tinymce.PluginManager.add("confluencesortabletablesplugin",r.tinymce.plugins.ConfluenceSortableTablesPlugin)},function(){r.tinymce.create("tinymce.plugins.AutoResizePlugin",Sn),r.tinymce.PluginManager.add("autoresize",r.tinymce.plugins.AutoResizePlugin)},function(){},function(){},function(){r.tinymce.create("tinymce.plugins.ConfluenceNotifyWatchers",Fn),r.tinymce.PluginManager.add("confluencenotifywatchers",r.tinymce.plugins.ConfluenceNotifyWatchers)},function(){},function(){r.Confluence.PropertyPanel.Macro.registerButtonHandler("office-connector-download-file-button",(function(e,t){for(var n=(t=t.nodeType?t:t[0]).getAttribute("data-macro-parameters").split("|"),o={},i=0;i<n.length;i++){var a=n[i].split("=");a.length>1&&(o[a[0]]=a[1])}var c=M.get("page-id"),s=M.get("content-type");function l(e,t,n){return e&&t&&("?"!=n.charAt(n.length-1)&&(n+="&"),n="".concat(n).concat(e,"=").concat(encodeURI(t))),n}o.space||(o.space=M.get("space-key"));var u=M.get("context-path")+"/plugins/servlet/oc/getattachment?";u=l("title",o.page,u),u=l("date",o.date,u),u=l("space",o.space,u),u=l("filename",o.name,u),u=l("contextid",c,u),u=l("contexttype",s,u);var d=r.tinymce.Env.ie?"_blank":"download-office-attachment";window.open(u,d).opener=null})),Fo()},function(){s("rte-ready",(function(){Ze(),et()}))},function(){r.tinymce.create("tinymce.plugins.TableAnalytics",zn),r.tinymce.PluginManager.add("tableAnalytics",r.tinymce.plugins.TableAnalytics)},function(){s("init.rte",Zr)},function(){s("init.rte",(function(){re(r.document,"postPaste",qn),ne(r.document,"postPaste",qn),r.tinymce.activeEditor&&r.tinymce.activeEditor.on("Remove",(function(){re(r.document,"postPaste",qn)}))}))},function(){r.tinymce.create("tinymce.plugins.ConfIndentation",Vn),r.tinymce.PluginManager.add("confindentation",r.tinymce.plugins.ConfIndentation)},function(){},function(){r.tinymce.create("tinymce.plugins.TextPatternPlugin",Gn),r.tinymce.PluginManager.add("aetextpattern",r.tinymce.plugins.TextPatternPlugin)},function(){r.tinymce.Env.gecko&&s("rte-ready",fr)},function(){12===r.tinymce.Env.ie&&s("rte-ready",fr)},function(){r.tinymce.create("tinymce.plugins.PersistScrollPosition",ir),r.tinymce.PluginManager.add("persit_scroll_position",r.tinymce.plugins.PersistScrollPosition)},function(){r.tinymce.create("tinymce.plugins.templateeditor",ar),r.tinymce.PluginManager.add("templateeditor",r.tinymce.plugins.templateeditor)},function(){r.tinymce.PluginManager.add("preserve-paragraph-formatting-on-delete",(function(e){return e.on("KeyDown",(function(t){!function(e,t){var n=r.tinymce.VK,o=n.BACKSPACE,i=n.DELETE,a=e.selection.getNode(),c=a.nextSibling;if(e.selection.isCollapsed()&&a!=e.dom.getRoot())if(t.keyCode===o){if(0===e.selection.getRng(!0).startOffset){var s=a.previousSibling;s&&sr(s)&&(lr(e,s),r.tinymce.dom.Event.cancel(t))}}else if(t.keyCode==i){if(cr(a).length<=1||a.childNodes.length>1)return;c&&sr(a)&&(lr(e,a),r.tinymce.dom.Event.cancel(t),function(e,t){var n=e.selection,r=n.getRng(!0);e.focus(),t.focus(),r.setStart(t,0),r.setEnd(t,0),n.setRng(r)}(e,c))}}(e,t)})),{getMetadata:function(){return{name:"Preserve paragraph formatting when deleting empty line",author:"Atlassian",url:"http://www.atlassian.com"}}}}))}],oi=function(){return ri.forEach((function(e,t){try{e()}catch(o){n="initError",r={fnName:e.name||t,message:o.message||"",exceptionName:o.name||""},Object.keys(r).forEach((function(e){r[e]=m(r[e])})),u("analytics",{name:"".concat(d,".plugins.").concat(n),data:r})}var n,r})),!0},ii=function(){return new Promise((function(e){!function(e,t){e.listener;var n=e.globalProperty,r=e.interval,o=void 0===r?250:r;if(i(n))return t(),null;var a=setInterval((function(){i(n)&&(clearInterval(a),t())}),o)}({listener:"editor-plugins/index",globalProperty:"AJS.Confluence.PropertyPanel.Macro",interval:20},(function(){e()}))}))},ai=!1,ci=function(){if(!ai){var e=window.tinymce;return e.VK=e.util.VK,e.confluence=e.confluence||{},r.tinymce.confluence=r.tinymce.confluence||{},r.tinymce.confluence.macrobrowser=Me,dr(),r.tinymce.confluence=r.tinymce.confluence||{},r.tinymce.confluence.NodeUtils=Te,r.tinymce.confluence=r.tinymce.confluence||{},r.tinymce.confluence.MacroUtils=De,gr(),g.a.EditorUtils=je,g.a.Rte=g.a.Rte||{},g.a.Rte.Cursor=g.a.Rte.Cursor||{},c.a.extend(g.a.Rte.Cursor,{insertParagraph:y,isCursorAtStart:v,isCursorAtEnd:b}),ai=!0,ii().then(oi)}},si=!1,li="",ui={},di={},fi=function(){si&&(u("analytics",function(){for(var e={},t={name:li,data:e},n=mi.getEntriesByType("measure"),r=0;r<n.length;r++){var o=n[r],i=o.name;ui[i]&&(e["".concat(i,".startTime")]=o.startTime,e["".concat(i,".duration")]=o.duration)}return t}()),si=!1)};var mi=o.a.performance,pi=function(e){return"".concat(e,".start")},gi=function(e){if(mi&&mi.mark&&ui[e]){si||(si=!0);var t=pi(e);mi.mark(t)}},hi=function(e){if(mi&&mi.mark&&ui[e]){var t=pi(e);if(0!==mi.getEntriesByName(t,"mark").length){var n=function(e){return"".concat(e,".end")}(e);mi.mark(n),mi.measure(e,t,n),di[e]&&fi()}else o.a.console.warn("Calling debugTimeEnd for ".concat(e," before debugTime"))}};function vi(e){gi(e)}function bi(e){hi(e)}var yi={Formatting:".rte-toolbar-group-formatting",Style:".rte-toolbar-group-style",Indentation:".rte-toolbar-group-indentation",Lists:".rte-toolbar-group-lists",Tasks:".rte-toolbar-group-task-lists",Justification:".rte-toolbar-group-justification",Links:".rte-toolbar-group-link",Table:".rte-toolbar-group-table",Insert:".rte-toolbar-group-insert",Undo:".rte-toolbar-group-undo",PageLayouts:"#page-layout-2-group",SearchReplace:".rte-toolbar-group-searchreplace",Help:".rte-toolbar-group-help"},Ci=function(e,t,n){!1===t&&function(e,t){Array.prototype.forEach.call(r.document.getElementById(e).querySelectorAll(t),(function(e){e.style.display="none"}))}(e,n)};function wi(e){return!!(e=e&&e.jquery?e[0]:e)&&("BR"!==e.tagName&&3!==e.nodeType||(e=e.parentNode),e&&9===e.nodeType&&(e=null),e)}var xi={};xi.Rte={HIDDEN_CHAR:"\ufeff",ZERO_WIDTH_WHITESPACE:"&#x200b;",editorId:"wysiwygTextArea",isQuickEdit:!1,getEditor:function(){return o.a.tinymce.activeEditor},getCurrentBaseUrl:function(){if(!this.currentBaseUrl){var e=o.a.document.location;this.currentBaseUrl="".concat(e.protocol,"//").concat(e.hostname).concat(e.port?":".concat(e.port):"")}return this.currentBaseUrl},showSelection:function(e){ge().showElement(o.a.tinymce.activeEditor.selection.getStart(),e)},isAnyPartShown:function(e){if(!(e=wi(e)))return!1;var t=c()(e),n=t.offset().top,r=n+t.outerHeight(),o=c()(ge().getEditor().getDoc()).scrollTop(),i=o+c()(ge().getEditorFrame()).height();return r>o&&n<i},showElement:function(e,t){var n=wi(e);if(!n)return!1;var r=c()(n),o=ge().getEditor(),i=c()(o.getDoc()),a=r.offset().top,s=a+r.outerHeight(),l=i.scrollTop(),u=l+c()(ge().getEditorFrame()).height(),d=function(){ge().bindScroll("AJS.Rte.showElement",(function(){ge().unbindScroll("AJS.Rte.showElement"),setTimeout(t,1)}))};a<l?(ge().scrollTo(a),t&&d()):s>u?(ge().scrollTo(Math.min(a,l+s-u)),t&&d()):t&&t()},scrollTo:function(e){var t=ge().getEditor();e=Math.ceil(e),c()(t.getDoc()).scrollTop(e)},bindScroll:function(e,t){var n=ge().getEditor();c()(r.document).add(n.getDoc()).add(n.getWin()).bind("scroll.".concat(e),t)},unbindScroll:function(e){var t=ge().getEditor();c()(r.document).add(t.getDoc()).add(t.getWin()).unbind("scroll.".concat(e))},getMainEditor:function(){var e=o.a.tinymce.EditorManager.editors[ge().editorId];if(!e)throw new Error("Main editor has not been initialised yet and is therefore not accessible via tinymce.EditorManager.editors");return e},getEditorContainer:function(){return r.document.getElementById("wysiwyg")},getEditorFrame:function(){return r.document.getElementById("".concat(ge().getEditor().id,"_ifr"))},getEditorTable:function(){return r.document.getElementById("".concat(ge().getEditor().id,"_tbl"))},webResourcePath:"/download/resources/com.atlassian.confluence.tinymceplugin%3Atinymceeditor/",getResourceUrlPrefix:function(){return this.resourceUrlPrefix||(this.resourceUrlPrefix=this.getCurrentBaseUrl()+M.get("editor-plugin-resource-prefix")),this.resourceUrlPrefix},getTinyMceBaseUrl:function(){return this.absoluteUrl||(this.absoluteUrl="".concat(this.getResourceUrlPrefix()+this.webResourcePath,"tinymcesource/")),this.absoluteUrl},getMinEditorHeight:function(){return+M.get("min-editor-height")},getTinyMceEditorMinHeight:function(e){e=e||0;var t=ge().getMinEditorHeight(),n=0;return t||(Array.prototype.forEach.call(r.document.querySelectorAll("#editor-precursor,#header-precursor,#header"),(function(e){n+=c()(e).outerHeight(!0)})),c()(o.a).height()-n-e)},fixEditorFocus:function(){0},editorFocus:function(e){if(e&&!e.destroyed){var t,n=(t=e.dom.getRoot(),o.a.tinymce.isWebKit&&!c()(t).parents("body").length&&(t=c()(e.getBody()).find("p:first-child")[0]),t);n&&(e.selection.select(n,1),e.selection.collapse(1),n.focus()),e.getBody().focus(),e.getWin().focus()}}},xi.KEYS={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,META:91};var ki=xi;function Ti(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Ei(e,t,n[t])}))}return e}function Ei(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Si=function(){void 0===r.AJS.Rte&&(r.AJS.Rte=Ti({},ki.Rte)),void 0===r.AJS.Rte.getEditor&&(r.AJS.Rte=Ti({},r.AJS.Rte,ki.Rte))};function Ni(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Ai(e,t,n[t])}))}return e}function Ai(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ri(e){return(Ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var _i=!1,Ii=null,Bi={_tinyMceHasInit:!1,_beforeInitCallbacks:[],_tinymcePluginInits:[],_settings:null,isInitComplete:function(){return Bi._tinyMceHasInit},isEditorActive:function(){return!!(Bi.isInitComplete()&&r.tinymce&&r.tinymce.activeEditor)},onInit:function(){Bi._tinyMceHasInit=!0;var e=r.AJS.Rte.getEditor();if(e.getBody().classList.add("notranslate"),u("init.rte",{editor:e}),!1!==M.get("editor-auto-focus")){var t=r.document.getElementById("content-title");t&&""===t.value?t.focus():r.AJS.Rte.editorFocus(e)}else 0},addOnInitCallback:function(e){if("function"!=typeof e)throw new Error("Attempt made to register an oninit callback that is not a function. Received: ".concat(e));Bi._tinyMceHasInit?e():s("init.rte",e)},addBeforeInitCallback:function(e){Bi._beforeInitCallbacks.push(e)},addTinyMcePluginInit:function(e){Bi._tinymcePluginInits.push(e)},preInitialise:function(e){Bi._settings=e,_i&&(_i=!1,Bi.initialise(Ii))},initialise:function(e){if(vi("confluence.editor.tinymce"),!Bi._settings)return _i=!0,void(Ii=e);e=Ni({},e);var t,n,o,i,a=Ni({},Bi._settings);r.AJS.Rte.isQuickEdit=e.isQuickEdit||!1,Bi._beforeInitCallbacks.forEach((function(e){e(a)})),u("rte-pre-resolveplugins");for(var c=0,s=Bi._tinymcePluginInits.length;c<s;c++)"function"==typeof Bi._tinymcePluginInits[c]&&Bi._tinymcePluginInits[c](a);!function(e){var t=pr("confluence-editor/i18n/translations.i18n");Ri(t);var n=new RegExp("".concat(t.ctrl_key,"\\+"),"g"),o=new RegExp("".concat(t.shift_key,"\\+"),"g"),i=function(e){return e.replace(n,"⌘").replace(o,"⇧")};for(var a in t){var c=t[a];if("object"===Ri(c))for(var s in c)r.tinymce.Env.mac&&(c[s]=i(c[s]));r.tinymce.EditorManager.addI18n("".concat(e,".").concat(a),t[a])}r.tinymce.ScriptLoader.markDone("".concat(r.tinymce.baseURL,"/langs/").concat(e,".js")),r.tinymce.Env.mac&&Array.prototype.forEach.call(r.document.querySelectorAll("#rte-toolbar .toolbar-item, #rte-toolbar .dropdown-item, #rte-savebar .aui-button"),(function(e){var t=e.getAttribute("title"),n=e.dataset.tooltip;t&&e.setAttribute("title",i(t)),n&&(e.dataset.tooltip=i(n))}))}(a.locale),function(e,t){var n;if(!1!==t)for(n in t=t||{})t.hasOwnProperty(n)&&yi[n]&&Ci(e,t[n],yi[n]);else r.document.getElementById(e).style.display="none"}("toolbar",e.toolbar),a.plugins=(t=a.plugins,n="string"==typeof e.plugins?e.plugins.split(","):e.plugins||[],o=e.excludePlugins||[],i=t.split(","),n.forEach((function(e){i.indexOf(e)<0&&i.push(e)})),(i=i.filter((function(e){return o.indexOf(e)<0}))).join(",")),a.setup=function(t){t.on("PreInit",(function(){t.schema.getSpecialElements().iframe=/<\/iframe[^>]*>/gi})),e&&"function"==typeof e.onInitialise&&e.onInitialise(t)},a.init_instance_callback=function(e){var t=Ge();Si(),r.tinymce.FocusManager.isEditorUIElement=function(e){for(var t=e,n=!1;t;){if("rte-toolbar"===t.id){n=!0;break}t=t.parentElement}return n};try{var n=a.contentCssTags,o=e.getDoc().querySelectorAll("head");if(void 0===o[0])throw"No editor <head>";o[0].innerHTML=n+o[0].innerHTML}catch(e){}r.AJS.Rte.BootstrapManager.onInit(e),ur.editorResetContentChanged(),r.AJS.Rte.getEditorFrame().setAttribute("tabindex",100),r.tinymce.isIE&&r.AJS.Rte.getEditorFrame().setAttribute("hidefocus","hidefocus"),t&&e.on("AddUndo",(function(t){var n={level:null,lastLevel:null,originalEvent:t};return e.fire("change",n)})),bi("confluence.editor.tinymce"),u("rte-ready"),t&&u("rte-begin-collab-editing")},r.tinymce.init(a)}},Pi=Bi,Di="".concat(o.a.location.protocol,"//").concat(o.a.location.host),Oi=["compat3x","auiwindowmanager","table","emotions","confluence","macroplaceholder","customtoolbar","insertwikimarkup","propertypanel","keyboardshortcuts","confmonospace","confcharmap","lists","conflist","tasklist","paste","aePaste","cursorTarget","aeTable","confluencepastetableplugin","pagelayoutplugin","iosediting","autoconvert","deletecommand","draggable","confluencesortabletablesplugin","textplaceholders","linkbrowser","insertfiles","tableAnalytics","aetextpattern","persit_scroll_position","confindentation","preserve-paragraph-formatting-on-delete","tableContentWrapper"],Mi=function(){return{autoresize_min_height:"100%",width:"100%",height:"100%",document_base_url:"".concat(Di).concat(Ce,"/"),plugins:Oi.join(","),theme:"atlassian",theme_advanced_buttons1:"formatselect,bold,italic,underline,strikethrough,forecolor,separator,table,row_before,row_after,delete_row,col_before,col_after,delete_col,delete_table,separator,bullist,numlist,tasklist,outdent,indent,blockquote,justifyleft,justifycenter,justifyright,justifyfull,separator,sup,sub,separator,undo,redo,separator,confimage,conf_macro_browser,separator,code,customtoolbar,help,monospace,separator,searchreplace,linkbrowserButton",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_resizing:!1,theme_advanced_resize_horizontal:!1,theme_advanced_statusbar_location:"none",theme_advanced_path:!1,theme_advanced_blockformats:"p,h1,h2,h3,h4,h5,h6,pre,blockquote",mode:"specific_textareas",editor_selector:"tinymce-editor",body_class:"aui-theme-default mceContentBody wiki-content",popup_css:!1,content_css:!1,editor_css:!1,custom_undo_redo:!0,custom_undo_redo_levels:20,context_path:Ce,plugin_action_base_path:"".concat(Ce,"/plugins/tinymce"),editor_plugin_action_base_path:"".concat(Ce,"/plugins/editor/tinymce"),page_id:M.get("page-id"),draft_type:null,form_name:M.get("form-name"),space_key:encodeURI(M.get("space-key")),confluence_popup_width:620,confluence_popup_height:550,editor_id:"wysiwygTextarea",indent:!1,table_tab_navigation:!1,inline_boundaries:!1,indent_use_margin:!0,end_container_on_empty_block:!0,atlassian:!0,keep_values:!0,convert_urls:!0,relative_urls:!1,remove_script_host:!1,button_tile_map:!0,gecko_spellcheck:!0,apply_source_formatting:!1,list_outdent_on_enter:!0,visual:!1,confluence_table_style:"confluenceTable",confluence_table_cell_style:"confluenceTd",confluence_table_heading_style:"confluenceTh",confluence_table_default_rows:4,confluence_table_default_cols:3,confluence_table_default_heading:!0,cleanup:!0,cleanup_on_startup:!0,fix_list_elements:!1,fix_table_elements:!0,valid_elements:"@[id|class|style|title|wysiwyg|dir<ltr?rtl|lang|xml::lang|onclick|ondblclick|onmousedown|onmouseup|onmouseover|onmousemove|onmouseout|onkeypress|onkeydown|onkeyup],a[*],strong/b,em/i,s,u,#p[align|user],-ol[type|compact],-ul[type|compact],li,br,img[imagetext|longdesc|usemap|src|border|alt=|title|hspace|vspace|width|height|align],-sub,-sup,-blockquote[cite|markup],-table[*],-tr[rowspan|width|height|align|valign|bgcolor|background|bordercolor],tbody,thead,tfoot,#td[colspan|rowspan|width|height|align|valign|bgcolor|background|bordercolor|scope],#th[colspan|rowspan|width|height|align|valign|scope],caption,#div[*],span[*],-code,#pre[*],address,-h1,-h2,-h3,-h4,-h5,-h6,hr[size|noshade],-font[face|size|color],dd,dl,dt,cite,abbr,acronym,del[datetime|cite],ins[datetime|cite],object[classid|width|height|codebase|*],param[name|value],embed[type|width|height|src|*],map[name],area[shape|coords|href|alt|target],bdo,button,col[align|char|charoff|span|valign|width],colgroup[align|char|charoff|span|valign|width],dfn,fieldset,form[action|accept|accept-charset|enctype|method],input[accept|alt|checked|disabled|maxlength|name|readonly|size|src|type|value],kbd,label[for],legend,noscript,optgroup[label|disabled],option[disabled|label|selected|value],q[cite],samp,select[disabled|multiple|name|size],small,textarea[cols|rows|disabled|name|readonly],tt,var,big",extended_valid_elements:"img[*],time[class|datetime|contenteditable|onselectstart|unselectable|oncontrolselect]",formats:{alignleft:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"left"}},{selector:"img.confluence-embedded-image",classes:"image-left"},{selector:"img,table",collapsed:!1,styles:{float:"left"}}],aligncenter:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"center"}},{selector:"img.confluence-embedded-image",classes:"image-center"},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"}}],alignright:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"right"}},{selector:"img.confluence-embedded-image",classes:"image-right"},{selector:"img,table",collapsed:!1,styles:{float:"right"}}],underline:[{inline:"u",remove:"all"},{inline:"span",styles:{textDecoration:"underline"},exact:!0}],strikethrough:[{inline:"s",remove:"all"}],removeformat:[{selector:"h1,h2,h3,h4,h5,h6,pre",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0,block:"*"},{selector:"address,article,b,big,blockquote,center,cite,code,date,dd,del,dfn,dl,dt,em,embed,font,footer,header,hgroup,i,ins,kbd,link,menu,nav,object,param,q,s,samp,script,section,small,strike,strong,style,sub,sup,time,tt,u,var",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"table",attributes:["cellpadding","cellspacing","border"],split:!1,expand:!1,deep:!0},{selector:"*",attributes:["style","color","bgcolor","title","lang"],split:!1,expand:!1,deep:!0}]},forced_root_block:"p",force_p_newlines:!0,force_br_newlines:!1,padd_empty_with_br:!0,allow_unsafe_link_target:!0,paste_remove_styles_if_webkit:!1,object_resizing:!1,automatic_uploads:!1,allow_html_data_urls:!0,images_dataimg_filter:function(){return!1}}};function Li(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Fi(e,t,n[t])}))}return e}function Fi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ji(e){return(ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ui=function(e,t){if("number"==typeof e)return e;if("string"==typeof e&&/^\d+/.test(e))try{return parseInt(e)}catch(e){return t}return t},Wi=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scope=null,this.listeners=null,this.inDispatch=!1,this.scope=t||this,this.listeners=[]}var t,n,o;return t=e,(n=[{key:"add",value:function(e,t){return this.listeners.push({cb:e,scope:t||this.scope}),e}},{key:"addToTop",value:function(e,t){var n={cb:e,scope:t||this.scope};return this.inDispatch?this.listeners=[n].concat(this.listeners):this.listeners.unshift(n),e}},{key:"remove",value:function(e){var t=this.listeners,n=null;return r.tinymce.each(t,(function(r,o){if(e==r.cb)return n=r,t.splice(o,1),!1})),n}},{key:"dispatch",value:function(){var e,t,n,r=this,o=arguments,i=r.listeners;for(r.inDispatch=!0,t=0;t<i.length&&!1!==(n=(e=i[t]).cb.apply(e.scope,o.length>0?o:[e.scope]));t++);return r.inDispatch=!1,n}}])&&Hi(t.prototype,n),o&&Hi(t,o),e}();function zi(e){return"object"===ji(e)&&e.name}function qi(e,t){return"string"==typeof t?e.queryCommandState(t):!!zi(t)&&e.queryCommandState(t.name)}function Vi(e,t,n,r){return e.execCommand(t,n,r)}var $i={createProfileForCommentEditor:function(){return{plugins:["searchreplace","confluenceimagedialog","autocompletemacro","confluencemacrobrowser","confluenceleavecomment","confluencewatch","autoresize"]}},createProfileForPageEditor:function(e){var t=["searchreplace","confluencedrafts","confluenceimagedialog","autocompletemacro","confluencemacrobrowser","flextofullsize","referrer"];return e&&e.versionComment&&t.push("confluenceversioncomment"),e&&e.notifyWatchers&&t.push("confluencenotifywatchers"),{plugins:t}},createProfileForTemplateEditor:function(){return{plugins:["searchreplace","confluenceimagedialog","autocompletemacro","confluencemacrobrowser","confluenceleavetemplate","flextofullsize","templateeditor"]}}};function Ki(e){return(Ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ji(e){var t=function(){function e(e){this.init=this.init(e)}e.INCOMPATIBLE_PLUGINS=["dfe"],e.shouldInit=function(){var e=c()("body");return e.hasClass("edit")||e.hasClass("create")||e.hasClass("copy-page")},e.suppressIncompatiblePlugins=function(){for(var t=function(){},n=0,o=e.INCOMPATIBLE_PLUGINS.length;n<o;n++)r.tinymce.PluginManager.lookup[e.INCOMPATIBLE_PLUGINS[n]]=t},e.prototype.init=function(e){var t=c.a.ui.keyCode,n=c()("#content-title"),r=c()("form.editor"),i=c()(e.getBody()),a=c()(e.getDoc()),s=c()("#editor-precursor"),l=c()(e.getWin()),u=c()("#toolbar"),d=a.scrollTop(),f=parseInt(i.css("padding-top"),10)+parseInt(i.css("margin-top"),10),m=parseInt(s.css("padding-top"),10),p=o.a.requestAnimationFrame||o.a.webkitRequestAnimationFrame;function g(t){var n=this;e.plugins.customtoolbar.toggleToolbarButtons(t,t,t,(function(){return!c()(n).parent().hasClass("close")}))}function h(e){return e.getBoundingClientRect().top+document.body.scrollTop}function v(){var e=d-a.scrollTop(),t=h(u[0])-h(r[0]),n=s.outerHeight(),o=u.outerHeight();s.css("top","".concat(t+o+e+m,"px")),i.css("padding-top","".concat(n+f,"px"))}return n.on("keydown",(function(n){var r=n.keyCode||n.which;r!==t.ENTER&&r!==t.DOWN||(n.preventDefault(),n.stopPropagation(),e.focus())})).on("focus click",(function(){g(!0)})),l.on("focus",(function(){g(!1)})),function(e){!function t(){e(t),v()}(),i.on("scroll mousewheel",(function(){setTimeout(v,0)}))}(p),!0};var t={controlHandlers:{},controls:{bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",justifyleft:"JustifyLeft",justifycenter:"JustifyCenter",justifyright:"JustifyRight",bullist:"InsertUnorderedList",numlist:"InsertOrderedList",tasklist:"InsertInlineTaskList",outdent:"Outdent",indent:"Indent",cut:"Cut",copy:"Copy",paste:"Paste",undo:"Undo",redo:"Redo",removeformat:"RemoveFormat",sub:"subscript",sup:"superscript",forecolor:"ForeColor",forecolorpicker:"mceForeColor",backcolor:"HiliteColor",backcolorpicker:"mceBackColor",charmap:"mceCharMap",visualaid:"mceToggleVisualAid",anchor:"mceInsertAnchor",newdocument:"mceNewDocument",blockquote:"mceBlockQuote"},stateControls:["bold","italic","underline","bullist","numlist","tasklist","justifyleft","justifycenter","justifyright","strikethrough","sub","sup","monospace"],init:function(t,n){var o=e.shouldInit(),i=this;o&&e.suppressIncompatiblePlugins(),i.editor=t,i.url=n,i.settings=r.tinymce.extend({theme_advanced_toolbar_location:"bottom",theme_advanced_buttons1:"formatselect,bold,italic,underline,strikethrough,forecolor,separator,table,row_before,row_after,delete_row,col_before,col_after,delete_col,delete_table,separator,bullist,numlist,tasklist,outdent,indent,blockquote,justifyleft,justifycenter,justifyright,justifyfull,separator,sup,sub,separator,undo,redo,separator,conflink,oldlinkbrowserButton,confimage,conf_macro_browser,separator,search,code,customtoolbar, monospacep,h1,h2,h3,h4,h5,h6,pre,blockquote",readonly:t.settings.readonly},t.settings),t.on("init",(function(){t.settings.readonly||(t.on("NodeChange",(function(e){i.nodeChanged(t,null,e.element,!1,{parents:e.parents})})),t.on("keyup",(function(){i._updateUndoStatus(t)})),t.on("MouseUp",(function(){i._updateUndoStatus(t)})),t.dom.bind(t.dom.getRoot(),"dragend",(function(){i._updateUndoStatus(t)})),o&&new e(t))}))},execCommand:function(e,t,n){var r=this["_".concat(e)];return!!r&&(r.call(this,t,n),!0)},renderUI:function(e){return this.bindControls(),{iframeContainer:r.tinymce.DOM.get("rte"),editorContainer:"wysiwyg",sizeContainer:void 0,deltaHeight:e.deltaHeight}},getInfo:function(){return{longname:"Confluence theme",author:"Atlassian",authorurl:"http://tinymce.moxiecode.com",version:"".concat(r.tinymce.majorVersion,".").concat(r.tinymce.minorVersion)}},bindControls:function(){var e=this,t=e.settings;r.tinymce.each(r.tinymce.explode(t.theme_advanced_buttons1),(function(t){if(!e.createEditorButtons(t))switch(t){case"formatselect":e.createBlockFormats()}})),e.bindControlHandlers(),e.renderToolbarButtons()},renderToolbarButtons:function(){var e=this;var t={toolbar:"toolbar-primary",title:"",tooltip:"",cmd:"",className:"",locationGroup:null,weight:1/0,onclick:null},n=[];for(var r in this.editor.buttons)n.push(Li({},t,this.editor.buttons[r],{id:r,weight:Ui(this.editor.buttons[r].weight,1/0)}));n=n.filter((function(e){return!!e.locationGroup})),["toolbar-primary"].forEach((function(t){var r=c()(".".concat(t));n.filter((function(e){return e.toolbar===t})).sort((function(e,t){return e.weight-t.weight})).forEach((function(t){e.createEditorButtons(t.id);var n,o=r.find(".".concat(t.locationGroup)),i=c()('<li id="'.concat((n=t).id,'" class="toolbar-item ').concat(n.className,'" data-tooltip="').concat(n.tooltip,'" data-weight="').concat(n.weight,'">\n                            <a class="toolbar-trigger aui-button aui-button-subtle" href="#" data-control-id="').concat(n.id,'">\n                                <span class="icon ').concat(n.icon,'"></span>\n                                <span class="trigger-text">').concat(n.title,"</span>\n                            </a>\n                        </li>"));o.append(i).removeClass("hidden")}))}))},createEditorButtons:function(e){var t=this.editor.buttons[e];if(!t)return!1;t.cmd?this.controls[e]=t.cmd:this.controls[e]={func:t.onclick,name:e}},bindControlHandlers:function(){var e=this;e.controlHandlers.buttons={},e.controlHandlers.buttons.state=new Wi,e.controlHandlers.buttons.click=new Wi,e.controlHandlers.buttons.click.add((function(t){var n=e.controls[t];"string"===ji(n)?Vi(ge().getEditor(),e.controls[t]):zi(n)&&n.func()}))},createBlockFormats:function(){var e=this;e.controlHandlers.formatselect={},e.controlHandlers.formatselect.state=new Wi,e.controlHandlers.formatselect.click=new Wi,e.controlHandlers.formatselect.click.add((function(e){Vi(ge().getEditor(),"FormatBlock",!1,e)}))},createForeColorMenu:function(){return!0},_updateUndoStatus:function(e){var t=e.undoManager;this.controlHandlers.buttons.state.dispatch("undo","disabled",!t.hasUndo()&&!t.typing),this.controlHandlers.buttons.state.dispatch("redo","disabled",!t.hasRedo())},nodeChanged:function(e,t,n,o,i){var a=this;r.tinymce.each(a.stateControls,(function(t){a.controlHandlers.buttons.state.dispatch(t,"active",!!qi(e,a.controls[t]))})),a._updateUndoStatus(e),a.controlHandlers.buttons.state.dispatch("outdent","disabled",!qi(e,"Outdent"));var c=function(e){for(var t=i.parents,n=0;n<t.length;n++)if(e(t[n]))return t[n]}(e.dom.isBlock);c&&a.controlHandlers.formatselect.state.dispatch(c.nodeName.toLowerCase())}};return{Editor:e,ThemeOptions:t}}();r.tinymce.ThemeManager.requireLangPack("advanced"),r.tinymce.create("tinymce.themes.ConfluenceTheme",t.ThemeOptions),r.tinymce.ThemeManager.add("atlassian",r.tinymce.themes.ConfluenceTheme),o.a.requestAnimFrame=o.a.requestAnimationFrame||o.a.webkitRequestAnimationFrame;var n=Mi();0==n.page_id&&(n.page_id=null,n.draft_type=M.get("draft-type")),Pi.addBeforeInitCallback((function(e){e.contentCssTags=r.document.querySelector('script[title="editor-css"]').innerHTML,e.language=M.get("action-locale").replace("_","-");var t=M.get("min-editor-height");t&&(e.autoresize_min_height=t)}));var i=!(M.get("remote-user")&&M.get("confluence.prefs.editor.disable.autocomplete"));if(i&&(n.plugins+=",autocomplete,autocompletelink,autocompletemedia"),n.locale="object"===Ki(e)&&void 0!==e.locale?e.locale:"",!!M.get("auto-start")){if(u("rte-loaded",{editPermission:!0}),Ge()){var a=r.document.getElementById(n.editor_id);u("rte-collaborative-content-ready",{title:M.get("page-title")||M.get("original-content-title")||"",editorContent:a.value,confRev:M.get("conf-revision"),syncRev:r.document.getElementById("syncRev").value,syncRevSource:M.get("sync-revision-source")})}vi("confluence.editor"),i&&(n.plugins+=",autocompletemacro");var s="0"==="".concat(M.get("page-id")),l=function(e,t){if("template"===e)return $i.createProfileForTemplateEditor();if("comment"===e)return $i.createProfileForCommentEditor();var n={versionComment:!t,notifyWatchers:!t};return $i.createProfileForPageEditor(n)}(M.get("content-type"),s).plugins.join(",");l&&(n.plugins+=",".concat(l)),Pi.preInitialise(n),Pi.initialise(),bi("confluence.editor")}else Pi.preInitialise(n)}Si(),dr(),void 0!==r.AJS.Rte&&void 0===r.AJS.Rte.BootstrapManager&&(r.AJS.Rte.BootstrapManager=Pi),void 0!==r.AJS.Rte&&void 0===r.AJS.Rte.Placeholder&&(r.AJS.Rte.Placeholder=pe),void 0!==r.AJS.Rte&&void 0===r.AJS.Rte.BookmarkManager&&(r.AJS.Rte.BookmarkManager=_e),Object(r.define)("confluence-editor/loader/tinymce-bootstrap",(function(){return Pi})),Object(r.define)("confluence-editor/editor/atlassian-editor",(function(){return ki})),Object(r.define)("confluence-editor/editor/atlassian-editor-content",(function(){return ur})),Object(r.define)("confluence-editor/utils/tinymce-node-utils",(function(){return Ee})),Object(r.define)("confluence-editor-v4/build/editor",(function(){ci().then((function(){var e={locale:M.get("user-locale").replace("_","-")};r.AJS.toInit((function(){Ji(e)}))}))}))},0:function(e,t,n){e.exports=n("./src/index.js")},"com.atlassian.confluence.editor:attachments-insert-utils-resources/require('confluence-editor/utils/attachments-insert-utils')":function(e,t){e.exports=require("confluence-editor/utils/attachments-insert-utils")},"com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js/require('confluence-macro-browser/macro-browser')":function(e,t){e.exports=require("confluence-macro-browser/macro-browser")},"com.atlassian.confluence.restplugin:confluence-rest/require('confluence-rest/confluence-rest')":function(e,t){e.exports=require("confluence-rest/confluence-rest")},"confluence.web.components:confluence/require('confluence/root')":function(e,t){e.exports=require("confluence/root")},"confluence.web.resources:ajs/require('ajs')":function(e,t){e.exports=require("ajs")},"confluence.web.resources:jquery/require('jquery')":function(e,t){e.exports=require("jquery")},"confluence.web.resources:macro-js-overrides/require('confluence/macro-js-overrides')":function(e,t){e.exports=require("confluence/macro-js-overrides")},"confluence.web.resources:meta/require('confluence/meta')":function(e,t){e.exports=require("confluence/meta")}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:bookmark-manager-conf-frontend', location = 'bookmark/atlassian-editor-bookmark-manager.js' */
define("confluence-editor/atlassian-editor-bookmark-manager",["tinymce","ajs"],function(c,e){var b;return{storeBookmark:function(){var a=c.activeEditor,d=c.DOM.getViewPort(c.activeEditor.getWin());a.focus();a=a.selection.getRng();a=a.cloneRange&&"function"===typeof a.cloneRange?a.cloneRange():a.duplicate&&a.duplicate()||a;b={scrollX:d.x,scrollY:d.y,range:a};e.log("Storing bookmark");e.log(b)},restoreBookmark:function(){var a=c.activeEditor.selection,d=c.activeEditor.getWin();e.log("Restoring bookmark");
e.log(b);b&&(d.scrollTo(b.scrollX,b.scrollY),d.focus(),a.setRng(b.range));b=null}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/atlassian-editor-bookmark-manager","AJS.Rte.BookmarkManager");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:analytics', location = 'analytics/editor-ready-collab-mode-analytics.js' */
define("confluence-editor/analytics/editor-ready-collab-mode-analytics",["ajs","confluence/dark-features","confluence/meta"],function(a,c,b){return{trigger:function(){if(a.Rte&&a.Rte.getEditor()&&(a.$("#editpageform").length||a.$("#createpageform").length)){var d;d="confluence.editor.ready.collab.mode."+(c.isEnabled("site-wide.synchrony")&&c.isEnabled("site-wide.shared-drafts")?"on":c.isEnabled("site-wide.shared-drafts")?"limited":"off");var e=b.get("synchrony-connection-order")?b.get("synchrony-connection-order"):
"",f=b.get("synchrony-connection-type")?b.get("synchrony-connection-type"):"";a.trigger("analyticsEvent",{name:d,data:{connectionOrder:e,connectionType:f}})}}}});require("confluence/module-exporter").safeRequire("confluence-editor/analytics/editor-ready-collab-mode-analytics",function(a){require("ajs").bind("rte-ready",function(){a.trigger()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:unpublished-changes', location = 'unpublished-changes/unpublished-changes.soy' */
// This file was automatically generated from unpublished-changes.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.UnpublishedChanges.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.UnpublishedChanges == 'undefined') { Confluence.Templates.UnpublishedChanges = {}; }


Confluence.Templates.UnpublishedChanges.lozenge = function(opt_data, opt_ignored) {
  return '<a id="unpublished-changes-lozenge" href="#" class="view-diff-link" title="' + soy.$$escapeHtml(opt_data.tooltip) + '"><span class="aui-lozenge aui-lozenge-complete aui-lozenge-subtle unpublished-changes-lozenge">' + soy.$$escapeHtml(opt_data.label) + '</span></a>';
};
if (goog.DEBUG) {
  Confluence.Templates.UnpublishedChanges.lozenge.soyTemplateName = 'Confluence.Templates.UnpublishedChanges.lozenge';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:unpublished-changes', location = 'unpublished-changes/unpublished-changes.js' */
define("confluence-editor/unpublished-changes/unpublished-changes",["jquery","confluence/legacy","ajs","underscore","tinymce"],function(c,a,g,i,h){return{init:function(e){var f=c(a.Templates.UnpublishedChanges.lozenge({tooltip:g.I18n.getText("editor.unpublished.changes.lozenge.tooltip"),label:g.I18n.getText("editor.unpublished.changes.lozenge.label")})),h=function(d){d=i.isBoolean(d)?d:!0;a.Editor.UI.setButtonState(d,c("#rte-button-publish"))},j=function(d,b){var a=b||function(){};(i.isBoolean(d)?
d:1)?f.addClass("visible").fadeIn("fast",a):f.fadeOut("fast",function(){c(this).hide().removeClass("visible");a()})},b={show:function(){f.hasClass("visible")||j(!0,h)},hide:function(){j(!1);h(!1)}};g.bind("rte-ready",function(){var a=c("#content-title-div");b.hide();f.insertBefore(a);f.tooltip();c("#content-title").on("keydown change",b.show);e.onChange.add(b.show);e.onKeyDown.add(b.show);e.onLoad.add(function(){c(e.startContent).text().trim()&&0<g.Meta.get("draft-id")&&b.show()});f.on("mouseenter.tipsy",
function(){g.trigger("analytics",{name:"confluence.editor.unpublished-changes.lozenge.hover"})});e.addCommand("mceConf.UnpublishedChangesLozenge.show",b.show);e.addCommand("mceConf.UnpublishedChangesLozenge.hide",b.hide)})},getInfo:function(){return{longname:"Unpublished Changes",author:"Atlassian",authorurl:"http://www.atlassian.com",version:h.majorVersion+"."+h.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/unpublished-changes/unpublished-changes",function(c){var a=require("tinymce");a.create("tinymce.plugins.UnpublishedChanges",c);a.PluginManager.add("unpublishedchanges",a.plugins.UnpublishedChanges)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-v3-v4-shared-resources', location = 'tinymce3/plugins/confluencelist/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/confluencelist/editor_plugin_src",["jquery","ajs","tinymce"],function(b,g,h){return{init:function(l){!h.isIE8&&l.onKeyDown.add(function(d,k){function j(a){a&&a.lastChild&&!d.dom.isBlock(a.lastChild)&&!b(a.lastChild).is("br")&&b(a).append("<br/>")}if(8===k.keyCode){var c=d.selection.getRng(!0),e=b(c.startContainer).closest("li",d.getBody());if(0!==e.length&&g.EditorUtils.isCursorAtStartOf(e[0],c)){var c=e.prev("li"),f,i=e[0],a;if(0<c.length)return f=c[0],
a=b(i.firstChild),h.isIE9&&0===a.length?a=b("<br/>").appendTo(e):a.is("p")&&(a=a.contents().first()),d.undoManager.beforeChange(),d.undoManager.add(),b(f.lastChild).is("p")&&!d.dom.isBlock(i.firstChild)?(j(f.lastChild),e.contents().each(function(a,c){if(d.dom.isBlock(c))return!1;b(f.lastChild).append(b(c).detach())})):b(i.firstChild).is("p")&&!d.dom.isBlock(f.lastChild)?(j(f),b.each(b.makeArray(c.contents()).reverse(),function(a,c){if(d.dom.isBlock(c))return!1;b(i.firstChild).prepend(b(c).detach())})):
j(f),c.append(e.detach().contents()),a[0]&&g.EditorUtils.setCursorAtStartOfContents(a[0]),d.undoManager.add(),h.dom.Event.cancel(k)}}})},getInfo:function(){return{longname:"Confluence List Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:h.majorVersion+"."+h.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/confluencelist/editor_plugin_src",function(b){var g=require("tinymce");g.create("tinymce.plugins.ConfluenceListPlugin",b);g.PluginManager.add("confluencelist",g.plugins.ConfluenceListPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-v3-v4-shared-resources', location = 'tinymce3/plugins/confluencepastetable/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/confluencepastetable/editor_plugin_src",["jquery","document"],function(g,c){return{init:function(i){function m(a){var d={id:!0,"class":!0,style:!0,rowspan:!0,colspan:!0,"data-mce-style":!0,"data-mce-bogus":!0,"data-macro-name":!0,"data-macro-parameters":!0,"data-macro-body-type":!0,"data-highlight-colour":!0,"data-highlight-class":!0},f=["highlight","nohighlight","relative-table","fixed-table"],b,e=0,c=[],h=g(a);if(!a||j(a))return a;a&&a.getAttribute&&(b=
a.getAttribute("class"));if(b&&0<=b.indexOf("table-wrap"))if(a=g("table",a),a.length)g(a).unwrap(),a=a[0];else return null;if((!a.tagName?0:"TABLE"===a.tagName||"TR"===a.tagName||"TH"===a.tagName||"TD"===a.tagName||"TBODY"===a.tagName||"THEAD"===a.tagName||"TFOOT"===a.tagName||"COL"===a.tagName||"COLGROUP"===a.tagName||"CAPTION"===a.tagName)&&a.attributes){for(;e<=a.attributes.length;)(b=a.attributes[e])&&!0===b.specified&&!d[b.name]?a.removeAttribute(b.name):e++;k(a)&&c.push(k(a));d=0;for(e=f.length;d<
e;d++)f[d].exec||h.hasClass(f[d])&&c.push(f[d]);(f=h.attr("data-highlight-class"))&&c.push(f);(f=h.attr("data-highlight-colour"))&&c.push("highlight-"+f);h.attr("class",c.join(" "))}return a}function k(a){return!a.tagName?"":"TABLE"===a.tagName?"confluenceTable":"TH"===a.tagName?"confluenceTh":"TD"===a.tagName?"confluenceTd":""}function j(a){var d="";a&&a.getAttribute&&(d=a.getAttribute("class"));return!a.tagName?!1:"TABLE"!==a.tagName?!1:!d?!1:-1!==d.indexOf("wysiwyg-macro")}function l(a,d,c){for(var a=
c.node,d=m,b=a,e="";b;)if("function"===typeof d&&(b=d(b)),b)b.firstChild&&e.parentNode!==b&&!j(b)?(e=b,b=b.firstChild):b.nextSibling?(e=b,b=b.nextSibling):(e=b,b=b.parentNode);else break;c.node=a}i.onInit.add(function(){g(c).bind("postPaste",l)});i.onRemove.add(function(){g(c).unbind("postPaste",l)})},getInfo:function(){return{longname:"ConfluencePasteTablePlugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/confluencepastetable/editor_plugin_src",function(g){var c=require("tinymce");c.create("tinymce.plugins.ConfluencePasteTablePlugin",g);c.PluginManager.add("confluencepastetableplugin",c.plugins.ConfluencePasteTablePlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-v3-v4-shared-resources', location = 'tinymce3/plugins/confcleanup/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/confcleanup/editor_plugin_src",["tinymce","jquery"],function(d,f){return{init:function(g){if(d.isWebKit){var h={},i=function(a,c){var b=a[c];b||(b={},a[c]=b);return b};f("#format-dropdown").find("ul.aui-dropdown li").each(function(){var a=f("a",this),c=a.css("font-size"),b=a.css("font-weight"),a=a.css("color"),a=i(h,a),b=i(a,b);b[c]||(b[c]=f(this).attr("data-format"))});g.onNodeChange.add(function(a){for(var c=a.dom.select("span.Apple-style-span",a.dom.doc.body),
b=a.dom.select("font.Apple-style-span",a.dom.doc.body),c=c.concat(b),b=0,k=c.length;b<k&&!a.dom.is(c[b],'[face="mceinline"]');b++){var e;a:{e=f(c[b]);var d=h[e.css("color")],g=void 0;if(d&&(g=d[e.css("font-weight")])){e=g[e.css("font-size")];break a}e=null}e&&(d=a.selection.getBookmark(),e&&a.dom.remove(c[b],1),a.selection.moveToBookmark(d),a.execCommand("FormatBlock",!1,e))}})}g.onNodeChange.add(function(a){for(var c=a.dom.select("img",a.dom.doc.body),b=c.length,d=0;d<b;d++)"file:///"===c[d].src.substr(0,
8)&&a.dom.remove(c[d])});if(d.isIE9){var j=function(a){a.getBody().childNodes.length||a.setContent("<p>﻿</p>")};g.onNodeChange.add(j);g.onSetContent.add(j)}},getInfo:function(){return{longname:"ConfluenceCleanupPlugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/confcleanup/editor_plugin_src",function(d){var f=require("tinymce");f.create("tinymce.plugins.ConfluenceCleanupPlugin",d);f.PluginManager.add("confluencecleanupplugin",f.plugins.ConfluenceCleanupPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.reliablesave:reliable-save-conf-frontend', location = 'templates/reliable-save.soy' */
// This file was automatically generated from reliable-save.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Editor.Reliable.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.Reliable == 'undefined') { Confluence.Templates.Editor.Reliable = {}; }


Confluence.Templates.Editor.Reliable.draftMessage = function(opt_data, opt_ignored) {
  var output = '<div id="draft-messages">';
  if (opt_data.isNewPage) {
    if (opt_data.existingDraft.title) {
      var escapedTitle__soy8 = '' + soy.$$escapeHtml(opt_data.existingDraft.title);
      output += soy.$$filterNoAutoescape(AJS.format('\u4f60\u6dfb\u52a0\u7684\u4e00\u4e2a\u65b0\u9875\u9762 {0} \u53eb\x26#8216;{1}\x26#8217; \u5df2\u7ecf\u4fdd\u5b58\u8349\u7a3f\u3002',opt_data.existingDraft.date,escapedTitle__soy8));
    } else {
      output += soy.$$filterNoAutoescape(AJS.format('\u4f60\u6dfb\u52a0\u7684\u4e00\u4e2a\u65b0\u9875\u9762{0} \u5df2\u7ecf\u4fdd\u5b58\u8349\u7a3f\u3002',opt_data.existingDraft.date));
    }
    output += ' ' + soy.$$filterNoAutoescape(AJS.format('\u662f\u5426 {0}\u7ee7\u7eed\u7f16\u8f91 {1} \u8fd8\u662f {2} \u653e\u5f03 {3} ?','<a href="#" class="use-draft"> ','</a>','<a href="#" class="discard-draft"> ','</a>'));
  } else {
    output += soy.$$filterNoAutoescape(AJS.format('\u4f60\u7f16\u8f91\u7684\u9875\u9762{0}\u7684\u4e00\u4e2a\u7248\u672c\u5df2\u7ecf\u4fdd\u5b58\u8349\u7a3f\u3002',opt_data.existingDraft.date)) + ((opt_data.mergeRequired) ? ' ' + soy.$$escapeHtml('\u7531\u4e8e\u9875\u9762\u5df2\u88ab\u66f4\u65b0\uff0c\u4f60\u6240\u505a\u7684\u4fee\u6539\u5c06\u4e0e\u6700\u65b0\u7248\u672c\u5408\u5e76\u66f4\u65b0\u3002') : '') + ((opt_data.conflictFound) ? ' ' + soy.$$filterNoAutoescape(AJS.format('\u7531\u4e8e\u9875\u9762\u5df2\u88ab\u66f4\u65b0\uff0c\u5e76\u4e0e\u4f60\u6240\u505a\u7684\u4fee\u6539\u5b58\u5728\u51b2\u7a81\uff0c\u56e0\u6b64\u65e0\u6cd5\u5408\u5e76\u66f4\u65b0\u3002\u4f60\u5e0c\u671b{0}\u67e5\u770b\u51b2\u7a81{1}\u8fd8\u662f{2}\u5ffd\u7565{3}\u4fee\u6539\uff1f','<a href="?pageId=' + opt_data.pageId + '&viewConflict=true&spaceKey=' + opt_data.spaceKey + '" >','</a>','<a href="#" class="discard-draft">','</a>','<a href="' + "" + '/users/viewmydrafts.action">','</a>')) : (opt_data.mergeRequired) ? ' ' + soy.$$filterNoAutoescape(AJS.format('\u4f60\u60f3\u8981 {0}\u67e5\u770b{1}, {2}\u5408\u5e76\u548c\u7ee7\u7eed\u7f16\u8f91{3} \u6216\u8005{4}\u653e\u5f03{5} \u5b83?','<a id="view-diff-link-notification" href="#" class="view-diff-link">','</a>','<a href="#" class="use-draft"> ','</a>','<a href="#" class="discard-draft">','</a>')) : ' ' + soy.$$filterNoAutoescape(AJS.format('\u4f60\u60f3\u8981 {0}\u67e5\u770b\u53d8\u66f4{1}, {2}\u7ee7\u7eed\u7f16\u8f91{3} \u6216\u8005{4}\u653e\u5f03{5} \u5b83?','<a id="view-diff-link-notification" href="#" class="view-diff-link">','</a>','<a href="#" class="use-draft"> ','</a>','<a href="#" class="discard-draft">','</a>')));
  }
  output += '</div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Reliable.draftMessage.soyTemplateName = 'Confluence.Templates.Editor.Reliable.draftMessage';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.reliablesave:reliable-save-conf-frontend', location = 'js/reliable-save.js' */
'use strict';define("confluence-editor-reliable-save/reliable-save","ajs confluence/legacy underscore jquery window document confluence/api/constants confluence-editor/editor/page-editor-message confluence-editor/editor/page-editor-quit-dialog".split(" "),function(a,c,n,e,u,L,p,b,D){function v(){return a.Meta.get("shared-drafts")}function w(){return a.Meta.getBoolean("new-page")}function x(){c.Editor.UI.toggleSavebarBusy(!1)}function q(c){var e="\u5904\u7406\u8bf7\u6c42\u65f6\u51fa\u9519\u3002";
b.closeMessages(["generic-error"]);b.handleMessage("generic-error",{type:"error",message:e},f);a.logError("Generic error: "+JSON.stringify(c))}function f(){var b=e("#draft-messages");0<b.length&&(b.is(":visible")&&a.Confluence.Analytics.publish("rte.notification.draft"),b.find("a.use-draft").click(function(b){b.stopPropagation();b.preventDefault();c.Editor.Drafts.useDraft();a.Confluence.Analytics.publish("rte.notification.draft.resume")}),b.find("a.discard-draft").click(function(b){b.stopPropagation();
b.preventDefault();h.Draft.discardDraft(a.Meta.get("page-id"),a.Meta.get("existing-draft-id")).done(h.Draft.onSuccessDiscardDraft).fail(h.Draft.onErrorDiscardDraft)}))}function G(){e("#editor-restore-title-link").click(function(c){c.stopPropagation();c.preventDefault();e("#content-title").val(a.Meta.get("latest-published-page-title"));b.closeMessages(["rename-during-limited-mode"])})}function r(){a.Meta.set("access-mode","READ_ONLY");b.closeMessages(["read-only-mode"]);b.handleMessage("read-only-mode",
{title:"\u8fd9\u662f\u53ea\u8bfb\u7f51\u7ad9",type:"error",message:"\u4ece\u73b0\u5728\u5f00\u59cb\uff0c\u60a8\u7684\u4efb\u4f55\u6539\u52a8\u90fd\u65e0\u6cd5\u4fdd\u5b58\u3002 \u5f53\u60a8\u53ef\u4ee5\u518d\u6b21\u5f00\u59cb\u7f16\u8f91\u65f6\u6211\u4eec\u4f1a\u901a\u77e5\u60a8\u3002"});c.Editor.UI.setButtonsState(!0);c.Editor.UI.toggleSavebarBusy(!1);c.Editor.UI.setButtonState(!1,c.Editor.UI.saveButton);c.Editor.UI.setButtonState(!1,c.Editor.UI.cancelButton)}function A(c){var e="\u770b\u8d77\u6765\u60a8\u7684\u4f1a\u8bdd\u5df2\u8fc7\u671f\u3002\u91cd\u65b0\u767b\u5f55\u4ee5\u7ee7\u7eed\u5de5\u4f5c\u3002\n \u003cdiv\u003e\u003ca href=\u0022dashboard.action\u0022 target=\u0022_blank\u0022\u003e\u767b\u5f55\u003c/a\u003e\u003c/div\u003e";b.closeMessages(["noauthorized"]);b.handleMessage("noauthorized",{title:"\u4e0d\u80fd\u8fde\u63a5\u670d\u52a1\u5668",
type:"error",message:e},f);c&&a.trigger("rte.safe-save.invalid-xsrf-token")}function E(){var c="\u65e0\u6cd5\u4fdd\u5b58\u9875\u9762\u3002\u8bf7\u68c0\u67e5\u4e0e\u670d\u52a1\u5668\u901a\u4fe1\uff0c\u6216\u68c0\u67e5\u5185\u5bb9\u662f\u5426\u6709\u7279\u6b8a\u5b57\u7b26/emoji\u8868\u60c5\u3002";b.closeMessages(["server-offline"]);b.handleMessage("server-offline",{type:"error",message:c},f)}var F=[],t=!1,h={Draft:{discardDraft:function(b,c){b={draftId:c,pageId:b,type:a.Meta.get("draft-type"),spaceKey:a.Meta.get("space-key")};return e.ajax({type:"DELETE",url:p.CONTEXT_PATH+"/rest/tinymce/1/drafts/discard",data:e.toJSON(b),contentType:"application/json",
dataType:"json"})},onSuccessDiscardDraft:function(){w()||a.Meta.set("draft-id","0");b.closeMessages(["draft-message"]);b.handleMessage("discarding-successfull",{type:"info",message:"\u4f60\u7684\u8349\u7a3f\u5df2\u7ecf\u88ab\u5e9f\u5f03\u3002",close:"auto"},f);a.Confluence.Analytics.publish("rte.notification.draft.discard")},onErrorDiscardDraft:function(c){switch(c.status){case 403:A(!0);break;case 404:b.handleMessage("draft-deleted",{type:"info",message:"\u6b64\u8349\u7a3f\u5df2\u7ecf\u88ab\u5e9f\u5f03\u3002"},f);
break;case 405:r();break;case 422:b.handleMessage("discarding-invalid",{type:"error",message:"\u6b64\u8349\u7a3f\u65e0\u6548\u3002\u6709\u53ef\u80fd\u662f\u5df2\u7ecf\u88ab\u5176\u4ed6\u4eba\u5220\u9664\u6216\u8005\u662f\u4f60\u7684\u767b\u5f55\u8fc7\u671f\u3002"},f);break;default:b.handleMessage("discarding-error",{type:"error",message:"\u53d1\u751f\u672a\u77e5\u9519\u8bef. \u8bf7\u68c0\u67e5\u65e5\u5fd7."},f)}}}};h._internal=c.SafeSafe&&c.SafeSave._internal?c.SafeSave._internal:{};h._internal.onSuccessfulResponse=function(b){e("#rte-button-overwrite").unbind("click.overwrite");var f={dataType:"json",contentId:a.Meta.get("content-id"),draftType:a.Meta.get("draft-type")};
a.safe.post(p.CONTEXT_PATH+"/json/stopheartbeatactivity.action",f,function(){a.log("Stop heartbeat activity on",f.draftType,"id",f.contentId)},"json").fail(function(b,c,e){a.logError("Server error on stop heartbeat activity request:");a.log(e)}).always(function(){var a=b._links.webui;a?0!==a.indexOf("/")?u.location=a:u.location=p.CONTEXT_PATH+a:(c.Editor.isPublishing(!1),x())})};h.resetUnrecoverableEditorError=function(){t=!1};h.initialize=function(){function z(d){x();switch(d.status){case 400:b.closeMessages(["empty-title",
"duplicate-title","title-too-long","legacy-draft-deprecated","utf8-validation-failed"]);0<=d.responseText.indexOf(k.duplicatedTitle)?b.handleMessage("duplicate-title",{type:"error",message:a.format("\u4e00\u4e2a\u6807\u9898\u4e3a \u0027\u0027{0}\u0027\u0027 \u7684\u9875\u9762\u5df2\u7ecf\u5b58\u5728\u4e8e\u8be5\u7a7a\u95f4\u4e2d\u3002\u4e3a\u60a8\u7684\u9875\u9762\u8f93\u5165\u4e00\u4e2a\u4e0d\u540c\u7684\u6807\u9898\u3002",a.escapeHtml(e("#content-title").val()))}):0<=d.responseText.indexOf(k.titleTooLong)?b.handleMessage("title-too-long",{type:"error",message:"\u6807\u9898\u4e0d\u80fd\u957f\u4e8e 255 \u4e2a\u5b57\u7b26\u3002"},f):0<=d.responseText.indexOf(k.publishNewDraftDeprecated)||0<=d.responseText.indexOf(k.existingDraftNotFound)?
a.Meta.get("new-page")&&v()&&!c.Editor.hasContentChanged()?(a.trigger("rte.legacy-draft-can-be-migrated"),b.handleMessage("legacy-draft-deprecated",{type:"error",message:a.format("\u534f\u540c\u7f16\u8f91\u5c31\u5728\u8fd9\u91cc\uff01\u8fd9\u6837\u60a8\u5c31\u53ef\u4ee5\u7ee7\u7eed\u5728\u8fd9\u4e2a\u9875\u9762\u4e0a\u5de5\u4f5c\uff0c\u6211\u4eec\u9700\u8981\u4e3a\u60a8\u5c06\u5185\u5bb9\u8f6c\u79fb\u5230\u4e00\u4e2a\u65b0\u7684\u8349\u7a3f\u3002\u003cbr\u003e \u003ca href={0}\u003e \u73b0\u5728\u8f6c\u79fb \u003c/a\u003e",p.CONTEXT_PATH+"/pages/resumedraft.action?draftId\x3d"+a.Meta.get("draft-id"))},f)):(a.trigger("rte.legacy-draft-cannot-be-migrated"),b.handleMessage("legacy-draft-deprecated",{type:"error",message:"\u534f\u540c\u7f16\u8f91\u5c31\u5728\u8fd9\u91cc\uff01\u8fd9\u610f\u5473\u7740\u6211\u4eec\u9700\u8981\u60a8\u7684\u4e00\u70b9\u5e2e\u52a9\u4ee5\u91cd\u542f\u60a8\u7684\u7f16\u8f91\u4f1a\u8bdd\u3002\u60a8\u9700\u8981\u505a\u7684\u4e00\u5207\u5c31\u662f\u590d\u5236\u5185\u5bb9\uff0c\u91cd\u65b0\u7f16\u8f91\u8be5\u9875\u9762\uff0c\u7136\u540e\u5c06\u5176\u9ecf\u8d34\u5e76\u4fdd\u5b58\u3002"},f)):0<=d.responseText.indexOf(k.utf8ValidationFailed)?
(d=d.responseJSON.message.split(k.utf8ValidationFailed)[1],b.handleMessage("utf8-validation-failed",{title:"\u4e0d\u652f\u6301\u7684\u5b57\u7b26",type:"error",message:a.format("\u6211\u4eec\u65e0\u6cd5\u4fdd\u5b58\u60a8\u7684\u9875\u9762\uff0c\u56e0\u4e3a\u6570\u636e\u5e93\u4e0d\u652f\u6301 {0} \u5b57\u7b26\u3002\u003cbr\u003e\u003cbr\u003e\u8bf7\u5220\u9664\u6b64\u5b57\u7b26\u6216\u6539\u7528 Confluence \u7b26\u53f7\u6216\u8868\u60c5\u7b26\u53f7\u3002\u003ca href = \u0022https://confluence.atlassian.com/x/BYfsNg\u0022 target=\u0022_blank\u0022\u003e\u4e86\u89e3\u66f4\u591a\u003c/a\u003e",d)},f)):q(d);break;case 403:A(!0);break;case 404:b.closeMessages(["page-not-accessible","noauthorized"]);b.handleMessage("page-not-accessible",{title:"\u65e0\u6cd5\u8bbf\u95ee\u6b64\u5185\u5bb9",type:"error",message:a.format("\u60a8\u7684\u4f1a\u8bdd\u5df2\u7ecf\u5230\u671f\uff0c\u60a8\u53ef\u4ee5\u5c1d\u8bd5 \u003ca href=\u0022dashboard.action\u0022 target=\u0022_blank\u0022\u003e \u767b\u5f55\u003c/a\u003e\u3002",
a.Meta.get("space-key"))},f);break;case 405:r();break;case 410:b.closeMessages(["page-deleted"]);b.handleMessage("page-deleted",{title:"\u8be5\u5185\u5bb9\u5df2\u7ecf\u88ab\u5220\u9664",type:"error",message:a.format("\u590d\u5236\u60a8\u7684\u5185\u5bb9\uff0c\u7136\u540e\u5c06\u5176\u6dfb\u52a0\u5230\u65b0\u9875\u9762\u6216 \u003cdiv\u003e\u003ca href=\u0022viewtrash.action?key={0}\u0022 target=\u0022_blank\u0022\u003e\u4ece\u5783\u573e\u6876\u6062\u590d\u6b64\u9875\u9762\u003c/a\u003e\uff0c\u7136\u540e\u518d\u6b21\u5c1d\u8bd5\u3002\u003c/div\u003e",a.Meta.get("space-key"))},f);break;case 413:b.closeMessages(["page-too-big"]);b.handleMessage("page-too-big",{type:"error",message:"\u8be5\u9875\u9762\u592a\u5927\uff0c\u65e0\u6cd5\u4fdd\u5b58\u3002\u60a8\u53ef\u4ee5\u5c06\u5b83\u62c6\u5206\u6210\u591a\u4e2a\u9875\u9762\uff0c\u7136\u540e\u4f7f\u7528 \u003ca href=\u0022https://confluence.atlassian.com/conf51/include-page-macro-336169384.html\u0022 target=\u0022_blank\u0022\u003e \u5305\u62ec\u9875\u9762\u5b8f\u6307\u4ee4 \u003c/a\u003e \u4ee5\u663e\u793a\u5185\u5bb9\u3002"},f);break;case 0:case 500:case 503:E();break;case 501:0<=d.responseText.indexOf(k.renameDuringLimitedMode)?
b.handleMessage("rename-during-limited-mode",{type:"error",message:"\u73b0\u5728\u65e0\u6cd5\u66f4\u6539\u9875\u9762\u6807\u9898\uff0c\u56e0\u4e3a\u534f\u540c\u7f16\u8f91\u5904\u4e8e\u8131\u673a\u72b6\u6001\u3002\u003cdiv\u003e\u5982\u679c\u60a8\u60f3\u8981\u53d1\u5e03\u9875\u9762\uff0c\u90a3\u5c31\u003ca id=\u0022editor-restore-title-link\u0022 href=\u0022#\u0022\u003e\u6062\u590d\u9875\u9762\u6807\u9898\u003c/a\u003e\u3002\u003c/div\u003e"},G):q(d);break;default:q(d)}}function y(d){function I(c){B<J?(B++,C.push(setTimeout(function(){y()},K))):(a.trigger("analyticsEvent",{name:"editor.save.error.conflict"}),B=0,b.handleMessage("page-conflict",{title:"\u65e0\u6cd5\u4e0e\u670d\u52a1\u5668\u540c\u6b65\u3002",type:"error",message:a.format("\u5237\u65b0\u9875\u9762\u4ee5\u5c1d\u8bd5\u91cd\u65b0\u5efa\u7acb\u8fde\u63a5\u3002",g.space.key)},f),k(c))}function k(b){a.trigger("rte.safe-save.error",
{status:b.status})}function n(){c.Editor.isPublishing(!0);e.ajax({type:r,url:l,contentType:"application/json; charset\x3dutf-8",dataType:"json",data:JSON.stringify(g),success:function(b){"page"!==g.type&&"blogpost"!==g.type||a.trigger("analytics",{name:"confluence.editor.close",data:{source:"publishButton"}});a.trigger("rte.safe-save.success",b);h._internal.onSuccessfulResponse(b)},error:function(b){c.Editor.isPublishing(!1);x();var d=!1;switch(b.status){case 409:v()?(d=!0,I(b)):(c.Editor.restoreDefaultSave(),
c.Editor.UI.saveButton.click());break;case 0:case 500:case 503:for(;C.length;)clearTimeout(C.shift());z(b);break;default:z(b)}d||k(b);a.trigger("synchrony.start",{id:"confluence.editor.publish"})}})}a.trigger("synchrony.stop",{id:"confluence.editor.publish"});d&&d.preventDefault();var m=e("#content-title");if(m.hasClass("placeholded")||""===m.val().trim())a.trigger("rte.safe-save.error"),a.trigger("synchrony.start",{id:"confluence.editor.publish"}),b.closeMessages(["title-too-long","duplicate-title"]),
b.handleMessage("empty-title",{title:"\u8be5\u9875\u9762\u9700\u8981\u4e00\u4e2a\u540d\u79f0",type:"error",message:"\u5728\u70b9\u51fb\u53d1\u5e03\u524d\u6dfb\u52a0\u4e00\u4e2a\u9875\u9762\u6807\u9898\u3002"},f),x();else{c.Editor.Drafts.unBindUnloadMessage();var g={};d=a.Meta.get("draft-id");var t=a.Meta.get("content-id"),l=p.CONTEXT_PATH+"/rest/api/content",q=e("#sourceTemplateId").val();g.status="current";g.title=m.val();g.space={key:a.Meta.get("space-key")};g.body={editor:{value:function(a){F.forEach(function(b){a=b(a)});return a}(a.Rte.getEditor().getContent()),
representation:"editor"}};q&&(g.extensions={sourceTemplateId:q});m=(m=c.Editor.UI.postingDatePicker)&&m.getDate();"blogpost"===u.type&&m&&m.toISOString&&(g.history={createdDate:m.toISOString()});if(w()&&!a.Meta.get("shared-drafts")){var r="POST";a.Meta.get("is-blueprint-page")&&(l=l+"/blueprint/instance/"+d);l+="?status\x3ddraft";g.id=d;g.type=a.Meta.get("content-type");g.body.editor.content={id:d}}else r="PUT",w()&&a.Meta.get("is-blueprint-page")&&(l+="/blueprint/instance"),l=l+"/"+t,w()&&v()?(g.id=
d,g.body.editor.content={id:d}):(g.id=a.Meta.get("page-id"),g.body.editor.content={id:a.Meta.get("page-id")}),l="0"===d?l+"?status\x3dcurrent":l+"?status\x3ddraft",d=a.Meta.getNumber("page-version")||0,g.type=a.Meta.get("content-type"),g.version={number:d+1,message:e("#versionComment").val(),minorEdit:!e("#notifyWatchers").is(":checked"),syncRev:e("#syncRev").val()};d=function(){var b={};b.id=a.Meta.get("parent-page-id")||"0";b.type=a.Meta.get("content-type");var c=a.Meta.get("parent-page-id");c&&
g.space.key===a.Meta.get("space-key")||(b.id="0");c&&b.id!==c&&(b.id=e("#parentPageString").val()===a.Meta.get("from-page-title")?b.id:c);return b}();"0"!==d.id&&(g.ancestors=[d]);(d=c.Editor.Drafts.getDraftSavingPromise())?d.always(n):n()}}if(0!==e("#editpageform").length||0!==e("#createpageform").length){var k={duplicatedTitle:"A page with this title already exists",titleTooLong:"Title cannot be longer than 255 characters.",publishNewDraftDeprecated:"Unsupported call to publishNewDraft",existingDraftNotFound:"Could not find existing draft, perhaps you're trying to publish a personal draft?",
renameDuringLimitedMode:"Unable to perform a page rename when limited mode is enabled",utf8ValidationFailed:"Unsupported character found in content: "},u={existingDraftId:a.Meta.get("existing-draft-id")?a.Meta.get("existing-draft-id"):0,pageId:a.Meta.get("page-id"),type:a.Meta.get("draft-type"),spaceKey:a.Meta.get("space-key")};if(!0===a.Meta.get("show-draft-message")){if(0<e("#conflict-diffs").length)return;e.ajax({type:"GET",url:p.CONTEXT_PATH+"/rest/tinymce/1/drafts/message",data:u,contentType:"application/json",
dataType:"text json",success:function(d){d&&d.draftData&&(d=c.Templates.Editor.Reliable.draftMessage({existingDraft:d.draftData,conflictFound:d.conflictFound,mergeRequired:d.mergeRequired,isNewPage:d.newPage,pageId:a.Meta.get("page-id"),spaceKey:a.Meta.get("space-key")}),b.handleMessage("draft-message",{type:"info",message:d},f))}})}var H=0<e("#editor-notifications-container #all-messages .aui-message-error").length;v()?(D.init({saveHandler:y,cancelErrorHandler:z}),c.Editor.overrideSave(D.process)):
H?c.Editor.restoreDefaultSave():c.Editor.overrideSave(y);e("#rte-button-overwrite").bind("click.overwrite",y);var B=0,J=3,K=1E3,C=[];a.bind("rte.heartbeat-error",function(d,e){switch(e.status){case 401:case 403:b.isDisplayed(["page-not-accessible"])||A(!1);break;case 405:if(e.responseText){d=JSON.parse(e.responseText);b.isDisplayed(["read-only-mode"])||"READ_ONLY"!==d.reason||r();break}case 0:case 404:case 500:case 503:c.Editor.metadataSyncRequired()||E();break;default:a.logError("Heartbeat action error: "+
JSON.stringify(e))}});a.bind("rte.heartbeat",function(d){var e=!1;n.each(b.displayedErrors(),function(a){n.contains(["noauthorized","server-offline","page-not-accessible","read-only-mode"],a)&&(e=!0,b.closeMessages([a]))});(d="READ_ONLY"===a.Meta.get("access-mode"))&&a.Meta.set("access-mode","READ_WRITE");(e||d)&&b.handleMessage("reconnect",{type:"info",title:"\u6210\u529f\u91cd\u65b0\u8fde\u63a5",message:"\u6211\u4eec\u6062\u590d\u6b63\u5e38\u4e86\u3002\u60a8\u53ef\u81ea\u7531\u5730\u518d\u6b21\u4fdd\u5b58\u60a8\u7684\u9875\u9762\u3002",close:"auto"},f);c.Editor.UI.isButtonEnabled(c.Editor.UI.saveButton)||
t||c.Editor.UI.setButtonState(!0,c.Editor.UI.saveButton);c.Editor.UI.isButtonEnabled(c.Editor.UI.cancelButton)||t||c.Editor.UI.setButtonState(!0,c.Editor.UI.cancelButton)});a.bind("synchrony.history.evicted",function(){t=!0})}};h.registerCleanupFunction=function(a){F.push(a)};return h});
require("confluence/module-exporter").safeRequire("confluence-editor-reliable-save/reliable-save",function(a){var c=require("ajs"),n=0<window.document.referrer.indexOf("createDialog\x3dtrue\x26flashId");if(c.DarkFeatures.isEnabled("editor.ajax.save")&&""!==c.Meta.get("remote-user")&&!n){var e=require("confluence/legacy");c.bind("rte.init.ui",function(){a.initialize();e.Editor=e.Editor||{};e.Editor.SafeSave=e.Editor.SafeSave||{};e.Editor.SafeSave.Draft=a.Draft;e.Editor.SafeSave._internal=a._internal||
{}})}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.reliablesave:reliable-save-conf-frontend', location = 'js/ajax-login.js' */
'use strict';define("confluence-editor-reliable-save/ajax-login",["confluence/dark-features","confluence/meta","ajs","jquery","document"],function(p,k,b,f,y){return function(){function z(A,g,a){function h(a){a=a.getResponseHeader("X-AUSERNAME");return v===a}function k(a){for(var d=0,B=a.length;d<B;d++){var e=a[d];b.debug("Rerunning ajax query to: "+e.url,e);w.call(f,e.url,e.settings).done(function(){b.debug("Rerunning done");e.deferred.resolve(arguments)}).fail(function(){b.debug("Rerunning failed");
e.deferred.reject(arguments)})}}function p(a){r.push({deferred:l,url:A,settings:g,defaultCallback:a});t||(u=!1,m||(m=new b.Dialog(840,700),m.addPanel("ajax-login","ajax-login-content","ajax-login-panel",1),a=f(".ajax-login-panel"),n=f("\x3ciframe\x3e\x3c/iframe\x3e"),n.bind("load",function(a){(a=n[0].contentDocument.location.pathname)&&0<=a.indexOf("/ajaxlogincomplete.action")&&(t=!1,u=!0,m.hide(),n.attr("src","about:blank"))}),a.append(n),f(y).bind("hideLayer",function(a,d,e){if("popup"===d&&e===
m.popup){b.debug("hiding login dialog");if(u)k(r);else for(a=r,d=0,e=a.length;d<e;d++){var c=a[d];b.debug("Executing with original response for: "+c.url,c);c.defaultCallback&&c.defaultCallback()}r=[]}})),n.attr("src",C),m.show(),t=!0)}function q(a,b,f,e){function d(){c.readyState=a.readyState;c.status=a.status;c.statusText=a.statusText;a.responseXML?c.responseXML=a.responseXML:c.responseText=a.responseText;b.apply(f,e)}h(a)?d():p(d)}b.debug("Using authenticatingPromise");var c={abort:function(){a.abort.apply(a,
arguments)},getAllResponseHeaders:function(){a.getAllResponseHeaders.apply(a,arguments)},getResponseHeader:function(){a.getResponseHeader.apply(a,arguments)},overrideMimeType:function(){a.overrideMimeType.apply(a,arguments)},readyState:a.readyState,setRequestHeader:function(c,b){a.setRequestHeader.apply(a,arguments)},state:function(){a.state.apply(a,arguments)},status:a.status,statusCode:function(){a.statusCode.apply(a,arguments)},statusText:a.statusText},l=f.Deferred();l.promise(c);c.success=c.done;
c.error=c.fail;a.done(function(a,c,b){q(b,l.resolve,l,arguments)});a.fail(function(a,c,b){q(a,l.reject,l,arguments)});return c}if(p.isEnabled("ajax.login")){b.debug("AJAX login support enabled");var t=!1,m,n,u,r=[],w=f.ajax,v=k.get("remote-user"),q=k.get("base-url"),x=k.get("context-path"),C=k.get("context-path")+"/login.action?os_destination\x3d%2Fajaxlogincomplete.action";f.ajax=function(b,g){var a=w.call(f,b,g);var h=b&&b.url;h=v&&(!g||g&&!g.preventAjaxLogin)&&h&&(q&&0===h.indexOf(q)||x&&0===h.indexOf(x));
return h?z(b,g,a):a}}}});require("confluence/module-exporter").safeRequire("confluence-editor-reliable-save/ajax-login",function(p){require("ajs").toInit(p)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-resources-v4', location = 'tinymce3/plugins/confluencepaste/linkify.js' */
define("confluence-editor/tinymce3/plugins/confluencepaste/linkify",function(){return{RE_EMAIL_PATTERN:"(?:\\s|\\A|^)[\\w.-]+\\+*[\\w.-]+@(?:(?:[\\w-]+\\.)+[A-Za-z]{2,6}|(?:\\d{1,3}\\.){3}\\d{1,3})",RE_URL_SCHEME:"(?:[\\w-]{2,}):/{1,3}",RE_TLD:"(?:aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|travel|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|fi|fj|fk|fm|fo|fr|ga|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|qa|re|ro|ru|rw|sa|sb|sc|sd|se|sg|si|sj|sk|sl|sm|sn|so|sr|st|sv|sy|sz|tc|td|tf|tg|th|tj|tk|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw)",
RE_URL_MIDCHAR:"(?:[^\\s()]+|\\((\\S+)\\))",RE_URL_ENDCHAR:"(?:\\((\\S+)\\)|[^\\s`!()\\[\\]{};:'\".,<>?«»“”‘’])",init:function(){this.RE_URL_ENDING||(this.RE_URL_ENDING="(?:"+this.RE_URL_MIDCHAR+"*"+this.RE_URL_ENDCHAR+")?",this.RE_FULL_URL=this.RE_URL_SCHEME+"\\w+(?:.\\w+)"+this.RE_URL_ENDING,this.RE_OTHER_URL="\\w[\\w_-]*(?:\\.\\w[\\w_-]*)*\\."+this.RE_TLD+"(?:[\\/\\?#]"+this.RE_URL_ENDING+"|\\b)")},linkify:function(f,b,i){this.init();f=this.match_and_replace(this.RE_EMAIL_PATTERN,f,!0,!1,b,i);
f=this.match_and_replace(this.RE_FULL_URL,f,!1,!1,b,i);return f=this.match_and_replace(this.RE_OTHER_URL,f,!1,!0,b,i)},match_and_replace:function(f,b,i,o,k,h){for(var c=0,a=0,d=0,c=0,l=/<\/[aA]>/,f=RegExp(f,"g"),p=h.hasOwnProperty("add_wbrs")?h.add_wbrs:null,j=h.hasOwnProperty("truncate_length")?h.truncate_length:100,m=h.hasOwnProperty("link_target")?h.link_target:"_blank",h=h.hasOwnProperty("link_titles")?h.link_titles:null,d={},n=0;d=f.exec(b);){n++;if(20<n)break;c=d.index;d=d[0].length;if(0<=b.substring(a,
c).search(/<[aA]/)){l.lastIndex=a;c=b.substring(a,b.length).search(l);if(0>c)break;c+=a;f.lastIndex=c+4;a=c+4}else{var a=b.substr(c,d),g=a.search(/&(amp|gt|lt)$/);if(0<g&&b.length>c+d&&";"==b[c+d]){d-=a.length-g;for(a=b.substr(c,d);!a.match(this.RE_URL_ENDCHAR+"$")&&0<d;)d--,a=b.substr(c,d)}g=a;o&&(g="http://"+g);var e="<a";m&&(e+=' target="'+m+'"');e+=' href="';i&&(e+="mailto:");g=g.replace(/"/g,"%22");e+=g+'"';h&&(e+=' title="'+(i?"Email "+g:g)+'"');j&&a.length>j&&(a=a.substr(0,j)+"...");p&&(a=
a.replace(/([/=])/g,"<wbr>$1"));e+=">"+a+"</a>";k&&k.push(g);b=b.slice(0,c)+e+b.slice(c+d,b.length);f.lastIndex=c+e.length;a=c+e.length}}return b}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/confluencepaste/linkify","linkify");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-resources-v4', location = 'tinymce3/plugins/confluencepaste/post-paste-node-filter.js' */
define("confluence-editor/tinymce3/plugins/confluencepaste/post-paste-node-filter","jquery confluence/legacy confluence-editor/tinymce3/plugins/confluencepaste/linkify ajs document tinymce".split(" "),function(e,B,q,r,y,z){function u(a,b){for(var f=e(a).find("["+b+"]"),c="",d="",g="",h=0,k=f.length;h<k;h++){d=(c=e(f[h]))&&["/",c.attr(b)].join("");g=c&&["/",c.attr("data-mce-"+b)].join("");r.contextPath()&&d.indexOf(r.contextPath())===0&&(f[h]=c.attr(b,d));r.contextPath()&&g.indexOf(r.contextPath())===
0&&(f[h]=c.attr("data-mce-"+b,g))}return f}function m(a,b,f){var a=e(a).find("["+b+"]"),c="",d,g;if(a)for(var h=0,k=a.length;h<k;h++){d=e(a[h]);g=f.standard;for(var n in f)if(f.hasOwnProperty(n)&&d.is(n)){g=f[n];break}if(b.indexOf("style")>-1){var c=d,i=g;g=[];for(var o="",o=void 0,p=c.attr("style"),l=c.attr("data-mce-style"),j=0,m=i.length;j<m;j++)if(p&&p.toLowerCase().indexOf(i[j])>-1)g.push(i[j]+": "+c.css(i[j])+";");else if(l&&l.toLowerCase().indexOf(i[j])>-1){o=RegExp(i[j]+":.+?(?:;|$)");o=l.match(o);
g.push(o[0].indexOf(";")>-1?o:o+";")}c=g.join(" ")}else{c=d;i=b;p=[];if(g){l=0;for(j=g.length;l<j;l++)c.is("["+i+"~="+g[l]+"]")&&p.push(g[l])}c=p.join(" ")}d.removeAttr(b);c.length&&d.attr(b,c)}}function A(a,b){function f(f){var d;if(c.index){d=a.splitText(c.index);a&&b.push(a);a=d}(d=a.splitText(c[0].length))&&b.push(d);e(a).wrap("<a href='"+f+a.data+"'></a>")}var c,d,g;d=s.exec(a.data);g=t.exec(a.data);if(d){c=d;f("mailto:")}else if(g){d=(c=g)&&c[0].indexOf("://")===-1?"http://":"";f(d)}}var t;
q.init();var v=RegExp(q.RE_FULL_URL),w=RegExp(q.RE_OTHER_URL);t={exec:function(a){return v.exec(a)||w.exec(a)},test:function(a){return v.test(a)||w.test(a)}};var s,x=RegExp(q.RE_EMAIL_PATTERN);s={exec:function(a){if((a=x.exec(a))&&/\s/.test(a[0][0])){a[0]=a[0].replace(/\s/,"");a.index++}return a},test:function(a){return x.test(a)}};e(y).bind("postPaste",function(a,b,f){a=f.node;b={standard:["text-decoration","text-align","margin-left"],".wysiwyg-macro":["background-image"],p:["margin-left","text-align"],
span:["color","text-decoration"],pre:["margin-left"]};b.td=b.th=["text-align"];b.li=["list-style-type","background-image"];b.col=["width"];b["table.confluenceTable.relative-table"]=["width"];m(a,"style",b);m(a,"data-mce-style",b);if(e.browser.mozilla){u(a,"src");u(a,"href")}m(a,"face",{standard:[]});m(a,"id",{standard:[]});m(a,"data-mce-href",{standard:[]});a=f.node;b=[];b.push({elements:["div"],attribute:"class",blackValue:"aui-buttons"});for(var c=0;c<b.length;c++)for(var d=b[c],g=0;g<d.elements.length;g++)for(var h=
e(a).find(d.elements[g]+"["+d.attribute+"]"),k=0;k<h.length;k++){var n=h.eq(k).attr(d.attribute),n=n.replace(d.blackValue,"");h.eq(k).attr(d.attribute,n)}var i=f.node;e.each([".contentLayout",".contentLayout2",".columnLayout",".header",".footer",".cell",".innerCell",".panelContent",".panel",".panelHeader",".Apple-converted-space","font",".jira-status",".jira-issue",".diff-html-removed",".diff-html-added",".diff-html-changed"],function(a,b){e(b,i).contents().unwrap()});e("img",i).map(function(){e(this).attr("data-attachment-copy",
"");!e(this).attr("src")&&e(this).remove()});e("dl",i).map(function(){e(this).replaceWith(e("<p/>").text(e(this).text()))});e("a",i).map(function(){e(this).removeClass("confluence-userlink userLogoLink")});for(a=e.makeArray(f.node.childNodes);a.length;){b=a.pop();e(b).is("a")||(b.nodeType===3?A(b,a):b.nodeType===1&&(b.childNodes&&b.nodeName.toLowerCase()!=="pre")&&(a=a.concat(e.makeArray(b.childNodes))))}if(a=e.browser.mozilla){a=e(f.node);a=a.children("br").length&&!a.find(":not(br)").length&&!e(z.activeEditor.selection.getStart()).closest("[data-macro-body-type='PLAIN_TEXT']").length}if(a){f=
e(f.node);a="<p>"+f.html().replace(/<br>/gi,"</p><p>")+"</p>";f.html(a)}});return{URL:t,EMAIL:s}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/confluencepaste/post-paste-node-filter","Confluence.Editor.regex");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-resources-v4', location = 'com/atlassian/confluence/tinymceplugin/tinymce-adapter-deprecated.js' */
define("confluence-editor/tinymceplugin/tinymce-adapter-deprecated",["tinymce","ajs","confluence/legacy","jquery"],function(e,a,g,h){return{putCursorAtPostionInElement:function(b,a,c){var d=e.activeEditor,i=d.getDoc(),b=h(b,c||i),b=b.contents().filter(function(){return 3===this.nodeType})[0],c=d.selection.getRng(!0);c.setStart(b,a);c.setEnd(b,a);d.selection.setRng(c)},storeCurrentSelectionState:a.Rte.BookmarkManager.storeBookmark,restoreSelectionState:a.Rte.BookmarkManager.restoreBookmark,insertLink:function(b,
f){f&&a.Rte.getEditor().selection.select(f);g.Editor.LinkAdapter.setLink(b)},getCurrentBaseUrl:a.Rte.getCurrentBaseUrl,addOnInitCallback:function(b){a.debug("Adding callback to AJS.Rte.BootstrapManager. AJS.Rte.BootstrapManager = "+a.Rte.BootstrapManager);a.Rte.BootstrapManager.addOnInitCallback(b)},bindScroll:function(b,f){a.Rte.bindScroll(b,f)},unbindScroll:function(b){a.Rte.unbindScroll(b)},getTinyMceHasInit:function(){return a.Rte.BootstrapManager.isInitComplete()},getEditor:a.Rte.getEditor,addTinyMcePluginInit:function(b){a.Rte.BootstrapManager.addTinyMcePluginInit(b)},
isExternalLink:function(a){return g.Link.isExternalLink(a)},isInMacroPlaceholder:function(a){return e.confluence.MacroUtils.isInMacro(a)},initialiseTinyMce:function(){var b=a.Editor.Adapter;e.EditorManager.preInit.apply(e.EditorManager);e.EditorManager.init(b.settings)},offset:function(b){a.Rte.Content.offset(b)},getSelectedText:function(){return a.Rte.Content.getSelectedText()},setEditorValue:function(b){a.Rte.Content.setHtml(b)},getEditorHTML:function(){return""+a.Rte.getEditor.getContent()},editorHasContentChanged:function(){return a.Rte.getEditor().isDirty()},
editorResetContentChanged:function(){a.Rte.getEditor().setDirty(!1)},getChildIndex:function(a,f){for(var c=a.childNodes,d=0,e=c.length;d<e;d++)if(c[d]==f)return d;return-1},getMainEditor:function(){return a.Rte.getMainEditor()},getEditorContainer:function(){return a.Rte.getEditorContainer()},getEditorFrame:function(){return a.Rte.getEditorFrame()},getEditorTable:function(){return a.Rte.getEditorTable()},webResourcePath:a.Rte.webResourcePath,getResourceUrlPrefix:function(){return a.Rte.getResourceUrlPrefix()},
getTinyMceBaseUrl:function(){return a.Rte.getTinyMceBaseUrl()},getMinEditorHeight:function(){return a.Rte.getMinEditorHeight()},getTinyMceEditorMinHeight:function(b){return a.Rte.getTinyMceEditorMinHeight(b)}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymceplugin/tinymce-adapter-deprecated","AJS.Editor.Adapter");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:editor-resources-v4-exporter', location = 'editor-plugins/tinymce-exporter.js' */
try{require("confluence-editor-v4/build/editor")}catch(e){};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jiraAnalytics', location = '/jira/jiraanalytics.js' */
AJS.Editor.JiraAnalytics={events:{paste:{key:"confluence.jira.plugin.paste"},search:{key:"confluence.jira.plugin.search"},trigger:{key:"confluence.jira.plugin.trigger"},customizeColumn:{key:"confluence.jira.plugin.column.customize"}},linkTypes:{jqlDirect:"direct_jql",jql:"jql_link",xml:"xml_link",rss:"rss_link",filter:"filter_link"},getDisplayType:function(a){var b="single";if(a.container.find("#opt-table").is(":checked")){b="table"}else{if(a.container.find("#opt-total").is(":checked")){b="count"}}return b},setupAnalyticPanelActionObject:function(a,c,b){return{name:a.analyticPanelActionName,properties:this.setupPanelActionProperties(a,c,b)}},setupPanelActionProperties:function(a,d,b){var c={};if(d===AJS.Editor.JiraConnector.source.instructionalText){if(a.analyticPanelActionName==="confluence.jira.plugin.issuecreated"){c.issueType=a.container.find('select[name="issuetype"] :selected').text()}else{if(a.analyticPanelActionName==="confluence.jira.plugin.searchadded"){c.display=this.getDisplayType(a)}}c.label=b}return c},triggerPasteEvent:function(a){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push({name:AJS.Editor.JiraAnalytics.events.paste.key,properties:a})},triggerPannelActionEvent:function(a){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push(a)},triggerSearchEvent:function(a){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push({name:AJS.Editor.JiraAnalytics.events.search.key,properties:a})},triggerMarkupEvent:function(a){this.triggerSearchEvent(a)},triggerPannelTriggerEvent:function(a){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push({name:AJS.Editor.JiraAnalytics.events.trigger.key,properties:a})},triggerCustomizeColumnEvent:function(a){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push({name:AJS.Editor.JiraAnalytics.events.customizeColumn.key,properties:a})}};(function(a){a.aop.before({target:AJS.MacroBrowser,method:"loadMacroInBrowser"},function(b,c){if(b&&b[0]&&b[0].pluginKey=="confluence.extra.jira"){AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:AJS.Editor.JiraConnector.source.macroBrowser})}});a.aop.before({target:tinymce.confluence.macrobrowser,method:"macroBrowserToolbarButtonClicked"},function(b,c){if(b&&b[0]&&b[0].presetMacroMetadata&&b[0].presetMacroMetadata.pluginKey=="confluence.extra.jira"){AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:AJS.Editor.JiraConnector.source.editorBraceKey})}});AJS.bind("init.rte",function(){a.aop.before({target:tinyMCE.activeEditor,method:"execCommand"},function(l,k){if(l&&l[0]=="mceInsertContent"&&l[2]){var m=l[2];var e=AJS.$("<div></div>").html(m).children().first();var c=e.attr("data-macro-name");var h=["jira","jiraissues"];if(a.inArray(c,h)==-1){return}var j=AJS.Editor.JiraAnalytics;var n={source:"wiki_markup"};if(!e.attr("data-macro-parameters")){return}var g=e.attr("data-macro-parameters").split("|");for(var f=0;f<g.length;f++){var d=a.trim(g[f]);if(d.indexOf("jql")==0||d.indexOf("jqlQuery")==0){n.type=j.linkTypes.jqlDirect;break}else{if(d.indexOf("url")==0){var b=a.trim(d.substring(d.indexOf("=")+1,d.length));n.type=AJS.JQLHelper.checkQueryType(b);break}else{if(d.indexOf("http")==0){var b=d;n.type=AJS.JQLHelper.checkQueryType(b);break}}}}if(typeof n.type==="undefined"){n.type=j.linkTypes.jqlDirect}j.triggerMarkupEvent(n)}})})})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-frontend:split_jquery-selection-plugin', location = 'jquery-selection-plugin.js' */
(window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73=window.atlassianWebpackJsonpe19a4f58490c3d96a3072d1e47cd0e73||[]).push([[15],{390:function(t,e,n){"use strict";n.r(e);var s=n(11),i=n(104);!function(t,e){if(e.selection){var n=function(t){return t.replace(/\u000D/g,"")};t.fn.selection=function(t){var n=this[0];if(this.focus(),!n)return!1;if(null==t)return e.selection.createRange().text;var s=n.scrollTop,i=e.selection.createRange();i.text=t,i.select(),n.focus(),n.scrollTop=s},t.fn.selectionRange=function(t,s){var i=this[0];this.focus();var r=e.selection.createRange();if(null==t){var a=this.val(),o=a.length,c=r.duplicate();c.moveToElementText(i),c.setEndPoint("StartToEnd",r);var l=o-n(c.text).length;c.setEndPoint("StartToStart",r);var u=o-n(c.text).length;return l!==u&&"\n"===a.charAt(l+1)&&(l+=1),{end:l,start:u,text:a.substring(u,l),textBefore:a.substring(0,u),textAfter:a.substring(l)}}r.moveToElementText(i),r.collapse(!0),r.moveStart("character",t),r.moveEnd("character",s-t),r.select()}}else t.fn.selection=function(t){var e=this[0];if(!e)return!1;if(null==t)return!!e.setSelectionRange&&e.value.substring(e.selectionStart,e.selectionEnd);var n=e.scrollTop;if(e.setSelectionRange){var s=e.selectionStart;e.value=e.value.substring(0,s)+t+e.value.substring(e.selectionEnd),e.selectionStart=s,e.selectionEnd=s+t.length}e.focus(),e.scrollTop=n},t.fn.selectionRange=function(t,e){if(null==t){var n={start:this[0].selectionStart,end:this[0].selectionEnd},s=this.val();return n.text=s.substring(n.start,n.end),n.textBefore=s.substring(0,n.start),n.textAfter=s.substring(n.end),n}this[0].selectionStart=t,this[0].selectionEnd=e};t.fn.wrapSelection=function(t,e){this.selection(t+this.selection()+(e||""))}}(n.n(i).a,s.document)}},[[390,0,1,2,5]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/datatable.js' */
(function(a){AJS.DataTable=function(h,d,b){var g=null;if(h&&h.jquery){g=h}else{if(typeof h=="string"){g=a(h)}}g.addClass("data-table");if(d&&d.length){this.columns=d;var f=a("<tr></tr>").appendTo(g);f.addClass("data-table-header");for(var c=0;c<d.length;c++){var e=d[c];f.append('<th class="'+e.className+'">'+e.title+"</th>")}}this.tbl=g;this.rowIdx=0};AJS.DataTable.prototype.addRow=function(e){var f=a("<tr></tr>").appendTo(this.tbl);var c=this.columns;for(var b=0;b<this.columns.length;b++){var d=c[b];var g=a("<td></td>").appendTo(f);g.addClass(d.className);d.renderCell(g,e)}f.data("row-data",e);this._bindRowJs(f,this.rowIdx,"selected","hover");this.rowIdx+=1;f.attr("tabindex","-1")};AJS.DataTable.prototype.selectRow=function(b){var c=a("tbody tr",this.tbl)[b+1];a(c).focus()};AJS.DataTable.prototype._bindRowJs=function(f,g,c,b){var e=this;f.click(function(i){if(c){a(e.tbl).find("."+c).removeClass(c);a(this).addClass(c)}var h=f.data("row-data");e.tbl.trigger("row-select",[h])});var d=function(k){switch(k.keyCode){case 13:var j;var h=f.data("row-data");f.keyup(j=function(l){e.tbl.trigger("row-action",[h]);f.unbind("keyup",j);l.stopPropagation();return false});k.stopPropagation();return false;break;case 38:if(g>0){f.prev().focus()}k.stopPropagation();return false;case 40:var i=a("tbody tr",e.tbl).length;if(g<i-1){f.next().focus()}k.stopPropagation();return false}};if(a.browser.mozilla){f.keypress(d)}else{f.keydown(d)}f.focus(function(h){f.click()});if(b){f.hover(function(){a(this).addClass(b)},function(){a(this).removeClass(b)})}}})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/dialogs.js' */
(function(){tinymce.create("tinymce.plugins.JiraLink",{init:function(a){a.addCommand("mceJiralink",AJS.Editor.JiraConnector.hotKey);a.on("PostRender",function(){AJS.$.ajax({url:Confluence.getContextPath()+"/rest/jiraanywhere/1.0/servers",async:false,success:function(b){AJS.Editor.JiraConnector.servers=b}});AJS.$("#jiralink").click(function(b){AJS.Editor.JiraConnector.open(AJS.Editor.JiraConnector.source.editorDropdownLink,true);b.stopPropagation();return false});AJS.$("#insert-menu .macro-jiralink").show();a.addShortcut("ctrl+shift+j","","mceJiralink")})},getInfo:function(){return{longname:"Confluence Jira Connector",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("jiraconnector",tinymce.plugins.JiraLink)})();AJS.Editor.Adapter.addTinyMcePluginInit(function(b){b.plugins+=",jiraconnector";var c=b.theme_advanced_buttons1;var a=c.indexOf("confimage");b.theme_advanced_buttons1=c.substring(0,a)+"jiralinkButton,"+c.substring(a)});AJS.Editor.JiraConnector=(function(k){var c=require("confluence/form-state-control");var g="";var d="\u63d2\u5165Jira\u95ee\u9898/\u8fc7\u6ee4\u5668";var a="\u63d2\u5165";var i="\u53d6\u6d88";var m=function(){var r=navigator.platform.toLowerCase().indexOf("mac")!=-1;return r?"Cmd":"Ctrl"};var b={macroBrowser:"macro_browser",editorBraceKey:"editor_brace_key",editorHotKey:"editor_hot_key",editorDropdownLink:"editor_dropdown_link",instructionalText:"instructional text"};var q=AJS.format("\u63d0\u793a: \u5728\u7f16\u8f91\u5668\u4e2d\u8f93\u5165 \u0022{0}+Shift+J\u0022 \u8bbf\u95ee\u6b64\u5bf9\u8bdd\u6846\u3002",m());var o,n,e;var j=function(){var r=k("#createPageLabelsString");if(r.length>0){n=r.val().split(" ").join();AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:o,label:n});return}k.getJSON(AJS.Meta.get("base-url")+"/rest/ui/1.0/content/"+AJS.Meta.get("page-id")+"/labels",function(t){var s=[];k.each(t.labels,function(v,u){s.push(u.name)});n=s.join();AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:o,label:n})})};var h=function(r,s){if(AJS.Editor.JiraAnalytics){AJS.Editor.JiraConnector.analyticPanelActionObject=AJS.Editor.JiraAnalytics.setupAnalyticPanelActionObject(s,o,n);if(r.customizedColumn){AJS.Editor.JiraAnalytics.triggerCustomizeColumnEvent({columns:r.customizedColumn})}}};var p=function(r){r.focusForm&&r.focusForm()};var f=function(u){if(!e){e=new AJS.ConfluenceDialog({width:840,height:590,id:"jira-connector"});e.addHeader(d);var t=AJS.Editor.JiraConnector.Panels;for(var v=0;v<t.length;v++){e.addPanel(t[v].title());var x=e.getCurrentPanel();var s=t[v];s.init(x)}e.addLink("\u9009\u62e9\u5b8f",function(){e.hide();AJS.MacroBrowser.open(false)},"dialog-back-link");e.addHelpText(q);k("#jira-connector .dialog-tip").attr("title",q);e.addButton(a,function(){var A=e.getCurrentPanel().id;var z=t[A];var y=t[0];h(y,z);z.insertLink()},"insert-issue-button");c.disableElement(AJS.$(".insert-issue-button"));e.addCancel(i,function(){AJS.Editor.JiraConnector.closePopup()});e.gotoPanel(0);if(AJS.Editor.JiraConnector.servers){for(var v=0;v<AJS.Editor.JiraConnector.servers.length;v++){var w=AJS.Editor.JiraConnector.servers[v];AppLinks.makeRequest({appId:w.id,type:"GET",url:"/rest/api/2/field",dataType:"json",serverIndex:v,success:function(y){if(y&&y.length){AJS.Editor.JiraConnector.servers[this.serverIndex].columns=y}},error:function(){AJS.log("Jira Issues Macro: unable to retrieve fields from AppLink: "+w.id)}})}}k("#jira-connector ul.dialog-page-menu").append(Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink({id:"open-jira-chart-dialog",label:"Jira \u56fe\u8868"}));k("#jira-connector .dialog-page-menu button").click(function(){var y=AJS.Editor.JiraConnector.Panels[e.getCurrentPanel().id];y.setInsertButtonState&&y.setInsertButtonState();p(y)});k("#open-jira-chart-dialog").click(function(){AJS.Editor.JiraConnector.closePopup();if(AJS.Editor.JiraChart){AJS.Editor.JiraChart.open()}})}AJS.Editor.JiraConnector.Panels[0].refreshSearchForm();if(u){e.gotoPanel(1);var r=AJS.Editor.JiraConnector.Panels[1];r.setSummary(u);setTimeout(function(){p(r)},0)}else{e.gotoPanel(0)}e.overrideLastTab();e.show()};var l=function(){if(AJS.Editor.JiraConnector.clickConfigApplink){AJS.$.ajax({url:Confluence.getContextPath()+"/rest/jiraanywhere/1.0/servers",async:false,success:function(r){AJS.Editor.JiraConnector.servers=r}})}if(typeof(AJS.Editor.JiraConnector.servers)==="undefined"||AJS.Editor.JiraConnector.servers.length===0){AJS.Editor.JiraConnector.warningPopup(AJS.Meta.get("is-admin"));return false}AJS.Editor.JiraConnector.clickConfigApplink=false;if(AJS.Editor.JiraConnector.refreshAppLink){AJS.Editor.JiraConnector.refreshAppLink.call();AJS.Editor.JiraConnector.refreshAppLink=false}return true};return{warningPopup:function(t){var r=new AJS.ConfluenceDialog({width:600,height:400,id:"warning-applink-dialog"});var s="Confluence \u8fde\u63a5\u5230 Jira";r.addHeader(s);var u=Confluence.Templates.ConfluenceJiraPlugin.warningDialog({isAdministrator:t});r.addPanel("Panel 1",u);r.get("panel:0").setPadding(0);if(t){r.addButton("\u8bbe\u7f6e\u8fde\u63a5",function(v){AJS.Editor.JiraConnector.clickConfigApplink=true;v.hide();tinymce.confluence.macrobrowser.macroBrowserCancel();var w=window.open(Confluence.getContextPath()+"/admin/listapplicationlinks.action");w.opener=null},"create-dialog-create-button app_link");r.popup.element.find(".create-dialog-create-button").removeClass("button-panel-button").addClass("aui-button aui-button-primary")}else{r.addButton("\u8054\u7cfb\u7ba1\u7406\u5458",function(v){v.hide();tinymce.confluence.macrobrowser.macroBrowserCancel();var w=window.open(Confluence.getContextPath()+"/wiki/contactadministrators.action");w.opener=null})}r.addLink("\u53d6\u6d88",function(v){v.hide();tinymce.confluence.macrobrowser.macroBrowserCancel()});r.show();r.gotoPanel(0)},closePopup:function(){e.hide();tinymce.confluence.macrobrowser.macroBrowserCancel()},open:function(t,u){if(!l()){return}AJS.Editor.Adapter.storeCurrentSelectionState();o=t;if(AJS.Editor.JiraAnalytics&&o){if(o===AJS.Editor.JiraConnector.source.instructionalText){j()}else{n=null;AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:o})}}var s=tinymce.confluence.macrobrowser,r=s.getCurrentNode();if(s.isMacroTag(r)&&"jira"==k(r).attr("data-macro-name")){s.editMacro(r);return}AJS.Editor.JiraConnector.openCleanDialog(u)},openCleanDialog:function(t){var s=t&&tinyMCE.activeEditor.selection&&tinyMCE.activeEditor.selection.getContent({format:"text"});f(s);var r=AJS.Editor.JiraConnector.Panels[0];r.setMacroParams(null)},edit:function(v){if(!l()){return}if(typeof(v.params)=="undefined"){AJS.Editor.JiraConnector.openCleanDialog(false);return}o=g;n=g;var x=function(A){if(A.hasOwnProperty("jqlQuery")){return A.jqlQuery}var z=/^([0-9]\d*)$/;var y=["count","columns","columnIds","title","renderMode","cache","width","height","server","serverId","anonymous","baseurl","showSummary"];for(var B in A){if(k.inArray(B,y)==-1&&A.hasOwnProperty(B)){if(z.test(B)){return A[B]}return B+=" = "+A[B]}}return""};var s=function(A){var B={};if(A.params.url){B.searchStr=A.params.url;return B}B.maximumIssues=A.params.maximumIssues;var y=A.defaultParameterValue||x(A.params);if(typeof(y)=="undefined"){B.searchStr=g}else{B.searchStr=y}if(typeof(A.params.server)!="undefined"){B.serverName=A.params.server}else{for(var z=0;z<AJS.Editor.JiraConnector.servers.length;z++){if(AJS.Editor.JiraConnector.servers[z].selected){B.serverName=AJS.Editor.JiraConnector.servers[z].name;break}}}B.columnIds=A.params.columnIds;return B};var u=function(A){var B=s(A);var z=A.params.count;if(typeof z==="undefined"){z="false"}B.count=z;var y=A.params.columns;if(typeof(y)!="undefined"){if(y.length){B.columns=y}}return B};var t=u(v);if(v&&!AJS.Editor.inRichTextMode()){k("#markupTextarea").selectionRange(v.startIndex,v.startIndex+v.markup.length)}f();if(t.searchStr){e.gotoPanel(0);var r=AJS.Editor.JiraConnector.Panels[0];r.setMacroParams(t);var w={searchValue:t.searchStr,serverName:t.serverName,isJqlQuery:v.params.hasOwnProperty("jqlQuery"),isAutoSearch:true};r.doSearch(w)}},source:b}})(AJS.$);AJS.MacroBrowser.setMacroJsOverride("jira",{opener:AJS.Editor.JiraConnector.edit});AJS.MacroBrowser.setMacroJsOverride("jiraissues",{opener:AJS.Editor.JiraConnector.edit});AJS.Editor.JiraConnector.Panels=[];AJS.Editor.JiraConnector.clickConfigApplink=false;AJS.Editor.JiraConnector.hotKey=function(){AJS.Editor.JiraConnector.open(AJS.Editor.JiraConnector.source.editorHotKey,true)};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/panelhelper.js' */
(function(a){var b=require("confluence/form-state-control");a.Editor.JiraConnector.Panel=function(){};a.Editor.JiraConnector.Panel.prototype={SHOW_MESSAGE_ON_TOP:false,insertIssueLink:function(c){this.insertIssueLinkWithParams({key:c})},insertJqlLink:function(c){this.insertIssueLinkWithParams({jqlQuery:c})},insertIssueLinkWithParams:function(g){var h=function(i){tinymce.confluence.macrobrowser.macroBrowserComplete(i)};g.server=this.selectedServer.name;g.serverId=this.selectedServer.id;if(a.Editor.inRichTextMode()){h({name:"jira",params:g})}else{var c="{jira:";for(var d in g){c=c+d+"="+g[d]+"|"}if(c.charAt(c.length-1)=="|"){c=c.substr(0,c.length-1)}var f=a.$("#markupTextarea");var e=f.selectionRange();f.selectionRange(e.start,e.end);f.selection(c);e=f.selectionRange();f.selectionRange(e.end,e.end)}if(a.Editor.JiraAnalytics&&a.Editor.JiraConnector.analyticPanelActionObject){a.Editor.JiraAnalytics.triggerPannelActionEvent(a.Editor.JiraConnector.analyticPanelActionObject);a.Editor.JiraConnector.analyticPanelActionObject=null}a.Editor.JiraConnector.closePopup()},disableInsert:function(){b.disableElement(a.$(".insert-issue-button"))},isInsertDisabled:function(){return a.$(".insert-issue-button").is(":disabled")},getOAuthRealm:function(f){var d=f.getResponseHeader("WWW-Authenticate")||"";var c=/OAuth realm\=\"([^\"]+)\"/;var e=c.exec(d);if(e){return e[1]}else{return null}},enableInsert:function(){b.enableElement(a.$(".insert-issue-button"))},handleInsertWaiting:function(d){var c=a.$(".insert-issue-button");return d?c.before(aui.icons.icon({icon:"wait"})):c.prev(".aui-icon.aui-icon-wait").remove()},msg:function(c,f,d){if(aui&&aui.message){try{var j=a.$('<div class="aui-message-container"/>');var h=f;if(f.html){h=f.html()}var k={content:h};var g;switch(d){case"error":g=aui.message.error(k);break;case"success":g=aui.message.success(k);break;case"warning":g=aui.message.warning(k);break;default:g=aui.message.info(k)}j.append(g);f=j}catch(i){if(a&&a.logError){a.logError("jira-connector",i)}}}c.append(f)},errorMsg:function(c,e){this.removeError(c);var d=this.SHOW_MESSAGE_ON_TOP?a.$('<div class="jira-error"></div>').prependTo(c):a.$('<div class="jira-error"></div>').appendTo(c);this.msg(d,e,"error")},warningMsg:function(c,d){this.removeError(c);var e=this.SHOW_MESSAGE_ON_TOP?a.$('<div class="jira-error"></div>').prependTo(c):a.$('<div class="jira-error"></div>').appendTo(c);this.msg(e,d,"warning")},noServerMsg:function(c,d){var f=a.$('<div class="data-table jiraSearchResults" ></div>').appendTo(c);var e=this.SHOW_MESSAGE_ON_TOP?a.$('<div class="message-panel"/>').prependTo(f):a.$('<div class="message-panel"/>').appendTo(f);this.msg(e,d,"info")},ajaxError:function(e,d){if(e.status==401){var c=this.getOAuthRealm(e);this.selectedServer.authUrl=c;d.call(this)}else{this.errorMsg(this.container,"\u4ece\u670d\u52a1\u5668\u63a5\u6536\u5230\u4e0b\u5217 HTTP\u9519\u8bef\u4ee3\u7801"+": "+e.status)}},removeError:function(c){a.$("div.jira-error",c).remove()},setActionOnEnter:function(c,e,d){c.unbind("keydown").keydown(function(f){if(f.which==13){var g=function(h){c.unbind("keyup",g);e(d);h.stopPropagation();return false};c.keyup(g);f.stopPropagation();return false}})},createOauthForm:function(g){var f=this.selectedServer;var e={onSuccess:function(){f.authUrl=null;g(f)},onFailure:function(){}};var c='<a class="oauth-init" href="javascript:void(0)">'+"\u767b\u5f55\u5e76\u5141\u8bb8"+"</a> "+"\u63a5\u6536\u6570\u636e\u4ece"+" "+a.escapeHtml(this.selectedServer.name);var d=a.$('<div class="jira-oauth-message-marker"/>');if(!(aui&&aui.message)){d.addClass("oauth-message")}this.msg(d,c,"info");a.$(".oauth-init",d).click(function(h){AppLinks.authenticateRemoteCredentials(f.authUrl,e.onSuccess,e.onFailure);h.preventDefault()});return d},applinkServerSelect:function(c,d){var e=a.Editor.JiraConnector.servers;a.$(e).each(function(){var f="<option ";if(this.selected){selectedServer=this;f+='selected="selected"'}f+='value="'+this.id+'"></option>';f=a.$(f);f.text(this.name);a.$(c).append(f);f.data("jiraapplink",this)});a.$(c).change(function(h){var f=a.$("option:selected",c);var g=f.data("jiraapplink");d(g)})},showSpinner:function(f,c,e,d){a.$.data(f,"spinner",Raphael.spinner(f,c,"#666"));if(e){a.$(f).css("marginLeft",-c*1.2)}if(d){a.$(f).css("marginTop",-c*1.2)}},hideSpinner:function(c){a.$(c).css("marginTop","");a.$(c).css("marginLeft","");var d=a.$.data(c,"spinner");if(d){d();delete d;a.$.data(c,"spinner",null)}},setSelectedIssue:function(c){this.selectedIssue=c;this.enableInsert()},insertSelected:function(){if(this.selectedIssue){this.insertIssueLink(this.selectedIssue.key)}},createIssueTableFromUrl:function(e,m,d,c,f,j,k,h,g){a.$("div.data-table",e).remove();var l=a.$('<div class="data-table jiraSearchResults" ></div>').appendTo(e);var n=a.$('<div class="loading-data"></div>').appendTo(l);this.removeError(e);this.showSpinner(n[0],50,true,true);var i=this;this.currentXhr=AppLinks.makeRequest({appId:m,type:"GET",url:d,dataType:"xml",success:function(s){n.remove();var t=a.$("item",s);b.enableElement(a.$(":disabled",e));if(t.length){var w=a.$('<table class="my-result aui"></table>');a.$(".jiraSearchResults",e).append(w);var q=[];if(g){var v={className:"issue-checkbox-column",title:'<input type="checkbox" name="jira-issue-all" checked/>',renderCell:function(A,y){var z=Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox({issueKey:y.key});a.$(z).appendTo(A)}};q.push(v)}var u=[{className:"issue-key-column",title:"\u952e\u503c",renderCell:function(A,z){var y=Confluence.Templates.ConfluenceJiraPlugin.issueKey({issueIconUrl:z.iconUrl,issueKey:z.key});a.$(y).appendTo(A)}},{className:"issue-summary-column",title:"\u6458\u8981",renderCell:function(z,y){z.text(y.summary)}}];q=q.concat(u);var o=new a.DataTable(w,q);a.$(t).each(function(){var y={iconUrl:a.$("type",this).attr("iconUrl"),key:a.$("key",this).text(),summary:a.$("summary",this).text(),url:a.$("link",this).text()};o.addRow(y)});w.bind("row-action",function(z,y){f.call(i,y)});w.bind("row-select",function(z,y){c.call(i,y)});o.selectRow(0);if(k){var p=a.$("issue",s).attr("total");k.call(i,p)}}else{if(j){j()}var x="\u6ca1\u6709\u641c\u7d22\u7ed3\u679c\u3002";var r=a.$('<div class="message-panel"/>');i.msg(r,x,"info");a.$(".jiraSearchResults",e).append(r)}},error:function(o){b.enableElement(a.$(":disabled",e));n.remove();h.call(i,o)}})},retrieveJson:function(e,c,f,d){AppLinks.makeRequest({appId:e,type:"GET",url:c,dataType:"json",success:f,error:d})}}})(AJS);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/searchpanel.js' */
AJS.Editor.JiraConnector.Panel.Search=function(){this.jql_operators=/=|!=|~|>|<|!~| is | in /i};AJS.Editor.JiraConnector.Select2=AJS.Editor.JiraConnector.Select2||{};AJS.Editor.JiraConnector.Panel.Search.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Search.prototype,AJS.Editor.JiraConnector.Panel.prototype);AJS.Editor.JiraConnector.Panel.Search.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Search.prototype,{defaultColumns:"key,summary,type,created,updated,due,assignee,reporter,priority,status,resolution",defaultColumnIds:"issuekey,summary,issuetype,created,updated,duedate,assignee,reporter,priority,status,resolution",aliases:[{id:"issuekey",clauseName:"key"},{id:"issuetype",clauseName:"type"},{id:"duedate",clauseName:"due"}],DEFAULT_MAX_ISSUES_VAL:20,MAXIMUM_MAX_ISSUES_VAL:1000,MINIMUM_MAX_ISSUES_VAL:1,title:function(){return "\u641c\u7d22"},init:function(b){var a=require("confluence/form-state-control");b.html('<div id="my-jira-search"></div>');var h=this;var c=AJS.$("#my-jira-search");this.container=c;var i=function(){c.children(":not(div.jira-search-form)").remove()};var g=function(){a.enableElement(AJS.$("input.text,button",c))};var k=function(){a.disableElement(AJS.$("input.text,button",c))};var j=function(m){i();h.disableInsert();if(m){h.selectedServer=m}if(h.selectedServer.authUrl){k();var l=h.createOauthForm(function(){i();g()});c.append(l)}else{g();AJS.$(".search-help").show()}};this.authCheck=j;var f=function(w){var l=w&&w.searchValue;var n=w&&w.serverName;if(l){AJS.$("input:text",c).val(l)}if(n&&n!=this.selectedServer.name){var x=AJS.Editor.JiraConnector.servers;var p=false;for(var q=0;q<x.length;q++){if(x[q].name==n){AJS.$('option[value="'+x[q].id+'"]',c).attr("selected","selected");AJS.$("select",c).change();p=true;break}}if(!p){d(AJS.Meta.get("is-admin"));return}}if(this.currentXhr&&this.currentXhr.readyState!=4){return}var o=l||AJS.$("input",c).val();if(AJS.Editor.JiraAnalytics){var v=AJS.JQLHelper.checkQueryType(o);if(v){AJS.Editor.JiraAnalytics.triggerSearchEvent({type:v,source:"dialog"})}}var r=function(A,D,B){var z=c.find("#jiraIssueColumnSelector");var C=z.val()&&z.val();a.disableElement(AJS.$("select",c));k();h.lastSearch=A;h.createIssueTableFromUrl(c,h.selectedServer.id,"/sr/jira.issueviews:searchrequest-xml/temp/SearchRequest.xml?jqlQuery="+encodeURIComponent(A)+"&returnMax=true&tempMax=20&field=summary&field=type&field=link",h.selectHandler,h.insertLinkFromForm,function(){h.addDisplayOptionPanel();h.loadMacroParams(C);h.bindEventToDisplayOptionPanel(true,w);h.enableInsert()},function(E){h.addDisplayOptionPanel();h.loadMacroParams(C);h.bindEventToDisplayOptionPanel(false,w);h.updateTotalIssuesDisplay(E);h.checkAutoSelectColumns();w&&w.isAutoSearch&&h.focusForm()},function(E){h.disableInsert();if(E.status==400){if(B){B()}else{AJS.$("div.data-table",c).remove();h.warningMsg(c,AJS.format("Jira\u670d\u52a1\u5668\u4e0d\u7406\u89e3\u60a8\u7684\u641c\u7d22\u67e5\u8be2\u3002 \u5982\u679c\u60a8\u8f93\u5165\u4e86 JQL\uff0c\u8bf7\u786e\u4fdd\u5b83\u7684\u683c\u5f0f\u6b63\u786e\u3002 \u5982\u679c\u60a8\u8f93\u5165\u4e86\u95ee\u9898\u5bc6\u94a5\uff0c\u8bf7\u786e\u4fdd\u5b83\u5b58\u5728\u5e76\u4e14\u60a8\u6709\u67e5\u770b\u6743\u9650\u3002 {0}",Confluence.Templates.ConfluenceJiraPlugin.learnMore()))}}else{AJS.$("div.data-table",c).remove();h.ajaxError(E,j)}w&&w.isAutoSearch&&h.focusForm()},true)};if(AJS.JQLHelper.isFilterUrl(o)){var m=decodeURIComponent(o);var u=AJS.JQLHelper.findServerIndexFromUrl(m,AJS.Editor.JiraConnector.servers);if(u!=-1){var s=AJS.Editor.JiraConnector.servers[u].id;AJS.$('option[value="'+s+'"]',c).attr("selected","selected");AJS.$("select",c).change();var y=AJS.JQLHelper.getFilterFromFilterUrl(m);if(y){AJS.$("input",c).val(y);r(y)}else{i();h.warningMsg(c,AJS.format("Jira\u670d\u52a1\u5668\u4e0d\u7406\u89e3\u60a8\u7684\u641c\u7d22\u67e5\u8be2\u3002 \u5982\u679c\u60a8\u8f93\u5165\u4e86 JQL\uff0c\u8bf7\u786e\u4fdd\u5b83\u7684\u683c\u5f0f\u6b63\u786e\u3002 \u5982\u679c\u60a8\u8f93\u5165\u4e86\u95ee\u9898\u5bc6\u94a5\uff0c\u8bf7\u786e\u4fdd\u5b83\u5b58\u5728\u5e76\u4e14\u60a8\u6709\u67e5\u770b\u6743\u9650\u3002 {0}",Confluence.Templates.ConfluenceJiraPlugin.learnMore()))}}else{i();h.disableInsert();d(AJS.Meta.get("is-admin"))}}else{if(AJS.JQLHelper.isIssueUrlOrXmlUrl(o)){var m=decodeURIComponent(o);var t=AJS.JQLHelper.getJqlAndServerIndexFromUrl(m,AJS.Editor.JiraConnector.servers);if(e(t)){AJS.$("input",c).val(t.jqlQuery);r(t.jqlQuery,false,null)}}else{if(o.match(h.jql_operators)){r(o,false,null)}else{if(AJS.JQLHelper.isSingleKeyJQLExp(o)){r("key = "+o,true)}else{if(AJS.JQLHelper.isMultipleSingleKeyJQLExp(o)){r("key in ("+o+")",true)}else{r('summary ~ "'+o+'" OR description ~ "'+o+'"',false,null)}}}}}};this.doSearch=f;h.addSearchForm();var e=function(l){var m;if(l.serverIndex!=-1){AJS.$('option[value="'+AJS.Editor.JiraConnector.servers[l.serverIndex].id+'"]',c).attr("selected","selected");AJS.$("select",c).change();if(l.jqlQuery.length==0){i();h.errorMsg(c,"Jira\u670d\u52a1\u5668\u4e0d\u7406\u89e3\u60a8\u7684\u641c\u7d22\u67e5\u8be2\u3002 \u5982\u679c\u60a8\u8f93\u5165\u4e86 JQL\uff0c\u8bf7\u786e\u4fdd\u5b83\u7684\u683c\u5f0f\u6b63\u786e\u3002 \u5982\u679c\u60a8\u8f93\u5165\u4e86\u95ee\u9898\u5bc6\u94a5\uff0c\u8bf7\u786e\u4fdd\u5b83\u5b58\u5728\u5e76\u4e14\u60a8\u6709\u67e5\u770b\u6743\u9650\u3002 {0}")}else{m=l.jqlQuery}}else{i();h.disableInsert();d(AJS.Meta.get("is-admin"))}return m};h.processJiraParams=e;var d=function(l){var n=Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer({isAdministrator:l,contextPath:Confluence.getContextPath()});h.noServerMsg(c,n);var m=AJS.$("#open_applinks");m.bind("click",function(){AJS.Editor.JiraConnector.clickConfigApplink=true;AJS.Editor.JiraConnector.refreshAppLink=function(){h.refreshSearchForm()}})};h.bindPasteEvent();AJS.$(b).select(function(){h.validate()});$(document).tooltip({live:".jql-display-opts-open.disabled",title:function(){return AJS.$(".jql-display-opts-open.disabled").data("title")},gravity:"s",delayIn:300,delayOut:0})},focusForm:function(){AJS.$('input[name="jiraSearch"]',this.container).focus()},addSearchForm:function(){var d=this;d.container.empty();var f=AJS.Editor.JiraConnector.servers;d.selectedServer=f[0];var a=false;if(f.length>1){a=true}var e=Confluence.Templates.ConfluenceJiraPlugin.searchForm({isMultiServer:a});var c=AJS.$(e).appendTo(d.container);if(f.length>1){var b=AJS.$('<select class="select" tabindex="0"></select>').insertAfter("div.search-input",c);d.applinkServerSelect(b,d.authCheck)}d.authCheck(d.selectedServer);AJS.$("button",d.container).click(function(){d.doSearch()});d.setActionOnEnter(AJS.$("input.text",d.container),d.doSearch)},bindPasteEvent:function(){var a=this;AJS.$("#my-jira-search input:text").bind("paste",function(){var b=this;setTimeout(function(){var d=AJS.$(b).val();if(AJS.JQLHelper.isFilterUrl(d)){a.doSearch()}else{if(AJS.JQLHelper.isIssueUrlOrXmlUrl(d)){var e=decodeURIComponent(d);var c=AJS.JQLHelper.getJqlAndServerIndexFromUrl(e,AJS.Editor.JiraConnector.servers);if(a.processJiraParams(c)){AJS.$(b).val(c.jqlQuery);a.doSearch()}}}},100)})},refreshSearchForm:function(){this.container.empty();this.addSearchForm();this.bindPasteEvent()},validate:function(e,d){var c=this.container;var f=AJS.$("input:checkbox[name=jira-issue]",c);var b=AJS.Editor.JiraConnector.Panel.Search.prototype;if(f.length||e){var a=AJS.$("input:checkbox[name=jira-issue]:checked",c).length;if(a>0||e){b.enableInsert()}else{b.disableInsert()}b.changeInsertOptionStatus(a,e,d)}else{if(AJS.$(".jira-oauth-message-marker",c).length){b.authCheck(this.selectedServer)}AJS.$("input",c).focus();b.disableInsert()}if(b.isInsertDisabled()){return}b.validateMaxIssues()},isValidMaxIssues:function(a){return AJS.$.isNumeric(a)&&(this.MINIMUM_MAX_ISSUES_VAL<=a&&a<=this.MAXIMUM_MAX_ISSUES_VAL)},validateMaxIssues:function(i){var b=AJS.$("#jira-maximum-issues");function d(){b.next("#jira-max-number-error").remove()}function f(){b.attr("disabled","disabled")}function h(){b.removeAttr("disabled")}function c(){d();b.after(Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues())}switch(AJS.$("input:radio[name=insert-advanced]:checked").val()){case"insert-single":case"insert-count":d();f();break;case"insert-table":var a=AJS.Editor.JiraConnector.Panel.Search.prototype;h();var g=b.val();if(AJS.$.trim(g)===""){if(i&&i.type==="keyup"){d();break}if(i&&i.type==="blur"){g=a.MAXIMUM_MAX_ISSUES_VAL;b.val(g);break}}if(a.isValidMaxIssues(g)){d();a.enableInsert()}else{c();a.disableInsert()}break}},customizedColumn:null,checkAndSetDefaultValueMaximumIssues:function(a){if(!a){AJS.log("Cannot set default value for Maximum Issues");return}var b=a.element||AJS.$("#jira-maximum-issues");var d=a.defaultVal||this.MAXIMUM_MAX_ISSUES_VAL;var c=AJS.$.trim(b.val());if(c===""){b.val(d)}},setMacroParams:function(a){this.macroParams=a},getMacroParamsFromUserInput:function(){var g=this;var f=((AJS.$("input:radio[name=insert-advanced]:checked").val()=="insert-count"));var i=[];var a=[];var e=[];var d=[];var b=[];var c={};AJS.$("#my-jira-search .my-result.aui input:checkbox[name=jira-issue]").each(function(j){var k=AJS.$(this);if(k.is(":checked")){a[a.length]=k.val()}else{e[e.length]=k.val()}});if(f){c.count="true"}else{if(!AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox){c.columns=this.defaultColumns;c.columnIds=this.defaultColumnIds;return}i=AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox.select2("data");if(i.length){c.columns=i.map(function(j){return g.selectedServer.columns.find(function(k){return k.id===j.id}).custom?j.text.replace(/%/g,encodeURIComponent("%")).replace(/,/g,encodeURIComponent(",")).replace(/;/g,encodeURIComponent(";")):j.id}).map(function(j){var k=g.aliases.find(function(l){return l.id===j});return k?k.clauseName:j}).join(",");c.columnIds=i.map(function(j){return j.id}).join(",");d=g.selectedServer.columns.find(function(j){return j.clauseNames.find(function(k){var l=k.toLowerCase();return l==="epic link"||l==="gh.epic.link.name"})});if(d&&!i.some(function(j){return j.id===d.id})){b=g.selectedServer.columns.filter(function(j){return j.clauseNames.find(function(k){var l=k.toLowerCase();return l==="epic name"||l==="gh.epic.label.name"||l==="epic colour"||l==="gh.epic.color.name"||l==="epic status"||l==="gh.epic.status.name"})});if(i.some(function(j){return b.some(function(k){return k.id===j.id})})){c.epicLinkId=d.id}}}else{c.columns=this.defaultColumns;c.columnIds=this.defaultColumnIds}}var h=AJS.$("input:radio[name=insert-advanced]:checked").val();if(h==="insert-single"){c.key=a.toString()}else{if(e.length==0){c.jqlQuery=this.lastSearch+" "}else{if(a.length==1){c.jqlQuery="key = "+a.toString()}else{c.jqlQuery="key in ("+a.toString()+")"}}}if(h==="insert-table"){c.maximumIssues=AJS.$("#jira-maximum-issues").val()}return c},insertLinkFromForm:function(){var c=this;var b=c.container;var d=AJS.$("input:checkbox[name=jira-issue]",b);if(d.length){var a=AJS.$("input:checkbox[name=jira-issue]:checked",b).length;if(a>0){c.insertLink()}}},insertLink:function(c){var a;if(c&&typeof c.insertIssueLinkWithParams==="function"){a=c}else{a=this}var b=a.getMacroParamsFromUserInput();a.insertIssueLinkWithParams(b);return true},loadMacroParams:function(c){var a=this.macroParams;if(!a){this.checkAndSetDefaultValueMaximumIssues({defaultVal:20});this.prepareColumnSelect(c)}else{if(!a.maximumIssues){AJS.$("#jira-maximum-issues").attr("disabled","disabled")}if(a.count=="true"){AJS.$("#opt-total").prop("checked",true)}else{AJS.$("#opt-table").prop("checked",true);AJS.$("#jira-maximum-issues").removeAttr("disabled");var b=a.maximumIssues||this.DEFAULT_MAX_ISSUES_VAL;this.checkAndSetDefaultValueMaximumIssues({defaultVal:b})}this.prepareColumnSelect(c)}},selectHandler:function(){var a=this.container;var b=a.find("tr.selected");if(b.length){b.unbind("keydown.space").bind("keydown.space",function(c){if(c.which==32||c.keyCode==32){var d=b.find("[type=checkbox]");d.trigger("click")}})}},addDisplayOptionPanel:function(){var a=Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml;AJS.$(".jiraSearchResults").after(a());AJS.$("#jiraMacroDlg").unbind("submit").on("submit",function(b){return false})},updateTotalIssuesDisplay:function(b){var a=this.selectedServer.url+"/issues/?jql="+this.lastSearch;if(b>20){AJS.$(".my-result.aui").after(Confluence.Templates.ConfluenceJiraPlugin.viewAll({jiraIssuesLink:a}))}var c=AJS.format("{0}\u95ee\u9898",b);AJS.$(".total-issues-text").html(c);AJS.$(".total-issues-link").attr("href",a)},prepareColumnSelect:function(f){var d=this;var a=!(this.macroParams&&!this.macroParams.columnIds);var c=f||(this.macroParams&&this.macroParams.columnIds&&this.macroParams.columnIds.split(","))||(this.macroParams&&this.macroParams.columns&&this.macroParams.columns.toLowerCase().split(","))||this.defaultColumnIds.split(",");var e=this.selectedServer;var b=function(g){var i=AJS.$("#jiraIssueColumnSelector");var j="";var h="";g.filter(function(k){return k.navigable}).sort(function(l,k){var m=c.map(function(n){var o=d.aliases.find(function(p){return p.clauseName===n});return o?o.id:n});return m.indexOf((a||!l.custom)?l.id:l.name.toLowerCase())-m.indexOf((a||!k.custom)?k.id:k.name.toLowerCase())}).forEach(function(k){if(c.find(function(l){if(a){return l===k.id}return k.clauseNames.includes(l)||l===k.name.toLowerCase()})){h+=AJS.template('<option selected="true" value="{fieldId}">{fieldName}</option>').fill({fieldId:k.id,fieldName:k.name})}else{j+=AJS.template('<option value="{fieldId}">{fieldName}</option>').fill({fieldId:k.id,fieldName:k.name})}});i.hide();i.html(h+j);i.show();i.auiSelect2({width:"415px",containerCssClass:"select2-container-jira-issue-columns"});AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox=i};if(e.columns&&e.columns.length>0){b(e.columns);return}this.retrieveJson(e.id,"/rest/api/2/field",function(g){if(g&&g.length){e.columns=g;b(e.columns)}})},expandDisplayOptPanel:function(){var b=AJS.$(".jql-display-opts-overlay");var c=b.height();var d=40;b.css("top","");var a=-(c-d);b.css("bottom",a+"px");b.animate({bottom:0},500)},minimizeDisplayOptPanel:function(){var a=AJS.$(".jql-display-opts-overlay");a.css("top",a.position().top+"px");a.css("bottom","");a.animate({top:414},500)},disableAutoSelectColumns:function(){AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox.auiSelect2("enable",false)},enableAutoSelectColumns:function(){AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox.auiSelect2("enable",true)},checkAutoSelectColumns:function(){if(AJS.$("#opt-table").prop("checked")){this.enableAutoSelectColumns()}else{this.disableAutoSelectColumns();this.enableInsert()}},bindEventToDisplayOptionPanel:function(f,h){var d=this;var b=AJS.$(".jql-display-opts-close, .jql-display-opts-open");var c=AJS.$(".jql-display-opts-overlay");var i=AJS.$(".jql-display-opts-inner .radio");var a=AJS.$("#my-jira-search input:checkbox[name=jira-issue-all]");var e=AJS.$("#my-jira-search input:checkbox[name=jira-issue]");var g=AJS.$("#jira-maximum-issues");g.on("blur keyup",AJS.Editor.JiraConnector.Panel.Search.prototype.validateMaxIssues);c.css("top","414px");b.click(function(j){j.preventDefault();if(AJS.$(this).hasClass("disabled")){return}var k=AJS.$(this).hasClass("jql-display-opts-open");if(k){d.expandDisplayOptPanel();jQuery(this).addClass("jql-display-opts-close");jQuery(this).removeClass("jql-display-opts-open")}else{d.minimizeDisplayOptPanel();jQuery(this).removeClass("jql-display-opts-close");jQuery(this).addClass("jql-display-opts-open")}});i.change(function(){d.checkAutoSelectColumns();d.validateMaxIssues()});a.bind("click",function(){var j=AJS.$(this);if(j.prop("checked")){e.prop("checked","checked")}else{e.removeAttr("checked")}d.validate()});e.change(function(){var j=AJS.$("#my-jira-search input:checkbox[name=jira-issue]:not(:checked)").length;if(j>0){a.removeAttr("checked")}else{a.prop("checked","checked")}d.validate()});d.validate(f,h)},changeInsertOptionStatus:function(q,n,f){var r=this;var g=AJS.$("#opt-single");var d=AJS.$("#opt-total");var m=AJS.$("#opt-table");var j=AJS.$("#my-jira-search input:checkbox[name=jira-issue]:checked");var i=AJS.$("#my-jira-search input:checkbox[name=jira-issue-all]").attr("checked")==="checked";var l=j.length===1;var p=j.length>1;var h=j.length===0;var b=AJS.JQLHelper.isSingleKeyJQLExp(AJS.$("#my-jira-search input[name=jiraSearch]").val());var c=function(){if(f&&f.isJqlQuery){m.click()}else{g.click()}};var k=function(){d.attr("disabled","disabled");m.removeAttr("disabled");g.removeAttr("disabled");c();setTimeout(function(){c()},100)};var e=function(){g.attr("disabled","disabled");d.removeAttr("disabled");if(AJS.$("input[name=insert-advanced]:checked").val()==="insert-single"){setTimeout(function(){m.removeAttr("disabled").click()},100)}};var o=function(){m.removeAttr("disabled","disabled");d.removeAttr("disabled","disabled");g.removeAttr("disabled","disabled");var s=AJS.$("input:radio[name=insert-advanced]:checked").val();if(s==="insert-single"){setTimeout(function(){m.click()},100)}};var a=function(){g.attr("disabled","disabled");d.attr("disabled","disabled");m.attr("disabled","disabled");AJS.$(".jql-display-opts-close").click();AJS.$(".jql-display-opts-open").addClass("disabled")};AJS.$(".jql-display-opts-open").removeClass("disabled");g.removeAttr("disabled");d.removeAttr("disabled");m.removeAttr("disabled");if(i&&l&&b){k()}else{if(i&&l&&!b){o()}else{if(p){e()}else{if(l&&!i){k()}else{if(n){e()}else{if(h){a()}}}}}}},isInsertTableType:function(){return AJS.$("input:radio[name=insert-advanced]:checked").val()==="insert-table"},setInsertButtonState:function(){var a=AJS.$(".jql-display-opts-close, .jql-display-opts-open");var b=AJS.$("#jira-maximum-issues");if(!a.length||(a.length&&this.isInsertTableType()&&!this.isValidMaxIssues(b.val()))){this.disableInsert()}else{this.enableInsert()}},analyticPanelActionName:"confluence.jira.plugin.searchadded"});AJS.Editor.JiraConnector.Panels.push(new AJS.Editor.JiraConnector.Panel.Search());
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/jip_createissuepanel.js' */
AJS.Editor.JiraConnector.Panel.Create=function(){};AJS.Editor.JiraConnector.Panel.Create.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Create.prototype,AJS.Editor.JiraConnector.Panel.prototype);AJS.Editor.JiraConnector.Panel.Create.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Create.prototype,{DEFAULT_PROJECT_VALUE:"-1",SHOW_MESSAGE_ON_TOP:true,EXCLUDED_FIELDS:["project","issuetype","summary","description"],PROJECTS_META:{},setSummary:function(b){var a=AJS.$('.field-group [name="summary"]',this.jipForm.formEl);a.length&&a.val(b)},resetIssue:function(){AJS.$(".issue-summary",this.container).empty();AJS.$(".issue-description",this.container).empty()},focusForm:function(){var a=AJS.$("select.server-select",this.container);if(a.length){a.focus()}else{var b=AJS.$(".project-select",this.container);b.length&&b.focus()}},authCheck:function(){this.selectedServer=this.jipForm.getCurrentServer();if(this.selectedServer.authUrl){this.showOauthChallenge()}else{this.serverSelect()}},ajaxAuthCheck:function(b){var a=this;this.endLoading();this.ajaxError(b,function(){a.authCheck(a.jipForm.getCurrentServer())})},showOauthChallenge:function(){AJS.$("div.field-group",this.container).not(".servers").hide();AJS.$(".jira-oauth-message-marker",this.container).remove();var a=this;var b=this.createOauthForm(function(){a.serverSelect()});this.container.append(b)},projectOk:function(){var a=AJS.$(".project-select option:selected",this.container).val();return a&&a.length&&a!=this.DEFAULT_PROJECT_VALUE},setInsertButtonState:function(){if(this.formHasError===false&&this.projectOk()){this.enableInsert();return true}else{this.disableInsert();return false}},startLoading:function(){var a=require("confluence/form-state-control");this.removeError(this.container);AJS.$(".loading-blanket",this.container).removeClass("hidden");a.disableElement(AJS.$("input,select,textarea",this.container));this.disableInsert();this.handleInsertWaiting(true)},endLoading:function(){var a=require("confluence/form-state-control");AJS.$(".loading-blanket",this.container).addClass("hidden");a.enableElement(AJS.$("input,select,textarea",this.container));if(AJS.$(".project-select",this.container).val()===this.DEFAULT_PROJECT_VALUE){a.disableElement(AJS.$(".issuetype-select",this.container))}this.setInsertButtonState();this.handleInsertWaiting(false)},bindEvent:function(){var b=this;var a=AJS.$('.field-group [name="summary"]',this.jipForm.formEl);a.keyup(function(){b.setInsertButtonState()});this.container.on("focus","input[data-aui-dp-uuid]",function(){var c=AJS.$(this).attr("data-aui-dp-uuid");setTimeout(function(){AJS.$("[data-aui-dp-popup-uuid="+c+"]").parents(".aui-inline-dialog").addClass("datepicker-patch")},0)})},title:function(){return "\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4e8b\u52a1"},init:function(b){var c=this;b.html('<div class="create-issue-container"></div>');this.container=AJS.$("div.create-issue-container");var a=this.container;var d=AJS.Editor.JiraConnector.servers;this.selectedServer=d[0];this.jipForm=new jiraIntegration.JiraCreateIssueForm({container:".create-issue-container",renderSummaryAndDescription:true,onError:function(){AJS.$(".field-group .error",this.container).remove();c.formHasError=true;c.disableInsert()},onServerChanged:function(){AJS.$(".field-group .error",this.container).remove();c.setInsertButtonState();c.selectedServer=this.getCurrentServer()},onRequiredFieldsRendered:function(f,e){AJS.$(".field-group .error",this.container).remove();c.formHasError=!!e.length;c.setInsertButtonState()},ajax:AJS.$.ajax});b.onselect=function(){c.onselect()};this.bindEvent()},convertFormToJSON:function(b){if(!jiraIntegration){AJS.logError("Jira integration plugin is missing!");return""}var c={};c.issues=[];var a={};a.fields={project:{id:AJS.$(".project-select option:selected",b).val()},issuetype:{id:AJS.$(".issuetype-select option:selected",b).val()},summary:AJS.$('.field-group [name="summary"]',b).val(),description:AJS.$('.field-group [name="description"]',b).val()};b.children(".create-issue-required-fields").children(".jira-field").children("input,select,textarea").not(".select2-input").each(function(d,e){var f=AJS.$(e);a.fields[f.attr("name")]=jiraIntegration.fields.getJSON(f)});c.issues.push(a);return JSON.stringify(c)},validateRequiredFieldInForm:function(b){var d=true;var a="placeholder" in document.createElement("input");var c=b.find(".field-group .icon-required, .field-group .aui-icon-required");c.each(function(h,l){var k=AJS.$(l).parent();var g=k.text();var i=k.nextAll("input,select,textarea");var j=AJS.$.trim(i.val());if(!j||(!a&&j==i.attr("placeholder"))){d=false;var f=k.parent();var e=AJS.format("{0} \u5fc5\u586b",g);f.append(aui.form.fieldError({message:e}))}});return d},clearFieldErrors:function(){AJS.$("form div.error",this.container).remove()},insertLink:function(){var b=this;var c=Confluence.getContextPath()+"/rest/jira-integration/1.0/issues";var a=AJS.$("div.create-issue-container form");var d=this.jipForm.getCurrentServer();b.clearFieldErrors();if(!b.validateRequiredFieldInForm(a)){return}this.startLoading();AJS.$.ajax({type:"POST",contentType:"application/json",url:c+"?applicationId="+this.selectedServer.id,data:this.convertFormToJSON(a),success:function(h){var f=h&&h.issues&&h.issues[0]&&h.issues[0].issue&&h.issues[0].issue.key;if(!f){if(!_.isEmpty(h.errors[0].elementErrors.errorMessages)){var g=h.errors[0].elementErrors.errorMessages;var i=Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel({errors:g,serverUrl:d.displayUrl});b.errorMsg(AJS.$("div.create-issue-container"),i)}var e=h.errors[0].elementErrors.errors;_.each(e,function(l,k){var j=aui.form.fieldError({message:l});AJS.$(AJS.format(".field-group [name={0}]",k),a).after(j)})}else{b.insertIssueLink(f,d.displayUrl+"/browse/"+f);b.resetIssue()}b.endLoading()},error:function(f,e){b.ajaxAuthCheck(f)}})},onselect:function(){var a=!!AJS.$(".aui-message > .oauth-init",this.container).length;if(this.selectedServer&&!this.selectedServer.authUrl&&a){this.jipForm.defaultFields.server.trigger("change")}else{this.setInsertButtonState()}},analyticPanelActionName:"confluence.jira.plugin.issuecreated"});AJS.Editor.JiraConnector.Panels.push(new AJS.Editor.JiraConnector.Panel.Create());
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/recentlyviewedpanel.js' */
AJS.Editor.JiraConnector.Panel.Recent=function(){};AJS.Editor.JiraConnector.Panel.Recent.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Recent.prototype,AJS.Editor.JiraConnector.Panel.prototype);AJS.Editor.JiraConnector.Panel.Recent.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Recent.prototype,{title:function(){return "\u6700\u8fd1\u6d4f\u89c8"},init:function(a){var d=AJS.Editor.JiraConnector.servers;a.html('<div id="my-recent-issues" '+(d.length>1?'class="multi-server" ':"")+"></div>");var c=this;this.selectedServer=d[0];if(d.length>1){var b=AJS.$('<div class="jira-server-select"><form action="#" method="post" class="aui"><div class="field-group"><label>Server</label><select class="select" ></select></div></form></div>').appendTo("div#my-recent-issues");this.applinkServerSelect(AJS.$(".select",b),function(e){c.selectedServer=e;c.onselect()})}a.onselect=function(){c.onselect()}},insertLink:function(){this.insertSelected()},onselect:function(){var c=require("confluence/form-state-control");var d=this;var b=AJS.$("div#my-recent-issues");this.container=b;var e=function(){b.children().not(".jira-server-select").remove()};var f;var a=function(){if(d.selectedServer.authUrl){e();var g=d.createOauthForm(function(){f()});b.append(g)}else{f()}};f=function(){if(d.currentXhr&&d.currentXhr.readyState!=4){return}var g=AJS.$(".select",b);c.disableElement(g);e();var h="key+in+issueHistory()+ORDER+BY+lastViewed+DESC";d.createIssueTableFromUrl(b,d.selectedServer.id,"/sr/jira.issueviews:searchrequest-xml/temp/SearchRequest.xml?jqlQuery="+h+"&field=summary&field=type&field=link&tempMax=50&returnMax=true",d.setSelectedIssue,d.insertLink,d.disableInsert,function(){g.length&&g.focus()},function(i){AJS.$("div.data-table",b).remove();d.ajaxError(i,a)},false)};a()},analyticPanelActionName:"confluence.jira.plugin.recentlyviewadded"});AJS.Editor.JiraConnector.Panels.push(new AJS.Editor.JiraConnector.Panel.Recent());
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = 'templates/soy/dialog.soy' */
// This file was automatically generated from dialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.ConfluenceJiraPlugin.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.ConfluenceJiraPlugin == 'undefined') { Confluence.Templates.ConfluenceJiraPlugin = {}; }


Confluence.Templates.ConfluenceJiraPlugin.displayOptsHtml = function(opt_data, opt_ignored) {
  return '<div class=\'jql-display-opts-bar data-table\'><a href="javascript:void(0)" class=\'jql-display-opts-open\' data-title="' + soy.$$escapeHtml('\u5982\u679c\u6ca1\u6709\u9009\u4e2d\u95ee\u9898\u5c06\u4e0d\u80fd\u663e\u793a\u9009\u9879\u6846\u3002') + '"><span></span><strong>' + soy.$$escapeHtml('\u663e\u793a\u64cd\u4f5c') + '</strong></a></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.displayOptsHtml.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.displayOptsHtml';
}


Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml = function(opt_data, opt_ignored) {
  return '<div class=\'jql-display-opts-overlay data-table\' data-js="display-option-wrapper"><form id="jiraMacroDlg" class="aui" action="#"><div class=\'jql-display-opts-inner\'><a href="javascript:void(0)" class=\'jql-display-opts-open\' data-js="display-option-trigger" data-title="' + soy.$$escapeHtml('\u5982\u679c\u6ca1\u6709\u9009\u4e2d\u95ee\u9898\u5c06\u4e0d\u80fd\u663e\u793a\u9009\u9879\u6846\u3002') + '"><span></span><strong>' + soy.$$escapeHtml('\u663e\u793a\u64cd\u4f5c') + '</strong></a><fieldset class="group"><legend><span>' + soy.$$escapeHtml('\u663e\u793a\u4e3a') + '</span></legend><div class="radio"><input type=\'radio\' class=\'radio\' name=\'insert-advanced\' id=\'opt-single\' value=\'insert-single\'><label for=\'opt-single\'>' + soy.$$escapeHtml('\u5355\u4e2a\u95ee\u9898') + '</label><div class=\'description\'>' + soy.$$escapeHtml('\u663e\u793a\u6b64\u5b8f\u4e3a\u5355\u4e2a\u95ee\u9898\u3002') + '</div></div><div class="radio"><input type=\'radio\' class=\'radio\' name=\'insert-advanced\' id=\'opt-total\' value=\'insert-count\'><label for=\'opt-total\'>' + soy.$$escapeHtml('\u95ee\u9898\u603b\u6570') + '</label><div class=\'description\'>' + soy.$$escapeHtml('\u663e\u793a\u95ee\u9898\u603b\u6570\u7684\u94fe\u63a5') + '<a class=\'total-issues-link\' target=\'_blank\' href=\'#\'><span class=\'total-issues-text\'>' + soy.$$escapeHtml(AJS.format('{0}\u95ee\u9898',12)) + '</span></a></div></div><div class="radio"><input type=\'radio\' class=\'radio\' checked=\'checked\' name=\'insert-advanced\' id=\'opt-table\' value=\'insert-table\'><label for=\'opt-table\'>' + soy.$$escapeHtml('\u8868\u683c') + '</label><div class=\'description\'>' + soy.$$escapeHtml('\u5b9a\u5236\u4e0b\u9762\u7684\u5217\u3002') + '</div></div></fieldset><fieldset><div class="field-group"><label>' + soy.$$escapeHtml('\u6700\u5927\u95ee\u9898\u6570') + '</label><input type="text" name="jira-maximum-issues" id="jira-maximum-issues" class="text short-field" /><div class="description">' + soy.$$escapeHtml('\u7559\u7a7a\u5c06\u83b7\u53d6\u5168\u90e8\u95ee\u9898\u3002') + '</div></div></fieldset><fieldset><div class="field-group"><label>' + soy.$$escapeHtml('\u5f85\u663e\u793a\u7684\u5217') + '</label><select id="jiraIssueColumnSelector" data-placeholder="' + soy.$$escapeHtml('\u5f00\u59cb\u8f93\u5165\u4ee5\u67e5\u770b\u53ef\u80fd\u7684\u5217') + '" multiple="true" class="select long-field"></select></div></fieldset></div></form></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml';
}


Confluence.Templates.ConfluenceJiraPlugin.searchForm = function(opt_data, opt_ignored) {
  return '<div class=\'jira-search-form\'><form class=\'aui\'><fieldset class=\'inline\'>' + ((opt_data.isMultiServer == true) ? '<div class=\'search-input\'><input type=\'text\' class=\'text search-text\' name=\'jiraSearch\' placeholder="' + soy.$$escapeHtml('\u4f8b\u5982 \u8fc7\u6ee4\uff1d\u201c\u6211\u7684 Jira \u8fc7\u6ee4\u201d') + '"/></div>' : '<div class=\'search-input one-server\'><input type=\'text\' class=\'text one-server long-field\' name=\'jiraSearch\' placeholder="' + soy.$$escapeHtml('\u4f8b\u5982 \u8fc7\u6ee4\uff1d\u201c\u6211\u7684 Jira \u8fc7\u6ee4\u201d') + '"/></div>') + '<button type=\'button\' title="' + soy.$$escapeHtml('\u641c\u7d22') + '" class=\'button\'><span class="aui-icon aui-icon-small aui-iconfont-search"></span></button></fieldset><div class=\'search-help\'>' + soy.$$escapeHtml('\u4f7f\u7528\u95ee\u9898\u5173\u952e\u5b57\u3001\u641c\u7d22URL\u3001Jira\u94fe\u63a5\u3001JQL\u6216\u7eaf\u6587\u672c\u8fdb\u884c\u641c\u7d22') + '</div></form></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.searchForm.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.searchForm';
}


Confluence.Templates.ConfluenceJiraPlugin.warningDialog = function(opt_data, opt_ignored) {
  return '<div class=\'warning-body\'><p>' + soy.$$escapeHtml('Confluence \u8fde\u63a5\u5230 Jira \u540e\uff0c\u4f60\u53ef\u4ee5\u66f4\u7b80\u5355\u7684\u8fde\u63a5\u95ee\u9898...') + '</p>' + ((opt_data.isAdministrator == false) ? '<p>' + soy.$$escapeHtml('\u60a8\u7684\u7ba1\u7406\u5458\u53ef\u4ee5\u8bbe\u7f6e\u8fd9\u4e2a\u3002') + '</p>' : '') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.warningDialog.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.warningDialog';
}


Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox = function(opt_data, opt_ignored) {
  return '<input type=\'checkbox\' name=\'jira-issue\' value=\'' + soy.$$escapeHtml(opt_data.issueKey) + '\' checked/>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox';
}


Confluence.Templates.ConfluenceJiraPlugin.issueKey = function(opt_data, opt_ignored) {
  return '<span><img class="icon" src="' + soy.$$escapeHtml(opt_data.issueIconUrl) + '"/> ' + soy.$$escapeHtml(opt_data.issueKey) + '</span>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.issueKey.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.issueKey';
}


Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer = function(opt_data, opt_ignored) {
  return '' + ((opt_data.isAdministrator == true) ? soy.$$escapeHtml('\u627e\u4e0d\u5230\u4e0eURL\u5339\u914d\u7684\u670d\u52a1\u5668\u3002') + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/admin/listapplicationlinks.action">' + soy.$$escapeHtml('\u70b9\u51fb\u8fd9\u91cc\u8fdb\u884c\u6b64\u8bbe\u7f6e') + '</a>' : soy.$$escapeHtml('\u627e\u4e0d\u5230\u4e0eURL\u5339\u914d\u7684\u670d\u52a1\u5668\uff0c\u7ba1\u7406\u5458\u624d\u80fd\u8fdb\u884c\u8bbe\u7f6e\u3002') + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/wiki/contactadministrators.action">' + soy.$$escapeHtml('\u70b9\u51fb\u8fd9\u91cc\u8054\u7cfb\u4f60\u7684\u7ba1\u7406\u5458') + '</a>');
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer';
}


Confluence.Templates.ConfluenceJiraPlugin.viewAll = function(opt_data, opt_ignored) {
  return '<div class=\'view-all\'>' + soy.$$escapeHtml('\u663e\u793a\u593420\u4e2a\u7ed3\u679c\u3002') + '<a href=\'' + soy.$$escapeHtml(opt_data.jiraIssuesLink) + '\' target=\'_blank\'>' + soy.$$escapeHtml('\u67e5\u770b\u5168\u90e8\u3002') + '</a></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.viewAll.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.viewAll';
}


Confluence.Templates.ConfluenceJiraPlugin.learnMore = function(opt_data, opt_ignored) {
  return '<a href="' + soy.$$escapeHtml('https://confluence.atlassian.com/display/DOC/Jira+Issues+Macro') + '" target=\'_blank\'>' + soy.$$escapeHtml('\u4e86\u89e3\u66f4\u591a') + '</a>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.learnMore.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.learnMore';
}


Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart = function(opt_data, opt_ignored) {
  return '<div id="jira-chart-content-' + soy.$$escapeHtml(opt_data.chartType) + '"><div class=\'jira-chart-search\'><form class=\'aui\'><fieldset class=\'inline\'>' + ((opt_data.isMultiServer == true) ? '<div class=\'jira-chart-search-input\'><input type=\'text\' id="jira-chart-search-input" class=\'text search-text\' name=\'jiraSearch\' placeholder="' + soy.$$escapeHtml('\u4f8b\u5982 \u8fc7\u6ee4\uff1d\u201c\u6211\u7684 Jira \u8fc7\u6ee4\u201d') + '"/></div><select id="jira-chart-servers" class="select" name="server" tabindex="0"></select>' : '<div class=\'jira-chart-search-input one-server\'><input type=\'text\' id="jira-chart-search-input" class=\'text one-server long-field\' name=\'jiraSearch\' placeholder="' + soy.$$escapeHtml('\u4f8b\u5982 \u8fc7\u6ee4\uff1d\u201c\u6211\u7684 Jira \u8fc7\u6ee4\u201d') + '"/></div>') + '<button id="jira-chart-search-button" type=\'button\' class=\'button\'>' + soy.$$escapeHtml('\u9884\u89c8') + '</button></fieldset><div class=\'search-help\'>' + soy.$$escapeHtml('\u4f7f\u7528\u95ee\u9898\u5173\u952e\u5b57\u3001\u641c\u7d22URL\u3001Jira\u94fe\u63a5\u3001JQL\u6216\u7eaf\u6587\u672c\u8fdb\u884c\u641c\u7d22') + '</div></form></div><div class="jira-chart-img"></div><div class="jira-chart-option" data-js="display-option-wrapper" ><form action="#" class="aui" id="jiraChartMacroOption"><div class="jiraChartOption"><a class="jirachart-display-opts-open" data-js="display-option-trigger" href="javascript:void(0)"><span class="display-option-icon"></span><strong>' + soy.$$escapeHtml('\u663e\u793a\u64cd\u4f5c') + '</strong></a>' + ((opt_data.chartType == 'pie') ? Confluence.Templates.ConfluenceJiraPlugin.piechartForm(null) : (opt_data.chartType == 'createdvsresolved') ? Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved(null) : (opt_data.chartType == 'twodimensional') ? Confluence.Templates.ConfluenceJiraPlugin.twoDimensional(null) : '') + '</div></form></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart';
}


Confluence.Templates.ConfluenceJiraPlugin.piechartForm = function(opt_data, opt_ignored) {
  return '<fieldset><div class="field-group"><label for="jira-chart-statType">' + soy.$$escapeHtml('\u56fe\u8868\u751f\u6210\u81ea') + '</label><select name="type" id="jira-chart-statType" class="select"></select></div></fieldset><fieldset class="group"><div class="field-group"><label for="jira-chart-width">' + soy.$$escapeHtml('\u5bbd') + '</label><input type="text" name="jira-chart-width" id="jira-chart-width" class="text short-field"><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment widthInfo" title="' + soy.$$escapeHtml('\u6309\u50cf\u7d20\u70b9\u3001\u767e\u5206\u6bd4\u65b9\u5f0f\u8f93\u5165\u5bbd\u5ea6\uff0c\u6216\u4e0d\u8f93\u5165\u5185\u5bb9\u81ea\u52a8\u8c03\u6574\u5927\u5c0f') + '"></span><div class="checkbox"><input type="checkbox" id="jira-pie-chart-show-border" class="checkbox jira-chart-show-border"><label for="jira-pie-chart-show-border">' + soy.$$escapeHtml('\u663e\u793a\u8fb9\u6846') + '</label></div><div class="checkbox"><input type="checkbox" id="jira-pie-chart-show-infor" class="checkbox jira-chart-show-infor"><label for="jira-pie-chart-show-infor">' + soy.$$escapeHtml('\u663e\u793a\u56fe\u8868\u4fe1\u606f') + '</label></div></div></fieldset>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.piechartForm.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.piechartForm';
}


Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved = function(opt_data, opt_ignored) {
  return '<fieldset><div class="field-group"><label for="created-vs-resolved-chart-periodName">' + soy.$$escapeHtml('\u671f\u95f4') + '</label><select class="select" id="created-vs-resolved-chart-periodName" name="created-vs-resolved-chart-periodName"><option value="hourly">' + soy.$$escapeHtml('\u6bcf\u5c0f\u65f6') + '</option><option value="daily">' + soy.$$escapeHtml('\u6bcf\u65e5') + '</option><option value="weekly">' + soy.$$escapeHtml('\u6bcf\u5468') + '</option><option value="monthly">' + soy.$$escapeHtml('\u6bcf\u6708') + '</option><option value="quarterly">' + soy.$$escapeHtml('\u6bcf\u5b63') + '</option><option value="yearly">' + soy.$$escapeHtml('\u6bcf\u5e74') + '</option></select><div class="error"></div></div><div class="field-group"><label for="created-vs-resolved-chart-daysprevious">' + soy.$$escapeHtml('\u51e0\u5929\u4ee5\u524d') + '<span class="aui-icon icon-required"></span></label><input type="text" class="text" id="created-vs-resolved-chart-daysprevious" value="30"><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment daysPreviousInfo" title="' + soy.$$escapeHtml('\u8981\u5305\u62ec\u7684\u5929\u6570\uff08\u4ece\u4eca\u5929\u5f80\u56de\u7b97\uff09\u3002') + '"></span><div class="error days-previous-error"></div></div><fieldset class="group"><div class="checkbox"><input type="checkbox" id="created-vs-resolved-chart-cumulative" name="created-vs-resolved-chart-cumulative" class="checkbox"><label for="created-vs-resolved-chart-cumulative">' + soy.$$escapeHtml('\u7d2f\u8ba1') + '</label><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment cumulativeInfo" title="' + soy.$$escapeHtml('\u9010\u6b65\u6dfb\u52a0\u603b\u8ba1 (1, 2, 3) \u6d3b\u7740\u663e\u793a\u5355\u4e2a\u7684\u503c(1,1,1)\u3002') + '"></span></div><div class="checkbox"><input type="checkbox" id="created-vs-resolved-chart-showunresolvedtrend" name="created-vs-resolved-chart-showunresolvedtrend" class="checkbox"><label for="created-vs-resolved-chart-showunresolvedtrend">' + soy.$$escapeHtml('\u663e\u793a\u672a\u89e3\u51b3\u7684\u8d8b\u52bf') + '</label><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment showunresolvedtrendInfo" title="' + soy.$$escapeHtml('\u5305\u62ec\u4e00\u4e2a\u663e\u793a\u672a\u89e3\u51b3\u7684\u95ee\u9898\u7684\u6b21\u8981\u60c5\u8282\u3002') + '"></span></div></fieldset><div class="field-group"><label for="created-vs-resolved-chart-versionLabel">' + soy.$$escapeHtml('\u663e\u793a\u7248\u672c') + '</label><select class="select" id="created-vs-resolved-chart-versionLabel" name="created-vs-resolved-chart-versionLabel"><option value="all">' + soy.$$escapeHtml('\u5168\u90e8\u7248\u672c') + '</option><option value="major">' + soy.$$escapeHtml('\u4ec5\u4e3b\u8981\u7248\u672c') + '</option><option value="none">' + soy.$$escapeHtml('\u65e0') + '</option></select><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment versionLabelInfo" title="' + soy.$$escapeHtml('\u6807\u8bb0\u8fd9\u4e2a\u56fe\u8868\u4e2d\u7684\u7248\u672c\u53d1\u5e03\u65e5\u671f\u3002') + '"></span><div class="error"></div></div></fieldset><fieldset class="group"><div class="field-group"><label for="jira-chart-width">' + soy.$$escapeHtml('\u5bbd') + '</label><input type="text" name="jira-chart-width" id="jira-chart-width" class="text short-field"><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment widthInfo" title="' + soy.$$escapeHtml('\u6309\u50cf\u7d20\u70b9\u3001\u767e\u5206\u6bd4\u65b9\u5f0f\u8f93\u5165\u5bbd\u5ea6\uff0c\u6216\u4e0d\u8f93\u5165\u5185\u5bb9\u81ea\u52a8\u8c03\u6574\u5927\u5c0f') + '"></span><div class="checkbox"><input type="checkbox" id="jira-createdvsresolved-chart-show-border" class="checkbox jira-chart-show-border"><label for="jira-createdvsresolved-chart-show-border">' + soy.$$escapeHtml('\u663e\u793a\u8fb9\u6846') + '</label></div><div class="checkbox"><input type="checkbox" id="jira-createdvsresolved-chart-show-infor" class="checkbox jira-chart-show-infor"><label for="jira-createdvsresolved-chart-show-infor">' + soy.$$escapeHtml('\u663e\u793a\u56fe\u8868\u4fe1\u606f') + '</label></div></div></fieldset>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved';
}


Confluence.Templates.ConfluenceJiraPlugin.twoDimensional = function(opt_data, opt_ignored) {
  return '<fieldset><div id="jira-chart-support-all-version" class="hidden"></div><div class="field-group"><label for="twodimensional-xaxis">' + soy.$$escapeHtml('X\u8f74') + '</label><select class="select" id="twodimensional-xaxis"><option value="statuses">' + soy.$$escapeHtml('\u72b6\u6001') + '</option><option value="priorities">' + soy.$$escapeHtml('\u4f18\u5148\u7ea7') + '</option><option value="assignees">' + soy.$$escapeHtml('\u7ecf\u529e\u4eba') + '</option><option value="allFixfor">' + soy.$$escapeHtml('\u4fee\u590d\u7248\u672c\uff08\u6240\u6709\uff09') + '</option><option value="components">' + soy.$$escapeHtml('\u7ec4\u4ef6') + '</option><option value="issuetype">' + soy.$$escapeHtml('\u4e8b\u52a1\u7c7b\u578b') + '</option></select></div><div class="field-group"><label for="twodimensional-yaxis">' + soy.$$escapeHtml('Y\u8f74') + '</label><select class="select" id="twodimensional-yaxis"><option value="statuses">' + soy.$$escapeHtml('\u72b6\u6001') + '</option><option value="priorities">' + soy.$$escapeHtml('\u4f18\u5148\u7ea7') + '</option><option value="assignees">' + soy.$$escapeHtml('\u7ecf\u529e\u4eba') + '</option><option value="allFixfor">' + soy.$$escapeHtml('\u4fee\u590d\u7248\u672c\uff08\u6240\u6709\uff09') + '</option><option value="components">' + soy.$$escapeHtml('\u7ec4\u4ef6') + '</option><option value="issuetype">' + soy.$$escapeHtml('\u4e8b\u52a1\u7c7b\u578b') + '</option></select></div><div class="field-group"><label for="twodimensional-number-of-result">' + soy.$$escapeHtml('\u663e\u793a\u7684\u884c') + '</label><input type="text" name="twodimensional-number-of-result" id="twodimensional-number-of-result" class="text short-field"><div class="error twodimensional-number-of-result-error"></div></div></fieldset>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.twoDimensional.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.twoDimensional';
}


Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage = function(opt_data, opt_ignored) {
  return '<div class="aui-message-container"><div class="aui-message error closeable shadowed"><span class=\'message\'>' + soy.$$escapeHtml(opt_data.message) + '</span><span class="aui-icon icon-close" role="button" tabindex="0"></span></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage';
}


Confluence.Templates.ConfluenceJiraPlugin.noServerWarning = function(opt_data, opt_ignored) {
  return '<div class="aui-message-container"><div class="aui-message warning">' + ((opt_data.isAdministrator == true) ? soy.$$escapeHtml('\u627e\u4e0d\u5230\u4e0eURL\u5339\u914d\u7684\u670d\u52a1\u5668\u3002') + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/admin/listapplicationlinks.action">' + soy.$$escapeHtml('\u70b9\u51fb\u8fd9\u91cc\u8fdb\u884c\u6b64\u8bbe\u7f6e') + '</a>' : soy.$$escapeHtml('\u627e\u4e0d\u5230\u4e0eURL\u5339\u914d\u7684\u670d\u52a1\u5668\uff0c\u7ba1\u7406\u5458\u624d\u80fd\u8fdb\u884c\u8bbe\u7f6e\u3002') + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/wiki/contactadministrators.action">' + soy.$$escapeHtml('\u70b9\u51fb\u8fd9\u91cc\u8054\u7cfb\u4f60\u7684\u7ba1\u7406\u5458') + '</a>') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.noServerWarning.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.noServerWarning';
}


Confluence.Templates.ConfluenceJiraPlugin.addMoreToComeLink = function(opt_data, opt_ignored) {
  return '<li class="page-menu-item"><button class="item-button moreToCome"><a target="_blank" href="http://go.atlassian.com/confluencejiracharts">' + soy.$$escapeHtml('\u66f4\u591a...') + '</a></button></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.addMoreToComeLink.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.addMoreToComeLink';
}


Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink = function(opt_data, opt_ignored) {
  return '<li class="page-menu-item"><hr><span class="aui-nav-heading jira-padding-left-10px"><strong>' + soy.$$escapeHtml('\u5176\u4ed6 Jira \u5185\u5bb9') + '</strong></span><nav class="aui-navgroup aui-navgroup-vertical"><div class="aui-navgroup-inner"><ul class="aui-nav"><li><button class="item-button jira-left-panel-link" id="' + soy.$$escapeHtml(opt_data.id) + '">' + soy.$$escapeHtml(opt_data.label) + '</button></li></ul></div></nav></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink';
}


Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid = function(opt_data, opt_ignored) {
  return '<div class="aui-message-container"><div class="aui-message warning">' + soy.$$escapeHtml('Jira\u670d\u52a1\u5668\u4e0d\u80fd\u7406\u89e3\u60a8\u7684\u67e5\u8be2\uff0c\u5982\u679c\u8f93\u5165\u7684\u662f JQL, \u8bf7\u786e\u4fdd\u8bed\u6cd5\u683c\u5f0f\u6b63\u786e\uff0c\u5982\u679c\u8f93\u5165\u7684\u662f\u95ee\u9898\u5173\u952e\u5b57\uff0c\u8bf7\u786e\u4fdd\u6b64\u95ee\u9898\u5b58\u5728\u5e76\u6709\u6743\u67e5\u770b\u3002') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid';
}


Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn = function(opt_data, opt_ignored) {
  return '<div class="error width-error">' + ((opt_data.error == 'wrongFormat') ? soy.$$escapeHtml('\u5bbd\u5ea6\u5fc5\u987b\u4e3a\u6b63\u786e\u683c\u5f0f') : (opt_data.error == 'wrongNumber') ? soy.$$escapeHtml('\u5bbd\u5ea6\u5fc5\u987b\u662f100 \u81f3 9000\u4e4b\u95f4\u7684\u6570\u5b57') : '') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn';
}


Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues = function(opt_data, opt_ignored) {
  return '<div id="jira-max-number-error" class="error">' + soy.$$escapeHtml('\u5fc5\u987b\u4e3a\u6570\u5b571\u81f31000\u3002') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues';
}


Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion = function(opt_data, opt_ignored) {
  return '<div class="jira-unsupported-version aui-message-container"><div class="aui-message warning">' + soy.$$escapeHtml('Jira \u56fe\u8868\u5728\u6b64\u7248\u672cJira\u4e2d\u65e0\u6cd5\u4f7f\u7528\uff0c\u5347\u7ea7\u5230Jira 6.1.1 \u6216\u4ee5\u4e0a\u7248\u672c\u624d\u80fd\u4f7f\u7528\u6b64\u5b8f\u3002') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = 'templates/soy/create_issues.soy' */
// This file was automatically generated from create_issues.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.ConfluenceJiraPlugin.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.ConfluenceJiraPlugin == 'undefined') { Confluence.Templates.ConfluenceJiraPlugin = {}; }


Confluence.Templates.ConfluenceJiraPlugin.createIssuesForm = function(opt_data, opt_ignored) {
  return '<form action="#" method="post" class="aui" id="create-issues-form"><div class="loading-blanket hidden"><div class="loading-data"></div></div><div class="field-group servers"><label>' + soy.$$escapeHtml('\u670d\u52a1\u5668') + '</label><select class="select server-select"></select></div><div class="field-group project-select-parent" ><label>' + soy.$$escapeHtml('\u9879\u76ee') + '</label><select class="select project-select" name="pid"></select></div><div class="field-group type-select-parent issues-type-group" ><label>' + soy.$$escapeHtml('\u4e8b\u52a1\u7c7b\u578b') + '</label><select class="select type-select" name="issuetype"></select></div><div class="field-group"><label>' + soy.$$escapeHtml('\u6982\u8981') + '<span class="aui-icon icon-required"></span></label><input class="text issue-summary" type="text" name="summary"/></div><div id="jira-required-fields-panel"></div><div class="field-group"><label>' + soy.$$escapeHtml('\u63cf\u8ff0') + '</label><textarea class="issue-description textarea" rows="5" name="description"></textarea></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.createIssuesForm.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.createIssuesForm';
}


Confluence.Templates.ConfluenceJiraPlugin.renderOptions = function(opt_data, opt_ignored) {
  var output = '';
  var optionList15 = opt_data.options;
  var optionListLen15 = optionList15.length;
  for (var optionIndex15 = 0; optionIndex15 < optionListLen15; optionIndex15++) {
    var optionData15 = optionList15[optionIndex15];
    output += '<option value="' + soy.$$escapeHtml(optionData15.id) + '">' + soy.$$escapeHtml(optionData15.name) + '</option>';
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.renderOptions.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.renderOptions';
}


Confluence.Templates.ConfluenceJiraPlugin.renderOption = function(opt_data, opt_ignored) {
  return '<option value="' + soy.$$escapeHtml(opt_data.option.id) + '" data-jira-option-key="' + soy.$$escapeHtml(opt_data.option.key) + '">' + soy.$$escapeHtml(opt_data.option.name) + '</option>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.renderOption.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.renderOption';
}


Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel = function(opt_data, opt_ignored) {
  var output = '<div>' + soy.$$escapeHtml('\u521b\u5efa\u95ee\u9898\u53d1\u751f\u9519\u8bef\u5728') + '<a target="_blank" href=' + soy.$$escapeHtml(opt_data.serverUrl) + '>Jira</a></div><ul>';
  var errorList36 = opt_data.errors;
  var errorListLen36 = errorList36.length;
  for (var errorIndex36 = 0; errorIndex36 < errorListLen36; errorIndex36++) {
    var errorData36 = errorList36[errorIndex36];
    output += '<li>' + soy.$$escapeHtml(errorData36) + '</li>';
  }
  output += '</ul>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:text-placeholders-jira', location = '/jira/placeholder.js' */
(function(){AJS.bind("init.rte",function(){AJS.bind("editor.text-placeholder.activated",function(b,a){if(a&&a.placeholderType==="jira"){AJS.Editor.JiraConnector.open(AJS.Editor.JiraConnector.source.instructionalText)}});if(AJS.Rte.Placeholder&&AJS.Rte.Placeholder.addPlaceholderType){AJS.Rte.Placeholder.addPlaceholderType({type:"jira",label:"Jira \u5b8f",tooltip:"\u8bf4\u660e\u6587\u672c\u5c06\u7528Jira\u5b8f\u66ff\u6362\u3002",activation:{click:true,keypress:false}})}})})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/jirachart-dialog.js' */
AJS.Editor.JiraChart=(function(j){var k=require("confluence/form-state-control");var n=-1;var B=6109;var e=6155;var d="\u63d2\u5165";var r="\u53d6\u6d88";var z="\u63d2\u5165Jira\u56fe\u8868";var c;var g;var F=function(I){if(!c){c=new AJS.ConfluenceDialog({width:840,height:590,id:"jira-chart"});c.addHeader(z);g=AJS.Editor.JiraChart.Panels;for(var H=0;H<g.length;H++){if(typeof(g[H].title)==="function"){c.addPanel(g[H].title())}else{if(g[H].title!==undefined){c.addPanel(g[H].title)}}var K=c.getCurrentPanel();g[H].init(K)}j("#jira-chart ul.dialog-page-menu").show().append(Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink({id:"open-jira-issue-dialog",label:"Jira\u95ee\u9898/\u8fc7\u6ee4\u5668"}));c.addButton(d,function(){var L=g[c.getCurrentPanel().id];if(b(L.chartType)&&L.isImageChartExisted()){var M=L.getMacroParamsFromDialog();D(M);AJS.Editor.JiraChart.close()}else{y(j("#jira-chart-content-"+L.chartType))}},"insert-jira-chart-macro-button");c.addLink("\u9009\u62e9\u5b8f",function(){c.hide();AJS.MacroBrowser.open(false)},"dialog-back-link");c.addCancel(r,function(){AJS.Editor.JiraChart.close()})}AJS.$("#jira-chart .dialog-page-menu button").click(function(){var N=g[c.getCurrentPanel().id];var M=c.getCurrentPanel().body;var L=AJS.Editor.JiraChart.Helper.getSelectedServer(M);o(M,L);q(M);N.handleInsertButton();N.focusForm();N.resetDisplayOption()});var J=c.getCurrentPanel().body;q(J);var G=G||function(M){var L={};_.each(M,function(N,O){L[N.chartType]=O});return L}(g);f(G,I);a();c.gotoPanel(s(G,I));c.overrideLastTab();c.show();i()};var s=function(G,H){if(H&&H.params){return G[H.params.chartType]}return 0};var t=function(){_.each(AJS.Editor.JiraChart.Panels,function(G){G.preBinding&&typeof G.preBinding==="function"&&G.preBinding()})};var i=function(){j("#open-jira-issue-dialog").click(function(){AJS.Editor.JiraChart.close();if(AJS.Editor.JiraConnector){AJS.Editor.JiraConnector.openCleanDialog(false)}})};var E=function(G){if(AJS.Editor.JiraConnector.servers.length>0){AJS.Editor.JiraConnector.Panel.prototype.applinkServerSelect(G.find("#jira-chart-servers"),function(H){m(G);if(q(G)){o(G,H);C(G)}})}};var b=function(H){var G=c.getCurrentPanel().body;return G.find("#jira-chart-content-"+H).length>0};var l=function(G){G(g[c.getCurrentPanel().id])};var y=function(G){if(AJS.Editor.JiraChart.Helper.convertSearchTextToJQL(G)===undefined){return}l(function(H){H.renderChart()})};var q=function(G){if(G.find("#jira-chart-support-all-version").length){return true}var H=AJS.Editor.JiraChart.Helper.getSelectedServer(G);if(x(H)){u(G);A(G);return false}return true};var D=function(G){var H=function(I){tinymce.confluence.macrobrowser.macroBrowserComplete(I)};if(AJS.Editor.inRichTextMode()){H({name:"jirachart",params:G})}};var f=function(G,I){for(var H=0;H<g.length;H++){g[H].resetDialogValue()}t();if(I&&I.params){var J=g[G[I.params.chartType]];J.bindingDataFromMacroToForm(I.params)}};var w=function(){if(AJS.Editor.JiraConnector.servers===undefined||AJS.Editor.JiraConnector.servers.length===0){AJS.Editor.JiraConnector.warningPopup(AJS.Meta.get("is-admin"));return false}return true};var m=function(G){G.find(".jira-oauth-message-marker").remove();G.find(".jira-chart-img").empty();G.find("#jira-chart-search-input").empty()};var a=function(){k.disableElement(j("#jira-chart").find(".insert-jira-chart-macro-button"))};var h=function(){var G=AJS.$("#jira-chart").find(".insert-jira-chart-macro-button");if(G.is(":disabled")){k.enableElement(G)}};var p=function(G){k.disableElement(G.find("#jira-chart-search-button"))};var v=function(G){if(G.find("#jira-chart-search-button").is(":disabled")){k.enableElement(G.find("#jira-chart-search-button"))}};var o=function(I,H){j(".jira-oauth-message-marker",I).remove();var J={selectedServer:H,msg:AJS.Editor.JiraConnector.Panel.prototype.msg};if(H&&H.authUrl){var G=AJS.Editor.JiraConnector.Panel.prototype.createOauthForm.call(J,function(){j(".jira-oauth-message-marker",I).remove();AJS.Editor.JiraChart.search(I)});I.find("div.jira-chart-search").append(G)}};var u=function(G){G.find(".jira-chart-img").html(Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion())};var A=function(H){H.find("#jira-chart-search-input").attr("disabled","disabled");H.find("#jira-chart-search-button").attr("disabled","disabled");var G=H.find(".jirachart-display-opts-close, .jirachart-display-opts-open");if(G.hasClass("jirachart-display-opts-close")){G.click()}G.addClass("disabled");a()};var C=function(G){G.find("#jira-chart-search-input").removeAttr("disabled");G.find("#jira-chart-search-button").removeAttr("disabled");G.find(".jirachart-display-opts-open").removeClass("disabled")};var x=function(H){var G=H.buildNumber;return G==n||(G>=B&&G<e)};return{close:function(){c.hide();tinymce.confluence.macrobrowser.macroBrowserCancel()},edit:function(G){if(!w()){return}F(G);var I=c.getCurrentPanel().body;if(!q(I)){return}C(I);if(G.params!==undefined&&G.params.serverId!==undefined){y(I)}var H=AJS.Editor.JiraChart.Helper.getSelectedServer(I);o(I,H)},search:y,disableInsert:a,enableInsert:h,disableSearch:p,enableSearch:v,insertJiraChartMacroWithParams:D,open:F,clearChartContent:m,loadServers:E,validateServerSupportedChart:q}})(AJS.$);AJS.Editor.JiraChart.Panels=[];AJS.MacroBrowser.setMacroJsOverride("jirachart",{opener:AJS.Editor.JiraChart.edit});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/jirachart-helper.js' */
AJS.Editor.JiraChart.Helper=(function(g){var a=/^\d+$/;var m={};var f=function(o){o=(o&&typeof o==="string")?o.replace("px",""):"";if(o==="auto"){o=""}if(o.indexOf("%")>0){o=o.replace("%","")*4}return o};var n=function(o){return a.test(o)};var k=function(o){var p=AJS.Editor.JiraConnector.servers;if(p.length>1){return o.find("#jira-chart-servers option:selected").data("jiraapplink")}return p[0]};var h=function(p){var u=AJS.Editor.JiraConnector.servers;var r;var q=p.find("#jira-chart-search-input").val();if(q.indexOf("http")===0){var t=AJS.JQLHelper.findServerIndexFromUrl(q,u);if(t!==-1){r=u[t].id;p.find("#jira-chart-servers").val(r)}else{var s=Confluence.Templates.ConfluenceJiraPlugin.noServerWarning({isAdministrator:AJS.Meta.get("is-admin"),contextPath:Confluence.getContextPath()});p.find(".jira-chart-img").html(s);AJS.Editor.JiraChart.disableInsert();return}}var o=AJS.JQLHelper.convertToJQL(q,r);if(o){p.find("#jira-chart-search-input").val(o)}else{p.find(".jira-chart-img").html(Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid());AJS.Editor.JiraChart.disableInsert()}return o};var d=function(o,q){var s=k(o);if(q){var p=s.id;var t=m[p];if(!t){AppLinks.makeRequest({appId:s.id,type:"GET",url:"/rest/gadget/1.0/statTypes",dataType:"json",async:false,success:function(u){if(u){m[s.id]=u;t=u}},error:function(u){if(u){try{m[s.id]=JSON.parse(u.responseText);t=JSON.parse(u.responseText)}catch(v){AJS.error("Error contacting the server "+s.id+" with response "+u.response)}}AJS.log("Jira Chart Macro: unable to retrieve statTypes from AppLink: "+s.id)}}).fail(function(u){if(u){try{m[s.id]=JSON.parse(u.responseText);t=JSON.parse(u.responseText)}catch(v){AJS.error("Error contacting the server "+s.id+" with response "+u.response)}}})}var r="";if(t&&typeof t.stats!=="undefined"){_.each(t.stats,function(u){r+="<option value = '"+u.value+"'>"+AJS.escapeHtml(u.label)+" </option>"})}q.html(r)}};var l=function(o){o.next().next(".width-error").remove();var p=f(o.val());var q;if(p){if(n(p)){if(p<100||p>9000){q="wrongNumber"}}else{q="wrongFormat"}}if(q){o.next().after(Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn({error:q}));AJS.Editor.JiraChart.disableInsert();return false}return true};var j=function(o){return{jql:o.find("#jira-chart-search-input"),width:o.find("#jira-chart-width"),border:o.find(".jira-chart-show-border"),showinfor:o.find(".jira-chart-show-infor"),displayOption:o.find(".jirachart-display-opts-close, .jirachart-display-opts-open"),server:o.find("#jira-chart-servers")}};var c=function(p,o){p.jql.val(decodeURIComponent(o.jql));p.width.val(o.width);p.border.attr("checked",(o.border==="true"));p.showinfor.attr("checked",(o.showinfor==="true"));if(AJS.Editor.JiraConnector.servers.length>1){p.server.val(o.serverId)}};var b=function(q,o){var p=k(o);return{jql:encodeURIComponent(q.jql.val()),width:f(q.width.val()),border:q.border.prop("checked"),showinfor:q.showinfor.prop("checked"),serverId:p.id,server:p.name,isAuthenticated:!p.authUrl}};var i=function(p,o){return{contentId:AJS.Meta.get("page-id"),macro:{name:"jirachart",params:{jql:p.jql,serverId:p.serverId,width:p.width,border:p.border,showinfor:p.showinfor,chartType:o}}}};var e=function(o){if(o){return AJS.$.trim(o.val())!==""&&o.val()!==o.attr("placeholder")}return false};return{getSelectedServer:k,bindingCommonChartElements:j,bindingCommonDataFromMacroToForm:c,getCommonMacroParamsFromDialog:b,getCommonChartParamsRequest:i,convertSearchTextToJQL:h,convertFormatWidth:f,isChartWidthValid:l,isNumber:n,isJqlNotEmpty:e,populateStatType:d}})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/jirachart-panel.js' */
AJS.Editor.JiraChart.Panel=function(){};AJS.Editor.JiraChart.Panel.prototype={init:function(a){var b=this.chartType;var c=Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart({isMultiServer:AJS.Editor.JiraConnector.servers.length>1,chartType:b});a.html(c);this.container=AJS.$(this.containerId);AJS.Editor.JiraChart.clearChartContent(this.container);AJS.Editor.JiraChart.loadServers(this.container);this.bindingChartElements();this.bindingActions()},bindingActions:function(){var e=this;var d=function(){if(e.isFormValid()){AJS.Editor.JiraChart.search(e.container)}else{AJS.Editor.JiraChart.disableInsert()}};var b=e.container.find(e.clickableElements);b.click(d);var f=e.container.find(e.onChangeElements);f.change(d);e.chartElements.jql.change(function(){if(this.value!==e.jqlWhenEnterKeyPress){e.container.find(".jira-chart-img").empty();AJS.Editor.JiraChart.disableInsert()}e.jqlWhenEnterKeyPress=""}).bind("paste",function(){setTimeout(function(){if(e.isFormValid()){e.jqlWhenEnterKeyPress=e.chartElements.jql.val();AJS.Editor.JiraChart.search(e.container)}},100)});var a=e.container.find("input[type='text']");var c=function(g){if(g.attr("id")==="jira-chart-search-input"){e.jqlWhenEnterKeyPress=g.val()}};a.unbind("keydown").keydown(function(g){if(g.which==13){var h=function(i){a.unbind("keyup",h);if(e.isFormValid()){AJS.Editor.JiraChart.search(e.container)}c(a);i.stopPropagation();return false};a.keyup(h);g.stopPropagation();return false}});e.bindSelectOption();e.bindingServerChange()},bindingServerChange:function(){var a=this;a.chartElements.server.change(function(){if(a.isFormValid()&&AJS.Editor.JiraChart.validateServerSupportedChart(a.container)){AJS.Editor.JiraChart.search(a.container)}else{AJS.Editor.JiraChart.disableInsert()}})},renderChart:function(){var e=this;var b=this.getChartParamsRequest();var a=Confluence.getContextPath()+"/rest/tinymce/1/macro/preview";var d=this.container.find(".jira-chart-img");d.html('<div class="loading-data"></div>');var c=d.find(".loading-data")[0];AJS.$.data(c,"spinner",Raphael.spinner(c,50,"#666"));if(e.request){e.request.abort()}e.request=AJS.$.ajax({url:a,type:"POST",contentType:"application/json",data:JSON.stringify(b)}).done(function(f){d.html("").hide();var i=AJS.$('<iframe frameborder="0" id="chart-preview-iframe"></iframe>');i.appendTo(d);var h=i[0].contentWindow,g=h.document;i.on("load",function(){h.AJS.$("#main").addClass("chart-preview-main");d.show();e.handleInsertButton()});f=f.replace("window.onload","var chartTest");g.open();g.write(f);g.close()}).error(function(f){if(f.statusText!="abort"){AJS.log("Jira Chart Macro - Fail to get data from macro preview");d.html(Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage({message:"\u4e0d\u80fd\u5448\u73b0Jira\u56fe\u8868\u5b8f\uff0c\u53d1\u751f\u8fd0\u884c\u9519\u8bef\u3002"}))}AJS.Editor.JiraChart.disableInsert()})},resetDialogValue:function(){var a=AJS.$("input",this.container);a.filter(":text").val("");a.filter(":checked").removeAttr("checked");this.container.find("#jira-chart-search-input").val();this.container.find(".jira-chart-img").empty();this.resetDisplayOption()},resetDisplayOption:function(){var b=this;var a=this.chartElements.displayOption;a.addClass("jirachart-display-opts-open");a.removeClass("jirachart-display-opts-close");setTimeout(function(){var c=b.container.find(".jira-chart-option");c.scrollTop(0);c.css({overflow:"hidden",top:"430px"})},0)},bindSelectOption:function(){var c=this;var b=c.container.find(".jira-chart-option");var d=function(g){var f=40;var i=b.position().top+"px";var e="";var h={top:430};if(g){i="";e=f-b.find("#jiraChartMacroOption").height()+"px";h={bottom:0};b.css("overflow","auto")}else{b.css("overflow","hidden")}b.css("top",i);b.css("bottom",e);b.animate(h,500)};b.css("top","430px");var a=this.chartElements.displayOption;a.click(function(g){var f=AJS.$(this);g.preventDefault();if(f.hasClass("disabled")){return}var h=f.hasClass("jirachart-display-opts-open");if(h){d(true);f.addClass("jirachart-display-opts-close");f.removeClass("jirachart-display-opts-open")}else{d();f.removeClass("jirachart-display-opts-close");f.addClass("jirachart-display-opts-open")}})},isImageChartExisted:function(){return this.container.find("#chart-preview-iframe").contents().find(".jira-chart-macro-img").length>0},focusForm:function(){this.container.find("#jira-chart-search-input").focus()},handleInsertButton:function(){if(this.isFormValid()&&this.isResultValid()){AJS.Editor.JiraChart.enableInsert()}else{AJS.Editor.JiraChart.disableInsert()}}};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/piechart-panel.js' */
AJS.Editor.JiraChart.Panel.PieChart=function(d){AJS.Editor.JiraChart.Panel.call(this);var a="\u997c\u56fe";var c="pie";var b=this;this.title=a;this.chartType=c;this.containerId="#jira-chart-content-pie";this.clickableElements=".jira-chart-search button, .jira-chart-show-border, .jira-chart-show-infor";this.onChangeElements="#jira-chart-statType, #jira-chart-width";this.isFormValid=function(){return AJS.Editor.JiraChart.Helper.isChartWidthValid(b.chartElements.width)&&AJS.Editor.JiraChart.Helper.isJqlNotEmpty(b.chartElements.jql)};this.isResultValid=function(){return this.container.find("#chart-preview-iframe").contents().find(".jira-chart-macro-wrapper").length};this.bindingActions=function(){var e=this;AJS.Editor.JiraChart.Panel.prototype.bindingActions.call(e);e.container.find(".widthInfo").tooltip({gravity:"w"})};this.bindingServerChange=function(){b.chartElements.server.change(function(){AJS.Editor.JiraChart.Helper.populateStatType(b.container,b.chartElements.statType);if(b.isFormValid()){AJS.Editor.JiraChart.search(b.container)}else{AJS.Editor.JiraChart.disableInsert()}})};this.bindingChartElements=function(){this.chartElements=AJS.Editor.JiraChart.Helper.bindingCommonChartElements(this.container);this.chartElements.statType=this.container.find("#jira-chart-statType")};this.getChartParamsRequest=function(){var f=this.getMacroParamsFromDialog();var e=AJS.Editor.JiraChart.Helper.getCommonChartParamsRequest(f,this.chartType);e.macro.params.statType=f.statType;return e};this.getMacroParamsFromDialog=function(){var e=AJS.Editor.JiraChart.Helper.getCommonMacroParamsFromDialog(this.chartElements,this.container);e.chartType=c;e.statType=this.chartElements.statType.val();return e};this.bindingDataFromMacroToForm=function(e){if(e){AJS.Editor.JiraChart.Helper.bindingCommonDataFromMacroToForm(this.chartElements,e);this.chartElements.statType.val(e.statType)}};this.preBinding=function(){AJS.Editor.JiraChart.Helper.populateStatType(this.container,this.container.find("#jira-chart-statType"))}};AJS.Editor.JiraChart.Panel.PieChart.prototype=AJS.Editor.JiraChart.Panel.prototype;AJS.Editor.JiraChart.Panel.PieChart.prototype.constructor=AJS.Editor.JiraChart.Panel.PieChart;AJS.Editor.JiraChart.Panels.push(new AJS.Editor.JiraChart.Panel.PieChart(AJS.$));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/createdvsresolvedchart-panel.js' */
AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart=function(e){AJS.Editor.JiraChart.Panel.call(this);var d="createdvsresolved";var c=this;var a=function(){c.container.find("#created-vs-resolved-chart-periodName").val("daily");c.container.find("#created-vs-resolved-chart-daysprevious").val("30")};var b=function(){var h=c.chartElements.periodName.val();var g=e.trim(c.chartElements.daysprevious.val());var f=c.container.find(".days-previous-error");if(g===""){c.container.find(".days-previous-error").html("\u4e4b\u524d\u7684\u5929\u6570\u662f\u5fc5\u586b\u5b57\u6bb5\u3002");return false}if(!AJS.Editor.JiraChart.Helper.isNumber(g)||g<0){f.html("\u4e4b\u524d\u7684\u5929\u6570\u5fc5\u987b\u662f\u4e00\u4e2a\u6b63\u6570\u3002");return false}switch(h){case"hourly":isValid=g<=10;if(!isValid){f.html(AJS.format("\u5929\u6570\u4e0d\u80fd\u8d85\u8fc7 {0} {1} \u7684\u65f6\u95f4\u8303\u56f4",10,h))}break;case"daily":isValid=g<=300;if(!isValid){f.html(AJS.format("\u5929\u6570\u4e0d\u80fd\u8d85\u8fc7 {0} {1} \u7684\u65f6\u95f4\u8303\u56f4",300,h))}break;case"weekly":isValid=g<=1750;if(!isValid){f.html(AJS.format("\u5929\u6570\u4e0d\u80fd\u8d85\u8fc7 {0} {1} \u7684\u65f6\u95f4\u8303\u56f4",1750,h))}break;case"monthly":isValid=g<=7500;if(!isValid){f.html(AJS.format("\u5929\u6570\u4e0d\u80fd\u8d85\u8fc7 {0} {1} \u7684\u65f6\u95f4\u8303\u56f4",7500,h))}break;case"quarterly":isValid=g<=22500;if(!isValid){f.html(AJS.format("\u5929\u6570\u4e0d\u80fd\u8d85\u8fc7 {0} {1} \u7684\u65f6\u95f4\u8303\u56f4",22500,h))}break;case"yearly":isValid=g<=36500;if(!isValid){f.html(AJS.format("\u5929\u6570\u4e0d\u80fd\u8d85\u8fc7 {0} {1} \u7684\u65f6\u95f4\u8303\u56f4",36500,h))}break;default:isValid=false}if(isValid){f.empty()}return isValid};this.title="\u521b\u5efaVS\u89e3\u51b3";this.chartType=d;this.containerId="#jira-chart-content-createdvsresolved";this.clickableElements=".jira-chart-search button, .jira-chart-show-border, .jira-chart-show-infor, #created-vs-resolved-chart-cumulative, #created-vs-resolved-chart-showunresolvedtrend";this.onChangeElements="#created-vs-resolved-chart-periodName, #created-vs-resolved-chart-daysprevious, #created-vs-resolved-chart-versionLabel, #jira-chart-width";this.isFormValid=function(){var f=AJS.Editor.JiraChart.Helper.isChartWidthValid(c.chartElements.width);return b()&&f&&AJS.Editor.JiraChart.Helper.isJqlNotEmpty(c.chartElements.jql)};this.isResultValid=function(){return this.container.find("#chart-preview-iframe").contents().find(".jira-chart-macro-wrapper").length};this.init=function(f){AJS.Editor.JiraChart.Panel.prototype.init.call(this,f);a()};this.bindingChartElements=function(){this.chartElements=AJS.Editor.JiraChart.Helper.bindingCommonChartElements(this.container);this.chartElements.periodName=this.container.find("#created-vs-resolved-chart-periodName");this.chartElements.daysprevious=this.container.find("#created-vs-resolved-chart-daysprevious");this.chartElements.isCumulative=this.container.find("#created-vs-resolved-chart-cumulative");this.chartElements.showUnresolvedTrend=this.container.find("#created-vs-resolved-chart-showunresolvedtrend");this.chartElements.versionLabel=this.container.find("#created-vs-resolved-chart-versionLabel")};this.bindingActions=function(){AJS.Editor.JiraChart.Panel.prototype.bindingActions.call(this);this.container.find(".widthInfo").tooltip({gravity:"w"});this.container.find(".showunresolvedtrendInfo").tooltip({gravity:"w"});this.container.find(".cumulativeInfo").tooltip({gravity:"w"});this.container.find(".versionLabelInfo").tooltip({gravity:"w"});this.container.find(".daysPreviousInfo").tooltip({gravity:"w"})};this.getChartParamsRequest=function(){var g=this.getMacroParamsFromDialog();var f=AJS.Editor.JiraChart.Helper.getCommonChartParamsRequest(g,this.chartType);f.macro.params.periodName=g.periodName;f.macro.params.daysprevious=g.daysprevious;f.macro.params.isCumulative=g.isCumulative;f.macro.params.showUnresolvedTrend=g.showUnresolvedTrend;f.macro.params.versionLabel=g.versionLabel;return f};this.getMacroParamsFromDialog=function(){var f=AJS.Editor.JiraChart.Helper.getCommonMacroParamsFromDialog(this.chartElements,this.container);f.chartType=d;f.periodName=this.chartElements.periodName.val();f.daysprevious=e.trim(this.chartElements.daysprevious.val());f.isCumulative=this.chartElements.isCumulative.prop("checked");f.showUnresolvedTrend=this.chartElements.showUnresolvedTrend.prop("checked");f.versionLabel=this.chartElements.versionLabel.val();return f};this.resetDialogValue=function(){AJS.Editor.JiraChart.Panel.prototype.resetDialogValue.call(this);a()};this.bindingDataFromMacroToForm=function(f){if(f){AJS.Editor.JiraChart.Helper.bindingCommonDataFromMacroToForm(c.chartElements,f);c.chartElements.isCumulative.attr("checked",(f.isCumulative!=="false"));c.chartElements.showUnresolvedTrend.attr("checked",(f.showUnresolvedTrend==="true"));c.chartElements.periodName.val(f.periodName===""?"daily":f.periodName);c.chartElements.versionLabel.val(f.versionLabel);c.chartElements.daysprevious.val(f.daysprevious===""?"30":f.daysprevious)}}};AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart.prototype=AJS.Editor.JiraChart.Panel.prototype;AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart.prototype.constructor=AJS.Editor.JiraChart.Panels.CreatedVsResolvedChart;AJS.Editor.JiraChart.Panels.push(new AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart(AJS.$));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/twodimensionalchart-panel.js' */
AJS.Editor.JiraChart.Panel.TwoDimensionalChart=function(d){AJS.Editor.JiraChart.Panel.call(this);var c="twodimensional";var f=5;var b=this;var e=function(){var h=d(".twodimensional-number-of-result-error");var g=b.chartElements.numberToShow.val();if(AJS.Editor.JiraChart.Helper.isNumber(g)&&g>0){h.empty();return true}h.html("\u884c\u6570\u5e94\u8be5\u662f\u4e00\u4e2a\u6b63\u6574\u6570");return false};var a=function(){b.chartElements.numberToShow.val(f);b.chartElements.xstattype.val("statuses");b.chartElements.ystattype.val("assignees")};this.title="\u4e8c\u7ef4";this.chartType=c;this.containerId="#jira-chart-content-twodimensional";this.clickableElements=".jira-chart-search button, .jira-chart-show-border, .jira-chart-show-infor, #twodimensional-show-total";this.onChangeElements="#twodimensional-xaxis, #twodimensional-yaxis, #twodimensional-number-of-result";this.isFormValid=function(){var g=e();return g&&AJS.Editor.JiraChart.Helper.isJqlNotEmpty(b.chartElements.jql)};this.isResultValid=function(){return this.container.find("#chart-preview-iframe").contents().find(".two-dimensional-chart-table").length};this.init=function(g){AJS.Editor.JiraChart.Panel.prototype.init.call(this,g);a()};this.bindingChartElements=function(){this.chartElements=AJS.Editor.JiraChart.Helper.bindingCommonChartElements(this.container);this.chartElements.xstattype=this.container.find("#twodimensional-xaxis");this.chartElements.ystattype=this.container.find("#twodimensional-yaxis");this.chartElements.sortBy=this.container.find("#twodimensional-sortby");this.chartElements.sortDirection=this.container.find("#twodimensional-sort-direction");this.chartElements.showTotals=this.container.find("#twodimensional-show-total");this.chartElements.numberToShow=this.container.find("#twodimensional-number-of-result")};this.getChartParamsRequest=function(){var h=this.getMacroParamsFromDialog();var g=AJS.Editor.JiraChart.Helper.getCommonChartParamsRequest(h,this.chartType);g.macro.params.xstattype=h.xstattype;g.macro.params.ystattype=h.ystattype;g.macro.params.sortBy=h.sortBy;g.macro.params.sortDirection=h.sortDirection;g.macro.params.showTotals=h.showTotals;g.macro.params.numberToShow=h.numberToShow;return g};this.getMacroParamsFromDialog=function(){var g=AJS.Editor.JiraChart.Helper.getCommonMacroParamsFromDialog(this.chartElements,this.container);g.chartType=c;g.xstattype=this.chartElements.xstattype.val();g.ystattype=d.trim(this.chartElements.ystattype.val());g.sortBy=d.trim(this.chartElements.sortBy.val());g.sortDirection=d.trim(this.chartElements.sortDirection.val());g.showTotals=this.chartElements.showTotals.prop("checked");g.numberToShow=this.chartElements.numberToShow.val();return g};this.bindingDataFromMacroToForm=function(g){if(g){AJS.Editor.JiraChart.Helper.bindingCommonDataFromMacroToForm(b.chartElements,g);b.chartElements.xstattype.val(g.xstattype);b.chartElements.ystattype.val(g.ystattype);b.chartElements.sortBy.val(g.sortBy);b.chartElements.sortDirection.val(g.sortDirection);b.chartElements.showTotals.attr("checked",g.showTotals==="true");b.chartElements.numberToShow.val(g.numberToShow)}};this.resetDialogValue=function(){AJS.Editor.JiraChart.Panel.prototype.resetDialogValue.call(this);a()};this.isImageChartExisted=function(){return this.container.find("#chart-preview-iframe").contents().find(".two-dimensional-chart-table").length>0};this.preBinding=function(){AJS.Editor.JiraChart.Helper.populateStatType(this.container,this.container.find("#twodimensional-xaxis"));AJS.Editor.JiraChart.Helper.populateStatType(this.container,this.container.find("#twodimensional-yaxis"));b.chartElements.xstattype.val("statuses");b.chartElements.ystattype.val("assignees")};this.bindingServerChange=function(){b.chartElements.server.change(function(){AJS.Editor.JiraChart.Helper.populateStatType(b.container,b.chartElements.xstattype);AJS.Editor.JiraChart.Helper.populateStatType(b.container,b.chartElements.ystattype);b.chartElements.xstattype.val("statuses");b.chartElements.ystattype.val("assignees");if(b.isFormValid()){AJS.Editor.JiraChart.search(b.container)}else{AJS.Editor.JiraChart.disableInsert()}})}};AJS.Editor.JiraChart.Panel.TwoDimensionalChart.prototype=AJS.Editor.JiraChart.Panel.prototype;AJS.Editor.JiraChart.Panel.TwoDimensionalChart.prototype.constructor=AJS.Editor.JiraChart.Panel.TwoDimensionalChart;AJS.Editor.JiraChart.Panels.push(new AJS.Editor.JiraChart.Panel.TwoDimensionalChart(AJS.$));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:editor-support-util', location = 'support/atlassian-editor-support.js' */
define("confluence-editor/support/atlassian-editor-support",["ajs","confluence/meta"],function(c,b){return{inlineTasks:function(){var a=b.get("use-inline-tasks");return"true"===a||!0===a},isCollaborativeContentType:function(){var a=b.get("content-type");return b.get("collaborative-content")&&("page"===a||"blogpost"===a)}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/support/atlassian-editor-support","AJS.Rte.Support");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-quit-dialog', location = 'editor/page-editor-quit-dialog.js' */
define("confluence-editor/editor/page-editor-quit-dialog","jquery confluence/templates ajs confluence/meta confluence/legacy window document confluence-editor/editor/page-editor-message confluence/api/constants underscore".split(" "),function(e,n,c,d,f,B,M,o,C,D){function E(b){b.stopPropagation();b.preventDefault();c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.show-diff-clicked"});a.showDiffButton.hide();s();a.hideDiffButton.show()}function t(b){b.stopPropagation();b.preventDefault();
c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.hide-diff-clicked"});a.hideDiffButton.hide();a.showDiffButton.show();a.dialogEl.removeClass("aui-dialog2-xlarge").addClass("aui-dialog2-medium");k(h)}function F(b){if(l!==true){h=i?g.REVERT:g.DELETE;p();c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard"});b.stopPropagation();b.preventDefault();f.Editor.UI.setButtonsState(false,a.buttonsAll);u(d.get("content-id"))}}function v(){f.Editor.Drafts.unBindUnloadMessage();
a.editorForm.append(n.Editor.Page.hiddenInputCancel()).submit()}function w(a){if(a&&a.stopPropagation){a.stopPropagation();a.preventDefault()}c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.keep-draft-clicked",data:{contributorCount:m.length+1}});v()}function G(b){f.Editor.UI.setButtonsState(false,a.buttonsAll);j.save(b);p()}function x(b){b.stopPropagation();b.preventDefault();h=null;c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.draft-status-indicator.click"});
y(function(){a.closeButton.show();s()})}function H(b){b.stopPropagation();b.preventDefault();if(l!==true){a.closeButton.show();d.get("new-page")?k(g.DELETE):k(g.REVERT)}}function I(b){b.stopPropagation();b.preventDefault();a.dialog.hide()}function s(){a.dialogEl.removeClass("aui-dialog2-medium").addClass("aui-dialog2-xlarge");k(g.SHOW_DIFF);e.ajax({url:C.CONTEXT_PATH+"/rest/tinymce/1/content/"+d.get("page-id")+"/draft/diff",type:"GET"}).success(function(b){a.dialogContent.find(".wiki-content").html(b).children().first().hasClass("diff-context-placeholder")&&
a.dialogContent.find("hr").hide()})}function k(b){function c(){return b===g.SHOW_DIFF&&(h===g.REVERT||h===g.DELETE)}if(b===g.UPDATE||b===g.PUBLISH)q=(new Date).getTime()/1E3;var f=b;c()&&(f=h);a.dialogHeader.html(n.Editor.Page.quitDialogHeader({dialogType:f,contentType:d.get("content-type"),newPage:d.get("new-page")}));a.dialogContent.html(n.Editor.Page.quitDialogContent({dialogType:b,contributors:m,contentType:d.get("content-type"),newDialog:h==null}));a.hideDiffButton=e("#qed-hide-diff-button").click(t);
if(!d.get("new-page")){b!==g.SHOW_DIFF&&(h=b);a.showDiffButton=e("#qed-show-diff-button").click(E);a.showDiffButton.show();a.buttonsAll.push(a.showDiffButton)}if(b===g.DELETE||b===g.REVERT||c()){a.discardButton.show();a.dialogEl.addClass("aui-dialog2-warning")}else a.dialogEl.removeClass("aui-dialog2-warning");a.closeButton.show();a.dialogFooter.find("."+b).show();a.dialog.show()}function J(){p();c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.dialog-closed"});a.dialogEl.removeClass("aui-dialog2-xlarge").addClass("aui-dialog2-medium");
f.Editor.UI.toggleSavebarBusy(false);a.dialogFooter.find(".aui-button").hide();a.dialogContent.empty()}function p(){var a=(new Date).getTime()/1E3-q;c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog."+h+".displayed",data:{displayTimeInSeconds:a,contentId:d.get("content-id")}});q=0}function u(b,g){var d=c.contextPath(),d=i?d+"/rest/synchrony/1.0/content/"+b+"/changes/unpublished":d+"/rest/api/content/"+b+"?status=draft";i&&o.suppressMessage("editor.synchrony.revert-page");g=
g||0;e.ajax({url:d,type:"DELETE",data:{draftId:b},contentType:"application/json",dataType:"json"}).done(function(){i&&o.handleMessage("collaborative-editor-discard-error",{type:"success",close:"auto",message:"\u6210\u529f\u6062\u590d\u5230\u4e0a\u6b21\u53d1\u5e03\u7684\u7248\u672c"});c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard-success",data:{contentId:b}});v()}).fail(function(d){if(d.status===409&&g<K){c.trigger("disable-draft-save");u(b,g+1)}else{var e=JSON.parse(d.responseText),
h="\u5220\u9664\u8349\u7a3f\u65f6\u53d1\u751f\u9519\u8bef\u3002",d=d.errors||"\u53d1\u751f\u672a\u77e5\u9519\u8bef. \u8bf7\u68c0\u67e5\u65e5\u5fd7.";if(e.data&&e.data.errors&&e.data.errors[0]&&e.data.errors[0].message.key==="content.delete.published"){h="\u6b64\u9875\u9762\u5df2\u53d1\u5e03\u3002";d="\u7531\u4e8e\u8fd9\u5df2\u4e0d\u518d\u662f\u8349\u7a3f\uff0c\u6240\u4ee5\u60a8\u65e0\u6cd5\u820d\u5f03\u3002"}c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard-error",data:{contentId:b}});c.trigger("enable-draft-save");o.handleMessage("collaborative-editor-discard-error",
{type:"error",title:i?"\u4e0d\u80fd\u6062\u590d\u5230\u4e0a\u6b21\u53d1\u5e03\u7684\u7248\u672c":h,message:i?"\u6b64\u523b\u6211\u4eec\u4e0d\u80fd\u83b7\u5f97\u8fd9\u4e2a\u9875\u9762\u6700\u540e\u53d1\u5e03\u7684\u7248\u672c\u3002\u51e0\u5206\u949f\u540e\u518d\u5c1d\u8bd5\u4e22\u5f03\u8349\u7a3f\u3002":d});a.dialog.hide();f.Editor.UI.setButtonsState(true,a.buttonsAll)}})}function L(a,c){c&&c.contributors&&(m=D.reject(c.contributors,function(a){return a.name===d.get("remote-user")}))}function y(a){f.Editor.Drafts.save({forceSave:i,skipErrorHandler:true,onSuccessHandler:a||e.noop})}var a={},i,z,g={DELETE:"delete",REVERT:"revert",PUBLISH:"publish",
UPDATE:"update",SHOW_DIFF:"diff"},m=[],r=false,j={},h,q=0,K=5,l=false,A=false;return{init:function(b){if(z=d.getBoolean("shared-drafts")&&(d.get("content-type")==="page"||d.get("content-type")==="blogpost"))if(r){j.save=b&&b.saveHandler;j.cancelErrorHandler=b&&b.cancelErrorHandler;a.publishButton.click(G)}else{i=!d.get("new-page");a.discardButton=e("#qed-discard-button").tooltip({gravity:"s",className:"quit-editor-dialog"});if(f.Editor.isLimitedModeEnabled()&&i){f.Editor.UI.setButtonState(false,a.discardButton);
a.discardButton.removeAttr("disabled")}else a.discardButton.click(F);a.saveExitButton=e("#qed-save-exit-button").click(w);a.hideDiffButton=e("#qed-hide-diff-button").click(t);a.publishButton=e("#qed-publish-button");a.closeButton=e("#qed-close-button").click(I);a.buttonsAll=[a.discardButton,a.saveExitButton,a.showDiffButton,a.hideDiffButton,a.publishButton];a.dialog=c.dialog2("#quit-editor-dialog");a.dialogEl=a.dialog.$el;a.dialogHeader=a.dialogEl.find(".aui-dialog2-header");a.dialogContent=a.dialogEl.find(".aui-dialog2-content");
a.dialogFooter=a.dialogEl.find(".aui-dialog2-footer");a.editorForm=e("#wysiwyg").closest("form");e("#rte-show-changes").on("click",x);e("#rte-show-revert").on("click",H);if(!d.get("new-page"))e("#pluggable-status").on("click","a",x);a.dialog.on("hide",J);c.bind("editor-heartbeat",L);c.bind("synchrony.history.evicted",function(){l=true;e("#qed-discard-button").attr("disabled","disabled")});c.bind("synchrony.connected",function(){A=true});r=true}},process:function(a){if(z){a.stopPropagation();a.preventDefault();
e(B).one("editor-heartbeat rte.heartbeat-error",function(c){e(this).off("editor-heartbeat rte.heartbeat-error");switch(a.target.id){case f.Editor.UI.saveButton.attr("id"):case f.Editor.UI.versionCommentInput.attr("id"):f.Editor.UI.toggleSavebarBusy(true);if(m.length===0)j.save();else{y();k(i?g.UPDATE:g.PUBLISH)}break;case f.Editor.UI.cancelButton.attr("id"):f.Editor.Drafts.save({forceSave:true,skipErrorHandler:false,onSuccessHandler:w,ignoreRelations:!(f.Editor.hasContentChanged()&&A)});var d=f.Editor.Drafts.getDraftSavingPromise();
d&&d.fail(function(a){j.cancelErrorHandler&&j.cancelErrorHandler(a)});(!c.namespace||c.namespace!=="heartbeat-error")&&f.Editor.UI.toggleSavebarBusy(true)}});f.Editor.heartbeat()}},_destroy:function(){l=r=false}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/util/is-valid-uri.js' */
define("confluence-collaborative-editor-plugin/util/is-valid-uri",[],function(){var g="\\s\xA0\u1680\u2000-\u200A\u202F\u205F\u3000";var b="\\$\\+<->\\^`\\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20BE\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u23FE\u2400-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B98-\u2BB9\u2BBD-\u2BC8\u2BCA-\u2BD1\u2BEC-\u2BEF\u2CE5-\u2CEA\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u32FE\u3300-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uFB29\uFBB2-\uFBC1\uFDFC\uFDFD\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD";var e="!-#%-\\*,-/:;\\?@\\[-\\]_\\{\\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E44\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65";var i="A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC";var f="0-9\xB2\xB3\xB9\xBC-\xBE\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u09F4-\u09F9\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0B72-\u0B77\u0BE6-\u0BF2\u0C66-\u0C6F\u0C78-\u0C7E\u0CE6-\u0CEF\u0D58-\u0D5E\u0D66-\u0D78\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F33\u1040-\u1049\u1090-\u1099\u1369-\u137C\u16EE-\u16F0\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1946-\u194F\u19D0-\u19DA\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\u2070\u2074-\u2079\u2080-\u2089\u2150-\u2182\u2185-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2CFD\u3007\u3021-\u3029\u3038-\u303A\u3192-\u3195\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\uA620-\uA629\uA6E6-\uA6EF\uA830-\uA835\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19";var h=new RegExp("^(((?![':\"<>])["+g+b+e+i+f+"])+|\\#(\\w)+)$");var d=new RegExp("^(?:\\s*(?:([a-zA-Z]*):\\/\\/|mailto:|skype:|callto:|facetime:|git:|irc:|irc6:|news:|nntp:|feed:|cvs:|svn:|mvn:|ssh:|itms:|notes:|smb:|sourcetree:|urn:|tel:|xmpp:|telnet:|vnc:|rdp:|whatsapp:|slack:|sip:|sips:|magnet:)["+i+f+"\\/]+(?:(?!['\"<>])["+g+b+e+i+f+"])*(?:\\s)*)$");function c(j,k){var l=j.lastIndexOf(k);return l!==-1&&l===j.length-k.length}return function a(j){if(j===null){return false}var m=h.test(j);var n=j.match(d);var l=n&&n.length&&n[1];var k=n&&n.length&&(!l||(!c(l,"script")&&!c(l,"data")));return m||k}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/template/synchrony-presence.soy' */
// This file was automatically generated from synchrony-presence.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.SynchronyPresence.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.SynchronyPresence == 'undefined') { Confluence.Templates.SynchronyPresence = {}; }


Confluence.Templates.SynchronyPresence.container = function(opt_data, opt_ignored) {
  return '<ul id="avatar-list" class="synchrony-doc-' + soy.$$escapeHtml(opt_data.docId) + ' collaborative-avatars-list"></ul><aui-inline-dialog id="more-avatars" alignment="bottom right" responds-to="toggle" aria-hidden="true"><h3>' + soy.$$escapeHtml('\u4e5f\u662f\u7f16\u8f91\u8fc7\u7684') + '</h3><ul id="more-avatars-list" class="collaborative-avatars-list"></ul></aui-inline-dialog>';
};
if (goog.DEBUG) {
  Confluence.Templates.SynchronyPresence.container.soyTemplateName = 'Confluence.Templates.SynchronyPresence.container';
}


Confluence.Templates.SynchronyPresence.avatar = function(opt_data, opt_ignored) {
  return '<li class="avatar-item' + ((opt_data.active) ? ' p' + soy.$$escapeHtml(opt_data.telepointer) + ' active' : '') + ((opt_data.currentUser) ? ' no-animate-entry' : '') + '"><span title="' + soy.$$escapeHtml(opt_data.title) + '" avatar="' + soy.$$escapeHtml(opt_data.initial) + '"' + ((opt_data.active) ? ' data-origin="' + soy.$$escapeHtml(opt_data.origin) + '"' : '') + ' class="avatar' + ((opt_data.active) ? ' active' : '') + '"' + ((opt_data.username) ? ' data-username="' + soy.$$escapeHtml(opt_data.username) + '"' : '') + '><img src="' + soy.$$escapeHtml(opt_data.avatarUrl) + '"></span></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.SynchronyPresence.avatar.soyTemplateName = 'Confluence.Templates.SynchronyPresence.avatar';
}


Confluence.Templates.SynchronyPresence.overlay = function(opt_data, opt_ignored) {
  return '<span id="synchrony-presence-overlay" class="overlay avatar"><a href="#" aria-controls="more-avatars" class="aui-button" data-aui-trigger></a></span>';
};
if (goog.DEBUG) {
  Confluence.Templates.SynchronyPresence.overlay.soyTemplateName = 'Confluence.Templates.SynchronyPresence.overlay';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/synchrony-presence.js' */
define("confluence-collaborative-editor-plugin/synchrony-presence",["backbone","confluence-collaborative-editor-plugin/avatar-list-view","confluence-collaborative-editor-plugin/overlay-view","ajs","confluence/legacy","confluence/meta","confluence/templates","jquery","underscore"],function(b,c,x,l,n,r,g,f,v){var h=new b.Collection();h.add(s({origin:"current-user",fullname:r.get("current-user-fullname"),name:r.get("remote-user"),avatarURL:r.get("current-user-avatar-url"),active:true,currentUser:true}));var i=false;var q="";var d;var w=[];var e=null;var j;var m=false;if(l.Rte.getEditor()&&l.Rte.getEditor().initialized){k()}else{l.bind("rte-collab-ready",k)}function k(){e=f(g.SynchronyPresence.container({docId:n.getContentId()}));f("#rte-toolbar").append(e);new c({el:"#avatar-list",collection:h});j=new x({collection:h});f("#rte-toolbar").append(j.render())}function a(y){d=y}function s(z){var y=f.extend({},z);y.id=z.origin;y.fullname=z.fullname||"\u533f\u540d\u7528\u6237";y.name=z.name||"anonymous";y.username=z.name;y.avatarURL=l.contextPath()+z.avatarURL;y.active=z.active||true;y.currentUser=z.currentUser||q===z.origin;return y}function o(y,z,A){q=y;if(!i){d=d||require("tinymce");i=true;w=A;z.on("presence",function(B){j.hideInlineDialog();B.joined.filter(function(C){return C.origin!==q}).forEach(function(C){var D=s(C);p(D);h.add(D,{at:u()})});B.left.forEach(function(C){C.id=C.origin;h.remove(C);t()});t();if(!m){l.bind("editor-heartbeat",function(D,C){if(v.isArray(C.contributors)){w=C.contributors;t()}});m=true}l.trigger("analyticsEvent",{name:"confluence.synchrony.user.in.session",data:{numOtherUsers:h.length,draftId:r.get("draft-id"),contentId:r.get("content-id")}})});d.EditorManager.activeEditor.onClick.add(v.bind(x.prototype.hideInlineDialog,j))}return e}function u(){return h.filter(function(y){return y.get("active")}).length}function p(y){var z=h.findWhere({active:false,id:y.name});if(z){h.remove(z)}}function t(){var y=[];h.each(function(z){if(!(z.get("active")||v.some(w,function(A){return z.get("id")===A.name}))){y.push(z)}});v.each(y,function(z){h.remove(z)});v.each(w,function(z){if(!(z.name===r.get("remote-user")||h.any(function(A){return A.get("id")===z.name||A.get("name")===z.name}))){z.active=false;z.id=z.name;h.add(z)}})}return{appendTo:o,setTinyMce:a}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/avatar-list-view.js' */
define("confluence-collaborative-editor-plugin/avatar-list-view",["backbone","confluence-collaborative-editor-plugin/avatar-view","ajs","jquery","underscore"],function(f,c,a,e,b){var d=5;return f.View.extend({initialize:function(){this.collection.on("add",this.addAvatar,this);this.collection.on("remove",this.removeAvatar,this);this.collection.each(this.addAvatar,this)},addAvatar:function(h){var k=new c({model:h});var g;if(h.get("active")){a.log(h.get("fullname")+" joined. ("+h.get("origin")+")");var j=this.$el.find("li.active").last();if(j.length){g=k.render().insertAfter(j)}else{g=k.render().prependTo(this.$el)}}else{g=k.render().appendTo(this.$el)}var i=function(l){l.addClass("show");l.children(".avatar").tooltip({fade:true,gravity:"ne"})};if(this.collection.length===d+1){i(g)}else{b.defer(i,g)}this._manageOverlayClass()},removeAvatar:function(g){if(g.get("active")){a.log(g.get("fullname")+" left. ("+g.get("origin")+")")}this._manageOverlayClass()},_manageOverlayClass:function(){var g=this.collection.length;this.collection.each(function(i,h){i.set("hidden",g>d&&h>=d-1)});if(g>d){this.$el.addClass("has-overlay")}else{this.$el.removeClass("has-overlay")}}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/avatar-view.js' */
define("confluence-collaborative-editor-plugin/avatar-view",["backbone","ajs","confluence/templates","jquery"],function(d,a,b,c){return d.View.extend({initialize:function(){this.model.on("remove",this.remove,this)},render:function(){this.$el=c(b.SynchronyPresence.avatar({title:this._determineTitle(),initial:this.model.get("fullname").charAt(0).toUpperCase(),fullname:this.model.get("fullname"),username:this.model.get("username"),avatarUrl:this.model.get("avatarURL"),origin:this.model.get("origin"),active:this.model.get("active"),currentUser:this.model.get("currentUser"),telepointer:this._synchronyTelepointerId()}));return this.$el},remove:function(){this.$el.removeClass().addClass("avatar-item animate");if(!this.model.get("hidden")){this.$el.addClass("removing")}this.$el.one(this._getSupportedTransition(),function(){c(this).removeClass("animate removing");c(this).remove()})},_determineTitle:function(){if(this.model.get("currentUser")){var e=["\u5c31\u662f\u4f60\uff0c\u4f46\u66f4\u5c0f\uff01","\u770b\u770b\u4f60\uff0c\u628a\u4e8b\u60c5\u5b8c\u6210\uff01"];return e[Math.floor(Math.random()*e.length)]}return this.model.get("fullname")+" "+(this.model.get("active")?"\u6b63\u5728\u7f16\u8f91\u6b64\u9875\u3002":"\u6709\u672a\u53d1\u5e03\u7684\u4fee\u6539\u3002")},_getSupportedTransition:function(){var g={transition:"transitionend",MozTransition:"transitionend",OTransition:"oTransitionEnd",MsTransition:"msTransitionEnd",WebkitTransition:"webkitTransitionEnd"};var e=document.createElement("_");for(var f in g){if(e.style[f]!==undefined){return g[f]}}},_synchronyTelepointerId:function(){var g=""+(this.model.get("sub")||this.model.get("origin")||"");var f=0;for(var e=0;e<g.length;e++){f=((f<<5)-f)+g.charCodeAt(e);f=f&f}return(Math.abs(f)%10)}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/overlay-view.js' */
define("confluence-collaborative-editor-plugin/overlay-view",["backbone","aui/inline-dialog2","confluence-collaborative-editor-plugin/avatar-view","confluence/templates","ajs","jquery","underscore"],function(g,d,c,e,a,f,b){return g.View.extend({initialize:function(){this.collection.on("add remove",this.reconcile,this);this.inlineDialog2=document.querySelector("#more-avatars")},render:function(){this.$el=f(e.SynchronyPresence.overlay());this.$el.children("a").tooltip({fade:true,gravity:"ne"});this.$el.on("click",function(){f(".tipsy").remove()});return this.$el},reconcile:function(){var h=this.collection.where({hidden:true});if(h.length>0){this.$el.addClass("show");this.$el.children(".aui-button").html("+"+h.length).attr("title",h.length+" "+"\u5176\u4ed6\u7528\u6237\u6b63\u5728\u7f16\u8f91");f("#more-avatars-list").children().remove();h.forEach(function(i){var j=new c({model:i});f("#more-avatars-list").append(j.render())})}else{this.$el.removeClass("show");this.hideInlineDialog()}},hideInlineDialog:function(){if(this.inlineDialog2&&this.inlineDialog2.isVisible&&this.inlineDialog2.isVisible()){this.inlineDialog2.open=false}}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/template/status-indicator.soy' */
// This file was automatically generated from status-indicator.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.CollaborativeEditor.StatusIndicator.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.CollaborativeEditor == 'undefined') { Confluence.Templates.CollaborativeEditor = {}; }
if (typeof Confluence.Templates.CollaborativeEditor.StatusIndicator == 'undefined') { Confluence.Templates.CollaborativeEditor.StatusIndicator = {}; }


Confluence.Templates.CollaborativeEditor.StatusIndicator.container = function(opt_data, opt_ignored) {
  return '<div class="synchrony-status-indicator"><div class="status-indicator-icon aui-icon aui-icon-small' + ((opt_data.error) ? ' aui-iconfont-warning' : (opt_data.saving) ? ' aui-iconfont-devtools-task-in-progress' : ' aui-iconfont-approve') + '" data-tooltip="' + soy.$$escapeHtml(opt_data.tooltipMessage) + '"></div><div class="status-indicator-message" data-tooltip="' + soy.$$escapeHtml(opt_data.tooltipMessage) + '">' + soy.$$escapeHtml(opt_data.statusMessage) + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.CollaborativeEditor.StatusIndicator.container.soyTemplateName = 'Confluence.Templates.CollaborativeEditor.StatusIndicator.container';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/status-indicator-view.js' */
define("confluence-collaborative-editor-plugin/status-indicator-view",["confluence/templates","backbone","ajs","jquery","underscore"],function(c,e,a,d,b){return e.View.extend({initialize:function(){this.$el.addClass("synchrony");this.listenTo(this.model,"change:saving change:error",this.render);this.model.set("confluenceUnreachable",false);this.model.set("synchronyUnreachable",false);this.model.set("tokenExpired",false);a.bind("rte.heartbeat",b.bind(this.onConfluenceConnectedState,this));a.bind("rte.safe-save.error",b.bind(this._errorPublishing,this));a.bind("rte.preview.error",b.bind(this._errorPublishing,this));this.model.set("connecting",true);this._setProgressState()},render:function(){d(".tipsy").remove();this.$el.html(c.CollaborativeEditor.StatusIndicator.container(this.model.attributes))},onConnectedState:function(g){this.model.set("synchronyUnreachable",false);if(!this.model.has("synchronyEntity")){this.model.set("synchronyEntity",g);var f=this;this.model.get("synchronyEntity").on("update",function(h){f._handleSynchronyUpdateEvent(h,f)});this.model.get("synchronyEntity").on("ack",function(h){f._handleSynchronyAckEvent(h,f)})}this._setSavedState()},onDisconnectedState:function(){this.model.set("synchronyUnreachable",true);this.model.set("connecting",true);this._setErrorState()},onConfluenceConnectedState:function(){if(this.model.get("confluenceUnreachable")){this.model.set("confluenceUnreachable",false);this._setSavedState()}},onConfluenceDisconnectedState:function(){this.model.set("confluenceUnreachable",true);this.model.set("connecting",true);this._setErrorState()},onTokenRenewedState:function(){if(this.model.get("tokenExpired")){this.model.set("tokenExpired",false);this._setSavedState()}},onTokenExpiredState:function(){this.model.set("tokenExpired",true);this.model.set("connecting",true);this._setErrorState()},_handleSynchronyUpdateEvent:function(g,f){if(g.updateType==="local"){f.model.set("pendingChanges",true);f._saving()}},_handleSynchronyAckEvent:function(h,g){var f=h.pending.length>0;g.model.set("pendingChanges",f);if(!f){g.model.set("lastSavedTime",new Date().getTime())}},_saving:function(){var f=this;var g=function(){setTimeout(function(){if(f.model.get("pendingChanges")||new Date().getTime()-f.model.get("lastSavedTime")<f.model.get("minActiveTime")){g()}else{f._setSavedState()}},f.model.get("minActiveTime"))};if(this.model.get("saving")){return}this.model.set("connecting",false);this._setProgressState();g()},_reachable:function(){return !this.model.get("confluenceUnreachable")&&!this.model.get("synchronyUnreachable")&&!this.model.get("tokenExpired")},_errorPublishing:function(g,f){switch(f.status){case 0:this.onConfluenceDisconnectedState();break;case 500:case 503:this.onConfluenceDisconnectedState();break;case 400:case 403:case 404:case 409:case 410:case 413:default:break}},_setSavedState:function(){if(this._reachable()&&a.Meta.get("access-mode")!=="READ_ONLY"){this.model.set("statusMessage",this.model.get("connecting")?"\u5373\u5c06\u5f00\u59cb~":"\u66f4\u6539\u5df2\u4fdd\u5b58");this.model.set("isReadyToGo",!!this.model.get("connecting"));this.model.set("tooltipMessage","\u81ea\u52a8\u4fdd\u5b58\u6240\u6709\u4fee\u6539\u5230\u8349\u7a3f\u4e2d");this.model.set("connecting",false);this.model.set("saving",false);this.model.set("error",false)}else{this._setErrorState()}},_setErrorState:function(){var f=a.Meta.get("access-mode")!=="READ_ONLY";this.model.set("statusMessage","\u4e0d\u80fd\u4fdd\u5b58\u53d8\u66f4");this.model.set("tooltipMessage",f?"\u65e0\u6cd5\u8fde\u63a5\u5230\u670d\u52a1\u5668\uff0c\u8bf7\u68c0\u67e5\u4f60\u7684\u82f1\u7279\u7f51\u8fde\u63a5\uff0c\u6211\u4eec\u5c06\u6301\u7eed\u5c1d\u8bd5\u8ddf\u60a8\u91cd\u65b0\u5efa\u7acb\u8fde\u63a5\u3002":"\u8fd9\u662f\u53ea\u8bfb\u7f51\u7ad9\u3002 \u60a8\u73b0\u5728\u65e0\u6cd5\u8fdb\u884c\u66f4\u6539\u3002");this.model.set("saving",false);this.model.set("error",true)},_setProgressState:function(){if(this._reachable()){this.model.set("statusMessage",this.model.get("connecting")?"\u8fde\u63a5\u4e2d...":"\u6b63\u5728\u4fdd\u5b58\u4fee\u6539");this.model.set("tooltipMessage","\u81ea\u52a8\u4fdd\u5b58\u6240\u6709\u4fee\u6539\u5230\u8349\u7a3f\u4e2d");this.model.set("saving",true);this.model.set("error",false)}else{this._setErrorState()}}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/initialise-metrics.js' */
define("collaborative-editing-initialise-metrics-collection",["confluence/legacy"],function(b){var a=function(){var c="confluence.editor.quickedit.loading.times";var d={"confluence.editor":true,"confluence.editor.preload":true,"confluence.editor.quick.fetchContent":true,"confluence.editor.tinymce":true,"confluence.editor.synchrony":true,"confluence.editor.synchrony.CR":true,"confluence.editor.synchrony.connect":true,"confluence.editor.synchrony.deps":true,"confluence.editor.synchrony.init":true,"confluence.editor.synchrony.jsLoad":true,"confluence.editor.synchrony.snapshot":true,"confluence.editor.synchrony.unmarshal":true};var e={"confluence.editor.synchrony.connect":true,};if(b.registerPerformanceSession){b.registerPerformanceSession(c,d,e)}};return a});require("confluence/module-exporter").safeRequire("collaborative-editing-initialise-metrics-collection",function(a){a()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/lib/SyncManager.js' */
define("confluence-collaborative-editor-plugin/lib/SyncManager",["ajs","jquery"],function(f,d){var b="synchrony.";var h=["id"];var a={START_SYNCHRONIZING_EVENT_NAME:"start",STOP_SYNCHRONIZING_EVENT_NAME:"stop",MAX_CONSECUTIVE_AUTO_RECOVERY_TRIGGERED:10,MAX_WAIT_TIME_TO_RESTART:30000,DEBUG_MODE:false};var g={AUTO_RECOVERY_TIMER_TRIGGERED:"Auto recovery has been triggered",AUTO_RECOVERY_TIMER_TRIGGERED_TOO_MANY_TIMES:"Auto recovery has been triggered too many times for the same action",INVALID_EVENT_PAYLOAD:"Invalid payload, missing required params",START_ENTITY:"Starting entity synchronization",STOP_ENTITY:"Stoping entity synchronization"};var c=function(){return{DISABLED_SYNC_STATUS:false,RECOVERY_TIMER_RUNNING:false,CONSECUTIVE_AUTO_RECOVERY_TRIGGERED:0}};var i=function(j){return h.every(function(k){return typeof j[k]!=="undefined"})};var e=function(k,l){this.entity=k;this.settings=d.extend({},a,l||{});this.controlSyncState={};this.recoveryTimeoutTasks={};var j=function(m,o,n){if(!i(n)){this.displayLogMessage(g.INVALID_EVENT_PAYLOAD,o,n)}else{m(n)}};f.bind(b+this.settings.START_SYNCHRONIZING_EVENT_NAME,j.bind(this,this.enableSynchronization.bind(this)));f.bind(b+this.settings.STOP_SYNCHRONIZING_EVENT_NAME,j.bind(this,this.disableSynchronization.bind(this)))};e.prototype.getOrCreateControlSyncState=function(k){var j=this.controlSyncState[k]=this.controlSyncState[k]||c();return j};e.prototype.enableDebug=function(j){this.settings.DEBUG_MODE=typeof j!=="undefined"?j:true};e.prototype.displayLogMessage=function(){if(this.settings.DEBUG_MODE){var j=Array.prototype.slice.call(arguments);j.splice(0,0,"DEBUG: "+new Date().toLocaleTimeString());console.log.apply(console,j)}};e.prototype.disableSynchronization=function(k){var l=k.id;var j=this.getOrCreateControlSyncState(l);j.DISABLED_SYNC_STATUS=true;this.clearAutoRecoveryTimer(l);this.setAutoRecoveryTimer(k);this.entity.stop(l);this.displayLogMessage(g.STOP_ENTITY,l,d.extend(true,{},this.controlSyncState))};e.prototype.enableSynchronization=function(k){var l=k.id;var j=this.getOrCreateControlSyncState(l);j.DISABLED_SYNC_STATUS=false;this.clearAutoRecoveryTimer(l);this.entity.start(l);this.displayLogMessage(g.START_ENTITY,l,d.extend(true,{},this.controlSyncState))};e.prototype.clearAutoRecoveryTimer=function(k){var j=this.getOrCreateControlSyncState(k);clearTimeout(this.recoveryTimeoutTasks[k]);delete this.recoveryTimeoutTasks[k];j.RECOVERY_TIMER_RUNNING=false};e.prototype.setAutoRecoveryTimer=function(k){var l=k.id;var j=this.getOrCreateControlSyncState(l);j.RECOVERY_TIMER_RUNNING=true;this.recoveryTimeoutTasks[l]=setTimeout(function(){this.displayLogMessage(g.AUTO_RECOVERY_TIMER_TRIGGERED,l);this.clearAutoRecoveryTimer(l);j.DISABLED_SYNC_STATUS=false;j.RECOVERY_TIMER_RUNNING=false;j.CONSECUTIVE_AUTO_RECOVERY_TRIGGERED++;f.trigger("analyticsEvent",{name:"confluence.synchrony.syncmanager.failed-to-restart",data:{id:l}});if(j.CONSECUTIVE_AUTO_RECOVERY_TRIGGERED>=this.settings.MAX_CONSECUTIVE_AUTO_RECOVERY_TRIGGERED){this.displayLogMessage(g.AUTO_RECOVERY_TIMER_TRIGGERED_TOO_MANY_TIMES,l,this.controlSyncState[l].CONSECUTIVE_AUTO_RECOVERY_TRIGGERED);f.trigger("analyticsEvent",{name:"confluence.synchrony.syncmanager.consecutive-failed-to-restart",data:{id:l}})}this.entity.start(l)}.bind(this),k.maxWaitTimeToRestart||this.settings.MAX_WAIT_TIME_TO_RESTART)};return e});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/telepointer-cleaner.js' */
define("confluence-collaborative-editor-plugin/telepointer-cleaner",["confluence-editor-reliable-save/reliable-save","jquery"],function(a,b){var c=function(d){var e=b("<div>");e.append(d);e.find(".synchrony-container, .synchrony-tp").remove();return e.html()};a.registerCleanupFunction(c)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/editor-blanket.js' */
define("confluence-collaborative-editor-plugin/editor-blanket",["ajs","jquery","confluence/meta","confluence-editor/support/atlassian-editor-support"],function(h,e,b,c){var f={};function a(k){switch(k){case"block":f.cssClass4Form="editor-block";f.ariaType4Form="aria-disabled";f.cssClass4EditorToolbar="";break;default:f.cssClass4Form="editor-loading editor-loading-spinner";f.ariaType4Form="aria-busy";f.cssClass4EditorToolbar="editor-loading";break}var j=e("#editpageform, #createpageform");j.addClass(f.cssClass4Form);j.attr(f.ariaType4Form,true);e("#content-title").attr("tabindex",-1);e("#wysiwygTextarea_ifr").attr("tabindex",-1);e(".aui-toolbar2-primary").addClass(f.cssClass4EditorToolbar)}function i(){var j=e("#editpageform, #createpageform");j.removeClass(f.cssClass4Form);j.attr(f.ariaType4Form,false);e("#rte").css("opacity",1).addClass("editor-blanket-ease-in");e("#content-title").attr("tabindex",1);e("#wysiwygTextarea_ifr").attr("tabindex",100);e("#content-title-div").css("opacity",1).addClass("editor-blanket-ease-in");e(".aui-toolbar2-primary").removeClass(f.cssClass4EditorToolbar);f={}}function g(){e("#rte").css("opacity",1);e("#content-title-div").css("opacity",1)}function d(j){if(c.isCollaborativeContentType()&&j.state()==="pending"){a();j.done(i)}else{g()}}return{applyBlanket:d,showEditor:g,showBlanket:a}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/synchrony-auth.js' */
define("confluence-collaborative-editor-plugin/synchrony-auth",["jquery","ajs","confluence/meta","confluence/legacy","confluence-collaborative-editor-plugin/synchrony-util"],function(f,i,d,k,j){var a,c=0;function l(){return j.retrieveMetadata("synchrony-token")}function e(){return parseInt(j.retrieveMetadata("synchrony-expiry"))}function g(){var p=e();if(isNaN(p)){return false}return p>(Date.now()/1000)}function o(p){if(p[1]==="error"&&p[0].responseText){return JSON.parse(p[0].responseText)}else{return p[0]}}function n(p){return h().pipe(p).pipe(function(q){var s=o(q);if(q[1]==="error"&&s.type&&s.type.match(/^jwt\//)){var r={errorType:s.type,message:s.message};return h(r).pipe(p)}return q})}function b(p,q){j.time("confluence.editor.synchrony.token");var r=q&&q.errorType?"?errorType="+q.errorType:"";f.ajax({dataType:"json",method:"GET",url:encodeURI(i.contextPath()+"/rest/synchrony/1.0/token/"+k.getContentId()+"/generate"+r)}).done(function(s){d.set("synchrony-token",s.synchronyToken);d.set("synchrony-expiry",s.synchronyExpiry);c=0;p.resolve(s.synchronyToken);if(a){a.onConfluenceConnectedState();a.onTokenRenewedState()}i.trigger("dismiss.editor.error.message",{messageKey:"synchrony-token-expired",enablePublish:true});i.debug("Synchrony JWT token updated.");j.timeEnd("confluence.editor.synchrony.token")}).fail(function(){c++;if(c>=10){i.trigger("editor.error.message",{messageKey:"synchrony-token-expired",message:"\u6211\u4eec\u4e0d\u80fd\u5904\u7406\u60a8\u7684\u8bf7\u6c42\uff0c\u56e0\u4e3a\u5b83\u7f3a\u5c11\u5fc5\u8981\u7684\u5b89\u5168\u4ee4\u724c\u3002\u590d\u5236\u60a8\u7684\u5de5\u4f5c\uff0c\u7136\u540e\u91cd\u65b0\u63d0\u53ca\u8868\u683c\u6216\u91cd\u65b0\u52a0\u8f7d\u9875\u9762\u3002",disablePublish:true})}if(a){a.onConfluenceDisconnectedState();a.onTokenExpiredState()}i.log(q?q.message:"Confluence failed to renew JWT token.");p.reject("token")})}function h(q){var p=f.Deferred();if(!q&&g()){p.resolve(l())}else{i.log("["+new Date()+"] Synchrony JWT expired or invalid, retrieving new token.");b(p,q)}return p.promise()}function m(p){a=p}return{init:m,performRequest:n,getTokenPromise:h}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/unsupported-extension.js' */
define("confluence-collaborative-editor-plugin/unsupported-extension",["ajs","jquery","confluence/legacy","confluence-editor/editor/page-editor-message","window","confluence-collaborative-editor-plugin/editor-blanket"],function(d,g,h,e,f,c){function b(){var i=d.Rte.getEditor().getBody();if(i.hasAttribute("data-gramm")&&i.hasAttribute("data-gramm_id")){d.trigger("synchrony.stop",{id:"confluence.editor.block.by.grammarly",maxWaitTimeToRestart:1000*60*60*24*365});d.trigger("analyticsEvent",{name:"confluence.synchrony.editor.grammarly.block"});i.setAttribute("contentEditable",false);g(i).find(".contentLayout2 .innerCell").each(function(){this.setAttribute("contentEditable",false)});c.showBlanket("block");h.Editor.UI.setButtonsState(false,h.Editor.UI.buttons);e.handleMessage("collaborative-editor-unsupported-extension",{type:"error",title:"\u4e0d\u652f\u6301 Grammarly",message:d.format("Grammarly \u6269\u5c55\u672a\u80fd\u826f\u597d\u5730\u7ed3\u5408\u534f\u540c\u7f16\u8f91\u3002\u7981\u7528\u5b83\u5e76 \u003ca {0}\u003e\u91cd\u65b0\u52a0\u8f7d\u9875\u9762 \u003c/a\u003e \u6765\u7ee7\u7eed\u5de5\u4f5c\u3002",'href="#" id="collabGrammarlyReload"')});g("#collabGrammarlyReload").click(function(){d.trigger("analyticsEvent",{name:"confluence.synchrony.editor.grammarly.reload.click"});f.location.reload();return false});d.trigger("synchrony-unsupported-extension")}}function a(){b()}return{check:a}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/synchrony-entity.js' */
define("confluence-collaborative-editor-plugin/synchrony-entity",["jquery","ajs","confluence-collaborative-editor-plugin/synchrony-auth","confluence-collaborative-editor-plugin/synchrony-util","confluence-collaborative-editor-plugin/unsupported-extension","confluence-collaborative-editor-plugin/util/is-valid-uri"],function(c,h,e,i,g,b){function d(k){return function(l){return null===l||k.test(l)}}function j(m){var k=d(/^[\w\.\-\+\%]+$/i);var l=d(/^[\w-]+$/);var o=d(/^data:image\/png;base64,([\w+\/%\-]+)=*$/);var n=m.whitelists.tinymce.attributes.src;return c.extend({},m.whitelists.tinymce,{styles:c.extend({},m.whitelists.tinymce.styles,{"padding-top":false,"padding-right":false,"padding-bottom":false,"padding-left":false,padding:false,display:k,"list-style-type":k}),attributes:c.extend({},m.whitelists.tinymce.attributes,{"confluence-query-params":true,"data-element-title":true,"data-ref":true,accesskey:true,datetime:true,"data-anchor":true,"data-encoded-xml":true,"data-highlight-class":true,"data-highlight-colour":true,"data-space-key":true,"data-username":true,"data-emoticon-name":l,"data-hipchat-emoticon":l,"data-entity-id":true,"data-entity-type":true,"data-favourites-bound":true,"data-macro-id":true,"data-macro-name":true,"data-macro-schema-version":true,"data-macro-body-type":true,"data-macro-parameters":true,"data-macro-default-parameter":true,"data-atlassian-layout":true,"data-placeholder-type":true,"data-layout":true,"data-title":true,"data-type":true,"data-inline-task-id":true,"data-inline-tasks-content-id":true,"data-base-url":true,"data-linked-resource-id":true,"data-linked-resource-type":true,"data-linked-resource-version":true,"data-linked-resource-default-alias":true,"data-linked-resource-container-version":true,"data-linked-resource-content-type":true,"data-unresolved-comment-count":true,"data-location":true,"data-image-height":true,"data-image-width":true,"data-attachment-copy":true,"data-content-title":true,"data-filename":true,username:true,src:function(p){return o(p)||n(p)},href:b}),classes:function(p){switch(p){case"mceSelected":case"active-resizable":return false;break;default:return true}},elements:c.extend({},m.whitelists.tinymce.elements,{time:true,mark:true,label:true,form:true})})}function a(k,m,n){var l=j(k);return{profile:"tinymce",selectionCorrections:false,telepointer:{refreshOnResize:true,label:{hover:true,movement:1000,text:function(q){try{var o=q.fullname||"\u533f\u540d\u7528\u6237";return o.charAt(0).toUpperCase()}catch(p){h.log(p)}return"&#9786;"}}},tinymce:{monkeyPatchUndoManager:true,instance:m},whitelist:function(r){var o=r.domNode===n;var q=r.type==="node";var p=r.type==="attribute"&&r.name==="data-title";if(o){return q||p}return k.isWhitelisted(l,r)},domReadHook:function(){h.trigger("cursor-target-refresh");g.check()}}}function f(k,l,o,n,m){return k.entity({url:i.getServiceUrl(),entityId:i.getEntityId(),jwt:e.getTokenPromise,initRev:m.confRev,history:n,presence:true,useFallback:i.getXhrFallbackFlag()}).bind(o,a(k,l,o))}return{bind:f,makeWhitelist:j}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/util/url-parser.js' */
define("confluence-collaborative-editor-plugin/util/url-parser",["window"],function(a){return{parseUrl:function(c){var b=a.document.createElement("a");b.href=c;return{protocol:b.protocol.replace(":",""),hostname:b.hostname,port:b.port,pathname:b.pathname==="/"?"":b.pathname,search:b.search,hash:b.hash.substr(b.hash.indexOf("#")+1,b.hash.length),host:b.host}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/util/location-provider.js' */
define("confluence-collaborative-editor-plugin/util/location-provider",["window"],function(a){return{getLocation:function(){return a.location}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/util/editor-format-fixer.js' */
define("confluence-collaborative-editor-plugin/util/editor-format-fixer",["underscore","confluence/meta","confluence-collaborative-editor-plugin/util/url-parser"],function(d,e,f){var c=function(h){var k=0;var q="img[data-base-url]";var n=e.get("base-url");var t=f.parseUrl(n);var l=h.querySelectorAll(q);for(var m=0;m<l.length;m++){var j=l[m];var p=f.parseUrl(j.attributes["data-base-url"].value);if(!d.isEqual(p,t)){var s=j.attributes["data-image-src"].value;var o=j.attributes.src.value;var r=s.replace(p.pathname,t.pathname);var u=o.replace(p.pathname,t.pathname);j.setAttribute("data-base-url",n);j.setAttribute("data-image-src",r);j.setAttribute("src",u);k++}}return k};var g=function(j){var l=0;var s=["a[data-base-url][href][data-linked-resource-type='page']","a[data-base-url][href][data-linked-resource-type='blogpost']","a[data-base-url][href][data-linked-resource-type='comment']","a[data-base-url][href][data-linked-resource-type='space']","a[data-base-url][href][data-linked-resource-type='attachment']","a[data-base-url][href][data-linked-resource-type='custom']"].join(",");var r=e.get("base-url");var q=f.parseUrl(r);var m=j.querySelectorAll(s);for(var n=0;n<m.length;n++){var k=m[n];var p=f.parseUrl(k.attributes["data-base-url"].value);if(!d.isEqual(p,q)){var h=f.parseUrl(k.attributes.href.value);var o=r+h.pathname.replace(p.pathname,"")+h.search+(h.hash?"#"+h.hash:"");k.setAttribute("data-base-url",r);k.setAttribute("href",o);l++}}return l};var b=function(h){var m=0;var r="img[data-macro-name='view-file']";var u=f.parseUrl(e.get("base-url"));var n=h.querySelectorAll(r);for(var q=0;q<n.length;q++){var k=n[q];var t=k.attributes.src.value;var l=["/rest/documentConversion/latest/","/plugins/servlet/confluence/placeholder/unknown-attachment?"];for(var p=0;p<l.length;p++){var s=l[p];var o=t.indexOf(s);if(o!=-1){var w=t.substr(0,o);if(w!==u.pathname){var v=u.pathname+t.substr(o);k.setAttribute("src",v);m++}}}}return m};var a=function(j){var i="a[data-linked-resource-id][data-linked-resource-type='userinfo'][userkey]";var h=j.querySelectorAll(i);Array.prototype.forEach.call(h,function(k){k.removeAttribute("data-linked-resource-id")});return h.length};return{fixStaleBaseUrl:function(j){var h=c(j);var k=b(j);var i=g(j);return h+k+i},fixMentions:function(h){return a(h)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/synchrony-handlers.js' */
define("confluence-collaborative-editor-plugin/synchrony-handlers",["underscore","jquery","ajs","confluence/meta","confluence/analytics-support","confluence/legacy","confluence-editor/editor/page-editor-message","confluence-collaborative-editor-plugin/lib/SyncManager","confluence-collaborative-editor-plugin/synchrony-util","confluence-collaborative-editor-plugin/synchrony-content","confluence-collaborative-editor-plugin/synchrony-presence","confluence-collaborative-editor-plugin/util/location-provider","confluence-collaborative-editor-plugin/util/url-parser","confluence-collaborative-editor-plugin/util/editor-format-fixer","confluence-collaborative-editor-plugin/editor-blanket","confluence/api/event","window"],function(W,G,A,d,g,h,i,O,e,j,S,l,B,k,p,J,L){var t;var z;var a;var C;var r;var N;var Q;var s=[];var E=false;var P=false;function v(Z,aa,Y,X){e.time("confluence.editor.synchrony.connect");r=Z;a=aa;z=Y;Q=X.pipe(null,function(ab){r.destroy();z.onDisconnectedState();return V(ab,"collaborative-editor-load-failure",true)});t=G("#syncRev");C=a.getBody();r.on("init",F).on("update",I).on("ack",K).on("connected",o).on("disconnected",m).on("error",T);N=new O(r,{DEBUG_MODE:true});j.bindPostPasteFix();j.readTitleFromRootElement(C);h.Editor.overrideBeforeSave(q);G("#content-title").keyup(j.writeTitleToRootElement)}function R(Y,X){if(X.contributors){s=X.contributors;J.unbind(Y,R)}}J.bind("editor-heartbeat",R);function F(X){E=true;t.val(X.rev.toString())}function K(X){t.val(X.rev.toString());J.trigger("synchrony.entity.ack",{pendingChanges:X.pending.length>0})}function m(){z.onDisconnectedState();A.log("Synchrony disconnected!")}function T(X){if(X.errorType==="null/no-such-sequence"||X.errorType==="null/entity-evicted"||X.errorType==="hub.error/locked"){J.trigger("analyticsEvent",{name:"confluence.editor.data.evicted.error",data:{errorType:X.errorType,onLoad:!E,afterReload:!H()}});D();b();x()}else{if(X.level==="fatal"){J.trigger("editor.error.message",{disablePublish:true})}}}function D(){r.destroy();J.trigger("synchrony.history.evicted")}function b(){var Y=H();var X=E?"\u003cb\u003e\u65e0\u6cd5\u540c\u6b65\u60a8\u7684\u66f4\u6539\u003c/b\u003e\u003cbr/\u003e\u590d\u5236\u60a8\u9700\u8981\u4fdd\u7559\u7684\u66f4\u6539\uff0c\u7136\u540e\u5237\u65b0\u6b64\u9875\u9762\u4ee5\u7ee7\u7eed\u7f16\u8f91\u3002":(Y?"\u91cd\u65b0\u52a0\u8f7d\u8be5\u9875\u9762\uff0c\u4f7f\u5176\u7ee7\u7eed\u540c\u6b65\u3002":"\u003cb\u003e\u540c\u6b65\u6b64\u9875\u9762\u9700\u8981\u4e00\u4e9b\u65f6\u95f4\u003c/b\u003e\u003cbr/\u003e\u8bf7\u7a0d\u5019\uff0c\u7136\u540e\u5237\u65b0\u8be5\u9875\u9762\u4ee5\u5f00\u59cb\u7f16\u8f91\u3002\u5982\u9700\u8be5\u95ee\u9898\u4ecd\u7136\u5b58\u5728\uff0c\u8bf7\u8054\u7cfb Confluence \u7ba1\u7406\u5458\u3002");J.trigger("editor.error.message",{disablePublish:true,close:"never",message:X});if(E){z.onDisconnectedState()}else{p.showBlanket("block");if(Y){c()}}}function x(){L.onerror=function(Z,aa,ab,Y,X){if(!aa&&!ab&&!Y&&!X){if(P){return true}else{P=true;return false}}else{if(X&&X.message&&X.message==="entity destroyed"){return true}}return false}}function w(){return"_reload_for_"+d.get("draft-id")}function c(){L.sessionStorage.setItem(w(),"false");L.location.reload()}function H(){return L.sessionStorage.getItem(w())===null}function u(){L.sessionStorage.removeItem(w())}function o(X){e.timeEnd("confluence.editor.synchrony.connect");A.log("Synchrony connected.");S.appendTo(X.sid,r,s);z.onConnectedState(r);J.trigger("synchrony.connected");j.fixTinymceCaretContainer(C,a);u()}function V(Y,X,Z){return{origin:"synchrony",cause:Y,messageKey:X,disablePublish:Z}}function q(aa){var Z=5000;var ab=G.Deferred();function Y(){ab.resolve(aa)}function X(ad){if(!ad.pending.length){r.off("ack",X);t.val(ad.rev.toString());Y()}}var ac=!r.ackState().pending.length;if(ac){Y()}else{r.on("ack",X);setTimeout(function(){r.off("ack",X);ab.reject(V("timeout"))},Z)}return G.when(ab,Q).promise()}function U(Y){var X=e.getLatestRevisionWithAttr(Y.revisions,"user");return X?X.meta.user:"\u533f\u540d\u7528\u6237"}function y(X){i.handleMessage("editor.synchrony.page-published",{type:"info",message:A.format("\u6b64\u9875\u5df2\u53d1\u5e03{0}\u6b21\u3002",A.escapeHtml(X)),close:"auto"});J.trigger("analyticsEvent",{name:"confluence.synchrony.external-changes.publish"});J.trigger("editor-shared-drafts-published")}function n(){d.set("new-page",false);d.set("page-id",h.getContentId());d.set("draft-id","0");if(!h.Editor.isLimitedModeEnabled()){h.Editor.UI.setButtonState(true,G("#rte-button-discard"))}}function I(Y){if(Y.updateType==="remote"){t.val(Y.revisions[Y.revisions.length-1].rev.toString());if(e.hasRevisionTrigger(Y.revisions,"reset")){i.handleMessage("editor.synchrony.revert-page",{type:"info",message:A.format("{0} \u6062\u590d\u5230\u8be5\u9875\u9762\u4e00\u4e2a\u4e4b\u524d\u7684\u7248\u672c\u3002",A.escapeHtml(U(Y)))});d.set("has-collaborated",false);M();J.trigger("analyticsEvent",{name:"confluence.synchrony.external-changes.revert"});J.trigger("editor-shared-drafts-discarded");h.Editor.heartbeat()}if(e.hasRevisionTrigger(Y.revisions,"publish")){if(j.isUnpublished()){n()}d.set("has-collaborated",false);M();y(U(Y));h.Editor.heartbeat()}if(e.hasRevisionType(Y.revisions,"external")){J.trigger("editor.external.change")}var X=e.getLatestRevisionWithAttr(Y.revisions,"confVersion");if(X&&X.meta.confVersion){G('meta[name="page-version"]').attr("content",X.meta.confVersion);G('meta[name="ajs-page-version"]').attr("content",X.meta.confVersion);d.set("page-version",X.meta.confVersion)}}setTimeout(function(){if(Y.updateType==="init"||Y.updateType==="remote"){J.trigger("editor.remote.change");j.readTitleFromRootElement(C)}if(Y.updateType=="init"){if(f(l.getLocation())){a.undoManager.ignore(function(){var Z=k.fixStaleBaseUrl(C);if(Z>0){g.publish("collab.edit.format.stale.fix.count",{staleformatfixed:Z})}})}else{A.log("Request url does not match the configured base url. Not performing fixStaleBaseUrl().")}a.undoManager.ignore(function(){k.fixMentions(C)})}j.fixTinymceCaretContainer(C,a);if(Y.updateType==="local"){if(!a.undoManager.hasUndo()){a.setDirty(false)}J.trigger("editor.local.change")}},0)}function M(){if(r.ackState().pending.length===0){a.setDirty(false)}}function f(X){var Y=d.get("context-path");var aa=B.parseUrl(d.get("base-url"));var Z=B.parseUrl(X);var ab=B.parseUrl(Z.protocol+"://"+Z.host+Y);return W.isEqual(aa,ab)}return{handle:v}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:confluence-collaborative-editor-plugin-resources', location = '/js/synchrony-editor.js' */
define("confluence-collaborative-editor-plugin/synchrony-editor",["window","jquery","ajs","confluence/legacy","confluence-collaborative-editor-plugin/editor-blanket","confluence-collaborative-editor-plugin/synchrony-util","confluence-collaborative-editor-plugin/synchrony-content","confluence-collaborative-editor-plugin/synchrony-auth","confluence-collaborative-editor-plugin/synchrony-entity","confluence-collaborative-editor-plugin/synchrony-handlers","confluence-editor/support/atlassian-editor-support","confluence-editor/loader/collaborative-helper",],function(C,A,t,g,l,d,h,i,y,u,c,z){var F={};d.time("confluence.editor.synchrony.jsLoad");var J=10*60*1000;var s=30*1000;var r;var G=false;var D=false;var q=false;var k=false;var m;A(C).bind("beforeunload",function(){if(!q){t.trigger("analyticsEvent",{name:"confluence.synchrony.exit.before.connecting",data:{afterTimeout:k,contentId:g.getContentId()}})}});function x(M){A('meta[name="ajs-collaborative-editor-status"]').attr("content",M)}function w(){return !t.Rte.isQuickEdit}function o(){var M=A.Deferred();t.$(function(){t.$("body").addClass("synchrony-active");var N=require("confluence-collaborative-editor-plugin/status-indicator-view");r=new N({el:"#pluggable-status",model:new Backbone.Model({minActiveTime:500})});i.init(r);M.resolve()});return M}t.bind("synchrony.history.evicted",function(M){D=true});function I(M){if(D!==true){var O,N;switch(M){case"timeout":O="\u7f16\u8f91\u5668\u8fd9\u6b21\u6ca1\u6709\u52a0\u8f7d";N="\u8fde\u63a5\u8d85\u65f6\u3002\u5982\u679c\u8fd9\u4e2a\u95ee\u9898\u518d\u6b21\u53d1\u751f\uff0c\u8bf7\u8054\u7cfb\u60a8\u7684 Confluence \u7ba1\u7406\u5458\u3002\u60a8\u53ef\u80fd\u5728\u4f7f\u7528\u4e00\u4e2a\u4e0d\u5141\u8bb8 WebSocket \u8fde\u63a5\u7684\u4ee3\u7406\u670d\u52a1\u5668\u3002\u003c/br\u003e\u003ca href=\u0022#\u0022 id=\u0022websocketRetry\u0022\u003e\u91cd\u8bd5\u003c/a\u003e&nbsp;.&nbsp;\u003ca href=\u0022https://confluence.atlassian.com/display/CONFKB/Confluence+throws+The+editor+didn%27t+load+this+time+error+when+trying+to+edit+a+page\u0022 target=\u0022_blank\u0022 id=\u0022websocketFindmore\u0022\u003e\u4e86\u89e3\u66f4\u591a\u003c/a\u003e";break;case"synchrony-requests":G=true;O="";N="\u52a0\u8f7d\u7f16\u8f91\u5668\u540e\u51fa\u73b0\u4e86\u4e00\u4e9b\u95ee\u9898\u3002\u8bf7\u590d\u5236\u60a8\u8fd8\u672a\u4fdd\u5b58\u7684\u4fee\u6539\uff0c\u7136\u540e\u5237\u65b0\u9875\u9762\u6765\u7ee7\u7eed\u7f16\u8f91\u3002";break;case"limited-mode":G=true;O="";N="\u52a0\u8f7d\u7f16\u8f91\u5668\u51fa\u9519\uff0c\u8bf7\u91cd\u8bd5\u3002";break;default:G=true;O="";N="\u8be5\u6587\u4ef6\u7684\u52a0\u8f7d\u65f6\u95f4\u6bd4\u5e73\u65f6\u8981\u957f\u3002\u8bf7\u7a0d\u7b49\u7247\u523b\uff0c\u7136\u540e\u5c1d\u8bd5\u5237\u65b0\u3002\u95ee\u9898\u4f9d\u7136\u5b58\u5728\uff1f\u8bf7\u8054\u7cfb Confluence \u7ba1\u7406\u5458\u3002";break}t.trigger("editor.error.message",{title:O,messageKey:"collaborative-editor-load-failure",message:N,disablePublish:true,close:"manual"})}}function v(){t.trigger("dismiss.editor.error.message",{messageKey:"collaborative-editor-load-failure",enablePublish:true})}function j(O,M){var N=A.Deferred();O.done(function(){d.timeEnd(M)},N.resolve);O.fail(N.resolve);return N.promise()}function H(M,N){var P=((N[1]==="error"&&N[0].responseText)?JSON.parse(N[0].responseText):"");var O=false;if(P.type==="invalid-ancestor"){O="synchrony"}else{if(P.type==="out-of-order-revision"){O="confluence"}}if(O){t.log("Performing synchrony recovery");A.ajax({url:t.contextPath()+"/rest/synchrony/1.0/content/"+g.getContentId()+"/recovery?behind="+O+"&conflictingRev="+P["conflicting-rev"],type:"PUT"});return"synchrony-requests"}if((N[1]!=="success"&&M[1]!=="success")||(N[1]!=="success"&&P.type!=="duplicate-mismatch")){t.trigger("analyticsEvent",{name:"confluence.synchrony.client.content.reconciliation.failure",data:{type:P.type,contentId:g.getContentId()}});return"synchrony-requests"}return false}F._bindEditor=function(T,P,W,M,O){d.time("confluence.editor.synchrony.init");var V=H(W,M);if(V){return null}var U=A("#syncRev");var S=null;if(W[1]==="success"){var R=W[0];S={base:{rev:Synchrony.rev(R.stateAt),state:R.state}};U.val(S.base.rev.toString())}t.log("Synchrony will load with contentId: ",g.getContentId());try{var N=P.getBody();N.setAttribute("data-title",T.title);m=y.bind(Synchrony,P,N,S,T);u.handle(m,P,r,O);t.trigger("editor.remote.change");P.setDirty(false);d.timeEnd("confluence.editor.synchrony.init");return m}catch(Q){t.logError(Q);return null}};function L(N){function M(O){d.time("confluence.editor.synchrony.snapshot");return j(A.ajax({type:"POST",url:encodeURI(d.getServiceUrl()+"/data"+d.getEntityId()+"?state-at=@head&state-format=type-tagged&rewrite-request=true&cached="+N),contentType:"text/plain",dataType:"json",data:JSON.stringify({headers:{"content-type":"application/json","x-token":O},method:"GET"})}).pipe(d.asArray,d.asArray),"confluence.editor.synchrony.snapshot")}return i.performRequest(M)}function e(M){function N(O){d.time("confluence.editor.synchrony.CR");return j(A.ajax({type:"POST",url:encodeURI(d.getServiceUrl()+"/data"+d.getEntityId()+"?optimistic=true&rewrite-request=true"),dataType:"json",contentType:"text/plain",data:JSON.stringify({body:{ancestor:M.syncRev,rev:M.confRev,state:{format:"html",value:M.html},merges:{master:{meta:{type:"client-reconciliation"}}}},headers:{"content-type":"application/json","x-token":O},method:"PUT"})}).pipe(d.asArray,d.asArray),"confluence.editor.synchrony.CR")}if(!M.syncRev&&h.isUnpublished()&&(M.raw.length===0||/^\s+$/.test(M.raw))){return A.Deferred().resolve([{},"success"])}else{if(h.isContentEmpty(M.raw)){t.trigger("analyticsEvent",{name:"confluence.synchrony.client.content.reconciliation.blank-content",data:{contentId:g.getContentId()}});return A.Deferred().resolve([{},"success"])}}return i.performRequest(N)}function B(M){d.time("confluence.editor.synchrony");A.when(Date.now(),M).pipe(function(O){x("on");var N=Date.now();t.trigger("analyticsEvent",{name:"confluence.synchrony.editor.loaded",data:{durationMillis:(N-O),contentId:g.getContentId()}});t.trigger("rte-collab-ready");d.timeEnd("confluence.editor.synchrony");d.timeEnd("confluence.editor")})}function n(){var M=K("synchrony.connected synchrony.connected.fake");var N=K("synchrony.connected synchrony.connected.fake synchrony-unsupported-extension",s);N.fail(function(O){I(O);t.trigger("analyticsEvent",{name:"confluence.synchrony.editor.load.timeout",data:{contentId:g.getContentId()}});a();k=true;M.done(function(){if(!G){q=true;v()}})})}F._initialiseCollabEditingComponents=function(M){var N=o();A(C).one("synchrony.connected.fake",function(O){if(O.namespace==="connected.fake"){N.resolve();M.resolve();v();x("fake")}});return N};F._initialiseSynchrony=function(){d.time("confluence.editor.synchrony.deps");(function(N){var O=N.Synchrony=N.Synchrony||{};if(!O.ready){var P=O._cbs=O._cbs||[];O.ready=function(S){P.push(S)}}var R=function(){1===O.state&&(O.SockJS=N.SockJS,O.init())};if(N.SockJS){O.init&&R()}else{var Q=N._sockjs_onload;N._sockjs_onload=function(){R();Q&&Q.apply(this,arguments)}}})(C);var M=A.Deferred();Synchrony.ready(M.resolve);return A.when(M.promise(),d.loadScript(["/js/vendor/sockjs.min.js","/js/synchrony.min.js"])).pipe(function(N){d.timeEnd("confluence.editor.synchrony.deps");t.log("Synchrony successfully initialised.");return N})};function E(V,O,S){var P=F._initialiseSynchrony();var M=K("synchrony.connected.fake");var N=K(null);O.pipe(function(){setTimeout(N.reject,s,"synchrony-requests")});var U=F._initialiseCollabEditingComponents(N);var T=Date.now();var R=null;var Q=null;if(!t.DarkFeatures.isEnabled("synchrony-pessimistic-snapshot")){R=P.pipe(function(){return L(true)});R.done(function(X){Q=X[1]})}var W=A.when(V,P).pipe(function(){if(!R||R.state()==="rejected"||Q==="error"||(J<Date.now()-T)){return L(false)}return R});S.pipe(function(){n();B(M);l.applyBlanket(M)});O.pipe(function(X){var Y=P.pipe(function(){return e(X)});W=A.when(W,P).pipe(function(aa,ab){d.time("confluence.editor.synchrony.unmarshal");var Z=aa;if(aa[1]==="success"){Z=[{stateAt:aa[0].stateAt,state:ab.unmarshal(aa[0].state.value)},aa[1]]}d.timeEnd("confluence.editor.synchrony.unmarshal");return Z});A.when(W,Y).pipe(function(Z,ab){var aa=H(Z,ab);if(aa){N.reject(aa)}else{N.resolve()}});if(!t.DarkFeatures.isEnabled("synchrony-pessimistic-CR")&&(X.syncRevSource==="synchrony-ack"||h.isUnpublished())){t.debug("confluence.editor.synchrony: content up to date, not waiting for CR");N.fail(I);return A.when(X,S,W,[{},"success"],U)}return A.when(X,S,W,Y,U)}).pipe(function(ab,aa,Y,Z){var X=F._bindEditor(ab,aa,Y,Z,N);if(!X){t.trigger("analyticsEvent",{name:"confluence.synchrony.bind.failure",data:{contentId:g.getContentId()}});return A.Deferred().reject("editor-binding-failed")}M.resolve()}).fail(function(X){S.always(function(){if(X!=="synchrony-not-enabled"){t.log("Failed to load the collaborative editor",X);I(X);t.$(function(){r.onDisconnectedState()});x("failed");t.trigger("analyticsEvent",{name:"confluence.synchrony.error",data:{error:X,contentId:g.getContentId()}})}})})}F.init=function(){if(c.isCollaborativeContentType()){var M=b("rte-quick-edit-init rte-collaborative-content-ready rte-initial-raw-content-ready",true);var O=b("rte-quick-edit-init rte-collaborative-content-ready rte-initial-raw-content-ready rte-collab-editor-loaded",false);var P=b("rte-collaborative-content-ready rte-initial-raw-content-ready",false,h.getContent);var N=b("rte-collab-editor-loaded",false,t.Rte.getEditor);N=b("rte-ready rte-begin-collab-editing",false,t.Rte.getEditor,w,N);M.pipe(function(){E(O.promise(),P.promise(),N.promise())});P.fail(I);t.trigger("synchrony-events-bound");N.fail(function(Q){if(Q==="synchrony-not-enabled"){f();t.log("Synchrony is not available in this context.")}})}};F.register=function(){z.registerPlugin(F)};F.getSynchronisedEditorContent=function(){var O=m.ackState();if(O.rev){var N=Synchrony.makeDom(O.state,{document:document,whitelist:y.makeWhitelist(Synchrony)});var M=require("tinymce");return{content:M.activeEditor.serializer.serialize(N),syncRev:O.rev.toString()}}t.logError("Synchrony hasn't acked any data, can't fetch draft data");return null};function f(){l.showEditor();x("off")}function K(N,P,M){var Q=A.Deferred();if(N){t.bind(N,function O(S,R){t.debug("confluence.editor.synchrony.event: "+S.type+"."+S.namespace);t.unbind(N,O);Q.resolve(R)})}if(P){setTimeout(Q.reject,P,M||"timeout")}return Q}function b(P,S,O,M,N){var R=N||A.Deferred();if(d.isEditorInitialised()||(S&&d.synchronyReady())){return p(R,O)}t.bind(P,function Q(U,T){t.debug("confluence.editor.event "+U.type+"."+U.namespace);R.always(function(){t.unbind(P,Q)});p(R,O,T,M)});return R}function p(Q,O,P,N){if(!d.synchronyReady()){return Q.reject("synchrony-not-enabled")}if(!N||N()){var M=O?O(P):P;return M&&M.error?Q.reject(M.error):Q.resolve(M)}return Q}function a(){A("#websocketRetry").on("click",function(){t.trigger("analyticsEvent",{name:"confluence.synchrony.editor.websocket.retry.click"});C.location.reload();return false});A("#websocketFindmore").on("click",function(){t.trigger("analyticsEvent",{name:"confluence.synchrony.editor.websocket.findmore.click"})})}d.timeEnd("confluence.editor.synchrony.jsLoad");return F});require("confluence/module-exporter").safeRequire("confluence-collaborative-editor-plugin/synchrony-editor",function(a){a.register();a.init()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:trigger', location = '/includes/js/trigger.js' */
define("confluence/trigger",["jquery","window"],function(b,c){return function(a,d){a=new b.Event(a);b(d||c.top.document).trigger(a);return!a.isDefaultPrevented()}});require("confluence/module-exporter").exportModuleAsGlobal("confluence/trigger","AJS.jiraTrigger");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:keyboard', location = '/includes/js/api/keyboard.js' */
define("confluence/api/keyboard",["jquery"],function(f){function b(a,b,c){h[b]=a;i[a]=b;c&&(j[b]=!0);return a}function g(a){a=a.originalEvent||a;return null==a.which?a.keyCode:0!==a.which&&0!==a.charCode?a.which:null}function k(a){var a=a.originalEvent||a,b=e.specialKeyEntered(a);if(b)return b;if(f.browser.mozilla){if("keypress"===a.type&&(a=g(a),null!==a))return String.fromCharCode(a).toLowerCase()}else if("keypress"!==a.type)return String.fromCharCode(a.keyCode).toLowerCase()}var e={},h={},i={},
j={},c=e.SpecialKey={BACKSPACE:b("backspace",8,!0),TAB:b("tab",9,!0),RETURN:b("return",13,!0),SHIFT:b("shift",16),CTRL:b("ctrl",17),ALT:b("alt",18),PAUSE:b("pause",19),CAPS_LOCK:b("capslock",20),ESC:b("esc",27,!0),SPACE:b("space",32,!0),PAGE_UP:b("pageup",33),PAGE_DOWN:b("pagedown",34),END:b("end",35),HOME:b("home",36),LEFT:b("left",37),UP:b("up",38),RIGHT:b("right",39),DOWN:b("down",40),INSERT:b("insert",45),DELETE:b("del",46),F1:b("f1",112),F2:b("f2",113),F3:b("f3",114),F4:b("f4",115),F5:b("f5",
116),F6:b("f6",117),F7:b("f7",118),F8:b("f8",119),F9:b("f9",120),F10:b("f10",121),F11:b("f11",122),F12:b("f12",123),NUMLOCK:b("numlock",144),SCROLL:b("scroll",145),META:b("meta",224)};c.eventType=function(){return f.browser.mozilla?"keypress":"keydown"};c.fromKeyCode=function(a){return h[a]};c.toKeyCode=function(a){return i[a]};c.isAscii=function(a){return!!j[a]};c.isSpecialKey=function(a){return!!c.toKeyCode(a)};e.characterEntered=function(a){a=a.originalEvent||a;if("keypress"===a.type&&(a=g(a),
null!==a&&(!c.isAscii(a)||c.fromKeyCode(a)===c.SPACE)))return String.fromCharCode(a)};e.specialKeyEntered=function(a){a=a.originalEvent||a;if(f.browser.mozilla){if("keypress"===a.type){var b=g(a);if(null===b)return c.fromKeyCode(a.keyCode);if(c.isAscii(b))return c.fromKeyCode(b)}}else if("keypress"!==a.type)return c.fromKeyCode(a.keyCode)};e.shortcutEntered=function(a){a=a.originalEvent||a;if(a.type===e.SpecialKey.eventType()){var b=e.specialKeyEntered(a),d="";a.altKey&&b!==c.ALT&&(d+=c.ALT+"+");
a.ctrlKey&&b!==c.CTRL&&(d+=c.CTRL+"+");a.metaKey&&(!a.ctrlKey&&b!==c.META)&&(d+=c.META+"+");a.shiftKey&&b!==c.SHIFT&&(d+=c.SHIFT+"+");if(b)return d+b;if(0<d.length&&"shift+"!==d&&(a=k(a)))return d+a}};return e});require("confluence/module-exporter").exportModuleAsGlobal("confluence/api/keyboard","AJS.Keyboard");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/class.js' */
define("confluence/class",["jquery"],function(f){var j=function(d){var a=function(){};a.prototype=d;return new a},i=!1,l=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,k=function(){};k.extend=function(){function d(){!i&&this.init&&this.init.apply(this,arguments)}var a,g=this.prototype;if(1<arguments.length){var c=f.makeArray(arguments);a=c.pop();var h;f.each(c,function(b,a){h=h?h.extend(a):a});return h.extend(this.prototype).extend(a)}a=arguments[0];i=!0;c=new this;i=!1;for(var b in a)if(c[b]="function"===
typeof a[b]&&"function"===typeof g[b]&&l.test(a[b]))c[b]=function(a,b){return function(){var c=this._super;this._super=g[a];var d=b.apply(this,arguments);this._super=c;return d}}(b,a[b]);else if("object"===typeof g[b]){var e=j(a[b]);f.each(g[b],function(a,b){if(e[a]){if("object"===typeof e[a]){var c=j(e[a]);f.each(b,function(a,b){c[a]||(c[a]=b)});e[a]=c}}else e[a]=b});c[b]=e}else c[b]=a[b];d.prototype=c;d.constructor=d;d.extend=arguments.callee;return d};return k});
require("confluence/module-exporter").exportModuleAsGlobal("confluence/class","Class");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/control.js' */
define("confluence/control","confluence/class confluence/trigger confluence/api/logger confluence/api/keyboard jquery document".split(" "),function(k,l,i,g,d,e){return k.extend({INVALID:"INVALID",_throwReadOnlyError:function(a){Error(this.CLASS_SIGNATURE+": Sorry ["+a+"] is a read-only property")},_assignEvents:function(a,b){this._unassignEvents(a,b);if(typeof b==="string")for(var c in this._events[a])d(e).delegate(b,c,this._getDispatcher(a,c));else{b=d(b);for(c in this._events[a]){b.bind(c,this._getDispatcher(a,
c));i.debug("Control bound eventType '"+c+"' for group '"+a+"' on target '"+(b[0].type||b[0])+"'")}}},_unassignEvents:function(a,b){if(typeof b==="string")for(var c in this._events[a])d(e).undelegate(b,c,this._getDispatcher(a,c));else{b=d(b);try{for(c in this._events[a])b.unbind(c,this._getDispatcher(a,c))}catch(g){var f=d._data(b[0],"events");if(f)for(c in f)if(c in this._events[a]){for(var m=this._getDispatcher(a,c),j=f[c],h=0;h<j.length;h++)if(j[h]===m){j.splice(h,1);break}i.debug("Control unbound eventType '"+
c+"' for group '"+a+"' on target '"+(b[0].type||b[0])+"'")}}}},_getDispatcher:function(a,b){var c=a+"/"+b;if(!this._dispatchers)this._dispatchers={};if(!this._dispatchers[c]){var e=this._events[a][b],f=this;this._dispatchers[c]=function(c){i.debug("Control dispatching eventType '"+b+"' for group '"+a+"' on instance '"+f.type+"'");return e.call(f,c,d(this))}}return this._dispatchers[c]},_isValidInput:function(){return true},_handleKeyEvent:function(a){if(this._isValidInput(a)){var b=g.SpecialKey,c=
g.shortcutEntered(a);if(c){if(this.keys[c]){this.keys[c].call(this,a);return}if((c===b.BACKSPACE||c===b.DELETE)&&this.keys.onEdit){this.keys.onEdit.call(this,a);return}}(b=g.characterEntered(a))&&this.keys.onEdit&&this.keys.onEdit.call(this,a,b)}},getCustomEventName:function(a){return(this.CLASS_SIGNATURE||"")+"_"+a},_getCustomEventArgs:function(){return[this]},trigger:function(a){return l(a,this)},_supportsBoxShadow:function(){var a=e.body.style;return a.WebkitBoxShadow!==void 0||a.MozBoxShadow!==
void 0||a.boxShadow!==void 0},_setOptions:function(a){var b,c,a=a||{};if(a instanceof d||typeof a==="string"||typeof a==="object"&&a.nodeName)a={element:a};b=d(a.element);c=b.getOptionsFromAttributes();this.options=d.extend(true,this._getDefaultOptions(a),c,a);if(b.length===0)return this.INVALID},getCaret:function(a){var b=a.selectionStart;if(b>=0)return a.selectionEnd>b?-1:b;if(e.selection){b=e.selection.createRange();if(b.text.length===0){var c=b.duplicate();c.moveToElementText(a);c.setEndPoint("EndToStart",
b);return c.text.length}}return-1},_render:function(){var a,b=arguments[0],c=[];for(a=1;a<arguments.length;a++)c.push(arguments[a]);return this._renders[b].apply(this,c)}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence/control","AJS.Control");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/api/mouse.js' */
define("confluence/api/mouse",["jquery","window"],function(d,e){var b={MotionDetector:function(){this.reset()}};b.MotionDetector.prototype.reset=function(){this._y=this._x=this._handler=null;this.moved=!1};b.MotionDetector.prototype.wait=function(b){var a=this;a._handler||(this.reset(),d(e.top.document).bind("mousemove",a._handler=function(c){!a._x&&!a._y?(a._x=c.pageX,a._y=c.pageY):c.pageX===a._x&&c.pageY===a._y||(a.unbind(),a.moved=!0,b&&b.call(this,c))}))};b.MotionDetector.prototype.unbind=function(){this._handler&&
(d(e.top.document).unbind("mousemove",this._handler),this.reset())};return b});require("confluence/module-exporter").exportModuleAsGlobal("confluence/api/mouse","AJS.Mouse");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/group.js' */
define("confluence/group",["confluence/control","confluence/api/logger","jquery"],function(d,e,c){return d.extend({init:function(){this.type=this.type||"Group";this.items=[];this.index=-1;this._assignEvents("instance",this)},addItem:function(a){this.items.push(a);this._assignEvents("item",a)},removeItem:function(a){var b=c.inArray(a,this.items);if(0>b)throw Error("Group: item ["+a+"] is not a member of this group");a.trigger("blur");b<this.index&&this.index--;this.items.splice(b,1);this._unassignEvents("item",
a)},removeAllItems:function(){for(var a=0;a<this.items.length;a++)this._unassignEvents("item",this.items[a]),this.items[a].trigger("blur");this.index=-1;this.items.length=0;this._unassignEvents("keys",document)},shiftFocus:function(a){e.debug("Group.shiftFocus called with offset: "+a);-1===this.index&&1===a&&(a=0);0<this.items.length&&(a=(Math.max(0,this.index)+this.items.length+a)%this.items.length,this.items[a].trigger("focus"))},prepareForInput:function(){this._assignEvents("keys",document)},_events:{instance:{focus:function(){0!==
this.items.length&&(0>this.index?this.items[0].trigger("focus"):this._assignEvents("keys",document))},blur:function(){0<=this.index?this.items[this.index].trigger("blur"):this._unassignEvents("keys",document)}},keys:{"keydown keypress":function(a){this._handleKeyEvent(a)}},item:{focus:function(a){var b=this.index;this.index=c.inArray(a.target,this.items);0>b?this.trigger("focus"):b!==this.index&&this.items[b].trigger("blur")},blur:function(a){this.index===c.inArray(a.target,this.items)&&(this.index=
-1,this.trigger("blur"))},remove:function(a){this.removeItem(a.target)}}},keys:{}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence/group","AJS.Group");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/select-grid.js' */
define("confluence/select-grid",["ajs","jquery","confluence/templates","confluence/group","confluence/control"],function(g,d,j,e,m){var e=e.extend({init:function(a){this.type=this.type||"SelectGrid";this._super();var b=d(j.SelectGrid.gridOutline()),c=b.find("thead tr");d(a.columns).each(function(a,b){var f=d("<th></th>").addClass(b.getClassName()).text(b.heading);c.append(f)});this.gridContainer=d(a.gridContainer).append(b);this.getRowId=a.getRowId;this.table=b;this.columns=a.columns;this.selectionCallback=
a.selectionCallback;this.body=b.find("tbody");this.body.delegate("a","click",function(a){a.preventDefault()});this.dontShiftFocus=a.dontShiftFocus||function(){}},keys:{up:function(a){this.table.is(":visible")&&!this.dontShiftFocus()&&(this.shiftFocus(-1),a.preventDefault())},down:function(a){this.table.is(":visible")&&!this.dontShiftFocus()&&(this.shiftFocus(1),a.preventDefault())}},_addRow:function(a,b,c,h){d.isFunction(c)&&(h=c,c=!1);c?this.body.prepend(a):this.body.append(a);a=new n({row:a,data:b,
callback:h,getRowId:this.getRowId,selectionCallback:h});this.addItem(a);return a},clear:function(){this.removeAllItems();this.body.children().remove()},_addRows:function(a,b){var c=this,h=[];d(a).each(function(a,f){var g=c.columns,e,i,k,l;e=d("<tr></tr>");d(g).each(function(a,b){i={outerClass:b.getClassName(f)||"",href:b.getHref&&b.getHref(f)||"",innerClass:b.getInnerClass&&b.getInnerClass(f)||"",title:b.getTitle&&b.getTitle(f)||"",text:b.getText(f)||""};k=i.href?"cellWithLink":"cellWithoutLink";
l=j.SelectGrid[k](i);e.append(l)});e.attr("data-id",c.getRowId(f));h.push(c._addRow(e,f,b,c.selectionCallback))});return h},update:function(a){this.clear();!a||!a.length?g.debug("SelectGrid.update called with no data, returning."):(this._addRows(a),this.prepareForInput())},prependAndSelect:function(a,b){!a||!a.length?g.debug("SelectGrid.prependAndSelect called with no data, returning."):this._addRows(a,!0)[b||0].selectRow()},findItem:function(a){for(var b=0;b<this.items.length;b++)if(this.items[b].getRowId()==
a)return this.items[b];g.debug("SelectGrid.findItem didn't find item, returning null.");return null},select:function(a){(a=this.findItem(a))&&a.selectRow()},selectIndex:function(a){a=a||0;this.items[a]?this.items[a].selectRow():g.debug("SelectGrid.selectIndex couldn't select row with index "+a+", not found")},show:function(){this.gridContainer.removeClass("hidden")},hide:function(){this.gridContainer.addClass("hidden")},isVisible:function(){return!this.gridContainer.hasClass("hidden")}}),n=m.extend({init:function(a){this.type=
"SelectableRow";this.$row=d(a.row);this.$row.data("properties",a.data);this.getRowId=function(){return a.getRowId(a.data)};this.selectionCallback=a.selectionCallback;this._assignEvents("element",this.$row);this._assignEvents("instance",this);g.debug("SelectableRow initialized")},_events:{instance:{focus:function(){var a=this.$row;a.addClass("selected");this.selectionCallback(a,a.data("properties"))},blur:function(){this.$row.removeClass("selected")}},element:{click:function(){this.trigger("focus")}}},
selectRow:function(){this.trigger("focus")}});e.Column=function(a){var b=function(b){return b[a.key]};return{key:a.key,heading:a.heading,getClassName:a.getClassName||function(){return a.className||a.key+"-field"},getHref:a.getHref,getInnerClass:a.getInnerClass,getTitle:a.getTitle,getText:a.getText||b}};return e});require("confluence/module-exporter").exportModuleAsGlobal("confluence/select-grid","AJS.SelectGrid");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/select-grid.soy' */
// This file was automatically generated from select-grid.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.SelectGrid.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.SelectGrid == 'undefined') { Confluence.Templates.SelectGrid = {}; }


Confluence.Templates.SelectGrid.gridOutline = function(opt_data, opt_ignored) {
  return '<table class="select-grid aui"><thead><tr class="data-table-header"></tr></thead><tbody></tbody></table>';
};
if (goog.DEBUG) {
  Confluence.Templates.SelectGrid.gridOutline.soyTemplateName = 'Confluence.Templates.SelectGrid.gridOutline';
}


Confluence.Templates.SelectGrid.cellWithLink = function(opt_data, opt_ignored) {
  return '<td class="' + soy.$$escapeHtml(opt_data.outerClass) + '"><a class="' + soy.$$escapeHtml(opt_data.innerClass) + '" href="' + soy.$$escapeHtml(opt_data.href) + '" title="' + soy.$$escapeHtml(opt_data.title) + '"><span>' + soy.$$escapeHtml(opt_data.text) + '</span></a></td>';
};
if (goog.DEBUG) {
  Confluence.Templates.SelectGrid.cellWithLink.soyTemplateName = 'Confluence.Templates.SelectGrid.cellWithLink';
}


Confluence.Templates.SelectGrid.cellWithoutLink = function(opt_data, opt_ignored) {
  return '<td class="' + soy.$$escapeHtml(opt_data.outerClass) + '"><span class="' + soy.$$escapeHtml(opt_data.innerClass) + '" title="' + soy.$$escapeHtml(opt_data.title) + '">' + soy.$$escapeHtml(opt_data.text) + '</span></td>';
};
if (goog.DEBUG) {
  Confluence.Templates.SelectGrid.cellWithoutLink.soyTemplateName = 'Confluence.Templates.SelectGrid.cellWithoutLink';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/result-grid.js' */
define("confluence/result-grid",["ajs","jquery","confluence/control"],function(d,g,l){return l.extend({init:function(a){this.type=this.type||"ResultGrid";var c,f,k,h,j,e,i;f=a.gridContainer||g(a.baseElement).find(".data-table");f.length||d.debug("gridContainer for AJS.ResultGrid not found!");k=function(b){return b.id};c=new d.SelectGrid({gridContainer:f,columns:a.columns,selectionCallback:a.selectionCallback,getRowId:a.getRowId||k,dontShiftFocus:a.dontShiftFocus});e=a.messageHandler||d.MessageHandler({baseElement:g(a.baseElement).find(".message-panel")});
i=a.noResultMessage||"\u65e0\u7ed3\u679c\u3002";g.extend(this,{update:function(b,a){e.clearMessages();h&&(h(),j.remove(),h=null);c.clear();if(!b||!b.length){c.hide();var m=g.isFunction(i)?i(a):i;e.displayMessages(m);return!1}c.update(b);c.show();return!0},updateAndSelect:function(b,c,a){this.update(b,c)&&this.selectIndex(a)},prependAndSelect:function(b,a){!b||!b.length?d.debug("ResultGrid.prependAndSelect called with no data, returning."):(e.clearMessages(),c.prependAndSelect(b,
a),c.show())},select:function(b){c.select(b)},selectIndex:function(b){c.selectIndex(b)},clear:function(){e.clearMessages();c.hide()},loading:function(){c.show();var b=f.width(),a=f.height();this.clear();if(!h){var d,e;d=b/2-73;e=a/2-73;j=g("<div></div>").addClass("spinner-container").width(b-d).height(a-e).css({"padding-left":d,"padding-top":e}).insertAfter(f);h=Raphael.spinner(j[0],60,"#666")}},isVisible:function(){return c.isVisible()}})}})});
require("confluence/module-exporter").exportModuleAsGlobal("confluence/result-grid","AJS.ResultGrid");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:breadcrumbs-jquery', location = '/includes/js/breadcrumbs-jquery.js' */
define("confluence/breadcrumbs-jquery",["jquery","confluence/templates"],function(e,h){return function(a){var i=this,f=[],b=0,c=a.length-1,d=a[b],j=i.closest(".breadcrumbs-container").width(),g=function(){return i.width()<j};for(f.push(h.Dialog.breadcrumbItem({text:d.title,title:d.title,className:b===c?"last":""}));b++<c;)d=a[b],f.push(h.Dialog.breadcrumbItem({text:d.title,title:d.title,className:b===c?"last":""}));this.html(f.join(""));a=e("li a span",this);a.each(function(a){0!==a&&a!==c&&e(this).shortenUntil(g)});
e(a.get(0)).shortenUntil(g);e(a.get(c)).shortenUntil(g);return this}});require("confluence/module-exporter").exportModuleAsGlobal("confluence/breadcrumbs-jquery","jQuery.fn.renderBreadcrumbs");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:dialog-breadcrumbs', location = '/includes/js/dialog-breadcrumbs.js' */
define("confluence/dialog-breadcrumbs",["ajs","jquery","confluence/meta","confluence/templates"],function(b,d,e,k){var h={},l=function(a,e,f){var g=a.userName?a.userName:a.pageId?a.pageId+":"+a.fileName:a.spaceKey+":"+a.title+":"+a.postingDay+":"+a.fileName;g in h?e(h[g],"success"):d.ajax({type:"GET",dataType:"json",data:a,url:b.contextPath()+"/pages/breadcrumb.action",error:f||function(){},success:function(a,b){if(!a||!a.breadcrumbs)f(a,b);else{for(var c=d.makeArray(a.breadcrumbs);c[0]&&"userinfo"!==
a.type&&/peopledirectory\.action$/.test(c[0].url);)c.shift();"page"===a.type&&(c[1]&&/pages\.action/.test(c[1].url))&&c.splice(1,1);c.type=a.type;h[g]=c;e(c,b)}}})};return{getBreadcrumbsDefault:l,Breadcrumbs:function(a,h){var f=0;return{update:function(g,j){a.html(k.Dialog.breadcrumbLoading());var m=f+=1,c=function(){return m!==f?(b.debug("Breadcrumb response for ",g," is stale, ignoring."),!0):!1};(h||l)(g,function(f,h){if(!c())if("success"!==h||!f)a.html(k.Dialog.breadcrumbError());else{var i=g.spaceKey;
a.renderBreadcrumbs(f);if(!(i=i!==e.get("space-key")))a:{for(i=1;i<f.length;i++)if(f[i].title===e.get("page-title")){i=!1;break a}i=!0}i?(j.clearErrors(),d(j.moveButton).prop("disabled",!1)):(j.error("\u4f60\u4e0d\u80fd\u628a\u4e00\u4e2a\u9875\u9762\u79fb\u52a8\u5230\u81ea\u5df1\u7684\u5b50\u9875\u9762\u4e2d\u3002"),d("li:last-child",a).addClass("warning"))}},function(d){c()||(a.html(k.Dialog.breadcrumbError()),404===d.status&&j.error("\u672a\u53d1\u73b0\u6307\u5b9a\u7684\u9875\u9762\u3002"))})}}},getBreadcrumbsLegacy:function(a,e,f){if(!a.id)throw Error("id is a required parameter in 'options'");
if(!a.type)throw Error("type is a required parameter in 'options'");var g=a.id+":"+a.type;g in h?e(h[g],"success"):d.ajax({type:"GET",dataType:"json",data:a,url:b.contextPath()+b.REST.getBaseUrl()+"breadcrumb",error:f||function(){},success:function(a,b){if(!a||!a.breadcrumbs)f(a,b);else{for(var c=d.makeArray(a.breadcrumbs);c[0]&&"userinfo"!==a.type&&/peopledirectory.action$/.test(c[0].url);)c.shift();c.type=a.type;h[g]=c;e(c,b)}}})}}});
require("confluence/module-exporter").safeRequire("confluence/dialog-breadcrumbs",function(b){var d=require("ajs"),e=require("confluence/legacy");d.toInit(function(){d.MoveDialog||(d.MoveDialog={});d.MoveDialog.Breadcrumbs=b.Breadcrumbs;d.MoveDialog.getBreadcrumbs=b.getBreadcrumbsDefault;d.Breadcrumbs={};d.Breadcrumbs.getBreadcrumbs=b.getBreadcrumbsLegacy;e.Dialogs||(e.Dialogs={});e.Dialogs.Breadcrumbs=d.Breadcrumbs;e.Dialogs.Breadcrumbs.getBreadcrumbs=b.getBreadcrumbsLegacy;e.Dialogs.Breadcrumbs.Controller=
b.Breadcrumbs;e.Dialogs.Breadcrumbs.defaultGetBreadcrumbs=b.getBreadcrumbsDefault})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:dialog-breadcrumbs', location = '/includes/soy/dialog-breadcrumbs.soy' */
// This file was automatically generated from dialog-breadcrumbs.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Dialog.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Dialog == 'undefined') { Confluence.Templates.Dialog = {}; }


Confluence.Templates.Dialog.breadcrumbItem = function(opt_data, opt_ignored) {
  return '<li><a class="' + soy.$$escapeHtml(opt_data.className) + '" title="' + soy.$$escapeHtml(opt_data.title) + '" tabindex="-1"><span>' + soy.$$escapeHtml(opt_data.text) + '</span></a></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Dialog.breadcrumbItem.soyTemplateName = 'Confluence.Templates.Dialog.breadcrumbItem';
}


Confluence.Templates.Dialog.breadcrumbLoading = function(opt_data, opt_ignored) {
  return '<li class="loading"><span>' + soy.$$filterNoAutoescape('\u6b63\u5728\u52a0\u8f7d\u9762\u5305\u5c51\u5bfc\u822a\u2026') + '</span></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Dialog.breadcrumbLoading.soyTemplateName = 'Confluence.Templates.Dialog.breadcrumbLoading';
}


Confluence.Templates.Dialog.breadcrumbError = function(opt_data, opt_ignored) {
  return '<li class="warning last"><span>' + soy.$$escapeHtml('\u83b7\u53d6\u7f29\u7565\u56fe\u65f6\u53d1\u751f\u9519\u8bef\u3002') + '</span></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Dialog.breadcrumbError.soyTemplateName = 'Confluence.Templates.Dialog.breadcrumbError';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:page-location', location = '/includes/js/page-location.js' */
define("confluence/page-location",["ajs","confluence/meta"],function(c,a){var b=null;return{get:function(){return b?b:{spaceName:a.get("space-name"),spaceKey:a.get("space-key"),parentPageTitle:a.get("parent-page-title")}},set:function(a){b=a}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence/page-location","Confluence.PageLocation");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.vendors--8cfcf1af69', location = 'aui.chunk.b6422a117c92075fe82f--7151db9e25015ed358d0.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.vendors--8cfcf1af69"],{iwe4:function(t,e,i){},rNKm:function(t,e,i){var s,a;!function(n,l){void 0===n&&void 0!==window&&(n=window),s=[i("oDIA")],void 0===(a=function(t){return n.FancyFileInput=function(t){"use strict";var e=/^.*[\\\/]/,i=/\{0\}/gi,s=function(){var t=3,e=document.createElement("div"),i=e.getElementsByTagName("i");do{e.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e"}while(i[0]);return t>4?t:document.documentMode}();function a(e,i){var s=t(e).data("FancyFileInput");if(s)return s;i=t.extend({},a.defaults,i),this.el=e,this.$el=t(e),this.$label=this.createLabel(i.buttonText),this._addLabelText(),this.$clearButton=t("<button>",{text:this.$label.attr("data-ffi-clearButtonText")||i.clearButtonText,class:"ffi-clear",type:"button",tabindex:"-1"}),this.multipleFileTextPattern=this.$label.attr("data-ffi-multipleFileTextPattern")||i.multipleFileTextPattern,this._eventNamespace=".ffi",this.CLASSES={disabled:"is-disabled",focused:"is-focused",active:"is-active",valid:"is-valid",invalid:"is-invalid"},this[this.isDisabled()?"disable":"enable"](),this.isFocused=!1}return a.defaults={buttonText:"Browse…",clearButtonText:"Clear",multipleFileTextPattern:"{0} files"},a.prototype._addLabelText=function(){var e=t('label[for="'+this.el.id+'"]');e.length&&this.$el.attr("aria-label",e.text())},a.prototype.createLabel=function(e){var i=this.$el.parent(".ffi[data-ffi-button-text]");return i.length||(i=this.$el.wrap(t("<label>",{class:"ffi","data-ffi-button-text":e})).parent()),i},a.prototype.isDisabled=function(){return this.$el.is(":disabled")},a.prototype.formatMultipleFileText=function(t){return this.multipleFileTextPattern.replace(i,t)},a.prototype.bindEvents=function(){this.$el.on("invalid"+this._eventNamespace,t.proxy(this.checkValidity,this)).on("change"+this._eventNamespace,t.proxy(this.change,this)).on("keydown"+this._eventNamespace,t.proxy(this.keydown,this)).on("mousedown"+this._eventNamespace,t.proxy(this.mousedown,this)).on("mouseup"+this._eventNamespace,t.proxy(this.mouseup,this)).on("focus"+this._eventNamespace,t.proxy(this.focus,this)).on("blur"+this._eventNamespace,t.proxy(this.blur,this)),this.$clearButton.on("click"+this._eventNamespace,t.proxy(this.clear,this))},a.prototype.unbindEvents=function(){this.$el.off(this._eventNamespace),this.$clearButton.off(this._eventNamespace)},a.prototype.fireEvent=function(t){this.$el.trigger(t+this._eventNamespace)},a.prototype.enable=function(){this.bindEvents(),this.$el.prop("disabled",!1),this.$label.removeClass(this.CLASSES.disabled)},a.prototype.disable=function(){this.unbindEvents(),this.$el.prop("disabled",!0),this.$label.addClass(this.CLASSES.disabled)},a.prototype.clear=function(){return this.$el.wrap("<form>").closest("form").get(0).reset(),this.$el.unwrap(),this.el.value="",this.change(),!1},a.prototype.focus=function(){var t=this;this.$label.addClass(this.CLASSES.focused),s&&!this.isFocused&&(this.isFocused=!0,setTimeout(function(){t.$el.blur(),t.$el.focus()},0))},a.prototype.blur=function(){s&&this.isFocused||(this.$label.removeClass(this.CLASSES.focused),this.isFocused=!1)},a.prototype.mousedown=function(){this.$label.addClass(this.CLASSES.active)},a.prototype.mouseup=function(){this.$label.removeClass(this.CLASSES.active)},a.prototype.keydown=function(t){var e=t.which;if(8!==e&&46!==e||(this.clear(),t.preventDefault()),s&&9===e){var i=this;this.isFocused=!1,this.$el.prop("disabled",!0),setTimeout(function(){i.$el.prop("disabled",!1).blur()},0)}},a.prototype.checkValidity=function(){if(this.el.required){var t=this.$el.is(":invalid");this.$label.toggleClass(this.CLASSES.invalid,t).toggleClass(this.CLASSES.valid,!t)}},a.prototype.change=function(){var t,i="";this.checkValidity(),(t=this.el.multiple&&this.el.files.length>1?this.formatMultipleFileText(this.el.files.length):this.el.value).length?(i=t.replace(e,""),this.$clearButton.appendTo(this.$label)):this.$clearButton.detach(),this.$el.focus(),this.setFieldText(i),this.fireEvent("value-changed")},a.prototype.setFieldText=function(t){t.length?(this.$label.attr("data-ffi-value",t),this.fireEvent("value-added")):(this.$label.removeAttr("data-ffi-value"),this.fireEvent("value-cleared"))},t.fn.fancyFileInput=function(e){return this.each(function(){var i=new a(this,e);t(this).data("FancyFileInput",i)})},a}(t)}.apply(e,s))||(t.exports=a)}(this)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.component.form.file-select', location = 'aui.chunk.aa820132785b66ccb06a--6e3ed38325acf1030d9c.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.component.form.file-select"],{"7hWp":function(e,u,i){"use strict";Object.defineProperty(u,"__esModule",{value:!0}),u.FancyFileInput=void 0;var t=i("tyi3");Object.defineProperty(u,"FancyFileInput",{enumerable:!0,get:function(){return function(e){return e&&e.__esModule?e:{default:e}}(t).default}}),i("6fSn"),i("iwe4"),i("zXI7")},tyi3:function(e,u,i){"use strict";Object.defineProperty(u,"__esModule",{value:!0});var t=function(e){return e&&e.__esModule?e:{default:e}}(i("rNKm"));u.default=t.default,e.exports=u.default},zXI7:function(e,u,i){}},[["7hWp","runtime","aui.splitchunk.vendors--8cfcf1af69","aui.splitchunk.172ffb6da7","aui.splitchunk.b0831cc7d0","aui.splitchunk.572a8bf5cd","aui.splitchunk.d49cf794d2","aui.splitchunk.336ae4f9e7","aui.splitchunk.fb15cffa72","aui.splitchunk.56dfb54d0c","aui.splitchunk.908fe798b4","aui.splitchunk.462ee5f9ef","aui.splitchunk.50dca3e042"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-object.js' */
define("confluence-link-browser/link-object",["jquery","ajs","confluence/legacy"],function(c,g,m){function j(a){return c.nodeName(a,"img")?a:a.hasChildNodes()&&1===a.childNodes.length&&c.nodeName(a,"a")&&c.nodeName(a.firstChild,"img")?a.firstChild:null}function k(a){return!a?"":c(a).attr("data-linked-resource-default-alias")||c(a).attr("src")}function l(a){var b={};"A"===a.nodeName&&c(a.attributes).each(function(){b[this.name]=this.value});return b}function i(a,b){for(var c=a;c&&c!=b;){if(3!=c.nodeType)return!1;
c=c.nextSibling}return 3===b.nodeType}var e={isLink:function(a){return a&&!!a.fillNode}},f=function(a){if(e.isLink(a))return a;var b={insert:function(){return m.Editor.LinkAdapter.setLink(b)},fillNode:function(a){var b=this.attrs;b.href=b.href||"#";a.attr(b);this.classes&&this.classes.length&&a.addClass(this.classes.join(" "));a.html(this.body.html);return a},getData:function(){var a={},b;for(b in this)this.hasOwnProperty(b)&&!c.isFunction(this[b])&&(a[b]=this[b]);return a},getLinkedImage:function(){return this.body&&
this.body.jquery?1===this.body.length&&this.body.is("img")&&this.body:null},getResourceId:function(){return this.attrs["data-linked-resource-id"]||""},getResourceVersion:function(){return this.attrs["data-linked-resource-version"]||""},isToConfluenceEntity:function(){return this.attrs["data-linked-resource-id"]},isToAttachmentOnSamePage:function(a){return"attachment"==this.attrs["data-linked-resource-type"]&&this.attrs["data-linked-resource-container-id"]==a},isCustomAtlassianContentLink:function(){return this.classes&&
this.classes.length?-1!=c.inArray("confluence-link",this.classes):!1},hasAnchor:function(){return this.attrs["data-anchor"]},getResourceType:function(){return this.attrs["data-linked-resource-type"]},getDefaultAlias:function(){return this.attrs["data-linked-resource-default-alias"]},getHref:function(){return this.attrs.href},getAnchor:function(){return this.attrs["data-anchor"]},getHtml:function(){return this.body.html},getShortcut:function(){return this.attrs["data-linked-resource-shortcut"]},isHrefValid:function(){return this.attrs.href&&
"http://"!=this.attrs.href},isImage:function(){return this.body.isImage},isNewLink:function(){return c.isEmptyObject(this.attrs)},isShortcutLink:function(){return"shortcut"===this.getResourceType()},isExternalLink:function(){return!this.isCustomAtlassianContentLink()},showsBreadcrumbs:function(){return!0},getTarget:function(){return this.attrs.target},setTarget:function(a){a?this.attrs.target=a:this.removeTarget()},removeTarget:function(){this.attrs&&this.attrs.target&&delete this.attrs.target}};
if(a&&a.attrs){var f={},h=null;c.each(a.attrs,function(a,b){"class"==a?h=b:f[a]=b});a.attrs=f;if(h){var d=h.split(" ");a.classes=a.classes&&a.classes.length?a.classes.concat(d):d}}c.extend(b,a);return b};e.fromData=function(a){return f(a)};e.fromNode=function(a,b){f({attrs:{},body:{html:b,text:b}});return f({attrs:l(a),body:{html:b,text:b}})};e.fromSelectedAnchor=function(a,b){var e=c(a),h=j(a),d=!h&&i(a.firstChild,a.lastChild);return f({attrs:l(a),body:{isEditable:d,isImage:!!h,html:e.html(),imgName:k(h),
text:b}})};e.fromSelection=function(a,b,c,e){var b=j(b),d;if(d=!b)if(a.collapsed)d=!0;else if(d=a.startContainer,d==a.endContainer)d=3===d.nodeType?!0:i(d.childNodes[a.startOffset],d.childNodes[a.endOffset-1]);else{var g=require("tinymce").activeEditor.dom;d=g.isBlock(a.startContainer)?a.startContainer.childNodes[a.startOffset]:a.startContainer;a=g.isBlock(a.endContainer)?a.endContainer.childNodes[a.endOffset-1]:a.endContainer;a=d&&a&&d.parentNode==a.parentNode?{start:d,end:a}:null;d=!!a&&i(a.start,
a.end)}return f({attrs:{},body:{isEditable:d,isImage:!!b,html:c,imgName:k(b),text:e}})};e.fromREST=function(a){var b=f({attrs:{"data-base-url":g.Confluence.getBaseUrl(),"data-linked-resource-id":a.id,"data-linked-resource-type":a.type,"data-linked-resource-content-type":a.contentType,href:g.REST.findLink(a.link),"data-linked-resource-default-alias":a.title},body:{html:g.escapeHtml(a.title),text:g.escapeHtml(a.title)},classes:["confluence-link"]});"user"===a.type&&(b.attrs["data-linked-resource-type"]=
"userinfo");return b};e.createLinkToNewPage=function(a,b){return f({attrs:{"data-space-key":b,"data-content-title":a,href:g.contextPath()+"/pages/createpage.action?spaceKey="+b+"&title="+a},body:{html:g.escapeEntities(a),text:a},classes:["createlink","confluence-link"]})};e.makeExternalLink=function(a){return f({attrs:{href:a},body:{html:a,text:a}})};e.isExternalLink=function(a){return a&&(a.match(/^(\/\/|mailto:|file:|http:|https:)/)||0===a.indexOf("\\"))};return e});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-link-browser/link-object","Confluence.Link");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-adapter.js' */
define("confluence-link-browser/link-adapter",["ajs","jquery","confluence/legacy","tinymce"],function(d,e,f,h){return{setLink:function(a){var b=d.Rte.getEditor(),b=e(b.dom.create("a"),b.getDoc());a.fillNode(b);a=h.confluence.NodeUtils.replaceSelection(b);e("#comments-section").length&&d.Rte.fixEditorFocus();return a},getLink:function(){var a,b,c;a=d.Rte.getEditor().selection;var g=a.getNode();if(c=e(g).parents().andSelf().filter("a[href]")[0])return a.select(c),b=a.getContent({format:"text"}),f.Link.fromSelectedAnchor(c,
b);c=a.getRng(!0);b=a.getContent({format:"text"});a=a.getContent();return f.Link.fromSelection(c,g,a,b)}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-link-browser/link-adapter","Confluence.Editor.LinkAdapter");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser.js' */
define("confluence-link-browser/link-browser",["ajs","confluence/legacy","jquery"],function(b,o,h){function r(){if(!f.prop("disabled")){f.prop("disabled",!0);b.debug("link-browser.js: submit");i.preSubmit&&i.preSubmit();var a=c.getLink();b.DarkFeatures.isEnabled(s)||a.removeTarget();n();a.insert();b.trigger("closed.link-browser")}}function n(){k.hide().remove();b.Rte.BookmarkManager.restoreBookmark()}function p(){n();b.trigger("closed.link-browser")}function t(a,f,l){var d=f.key,f=f.label,e=d+"-panel",
g=o.Templates.LinkBrowser[d+"Panel"]({atlToken:b.Meta.get("atl-token")});k.addPanel(f,g,e,e+"-id");var a=k.get("panel:"+a),j=l.tabs[d];j.panelObj=a;j.key=d;j.createPanel({baseElement:h(a[0].body)});a[0].onblur=j.onDeselect;a[0].onselect=function(){var a=!!j.hasBreadcrumbs;b.debug("Link Browser: on tab select, breadcrumbs enabled: "+a);j.onSelect();c.refresh(a);i=j};return j}var s="link.openInNewWindow",k,c,f,i;return{SEARCH_PANEL:"search",ATTACHMENTS_PANEL:"attachments",WEBLINK_PANEL:"weblink",ADVANCED_PANEL:"advanced",
open:function(a){h(function(){h('.ffi input[type="file"]#file_0').fancyFileInput()});if(h(".aui-dialog:visible").length)return null;a=a||{};b.Rte.BookmarkManager.storeBookmark();a.linkInfo=a.linkInfo||o.Editor.LinkAdapter.getLink();if(a.opener)return a.opener(a.linkInfo.alias,a.linkInfo);var q=a,a={OPEN_IN_NEW_WINDOW_DARK_FEATURE:s,tabs:{},setLink:function(u,a){c.setLink(u,a)},getLink:function(){return c.getLink()},getSelectedDataTableItem:function(){return h(".data-table:visible tr.selected")},linkValid:function(a){f.prop("disabled",
!a)},focusLinkText:function(){c.focusLinkText()||(b.debug("LinkBrowser: focusing submit button"),f.focus())},getLinkText:function(){return c.getLinkText()},isLinkTextVisible:function(){return c.isLinkTextVisible()},isNewWindowCheckboxVisible:function(){return c.isNewWindowCheckboxVisible()},hasBreadcrumbs:function(a){return c.hasBreadcrumbs(a)},getLocationPresenter:function(){return c},doSearch:function(a){this.tabs.search.doSearch(a)},getSearchTextField:function(){return this.tabs.search.getSearchTextField()},
moveLocationPanel:function(a){c.moveLocationPanel(a)},restoreLocationPanel:function(){c.restoreLocationPanel()},gotoPanel:function(a){this.popup.gotoPanel(a)},getCurrentPanel:function(){return this.popup.getCurrentPanel()},setWebLinkURL:function(a){var c=this.tabs.weblink;i!=c?b.debug("Cannot set URL "+a+" on hidden Web Link panel"):c.setURL(a)},getWebLinkUrl:function(){var a=this.tabs.weblink;return i!=a?(b.debug("Cannot get URL on hidden Web Link panel"),null):a.getURL()},getTitle:function(){return this.popup.getTitle()},
getSubmitButtonText:function(){return f.text()},isSubmitButtonEnabled:function(){return f.is(":enabled")},isVisible:function(){return this.popup.isVisible()},showOpenInNewWindowCheckbox:function(a){return c.showOpenInNewWindowCheckbox(a)},getAdvancedTextField:function(){var a=this.tabs.advanced;return i!=a?(b.debug("Cannot get link text on hidden advanced panel"),null):a.getLink()},setAdvancedTextField:function(a){var c=this.tabs.advanced;i!=c?b.debug("Cannot set link text on hidden advanced panel"):
c.setLink(a)},submit:r,cancel:p},l=q.linkInfo,d=l.isNewLink(),e,g;e=new b.ConfluenceDialog({width:840,height:590,id:"insert-link-dialog",onCancel:p,onSubmit:r});g=d?"\u63d2\u5165\u94fe\u63a5":"\u7f16\u8f91\u94fe\u63a5";d=d?"\u63d2\u5165":"\u4fdd\u5b58";e.addHeader(g);e.addButton(d,r);e.addCancel("\u53d6\u6d88",p);e.addHelpText("\u63d0\u793a: \u5728\u7f16\u8f91\u5668\u4e2d\u8f93\u5165 \u0022[\u0022\u540e\uff0c\u51fa\u73b0\u5efa\u8bae\u7684\u9875\u9762\uff0c\u7136\u540e\u63d2\u5165\u94fe\u63a5\u3002");g=h("#insert-link-dialog .dialog-tip");
g.attr("title",g.text());h("#insert-link-dialog .dialog-components .dialog-title").prepend(o.Templates.LinkBrowser.helpLink());f=e.get("button:0")[0].item;f.attr("id","link-browser-insert");f.prop("disabled",!0);k=e;a.popup=k;b.trigger("dialog-created.link-browser",[a]);c=o.Editor.LinkBrowser.LinkInfoPresenter(a);c.setLinkBody(l.body);q=q.panelKey;e=h("#link-browser-tab-items").find("div").map(function(){var a=h(this);return{key:a.text(),weight:a.attr("data-weight"),label:this.title}}).sort(function(a,
b){return a.weight-b.weight});var j="template"!==b.Meta.get("content-type");e=h.grep(e,function(a){return j||"attachments"!==a.key});var n;g=null;for(var d=0,v=e.length;d<v;d++){var m=t(d,e[d],a);0===d&&(n=m);!l.isNewLink()&&h.isFunction(m.handlesLink)&&m.handlesLink(l)?(g=m,m.openedLink=l):q==m.key&&(g=m)}g?a.popup.overrideLastTab():g=n;i=g;k.popup.element.find(".dialog-page-body:first").append(c.getContainer());i.panelObj.select();i.openedLink=null;k.show();b.trigger("dialog-shown.link-browser",
k);return a},cancel:p}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-link-browser/link-browser","Confluence.Editor.LinkBrowser");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-location.js' */
define("confluence-link-browser/link-browser-location",["jquery","confluence/legacy","ajs","confluence/dialog-breadcrumbs"],function(k,B,i,s){return function(t){function m(){return i.escapeHtml(u())}function u(){return b.val()}function v(a){j.closest(".row").toggleClass("hidden",!a);e.toggleClass("has-breadcrumbs",!!a)}function w(a){var c=a.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/),a=c[2],d=c[3],f=c[5],e=c[7],c=c[9],b="";a&&(b=a.toLowerCase()+":");d&&(b+=d);b+=n(f);e&&(b+=
"?"+n(e));c&&(b+="#"+n(c));return b}function n(a){var c={"'":"%27","\\[":"%5B","\\]":"%5D","`":"%60","\\\\":"%5C"},d;for(d in c)c.hasOwnProperty(d)&&(a=a.replace(RegExp(d,"g"),c[d]));return a}function x(){return b.is(":visible")}function y(a,c){i.trigger("analyticsEvent",{name:a,data:{resourceType:c.getResourceType(),isExternal:c.isExternalLink()}})}var e,j,o,f,g,b,p,z,A,q,l,r,h;e=k(B.Templates.LinkBrowser.locationPanel());j=e.find("#breadcrumbs-container");o=s.Breadcrumbs(j,s.getBreadcrumbsLegacy);
g=e.find("#link-open-in-new-window");z=e.find(".link-image");A=e.find(".link-mixed");l=e.find("#link-image-filename");q=e.find("#link-mixed-content");p=e.find(".link-text");b=p.find("input");b.change(function(a){a.keyCode=a.keyCode||a.which;a.keyCode&&13!==a.keyCode&&b.removeClass("default-alias")});g.change(function(){g.prop("checked")?("attachment"!==f.getResourceType()&&f.setTarget("_blank"),y("editor.linkBrowser.location.openInNewWindow.checked",f)):(f.removeTarget(),y("editor.linkBrowser.location.openInNewWindow.unchecked",
f))});return{setLink:function(a,c){i.debug("Link Browser: setting link : "+a);var d=a.attrs["data-linked-resource-default-alias"]||a.getHtml();if(""===m()||b.hasClass("default-alias"))b.addClass("default-alias"),b.val(d);if(c&&a.getResourceId()&&a.getResourceType()){var e={clearErrors:function(){},error:function(){},select:function(a){o.update(a,e)}},d={id:a.getResourceId(),type:a.getResourceType()};o.update(d,e)}v(c);i.DarkFeatures.isEnabled(t.OPEN_IN_NEW_WINDOW_DARK_FEATURE)?(g.prop("checked")&&
a.setTarget("_blank"),g.prop("checked","_blank"===a.getTarget())):a.removeTarget();f=a;t.linkValid(f&&f.isHrefValid())},getLink:function(){if(!f)return null;var a=r;a||((a=m())||(a=f.getDefaultAlias()||f.getHref()),a={html:a});f.body=a;f.attrs.href=w(f.attrs.href);return f},refresh:function(a){f&&v(a)},setLinkBody:function(a){r||(a.isEditable?b.val(a.text):a.isImage?l.text(a.imgName):q.text(a.text),r=a.isEditable?null:a,p.toggleClass("hidden",!a.isEditable),z.toggleClass("hidden",!a.isImage),A.toggleClass("hidden",
a.isEditable||a.isImage))},getContainer:function(){return e},isLinkTextVisible:x,isLinkImageVisible:function(){return l.is(":visible")},isNewWindowCheckboxVisible:function(){return g.is(":visible")},isNewWindowCheckboxChecked:function(){return g.prop("checked")},isLinkMixedContentVisible:function(){return q.is(":visible")},focusLinkText:function(){return x()?(i.debug("LinkInfoPresenter.focusLinkText focusing alias"),b.select(),!0):!1},getLinkText:m,getRawLinkText:u,getLinkImageName:function(){return l.text()},
moveLocationPanel:function(a){h||(h=e.find(".row:not(.hidden) .field-group"),h.each(function(a,d){k(d).data("original-parent",k(d).parent())}));h.appendTo(a);e.hide()},restoreLocationPanel:function(){h&&h.each(function(a,c){var d=k(c);d.data("original-parent")&&(d.appendTo(d.data("original-parent")),d.removeData("original-parent"))});e.show();h=null},hasBreadcrumbs:function(a){if(!j.is(":visible"))return!1;var c=a.length,d=j.find("li");if(d.length!==c)return!1;for(var b=0;b<c;b++)if(d.eq(b).text()!==
a[b])return!1;return!0},showOpenInNewWindowCheckbox:function(a){g.closest(".row").toggleClass("hidden",!a)},encodeURLSafely:w}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-link-browser/link-browser-location","Confluence.Editor.LinkBrowser.LinkInfoPresenter");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-search.js' */
define("confluence-link-browser/link-browser-tab-search",["jquery","ajs","document","confluence/legacy","confluence/page-location"],function(d,b,n,i,o){return{dialogCreatedLinkBrowserSearch:function(n,j){var c,e,f,m,p=b.REST.getBaseUrl()+"search.json",k=function(a,b){i.Link.isLink(a)||(a=i.Link.fromREST(a));b&&c.val(a.attrs["data-linked-resource-default-alias"]);j.setLink(a,!0);j.focusLinkText()},l=function(a){b.debug("link-browser-tab-search.js: doing search");c.trigger("hide.autocomplete");var g=
d.trim(c.val());g?(f.loading(),b.getJSONWrap({url:p,data:{search:"site",query:g,spaceKey:e.val()},successCallback:function(b){d.isFunction(a)?(f.update(b.result),a()):f.updateAndSelect(b.result);c.trigger("hide.autocomplete")},messageHandler:m})):d.isFunction(a)&&a()};j.tabs.search={hasBreadcrumbs:!0,createPanel:function(a){var g=a.baseElement;c=g.find("#link-search-text");e=g.find("#search-panel-space");var h=o.get();e.find("option:eq(1)").text(h.spaceName).val(h.spaceKey);e.change(function(){c.attr("data-spacekey",
e.val());c.trigger("clearCache.autocomplete")});i.Binder.autocompleteSearch(c.parent());c.bind("selected.autocomplete-content",function(a,b){b.searchFor?l():(f.clear(),k(b.content,!1))});h=[b.SelectGrid.Column({key:"title",heading:"\u6807\u9898",getHref:function(a){return b.REST.findLink(a.link)},getInnerClass:function(a){return a.iconClass||"content-type-"+a.type}}),b.SelectGrid.Column({key:"space",heading:"\u7a7a\u95f4",getText:function(a){return a.space&&
a.space.title||""}}),b.SelectGrid.Column({key:"last-modified",heading:"\u6700\u8fd1\u4fee\u6539\u8fc7",getText:function(a){return a.lastModifiedDate&&a.lastModifiedDate.friendly||""},getTitle:function(a){return a.lastModifiedDate&&a.lastModifiedDate.date||""}})];m=b.MessageHandler({baseElement:a.baseElement.find(".message-panel")});f=new b.ResultGrid({baseElement:a.baseElement,columns:h,selectionCallback:function(a,b){k(b)},noResultMessage:"\u65e0\u641c\u7d22\u7ed3\u679c\u3002",
dontShiftFocus:function(){return d(c).add(e).is(":focus")}});g.find(".search-form").submit(function(){l();return!1}).keydown(function(a){13===a.keyCode&&!d(".aui-dropdown:visible .active",this).length&&(d("#search-panel-button").focus(),a.stopPropagation())})},onSelect:function(){b.debug("Link Browser Search panel selected");var a=this.openedLink;a?(b.debug("Link Browser Search panel setting link info"),k(a,!0)):c.focus()},handlesLink:function(a){return a.isCustomAtlassianContentLink()&&!a.hasAnchor()&&
!a.isShortcutLink()&&!a.isToAttachmentOnSamePage(b.Meta.get("content-id"))},doSearch:function(a,b){c.val(a);l(b)},isResultGridVisible:function(){return f.isVisible()},getSearchTextField:function(){return c}}}}});require("confluence/module-exporter").safeRequire("confluence-link-browser/link-browser-tab-search",function(d){require("ajs").bind("dialog-created.link-browser",d.dialogCreatedLinkBrowserSearch)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-history.js' */
define("confluence-link-browser/link-browser-tab-history",["ajs","confluence/legacy"],function(a,h){return{dialogCreatedLinkBrowserHistory:function(i,d){var e=a.REST.makeUrl("session/history.json?max-results=20"),f,g;d.tabs.recentlyviewed={createPanel:function(c){var e=[a.SelectGrid.Column({key:"title",heading:"\u6807\u9898",getHref:function(b){return a.REST.findLink(b.link)},getInnerClass:function(b){return b.iconClass||"content-type-"+b.type}}),a.SelectGrid.Column({key:"space",
heading:"\u7a7a\u95f4",getText:function(b){return b.space&&b.space.title||""}}),a.SelectGrid.Column({key:"last-modified",heading:"\u6700\u8fd1\u4fee\u6539\u8fc7",getText:function(b){return b.lastModifiedDate&&b.lastModifiedDate.friendly||""},getTitle:function(b){return b.lastModifiedDate&&b.lastModifiedDate.date||""}})];g=a.MessageHandler({baseElement:c.baseElement.find(".message-panel")});f=new a.ResultGrid({baseElement:c.baseElement,
columns:e,getRowId:function(b){return b.attachmentId},selectionCallback:function(b,a){var c=h.Link.fromREST(a);d.setLink(c);d.focusLinkText()},messageHandler:g,noResultMessage:"\u6ca1\u6709\u6700\u8fd1\u6d4f\u89c8\u8fc7\u7684\u5185\u5bb9\u3002"})},onSelect:function(){f.loading();a.getJSONWrap({url:e,messageHandler:g,successCallback:function(c){f.update(c.content);a.trigger("updated.link-browser-recently-viewed")}})}}}}});
require("confluence/module-exporter").safeRequire("confluence-link-browser/link-browser-tab-history",function(a){require("ajs").bind("dialog-created.link-browser",a.dialogCreatedLinkBrowserHistory)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-attachment.js' */
define("confluence-link-browser/link-browser-tab-attachment",["jquery","ajs","confluence/legacy"],function(h,a,j){return{dialogCreatedLinkBrowserAttachment:function(m,i){var f=a.REST.makeUrl("content/"+a.Meta.get("attachment-source-content-id")+"/attachments.json"),g,k,l,d;i.tabs.attachments={hasBreadcrumbs:!1,createPanel:function(b,c){var e=b.baseElement.find(".attach-file-form");g=h.extend({getUploaderController:function(){return j.AttachmentUploader({baseElement:e},function(){return{onUploadSuccess:function(a){for(var b=
0,c=a.length;b<c;b++)a[b].type="attachment";d.prependAndSelect(a)}}})}},c&&c(b));k=g.getUploaderController(b);l=k.getMessageHandler();var f=[a.SelectGrid.Column({key:"title",heading:"\u540d\u79f0",getHref:function(b){return b.link?a.REST.findLink(b.link):b.url},getInnerClass:function(a){return a.iconClass}}),a.SelectGrid.Column({key:"size",heading:"\u5927\u5c0f",getText:function(a){return a.niceFileSize}}),a.SelectGrid.Column({key:"comment",
heading:"\u5907\u6ce8"})];d=new a.ResultGrid({baseElement:b.baseElement,columns:f,selectionCallback:function(b,c){var d=j.Link.fromREST(c);d.attrs["data-linked-resource-container-id"]=a.Meta.get("content-id");if(h.isArray(c.link))for(var e=0,f=c.link.length;e<f;e++){var g=c.link[e];"download"===g.rel&&(d.attrs.href=g.href)}i.setLink(d);i.focusLinkText()},noResultMessage:"\u6b64\u9875\u6ca1\u6709\u4efb\u4f55\u6587\u4ef6\u3002"})},onSelect:function(){var b=this.openedLink,c=i.getLink();
d.loading();a.getJSONWrap({url:f,messageHandler:l,successCallback:function(e){d.update(e.attachment);c?"attachment"==c.getResourceType()&&d.select(c.getResourceId()):b?d.select(b.getResourceId()):e.attachment.length&&d.select(e.attachment[0].id);a.debug("Loaded attachments")}})},handlesLink:function(b){return b.isToAttachmentOnSamePage(a.Meta.get("content-id"))}}}}});
require("confluence/module-exporter").safeRequire("confluence-link-browser/link-browser-tab-attachment",function(h){var a=require("ajs");"template"!==a.Meta.get("content-type")&&a.bind("dialog-created.link-browser",h.dialogCreatedLinkBrowserAttachment)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-weblink.js' */
define("confluence-link-browser/link-browser-tab-weblink",["ajs","jquery","confluence/legacy"],function(d,k,h){return{dialogCreatedLinkBrowserWeblink:function(n,c){function e(){return k.trim(b.val())}function f(){var a=e();if(!(d.Validate.url(a)||0===a.indexOf("mailto:"))){if(d.Validate.email(a))a="mailto:"+a;else{if(l.test(a))return;a="http://"+a}d.debug("Updating Link Browser Web Link URL to: "+a);b.val(a);a=h.Link.makeExternalLink(a);c.setLink(a)}}function i(){var a=e();(a=a?h.Link.makeExternalLink(a):
null)&&c.setLink(a)}function m(){f();i()}var b,g,j,l=/[:/]/;j=c.tabs.weblink={createPanel:function(a){g=a.baseElement;b=g.find("input[name='destination']");b.keyup(function(){i()});b.change(f);b.bind("paste",function(){d.debug("Link Browser web link url pasted");setTimeout(m,0)})},onSelect:function(){d.DarkFeatures.isEnabled(c.OPEN_IN_NEW_WINDOW_DARK_FEATURE)&&c.showOpenInNewWindowCheckbox(!0);c.moveLocationPanel(g.find("form:first"));this.openedLink&&(j.setURL(this.openedLink.attrs.href),c.setLink(this.openedLink));
setTimeout(function(){b.focus()})},onDeselect:function(){c.restoreLocationPanel();c.showOpenInNewWindowCheckbox(!1)},preSubmit:f,handlesLink:function(a){return!a.isCustomAtlassianContentLink()},setURL:function(a){b.val(a);b.keyup();b.change()},getURL:e}}}});require("confluence/module-exporter").safeRequire("confluence-link-browser/link-browser-tab-weblink",function(d){require("ajs").bind("dialog-created.link-browser",d.dialogCreatedLinkBrowserWeblink)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-advanced.js' */
define("confluence-link-browser/link-browser-tab-advanced",["jquery","ajs","confluence/legacy","confluence/api/constants"],function(g,e,k,l){return{dialogCreatedLinkBrowserAdvanced:function(o,d){var c,f,h,j,m=function(b){b=g(b);if(b.length){var a=b.find("a:first");a.length?a.hasClass("unresolved")?(b=a.attr("shortcut-key"),a=a.attr("data-space-key"),b?f.text(e.format("{0} \u662f\u4e0d\u80fd\u8bc6\u522b\u7684\u5feb\u6377\u952e",b)):a&&f.text(e.format("{0} \u662f\u4e0d\u80fd\u8bc6\u522b\u7684\u7a7a\u95f4",a))):
(b=k.Link.fromNode(a[0],c.val()),d.setLink(b)):f.text("\u65e0\u6548\u7684\u94fe\u63a5\u6807\u8bb0")}},n=function(b,a,c){e.debug("Error during conversion: textStatus = "+a+", errorThrown = "+c);f.text("\u53d1\u751f\u5185\u90e8\u670d\u52a1\u5668\u9519\u8bef")},i=d.tabs.advanced={createPanel:function(b){h=b.baseElement;c=h.find("input[name='advanced-link']");f=h.find("div[name='advanced-error']");h.find("form").keydown(function(a){13===a.keyCode&&!d.isSubmitButtonEnabled()&&a.preventDefault()});
c.keyup(function(){clearTimeout(j);f.text("");c.val()&&(j=setTimeout(function(){var a=c.val(),a=a.replace(/\[/g,"\\[").replace(/]/g,"\\]"),a={wiki:"["+a+"]",entityId:e.Meta.get("content-id"),spaceKey:e.Meta.get("space-key")};g.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:l.CONTEXT_PATH+"/rest/tinymce/1/wikixhtmlconverter",data:g.toJSON(a),dataType:"text",success:m,error:n,timeout:1E4})},200))})},setLink:function(b){c.val(b);c.keyup();c.change()},getLink:function(){return c.val()},
onSelect:function(){e.DarkFeatures.isEnabled(d.OPEN_IN_NEW_WINDOW_DARK_FEATURE)&&d.showOpenInNewWindowCheckbox(!0);d.moveLocationPanel(h.find("form:first"));this.openedLink&&(this.openedLink.isShortcutLink()?i.setLink(this.openedLink.getShortcut()):this.openedLink.getResourceId()?i.setLink(this.openedLink.getDefaultAlias()):i.setLink("#"+this.openedLink.getAnchor()),d.setLink(this.openedLink));setTimeout(function(){c.focus()})},onDeselect:function(){d.restoreLocationPanel();d.showOpenInNewWindowCheckbox(!1)},
handlesLink:function(b){return b.isShortcutLink()||b.hasAnchor()}}}}});require("confluence/module-exporter").safeRequire("confluence-link-browser/link-browser-tab-advanced",function(g){require("ajs").bind("dialog-created.link-browser",g.dialogCreatedLinkBrowserAdvanced)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'templates/link-browser.soy' */
// This file was automatically generated from link-browser.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.LinkBrowser.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.LinkBrowser == 'undefined') { Confluence.Templates.LinkBrowser = {}; }


Confluence.Templates.LinkBrowser.searchPanel = function(opt_data, opt_ignored) {
  return '<form class="aui search-form" onsubmit="return false;"><fieldset class="inline"><div class="search-input"><label for="link-search-text" id="linkSearch-label" class="assistive">' + soy.$$escapeHtml('\u641c\u7d22') + '</label><input id="link-search-text" type="text" tabindex="0" class="text autocomplete-search" name="linkSearch" autocomplete="off" data-search-link-message="' + soy.$$escapeHtml('\u641c\u7d22\x26lsquo;{0}\x26rsquo;') + '"></div><select tabindex="0" class="search-space select" id="search-panel-space"><option value="">' + soy.$$escapeHtml('\u5168\u90e8\u5185\u5bb9') + '</option><option value=""> </option></select><button type="submit" tabindex="0" class="aui-button" id="search-panel-button">' + soy.$$escapeHtml('\u641c\u7d22') + '</button></fieldset></form><div class="message-panel hidden"></div><div id="search-results-table" class="data-table hidden"></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.searchPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.searchPanel';
}


Confluence.Templates.LinkBrowser.recentlyviewedPanel = function(opt_data, opt_ignored) {
  return '<div class="recently-viewed-panel"><div class="message-panel hidden"></div><div class="data-table"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.recentlyviewedPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.recentlyviewedPanel';
}


Confluence.Templates.LinkBrowser.attachmentsPanel = function(opt_data, opt_ignored) {
  return '<div class="attach-file-form"><form method="post" enctype="multipart/form-data" id="attachments-attachfile-form" action="' + soy.$$escapeHtml("") + '/pages/attachfile.action" class="aui"><p>' + soy.$$escapeHtml('\u94fe\u63a5\u5230\u672c\u9875\u9762\u7684\u9644\u4ef6\uff0c\u6216\u9644\u52a0\u4e00\u4e2a\u65b0\u7684\u9644\u4ef6\u3002') + '</p><div class="upload-field field-group"><label for="file_0">' + soy.$$escapeHtml('\u4e0a\u4f20\u6587\u4ef6') + '</label><label id="fancy-file-upload" class="ffi" data-ffi-button-text="Browse"><input type="file" name="file_0" id="file_0"></label><input type="hidden" name="minorEdit_0" value="true"></div><input type="hidden" name="atl_token" value="' + soy.$$escapeHtml(opt_data.atlToken) + '" /></form><div class="upload-in-progress upload-field hidden">' + soy.$$escapeHtml('\u6b63\u5728\u4e0a\u4f20\u2026') + '</div><div class="warning"><ul class="hidden message-panel"></ul></div></div><div class="message-panel hidden"></div><div id="attachments-table" class="attachment-list data-table"></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.attachmentsPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.attachmentsPanel';
}


Confluence.Templates.LinkBrowser.weblinkPanel = function(opt_data, opt_ignored) {
  return '<form class="aui" onsubmit="return false;"><div class="field-group"><label id="destination-label" for="weblink-destination">' + soy.$$escapeHtml('\u5730\u5740') + '</label><input type="text" tabindex="0" class="text" id="weblink-destination" name="destination"><div class="web-link-desc description">' + soy.$$escapeHtml('Web\u3001email \u6216\u5176\u4ed6\u4e92\u8054\u7f51\u5730\u5740') + '</div></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.weblinkPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.weblinkPanel';
}


Confluence.Templates.LinkBrowser.advancedPanel = function(opt_data, opt_ignored) {
  return '<form class="aui" onsubmit="return false;"><div class="advanced-desc title">' + soy.$$filterNoAutoescape(AJS.format('\u8fd9\u91cc\u60a8\u53ef\u4ee5\u4f7f\u7528 \x3ca href\x3d\x22{0}\x22 target\x3d\x22_blank\x22\x3ewiki\u6807\u8bb0\x3c/a\x3e \u63d2\u5165\u4e00\u4e2a\u94fe\u63a5\u5230\u9875\u9762\u4e2d\u3002',"https://docs.atlassian.com/confluence/docs-74/Links")) + '</div><div class="field-group"><label id="advanced-label" for="advanced-link">' + soy.$$escapeHtml('\u94fe\u63a5') + '</label><input type="text" tabindex="0" class="text" id="advanced-link" name="advanced-link"><div class="advanced-desc description">' + soy.$$escapeHtml('\u5728\u65b0\u9875\u9762\u4e2d\u63d2\u5165\u94fe\u63a5\uff0c\u8f93\u5165\u9875\u9762\u6807\u9898\u3002') + '<br/>' + soy.$$escapeHtml('\u63d2\u5165\u951a\u70b9\u94fe\u63a5, \u8f93\u5165 #\u951a\u70b9\u540d\u3002') + '</div><div name="advanced-error" class="advanced-error error"></div></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.advancedPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.advancedPanel';
}


Confluence.Templates.LinkBrowser.locationPanel = function(opt_data, opt_ignored) {
  return '<div id="link-browser-location" class="location-info"><form class="aui"><div class="row hidden field-group"><label class="link-location-label" for="breadcrumbs-link">' + soy.$$escapeHtml('\u94fe\u63a5\u4f4d\u7f6e') + '</label><div class="breadcrumbs-container" id="breadcrumbs-link"><div class="breadcrumbs-line"><ol id="breadcrumbs-container" class="breadcrumbs"></ol></div></div></div></form><div class="row link-text"><form class="aui" onsubmit="return false;"><div class="field-group"><label for="alias" id="alias-label">' + soy.$$escapeHtml('\u94fe\u63a5\u6587\u5b57') + '</label><input type="text" tabindex="0" class="text" name="alias" id="alias"></div></form></div><div class="row link-open-in-new-window hidden"><div class="field-group"><div class="checkbox"><input type="checkbox" class="checkbox" name="open-in-new-window" tabindex="0" id="link-open-in-new-window"><label for="link-open-in-new-window" id="open-window-label">' + soy.$$escapeHtml('\u5728\u65b0\u6807\u7b7e\uff0f\u7a97\u53e3\u4e2d\u6253\u5f00') + '</label></div></div></div><div class="row link-image hidden"><div class="readonly"><label for="link-image-filename">' + soy.$$escapeHtml('\u94fe\u63a5\u56fe\u7247') + '</label><span id="link-image-filename" class="content-type-attachment-image"></span></div></div><div class="row link-mixed hidden"><div class="readonly"><label for="link-mixed-content">' + soy.$$escapeHtml('\u94fe\u63a5\u6587\u5b57') + '</label><span id="link-mixed-content"></span></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.locationPanel.soyTemplateName = 'Confluence.Templates.LinkBrowser.locationPanel';
}


Confluence.Templates.LinkBrowser.helpLink = function(opt_data, opt_ignored) {
  return '<div class="dialog-help-link"><a href="' + soy.$$escapeHtml("https://docs.atlassian.com/confluence/docs-74/Links") + '" target="_blank">' + soy.$$escapeHtml('\u5e2e\u52a9') + '</a></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LinkBrowser.helpLink.soyTemplateName = 'Confluence.Templates.LinkBrowser.helpLink';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:editor-resources', location = 'com/atlassian/confluence/plugins/createcontent/js/move-hidden-fields-hack.js' */
AJS.toInit(function(a){a("fieldset.create-content-template-fields \x3e input").appendTo("form.editor")});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:create-from-template-macro-browser-resources', location = 'com/atlassian/confluence/plugins/createcontent/js/create-from-template-macro-fields.js' */
AJS.toInit(function(f){function h(a,b){a=a||AJS.Meta.get("space-key");Confluence.Blueprint.Dialog.requestWebItems(a,!1,function(d){var e=Confluence.Blueprint.Dialog.loadedWebitems[a];_.isEmpty(e)?AJS.log("create-from-template-macro-fields: No Create dialog web items found for spaceKey \x3e"+a+"\x3c"):b(d,e)},function(){AJS.error("create-from-template-macro-fields: requestWebItems call for spaceKey \x3e"+a+"\x3c failed")})}function g(a,b){h(b,function(b,e){b=a.val();a.empty();_.each(e,function(b){var c=
b.itemModuleCompleteKey;"com.atlassian.confluence.plugins.confluence-create-content-plugin:create-blank-page"!==c&&"com.atlassian.confluence.plugins.confluence-create-content-plugin:create-blog-post"!==c&&(b.templateId||b.contentBlueprintId)&&(c=f("\x3coption\x3e\x3c/option\x3e").text(b.name),c.attr("data-template-id",b.templateId),c.attr("data-blueprint-module-complete-key",b.blueprintModuleCompleteKey),c.attr("data-content-blueprint-id",b.contentBlueprintId),c.attr("data-create-result",b.createResult),
c.val(b.templateId||b.contentBlueprintId),a.append(c))});a.val(b)})}AJS.MacroBrowser.setMacroJsOverride("create-from-template",{fields:{spacekey:{spaceKey:function(a){var b=AJS.MacroBrowser.ParameterFields.spacekey(a),d=b.input.val();a=function(){var a=b.input.val();a!=d&&g(AJS.MacroBrowser.fields.templateName.input,a);d=a};b.input.bind("selected.autocomplete-content",a);b.input.blur(a);return b}}},beforeParamsSet:function(a,b){a.buttonLabel=a.buttonLabel||a.createButtonLabel||"\u4ece\u6a21\u677f\u521b\u5efa";
g(f("#macro-param-templateName"),a.spaceKey);return a},beforeParamsRetrieved:function(a,b,d){b=AJS.MacroBrowser.fields.templateName.input.find("option:selected");a.blueprintModuleCompleteKey=b.data("blueprint-module-complete-key");a.contentBlueprintId=b.data("content-blueprint-id");a.templateId=b.data("template-id");a.createResult=b.data("create-result");return a}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-image-attributes:soy-resources', location = 'soy/image-attributes-panel.soy' */
// This file was automatically generated from image-attributes-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Editor.ImageAttributes.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.ImageAttributes == 'undefined') { Confluence.Templates.Editor.ImageAttributes = {}; }


Confluence.Templates.Editor.ImageAttributes.content = function(opt_data, opt_ignored) {
  return '<form class="aui" onsubmit="return false;"><div class="field-group"><label for="image-title-attribute">' + soy.$$escapeHtml('\u6807\u9898\u6587\u672c') + '</label><input class="text" type="text" id="image-title-attribute" name="image-title-attribute" value="' + ((opt_data.imgTitle) ? soy.$$escapeHtml(opt_data.imgTitle) : '') + '"><div class="description">' + soy.$$escapeHtml('\u6863\u5149\u6807\u5728\u56fe\u50cf\u4e0a\u60ac\u505c\u65f6\u663e\u793a') + '</div></div><div class="field-group"><label for="image-alt-attribute">' + soy.$$escapeHtml('\u66ff\u4ee3\u6587\u672c') + '</label><input class="text" type="text" id="image-alt-attribute" name="image-alt-attribute" value="' + ((opt_data.imgAlt) ? soy.$$escapeHtml(opt_data.imgAlt) : '') + '"><div class="description">' + soy.$$escapeHtml('\u5f53\u56fe\u50cf\u65e0\u6cd5\u663e\u793a\u65f6\u7531\u5c4f\u5e55\u9605\u8bfb\u5668\u4f7f\u7528') + '</div></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.ImageAttributes.content.soyTemplateName = 'Confluence.Templates.Editor.ImageAttributes.content';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-image-attributes:image-attributes', location = 'js/image-attributes-panel.js' */
'use strict';define("confluence-image-attributes/image-attributes-panel",["jquery","ajs","confluence/legacy"],function(f,h,g){return function(){function k(){var a=c.val();d.attr({"data-element-title":a,title:l(d.attr("data-location"),a),alt:e.val()})}function m(){c.val()===e.val()&&(c.bind("input.chained",function(a){e.val(c.val())}),e.on("change",function(){c.unbind("input.chained")}))}function l(a,b){return a&&0<a.length&&b&&0<b.length?a+" ("+b+")":a&&0<a.length?a:b&&0<b.length?"("+b+")":""}h.bind("dialog-created.image-properties",
function(a,b){d=f(b.img);a=f(g.Templates.Editor.ImageAttributes.content({imgTitle:d.attr("data-element-title"),imgAlt:d.attr("alt")}));c=a.find("#image-title-attribute");e=a.find("#image-alt-attribute");m();g.Editor.ImageProps.registerPanel(n,a,p,k)});var n="image-attributes",p="image-attributes-panel",d,c,e}});require("confluence/module-exporter").safeRequire("confluence-image-attributes/image-attributes-panel",function(f){require("ajs").toInit(f)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'tinymce3/plugins/imagedialog/editor_plugin_src.js' */
define("confluence-editor/tinymce3/plugins/imagedialog/editor_plugin_src",["tinymce","confluence/legacy"],function(a,b){return{init:function(a){a.onInit.add(function(){a.addCommand("mceConfimage",b.Editor.defaultInsertImageDialog)})},getInfo:function(){return{longname:"Confluence Image Dialog",author:"Atlassian",authorurl:"http://www.atlassian.com",version:a.majorVersion+"."+a.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/imagedialog/editor_plugin_src",function(a){var b=require("tinymce");b.create("tinymce.plugins.ConfluenceImageDialog",a);b.PluginManager.add("confluenceimagedialog",b.plugins.ConfluenceImageDialog)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'utils/tinymce-image-utils.js' */
define("confluence-editor/utils/tinymce-image-utils","jquery confluence/api/logger confluence/meta ajs tinymce confluence/api/constants".split(" "),function(d,m,n,j,o,r){var p=["imagetext","src","align","border","width","height"],s=/\/download\/(thumbnails|attachments)\/([0-9]+)\//,q=function(a,b,f,c,e){if(c){a.width=b>=e?e:b;a.style.maxWidth=""}else{a.height=f>=e?e:f;a.style.maxHeight=""}},k;k={isScaledByWidth:function(){return false},updateImageElement:function(a,b){var f=d(a),c;c=b.destination;
c=k.isRemoteImg(c)?c:b.thumbnail?c.replace("/attachments/","/thumbnails/"):c.replace("/thumbnails/","/attachments/");b.src=c;f.toggleClass("confluence-content-image-border",!!b.border);f.toggleClass("confluence-thumbnail",!!b.thumbnail);c=0;for(var e=p.length;c<e;c++){var h=p[c],g=b[h];g!==false&&g!=null?f.attr(h,g):f.removeAttr(h)}o.activeEditor.undoManager.add()},insertFromProperties:function(a,b){d.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:r.CONTEXT_PATH+"/rest/tinymce/1/embed/placeholder/image",
data:d.toJSON(a),dataType:"text",success:function(a){k.insertImagePlaceholder(a,b)}})},insertImagePlaceholder:function(a,b){var f,c=k.isScaledByWidth(),e=d(a);f=c?j.Confluence.PropertyPanel.Image.getPresetImageSize("large"):n.get("content-type")==="comment"?j.Confluence.PropertyPanel.Image.getPresetImageSize("small"):j.Confluence.PropertyPanel.Image.getPresetImageSize("medium");e.css(c?"max-width":"max-height",f+"px");var h=o.activeEditor,g="_"+ +new Date,i=d("<div></div>").append(e.attr("id",g));
h.selection.setContent(i.html());var l=h.dom.get(g);h.dom.setAttrib(l,"id","");if(!e.hasClass("confluence-external-resource")){g=e.attr("data-image-width");i=e.attr("data-image-height");if(g===void 0&&i===void 0){g=e.attr("width");i=e.attr("height")}q(l,g,i,c,f);this.updateThumbnailAttribute(l)}d(l).one("load",function(){e.hasClass("confluence-external-resource")&&q(this,this.width,this.height,c,f);j.Rte.showSelection(function(){b||j.trigger("trigger.property-panel",{elem:l});h.undoManager.add()});
h.onChange.dispatch()})},updateThumbnailAttribute:function(a){var b=a.width,f=a.height;if(b||f){var c=d(a),e=c.attr("data-image-width"),h=c.attr("data-image-height"),g=n.get("max-thumb-width"),i=n.get("max-thumb-height"),a=!this.isRemoteImg(a.src)&&this.isThumbnailUsable(b,f,e,h,g,i);c.attr("thumbnail",a);c.toggleClass("confluence-thumbnail",a)}},isRemoteImg:function(a){var b=j.Rte.getCurrentBaseUrl();return a.match("(https?://)")&&a.indexOf(b)===-1},isThumbnailUsable:function(a,b,f,c,e,d){if(a){if(a>
e)return false;if(f===void 0&&c===void 0)return true;e=f/c;return e>=1?true:e*d>=a}a=b;if(a>d)return false;if(f===void 0&&c===void 0)return true;d=c/f;return d>=1?true:d*e>=a}};return{ImageProperties:function(a){if(a&&d.nodeName(a,"img")&&d(a).hasClass("confluence-embedded-image")){var b=d(a),a={destination:b.attr("src"),url:b.attr("src"),border:b.attr("class")&&b.attr("class").indexOf("confluence-content-image-border")!==-1?1:0,width:b.prop("width"),height:b.prop("height"),originalSelected:!b.attr("width")&&
!b.attr("height")};if(!k.isRemoteImg(a.destination)&&!d(b).hasClass("confluence-external-resource")){var f=a;var b=d(b).attr("src"),c=b.match(s);if(c&&c.length===3)b=c[2];else{m.log("ERROR: could not parse page id from image url "+b);b="0"}f.pageId=b}return d.extend({},a)}if(a.destination){a.imageFileName=a.imageFileName||a.destination;return d.extend({},a)}return null},ImageUtils:k}});
require("confluence/module-exporter").safeRequire("confluence-editor/utils/tinymce-image-utils",function(d){var m=require("tinymce");m.confluence.ImageProperties=d.ImageProperties;m.confluence.ImageUtils=d.ImageUtils});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'tinymce3/plugins/propertypanel/js/property-panel-links.js' */
define("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-links",["ajs","jquery","confluence/legacy","tinymce","window"],function(a,e,i,j,k){var h=0;return{name:"link",canHandleElement:function(a){return a.is("a")&&"#"!=a.attr("href")&&!a.hasClass("unresolved")},handle:function(f){var c=f.containerEl,g=f.ed,b=function(c){return a.Rte.getEditor().getLang(c)},f={anchorIframe:a.Rte.getEditorFrame()},d=0===(c.getAttribute("href")||"").indexOf("#"),b=[{className:"link-property-panel-goto-button",
text:b("propertypanel.links_goto"),tooltip:d?b("propertypanel.links_goto_disabled_tooltip"):c.href,href:c.href,disabled:d,click:function(){a.Confluence.PropertyPanel.destroy();var b=k.open(c.href,j.isIE?"_blank":"confluence-goto-link-"+a.params.pageId+"-"+h);b.focus();b.opener=null}},{className:"link-property-panel-edit-button",text:b("propertypanel.links_edit"),tooltip:b("propertypanel.links_edit_tooltip"),disabled:e(c).hasClass("createlink")||!c.href,click:function(){a.Confluence.PropertyPanel.destroy();
g.selection.select(c);i.Editor.LinkBrowser.open()}},{className:"link-property-panel-unlink-button",text:b("propertypanel.links_unlink"),tooltip:b("propertypanel.links_unlink_tooltip"),click:function(){a.Confluence.PropertyPanel.destroy();g.execCommand("mceConfUnlink",!1,c);g.focus()}}],d=[];a.trigger("link-property-panel-buttons.created",{buttons:d,link:c});b=b.concat(d);a.Confluence.PropertyPanel.createFromButtonModel(this.name,c,b,f);h++}}});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-links","AJS.Confluence.PropertyPanel.Link",function(a){var e=require("ajs");e.bind("init.rte",function(){e.trigger("add-handler.property-panel",a)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'tinymce3/plugins/propertypanel/js/property-panel-macros.js' */
define("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-macros","ajs tinymce jquery confluence/legacy document confluence/macro-js-overrides underscore".split(" "),function(b,m,d,s,n,t,u){var o=[],p=[],l={},k="__PROPERTY_PANEL_SPACER",v=[{key:k}];return{name:"macro",registeredEvents:o,canHandleElement:function(a){return a.hasClass("editor-inline-macro")||a.hasClass("wysiwyg-macro")},handle:function(a){function i(){var c="macro-placeholder-property-panel-remove-button";e.length>
0&&e[e.length-1].key==k&&(c=c+" first");h.push({className:c,text:"\u5220\u9664",click:function(){b.Confluence.PropertyPanel.destroy();b.Rte.getEditor().execCommand("mceConfRemoveMacro",j)}});if(g.attr("data-macro-parameters")){var a=s.MacroParameterSerializer.deserialize(g.attr("data-macro-parameters"));if("atlassian-macro-output-type"in a){c=function(c){return function(b){a["atlassian-macro-output-type"]=c;g.attr("data-macro-parameters",s.MacroParameterSerializer.serialize(a));
c=="INLINE"?d(".macro-placeholder-property-panel-display-newline-button").removeClass("active"):d(".macro-placeholder-property-panel-display-inline-button").removeClass("active");d(b).addClass("active")}};h.push(null);h.push({className:"macro-placeholder-property-panel-display-newline-button",tooltip:"\u5728\u65b0\u884c\u663e\u793a",selected:a["atlassian-macro-output-type"]=="BLOCK",click:c("BLOCK")});h.push({className:"macro-placeholder-property-panel-display-inline-button",
tooltip:"\u663e\u793a\u5185\u8054",selected:a["atlassian-macro-output-type"]=="INLINE",click:c("INLINE")})}}d.each(o,function(){(!this.macroName||this.macroName==f)&&d(n).bind(q(this.id,this.macroName),this.handler)});c=p;f&&l[f]&&(c=c.concat(l[f]));d.each(c,function(){try{this(j,h,w)}catch(c){b.debug("Property panel init handler failed for : "+f+".  Is global handler : "+(d.inArray(this,p)>-1),c)}});if(h.length>0){var c=b.Confluence.PropertyPanel.createFromButtonModel("macro",
j,h,w),x=t.getFunction(f,"propertyPanelIFrameInjector");x&&x(c)}}if(!(a.e.type!=="click"&&a.e.type!=="mouseup")){var j=a.containerEl,g=d(j),f,e=[],a=!g.hasClass("editor-inline-macro"),y=!g.hasClass("wysiwyg-unknown-macro"),h=[],w={originalHeight:a&&g.height(),anchorIframe:b.Rte.getEditorFrame()},q=function(c,a){return c+"-button-click"+(a?a+".macro":"")+".property-panel"};if(y){var r=d.Deferred();f=g.attr("data-macro-name");if(b.MacroBrowser.getMacroMetadata(f))e=b.MacroBrowser.getMacroMetadata(f).buttons;
(a=t.getFunction(f,"getControls"))?a(function(a){var b=e,a=u.filter(a,function(a){return a.type==="button"}),a=u.map(a,function(a){return{key:a.key,label:a.name.value}});e=b.concat(v).concat(a).concat(v);r.resolve()}):r.resolve();r.done(function(){var a="macro-placeholder-property-panel-edit-button";e.length>0&&e[0].key==k&&(a=a+" last");h.push({className:a,text:"\u7f16\u8f91",click:function(){b.Confluence.PropertyPanel.destroy();m.confluence.macrobrowser.editMacro(g)}});
d.each(e,function(a,c){if(c.key!=k){var i="macro-property-panel-"+c.key;a>0&&e[a-1].key==k&&(i=i+" first");a<e.length-1&&e[a+1].key==k&&(i=i+" last");h.push({className:i,text:c.label,parameterName:c.key,click:function(){d(n).trigger(q(c.key),g);d(n).trigger(q(c.key,f),g);b.Confluence.PropertyPanel.destroy()}})}})}).then(i())}else i()}},registerButtonHandler:function(a,b,d){Array.isArray(a)||(a=[a]);a.forEach(function(a){o.push({id:a,handler:b,macroName:d})})},registerInitHandler:function(a,b){if(b){l[b]=
l[b]||[];l[b].push(a)}else p.push(a)},yieldButtonFor:function(a,b){var j;d.each(a,function(){this.parameterName&&this.parameterName==b&&(j=this)});return j}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-macros","AJS.Confluence.PropertyPanel.Macro",function(b){var m=require("ajs");m.bind("init.rte",function(){m.trigger("add-handler.property-panel",b)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'tinymce3/plugins/propertypanel/js/property-panel-images.js' */
define("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-images","jquery ajs tinymce confluence-editor/utils/tinymce-image-utils confluence/meta confluence/legacy confluence/api/browser confluence/property-panel".split(" "),function(f,g,s,F,v,w,G,h){function x(){var a=[];f.each(t,function(b,c){a.push(c)});h.current.panel.find(a.join(", ")).removeClass("active")}function p(a,b,c){var e=y(a,b),c=y(a,c),j=e||c;if(j){var d=h.getAnchor(),i=d.width(),d=d.height(),f=v.get("max-thumb-width"),
g=v.get("max-thumb-height");a.thumbnail=k.isRemoteImg(a.destination)?false:k.isThumbnailUsable(e,c,i,d,f,g);a.originalSelected=false;if(b){delete a.height;a.width=j}else{delete a.width;a.height=j}m(a);x();return true}return false}function z(a,b){if(u?p(a,n[b]):p(a,null,n[b])){A(b);m(a);return true}return false}function B(a){delete a.width;delete a.height;a.thumbnail=false;a.originalSelected=true;x();A("original");var b=h,c=b.getAnchor();b.current.updating=true;c.one("load",function(){l(b);q(a);a.width=
Math.floor(c.width());a.height=Math.floor(c.height())});k.updateImageElement(c,a);s.isGecko&&g.Rte.getEditor().execCommand("mceRepaint",false);c.each(function(){this.complete&&f(this).trigger("load")});return true}function A(a){h.current.panel.find(t[a]).addClass("active")}function C(a){f(".image-border-toggle").toggleClass("active",!a.border);a.border=+!a.border||false;m(a)}function m(a){var b=h,c=b.getAnchor(),e=c.attr("src"),f=c.height();b.current.updating=true;k.updateImageElement(c,a);s.isGecko&&
g.Rte.getEditor().execCommand("mceRepaint",false);if(a.src!=e){var d=setInterval(function(){var a=c.height();if(a!=f){g.debug("updateImageElement : height changed after image src change - "+f+" to "+a);clearTimeout(d);d=null;l(b)}},10);setTimeout(function(){if(d){clearTimeout(d);d=null;l(b)}},1E3)}else l(b);q(a)}function q(a){a=a.width?a.width:h.getAnchor().width();a=Math.floor(a);f("#image-size-input").val(a+"px")}function y(a,b){b=parseInt(b);if(!isNaN(b)){b<D?b=D:b>E&&(b=E);return b}return null}
var k=F.ImageUtils,u=k.isScaledByWidth(),n;n=u?{small:100,medium:300,large:500}:{small:150,medium:250,large:400};var t={small:".image-size-small",medium:".image-size-medium",large:".image-size-large",original:".image-size-original"},D=16,E=9E4,l=function(a){a.current.updating=false;a.current.snapToElement({animate:true,animateDuration:100})};return{_resizeImage:p,pluginButtons:[],name:"image",getPresetImageSize:function(a){return n[a]},canHandleElement:function(a){return a.is("img")&&!a.hasClass("editor-inline-macro")&&
!a.hasClass("template-variable")},handle:function(a){function b(){p(e,f("#image-size-input").val())?true:q(e);g.trigger("analyticsEvent",{name:"confluence.editor.image.resize.custom"})}var c;c=a.nodeName==="IMG"?a:a.containerEl;var a=f(c),e=s.confluence.ImageProperties(c);if(e&&!a.attr("data-resource-id")){var j=g.Rte.getEditor(),d=function(a){return j.getLang(a)},i=function(a){return{className:["image-size-"+a,"editor-resize","resize-"+a].join(" "),text:d("propertypanel.images_"+a),tooltip:d("propertypanel.images_"+
a+"_tooltip"),iconClass:"aui-icon aui-icon-small aui-iconfont-image-resize",click:function(){z(e,a);g.trigger("analyticsEvent",{name:"confluence.editor.image.resize."+a})},selected:u?e.width==n[a]:e.height==n[a]}},i=[{className:"editable",tooltip:d("propertypanel.images_sizing_tooltip"),html:'<input id="image-size-input"/>'},null,i("small"),i("medium"),i("large"),{className:"image-size-original",text:d("propertypanel.images_original"),tooltip:d("propertypanel.images_original_tooltip"),click:function(){B(e);
g.trigger("analyticsEvent",{name:"confluence.editor.image.resize.original"})},selected:e.originalSelected},null,{className:"image-border-toggle",text:d("propertypanel.images_border"),tooltip:d("propertypanel.images_border_tooltip"),click:function(){C(e)},selected:e.border||e.border==1}];i.push(null);var k=a.parent();if(k.is("a[href]")){i.push({className:"image-link-edit",text:d("propertypanel.images_link_edit"),tooltip:d("propertypanel.images_link_edit_tooltip"),click:function(){h.destroy();j.selection.select(k[0]);
w.Editor.LinkBrowser.open()}});i.push({className:"image-link-remove",text:d("propertypanel.images_link_remove"),tooltip:d("propertypanel.images_link_remove_tooltip"),click:function(){h.destroy();j.execCommand("mceConfUnlink",false,c);j.focus()}})}else i.push({className:"image-make-link",text:d("propertypanel.images_link_create"),tooltip:d("propertypanel.images_link_create_tooltip"),iconClass:"aui-icon aui-icon-small aui-iconfont-link",click:function(){h.destroy();j.selection.select(c);w.Editor.LinkBrowser.open()}});
for(var l=h.Image.pluginButtons,r=0;r<l.length;r++)if(l[r]===null)i.push(null);else{var m=l[r].create(a);m&&i.push(m)}h.createFromButtonModel(this.name,c,i,{anchorIframe:g.Rte.getEditorFrame()});a=f("#image-size-input");a.bind("focus",function(){f(this).select()});a.bind("change",function(){b()});(new G(window.navigator.userAgent)).isIE()&&a.bind("keyup",function(a){a.keyCode===13&&b()});h.current.imageProps=e;q(e);var o=e;return{setPresetSize:function(a){z(o,a)},setPixelSize:function(a){p(o,a)},
setToOriginalSize:function(){B(o)},toggleBorder:function(){C(o)},getWidth:function(){return o.width},getHeight:function(){return o.height},getDisplayWidth:function(){return f("#image-size-input").val()},isButtonSelected:function(a){return h.current.panel.find(t[a]).hasClass("active")}}}}}});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/propertypanel/js/property-panel-images","AJS.Confluence.PropertyPanel.Image",function(f){var g=require("ajs");g.bind("init.rte",function(){g.trigger("add-handler.property-panel",f)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:property-panel-image-link-macro-conf-frontend', location = 'tinymce3/plugins/imageproperties/js/image-properties-dialog.js' */
define("confluence-editor/tinymce3/plugins/imageproperties/js/image-properties-dialog",["jquery","ajs"],function(d,a){function l(){h||(h=d("#image-properties-tab-items > div").map(function(){var a=d(this);return{key:a.text(),weight:a.attr("data-weight"),label:this.title}}).sort(function(a,b){return a.weight-b.weight}));return h}function m(){var a=c.popup.element,b=650/60,e=d('<div class="image-properties-loading-blanket"><div class="loading-data"></div></div>').appendTo(a.find(".dialog-page-body")),
f=e.find(".loading-data");e.css({width:e.parent().width(),height:a.height()});f.css({marginTop:-60,marginLeft:-60});f.spin({color:"#666",width:b,radius:25,length:25,top:0,left:0,zIndex:0,speed:1.042});var a=[],g;for(g in i)b=i[g],(b=b.saveFn&&b.saveFn())&&b.done&&a.push(b);d.when.apply(d,a).done(function(){var a=c.popup.element.find(".image-properties-loading-blanket .loading-data");a.css({marginTop:"",marginLeft:""});a.spinStop();a.closest(".image-properties-loading-blanket").remove();c.hide().remove()})}
function o(){c.hide().remove()}var c,h,i={},n;return{init:function(){n||(h=null,0<l().length&&(n=!0,a.Confluence.PropertyPanel.Image.pluginButtons.push(null,{create:function(){return{className:"image-properties",text:"\u5c5e\u6027",tooltip:"\u8bbe\u7f6e\u989d\u5916\u7684\u56fe\u50cf\u5c5e\u6027",click:function(h,b){a.trigger("analyticsEvent",{name:"confluence.editor.image-properties-trigger"});a.Confluence.PropertyPanel.destroy();d("#image-properties-dialog").remove();c=new a.ConfluenceDialog({id:"image-properties-dialog",
onSubmit:m});a.trigger("dialog-created.image-properties",{img:b});c.popup.element.attr("data-tab-default","0");c.addHeader("\u56fe\u50cf\u5c5e\u6027");c.addSubmit("\u4fdd\u5b58",m);c.addCancel("\u53d6\u6d88",o);for(var e=c,f=l(),g=0;g<f.length;g++){var j=f[g],k=i[j.key];k&&e.addPanel(j.label,k.content,k.panelClass,j.key)}1===f.length&&e.popup.element.find(".dialog-page-menu").show();a.trigger("dialog-before-show.image-properties");
c.show()}}}})))},registerPanel:function(a,b,c,d){i[a]={content:b,panelClass:c,saveFn:d}}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/imageproperties/js/image-properties-dialog","Confluence.Editor.ImageProps",function(d){var a=require("ajs");a.toInit(d.init);a.bind("quickedit.success",d.init)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/variable-manager.js' */
define("confluence-templates/variable-manager",["confluence/api/event","jquery"],function(f,g){function i(c,a){var b=c.toLocaleLowerCase(),d=a.toLocaleLowerCase(),b=b.localeCompare(d);0==b&&(b=c.localCompare(a));return b}function h(c){return g.extend(!0,{},e.defaults[c]||e.defaults.string)}var e=function(){var c={};return{find:function(a){var a=a.toLocaleLowerCase(),b={},d;for(d in c)if(c.hasOwnProperty(d)&&(!a.length||0===d.toLocaleLowerCase().indexOf(a)))b[d]=c[d];return b},contains:function(a){return!!c[a]},
get:function(a){return c[a]},getAll:function(){return g.extend(!0,{},c)},getSortedNames:function(){var a=[],b;for(b in c)a.push(b);return a.sort(i)},add:function(a,b){c[a]=b||h();f.trigger("add.confluence-variable",{name:a,details:g.extend(!0,{},b)})},del:function(a){var b=c[a];delete c[a];f.trigger("delete.confluence-variable",{name:a,details:g.extend(!0,{},b)})},rename:function(a,b){var d=c[a];delete c[a];d&&(c[b]=d,f.trigger("rename.confluence-variable",{oldName:a,newName:b,details:g.extend(!0,
{},details)}))},createDefault:h}};e.defaultVariableManager=e();e.defaults={textarea:{type:"textarea",rows:5,columns:100},list:{type:"list",options:[]},string:{type:"string"}};return e});"template"===AJS.Meta.get("content-type")&&require("confluence/module-exporter").safeRequire("confluence-templates/variable-manager",function(f){require("confluence/legacy").VariableManager=f});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/variable-placeholder.js' */
define("confluence-templates/variable-placeholder",["ajs","jquery"],function(a,d){return{component:{insertPlaceholder:function(c,e){var b;b="$"+c;var f=a.Rte.getEditor();a.Rte.BookmarkManager.storeBookmark();b={title:b,src:a.Meta.get("context-path")+"/plugins/servlet/confluence/placeholder/template-variable?name="+encodeURIComponent(c),"data-variable-name":c,"class":"template-variable",alt:"$"+c};e&&d.extend(b,e);b=d("<img/>").attr(b);f.selection.setNode(b[0])}},init:function(){d(a.Rte.getEditor().getBody()).delegate("img.template-variable",
"dragstart",function(a){a.preventDefault()})}}});"template"===AJS.Meta.get("content-type")&&require("confluence/module-exporter").safeRequire("confluence-templates/variable-placeholder",function(a){require("confluence/legacy").VariablePlaceHolder=a.component;require("ajs").bind("init.rte",a.init)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/variable-toolbar.js' */
define("confluence-templates/variable-toolbar",["ajs","document","confluence/api/event","jquery","confluence/legacy"],function(e,k,h,f,c){return{init:function(){h.bind("init.rte",function(){var g=c.VariableManager.defaultVariableManager,a=f("#template-menu"),i=a.find(".variables-list");h.bind("add.confluence-variable,delete.confluence-variable,rename.confluence-variable",function(){var b=g.getSortedNames(),j=b.length,d="";i.toggleClass("hidden",!j);for(var a=0;a<j;a++)d+=c.Templates.Variables.renderVariableItem({variableName:"$"+
b[a],tooltip:e.format("\u5728\u9875\u9762\u4e2d\u63d2\u5165\u201c{0}\u201d\u5b57\u6bb5\uff0c\u4f9b\u6a21\u677f\u7528\u6237\u586b\u5199\u3002",b[a])});i.html(d)});a.delegate(".variables-list a","click",function(){var b=f(this).attr("data-variable-name");!g.contains(b)&&g.add(b);c.VariablePlaceHolder.insertPlaceholder(b)});a.delegate(".variables-add","click",function(b){var a=c.Editor.Autocompleter.Manager.getInputDrivenDropdown();e.Rte.getEditor().focus();(!a||a.inactive)&&c.Editor.Autocompleter.Manager.shortcutFired("$",!0);b.stopPropagation()});f(k).bind("showLayer",
function(b,c,d){"dropdown"===c&&d.$.closest(a).length&&d.reset()})})}}});"template"===AJS.Meta.get("content-type")&&require("confluence/module-exporter").safeRequire("confluence-templates/variable-toolbar",function(e){e.init()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/autocomplete-settings-variables.js' */
define("confluence-templates/autocomplete-settings-variables",["confluence/legacy","ajs"],function(d,c){return function(){function e(a,b){return{callback:function(c){c.replaceWithSelectedSearchText();!f.contains(a)&&f.add(a);d.VariablePlaceHolder.insertPlaceholder(a,b)},name:c.escapeHtml(a),href:"#"}}function i(a,b){return!a&&!b?0:!a?-1:!b?1:a.toLocaleLowerCase().localeCompare(b.toLocaleLowerCase())}var f=d.VariableManager.defaultVariableManager;return{ch:"$",cache:!1,endChars:[],dropDownDelay:0,
preventStartNodes:"",dropDownClassName:"autocomplete-variables",selectFirstItem:!0,getHeaderText:function(a,b){return b?"\u53d8\u91cf\u5efa\u8bae":"\u53d8\u91cf\u5efa\u8bae"},getAdditionalLinks:function(a,b){var e=d.unescapeEntities(b);return f.get(e)||0===b.length?[]:[{className:"dropdown-create-variable",href:"#",callback:function(a){var b=a.plainText();a.replaceWithSelectedSearchText();!f.contains(b)&&f.add(b);d.VariablePlaceHolder.insertPlaceholder(b,
void 0)},name:c.format("\u521b\u5efa\u53d8\u91cf \u0027\u0027{0}\u0027\u0027",b)}]},getDataAndRunCallback:function(a,b,c){var g,k,a=d.unescapeEntities(b),j=f.find(a),h=[],l=[];for(g in j)j.hasOwnProperty(g)&&h.push(g);h.sort(i);a=0;for(k=h.length;a<k;a++)g=h[a],l.push(e(g,j[g]));c([l],b)},update:function(){}}}});
require("confluence/module-exporter").safeRequire("confluence-templates/autocomplete-settings-variables",function(d){var c=require("ajs"),e=require("confluence/legacy"),i=require("confluence/meta");c.bind("init.rte",function(){var c=require("tinymce");"template"===i.get("content-type")&&(e.Editor.Autocompleter||(e.Editor.Autocompleter=c.confluence.Autocompleter),e.Editor.Autocompleter.Settings.$=d())})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/property-panel-variables.js' */
define("confluence-templates/property-panel-variables",["ajs","jquery","confluence/legacy"],function(b,a,h){return{name:"variable",canHandleElement:function(a){return a.hasClass("template-variable")},handle:function(f){function l(d){b.debug("clicked type: "+d);var c=a("#property-panel");c.find(".panel-buttons").toggleClass("no-inputs","string"===d);c.find(".textarea-section,.list-section,.string-section").addClass("hidden");c.find("."+d+"-section").removeClass("hidden");"textarea"===d?(a("#variable-property-panel-textarea-rows").val(e.rows),
a("#variable-property-panel-textarea-columns").val(e.columns)):"list"===d&&a("#variable-property-panel-list-values").val(e.options.join(","))}function i(d,b,c){return{className:"variable-property-panel-type-item variable-property-panel-type-"+d,text:b,tooltip:c,selected:m===d,click:function(){e.type=d;e=j.createDefault(d);j.add(k,e);a(".variable-property-panel-type-item").removeClass("selected");a(".variable-property-panel-type-"+d).addClass("selected");l(d)}}}function g(a){return m===a?"":" hidden"}
if(!("click"!==f.e.type&&"mouseup"!==f.e.type)){var f=f.containerEl,n=a(f),k,c=[],o={originalHeight:n.height(),anchorIframe:b.Rte.getEditorFrame()};k=n.attr("data-variable-name");var j=h.VariableManager.defaultVariableManager,e=j.get(k),m=e&&e.type||"string";c.push(i("string","\u6587\u672c","\u5355\u884c\u6587\u672c\u8f93\u5165\u6846\u3002"));c.push(i("textarea","\u591a\u884c\u6587\u672c","\u591a\u884c\u6587\u672c\u8f93\u5165\u6846\u3002"));
c.push(i("list","\u5217\u8868","\u4e0b\u62c9\u5217\u8868\u3002"));c.push(null);c.push({className:"editable textarea-section"+g("textarea"),tooltip:"\u5b57\u6bb5\u7684\u884c\u6570\u3002",html:'<input id="variable-property-panel-textarea-rows"/>'});c.push({className:"variable-property-panel-textarea-split textarea-section"+g("textarea"),tooltip:"",html:"<span>x</span>"});c.push({className:"editable textarea-section"+
g("textarea"),tooltip:"\u5b57\u6bb5\u7684\u5217\u6570\u3002",html:'<input id="variable-property-panel-textarea-columns"/>'});c.push(null);c.push({className:"editable list-section"+g("list"),tooltip:"\u8f93\u5165\u5217\u8868\u7684\u6bcf\u4e00\u4e2a\u9879\uff0c\u7528\u9017\u53f7\u5206\u9694\u3002",html:"<input id=\"variable-property-panel-list-values\" size='50'/>"});b.Confluence.PropertyPanel.createFromButtonModel("variable",f,c,o);l(e.type);a("#variable-property-panel-textarea-rows").change(function(){e.rows=
+a(this).val()||h.VariableManager.defaults.textarea.rows});a("#variable-property-panel-textarea-columns").change(function(){e.columns=+a(this).val()||h.VariableManager.defaults.textarea.columns});a("#variable-property-panel-list-values").change(function(){var d,b,c,f=a(this).val().split(",");e.options=[];d=0;for(b=f.length;d<b;d++)(c=a.trim(f[d]))&&e.options.push(c)});a("#variable-property-panel-textarea-rows,#variable-property-panel-textarea-columns,#variable-property-panel-list-values").keypress(function(b){13===
b.which&&a(this).blur()})}}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-templates/property-panel-variables","AJS.Confluence.PropertyPanel.Variable",function(b){var a=require("ajs");a.bind("init.rte",function(){a.trigger("add-handler.property-panel",b)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/variable-marshaller.js' */
define("confluence-templates/variable-marshaller",["ajs","jquery","confluence/legacy"],function(d,b,q){function r(c){var a=c.attr("data-variable-type");return"textarea"===a?{type:a,rows:+c.attr("data-variable-rows")||i,columns:+c.attr("data-variable-columns")||s}:"list"===a?{type:a,options:c.find("li").map(function(){return b(this).attr("data-variable-option")}).toArray()}:{type:"string"}}function m(){var c=b(d.Rte.getEditor().getBody()).find("img[data-variable-name]"),a={};b.map(c,function(c){var f=
{};b(c).attr("data-variable-raw-xhtml")&&(f={"data-variable-raw-xhtml":!0});a[b(c).attr("data-variable-name")]=f});return a}var i=5,s=100;return function(){function c(a){for(var b in a)a.hasOwnProperty(b)&&!f.contains(b)&&(d.debug("adding: ",b),f.add(b,a[b]))}var a=d.Rte.getEditor(),i=b(a.getBody()),f=q.VariableManager.defaultVariableManager;a.onGetContent.add(function(a,d){var i=b("<div></div>"),n=b("<ul></ul>").attr("data-variable-declarations","true"),e;i.append(n);var o=m();c(o);var p=f.getAll(),
l;for(l in p)if(o.hasOwnProperty(l)){var j=l;e=p[l];var g=void 0,k=void 0,g=e.type,h=b("<li></li>");h.attr("data-variable-name",j);h.attr("data-variable-type",g);h.text(j);if("textarea"===g)h.attr("data-variable-rows",e.rows),h.attr("data-variable-columns",e.columns);else if("list"===g){g=b("<ul></ul>");j=void 0;for(j in e.options)k=e.options[j],k=b("<li></li>").text(k).attr("data-variable-option",k),g.append(k);h.append(g)}e=h;n.append(e)}d.content=i.html()+d.content});a=i.find("ul[data-variable-declarations]");
a.remove();a.find("li[data-variable-name]").each(function(){var a=b(this);f.add(a.attr("data-variable-name"),r(a))});c(m())}});"template"===AJS.Meta.get("content-type")&&require("confluence/module-exporter").safeRequire("confluence-templates/variable-marshaller",function(d){require("ajs").bind("init.rte",d)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-template-resources', location = 'js/variable-templates.soy' */
// This file was automatically generated from variable-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Variables.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Variables == 'undefined') { Confluence.Templates.Variables = {}; }


Confluence.Templates.Variables.renderVariableItem = function(opt_data, opt_ignored) {
  return '<li class="dropdown-item" data-tooltip="' + soy.$$escapeHtml(opt_data.tooltip) + '"><a href="#" class="item-link variable-item" title="' + soy.$$escapeHtml(opt_data.variableName) + '" data-variable-name="' + soy.$$escapeHtml(opt_data.variableName) + '">' + soy.$$escapeHtml(opt_data.variableName) + '</a></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Variables.renderVariableItem.soyTemplateName = 'Confluence.Templates.Variables.renderVariableItem';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-fixed-headers:confluence-fixed-headers-editor-resources', location = '/js/slow-edit-handler.js' */
require(["confluence/fh/utils/dom","ajs"],function(b,a){a.toInit(function(){var c=a.Meta.get("browse-page-tree-mode");if(c!=="create"&&c!=="edit"){return}b.addClassToPage();$("#content").css({paddingRight:0})})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.share-page:edit-resources', location = 'js/edit-init.js' */
require(["ajs","confluence/meta","confluence/share-page/service/share-page","confluence/share-page/service/share-dialog-loader","confluence/dark-features"],function(a,d,e,c,b){if(d.get("edit-mode")!=="collaborative"||!d.get("remote-user")){return}if(a.Rte.getEditor()&&a.Rte.getEditor().initialized){f()}else{a.bind("rte-collab-ready",f)}function f(){if(d.get("content-type")!=="page"&&d.get("content-type")!=="blogpost"){return}var l=a.$;if(b.isEnabled("react.share.dialog")){var i="share-react-link";var k=l("<div>").addClass("invite-to-edit-container").tooltip({title:function(){return "\u9080\u8bf7\u6210\u5458\u548c\u60a8\u4e00\u8d77\u7f16\u8f91"},gravity:"ne"});k.append(l("<span>").attr("id",i));l("#rte-toolbar").prepend(k);c.init(i,"edit")}else{var h="#inviteToEditLink";l("#rte-toolbar").prepend(l(document.createElement("div")).prop("id",h.replace("#","")).addClass("aui-button").addClass("invite-to-edit-button").html('<span class="invite-plus-icon"></span>').tooltip({title:function(){return "\u9080\u8bf7\u6210\u5458\u548c\u60a8\u4e00\u8d77\u7f16\u8f91"},gravity:"ne"}));var g=l(h);var j=d.get("content-type")==="page"?"\u8ba9\u6211\u4eec\u4e00\u8d77\u5b8c\u6210\u6b64\u9875\u9762":"\u8ba9\u6211\u4eec\u4e00\u8d77\u5b8c\u6210\u6b64\u535a\u5ba2";e.initDialog(h,"inviteToEditPopup",{},{heading:"\u9080\u8bf7\u6210\u5458\u7f16\u8f91",notePlaceholder:j,link:function(){return require("confluence/share-page/fetch/content-info")(d.get("content-id"),"draft").pipe(function(m){return d.get("base-url")+m._links.edit})},entityId:function(){return d.get("draft-id")},restriction:function(){return require("confluence/share-page/fetch/content-restrictions")(d.get("content-id")).pipe(function(m){var o=m.read.restrictions.user.size||m.read.restrictions.group.size||m.update.restrictions.user.size||m.update.restrictions.group.size;var n={};if(o){n.type="restrict";n.message="\u6b64\u9875\u9762\u7684\u9650\u5236\u53ef\u4ee5\u9632\u6b62\u6210\u5458\u67e5\u770b\u6216\u7f16\u8f91\u3002"}return n})},copyOption:"invite",shareType:"edit",contentType:d.get("content-type"),errorText:"\u53d1\u751f\u610f\u5916\u9519\u8bef\u3002\u8bf7\u91cd\u8bd5\u3002",beforeLoad:function(){g.find(".invite-plus-icon").css("visibility","hidden");g.spin()},afterLoad:function(){g.find(".invite-plus-icon").css("visibility","visible");g.spinStop()}})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.deprecated.pattern.toolbar1', location = 'aui.chunk.b92d609235334b91925e--4f4d7826ad3ea21b19ca.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.deprecated.pattern.toolbar1"],{BDec:function(i,u,c){"use strict";c("FStl"),c("Q0fs"),c("S3ao"),c("KdMs")},KdMs:function(i,u,c){}},[["BDec","runtime","aui.splitchunk.b0831cc7d0","aui.splitchunk.572a8bf5cd","aui.splitchunk.d49cf794d2","aui.splitchunk.336ae4f9e7","aui.splitchunk.ed80e00f15"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.keyboardshortcuts:confluence-tinymce-keyboard-shortcuts', location = 'js/tinymce-plugin.js' */
define("confluence-keyboard-shortcuts/tinymce-plugin",["ajs","confluence-keyboard-shortcuts/confluence-keyboard-shortcuts"],function(e,b){return{init:function(a){e.debug("Init Editor Keyboard shortcuts plugin");for(var c=function(b){return function(){a.execCommand("FormatBlock",!1,b)}},d=1;7>d;d++)a.addCommand("FormatBlock-h"+d,c("h"+d));a.addCommand("FormatBlock-p",c("p"));a.addCommand("FormatBlock-pre",c("pre"));a.addCommand("FormatBlock-blockquote",c("blockquote"));a.addCommand("mceConfShortcutDialog",
b.keyboardShortcuts.openDialog);a.addButton("help",{title:"confluence.conf_shortcuts_help_desc",cmd:"mceConfShortcutDialog"})},getInfo:function(){var a=require("tinymce");return{longname:"Atlassian Editor Keyboard Shortcuts Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:a.majorVersion+"."+a.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-keyboard-shortcuts/tinymce-plugin",function(e){var b=require("tinymce");b.create("tinymce.plugins.KeyboardShortcutsPlugin",e);b.PluginManager.add("keyboardshortcuts",b.plugins.KeyboardShortcutsPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.image.effects.ImageEffectsPlugin:propertiespanel', location = 'com/atlassian/confluence/image/effects/property-panel.js' */
AJS.toInit(function(e){var p,i=/(\?|\&)(effects\=[^&]+)($|&)/,t=/(^|\&)(effects\=([^&]+))($|&)/,s=null,j=[],h=4000;q();if(Confluence.Editor.ImageProps){f()}else{l()}function f(){AJS.bind("dialog-created.image-properties",function(x,y){p=y.img;var z="image-effects",w="image-effects-panel";if(!a()){Confluence.Editor.ImageProps.registerPanel(z,c("\u56fe\u7247\u6548\u679c\u4e0d\u80fd\u5e94\u7528\u4e8eweb\u56fe\u7247"),w,null)}else{if(!n()){Confluence.Editor.ImageProps.registerPanel(z,c("\u8be5\u56fe\u7247\u592a\u5927\uff0c\u65e0\u6cd5\u65cb\u8f6c\u6216\u5e94\u7528\u56fe\u50cf\u6548\u679c\u3002\u60a8\u9700\u8981\u4e0a\u4f20\u4e00\u4e2a\u8f83\u5c0f\u7248\u672c\u7684\u6587\u4ef6\u3002"),w,null)}else{Confluence.Editor.ImageProps.registerPanel("image-effects",c(),"image-effects-panel",r)}}});AJS.bind("dialog-before-show.image-properties",function(){b();o(m(e(p)))})}function l(){var w=new AJS.Dialog({width:600,height:500,id:"image-effects-dialog"});w.addHeader("\u589e\u52a0\u56fe\u7247\u6548\u679c");w.addPanel("",c(),"");b();w.addSubmit("\u4fdd\u5b58",function(){var x=v();x.done(function(){w.hide()})});w.addCancel("\u5173\u95ed",function(){w.hide()});AJS.Confluence.PropertyPanel.Image.pluginButtons.push(null,{create:function(x){p=x[0];var z=m(x),y=!a();return{className:"image-effects",text:"\u6548\u679c...",tooltip:y?"\u56fe\u7247\u6548\u679c\u4e0d\u80fd\u5e94\u7528\u4e8eweb\u56fe\u7247":"\u6dfb\u52a0\u56fe\u7247\u7684\u6548\u679c\u5982\u9634\u5f71\u6216\u56fe\u7247\u8fb9\u6846",click:function(){if(!n()){alert("\u8be5\u56fe\u7247\u592a\u5927\uff0c\u65e0\u6cd5\u65cb\u8f6c\u6216\u5e94\u7528\u56fe\u50cf\u6548\u679c\u3002\u60a8\u9700\u8981\u4e0a\u4f20\u4e00\u4e2a\u8f83\u5c0f\u7248\u672c\u7684\u6587\u4ef6\u3002");return false}o(m(e(p)));AJS.Confluence.PropertyPanel.destroy();w.show()},disabled:y,selected:!!z}}})}function g(y,A){var B=y.attr("src");var x=i.exec(B);var w=A?"effects="+A:"";if(x){B=B.replace(x[2],w)}else{if(A){B=B+(B.indexOf("?")!=-1?"&":"?")+w}}y.attr("src",B);y.attr("data-mce-src",B);var z=y.attr("confluence-query-params");if(z){var x=t.exec(z);if(x){z=z.replace(x[2],w)}else{z=z+"&"+w}}else{z=w}y.attr("confluence-query-params",z)}function m(x){var y=x.attr("confluence-query-params");var w=t.exec(y);if(w){return w[3]}}function o(w){e(".image-effect-preview.selected").removeClass("selected");if(w){e(j).each(function(x,y){if(y.effects==w){e(e(".image-effect-preview")[x]).addClass("selected");return false}})}else{e(".image-effect-preview.image-effect-none").addClass("selected")}s=w}function q(){j.push({name:"\u65e0",effects:null});j.push({name:"\u5e26\u8d34",effects:"border-simple,blur-border,tape"});j.push({name:"\u62cd\u7acb\u5f97",effects:"border-polaroid,blur-border"});j.push({name:"\u5377\u66f2\u9634\u5f71",effects:"border-simple,shadow-kn"});j.push({name:"\u5feb\u7167",effects:"border-simple,blur-border"});j.push({name:"\u9634\u5f71",effects:"drop-shadow"})}function c(w){if(w){return'<div class="aui-message aui-message-warning warning"><span class="aui-icon icon-warning"></span>'+w+"</div>"}return'<div class="image-effects"><ul class="image-list"></ul></div>'}function b(){var x=e("div.image-effects ul.image-list");var z=Math.floor(Math.random()*22)+1;for(var y=0;y<j.length;y++){var w=e('<li class="attached-image image-effect-preview'+(!j[y].effects?" image-effect-none":"")+'"><div class="image-container"><img class="thumbnail" src="'+AJS.contextPath()+"/plugins/servlet/imgFilter.png?preview=true&id="+z+"&effects="+j[y].effects+'" title="'+j[y].name+'" style="margin-top: 5px"></div><span class="caption filename" title="'+j[y].name+'">'+j[y].name+"</span></li>");w.hover(function(){e(this).addClass("hover")},function(){e(this).removeClass("hover")});x.append(w);var A=j[y];w.click(A,function(B){e(".image-effect-preview.selected").removeClass("selected");e(this).addClass("selected");s=B.data.effects})}}function a(){return !e(p).hasClass("confluence-external-resource")}function n(){return !(p.naturalHeight&&p.naturalWidth&&(p.naturalHeight*p.naturalWidth)>(h*h))}function r(){return u()}function v(){return u(d,k)}function u(w,z){var y=e.Deferred();w&&w();p.onload=A;var x=p.src;g(e(p),s);if(p.src==x){A()}function A(){z&&z();y.resolve();p.onload=null;tinyMCE.activeEditor.undoManager.add()}return y}function d(){var C=dialog.popup.element,x=50,z=x*13/60,D=x*30/60,w=x-D,y=e('<div class="image-properties-loading-blanket"><div class="loading-data"></div></div>').appendTo(C.find(".dialog-page-body")),B=y.find(".loading-data");y.css({width:y.parent().width(),height:C.height()});B.css({marginTop:-x*1.2,marginLeft:-x*1.2});var A={color:"#666",width:z,radius:D,length:w,top:0,left:0,zIndex:0,speed:1.042};B.spin(A)}function k(){var w=dialog.popup.element.find(".image-properties-loading-blanket .loading-data");w.css({marginTop:"",marginLeft:""});w.spinStop();w.closest(".image-properties-loading-blanket").remove()}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-browser-metrics:editor', location = '/js/editor.js' */
require(["internal/browser-metrics","jquery"],function(b,c){function a(){var h=AJS.Meta.get("content-type");var g=AJS.Meta.getBoolean("new-page")?"create":"edit";var f=c("body");var d=f.hasClass("edit")||f.hasClass("create");if(d&&h&&g){if(AJS.Meta.getBoolean("collaborative-content")){var e="confluence."+h+"."+g+".collaborative.view";b.start({key:e,isInitial:true});AJS.bind("rte-collab-ready",function(){b.end({key:e});b.start({key:e+".connected"})});AJS.bind("synchrony.connected",function(){b.end({key:e+".connected"})})}else{if(!AJS.Meta.getBoolean("collaborative-content")){b.start({key:"confluence."+h+"."+g+".view",ready:".active-richtext",isInitial:true})}}}}c(a)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-utilities-resources', location = 'utils/roadmap-helper.js' */
(function(b,a){var c=Confluence.Roadmap=Confluence.Roadmap||{};c.Helper={getPosXOnMonthTimeline:function(g,e){var j=moment(g.startDate).startOf("month");var f=moment(e).startOf("month");var d=c.DateUtilities.getNumberOfMonths(j,f);var i=d*Roadmap.MONTH_WIDTH;var h=c.DateUtilities.getMilisecondsFromStartMonth(e)*Roadmap.MONTH_WIDTH/c.DateUtilities.getMilisecondsInMonth(e);return Math.round(i+h)},getPosXOnWeekTimeline:function(g,d){var e=moment(g.startDate).startOf("isoWeek");var f=moment(d).diff(e,"weeks",true);var h=f*Roadmap.WEEK_WIDTH;return Math.round(h)},getWidthTimeline:function(f,e){var d=e.duration;if(f.displayOption===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH){d*=Roadmap.MONTH_WIDTH}else{d*=Roadmap.WEEK_WIDTH}return d<Roadmap.EXTRA_SPACE_AROUND?0:Math.round(d-Roadmap.EXTRA_SPACE_AROUND)},getMonthStartDateByPosition:function(i,h){var d=Math.floor(h/Roadmap.MONTH_WIDTH);var g=moment(i.startDate).startOf("month");var e=g.add(d,"months").toDate();var f=Math.abs(h)%Roadmap.MONTH_WIDTH;if(f!==0&&d<0){f=Roadmap.MONTH_WIDTH-f}var j=c.DateUtilities.getMilisecondsInMonth(e)*f/Roadmap.MONTH_WIDTH;return new Date(e.getTime()+j)},getWeekStartDateByPosition:function(f,e){var h=moment(f.startDate).startOf("isoWeek");var d=e/Roadmap.WEEK_WIDTH;var g=d*c.DateUtilities.MILLISECONDS_A_WEEK;return new Date(h.valueOf()+g)},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(f){var e=Math.random()*16|0,d=f=="x"?e:(e&3|8);return d.toString(16)})}};c.ColorHelper={resetColorCounts:function(){a.each(Roadmap.COLORS,function(d){d.count=0})},findColor:function(d){return a.find(Roadmap.COLORS,function(e){return e.lane===d.lane})},adjustColorCount:function(e,f){var d=c.ColorHelper.findColor(e);if(d){d.count=d.count+f}},getColor:function(){return a.min(Roadmap.COLORS,function(d){return d.count})}}}(AJS.$,window._));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-utilities-resources', location = 'utils/roadmap-utilities.js' */
(function(b,a){var c=Confluence.Roadmap=Confluence.Roadmap||{};c.DateUtilities={MILLISECONDS_A_DAY:86400000,MILLISECONDS_A_WEEK:604800000,parseDate:function(e){var d=moment(e,Roadmap.SHORT_DATE_FORMAT,true);if(d.isValid()){return d}d=moment(e,Roadmap.TWO_YY_SHORT_DATE_FORMAT,true);return d.isValid()?d:null},getDateStringFromDate:function(e,d){if(d){return moment(e).format(d)}return moment(e).format(Roadmap.DATE_FORMAT)},getDateFromDateString:function(e,d){return moment(e,d||Roadmap.DATE_FORMAT).toDate()},getNumberOfMonths:function(e,d){var g=moment(e),f=moment(d);return f.diff(g,"months")},getMilisecondsInMonth:function(d){return moment(d).daysInMonth()*c.DateUtilities.MILLISECONDS_A_DAY},getMilisecondsFromStartMonth:function(d){return d.getTime()-moment(d).startOf("month").valueOf()},calculateDurationInformation:function(d){var g=c.DateUtilities.getMilisecondsInMonth(d.toDate());var e=c.DateUtilities.getMilisecondsFromStartMonth(d.toDate());var f=g-e;return{totalMillisOfMonth:g,millisFromStartMonth:e,millisRemainingOfMonth:f,durationOfMonth:e/g,remainingDurationOfMonth:f/g}},convertToWeekDuration:function(e,g){var l=moment(e);var j=l.clone();var m=c.DateUtilities.calculateDurationInformation(l);if(g<=m.remainingDurationOfMonth){var f=g*m.totalMillisOfMonth;j=j.add(f,"ms")}else{j=j.add(m.millisRemainingOfMonth,"ms");g=g-m.remainingDurationOfMonth;var h=Math.floor(g);if(h>0){j=j.add(h,"months")}var k=g%1;var i=c.DateUtilities.getMilisecondsInMonth(j.toDate());var d=k*i;j.add(d,"ms")}return j.diff(l,"weeks",true)},convertToMonthDuration:function(e,j){var k=moment(e);var f=j*c.DateUtilities.MILLISECONDS_A_WEEK;var i=k.clone().add(f,"ms");var h=i.get("year")*12+i.get("month");h=h-(k.get("year")*12+k.get("month"));var l=c.DateUtilities.calculateDurationInformation(k);if(h===0){return f/l.totalMillisOfMonth}else{var g=l.remainingDurationOfMonth;var d=c.DateUtilities.calculateDurationInformation(i);g=g+d.durationOfMonth;g=g+(h-1);return g}}};c.FieldUtilities={fixDatePickerFields:function(d){var e=d.find("input[data-aui-dp-uuid]");e.each(function(f,g){var i=b(g),h=i.attr("data-aui-dp-uuid");i.on("click focus",function(){var j=b("[data-aui-dp-popup-uuid="+h+"]");if(AJS.version<="5.4.5"){var k=j.datepicker("option","onSelect");j.datepicker("option","onSelect",function(m,l){k(m,l);i.change()})}j.parents(".aui-inline-dialog").addClass("datepicker-roadmap-patch")})})}}}(AJS.$,window._));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-models', location = '/models/model.js' */
(function(){window.Roadmap=window.Roadmap||{};Roadmap.Bar=Backbone.Model.extend({defaults:function(){return{id:Confluence.Roadmap.Helper.guid(),title:"\u65b0\u6a2a\u6761",description:"",startDate:new Date(),duration:1,rowIndex:0,pageLink:{}}}});Roadmap.Lane=Backbone.Model.extend({defaults:function(){return{title:"\u65b0\u7684\u901a\u9053",color:Confluence.Roadmap.ColorHelper.getColor(),bars:[]}},initialize:function(){var a=new Roadmap.Bars(this.get("bars"));this.set("bars",a)},getNumberOfRows:function(){var a=this.get("bars");if(a.length===0){return 0}var b=0;a.each(function(c){b=Math.max(c.get("rowIndex"),b)});return b+1}});Roadmap.Marker=Backbone.Model.extend({defaults:function(){return{title:"\u6807\u8bb0"}}});Roadmap.Timeline=Backbone.Model.extend({defaults:function(){return{displayOption:Roadmap.TIMELINE_DISPLAY_OPTION.MONTH}},validate:function(a){var d=[];var c=Confluence.Roadmap.DateUtilities.parseDate(a.startDateString);var b=Confluence.Roadmap.DateUtilities.parseDate(a.endDateString);if(!c||!b){d.push({name:"date",message:"\u8f93\u5165\u683c\u5f0f\u4e3a\u5e74\uff0d\u6708\uff0d\u65e5\u7684\u65e5\u671f"})}else{if(c.diff(b)>=0){d.push({name:"endDate",message:"\u5f00\u59cb\u65e5\u671f\u5fc5\u987b\u5728\u7ed3\u675f\u65e5\u671f\u4e4b\u524d"})}else{if(b.diff(c,"years",true)>Roadmap.TIMELINE_YEARS_LIMIT){d.push({name:"endDate",message:AJS.format("\u60a8\u4e0d\u80fd\u8ba1\u5212\u8d85\u8fc7\u672a\u6765 {0} \u5e74\u3002",Roadmap.TIMELINE_YEARS_LIMIT)})}}}return d.length>0?d:false},calculateTimelineColumns:function(){var d=this.get("startDate");var f=this.get("endDate");var c=[];var e;if(this.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH){e=moment(d).clone().startOf("month");var b=moment(f).clone().endOf("month");do{c.push({month:Confluence.Roadmap.DateUtilities.getDateStringFromDate(e,Roadmap.MONTH_FORMAT),year:e.get("year")});e.add(1,"months")}while(e.diff(b)<0)}else{e=moment(d).clone().startOf("isoWeek");var a=moment(f).clone().endOf("isoWeek");do{c.push({month:Confluence.Roadmap.DateUtilities.getDateStringFromDate(e,Roadmap.WEEK_FORMAT),year:e.get("year")});e.add(1,"weeks")}while(e.diff(a)<0)}this.attributes.displayTimelineColumns=c}});Roadmap.Roadmap=Backbone.Model.extend({defaults:function(){return{title:"\u8def\u7ebf\u56fe\u7f16\u8f91\u5668",lanes:[],markers:[]}},initialize:function(){var a=new Roadmap.Lanes(this.get("lanes"));this.set("lanes",a);var c=new Roadmap.Markers(this.get("markers"));this.set("markers",c);var b=new Roadmap.Timeline(this.get("timeline"));this.set("timeline",b)},parse:function(a){if(!a.timeline){return Roadmap.getDefaultRoadmapData()}return this.fromMacroData(a)},fromMacroData:function(c){var b=c.timeline;b.startDate=Confluence.Roadmap.DateUtilities.getDateFromDateString(b.startDate);b.endDate=Confluence.Roadmap.DateUtilities.getDateFromDateString(b.endDate);var a=c.lanes;_.each(a,function(e){var f=e.bars;_.each(f,function(g){g.startDate=Confluence.Roadmap.DateUtilities.getDateFromDateString(g.startDate);if(!g.id){g.id=Confluence.Roadmap.Helper.guid()}});e.bars=f});c.lanes=a;var d=c.markers;_.each(d,function(e){e.markerDate=Confluence.Roadmap.DateUtilities.getDateFromDateString(e.markerDate)});c.markers=d;return c},toMacroData:function(){var c=this.toJSON();var b=c.timeline.toJSON();b.startDate=Confluence.Roadmap.DateUtilities.getDateStringFromDate(b.startDate);b.endDate=Confluence.Roadmap.DateUtilities.getDateStringFromDate(b.endDate);delete b.displayTimelineColumns;c.timeline=b;var a=c.lanes.toJSON();_.each(a,function(e){var f=e.bars.toJSON();_.each(f,function(g){g.startDate=Confluence.Roadmap.DateUtilities.getDateStringFromDate(g.startDate)});e.bars=f});c.lanes=a;var d=c.markers.toJSON();_.each(d,function(e){e.markerDate=Confluence.Roadmap.DateUtilities.getDateStringFromDate(e.markerDate)});c.markers=d;return c},updateDurationUnit:function(a){this.get("lanes").each(function(b){b.get("bars").each(function(c){var d;d=a===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?Confluence.Roadmap.DateUtilities.convertToMonthDuration(c.get("startDate"),c.get("duration")):Confluence.Roadmap.DateUtilities.convertToWeekDuration(c.get("startDate"),c.get("duration"));c.attributes.duration=d})})}})})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-models', location = '/models/collection.js' */
(function(){window.Roadmap=window.Roadmap||{};Roadmap.Bars=Backbone.Collection.extend({model:Roadmap.Bar});Roadmap.Lanes=Backbone.Collection.extend({model:Roadmap.Lane});Roadmap.Markers=Backbone.Collection.extend({model:Roadmap.Marker})})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-toolbar-view-resources', location = 'view/roadmap-editor/toolbar/toolbar-templates.soy' */
// This file was automatically generated from toolbar-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Roadmap.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.toolbar = function(opt_data, opt_ignored) {
  return '<div id="roadmap-editor-toolbar" class="aui-toolbar2"><div class="aui-toolbar2-inner"><div class="aui-toolbar2-group"><div class="aui-toolbar2-primary">' + aui.buttons.buttons({content: '' + aui.buttons.button({id: 'toolbar-button-add-lane', text: ' ' + soy.$$escapeHtml('\u6dfb\u52a0\u752c\u9053'), iconType: 'aui', iconClass: 'aui-icon-small aui-iconfont-add', iconText: 'Add'}) + aui.buttons.button({id: 'toolbar-button-add-bar', text: ' ' + soy.$$escapeHtml('\u6dfb\u52a0\u6a2a\u6761'), iconType: 'aui', iconClass: 'aui-icon-small aui-iconfont-add', iconText: 'Add'}) + aui.buttons.button({id: 'toolbar-button-add-marker', text: ' ' + soy.$$escapeHtml('\u6dfb\u52a0\u6807\u8bb0'), iconType: 'aui', iconClass: 'aui-icon-small aui-iconfont-add', iconText: 'Add'})}) + '</div><div class="aui-toolbar2-secondary">' + Confluence.Templates.Roadmap.timelineOptionsForm(null) + '</div></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.toolbar.soyTemplateName = 'Confluence.Templates.Roadmap.toolbar';
}


Confluence.Templates.Roadmap.timelineOptionsForm = function(opt_data, opt_ignored) {
  return '' + aui.form.form({id: 'timeline-options-form', action: '#', content: '<fieldset>' + aui.form.selectField({id: 'timeline-display-options-select', labelContent: '' + soy.$$escapeHtml('\u67e5\u770b\u901a\u8fc7'), options: [{text: '\u6708', value: 'MONTH'}, {text: '\u5468', value: 'WEEK'}], extraClasses: 'view-by'}) + aui.form.textField({id: 'timeline-startdate-input', name: 'startDate', isRequired: true, extraClasses: 'roadmap-toolbar-date start-date aui-date-picker'}) + ' - ' + aui.form.textField({id: 'timeline-enddate-input', name: 'endDate', isRequired: true, extraClasses: 'roadmap-toolbar-date end-date aui-date-picker'}) + '<div class="field-group timeline-field-group-error"><div id="roadmap-timeline-error" class="error" /></div></fieldset>'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.timelineOptionsForm.soyTemplateName = 'Confluence.Templates.Roadmap.timelineOptionsForm';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-toolbar-view-resources', location = 'view/roadmap-editor/toolbar/toolbar.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};Roadmap.ToolbarView=Backbone.View.extend({className:"roadmap-toolbar",events:{"click #toolbar-button-add-bar":"onAddBarClick","click #toolbar-button-add-lane":"onAddLaneClick","click #toolbar-button-add-marker":"onAddMarkerClick","change #timeline-display-options-select":"onTimelineOptionChange"},initialize:function(){a.bindAll(this,"render")},render:function(){b(this.$el).html(Confluence.Templates.Roadmap.toolbar());this._initVariables();this._setupTimelineOptionsForm();return this},onAddBarClick:function(i){i.preventDefault();var d=this.model.get("lanes").at(0);var c=d.get("bars");var g=this.model.get("timeline");var f=this.model.get("timeline").get("startDate");var h=g.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?moment(f).startOf("month"):moment(f).startOf("isoWeek");c.add(new Roadmap.Bar({rowIndex:d.getNumberOfRows(),startDate:h.toDate()}))},onAddLaneClick:function(d){d.preventDefault();var c=this.model.get("lanes");c.add(new Roadmap.Lane())},onAddMarkerClick:function(f){var g=this.model.get("markers");var d=this.model.get("timeline");var h=moment(d.get("startDate"));var c=d.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?h.date(15):h.isoWeekday(4);g.add(new Roadmap.Marker({markerDate:c.toDate()}))},onTimelineOptionChange:function(d){var c=this.model.get("timeline");c.set({displayOption:this.$timelineSelect.val()})},_initVariables:function(){this.$timelineForm=this.$el.find("#timeline-options-form");this.$startDateInput=this.$timelineForm.find("#timeline-startdate-input");this.$endDateInput=this.$timelineForm.find("#timeline-enddate-input");this.$timelineSelect=this.$timelineForm.find("#timeline-display-options-select");this.$timelineError=this.$timelineForm.find("#roadmap-timeline-error");this.newTimeline=new Roadmap.Timeline()},_clearTimelineErrors:function(){this.$timelineError.empty()},_showTimelineErrors:function(){var c=this;a.each(c.newTimeline.validationError,function(d){c.$timelineError.append(d.message)})},_applyNewTimeline:function(){var c=this.model.get("timeline");var e=Confluence.Roadmap.DateUtilities.parseDate(this.$startDateInput.val());var d=Confluence.Roadmap.DateUtilities.parseDate(this.$endDateInput.val());c.set({startDate:e.toDate(),endDate:d.toDate()});this._showTimeLineFormat()},_showTimeLineFormat:function(){var c=this.model.get("timeline");this.$startDateInput.val(Confluence.Roadmap.DateUtilities.getDateStringFromDate(c.get("startDate"),Roadmap.SHORT_DATE_FORMAT));this.$endDateInput.val(Confluence.Roadmap.DateUtilities.getDateStringFromDate(c.get("endDate"),Roadmap.SHORT_DATE_FORMAT))},_validate:function(){this._clearTimelineErrors();if(this.newTimeline.isValid()){this._applyNewTimeline()}else{this._showTimelineErrors()}},_setupTimelineOptionsForm:function(){var e=this.model.get("timeline");var g=Confluence.Roadmap.DateUtilities.getDateStringFromDate(e.get("startDate"),Roadmap.SHORT_DATE_FORMAT),c=Confluence.Roadmap.DateUtilities.getDateStringFromDate(e.get("endDate"),Roadmap.SHORT_DATE_FORMAT);this.$startDateInput.val(g);this.$endDateInput.val(c);this.newTimeline.set({startDateString:g,endDateString:c});this.$timelineSelect.val(e.get("displayOption"));var f={overrideBrowserDefault:true,firstDay:1};this.$startDateInput.datePicker(f);this.$endDateInput.datePicker(f);Confluence.Roadmap.FieldUtilities.fixDatePickerFields(this.$timelineForm);var d=this;this.$startDateInput.on("change",function(){d.newTimeline.set({startDateString:d.$startDateInput.val()});d._validate()});this.$endDateInput.on("change",function(){d.newTimeline.set({endDateString:d.$endDateInput.val()});d._validate()})}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-timeline-view-resources', location = 'view/roadmap-editor/timeline/timeline-templates.soy' */
// This file was automatically generated from timeline-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Roadmap.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.timeline = function(opt_data, opt_ignored) {
  var output = '';
  var displayTimelineList3 = opt_data.displayTimelines;
  var displayTimelineListLen3 = displayTimelineList3.length;
  for (var displayTimelineIndex3 = 0; displayTimelineIndex3 < displayTimelineListLen3; displayTimelineIndex3++) {
    var displayTimelineData3 = displayTimelineList3[displayTimelineIndex3];
    output += '<div class="roadmap-column-title">' + ((displayTimelineIndex3 == 0 || displayTimelineData3.year != opt_data.displayTimelines[displayTimelineIndex3 - 1].year) ? '<span class="roadmap-column-year">' + soy.$$escapeHtml(displayTimelineData3.year) + '</span><br/>' : '') + soy.$$escapeHtml(displayTimelineData3.month) + '</div>';
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.timeline.soyTemplateName = 'Confluence.Templates.Roadmap.timeline';
}


Confluence.Templates.Roadmap.timelineColumn = function(opt_data, opt_ignored) {
  var output = '';
  var iLimit14 = opt_data.numberOfColumns;
  for (var i14 = 0; i14 < iLimit14; i14++) {
    output += '<div class="roadmap-column-item">&nbsp;</div>';
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.timelineColumn.soyTemplateName = 'Confluence.Templates.Roadmap.timelineColumn';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-timeline-view-resources', location = 'view/roadmap-editor/timeline/timeline.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};var c={};c.Helper=Confluence.Roadmap.Helper;Roadmap.TimelineView=Backbone.View.extend({className:"roadmap-frame-title",initialize:function(){a.bindAll(this,"render")},render:function(){this.model.calculateTimelineColumns();this.$el.html(Confluence.Templates.Roadmap.timeline({displayTimelines:this.model.get("displayTimelineColumns")}));return this},update:function(){this.render()},getBarPosition:function(d){if(this.model.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH){return{left:c.Helper.getPosXOnMonthTimeline(this.model.attributes,d.startDate),width:c.Helper.getWidthTimeline(this.model.attributes,d)}}return{left:c.Helper.getPosXOnWeekTimeline(this.model.attributes,d.startDate),width:c.Helper.getWidthTimeline(this.model.attributes,d)}},getBarDuration:function(d){return(this.model.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH)?(d/Roadmap.MONTH_WIDTH):(d/Roadmap.WEEK_WIDTH)},getBarStartDate:function(d){return(this.model.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH)?c.Helper.getMonthStartDateByPosition(this.model.attributes,d):c.Helper.getWeekStartDateByPosition(this.model.attributes,d)}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-timeline-view-resources', location = 'view/roadmap-editor/timeline/timeline-column.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};Roadmap.TimelineColumnView=Backbone.View.extend({className:"roadmap-frame-content",initialize:function(){a.bindAll(this,"render")},render:function(){var c=this.model.get("displayTimelineColumns").length;this.$el.html(Confluence.Templates.Roadmap.timelineColumn({numberOfColumns:c}));return this},updateHeight:function(c){this.$el.height(c)},update:function(){this.render()},getSizeAndPosition:function(){return{width:this.$el.width(),height:this.$el.height(),left:this.$el.position().left,top:this.$el.position().top}}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-dialog-resources', location = 'view/dialog-view.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};Roadmap.InlineDialogView=Backbone.View.extend({initialize:function(c){a.bindAll(this,"_onDocumentClick","_onKeyDown","_shouldHide","_onHide");this._trigger=c.trigger;this._dialogOptions=c.dialogOptions;this._reset();var d=this;b(".roadmap-editor-popup, .roadmap-macro-view").scroll(function(){d.hide()})},_shouldHideWhenClick:function(c){return !b.contains(this._inlineDialog[0],c.target)},_createInlineDialog:function(d,f){var e,g=this;function h(l,k,j){g._getContent(l);j()}function c(){g._onBeforeShow();a.delay(function(){AJS.InlineDialog.current=null;g._onShow();b(document).on({click:g._onDocumentClick,keydown:g._onKeyDown})},g._inlineDialog.getOptions().fadeTime)}var i={hideCallback:this._onHide,initCallback:c,noBind:true,persistent:true,preHideCallback:this._shouldHide};if(f&&f.isSideInlineDialog){a.extend(i,{calculatePositions:a.compose(this._calculateSidePositions,this._getSideDimensions),offsetX:8,offsetY:0});if(Raphael.version){a.extend(i,{getArrowPath:this._getSideArrowPath})}}e=new AJS.InlineDialog(d,"roadmap-dialog",h,a.extend({},i,f));return e},_onHide:function(){b(document).off({click:this._onDocumentClick,keydown:this._onKeyDown})},hide:function(){this._inlineDialog.remove()},_onDocumentClick:function(c){this._shouldHideWhenClick(c)&&this.hide()},_onBeforeShow:b.noop,_onKeyDown:function(f){var c=f.which===b.ui.keyCode.ESCAPE,d=b(f.target).is(":input");if(c&&!d){this.hide()}},_onShow:b.noop,_reset:function(){this._inlineDialog=this._createInlineDialog(this._trigger,this._dialogOptions);this.setElement(this._inlineDialog)},_shouldHide:function(){return true},show:function(){this._inlineDialog.show()},disable:function(){this.$el.find(":input").attr("disabled","disabled")},enable:function(){this.$el.find(":input").removeAttr("disabled")},_onSubmit:function(){throw new Error("DialogView subclasses must implement _onSubmit().")},_getSideDimensions:function(e,i,p,c){var k=c.container.toLowerCase()!=="body";var d=AJS.$(c.container);var l=k?AJS.$(c.container).parent():AJS.$(window);var n=k?d.offset():{left:0,top:0};var j=k?l.offset():{left:0,top:0};var g=i.target;var q=g.offset();var m=g[0].getBoundingClientRect&&g[0].getBoundingClientRect();var f=m?m.width:g.outerWidth();if(c.timelineWidth){var h=g.position();if(h.left+f>c.timelineWidth){f=c.timelineWidth-h.left-1}}var o={screenPadding:10,arrowMargin:5,window:{top:j.top,left:j.left,scrollTop:l.scrollTop(),scrollLeft:l.scrollLeft(),width:l.width(),height:l.height()},scrollContainer:{width:d.width(),height:d.height()},trigger:{top:q.top-n.top,left:q.left-n.left,width:f,height:m?m.height:g.outerHeight()},dialog:{width:e.width(),height:e.height(),offset:{top:c.offsetY,left:c.offsetX}},arrow:{height:e.find(".arrow").outerHeight()}};return o},_calculateSidePositions:function(i){var g=i.screenPadding;var h=i.window;var o=i.trigger;var y=i.dialog;var f=i.arrow;var s=i.scrollContainer;var A={top:o.top-h.scrollTop,left:o.left-h.scrollLeft};var t=Math.floor(o.height/2);var q=Math.floor(y.height/2);var p=Math.floor(f.height/2);var x=A.left-y.offset.left-g;var B=s.width-A.left-o.width-y.offset.left-g;var u=x>=y.width;var e=B>=y.width;var w=!e&&u?"left":"right";var k=A.top+t-p;var m=h.height-k-f.height;g=Math.min(g,k-i.arrowMargin);g=Math.min(g,m-i.arrowMargin);var l=Math.max(A.top-g,0);var c=Math.max(h.height-A.top-o.height-g,0);var d=Math.max(q-t-y.offset.top-l,0);var v=Math.max(q-t+y.offset.top-c,0);var j=d||-v||0;var r={top:o.top+t-q+y.offset.top+j,left:w==="right"?o.left+o.width+y.offset.left:o.left-y.width-y.offset.left};var z="w";var n={position:"absolute",top:q-p-j};if(w==="right"){n.right="auto";n.left=Raphael.version?"-7px":"0px"}else{n.right="-7px";n.left="auto";z="e"}return{dialogLocation:w,popupCss:r,arrowCss:n,gravity:z}},_getSideArrowPath:function(c){return c.dialogLocation==="right"?"M8,0L0,8,8,16":"M8,0L16,8,8,16"},refresh:function(){this._inlineDialog&&this._inlineDialog.refresh()}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-bar-dialog-resources', location = 'view/roadmap-editor/bar-dialog/bar-dialog-templates.soy' */
// This file was automatically generated from bar-dialog-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Roadmap.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.barDialog = function(opt_data, opt_ignored) {
  var output = '';
  var hasPageLink__soy3 = opt_data.bar.pageLink != null && opt_data.bar.pageLink.id != null;
  output += '<h3 id="bar-title" class="editable-field">' + soy.$$escapeHtml(opt_data.bar.title) + '</h3><div class="information"><div class="bar-page-link-wrapper">' + ((opt_data.linkPageEditable) ? '<div class="link-update-page ' + ((hasPageLink__soy3) ? 'hidden-field' : '') + '"><a href="#">' + soy.$$escapeHtml('\u94fe\u63a5\u9875\u9762') + '</a></div>' : '') + '<div class="bar-page-link editable-field ' + ((! hasPageLink__soy3) ? 'hidden-field' : '') + '">' + ((hasPageLink__soy3) ? Confluence.Templates.Roadmap.buildPageLink({pageLink: opt_data.bar.pageLink, isEditMode: opt_data.renderOption.isEditMode}) : '') + '</div>' + ((opt_data.linkPageEditable) ? '<div class="link-new-page' + ((hasPageLink__soy3) ? ' hidden-field' : '') + '"><span class=\'page-link-separator\'>\u2022</span><a href="#">' + soy.$$escapeHtml('\u521b\u5efa\u9875\u9762') + '</a></div>' : '') + '</div><div class="clear" /><div class="bar-description editable-field">' + soy.$$filterNoAutoescape(opt_data.bar.description) + '</div></div>' + ((opt_data.renderOption.isEditMode) ? '<div class="inner">' + aui.buttons.button({id: 'delete-button', text: '\u5220\u9664\u680f', type: 'link'}) + '</div>' : '');
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.barDialog.soyTemplateName = 'Confluence.Templates.Roadmap.barDialog';
}


Confluence.Templates.Roadmap.buildPageLink = function(opt_data, opt_ignored) {
  return '<a href=' + soy.$$escapeHtml("") + '/pages/viewpage.action?pageId=' + soy.$$escapeHtml(opt_data.pageLink.id) + ' ' + ((opt_data.isEditMode) ? 'target=\'_blank\'' : '') + ' class=\'confluence-link content-type-' + soy.$$escapeHtml(opt_data.pageLink.type) + '\'><span class="link-page-title">' + soy.$$escapeHtml(opt_data.pageLink.title) + '</span></a>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.buildPageLink.soyTemplateName = 'Confluence.Templates.Roadmap.buildPageLink';
}


Confluence.Templates.Roadmap.inlineEditSaveButton = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({id: 'inline-edit-save', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: '\u4fdd\u5b58'}, iconClass: 'aui-icon-small aui-iconfont-success'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.inlineEditSaveButton.soyTemplateName = 'Confluence.Templates.Roadmap.inlineEditSaveButton';
}


Confluence.Templates.Roadmap.inlineEditCancelButton = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({id: 'inline-edit-cancel', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: '\u53d6\u6d88'}, iconClass: 'aui-icon-small aui-iconfont-close-dialog'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.inlineEditCancelButton.soyTemplateName = 'Confluence.Templates.Roadmap.inlineEditCancelButton';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-bar-dialog-resources', location = 'view/roadmap-editor/bar-dialog/roadmap-editinplace.js' */
(function(g){g.fn.editInPlace=function(h){var i=g.extend({},g.fn.editInPlace.defaults,h);d(i);e(i.saving_image);return this.each(function(){var j=g(this);if(j.data("editInPlace")){return}j.data("editInPlace",true);new f(i,j).init()})};g.fn.editInPlace.defaults={url:"",bg_over:"#ffc",bg_out:"transparent",hover_class:"",form_extra_classes:[],show_buttons:false,save_button:'<button class="inplace_save">Save</button>',cancel_button:'<button class="inplace_cancel">Cancel</button>',params:"",field_type:"text",field_extra_classes:[],default_text:"(Click here to add text)",use_html:false,textarea_rows:10,textarea_cols:25,select_text:"Choose new value",select_options:"",text_size:null,saving_text:undefined,saving_image:"",saving_animation_color:"transparent",value_required:false,disable_submit_when_empty:false,element_id:"element_id",update_value:"update_value",original_value:"original_value",original_html:"original_html",save_if_nothing_changed:false,on_blur:"save",cancel:"",callback:null,callback_skip_dom_reset:false,success:null,error:null,error_sink:function(h,i){alert(i)},preinit:null,postclose:null,delegate:null,isAutoCompleteField:false};var c={shouldOpenEditInPlace:function(j,i,h){},willOpenEditInPlace:function(i,h){},didOpenEditInPlace:function(i,h){},shouldCloseEditInPlace:function(j,i,h){},willCloseEditInPlace:function(i,h){},didCloseEditInPlace:function(i,h){},missingCommaErrorPreventer:""};function f(h,i){this.settings=h;this.dom=i;this.originalValue=null;this.didInsertDefaultText=false;this.shouldDelayReinit=false}g.extend(f.prototype,{init:function(){this.setDefaultTextIfNeccessary();this.connectOpeningEvents()},reinit:function(){if(this.shouldDelayReinit){return}this.triggerCallback(this.settings.postclose,this.dom);this.triggerDelegateCall("didCloseEditInPlace");this.markEditorAsInactive();this.connectOpeningEvents()},setDefaultTextIfNeccessary:function(){if(""!==this.dom.html()){return}this.dom.html(this.settings.default_text);this.didInsertDefaultText=true},connectOpeningEvents:function(){var h=this;this.dom.bind("mouseenter.editInPlace",function(){h.addHoverEffect()}).bind("mouseleave.editInPlace",function(){h.removeHoverEffect()}).bind("click.editInPlace",function(i){h.openEditor(i)})},disconnectOpeningEvents:function(){this.dom.unbind(".editInPlace")},addHoverEffect:function(){if(this.settings.hover_class){this.dom.addClass(this.settings.hover_class)}else{this.dom.css("background-color",this.settings.bg_over)}},removeHoverEffect:function(){if(this.settings.hover_class){this.dom.removeClass(this.settings.hover_class)}else{this.dom.css("background-color",this.settings.bg_out)}},openEditor:function(h){if(!this.shouldOpenEditor(h)){return}this.disconnectOpeningEvents();this.removeHoverEffect();this.removeInsertedDefaultTextIfNeccessary();this.saveOriginalValue();this.markEditorAsActive();this.replaceContentWithEditor();this.setInitialValue();this.workAroundMissingBlurBug();this.connectClosingEventsToEditor();this.triggerDelegateCall("didOpenEditInPlace")},shouldOpenEditor:function(h){if(this.isClickedObjectCancelled(h.target)){return false}if(false===this.triggerCallback(this.settings.preinit,this.dom)){return false}if(false===this.triggerDelegateCall("shouldOpenEditInPlace",true,h)){return false}if(this.settings.isAutoCompleteField&&g(h.target).hasClass("link-page-title")){return false}return true},removeInsertedDefaultTextIfNeccessary:function(){if(!this.didInsertDefaultText||this.dom.html()!==this.settings.default_text){return}this.dom.html("");this.didInsertDefaultText=false},isClickedObjectCancelled:function(j){if(!this.settings.cancel){return false}var h=g(j).parents().andSelf();var i=h.filter(this.settings.cancel);return 0!==i.length},saveOriginalValue:function(){if(this.settings.use_html){this.originalValue=this.dom.html()}else{this.originalValue=a(this.dom.text())}},restoreOriginalValue:function(){this.setClosedEditorContent(this.originalValue)},setClosedEditorContent:function(h){h=h||this.settings.default_text;if(this.settings.use_html){this.dom.html(h)}else{this.dom.text(h)}},workAroundMissingBlurBug:function(){var h=this.dom.find(":input");this.dom.parents(":last").find(".editInPlace-active :input").not(h).blur()},replaceContentWithEditor:function(){var m=this.createEditorElement();var h="inplace_form";if(this.settings.form_extra_classes instanceof Array){h=h+" "+this.settings.form_extra_classes.join(" ")}this.dom.html('<form class="'+h+'" style="display: inline; margin: 0; padding: 0;"></form>');var j=this.dom.find("form");j.append(m);if(this.settings.show_buttons){var i=g('<div class="inline-edit-buttons"></div>');var k=g(this.settings.save_button);k.addClass("inplace_save");i.append(k);var l=g(this.settings.cancel_button);l.addClass("inplace_cancel");i.append(l);j.append(i)}},createEditorElement:function(){if(-1===g.inArray(this.settings.field_type,["text","textarea","select"])){throw"Unknown field_type <fnord>, supported are 'text', 'textarea' and 'select'"}var h=null;if("select"===this.settings.field_type){h=this.createSelectEditor()}else{if("text"===this.settings.field_type){h=g('<input type="text" '+this.inputNameAndClass()+' size="'+this.settings.text_size+'" />')}else{if("textarea"===this.settings.field_type){h=g("<textarea "+this.inputNameAndClass()+' rows="'+this.settings.textarea_rows+'"  cols="'+this.settings.textarea_cols+'" />')}}}return h},setInitialValue:function(){var h=this.triggerDelegateCall("willOpenEditInPlace",this.originalValue);var i=this.dom.find(":input");i.val(h);if(i.val()!==h){i.val("")}},inputNameAndClass:function(){var h="inplace_field";if(this.settings.field_extra_classes instanceof Array){h=h+" "+this.settings.field_extra_classes.join(" ")}return' name="inplace_value" class="'+h+'"'},createSelectEditor:function(){var m=g("<select"+this.inputNameAndClass()+'><option disabled="true" value="">'+this.settings.select_text+"</option></select>");var j=this.settings.select_options;if(!g.isArray(j)){j=j.split(",")}for(var k=0;k<j.length;k++){var h=j[k];if(!g.isArray(h)){h=h.split(":")}var n=a(h[1]||h[0]);var o=a(h[0]);var l=g("<option>").val(n).text(o);m.append(l)}return m},connectClosingEventsToEditor:function(){var k=this;function j(l){if(!k.settings.isAutoCompleteField){k.handleCancelEditor(l)}return false}function h(l){k.handleSaveEditor(l);return false}var i=this.dom.find("form");i.find(".inplace_field").focus().select();i.find(".inplace_cancel").click(j);i.find(".inplace_save").click(h);if(!this.settings.show_buttons){if("save"===this.settings.on_blur){i.find(".inplace_field").blur(h)}else{i.find(".inplace_field").blur(j)}}i.keyup(function(l){var m=27;if(m===l.which){return j()}});this.bindInputKeyup();i.submit(h)},bindSubmitOnEnterInInput:function(){if("textarea"===this.settings.field_type){return}var h=this;this.dom.find(":input").keyup(function(i){var j=13;if(j===i.which){return h.dom.find("form").submit()}})},bindInputKeyup:function(){if("textarea"===this.settings.field_type){return}var i=this;var h=this.dom.find(":input");var j=this.dom.find(".inplace_save");h.keyup(function(k){var l=13;if(l===k.which){return i.dom.find("form").submit()}else{if(i.settings.disable_submit_when_empty){if(g.trim(h.val()).length){j.removeAttr("disabled")}else{j.attr("disabled","disabled")}}}})},handleCancelEditor:function(h){if(false===this.triggerDelegateCall("shouldCloseEditInPlace",true,h)){return}var i=this.dom.find(":input").val();i=this.triggerDelegateCall("willCloseEditInPlace",i);this.restoreOriginalValue();this.reinit()},handleSaveEditor:function(h){if(false===this.triggerDelegateCall("shouldCloseEditInPlace",true,h)){return}var i=g.trim(this.dom.find(":input").val());i=this.triggerDelegateCall("willCloseEditInPlace",i);if(this.isDisabledDefaultSelectChoice()||this.isUnchangedInput(i)){this.handleCancelEditor(h);return}if(this.didForgetRequiredText(i)){if(this.settings.disable_submit_when_empty){return}this.handleCancelEditor(h);this.reportError("Error: You must enter a value to save this field");return}this.showSaving(i);if(this.settings.callback){this.handleSubmitToCallback(i)}else{this.handleSubmitToServer(i)}},didForgetRequiredText:function(h){return this.settings.value_required&&(""===h||undefined===h||null===h)},isDisabledDefaultSelectChoice:function(){return this.dom.find("option").eq(0).is(":selected:disabled")},isUnchangedInput:function(h){return !this.settings.save_if_nothing_changed&&this.originalValue===h},showSaving:function(i){if(this.settings.callback&&this.settings.callback_skip_dom_reset){return}var h=i;if(b(this.settings.saving_text)){h=this.settings.saving_text}if(b(this.settings.saving_image)){h=g("<img />").attr("src",this.settings.saving_image).attr("alt",h)}this.dom.html(encodeURIComponent(h))},handleSubmitToCallback:function(h){this.enableOrDisableAnimationCallbacks(true,false);var i=this.triggerCallback(this.settings.callback,this.id(),h,this.originalValue,this.settings.params,this.savingAnimationCallbacks());if(this.settings.callback_skip_dom_reset){}else{if(undefined===i){this.reportError("Error: Failed to save value: "+h);this.restoreOriginalValue()}else{this.dom.html(i)}}if(this.didCallNoCallbacks()){this.enableOrDisableAnimationCallbacks(false,false);this.reinit()}},handleSubmitToServer:function(h){var j=this.settings.update_value+"="+encodeURIComponent(h)+"&"+this.settings.element_id+"="+this.dom.attr("id")+((this.settings.params)?"&"+this.settings.params:"")+"&"+this.settings.original_html+"="+encodeURIComponent(this.originalValue)+"&"+this.settings.original_value+"="+encodeURIComponent(this.originalValue);this.enableOrDisableAnimationCallbacks(true,false);this.didStartSaving();var i=this;g.ajax({url:i.settings.url,type:"POST",data:j,dataType:"html",complete:function(k){i.didEndSaving()},success:function(l){var k=l||i.settings.default_text;i.dom.html(k);i.triggerCallback(i.settings.success,l)},error:function(k){i.dom.html(i.originalHTML);if(i.settings.error){i.triggerCallback(i.settings.error,k)}else{i.reportError("Failed to save value: "+k.responseText||"Unspecified Error")}}})},triggerCallback:function(i){if(!i){return}var h=Array.prototype.slice.call(arguments,1);return i.apply(this.dom[0],h)},triggerDelegateCall:function(j,i,h){if(!this.settings.delegate||!g.isFunction(this.settings.delegate[j])){return i}var k=this.settings.delegate[j](this.dom,this.settings,h);return(undefined===k)?i:k},reportError:function(h){this.triggerCallback(this.settings.error_sink,this.id(),h)},id:function(){return this.dom.attr("id")},markEditorAsActive:function(){this.dom.addClass("editInPlace-active")},markEditorAsInactive:function(){this.dom.removeClass("editInPlace-active")},savingAnimationCallbacks:function(){var h=this;return{didStartSaving:function(){h.didStartSaving()},didEndSaving:function(){h.didEndSaving()}}},enableOrDisableAnimationCallbacks:function(i,h){this.didStartSaving.enabled=i;this.didEndSaving.enabled=h},didCallNoCallbacks:function(){return this.didStartSaving.enabled&&!this.didEndSaving.enabled},assertCanCall:function(h){if(!this[h].enabled){throw new Error("Cannot call "+h+" now. See documentation for details.")}},didStartSaving:function(){this.assertCanCall("didStartSaving");this.shouldDelayReinit=true;this.enableOrDisableAnimationCallbacks(false,true);this.startSavingAnimation()},didEndSaving:function(){this.assertCanCall("didEndSaving");this.shouldDelayReinit=false;this.enableOrDisableAnimationCallbacks(false,false);this.reinit();this.stopSavingAnimation()},startSavingAnimation:function(){var h=this;this.dom.animate({backgroundColor:this.settings.saving_animation_color},400).animate({backgroundColor:"transparent"},400,"swing",function(){setTimeout(function(){h.startSavingAnimation()},10)})},stopSavingAnimation:function(){this.dom.stop(true).css({backgroundColor:""})},missingCommaErrorPreventer:""});function d(h){if(h.url||h.callback){return}throw new Error("Need to set either url: or callback: option for the inline editor to work.")}function e(i){if(""===i){return}var h=new Image();h.src=i}function a(h){return h.replace(/^\s+/,"").replace(/\s+$/,"")}function b(h){if(undefined===h||null===h){return false}if(0===h.length){return false}return true}})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-bar-dialog-resources', location = 'view/roadmap-editor/bar-dialog/bar-dialog.js' */
(function(c,a){var b=Roadmap.InlineDialogView;Roadmap.BarDialogView=b.extend({events:{"click #delete-button":"_onDeleteClick","click .link-new-page":"_goToCreateLinkPage","click .link-update-page":"_goToUpdateLinkPage"},initialize:function(){a.bindAll(this,"_onPageLinkOpen","_onPageLinkSelectCompleted","_onPageLinkCallback","_onPageLinkBlur","_goToCreateLinkPage");this.options.dialogOptions={width:260,timelineWidth:this.options.timelineWidth,isSideInlineDialog:true,renderOption:this.options.renderOption,linkPageEditable:this.options.linkPageEditable,createLinkPageCallback:this.options.createLinkPageCallback};b.prototype.initialize.call(this,this.options)},_getContent:function(d){d.html(Confluence.Templates.Roadmap.barDialog({bar:a.extend({},this.model.attributes,{description:AJS.escapeHtml(this.model.attributes.description).replace(/\r?\n/g,"<br />")}),renderOption:this.options.dialogOptions.renderOption,linkPageEditable:this.options.dialogOptions.linkPageEditable}))},_onBeforeShow:function(){this.fields=this._getFields();this._setupInlineEdit()},_getFields:function(){return{$title:this.$el.find("#bar-title"),$description:this.$el.find(".bar-description"),$pageLink:this.$el.find(".bar-page-link"),$pageLinkNew:this.$el.find(".link-new-page"),$pageLinkUpdate:this.$el.find(".link-update-page")}},_setupInlineEdit:function(){var f=this;var d=this.fields;var i=this.options.dialogOptions.renderOption.editInplace;var e={form_extra_classes:["aui"],hover_class:"editable-field-hover aui-icon-small aui-iconfont-edit",field_extra_classes:["text"],show_buttons:true,save_button:Confluence.Templates.Roadmap.inlineEditSaveButton(),cancel_button:Confluence.Templates.Roadmap.inlineEditCancelButton(),error_sink:null,use_html:true,default_text:"\u70b9\u51fb\u6dfb\u52a0\u63cf\u8ff0",delegate:{shouldOpenEditInPlace:function(){f.$el.find(".inplace_cancel").trigger("click")},didCloseEditInPlace:function(){setTimeout(function(){f.refresh()},0)}}};i.title&&d.$title.editInPlace(c.extend(true,{},e,{callback:function(j,k){f.options.updateTitle(k);return AJS.escapeHtml(k)},value_required:true,disable_submit_when_empty:true,delegate:{willOpenEditInPlace:function(){f.refresh();d.$title.find(".text").attr("maxlength",Roadmap.BarDialog.MAX_LENGTH_TITLE)}}}));(c.trim(d.$description.text())==="")?d.$description.addClass("empty-field"):d.$description.removeClass("empty-field");var g=c.extend(true,{},e,{field_type:"textarea",field_extra_classes:["textarea"],value_required:false,save_if_nothing_changed:true,callback:function(j,k){k=c.trim(k);f.options.updateDescription(k);if(k===""){k="\u70b9\u51fb\u6dfb\u52a0\u63cf\u8ff0";c(this).addClass("empty-field")}else{c(this).removeClass("empty-field");Confluence.Roadmap.Analytics.addDescription()}return AJS.escapeHtml(k).replace(/\r?\n/g,"<br />")},delegate:{willOpenEditInPlace:function(){f.refresh();d.$description.find(".textarea").attr("maxlength",Roadmap.BarDialog.MAX_LENGTH_DESCRIPTION);return f.model.attributes.description.replace(/<br\s*[\/]?>/gi,"\n")}}});i.description&&d.$description.editInPlace(g);var h=c.extend(true,{},e,{isAutoCompleteField:true,show_buttons:false,default_text:"",field_extra_classes:["text","autocomplete-confluence-content"],delegate:{willOpenEditInPlace:f._onPageLinkOpen,didCloseEditInPlace:function(){if(a.isEmpty(d.$pageLink.data("linkData"))){d.$pageLink.hide();d.$pageLinkNew.show();d.$pageLinkUpdate.show()}}},on_blur:null,callback:f._onPageLinkCallback});i.pageLink&&this.options.dialogOptions.linkPageEditable&&this.fields.$pageLink.editInPlace(h)},_onPageLinkOpen:function(e){var f=this;e.append('<div class="link-page-dropdown" />');var g=e.find(".autocomplete-confluence-content");g.attr({placeholder:"\u641c\u7d22\u9875\u9762","data-dropdown-target":"#inline-dialog-roadmap-dialog .link-page-dropdown","data-none-message":"\u6ca1\u6709\u5339\u914d\u7ed3\u679c"});Confluence.Binder.autocompleteConfluenceContent(e);g.bind("selected.autocomplete-content",this._onPageLinkSelectCompleted);g.on("blur",function(){setTimeout(f._onPageLinkBlur,150)});var d=this.model.attributes.pageLink;this.fields.$pageLink.data("linkData",d);if(!a.isEmpty(d)){return d.title}return true},_onPageLinkSelectCompleted:function(d,g){d.stopPropagation();var f=this.fields.$pageLink.find(".autocomplete-confluence-content");var e=g.content;f.val(e.title);this.fields.$pageLink.data("linkData",g.content);a.defer(this._onPageLinkBlur)},_onPageLinkBlur:function(){var d=this.fields.$pageLink.find(".autocomplete-confluence-content");var f=c.Event("keyup");f.which=AJS.keyCode.ENTER;d.trigger(f)},_onPageLinkCallback:function(e,f){var d=(f==="")?{}:this.fields.$pageLink.data("linkData");return this._updatePageLink(d)},_updatePageLink:function(e){if(e.id===this.model.attributes.pageLink.id){return}var d=this.fields;if(a.isEmpty(e)){this.options.updatePageLink({});d.$pageLink.hide();d.$pageLinkNew.show();d.$pageLinkUpdate.show();return "\u6ca1\u6709\u94fe\u63a5\u9875\u9762"}else{var f=a.pick(e,"id","title","type","spaceKey","wikiLink");if(!e.spaceKey){f.spaceKey=e.space.key}this.options.updatePageLink(f);d.$pageLink.show();d.$pageLinkNew.hide();d.$pageLinkUpdate.hide();if(this.options.renderOption.isEditMode){Confluence.Roadmap.Analytics.addPageLinkEditMode({linkedPageId:e.id,pageId:AJS.Meta.get("page-id")>0?AJS.Meta.get("page-id"):AJS.Meta.get("draft-id"),isDraft:AJS.Meta.get("page-id")<=0})}else{Confluence.Roadmap.Analytics.addPageLinkViewMode({linkedPageId:e.id,pageId:AJS.Meta.get("page-id")})}return Confluence.Templates.Roadmap.buildPageLink({pageLink:e,isEditMode:this.options.renderOption.isEditMode})}},_onDeleteClick:function(){this.options.deleteBar();this.remove()},_goToCreateLinkPage:function(f){var e=this.options.dialogOptions;if(e.createLinkPageCallback){var d=a.bind(e.createLinkPageCallback,{me:this},f);d()}},_goToUpdateLinkPage:function(d){d.preventDefault();this.fields.$pageLink.show();this.fields.$pageLinkNew.hide();this.fields.$pageLinkUpdate.hide();this.fields.$pageLink.click()}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-bar-dialog-resources', location = 'view/roadmap-editor/bar-dialog/bar-link-new-page.js' */
Confluence.RoadmapLink=(function(f,a){Roadmap.trackingBars=[];function c(j,k){var g={};if(parseInt(j.pageId)<=0){j.parentPageId=AJS.Meta.get("parent-page-id")}var h=f.param(j);var i=window.open(AJS.contextPath()+"/plugins/roadmap/create-page.action?"+h,"_blank");i.opener=null;b(j.roadmapBarId).done(function(l){Roadmap.trackingBars.push(j.roadmapBarId)});f(window).off("focus");f(window).on("focus",function(){if(!Roadmap.trackingBars.length){f(window).off("focus")}a.each(Roadmap.trackingBars,function(l){d(l).done(function(n){var m=n.status;if(m=="REDEEM"){e(l);k({barId:l,pageLink:f.parseJSON(n.pageLink)})}else{if(m=="UNKNOWN"){e(l)}}})})})}function e(g){Roadmap.trackingBars.splice(Roadmap.trackingBars.indexOf(g),1)}function b(g){return f.ajax({contentType:"application/json",type:"PUT",url:AJS.contextPath()+"/rest/roadmap/1.0/bar/"+g+"/PENDING"})}function d(g){return f.ajax({contentType:"application/json",type:"GET",url:AJS.contextPath()+"/rest/roadmap/1.0/bar/"+g+"/status"})}return{addCreateLinkPageListener:c}})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.vendors--825acd7236', location = 'aui.chunk.30cfc3ee698da81b10f9--0731854b3b05e314e279.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.vendors--825acd7236"],{PTCr:function(e,t,i){var s,o,n;o=[i("oDIA"),i("z+ct"),i("XPYc"),i("O+lX"),i("yIBB")],void 0===(n="function"==typeof(s=function(e){e.widget("ui.droppable",{version:"1.12.1",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,i=this.options,s=i.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(s)?s:function(e){return e.is(s)},this.proportions=function(){if(!arguments.length)return t||(t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight});t=arguments[0]},this._addToManager(i.scope),i.addClasses&&this._addClass("ui-droppable")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[],e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){for(var t=0;t<e.length;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t)},_setOption:function(t,i){if("accept"===t)this.accept=e.isFunction(i)?i:function(e){return e.is(i)};else if("scope"===t){var s=e.ui.ddmanager.droppables[this.options.scope];this._splice(s),this._addToManager(i)}this._super(t,i)},_activate:function(t){var i=e.ui.ddmanager.current;this._addActiveClass(),i&&this._trigger("activate",t,this.ui(i))},_deactivate:function(t){var i=e.ui.ddmanager.current;this._removeActiveClass(),i&&this._trigger("deactivate",t,this.ui(i))},_over:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this._addHoverClass(),this._trigger("over",t,this.ui(i)))},_out:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this._removeHoverClass(),this._trigger("out",t,this.ui(i)))},_drop:function(i,s){var o=s||e.ui.ddmanager.current,n=!1;return!(!o||(o.currentItem||o.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var s=e(this).droppable("instance");if(s.options.greedy&&!s.options.disabled&&s.options.scope===o.options.scope&&s.accept.call(s.element[0],o.currentItem||o.element)&&t(o,e.extend(s,{offset:s.element.offset()}),s.options.tolerance,i))return n=!0,!1}),!n&&!!this.accept.call(this.element[0],o.currentItem||o.element)&&(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",i,this.ui(o)),this.element))},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}});var t=e.ui.intersect=function(){function e(e,t,i){return e>=t&&e<t+i}return function(t,i,s,o){if(!i.offset)return!1;var n=(t.positionAbs||t.position.absolute).left+t.margins.left,r=(t.positionAbs||t.position.absolute).top+t.margins.top,a=n+t.helperProportions.width,l=r+t.helperProportions.height,p=i.offset.left,c=i.offset.top,d=p+i.proportions().width,h=c+i.proportions().height;switch(s){case"fit":return p<=n&&a<=d&&c<=r&&l<=h;case"intersect":return p<n+t.helperProportions.width/2&&a-t.helperProportions.width/2<d&&c<r+t.helperProportions.height/2&&l-t.helperProportions.height/2<h;case"pointer":return e(o.pageY,c,i.proportions().height)&&e(o.pageX,p,i.proportions().width);case"touch":return(r>=c&&r<=h||l>=c&&l<=h||r<c&&l>h)&&(n>=p&&n<=d||a>=p&&a<=d||n<p&&a>d);default:return!1}}}();return e.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(t,i){var s,o,n=e.ui.ddmanager.droppables[t.options.scope]||[],r=i?i.type:null,a=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(s=0;s<n.length;s++)if(!(n[s].options.disabled||t&&!n[s].accept.call(n[s].element[0],t.currentItem||t.element))){for(o=0;o<a.length;o++)if(a[o]===n[s].element[0]){n[s].proportions().height=0;continue e}n[s].visible="none"!==n[s].element.css("display"),n[s].visible&&("mousedown"===r&&n[s]._activate.call(n[s],i),n[s].offset=n[s].element.offset(),n[s].proportions({width:n[s].element[0].offsetWidth,height:n[s].element[0].offsetHeight}))}},drop:function(i,s){var o=!1;return e.each((e.ui.ddmanager.droppables[i.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&t(i,this,this.options.tolerance,s)&&(o=this._drop.call(this,s)||o),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,s)))}),o},dragStart:function(t,i){t.element.parentsUntil("body").on("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)})},drag:function(i,s){i.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(i,s),e.each(e.ui.ddmanager.droppables[i.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var o,n,r,a=t(i,this,this.options.tolerance,s),l=!a&&this.isover?"isout":a&&!this.isover?"isover":null;l&&(this.options.greedy&&(n=this.options.scope,(r=this.element.parents(":data(ui-droppable)").filter(function(){return e(this).droppable("instance").options.scope===n})).length&&((o=e(r[0]).droppable("instance")).greedyChild="isover"===l)),o&&"isover"===l&&(o.isover=!1,o.isout=!0,o._out.call(o,s)),this[l]=!0,this["isout"===l?"isover":"isout"]=!1,this["isover"===l?"_over":"_out"].call(this,s),o&&"isout"===l&&(o.isout=!1,o.isover=!0,o._over.call(o,s)))}})},dragStop:function(t,i){t.element.parentsUntil("body").off("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)}},!1!==e.uiBackCompat&&e.widget("ui.droppable",e.ui.droppable,{options:{hoverClass:!1,activeClass:!1},_addActiveClass:function(){this._super(),this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super(),this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super(),this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},_removeHoverClass:function(){this._super(),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}}),e.ui.droppable})?s.apply(t,o):s)||(e.exports=n)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_jquery.ui.droppable', location = 'aui.chunk.5976981f3956e6072e63--b76bd90276ad9a25b9fb.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["jquery.ui.droppable"],{qe8r:function(u,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i("PTCr"),e.default="jquery",u.exports=e.default}},[["qe8r","runtime","aui.splitchunk.vendors--20a97d6a33","aui.splitchunk.vendors--d18e3cafa7","aui.splitchunk.vendors--db57146687","aui.splitchunk.vendors--51504ebf10","aui.splitchunk.vendors--9c8c8c1546","aui.splitchunk.vendors--351ae504d7","aui.splitchunk.vendors--06bc6ae5d7","aui.splitchunk.vendors--825acd7236","aui.splitchunk.172ffb6da7"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.vendors--85718a7eef', location = 'aui.chunk.ae3c4b97fc5a1976668b--c6988b4dfd3c4a3d1198.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.vendors--85718a7eef"],{"2V+C":function(t,i,e){},XnJT:function(t,i,e){var s,h,n;h=[e("oDIA"),e("XPYc"),e("zq/Y"),e("lSwU"),e("O+lX"),e("yIBB")],void 0===(n="function"==typeof(s=function(t){return t.widget("ui.resizable",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(t){return parseFloat(t)||0},_isNumber:function(t){return!isNaN(parseFloat(t))},_hasScroll:function(i,e){if("hidden"===t(i).css("overflow"))return!1;var s,h=e&&"left"===e?"scrollLeft":"scrollTop";return i[h]>0||(i[h]=1,s=i[h]>0,i[h]=0,s)},_create:function(){var i,e=this.options,s=this;this._addClass("ui-resizable"),t.extend(this,{_aspectRatio:!!e.aspectRatio,aspectRatio:e.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:e.helper||e.ghost||e.animate?e.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(t("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,i={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")},this.element.css(i),this.originalElement.css("margin",0),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css(i),this._proportionallyResize()),this._setupHandles(),e.autoHide&&t(this.element).on("mouseenter",function(){e.disabled||(s._removeClass("ui-resizable-autohide"),s._handles.show())}).on("mouseleave",function(){e.disabled||s.resizing||(s._addClass("ui-resizable-autohide"),s._handles.hide())}),this._mouseInit()},_destroy:function(){this._mouseDestroy();var i,e=function(i){t(i).removeData("resizable").removeData("ui-resizable").off(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(e(this.element),i=this.element,this.originalElement.css({position:i.css("position"),width:i.outerWidth(),height:i.outerHeight(),top:i.css("top"),left:i.css("left")}).insertAfter(i),i.remove()),this.originalElement.css("resize",this.originalResizeStyle),e(this.originalElement),this},_setOption:function(t,i){switch(this._super(t,i),t){case"handles":this._removeHandles(),this._setupHandles()}},_setupHandles:function(){var i,e,s,h,n,o=this.options,a=this;if(this.handles=o.handles||(t(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=t(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),s=this.handles.split(","),this.handles={},e=0;e<s.length;e++)h="ui-resizable-"+(i=t.trim(s[e])),n=t("<div>"),this._addClass(n,"ui-resizable-handle "+h),n.css({zIndex:o.zIndex}),this.handles[i]=".ui-resizable-"+i,this.element.append(n);this._renderAxis=function(i){var e,s,h,n;for(e in i=i||this.element,this.handles)this.handles[e].constructor===String?this.handles[e]=this.element.children(this.handles[e]).first().show():(this.handles[e].jquery||this.handles[e].nodeType)&&(this.handles[e]=t(this.handles[e]),this._on(this.handles[e],{mousedown:a._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(s=t(this.handles[e],this.element),n=/sw|ne|nw|se|n|s/.test(e)?s.outerHeight():s.outerWidth(),h=["padding",/ne|nw|n/.test(e)?"Top":/se|sw|s/.test(e)?"Bottom":/^e$/.test(e)?"Right":"Left"].join(""),i.css(h,n),this._proportionallyResize()),this._handles=this._handles.add(this.handles[e])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.on("mouseover",function(){a.resizing||(this.className&&(n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),a.axis=n&&n[1]?n[1]:"se")}),o.autoHide&&(this._handles.hide(),this._addClass("ui-resizable-autohide"))},_removeHandles:function(){this._handles.remove()},_mouseCapture:function(i){var e,s,h=!1;for(e in this.handles)((s=t(this.handles[e])[0])===i.target||t.contains(s,i.target))&&(h=!0);return!this.options.disabled&&h},_mouseStart:function(i){var e,s,h,n=this.options,o=this.element;return this.resizing=!0,this._renderProxy(),e=this._num(this.helper.css("left")),s=this._num(this.helper.css("top")),n.containment&&(e+=t(n.containment).scrollLeft()||0,s+=t(n.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:e,top:s},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:o.width(),height:o.height()},this.originalSize=this._helper?{width:o.outerWidth(),height:o.outerHeight()}:{width:o.width(),height:o.height()},this.sizeDiff={width:o.outerWidth()-o.width(),height:o.outerHeight()-o.height()},this.originalPosition={left:e,top:s},this.originalMousePosition={left:i.pageX,top:i.pageY},this.aspectRatio="number"==typeof n.aspectRatio?n.aspectRatio:this.originalSize.width/this.originalSize.height||1,h=t(".ui-resizable-"+this.axis).css("cursor"),t("body").css("cursor","auto"===h?this.axis+"-resize":h),this._addClass("ui-resizable-resizing"),this._propagate("start",i),!0},_mouseDrag:function(i){var e,s,h=this.originalMousePosition,n=this.axis,o=i.pageX-h.left||0,a=i.pageY-h.top||0,l=this._change[n];return this._updatePrevProperties(),!!l&&(e=l.apply(this,[i,o,a]),this._updateVirtualBoundaries(i.shiftKey),(this._aspectRatio||i.shiftKey)&&(e=this._updateRatio(e,i)),e=this._respectSize(e,i),this._updateCache(e),this._propagate("resize",i),s=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),t.isEmptyObject(s)||(this._updatePrevProperties(),this._trigger("resize",i,this.ui()),this._applyChanges()),!1)},_mouseStop:function(i){this.resizing=!1;var e,s,h,n,o,a,l,r=this.options;return this._helper&&(h=(s=(e=this._proportionallyResizeElements).length&&/textarea/i.test(e[0].nodeName))&&this._hasScroll(e[0],"left")?0:this.sizeDiff.height,n=s?0:this.sizeDiff.width,o={width:this.helper.width()-n,height:this.helper.height()-h},a=parseFloat(this.element.css("left"))+(this.position.left-this.originalPosition.left)||null,l=parseFloat(this.element.css("top"))+(this.position.top-this.originalPosition.top)||null,r.animate||this.element.css(t.extend(o,{top:l,left:a})),this.helper.height(this.size.height),this.helper.width(this.size.width),this._helper&&!r.animate&&this._proportionallyResize()),t("body").css("cursor","auto"),this._removeClass("ui-resizable-resizing"),this._propagate("stop",i),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var t={};return this.position.top!==this.prevPosition.top&&(t.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(t.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(t.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(t.height=this.size.height+"px"),this.helper.css(t),t},_updateVirtualBoundaries:function(t){var i,e,s,h,n,o=this.options;n={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||t)&&(i=n.minHeight*this.aspectRatio,s=n.minWidth/this.aspectRatio,e=n.maxHeight*this.aspectRatio,h=n.maxWidth/this.aspectRatio,i>n.minWidth&&(n.minWidth=i),s>n.minHeight&&(n.minHeight=s),e<n.maxWidth&&(n.maxWidth=e),h<n.maxHeight&&(n.maxHeight=h)),this._vBoundaries=n},_updateCache:function(t){this.offset=this.helper.offset(),this._isNumber(t.left)&&(this.position.left=t.left),this._isNumber(t.top)&&(this.position.top=t.top),this._isNumber(t.height)&&(this.size.height=t.height),this._isNumber(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var i=this.position,e=this.size,s=this.axis;return this._isNumber(t.height)?t.width=t.height*this.aspectRatio:this._isNumber(t.width)&&(t.height=t.width/this.aspectRatio),"sw"===s&&(t.left=i.left+(e.width-t.width),t.top=null),"nw"===s&&(t.top=i.top+(e.height-t.height),t.left=i.left+(e.width-t.width)),t},_respectSize:function(t){var i=this._vBoundaries,e=this.axis,s=this._isNumber(t.width)&&i.maxWidth&&i.maxWidth<t.width,h=this._isNumber(t.height)&&i.maxHeight&&i.maxHeight<t.height,n=this._isNumber(t.width)&&i.minWidth&&i.minWidth>t.width,o=this._isNumber(t.height)&&i.minHeight&&i.minHeight>t.height,a=this.originalPosition.left+this.originalSize.width,l=this.originalPosition.top+this.originalSize.height,r=/sw|nw|w/.test(e),p=/nw|ne|n/.test(e);return n&&(t.width=i.minWidth),o&&(t.height=i.minHeight),s&&(t.width=i.maxWidth),h&&(t.height=i.maxHeight),n&&r&&(t.left=a-i.minWidth),s&&r&&(t.left=a-i.maxWidth),o&&p&&(t.top=l-i.minHeight),h&&p&&(t.top=l-i.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},_getPaddingPlusBorderDimensions:function(t){for(var i=0,e=[],s=[t.css("borderTopWidth"),t.css("borderRightWidth"),t.css("borderBottomWidth"),t.css("borderLeftWidth")],h=[t.css("paddingTop"),t.css("paddingRight"),t.css("paddingBottom"),t.css("paddingLeft")];i<4;i++)e[i]=parseFloat(s[i])||0,e[i]+=parseFloat(h[i])||0;return{height:e[0]+e[2],width:e[1]+e[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var t,i=0,e=this.helper||this.element;i<this._proportionallyResizeElements.length;i++)t=this._proportionallyResizeElements[i],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(t)),t.css({height:e.height()-this.outerDimensions.height||0,width:e.width()-this.outerDimensions.width||0})},_renderProxy:function(){var i=this.element,e=this.options;this.elementOffset=i.offset(),this._helper?(this.helper=this.helper||t("<div style='overflow:hidden;'></div>"),this._addClass(this.helper,this._helper),this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++e.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(t,i){return{width:this.originalSize.width+i}},w:function(t,i){var e=this.originalSize;return{left:this.originalPosition.left+i,width:e.width-i}},n:function(t,i,e){var s=this.originalSize;return{top:this.originalPosition.top+e,height:s.height-e}},s:function(t,i,e){return{height:this.originalSize.height+e}},se:function(i,e,s){return t.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[i,e,s]))},sw:function(i,e,s){return t.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[i,e,s]))},ne:function(i,e,s){return t.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[i,e,s]))},nw:function(i,e,s){return t.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[i,e,s]))}},_propagate:function(i,e){t.ui.plugin.call(this,i,[e,this.ui()]),"resize"!==i&&this._trigger(i,e,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),t.ui.plugin.add("resizable","animate",{stop:function(i){var e=t(this).resizable("instance"),s=e.options,h=e._proportionallyResizeElements,n=h.length&&/textarea/i.test(h[0].nodeName),o=n&&e._hasScroll(h[0],"left")?0:e.sizeDiff.height,a=n?0:e.sizeDiff.width,l={width:e.size.width-a,height:e.size.height-o},r=parseFloat(e.element.css("left"))+(e.position.left-e.originalPosition.left)||null,p=parseFloat(e.element.css("top"))+(e.position.top-e.originalPosition.top)||null;e.element.animate(t.extend(l,p&&r?{top:p,left:r}:{}),{duration:s.animateDuration,easing:s.animateEasing,step:function(){var s={width:parseFloat(e.element.css("width")),height:parseFloat(e.element.css("height")),top:parseFloat(e.element.css("top")),left:parseFloat(e.element.css("left"))};h&&h.length&&t(h[0]).css({width:s.width,height:s.height}),e._updateCache(s),e._propagate("resize",i)}})}}),t.ui.plugin.add("resizable","containment",{start:function(){var i,e,s,h,n,o,a,l=t(this).resizable("instance"),r=l.options,p=l.element,d=r.containment,g=d instanceof t?d.get(0):/parent/.test(d)?p.parent().get(0):d;g&&(l.containerElement=t(g),/document/.test(d)||d===document?(l.containerOffset={left:0,top:0},l.containerPosition={left:0,top:0},l.parentData={element:t(document),left:0,top:0,width:t(document).width(),height:t(document).height()||document.body.parentNode.scrollHeight}):(i=t(g),e=[],t(["Top","Right","Left","Bottom"]).each(function(t,s){e[t]=l._num(i.css("padding"+s))}),l.containerOffset=i.offset(),l.containerPosition=i.position(),l.containerSize={height:i.innerHeight()-e[3],width:i.innerWidth()-e[1]},s=l.containerOffset,h=l.containerSize.height,n=l.containerSize.width,o=l._hasScroll(g,"left")?g.scrollWidth:n,a=l._hasScroll(g)?g.scrollHeight:h,l.parentData={element:g,left:s.left,top:s.top,width:o,height:a}))},resize:function(i){var e,s,h,n,o=t(this).resizable("instance"),a=o.options,l=o.containerOffset,r=o.position,p=o._aspectRatio||i.shiftKey,d={top:0,left:0},g=o.containerElement,u=!0;g[0]!==document&&/static/.test(g.css("position"))&&(d=l),r.left<(o._helper?l.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-l.left:o.position.left-d.left),p&&(o.size.height=o.size.width/o.aspectRatio,u=!1),o.position.left=a.helper?l.left:0),r.top<(o._helper?l.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-l.top:o.position.top),p&&(o.size.width=o.size.height*o.aspectRatio,u=!1),o.position.top=o._helper?l.top:0),h=o.containerElement.get(0)===o.element.parent().get(0),n=/relative|absolute/.test(o.containerElement.css("position")),h&&n?(o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top):(o.offset.left=o.element.offset().left,o.offset.top=o.element.offset().top),e=Math.abs(o.sizeDiff.width+(o._helper?o.offset.left-d.left:o.offset.left-l.left)),s=Math.abs(o.sizeDiff.height+(o._helper?o.offset.top-d.top:o.offset.top-l.top)),e+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-e,p&&(o.size.height=o.size.width/o.aspectRatio,u=!1)),s+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-s,p&&(o.size.width=o.size.height*o.aspectRatio,u=!1)),u||(o.position.left=o.prevPosition.left,o.position.top=o.prevPosition.top,o.size.width=o.prevSize.width,o.size.height=o.prevSize.height)},stop:function(){var i=t(this).resizable("instance"),e=i.options,s=i.containerOffset,h=i.containerPosition,n=i.containerElement,o=t(i.helper),a=o.offset(),l=o.outerWidth()-i.sizeDiff.width,r=o.outerHeight()-i.sizeDiff.height;i._helper&&!e.animate&&/relative/.test(n.css("position"))&&t(this).css({left:a.left-h.left-s.left,width:l,height:r}),i._helper&&!e.animate&&/static/.test(n.css("position"))&&t(this).css({left:a.left-h.left-s.left,width:l,height:r})}}),t.ui.plugin.add("resizable","alsoResize",{start:function(){var i=t(this).resizable("instance").options;t(i.alsoResize).each(function(){var i=t(this);i.data("ui-resizable-alsoresize",{width:parseFloat(i.width()),height:parseFloat(i.height()),left:parseFloat(i.css("left")),top:parseFloat(i.css("top"))})})},resize:function(i,e){var s=t(this).resizable("instance"),h=s.options,n=s.originalSize,o=s.originalPosition,a={height:s.size.height-n.height||0,width:s.size.width-n.width||0,top:s.position.top-o.top||0,left:s.position.left-o.left||0};t(h.alsoResize).each(function(){var i=t(this),s=t(this).data("ui-resizable-alsoresize"),h={},n=i.parents(e.originalElement[0]).length?["width","height"]:["width","height","top","left"];t.each(n,function(t,i){var e=(s[i]||0)+(a[i]||0);e&&e>=0&&(h[i]=e||null)}),i.css(h)})},stop:function(){t(this).removeData("ui-resizable-alsoresize")}}),t.ui.plugin.add("resizable","ghost",{start:function(){var i=t(this).resizable("instance"),e=i.size;i.ghost=i.originalElement.clone(),i.ghost.css({opacity:.25,display:"block",position:"relative",height:e.height,width:e.width,margin:0,left:0,top:0}),i._addClass(i.ghost,"ui-resizable-ghost"),!1!==t.uiBackCompat&&"string"==typeof i.options.ghost&&i.ghost.addClass(this.options.ghost),i.ghost.appendTo(i.helper)},resize:function(){var i=t(this).resizable("instance");i.ghost&&i.ghost.css({position:"relative",height:i.size.height,width:i.size.width})},stop:function(){var i=t(this).resizable("instance");i.ghost&&i.helper&&i.helper.get(0).removeChild(i.ghost.get(0))}}),t.ui.plugin.add("resizable","grid",{resize:function(){var i,e=t(this).resizable("instance"),s=e.options,h=e.size,n=e.originalSize,o=e.originalPosition,a=e.axis,l="number"==typeof s.grid?[s.grid,s.grid]:s.grid,r=l[0]||1,p=l[1]||1,d=Math.round((h.width-n.width)/r)*r,g=Math.round((h.height-n.height)/p)*p,u=n.width+d,f=n.height+g,c=s.maxWidth&&s.maxWidth<u,m=s.maxHeight&&s.maxHeight<f,z=s.minWidth&&s.minWidth>u,w=s.minHeight&&s.minHeight>f;s.grid=l,z&&(u+=r),w&&(f+=p),c&&(u-=r),m&&(f-=p),/^(se|s|e)$/.test(a)?(e.size.width=u,e.size.height=f):/^(ne)$/.test(a)?(e.size.width=u,e.size.height=f,e.position.top=o.top-g):/^(sw)$/.test(a)?(e.size.width=u,e.size.height=f,e.position.left=o.left-d):((f-p<=0||u-r<=0)&&(i=e._getPaddingPlusBorderDimensions(this)),f-p>0?(e.size.height=f,e.position.top=o.top-g):(f=p-i.height,e.size.height=f,e.position.top=o.top+n.height-f),u-r>0?(e.size.width=u,e.position.left=o.left-d):(u=r-i.width,e.size.width=u,e.position.left=o.left+n.width-u))}}),t.ui.resizable})?s.apply(i,h):s)||(t.exports=n)},"zq/Y":function(t,i,e){var s,h,n;h=[e("oDIA"),e("O+lX")],void 0===(n="function"==typeof(s=function(t){return t.fn.extend({disableSelection:function(){var t="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.on(t+".ui-disableSelection",function(t){t.preventDefault()})}}(),enableSelection:function(){return this.off(".ui-disableSelection")}})})?s.apply(i,h):s)||(t.exports=n)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_jquery.ui.resizable', location = 'aui.chunk.a312bad5b76741024fb4--5eca985b02b335e904e5.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["jquery.ui.resizable"],{kW2n:function(u,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i("2V+C"),i("XnJT"),e.default="jquery",u.exports=e.default}},[["kW2n","runtime","aui.splitchunk.vendors--20a97d6a33","aui.splitchunk.vendors--d18e3cafa7","aui.splitchunk.vendors--db57146687","aui.splitchunk.vendors--9c8c8c1546","aui.splitchunk.vendors--85718a7eef","aui.splitchunk.172ffb6da7"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.vendors--7c76061134', location = 'aui.chunk.ec257084264be2137aff--47070070a0c5ff93b8b0.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.vendors--7c76061134"],{TRfs:function(e,t,s){},iCCw:function(e,t,s){var l,i,n;i=[s("oDIA"),s("XPYc"),s("O+lX"),s("yIBB")],void 0===(n="function"==typeof(l=function(e){return e.widget("ui.selectable",e.ui.mouse,{version:"1.12.1",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t=this;this._addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t.elementPos=e(t.element[0]).offset(),t.selectees=e(t.options.filter,t.element[0]),t._addClass(t.selectees,"ui-selectee"),t.selectees.each(function(){var s=e(this),l=s.offset(),i={left:l.left-t.elementPos.left,top:l.top-t.elementPos.top};e.data(this,"selectable-item",{element:this,$element:s,left:i.left,top:i.top,right:i.left+s.outerWidth(),bottom:i.top+s.outerHeight(),startselected:!1,selected:s.hasClass("ui-selected"),selecting:s.hasClass("ui-selecting"),unselecting:s.hasClass("ui-unselecting")})})},this.refresh(),this._mouseInit(),this.helper=e("<div>"),this._addClass(this.helper,"ui-selectable-helper")},_destroy:function(){this.selectees.removeData("selectable-item"),this._mouseDestroy()},_mouseStart:function(t){var s=this,l=this.options;this.opos=[t.pageX,t.pageY],this.elementPos=e(this.element[0]).offset(),this.options.disabled||(this.selectees=e(l.filter,this.element[0]),this._trigger("start",t),e(l.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),l.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var l=e.data(this,"selectable-item");l.startselected=!0,t.metaKey||t.ctrlKey||(s._removeClass(l.$element,"ui-selected"),l.selected=!1,s._addClass(l.$element,"ui-unselecting"),l.unselecting=!0,s._trigger("unselecting",t,{unselecting:l.element}))}),e(t.target).parents().addBack().each(function(){var l,i=e.data(this,"selectable-item");if(i)return l=!t.metaKey&&!t.ctrlKey||!i.$element.hasClass("ui-selected"),s._removeClass(i.$element,l?"ui-unselecting":"ui-selected")._addClass(i.$element,l?"ui-selecting":"ui-unselecting"),i.unselecting=!l,i.selecting=l,i.selected=l,l?s._trigger("selecting",t,{selecting:i.element}):s._trigger("unselecting",t,{unselecting:i.element}),!1}))},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){var s,l=this,i=this.options,n=this.opos[0],c=this.opos[1],a=t.pageX,o=t.pageY;return n>a&&(s=a,a=n,n=s),c>o&&(s=o,o=c,c=s),this.helper.css({left:n,top:c,width:a-n,height:o-c}),this.selectees.each(function(){var s=e.data(this,"selectable-item"),r=!1,u={};s&&s.element!==l.element[0]&&(u.left=s.left+l.elementPos.left,u.right=s.right+l.elementPos.left,u.top=s.top+l.elementPos.top,u.bottom=s.bottom+l.elementPos.top,"touch"===i.tolerance?r=!(u.left>a||u.right<n||u.top>o||u.bottom<c):"fit"===i.tolerance&&(r=u.left>n&&u.right<a&&u.top>c&&u.bottom<o),r?(s.selected&&(l._removeClass(s.$element,"ui-selected"),s.selected=!1),s.unselecting&&(l._removeClass(s.$element,"ui-unselecting"),s.unselecting=!1),s.selecting||(l._addClass(s.$element,"ui-selecting"),s.selecting=!0,l._trigger("selecting",t,{selecting:s.element}))):(s.selecting&&((t.metaKey||t.ctrlKey)&&s.startselected?(l._removeClass(s.$element,"ui-selecting"),s.selecting=!1,l._addClass(s.$element,"ui-selected"),s.selected=!0):(l._removeClass(s.$element,"ui-selecting"),s.selecting=!1,s.startselected&&(l._addClass(s.$element,"ui-unselecting"),s.unselecting=!0),l._trigger("unselecting",t,{unselecting:s.element}))),s.selected&&(t.metaKey||t.ctrlKey||s.startselected||(l._removeClass(s.$element,"ui-selected"),s.selected=!1,l._addClass(s.$element,"ui-unselecting"),s.unselecting=!0,l._trigger("unselecting",t,{unselecting:s.element})))))}),!1}},_mouseStop:function(t){var s=this;return this.dragged=!1,e(".ui-unselecting",this.element[0]).each(function(){var l=e.data(this,"selectable-item");s._removeClass(l.$element,"ui-unselecting"),l.unselecting=!1,l.startselected=!1,s._trigger("unselected",t,{unselected:l.element})}),e(".ui-selecting",this.element[0]).each(function(){var l=e.data(this,"selectable-item");s._removeClass(l.$element,"ui-selecting")._addClass(l.$element,"ui-selected"),l.selecting=!1,l.selected=!0,l.startselected=!0,s._trigger("selected",t,{selected:l.element})}),this._trigger("stop",t),this.helper.remove(),!1}})})?l.apply(t,i):l)||(e.exports=n)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:split_jquery.ui.selectable', location = 'aui.chunk.8715bd0c6e6a21be6cc9--b41682505f14b08b8b9c.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["jquery.ui.selectable"],{FvNQ:function(u,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i("TRfs"),i("iCCw"),e.default="jquery",u.exports=e.default}},[["FvNQ","runtime","aui.splitchunk.vendors--20a97d6a33","aui.splitchunk.vendors--d18e3cafa7","aui.splitchunk.vendors--db57146687","aui.splitchunk.vendors--7c76061134","aui.splitchunk.172ffb6da7"]]]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/templates.soy' */
// This file was automatically generated from templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Roadmap.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.roadmapPopupPanel = function(opt_data, opt_ignored) {
  return '<div class="roadmap-editor-popup"><div id=\'' + soy.$$escapeHtml(opt_data.roadmapPopupPanelId) + '\'></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.roadmapPopupPanel.soyTemplateName = 'Confluence.Templates.Roadmap.roadmapPopupPanel';
}


Confluence.Templates.Roadmap.roadmapEditor = function(opt_data, opt_ignored) {
  return '<div id="roadmap-editor-edit-area"><div id="roadmap-editor-edit-content"><!-- START GENERATE ROADMAP --><div id="roadmap-container"><div class="roadmap-drag-area"></div><div class="roadmap-frame"><div class="roadmap-marker"></div></div><div class="roadmap-content"></div></div><!-- END GENERATE ROADMAP --></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.roadmapEditor.soyTemplateName = 'Confluence.Templates.Roadmap.roadmapEditor';
}


Confluence.Templates.Roadmap.lane = function(opt_data, opt_ignored) {
  return '<div class="roadmap-lane-title" style="background-color: ' + soy.$$escapeHtml(opt_data.color.lane) + '; color: ' + soy.$$escapeHtml(opt_data.color.text) + '" title="' + soy.$$escapeHtml(opt_data.title) + '"><div class="title-outer"><div class="title-inner">' + soy.$$escapeHtml(opt_data.title) + '</div></div></div><div class="roadmap-separate-content">&nbsp;</div><div class="roadmap-lane-content"></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.lane.soyTemplateName = 'Confluence.Templates.Roadmap.lane';
}


Confluence.Templates.Roadmap.marker = function(opt_data, opt_ignored) {
  return '<div class="marker-drag-placeholder" /><div class="marker-title-wrapper"><span class="marker-title" title="' + soy.$$escapeHtml(opt_data.title) + '">' + soy.$$escapeHtml(opt_data.title) + '</span></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.marker.soyTemplateName = 'Confluence.Templates.Roadmap.marker';
}


Confluence.Templates.Roadmap.bar = function(opt_data, opt_ignored) {
  return '<p class="roadmap-bar-title">' + soy.$$escapeHtml(opt_data.title) + '</p>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.bar.soyTemplateName = 'Confluence.Templates.Roadmap.bar';
}


Confluence.Templates.Roadmap.newRowLine = function(opt_data, opt_ignored) {
  return '<hr class="new-row-line" />';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.newRowLine.soyTemplateName = 'Confluence.Templates.Roadmap.newRowLine';
}


Confluence.Templates.Roadmap.deprecationDialog = function(opt_data, opt_ignored) {
  return '<section role="dialog" id="' + soy.$$escapeHtml(opt_data.id) + '" class="aui-layer aui-dialog2 aui-dialog2-medium" aria-hidden="true"><header class="aui-dialog2-header"><h1 class="aui-dialog2-header-main">' + soy.$$escapeHtml('\u4e0d\u80fd\u8bbf\u95ee\u5b8f') + '</h1></header><div class="aui-dialog2-content">' + soy.$$filterNoAutoescape('\x3cp\x3e \u8def\u7ebf\u56fe\u5b8f\u6307\u4ee4\u5df2\u7ecf\u4f5c\u4e3a\u7248\u672c 1.2 \u88ab\u5f03\u7528\u4e86\u3002\u60a8\u4ecd\u7136\u53ef\u4ee5\u67e5\u770b\u60a8\u73b0\u6709\u7684\u8def\u7ebf\u56fe\u5b8f\u6307\u4ee4\uff0c\u4f46\u662f\u60a8\u5c06\u4e0d\u518d\u80fd\u591f\u7f16\u8f91\u5b83\u4eec\u6216\u521b\u5efa\u65b0\u7684\u3002\x3c/p\x3e\x3cp\x3e\u8bf7\u4f7f\u7528\u6211\u4eec\u65b0\u7684\u8def\u7ebf\u56fe\u8ba1\u5212\u5668\u5b8f\u6307\u4ee4\uff0c\u6765\u5b89\u6392\u60a8\u7684\u8def\u7ebf\u56fe\u3002\x3c/p\x3e') + '<div class="new-roadmap-thumb"></div></div><footer class="aui-dialog2-footer"><div class="aui-dialog2-footer-actions"><button id="dialog-close-button" class="aui-button aui-button-link">' + soy.$$escapeHtml('\u5173\u95ed') + '</button></div></footer></section>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.deprecationDialog.soyTemplateName = 'Confluence.Templates.Roadmap.deprecationDialog';
}


Confluence.Templates.Roadmap.newRowPlaceholder = function(opt_data, opt_ignored) {
  return '<hr class= "new-row-placeholder" />';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.newRowPlaceholder.soyTemplateName = 'Confluence.Templates.Roadmap.newRowPlaceholder';
}


Confluence.Templates.Roadmap.laneDialog = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({id: 'add-bar-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: '\u6dfb\u52a0\u6a2a\u6761'}, iconClass: 'aui-icon-small aui-iconfont-add'}) + aui.buttons.button({id: 'rename-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: '\u91cd\u547d\u540d\u9053'}, iconClass: 'aui-icon-small aui-iconfont-edit'}) + Confluence.Templates.Roadmap.laneColorSelect(opt_data) + ((opt_data.canDelete) ? aui.buttons.button({id: 'delete-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: '\u5220\u9664\u7ebf'}, iconClass: 'aui-icon-small delete-icon'}) : '');
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.laneDialog.soyTemplateName = 'Confluence.Templates.Roadmap.laneDialog';
}


Confluence.Templates.Roadmap.markerDialog = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({id: 'rename-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: '\u91cd\u547d\u540d\u6807\u8bb0'}, iconClass: 'aui-icon-small aui-iconfont-edit'}) + aui.buttons.button({id: 'delete-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: '\u5220\u9664\u6807\u8bb0'}, iconClass: 'aui-icon-small delete-icon'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.markerDialog.soyTemplateName = 'Confluence.Templates.Roadmap.markerDialog';
}


Confluence.Templates.Roadmap.markerRenameDialog = function(opt_data, opt_ignored) {
  return '' + aui.form.form({action: '', content: '' + aui.form.input({extraClasses: 'marker-title', name: 'marker-title', type: 'text', value: opt_data.markerTitle}) + aui.buttons.button({extraClasses: 'rename-button', text: '\u4fdd\u5b58'})});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.markerRenameDialog.soyTemplateName = 'Confluence.Templates.Roadmap.markerRenameDialog';
}


Confluence.Templates.Roadmap.laneRenameDialog = function(opt_data, opt_ignored) {
  return '' + aui.form.form({action: '', content: '' + aui.form.input({extraClasses: 'lane-title', name: 'lane-title', type: 'text', value: opt_data.laneTitle}) + aui.buttons.button({extraClasses: 'rename-button', text: '\u4fdd\u5b58'})});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.laneRenameDialog.soyTemplateName = 'Confluence.Templates.Roadmap.laneRenameDialog';
}


Confluence.Templates.Roadmap.laneColorSelect = function(opt_data, opt_ignored) {
  var output = '<a id="lane-color-select" href="#" aria-owns="lane-color-picker" aria-haspopup="true" class="aui-button aui-button-subtle aui-button-compact aui-dropdown2-trigger aui-style-default" title="' + soy.$$escapeHtml('\u9053\u7684\u989c\u8272') + '"><span class="color-item" style="background-color: ' + soy.$$escapeHtml(opt_data.laneColor) + ';">&nbsp;</span></a></a><div id="lane-color-picker" class="aui-dropdown2"><ul class="aui-list-truncate">';
  var colorList120 = opt_data.colors;
  var colorListLen120 = colorList120.length;
  for (var colorIndex120 = 0; colorIndex120 < colorListLen120; colorIndex120++) {
    var colorData120 = colorList120[colorIndex120];
    output += '<li class="color-display-item"><a href="#" ><span class="color-item ' + ((colorData120.lane == opt_data.laneColor) ? 'aui-icon aui-icon-small aui-iconfont-success' : '') + '" style="background-color: ' + soy.$$escapeHtml(colorData120.lane) + ';"></span></a></li>';
  }
  output += '</ul></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.laneColorSelect.soyTemplateName = 'Confluence.Templates.Roadmap.laneColorSelect';
}


Confluence.Templates.Roadmap.linkPageTitle = function(opt_data, opt_ignored) {
  return '<span class="link-page-title" />';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.linkPageTitle.soyTemplateName = 'Confluence.Templates.Roadmap.linkPageTitle';
}


Confluence.Templates.Roadmap.footerActionContent = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({text: '\u63d2\u5165', id: 'roadmapInsertBtn'}) + aui.buttons.button({text: '\u53d6\u6d88', type: 'link', id: 'roadmapCancelBtn'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.footerActionContent.soyTemplateName = 'Confluence.Templates.Roadmap.footerActionContent';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/bar/bar.js' */
(function(b,a){Roadmap.BarView=Backbone.View.extend({className:"roadmap-bar",events:{click:"_showDialog",dragstart:"_onDragstart",dragstop:"_onDragStop",dropover:"_onDropOver",dropout:"_onDropOut"},attributes:function(){return{cid:this.cid}},initialize:function(){a.bindAll(this,"render","_updateBar","_beforeResize","updateMaxWidth","_deleteBar","_updateTitle");this._addEvents()},_addEvents:function(){var c=this;this.$el.draggable({opacity:0.3,cursor:"move",appendTo:".roadmap-drag-area",snap:".roadmap-bar-row, .new-bar-row",snapMode:"inner",snapTolerance:17,scroll:true,zIndex:4020,helper:function(){return c.$el.clone().addClass("roadmap-bar-clone").data("View",c)}});this.$el.droppable({accept:".roadmap-bar",tolerance:"touch",hoverClass:"bar-hover-bar"});this.$el.data("View",this)},render:function(){this.updateColor(this.options.color);var c=this.options.timelineView.getBarPosition(this.model.attributes);this.$el.css({left:c.left+"px",width:c.width+"px"});this.$el.attr("title",this.model.get("title"));this.$el.append(Confluence.Templates.Roadmap.bar({title:this.model.get("title")}));this.$el.resizable({handles:"e, w",minWidth:Roadmap.barMinWidth,start:this._beforeResize,stop:this._updateBar});return this},updateMaxWidth:function(d){this.$el.resizable("option","maxWidth",d);var c=this.$el.resizable("option","minWidth");if(d<c){this.$el.resizable("option","minWidth",d)}},_beforeResize:function(d,c){this._barDialog&&this._barDialog.remove();this.trigger("beforeResize",this,this._checkHandleDirection(d))},_checkHandleDirection:function(c){var d=b(c.toElement?c.toElement:c.originalEvent.target);if(d.hasClass("ui-resizable-w")){return"left"}else{if(d.hasClass("ui-resizable-e")){return"right"}}throw"Unsupport resize direction handling = "+d},_updateBar:function(d,c){if(c.originalPosition.left!=c.position.left){this.model.set({startDate:this.options.timelineView.getBarStartDate(c.position.left),duration:this.options.timelineView.getBarDuration(c.element.outerWidth())})}else{if(c.originalSize.width!=c.size.width){this.model.set("duration",this.options.timelineView.getBarDuration(c.element.outerWidth()))}}},appendTo:function(c){this.$el.appendTo(c)},updateColor:function(c){this.$el.css({"background-color":c.bar,"border-color":c.lane,color:c.text})},updatePositionLeft:function(c){this.$el.css("left",c)},_onDragStop:function(d,c){this.options.lane.cleanLaneAfterDrop();this.$el.trigger("BarView.dragstop")},updateDeleteBar:function(c){this.options.deleteBar=c},_showDialog:function(c){if(!b(c.target).is(".ui-resizable-handle")){this._barDialog&&this._barDialog.remove();this._barDialog=this._createDialog();this._barDialog.show();Confluence.Roadmap.Analytics.openBarDialogInEdit()}},_createDialog:function(){return new Roadmap.BarDialogView({trigger:this.$el,model:this.model,timelineWidth:this.options.timelineView.$el.width(),renderOption:{isEditMode:true,editInplace:{title:true,pageLink:true,description:true}},linkPageEditable:true,deleteBar:this._deleteBar,updateTitle:this._updateTitle,updateDescription:this._updateDescription,updatePageLink:this._updatePageLink,createLinkPageCallback:this._goToCreateLinkPage})},_deleteBar:function(){this.options.deleteBar(this)},_updateTitle:function(c){this.model.set("title",c);this.$el.attr("title",c);this.$el.find(".roadmap-bar-title").html(AJS.escapeHtml(c))},_updateDescription:function(c){this.model.set("description",c)},_updatePageLink:function(c){this.model.set("pageLink",c)},_onDragstart:function(d,c){Roadmap.DragDrop.barDraggingOver={};this.$el.trigger("BarView.dragstart",[c])},_onDropOver:function(d,c){Roadmap.DragDrop.barDraggingOver[this.cid]=this.cid;if(Roadmap.DragDrop.barDraggingOver&&c.helper.data("isAddingNewRow")!==true){c.helper.addClass("roadmap-bar-overlapped")}},_onDropOut:function(f,d){var c=this;delete Roadmap.DragDrop.barDraggingOver[c.cid];d.helper.removeClass("roadmap-bar-overlapped");a.each(Roadmap.DragDrop.barDraggingOver,function(g){var e=d.helper.data("isAddingNewRow")!==true;if(e){if(typeof g==="string"){d.helper.addClass("roadmap-bar-overlapped")}else{if(g.className==="roadmap-bar-row"){g.$el.addClass("roadmap-bar-drag-hover")}}}})},_goToCreateLinkPage:function(f){f.preventDefault();var e=this.me;var c=parseInt(AJS.Meta.get("page-id"));var d=c>0?c:AJS.Meta.get("parent-page-id");var g={roadmapBarId:e.model.id,roadmapContentId:d,updateRoadmap:false};Confluence.RoadmapLink.addCreateLinkPageListener(g,function(i){var h=e._updatePageLink(i.pageLink);e.fields.$pageLink.html(h)})}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/bar/bar-row.js' */
(function(b,a){Roadmap.BarRowView=Backbone.View.extend({className:"roadmap-bar-row",initialize:function(){a.bindAll(this,"_addEvents");this._addEvents();return this},attributes:function(){return{cid:this.cid}},_addEvents:function(){var c=this;this.$el.droppable({greedy:true,tolerance:"pointer",hoverClass:"roadmap-bar-drag-hover",activeClass:"roadmap-bar-drag-active",accept:".roadmap-bar",over:function(f,d){Roadmap.DragDrop.barDraggingOver[c.cid]=c;if(d.helper.data("isAddingNewRow")!==true){var g=b(this);g.closest(".roadmap-content").find(".new-row-placeholder").remove()}else{c.$el.removeClass("roadmap-bar-drag-hover")}},out:function(){var d=b(this);delete Roadmap.DragDrop.barDraggingOver[c.cid];d.closest(".roadmap-content").find(".new-row-placeholder").remove()},drop:function(g,f){var d=a.reject(Roadmap.DragDrop.barDraggingOver,function(e){return(typeof e==="object")}).length>0;if(!f.helper.hasClass("roadmap-bar-overlapped")&&!d){b(this).trigger("BarView.drop",[{$barViewHelper:f.helper,$barViewOriginal:f.draggable,$barRow:b(this)},f])}}})},isEmptyRow:function(){return this.$el.is(":empty")}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/bar/bar-row-new.js' */
(function(b,a){Roadmap.BarRowNewView=Backbone.View.extend({className:"new-bar-row",overlayTop:3,margin:5,events:{drop:"_onDrop",dropover:"_onDropOver",dropout:"_onDropOut"},initialize:function(){a.bindAll(this,"render","_addEvent");return this},render:function(){this.$el.append(Confluence.Templates.Roadmap.newRowLine());this._addEvent();this._setSizePosition();return this},_addEvent:function(){this.$el.droppable({accept:".roadmap-bar",tolerance:"pointer",hoverClass:"new-bar-row-hover"})},_setSizePosition:function(){var f=this.options.$barRow;var c=this.options.renderBottom===false?(this.margin*-1):f.height();var e=f.index()===0;var d=(e)?this.overlayTop+this.margin:this.overlayTop;this.$el.css({top:f.position().top+c-d,width:f.width()})},_onDrop:function(d,c){this.$el.trigger("BarView.drop",[{barRowNewView:this},c])},_onDropOver:function(d,c){this.$el.trigger("BarRowNew.dropover",[this,c])},_onDropOut:function(d,c){this.$el.trigger("BarRowNew.dropout",[this,c])}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/lane-dialog/lane-dialog.js' */
(function(c,a){var b=Roadmap.InlineDialogView;Roadmap.LaneDialogView=b.extend({events:{"click #delete-button":"_onDeleteClick","click #rename-button":"_onRenameClick","click #add-bar-button":"_onAddBarClick"},initialize:function(){a.bindAll(this,"_onHide");this.options.dialogOptions={width:this._getDialogWidth(),hideCallback:this._onHide};c(".roadmap-editor-popup, .roadmap-macro-view").scroll(function(){c("#lane-color-picker").hide()});b.prototype.initialize.call(this,this.options)},_getContent:function(d){var g=this.options.lane.model.get("color").lane;d.html(Confluence.Templates.Roadmap.laneDialog({canDelete:this.options.canDelete,colors:Roadmap.COLORS,laneColor:g}));this.$el.find(".aui-button").tooltip({gravity:"s"});var e=this;var f=this.$el.find("#lane-color-picker .color-item");f.click(function(i){i.preventDefault();var h=Roadmap.COLORS[f.index(this)];if(h.lane!=g){e.options.changeColor(h)}c("#lane-color-picker").hide()})},_getDialogWidth:function(){var e=29;var f=51;var d=2;if(this.options.canDelete){d++}return d*e+f},_onDeleteClick:function(){this.options.deleteLane();this.remove()},_onRenameClick:function(){if(!this._laneRenameDialog){this._laneRenameDialog=new Roadmap.LaneRenameDialogView({trigger:this.options.trigger,lane:this.options.lane})}this._laneRenameDialog.show();this.hide()},_onAddBarClick:function(){this.options.addBar();this.remove()},_onHide:function(){c("#lane-color-picker").hide();b.prototype._onHide.call(this)}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/lane-dialog/lane-rename-dialog.js' */
(function(d,a){var b=require("confluence/form-state-control");var c=Roadmap.InlineDialogView;Roadmap.LaneRenameDialogView=c.extend({events:{"click .rename-button":"_onRenameButtonClick","keyup .lane-title":"_onChangeLaneTitle"},initialize:function(){this.options.dialogOptions={width:this._getDialogWidth()};c.prototype.initialize.call(this,this.options)},_getContent:function(e){e.html(Confluence.Templates.Roadmap.laneRenameDialog({laneTitle:this.options.trigger.text()}));this.controls={$renameButton:this.$el.find(".rename-button"),$laneTitle:this.$el.find(".lane-title")}},_getDialogWidth:function(){return 315},_onChangeLaneTitle:function(f){var g=d.trim(this.controls.$laneTitle.val());if(!g){b.disableElement(this.controls.$renameButton)}else{b.enableElement(this.controls.$renameButton);if(f.which==AJS.$.ui.keyCode.ENTER){this.controls.$renameButton.click()}}},_onShow:function(f){this.controls.$laneTitle.select()},_onRenameButtonClick:function(e){e.preventDefault();this.hide();var f=this.controls.$laneTitle.val();this.options.lane.renameTitle(f)}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/marker-dialog/marker-dialog.js' */
(function(c,a){var b=Roadmap.InlineDialogView;Roadmap.MarkerDialogView=b.extend({events:{"click #rename-button":"_onRenameButtonClick","click #delete-button":"_onDeleteButtonClick"},initialize:function(){this.options.dialogOptions={width:60};b.prototype.initialize.call(this,this.options)},_getContent:function(d){d.html(Confluence.Templates.Roadmap.markerDialog());this.$el.find(".aui-button.aui-button-compact").tooltip({gravity:"s"})},_onRenameButtonClick:function(){if(!this._markerRenameDialog){this._markerRenameDialog=new Roadmap.MarkerRenameDialogView({trigger:this.options.trigger,marker:this.options.marker})}this._markerRenameDialog.show();this.hide()},_onDeleteButtonClick:function(){this.options.marker.removeMarker();this.hide()}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/marker-dialog/marker-rename-dialog.js' */
(function(d,a){var b=require("confluence/form-state-control");var c=Roadmap.InlineDialogView;Roadmap.MarkerRenameDialogView=c.extend({events:{"click .rename-button":"_onSaveButtonClick","keyup .marker-title":"_onChangeMarkerTitle"},initialize:function(){this.options.dialogOptions={width:315};c.prototype.initialize.call(this,this.options)},_getContent:function(e){e.html(Confluence.Templates.Roadmap.markerRenameDialog({markerTitle:this.options.marker.model.get("title")}));this.controls={$renameButton:this.$el.find(".rename-button"),$title:this.$el.find(".marker-title")}},_onChangeMarkerTitle:function(f){var g=d.trim(this.controls.$title.val());if(!g){b.disableElement(this.controls.$renameButton)}else{b.enableElement(this.controls.$renameButton);if(f.which==AJS.$.ui.keyCode.ENTER){this.controls.$renameButton.click()}}},_onShow:function(f){this.controls.$title.select()},_onSaveButtonClick:function(f){f.preventDefault();this.hide();this.options.marker.renameTitle(this.controls.$title.val())}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/lane.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};Roadmap.LaneView=Backbone.View.extend({tagName:"div",className:"roadmap-lane",events:{"click .roadmap-lane-title":"_showDialog","BarView.drop":"_onBarDropped","BarRowNew.dropover":"_onBarRowNewDropover","BarRowNew.dropout":"_onBarRowNewDropout"},attributes:function(){return{cid:this.cid}},initialize:function(){a.bindAll(this,"render","renameTitle","updateRowIndex","removeEmptyRow","cleanLaneAfterDrop","_deleteLane","_updateLaneHeight","_renderComplete","_deleteBar","_addBar","_changeColor","addDefaultBarRow");this._barViews=[];this._barRowViews=[];this.listenTo(this.model.get("bars"),"add",function(d){var c=this._newBarRowView();var e=this._newBarView(d);c.$el.append(e.render().$el);this._$laneContent.append(c.$el);this._barViews.push(e);this.$el.trigger("BarView.add",e);a.defer(this._updateLaneHeight)})},render:function(){var c=this;this.$el.append(Confluence.Templates.Roadmap.lane({title:this.model.get("title"),color:this.model.get("color")}));Confluence.Roadmap.ColorHelper.adjustColorCount(this.model.get("color"),1);var d=this.model.get("bars").models;d=a.sortBy(d,function(e){return e.attributes.rowIndex});a.each(d,function(e){var f=c._newBarView(e);c._barViews.push(f)});this._renderBars();a.defer(this._renderComplete);return this},_renderComplete:function(){this._updateLaneHeight()},renameTitle:function(c){this.model.set("title",c);this.$el.find(".roadmap-lane-title").attr("title",c);this.$el.find(".title-inner").html(AJS.escapeHtml(c));this._updateLaneHeight()},_updateLaneHeight:function(){var d=this.$el.find(".title-inner");d.hide();var c=this._$laneContent.outerHeight();d.width(c-2*Roadmap.LANE_PADDING);d.show()},_barBeforeResize:function(e,k){var l=e.$el;var g=Math.ceil(l.outerWidth()-l.width());var j;if(k=="left"){var f=this._getNearestBarView(e,k);var c=f==null?0:f.position().left+f.width()+g;var d=l.position().left-c;j=l.width()+d}else{var i=this._getNearestBarView(e,k);var h=i==null?this._getLaneContentWidth()-g:i.position().left-g;j=h-l.position().left}e.updateMaxWidth(j-Roadmap.BAR_MARGIN)},_renderBars:function(){var c=this;this._$laneContent=this.$el.find(".roadmap-lane-content");var d={};a.each(this._barViews,function(f){var g="row-"+f.model.get("rowIndex");var e=d[g];if(!e){e=c._newBarRowView(f.model.get("rowIndex"));d[g]=e}e.$el.append(f.render().$el);c._$laneContent.append(e.$el)})},_newBarRowView:function(){var c=new Roadmap.BarRowView();this._barRowViews.push(c);return c},_newBarView:function(c){var d=new Roadmap.BarView({model:c,lane:this,color:this.model.get("color"),timelineView:this.options.timelineView,deleteBar:this._deleteBar});d.on("beforeResize",a.bind(this._barBeforeResize,this));return d},_getNearestBarView:function(d,e){var f=a.filter(d.options.lane._barViews,function(g){return g.model.get("rowIndex")===d.model.get("rowIndex")});var c=null;if(e=="left"){a.each(f,function(g){if(g.$el.position().left<d.$el.position().left&&(c==null||g.$el.position().left>c.$el.position().left)){c=g}})}else{a.each(f,function(g){if(g.$el.position().left>d.$el.position().left&&(c==null||g.$el.position().left<c.$el.position().left)){c=g}})}return c!=null?c.$el:null},_getLaneContentWidth:function(){return this.$el.find(".roadmap-lane-content").width()},_showDialog:function(){this._laneDialog&&this._laneDialog.remove();this._laneDialog=this._createLaneDialog();this._laneDialog.show()},_createLaneDialog:function(){return new Roadmap.LaneDialogView({trigger:this.$el.find(".title-outer"),canDelete:this.options.canDelete,deleteLane:this._deleteLane,addBar:this._addBar,changeColor:this._changeColor,lane:this})},_onBarDropped:function(i,k,l){var n=!!k.barRowNewView;var f=l.draggable.data("View");var m=f.model;var h=f.options.lane;var j=(h.cid===this.cid);var g=this.model.get("bars");var o=l.position.left;var d=this.options.timelineView.getBarStartDate(o);if(j&&g.models.length===1&&n){return}f.updatePositionLeft(o);f.updateColor(this.model.get("color"));m.attributes.startDate=d;if(n){var c=this._newBarRowView();k.barRowNewView.$el.replaceWith(c.$el);f.appendTo(c.$el)}else{f.appendTo(k.$barRow)}l.helper.remove();if(!j){f.options.lane.removeEmptyRow();g._byId[m.id]=m;this._barViews.push(f);f.updateDeleteBar(this._deleteBar);h.model.get("bars").remove(m);g.models.push(m);h._barViews.splice(a.indexOf(h._barViews,f),1);this.updateRowIndex(h.$el);f.options=a.extend(f.options,{color:this.model.get("color"),lane:this});h._updateLaneHeight()}this.removeEmptyRow();this.updateRowIndex(this.$el);this._updateLaneHeight()},updateRowIndex:function(c){c.find(".roadmap-bar-row").each(function(e,d){b(d).find('.roadmap-bar:not(".roadmap-bar-clone")').each(function(h,f){var g=b(f).data("View");if(g){g.model.attributes.rowIndex=e}})})},removeEmptyRow:function(){var c=0;a.each(this._barRowViews,function(d){if(d.isEmptyRow()){d.remove();c++}});return !!c},cleanLaneAfterDrop:function(){this._$laneContent.find(".roadmap-bar-drag-active").removeClass("roadmap-bar-drag-active");this._$laneContent.find(".new-row-placeholder").remove()},_deleteLane:function(){Confluence.Roadmap.ColorHelper.adjustColorCount(this.model.get("color"),-1);this.$el.trigger("Lane.delete",this)},updateDeleteStatus:function(c){if(this._laneDialog){this._laneDialog.remove();delete this._laneDialog}this.options.canDelete=c},_deleteBar:function(c){this.model.get("bars").remove(c.model);this._barViews.splice(a.indexOf(this._barViews,c),1);c.remove();if(this.removeEmptyRow()){this.updateRowIndex(this.$el);this._updateLaneHeight();this.$el.trigger("BarRowView.remove")}},_addBar:function(){var c=this.model.get("bars");var e=this.options.timelineView.model;var f=moment(e.get("startDate"));var d=e.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?f.startOf("month"):f.startOf("isoWeek");c.add(new Roadmap.Bar({rowIndex:this.model.getNumberOfRows(),startDate:d.toDate()}))},_changeColor:function(c){Confluence.Roadmap.ColorHelper.adjustColorCount(this.model.get("color"),-1);this.model.set("color",c);Confluence.Roadmap.ColorHelper.adjustColorCount(c,1);this.$el.find(".roadmap-lane-title").css({"background-color":c.lane,color:c.text});a.each(this._barViews,function(d){d.updateColor(c)})},addNewBarRow:function(h){var g=this._$laneContent.find(".roadmap-bar-row");var c=[];var d=function(){g.each(function(){var k=b(this);var j=k.index()===0;if(j){var l=new Roadmap.BarRowNewView({$barRow:k,renderBottom:false});k.before(l.render().$el);c.push(l)}var i=new Roadmap.BarRowNewView({$barRow:k});k.after(i.render().$el);c.push(i)})};if(g.length==0){this.addDefaultBarRow()}else{var e=g.find(".roadmap-bar");if(e.length>0){var f=(e.length>0)&&(e.length==1)&&(e.attr("cid")===h.attr("cid"));if(!f){d()}}}return c},addDefaultBarRow:function(){var c=this._newBarRowView();this._$laneContent.append(c.$el)},_onBarRowNewDropover:function(f,d,c){if(!a.isEmpty(Roadmap.DragDrop.barDraggingOver)){a.each(Roadmap.DragDrop.barDraggingOver,function(e){e.$el&&e.$el.removeClass("new-bar-row-hover roadmap-bar-drag-hover")})}Roadmap.DragDrop.barDraggingOver[d.cid]=d;c.helper.removeClass("roadmap-bar-overlapped");c.helper.data("isAddingNewRow",true)},_onBarRowNewDropout:function(f,d,c){c.helper.data("isAddingNewRow",false);delete Roadmap.DragDrop.barDraggingOver[d.cid];a.each(Roadmap.DragDrop.barDraggingOver,function(e){if(typeof e==="string"){c.helper.addClass("roadmap-bar-overlapped")}else{if(e.className==="roadmap-bar-row"&&c.helper.data("isAddingNewRow")!==true){e.$el.addClass("roadmap-bar-drag-hover")}}})}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/marker.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};Roadmap.MarkerView=Backbone.View.extend({className:"vertical-line",events:{dragstop:"_onDragStop",dragstart:"_onDragStart"},initialize:function(){a.bindAll(this,"render","updateHeight","renameTitle","_renderComplete","_onMarkerClick")},render:function(){var d=this.options.roadmap._timelineView.model;var c;if(d.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH){c=Confluence.Roadmap.Helper.getPosXOnMonthTimeline(d.attributes,this.model.get("markerDate"))}else{c=Confluence.Roadmap.Helper.getPosXOnWeekTimeline(d.attributes,this.model.get("markerDate"))}if(c<0||c>this.options.roadmap._timelineView.$el.width()){return false}this.$el.css({left:(c+Roadmap.LANE_TITLE_WIDTH)+"px"});this.$el.append(Confluence.Templates.Roadmap.marker({title:this.model.get("title")}));this.updateHeight(this.options.roadmap._getLaneHeight());a.defer(this._renderComplete);return this},_renderComplete:function(){this._setupMarkerDragging();this.$el.click(this._onMarkerClick);this.$el.find(".marker-title").ellipsis({row:Roadmap.MARKER_TITLE_LINE})},_setupMarkerDragging:function(){this.$el.draggable({axis:"x",zIndex:4013,containment:".roadmap-frame-content",cursor:"move"})},_onDragStop:function(g,f){var c=f.position.left-Roadmap.LANE_TITLE_WIDTH;var d=this.options.roadmap._timelineView.model.attributes;var h;if(d.displayOption===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH){h=Confluence.Roadmap.Helper.getMonthStartDateByPosition(d,c)}else{h=Confluence.Roadmap.Helper.getWeekStartDateByPosition(d,c)}this.model.set("markerDate",h)},_onDragStart:function(d,c){this.options.roadmap.hideDialog()},_onMarkerClick:function(c){if(!b(c.target).hasClass("marker-title")){return}this._markerDialog&&this._markerDialog.remove();this._markerDialog=this._createMarkerDialog();this._markerDialog.show()},_createMarkerDialog:function(){return new Roadmap.MarkerDialogView({trigger:this.$el.find(".marker-title"),marker:this})},updateHeight:function(c){this.$el.height(c+Roadmap.MARKER_HEIGHT_PADDING)},renameTitle:function(d){this.model.set("title",d);var c=this.$el.find(".marker-title");c.attr("title",d);c.html(AJS.escapeHtml(d)).ellipsis({row:Roadmap.MARKER_TITLE_LINE})},removeMarker:function(){this.model.collection.remove(this.model);this.remove()}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/roadmap.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};Roadmap.RoadmapEditorView=Backbone.View.extend({className:"roadmap-editor-container",events:{"BarView.add":"_onAddBar","BarView.dragstart":"_onBarDragstart","BarView.dragstop":"_onBarDragstop","BarView.drop":"_onBarDropped","LaneView.drop":"_onBarDropped","Lane.delete":"_onDeleteLane","BarRowView.remove":"_onBarRowViewRemove","sortstart .roadmap-content":"_onSortStart","sortstop .roadmap-content":"_onSortStop",remove:"_onRemove"},initialize:function(){a.bindAll(this,"render");this.listenTo(this.model.get("lanes"),"add",function(c){var d=new Roadmap.LaneView({model:c,timelineView:this._timelineView,canDelete:true});if(this._laneViews.length===1){this._laneViews[0].updateDeleteStatus(true)}this._laneViews.push(d);this.$roadmapContent.append(d.render().$el);this._updateTimelineColumnHeight();this._scrollToBottom()});this.listenTo(this.model.get("markers"),"add",function(c){var d=new Roadmap.MarkerView({model:c,roadmap:this});this.$roadmapMarker.append(d.render().$el);this._markerViews.push(d)});this.listenTo(this.model.get("timeline"),"change",function(){if(this._isTimelineChanged()){this._calculateMinWidthOfABar();this._timelineView.update();this._timelineColumnView.update();this.$roadmapContent.empty();a.each(this._laneViews,function(c){c.remove()});this._laneViews=[];this._renderLanes();this.$roadmapMarker.empty();this._markerViews=[];this._renderMarkers();this._updateDragArea()}})},render:function(){this.$el.html(Confluence.Templates.Roadmap.roadmapEditor());this._calculateMinWidthOfABar();this._initVariables();this._renderToolbar();this._renderTimeline();this._renderLanes();this._renderMarkers();this._renderTimelineColumn();this._updateDragArea();return this},_calculateMinWidthOfABar:function(){Roadmap.barMinWidth=this.model.get("timeline").get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?Roadmap.MONTH_BAR_MIN_WIDTH:Roadmap.WEEK_BAR_MIN_WIDTH},_initVariables:function(){this.$roadmapContainer=this.$el.find("#roadmap-container");this.$roadmapTimeline=this.$roadmapContainer.find(".roadmap-frame");this.$roadmapContent=this.$roadmapContainer.find(".roadmap-content");this.$roadmapMarker=this.$roadmapContainer.find(".roadmap-marker");this._timelineView=new Roadmap.TimelineView({model:this.model.get("timeline")});this._timelineColumnView=new Roadmap.TimelineColumnView({model:this.model.get("timeline")});this._laneViews=[];this._markerViews=[]},_renderTimeline:function(){this.$roadmapTimeline.prepend(this._timelineView.render().$el)},_renderTimelineColumn:function(){this._updateTimelineColumnHeight();this.$roadmapTimeline.append(this._timelineColumnView.render().$el)},_renderMarkers:function(){var c=this;this.model.get("markers").each(function(d){var e=new Roadmap.MarkerView({model:d,roadmap:c});c.$roadmapMarker.append(e.render().$el);c._markerViews.push(e)})},_renderLanes:function(){Confluence.Roadmap.ColorHelper.resetColorCounts();var d=this;this._updateLaneWidth();var c=this.model.get("lanes").models.length>1;this.model.get("lanes").each(function(e){var f=new Roadmap.LaneView({model:e,timelineView:d._timelineView,canDelete:c});d._laneViews.push(f);d.$roadmapContent.append(f.render().$el)});this._setupLaneReordering()},_onAddBar:function(d,c){this._updateTimelineColumnHeight();var e=c.$el;if(!this._isInViewScreen(e)){this._scrollToBar(e)}},_renderToolbar:function(){var d=b("#"+this.options.dialogId+" .aui-dialog2-content");d.find(".roadmap-toolbar").remove();var c=new Roadmap.ToolbarView({model:this.model,timelineView:this._timelineView});d.prepend(c.render().$el)},_getTimelineWidth:function(){return this.$roadmapTimeline.find(".roadmap-frame-title").width()},_getLaneHeight:function(){return this.$roadmapContent.height()},_updateLaneWidth:function(){this.$roadmapContent.width(this._getTimelineWidth()+Roadmap.LANE_TITLE_WIDTH)},_scrollToBottom:function(){this.options.roadmapEditorPopup.scrollTop(this._getLaneHeight())},_isInViewScreen:function(c){return b.inviewport(c,{threshold:-200})},_scrollToBar:function(c){this.options.roadmapEditorPopup.scrollTop(c.parent().position().top);this.options.roadmapEditorPopup.scrollLeft(0)},_onBarDropped:function(){this._updateTimelineColumnHeight()},_onDeleteLane:function(d,c){this.model.get("lanes").remove(c.model);this._laneViews.splice(a.indexOf(this._laneViews,c),1);c.remove();this._updateTimelineColumnHeight();if(this._laneViews.length===1){this._laneViews[0].updateDeleteStatus(false)}},_onBarRowViewRemove:function(){this._updateTimelineColumnHeight()},_updateTimelineColumnHeight:function(){var c=this._getLaneHeight();this._timelineColumnView.updateHeight(c);a.each(this._markerViews,function(d){d.updateHeight(c)})},hideDialog:function(){b("#inline-dialog-roadmap-dialog, #inline-dialog-timeline-options").hide()},removeDialog:function(){b("#inline-dialog-roadmap-dialog, #inline-dialog-timeline-options").remove()},_onBarDragstart:function(f,d){var c=this;this.hideDialog();this._updateDragArea();this._barRowNewViewList=[];a.each(this._laneViews,function(e){c._barRowNewViewList.push(e.addNewBarRow(d.helper))})},_updateDragArea:function(){var c=this.$roadmapContainer.find(".roadmap-drag-area");c.css(this._timelineColumnView.getSizeAndPosition())},_onBarDragstop:function(){a.each(a.flatten(this._barRowNewViewList),function(c){c.remove()});delete this._barRowNewViewList;a.each(this._laneViews,function(c){c.removeEmptyRow()})},_setupLaneReordering:function(){this.$roadmapContent.sortable({axis:"y",cursor:"move",handle:".roadmap-lane-title",opacity:0.3,placeholder:"roadmap-lane lane-sorting-placeholder",helper:function(d,c){return b(c).clone().addClass("lane-sorting-hepler")}})},_onSortStart:function(d,c){this.hideDialog();this._timelineColumnView.$el.hide();c.placeholder.css({height:Math.min(c.helper.height(),100),width:c.helper.width()}).html(Confluence.Templates.Roadmap.lane(Roadmap.TRANSPARENT_LANE));c.helper.find(".roadmap-lane-content").css({width:c.helper.width()-(c.helper.find(".roadmap-lane-title").outerWidth()+c.helper.find(".roadmap-separate-content").outerWidth())})},_onSortStop:function(h,g){this._timelineColumnView.$el.show();var d=g.item.attr("cid");var f=a.find(this._laneViews,function(e){return e.cid===d});var c=f.model;var i=this.model.get("lanes");i.remove(c);i.models.splice(g.item.index(),0,c);i._byId[c.cid]=c},_onRemove:function(){this.$roadmapTimeline.remove()},_isMonthYearChanged:function(){var d=function(f,e){if(f.getMonth()!==e.getMonth()||f.getYear()!==e.getYear()){return true}return false};var c=this.model.get("timeline");return d(c._previousAttributes.startDate,c.attributes.startDate)||d(c._previousAttributes.endDate,c.attributes.endDate)},_isWeekChanged:function(){var c=function(l,k){var j=moment(l);var i=moment(k);return j.get("year")===i.get("year")&&j.isoWeek()===i.isoWeek()};var d=this.model.get("timeline");var g=d._previousAttributes.startDate;var h=d.attributes.startDate;var f=d._previousAttributes.endDate;var e=d.attributes.endDate;return !(c(g,h)&&c(f,e))},_isTimelineChanged:function(){var d=this.model.get("timeline");var c=d.changed.displayOption;if(c){this.model.updateDurationUnit(d.get("displayOption"))}else{c=d.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?this._isMonthYearChanged():this._isWeekChanged()}return c},resize:function(){this._updateLaneWidth();this._updateTimelineColumnHeight();this.$roadmapContent.css({top:this.$roadmapTimeline.find(".roadmap-column-title:first").innerHeight()})}})})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-analytics-resources', location = 'analytics/roadmap-analytics.js' */
Confluence.Roadmap=Confluence.Roadmap||{};Confluence.Roadmap.Analytics=(function(f,j){var c={INSERT:"confluence.roadmap.insert",CREATE:"confluence.roadmap.create",EDIT:"confluence.roadmap.edit",EDIT_ACTIONS:{OPEN_BAR_DIALOG:"confluence.roadmap.editmode.open_bar_dialog",ADD_DESCRIPTION:"confluence.roadmap.editmode.add_description",ADD_PAGE_LINK:"confluence.roadmap.editmode.add_page_link"},VIEW_ACTIONS:{OPEN_BAR_DIALOG:"confluence.roadmap.viewmode.open_bar_dialog",CLICK_PAGE_LINK:"confluence.roadmap.viewmode.click_page_link",ADD_PAGE_LINK:"confluence.roadmap.viewmode.add_page_link"}};function h(o,p){AJS.trigger("analytics",{name:o,data:p})}function m(p){var o=0;j.each(p.lanes,function(q){o=o+q.bars.length});return{lanes:p.lanes.length,bars:o,markers:p.markers.length,months:Confluence.Roadmap.DateUtilities.getNumberOfMonths(p.timeline.startDate,p.timeline.endDate)+1}}function k(){h(c.INSERT)}function d(p){var o=m(p);h(c.CREATE,o)}function e(p){var o=m(p);h(c.EDIT,o)}function a(){h(c.EDIT_ACTIONS.OPEN_BAR_DIALOG)}function n(){h(c.VIEW_ACTIONS.OPEN_BAR_DIALOG)}function b(){h(c.VIEW_ACTIONS.CLICK_PAGE_LINK)}function l(){h(c.EDIT_ACTIONS.ADD_DESCRIPTION)}function g(o){h(c.EDIT_ACTIONS.ADD_PAGE_LINK,o)}function i(o){h(c.VIEW_ACTIONS.ADD_PAGE_LINK,o)}return{insertRoadmap:k,createRoadmap:d,editRoadmap:e,openBarDialogInEdit:a,addDescription:l,addPageLinkEditMode:g,addPageLinkViewMode:i,openBarDialogInView:n,clickPageLink:b}})(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'lib/jquery.viewport.js' */
(function(a){a.belowthefold=function(c,d){var b=a(window).height()+a(window).scrollTop();return b<=a(c).offset().top-d.threshold};a.abovethetop=function(b,c){var d=a(window).scrollTop();return d>=a(b).offset().top+a(b).height()-c.threshold};a.rightofscreen=function(c,d){var b=a(window).width()+a(window).scrollLeft();return(b<=a(c).offset().left-d.threshold)||a(c).offset().left<0};a.leftofscreen=function(b,c){var d=a(window).scrollLeft();return d>=a(b).offset().left+a(b).width()-c.threshold};a.inviewport=function(b,c){return !a.rightofscreen(b,c)&&!a.leftofscreen(b,c)&&!a.belowthefold(b,c)&&!a.abovethetop(b,c)};a.extend(a.expr[":"],{"below-the-fold":function(c,d,b){return a.belowthefold(c,{threshold:0})},"above-the-top":function(c,d,b){return a.abovethetop(c,{threshold:0})},"left-of-screen":function(c,d,b){return a.leftofscreen(c,{threshold:0})},"right-of-screen":function(c,d,b){return a.rightofscreen(c,{threshold:0})},"in-viewport":function(c,d,b){return a.inviewport(c,{threshold:0})}})})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'lib/jquery.ellipsis.min.js' */
/*! jQuery ellipsis - v1.1.1 - 2014-02-23
* https://github.com/STAR-ZERO/jquery-ellipsis
* Copyright (c) 2014 Kenji Abe; Licensed MIT */
!function(a){a.fn.ellipsis=function(b){var c={row:1,onlyFullWords:!1,"char":"...",callback:function(){},position:"tail"};return b=a.extend(c,b),this.each(function(){var c=a(this),d=c.text(),e=d,f=e.length,g=c.height();c.text("a");var h=parseFloat(c.css("lineHeight"),10),i=c.height(),j=h>i?h-i:0,k=j*(b.row-1)+i*b.row;if(k>=g)return c.text(d),void b.callback.call(this);var l=1,m=0,n=d.length;if("tail"===b.position){for(;n>l;)m=Math.ceil((l+n)/2),c.text(d.slice(0,m)+b["char"]),c.height()<=k?l=m:n=m-1;d=d.slice(0,l),b.onlyFullWords&&(d=d.replace(/[\u00AD\w\uac00-\ud7af]+$/,"")),d+=b["char"]}else if("middle"===b.position){for(var o=0;n>l;)m=Math.ceil((l+n)/2),o=Math.max(f-m,0),c.text(e.slice(0,Math.floor((f-o)/2))+b["char"]+e.slice(Math.floor((f+o)/2),f)),c.height()<=k?l=m:n=m-1;o=Math.max(f-l,0);var p=e.slice(0,Math.floor((f-o)/2)),q=e.slice(Math.floor((f+o)/2),f);b.onlyFullWords&&(p=p.replace(/[\u00AD\w\uac00-\ud7af]+$/,"")),d=p+b["char"]+q}c.text(d),b.callback.call(this)}),this}}(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'editor/md5.js' */
var hexcase=0;var b64pad="";function hex_md5(a){return rstr2hex(rstr_md5(str2rstr_utf8(a)))}function b64_md5(a){return rstr2b64(rstr_md5(str2rstr_utf8(a)))}function any_md5(a,b){return rstr2any(rstr_md5(str2rstr_utf8(a)),b)}function hex_hmac_md5(a,b){return rstr2hex(rstr_hmac_md5(str2rstr_utf8(a),str2rstr_utf8(b)))}function b64_hmac_md5(a,b){return rstr2b64(rstr_hmac_md5(str2rstr_utf8(a),str2rstr_utf8(b)))}function any_hmac_md5(a,c,b){return rstr2any(rstr_hmac_md5(str2rstr_utf8(a),str2rstr_utf8(c)),b)}function md5_vm_test(){return hex_md5("abc").toLowerCase()=="900150983cd24fb0d6963f7d28e17f72"}function rstr_md5(a){return binl2rstr(binl_md5(rstr2binl(a),a.length*8))}function rstr_hmac_md5(c,f){var e=rstr2binl(c);if(e.length>16){e=binl_md5(e,c.length*8)}var a=Array(16),d=Array(16);for(var b=0;b<16;b++){a[b]=e[b]^909522486;d[b]=e[b]^1549556828}var g=binl_md5(a.concat(rstr2binl(f)),512+f.length*8);return binl2rstr(binl_md5(d.concat(g),512+128))}function rstr2hex(c){try{hexcase}catch(g){hexcase=0}var f=hexcase?"0123456789ABCDEF":"0123456789abcdef";var b="";var a;for(var d=0;d<c.length;d++){a=c.charCodeAt(d);b+=f.charAt((a>>>4)&15)+f.charAt(a&15)}return b}function rstr2b64(c){try{b64pad}catch(h){b64pad=""}var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var b="";var a=c.length;for(var f=0;f<a;f+=3){var k=(c.charCodeAt(f)<<16)|(f+1<a?c.charCodeAt(f+1)<<8:0)|(f+2<a?c.charCodeAt(f+2):0);for(var d=0;d<4;d++){if(f*8+d*6>c.length*8){b+=b64pad}else{b+=g.charAt((k>>>6*(3-d))&63)}}}return b}function rstr2any(m,c){var b=c.length;var l,f,a,n,e;var k=Array(Math.ceil(m.length/2));for(l=0;l<k.length;l++){k[l]=(m.charCodeAt(l*2)<<8)|m.charCodeAt(l*2+1)}var h=Math.ceil(m.length*8/(Math.log(c.length)/Math.log(2)));var g=Array(h);for(f=0;f<h;f++){e=Array();n=0;for(l=0;l<k.length;l++){n=(n<<16)+k[l];a=Math.floor(n/b);n-=a*b;if(e.length>0||a>0){e[e.length]=a}}g[f]=n;k=e}var d="";for(l=g.length-1;l>=0;l--){d+=c.charAt(g[l])}return d}function str2rstr_utf8(c){var b="";var d=-1;var a,e;while(++d<c.length){a=c.charCodeAt(d);e=d+1<c.length?c.charCodeAt(d+1):0;if(55296<=a&&a<=56319&&56320<=e&&e<=57343){a=65536+((a&1023)<<10)+(e&1023);d++}if(a<=127){b+=String.fromCharCode(a)}else{if(a<=2047){b+=String.fromCharCode(192|((a>>>6)&31),128|(a&63))}else{if(a<=65535){b+=String.fromCharCode(224|((a>>>12)&15),128|((a>>>6)&63),128|(a&63))}else{if(a<=2097151){b+=String.fromCharCode(240|((a>>>18)&7),128|((a>>>12)&63),128|((a>>>6)&63),128|(a&63))}}}}}return b}function str2rstr_utf16le(b){var a="";for(var c=0;c<b.length;c++){a+=String.fromCharCode(b.charCodeAt(c)&255,(b.charCodeAt(c)>>>8)&255)}return a}function str2rstr_utf16be(b){var a="";for(var c=0;c<b.length;c++){a+=String.fromCharCode((b.charCodeAt(c)>>>8)&255,b.charCodeAt(c)&255)}return a}function rstr2binl(b){var a=Array(b.length>>2);for(var c=0;c<a.length;c++){a[c]=0}for(var c=0;c<b.length*8;c+=8){a[c>>5]|=(b.charCodeAt(c/8)&255)<<(c%32)}return a}function binl2rstr(b){var a="";for(var c=0;c<b.length*32;c+=8){a+=String.fromCharCode((b[c>>5]>>>(c%32))&255)}return a}function binl_md5(p,k){p[k>>5]|=128<<((k)%32);p[(((k+64)>>>9)<<4)+14]=k;var o=1732584193;var n=-271733879;var m=-1732584194;var l=271733878;for(var g=0;g<p.length;g+=16){var j=o;var h=n;var f=m;var e=l;o=md5_ff(o,n,m,l,p[g+0],7,-680876936);l=md5_ff(l,o,n,m,p[g+1],12,-389564586);m=md5_ff(m,l,o,n,p[g+2],17,606105819);n=md5_ff(n,m,l,o,p[g+3],22,-1044525330);o=md5_ff(o,n,m,l,p[g+4],7,-176418897);l=md5_ff(l,o,n,m,p[g+5],12,1200080426);m=md5_ff(m,l,o,n,p[g+6],17,-1473231341);n=md5_ff(n,m,l,o,p[g+7],22,-45705983);o=md5_ff(o,n,m,l,p[g+8],7,1770035416);l=md5_ff(l,o,n,m,p[g+9],12,-1958414417);m=md5_ff(m,l,o,n,p[g+10],17,-42063);n=md5_ff(n,m,l,o,p[g+11],22,-1990404162);o=md5_ff(o,n,m,l,p[g+12],7,1804603682);l=md5_ff(l,o,n,m,p[g+13],12,-40341101);m=md5_ff(m,l,o,n,p[g+14],17,-1502002290);n=md5_ff(n,m,l,o,p[g+15],22,1236535329);o=md5_gg(o,n,m,l,p[g+1],5,-165796510);l=md5_gg(l,o,n,m,p[g+6],9,-1069501632);m=md5_gg(m,l,o,n,p[g+11],14,643717713);n=md5_gg(n,m,l,o,p[g+0],20,-373897302);o=md5_gg(o,n,m,l,p[g+5],5,-701558691);l=md5_gg(l,o,n,m,p[g+10],9,38016083);m=md5_gg(m,l,o,n,p[g+15],14,-660478335);n=md5_gg(n,m,l,o,p[g+4],20,-405537848);o=md5_gg(o,n,m,l,p[g+9],5,568446438);l=md5_gg(l,o,n,m,p[g+14],9,-1019803690);m=md5_gg(m,l,o,n,p[g+3],14,-187363961);n=md5_gg(n,m,l,o,p[g+8],20,1163531501);o=md5_gg(o,n,m,l,p[g+13],5,-1444681467);l=md5_gg(l,o,n,m,p[g+2],9,-51403784);m=md5_gg(m,l,o,n,p[g+7],14,1735328473);n=md5_gg(n,m,l,o,p[g+12],20,-1926607734);o=md5_hh(o,n,m,l,p[g+5],4,-378558);l=md5_hh(l,o,n,m,p[g+8],11,-2022574463);m=md5_hh(m,l,o,n,p[g+11],16,1839030562);n=md5_hh(n,m,l,o,p[g+14],23,-35309556);o=md5_hh(o,n,m,l,p[g+1],4,-1530992060);l=md5_hh(l,o,n,m,p[g+4],11,1272893353);m=md5_hh(m,l,o,n,p[g+7],16,-155497632);n=md5_hh(n,m,l,o,p[g+10],23,-1094730640);o=md5_hh(o,n,m,l,p[g+13],4,681279174);l=md5_hh(l,o,n,m,p[g+0],11,-358537222);m=md5_hh(m,l,o,n,p[g+3],16,-722521979);n=md5_hh(n,m,l,o,p[g+6],23,76029189);o=md5_hh(o,n,m,l,p[g+9],4,-640364487);l=md5_hh(l,o,n,m,p[g+12],11,-421815835);m=md5_hh(m,l,o,n,p[g+15],16,530742520);n=md5_hh(n,m,l,o,p[g+2],23,-995338651);o=md5_ii(o,n,m,l,p[g+0],6,-198630844);l=md5_ii(l,o,n,m,p[g+7],10,1126891415);m=md5_ii(m,l,o,n,p[g+14],15,-1416354905);n=md5_ii(n,m,l,o,p[g+5],21,-57434055);o=md5_ii(o,n,m,l,p[g+12],6,1700485571);l=md5_ii(l,o,n,m,p[g+3],10,-1894986606);m=md5_ii(m,l,o,n,p[g+10],15,-1051523);n=md5_ii(n,m,l,o,p[g+1],21,-2054922799);o=md5_ii(o,n,m,l,p[g+8],6,1873313359);l=md5_ii(l,o,n,m,p[g+15],10,-30611744);m=md5_ii(m,l,o,n,p[g+6],15,-1560198380);n=md5_ii(n,m,l,o,p[g+13],21,1309151649);o=md5_ii(o,n,m,l,p[g+4],6,-145523070);l=md5_ii(l,o,n,m,p[g+11],10,-1120210379);m=md5_ii(m,l,o,n,p[g+2],15,718787259);n=md5_ii(n,m,l,o,p[g+9],21,-343485551);o=safe_add(o,j);n=safe_add(n,h);m=safe_add(m,f);l=safe_add(l,e)}return Array(o,n,m,l)}function md5_cmn(h,e,d,c,g,f){return safe_add(bit_rol(safe_add(safe_add(e,h),safe_add(c,f)),g),d)}function md5_ff(g,f,k,j,e,i,h){return md5_cmn((f&k)|((~f)&j),g,f,e,i,h)}function md5_gg(g,f,k,j,e,i,h){return md5_cmn((f&j)|(k&(~j)),g,f,e,i,h)}function md5_hh(g,f,k,j,e,i,h){return md5_cmn(f^k^j,g,f,e,i,h)}function md5_ii(g,f,k,j,e,i,h){return md5_cmn(k^(f|(~j)),g,f,e,i,h)}function safe_add(a,d){var c=(a&65535)+(d&65535);var b=(a>>16)+(d>>16)+(c>>16);return(b<<16)|(c&65535)}function bit_rol(a,b){return(a<<b)|(a>>>(32-b))};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'editor/roadmap-editor.js' */
AJS.toInit(function(){var g,d,a,c,e;var f="~~~~~";AJS.MacroBrowser.setMacroJsOverride("roadmap",{opener:function(l){var n=function(s,q,r,t){var p=r?r.split(f):[];var o=q?q.split(f):[];if(!_.isEmpty(p)){$.ajax({type:"POST",contentType:"application/json",url:AJS.contextPath()+"/rest/roadmap/1.0/extractPageLinks",data:JSON.stringify({wikiLinks:_.object(p,o),roadmapSpace:AJS.Meta.get("space-key")}),success:function(u){_.each(s.lanes,function(v){_.chain(v.bars).filter(function(w){return _.contains(p,w.id)}).each(function(w){if(u[w.id]){w.pageLink=u[w.id]}})});t&&t()},error:function(u){AJS.log(u);t&&t()}})}else{t&&t()}},m=function(p){var q=[];var o=[];p.lanes.forEach(function(r){r.bars.forEach(function(s){if(!_.isEmpty(s.pageLink)){var t=s.pageLink.wikiLink.replace(/[\][]/g,"");q.push(_.escape(t));o.push(s.id)}})});return{pageLinks:q.join(f),mapLinks:o.join(f)}};if(l.params&&l.params.timeline!=="true"){var i="roadmap-deprecation-dialog";var j=$(Confluence.Templates.Roadmap.deprecationDialog({id:i}));AJS.dialog2(j).on("hide",function(){$("#"+i).remove()}).on("show",function(){$("#dialog-close-button",j).click(function(o){o.preventDefault();AJS.dialog2("#"+i).hide()})}).show();return false}var h;var k=function(){var p="confluence-roadmap-dialog";var t="roadmap-popup-panel";var s;if(typeof g=="undefined"){g=aui.dialog.dialog2({id:p,size:"xlarge",titleText:"\u63d2\u5165\u8def\u7ebf\u56fe\u8ba1\u5212\u5668",content:Confluence.Templates.Roadmap.roadmapPopupPanel({roadmapPopupPanelId:t}),footerActionContent:Confluence.Templates.Roadmap.footerActionContent(),modal:true});d=$(g).appendTo($("body"));d.find("#roadmapInsertBtn").on("click",function(y){c.removeDialog();var v=c.model.toMacroData();var w=encodeURIComponent(JSON.stringify(v));var x=hex_md5(w);var z=m(v);var u={timeline:"true",source:w,hash:x,title:encodeURIComponent(v.title),pagelinks:z.pageLinks,maplinks:z.mapLinks};tinymce.confluence.macrobrowser.macroBrowserComplete({name:"roadmap",params:u});c.remove();s.hide();if(e){Confluence.Roadmap.Analytics.createRoadmap(v)}else{Confluence.Roadmap.Analytics.editRoadmap(v)}});d.find("#roadmapCancelBtn").on("click",function(u){c.removeDialog();c.remove();s.hide()});a=d.find(".roadmap-editor-popup")}s=AJS.dialog2("#"+p).show();var o=$("#"+t);var q=o.find(".roadmap-view");if(!q.length){q=$('<div class="roadmap-view"/>');o.append(q)}var r=new Roadmap.Roadmap(h,{parse:true});c=new Roadmap.RoadmapEditorView({model:r,dialogId:p,el:q,roadmapEditorPopup:a});c.render();b()};if(l.params&&l.params.source){e=false;h=JSON.parse(decodeURIComponent(l.params.source));n(h,l.params.pagelinks,l.params.maplinks,k)}else{e=true;Confluence.Roadmap.Analytics.insertRoadmap();k()}}});function b(){setTimeout(function(){if(d&&d.is(":visible")){var k=d.height(),j=d.find(".aui-dialog2-header").outerHeight(),l=d.find(".aui-dialog2-footer").outerHeight(),i=d.find("#roadmap-editor-toolbar").outerHeight(),h=d.find(".roadmap-editor-popup");h.css("height",k-j-l-i)}},0)}$(window).resize(function(){b();c&&c.resize()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'editor/roadmap-editor-config.js' */
(function(){window.Roadmap=window.Roadmap||{};Roadmap.COLORS=[{lane:"#f6c342",bar:"#fadb8e",text:"#594300"},{lane:"#3b7fc4",bar:"#6c9fd3",text:"#ffffff"},{lane:"#d04437",bar:"#dc7369",text:"#ffffff"},{lane:"#8eb021",bar:"#aac459",text:"#ffffff"},{lane:"#ea632b",bar:"#ef8a60",text:"#ffffff"},{lane:"#654982",bar:"#8c77a1",text:"#ffffff"},{lane:"#f15c75",bar:"#f58598",text:"#ffffff"},{lane:"#815b3a",bar:"#a1846b",text:"#ffffff"}];Roadmap.TIMELINE_DISPLAY_OPTION={MONTH:"MONTH",WEEK:"WEEK"};Roadmap.SHORT_DATE_FORMAT="YYYY-MM-DD";Roadmap.TWO_YY_SHORT_DATE_FORMAT="YY-MM-DD";Roadmap.DATE_FORMAT="YYYY-MM-DD HH:mm:ss";Roadmap.WEEK_FORMAT="DD-MMM";Roadmap.MONTH_FORMAT="MMM";Roadmap.TIMELINE_YEARS_LIMIT=5;Roadmap.LANE_TITLE_WIDTH=45;Roadmap.MARKER_HEIGHT_PADDING=10;Roadmap.MARKER_TITLE_LINE=2;Roadmap.LANE_PADDING=11;Roadmap.BAR_PADDING=8;Roadmap.BAR_MARGIN=1;Roadmap.BAR_BORDER=1;Roadmap.MONTH_WIDTH=101;Roadmap.WEEK_WIDTH=101;Roadmap.EXTRA_SPACE_AROUND=Roadmap.BAR_PADDING*2+Roadmap.BAR_BORDER*2;Roadmap.MONTH_BAR_MIN_WIDTH=Roadmap.MONTH_WIDTH/4-Roadmap.EXTRA_SPACE_AROUND;Roadmap.WEEK_BAR_MIN_WIDTH=Roadmap.WEEK_WIDTH-Roadmap.EXTRA_SPACE_AROUND;Roadmap.barMinWidth=Roadmap.MONTH_BAR_MIN_WIDTH;Roadmap.TRANSPARENT_LANE={title:"",color:{lane:"#ffffff",bar:"#ffffff",text:"#ffffff"}};Roadmap.DragDrop={};Roadmap.BarDialog={MAX_LENGTH_TITLE:100,MAX_LENGTH_DESCRIPTION:150};Roadmap.getDefaultRoadmapData=function(){var a=moment(new Date()).hours(0).minutes(0).seconds(0).milliseconds(0).toDate();var b=moment(a).add(11,"months").toDate();return{title:"\u8def\u7ebf\u56fe\u7f16\u8f91\u5668",timeline:{startDate:new Date(a),endDate:b,displayOption:Roadmap.TIMELINE_DISPLAY_OPTION.MONTH},lanes:[{title:"\u9053 1",color:Roadmap.COLORS[0],bars:[{title:"\u6a2a\u67611",description:"\u8fd9\u662f\u7b2c\u4e00\u4e2a\u6a2a\u6761",startDate:new Date(a.setDate(1)),duration:2,rowIndex:0},{title:"\u680f 2",description:"\u8fd9\u662f\u7b2c\u4e8c\u680f\u3002",startDate:new Date(a),duration:1,rowIndex:1}]},{title:"\u9053 2",color:Roadmap.COLORS[1],bars:[{title:"\u680f 3",description:"\u8fd9\u662f\u7b2c\u4e09\u680f\u3002",startDate:a,duration:2.5,rowIndex:0}]}],markers:[{title:"\u6807\u8bb0 1",markerDate:moment(a).date(15).toDate()}]}}})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.macros.advanced:include_macro', location = 'com/atlassian/confluence/plugins/macros/advanced/js/include-macro.js' */
AJS.bind("init.rte",function(){var b=AJS.Meta.get("context-path"),d=AJS.Meta.get("content-id"),c="plugins/servlet/confluence/include-page-macro/goto",a=function(e){var j=AJS.$(e),f=j.attr("data-macro-default-parameter"),h=b+"/"+c+"?location="+encodeURIComponent(f)+"&contentId="+d,g=(AJS.$.browser&&AJS.$.browser.msie)?"_blank":"confluence-goto-link-include-macro-"+e.id,i=window.open(h,g);if(i){i.focus()}};AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("goto-page",function(g,f){a(f)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.macros.multimedia:macro-browser-smart-fields', location = 'javascript/macro-fields.js' */
(function(a){AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("multimedia",["swf","avi","mov","mp4","mpeg","mpg","wmv","wma","mp3","ram","rm"])})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-layout:pagelayout-frontend', location = 'js/pagelayout/page-layout.soy' */
// This file was automatically generated from page-layout.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.PageLayout.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.PageLayout == 'undefined') { Confluence.Templates.PageLayout = {}; }


Confluence.Templates.PageLayout.contentLayout = function(opt_data, opt_ignored) {
  return '<div class="contentLayout"></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.contentLayout.soyTemplateName = 'Confluence.Templates.PageLayout.contentLayout';
}


Confluence.Templates.PageLayout.cellLayout = function(opt_data, opt_ignored) {
  return '<div class="cell"><div class="innerCell"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.cellLayout.soyTemplateName = 'Confluence.Templates.PageLayout.cellLayout';
}


Confluence.Templates.PageLayout.smallCellLayout = function(opt_data, opt_ignored) {
  return '<div class="cell aside"><div class="innerCell"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.smallCellLayout.soyTemplateName = 'Confluence.Templates.PageLayout.smallCellLayout';
}


Confluence.Templates.PageLayout.headerLayout = function(opt_data, opt_ignored) {
  return '<div class="header"><div class="innerCell"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.headerLayout.soyTemplateName = 'Confluence.Templates.PageLayout.headerLayout';
}


Confluence.Templates.PageLayout.footerLayout = function(opt_data, opt_ignored) {
  return '<div class="footer"><div class="innerCell"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.footerLayout.soyTemplateName = 'Confluence.Templates.PageLayout.footerLayout';
}


Confluence.Templates.PageLayout.columnLayout = function(opt_data, opt_ignored) {
  return '<div class="columnLayout"></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.columnLayout.soyTemplateName = 'Confluence.Templates.PageLayout.columnLayout';
}


Confluence.Templates.PageLayout.emptyLayout2 = function(opt_data, opt_ignored) {
  return '<div class="contentLayout2">' + Confluence.Templates.PageLayout.emptySection2(null) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.emptyLayout2.soyTemplateName = 'Confluence.Templates.PageLayout.emptyLayout2';
}


Confluence.Templates.PageLayout.emptySection2 = function(opt_data, opt_ignored) {
  return '<div class="columnLayout single" data-layout="single">' + Confluence.Templates.PageLayout.cell2({type: 'normal'}) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.emptySection2.soyTemplateName = 'Confluence.Templates.PageLayout.emptySection2';
}


Confluence.Templates.PageLayout.newSection2 = function(opt_data, opt_ignored) {
  return '<div class="columnLayout single" data-layout="single">' + Confluence.Templates.PageLayout.cell2({type: 'normal'}) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.newSection2.soyTemplateName = 'Confluence.Templates.PageLayout.newSection2';
}


Confluence.Templates.PageLayout.cell2 = function(opt_data, opt_ignored) {
  return '<div class="cell ' + soy.$$escapeHtml(opt_data.type) + '" data-type="' + soy.$$escapeHtml(opt_data.type) + '"><div class="innerCell">' + ((opt_data.content) ? soy.$$filterNoAutoescape(opt_data.content) : '') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageLayout.cell2.soyTemplateName = 'Confluence.Templates.PageLayout.cell2';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-layout:pagelayout-frontend', location = 'js/pagelayout/tinymce-page-layout.js' */
define("confluence-page-layout/pagelayout/tinymce-page-layout",["jquery","ajs","tinymce"],function(e,f,c){function j(a){a=e(a.getBody());if(a.children(".contentLayout").length)return!1;a.children(".contentLayout2");return!0}var i=function(a){var c=e("#pagelayout-menu"),h=e(".icon-check",c);i=function(a){var b=h.not(".hidden"),a=h.siblings("."+a.name).siblings();b.addClass("hidden");a.removeClass("hidden")};i(a)};return{init:function(a){function l(){j(a)||c.plugins.PageLayoutPlugin.PageLayout.needsContentEditableBody(b.getLayout())||
c.webkit||f.Rte.editorFocus(a)}function h(){c.isGecko&&setTimeout(function(){a.focus();a.dom.getRoot().focus()},1)}function k(){var g=e("#pagelayout-menu").parent(),d=e("#page-layout-2-group");j(a)?(g.addClass("hidden"),d.removeClass("hidden"),b=new c.plugins.PageLayoutPlugin.PageLayout2(a),c.plugins.PageLayoutPlugin.PageLayout2.needsContentEditableBody()&&e(a.getBody()).attr("contenteditable","true")):(g.removeClass("hidden"),d.addClass("hidden"),b=new c.plugins.PageLayoutPlugin.PageLayout(a),c.plugins.PageLayoutPlugin.PageLayout.needsContentEditableBody(b.getLayout())?
b.body.attr("contenteditable","true"):h(),i(b.getLayout()))}var b;this.ed=a;"comment"!==f.Meta.get("content-type")&&(a.onInit.add(function(){a.undoManager.clear();a.undoManager.add();k();f.bind("editor.remote.change editor.local.change",function(){a.undoManager.ignore(function(){b.setup()})});f.bind("rte-ready",function(){var b=e('[contenteditable="true"]',a.getBody()),d=!1!==f.Meta.get("editor-auto-focus");b.attr("contenteditable","false");b.attr("contenteditable","true");d&&f.Rte.editorFocus(a)});
a.selection.onSetContent.add(l);j(a)&&a.undoManager.onUndo.add(function(){c.plugins.PageLayoutPlugin.PageLayout2.needsContentEditableBody()&&b.body.attr("contenteditable","true");h()})}),e("#pagelayout-menu").delegate("li.dropdown-item a","click",function(){a.execCommand("mcePageLayout",!1,c.plugins.PageLayoutPlugin.PageLayout.getLayoutOptions(this))}),a.addCommand("mcePageLayoutInitialize",function(){a.undoManager.add();b.createInitialLayoutIfNone()}),a.addCommand("mcePageLayout",function(g,d){a.undoManager.add();
b.setLayout(d);i(b.getLayout())}),a.addCommand("mcePageLayoutAddSection",function(g,d){a.undoManager.add();b.addSection&&b.addSection(d&&d.section)}),a.addCommand("mcePageLayoutChangeSection",function(g,d){a.undoManager.add();b.changeSection&&b.changeSection(d&&d.layout,d&&d.section)}),a.addCommand("mcePageLayoutRemoveSection",function(g,d){a.undoManager.add();b.removeSection&&b.removeSection(d&&d.section)}),a.addCommand("mcePageLayoutMoveSectionUp",function(g,d){a.undoManager.add();b.moveSectionUp&&
b.moveSectionUp(d&&d.section)}),a.addCommand("mcePageLayoutMoveSectionDown",function(g,d){a.undoManager.add();b.moveSectionDown&&b.moveSectionDown(d&&d.section)}),a.onSetContent.add(k),a.onClick.add(function(a,d){var b=e(d.target);b.is("div.cell")&&b.children(".innerCell").focus();if(c.isWebKit&&(d.target===a.getBody()||d.target===a.getBody().parentNode))b=b.find(".innerCell"),b.length&&(a.execCommand("selectAll"),b=d.target!==a.getBody(),a.selection.collapse(b))}),!c.isIE9&&a.onKeyUp.add(function(a,
b){var c=b.keyCode;if(8!==c&&46!==c)return!0;c=a.selection.getRng(!0).startContainer;if(e(c).closest(".contentLayout,.contentLayout2",a.getBody()).length&&(c=e(c).closest(".innerCell"))&&c.length&&a.dom.isEmpty(c.clone()[0]))c.html('<p><br data-mce-bogus="1"></p>'),b.preventDefault(),a.selection.select(c[0].firstElementChild.firstChild,!0),a.selection.collapse(!0)}))},execCommand:function(a){if("selectAll"===a){var a=this.ed,c=a.getBody(),e,f;if("true"==a.dom.getAttrib(c,"contenteditable"))return!1;
e=a.dom.select(".innerCell",c);c=e[0];e=e[e.length-1];f=a.dom.createRng();f.setStart(c,0);f.setEnd(e,e.childNodes.length);a.selection.setRng(f);return!0}return!1},disableContent:function(){this.ed.dom.setAttribs(this.ed.dom.select("div.innerCell"),{contenteditable:!1});this.ed.dom.setStyle(this.ed.dom.select(".wiki-content .contentLayout2"),"user-select","auto")},getInfo:function(){return{longname:"Page Layout Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",
version:"1.0"}}}});require("confluence/module-exporter").safeRequire("confluence-page-layout/pagelayout/tinymce-page-layout",function(e){var f=require("tinymce");f.create("tinymce.plugins.PageLayoutPlugin",e);f.PluginManager.add("pagelayoutplugin",f.plugins.PageLayoutPlugin)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-layout:pagelayout-frontend', location = 'js/pagelayout/page-layout.js' */
define("confluence-page-layout/pagelayout/page-layout",["jquery","confluence/templates","ajs"],function(c,k,r){var h=function(a){this.editor=a;this.body=c(a.getBody());this.setup()};h.DEFAULT_LAYOUT={name:"pagelayout-none",columns:0};h.prototype.setup=function(){var a=c(".contentLayout",this.body);a.length?(n(a),o(a,this.body,this.editor),this.editor.undoManager.add()):this.body.attr("contenteditable","true")};h.prototype.setLayout=function(a){var g=require("tinymce"),b;b=c(".contentLayout",this.body);
if(h.getLayoutOptions(b).name!==a.name){r.trigger("analyticsEvent",{name:"PageLayoutEvent.pageLayoutChanged",data:{name:a.name}});if(1===b.length)b=b.clone();else{var d=this.editor;b=this.body;var e=k.PageLayout.contentLayout(),d=d.dom.create("div");d.innerHTML=e;b=c(d).children().html(b.html())}n(b);var e=b,d=c(".columnLayout > .cell",e).length,i=a.name,j=a.columns,f;if(0===d){f=e.html();for(e.html(k.PageLayout.columnLayout());d!==j.length;)p(e),d++}i=i.substring(i.indexOf("-")+1);i=i.substring(0,
Math.max(0,i.indexOf("-"))||void 0);c(".columnLayout",e).attr("class","columnLayout "+i+"Columns");if(j)for(c(".columnLayout > .cell",e).each(function(a,b){void 0!==j[a]&&c(b).attr("class","cell "+j[a])});d!==j.length;)if(d<j.length)p(e),d++;else{var i=c(".columnLayout .cell:nth-child("+d+") .innerCell",e),s=c(".columnLayout > .cell:nth-child("+(d-1)+") .innerCell",e),t=l(i);s.append(t);i.parent().remove();d--}else{var m="";c(".columnLayout > .cell",e).each(function(){m+=l(c(".innerCell",this))});
c(".columnLayout",e).replaceWith(m)}f&&q(e).html(f);a.header?(f=b,c(".header",f).length||f.prepend(k.PageLayout.headerLayout())):(e=b,f=c(".header",e),e=q(e),d=l(c(".innerCell",f)),e.length?(e.prepend(d),f.remove()):f.replaceWith(d));a.footer?(f=b,c(".footer",f).length||f.append(k.PageLayout.footerLayout())):(e=b,f=c(".footer",e),e=c(".columnLayout > .cell:last-child .innerCell",e),d=l(c(".innerCell",f)),e.length?(e.append(d),f.remove()):f.replaceWith(d));h.needsContentEditableBody(a)?(b=b.contents().unwrap(),
this.body.attr("contenteditable","true")):(o(b,this.body,this.editor),b.attr("data-atlassian-layout",JSON.stringify(a)));this.body.empty().append(b);g.isIE&&this.editor.dom.setRoot();b=this.editor;a=b.selection;g=a.getRng(!0);f=c('[contenteditable="true"]',b.getBody());f.length?(b.focus(),f[0].focus(),b=f.children()[0],g.setStart(b,0),g.setEnd(b,0),a.setRng(g)):b.focus()}};h.prototype.getLayout=function(){var a=c(".contentLayout",this.body);return a.length&&a.attr("data-atlassian-layout")?JSON.parse(a.attr("data-atlassian-layout")):
h.DEFAULT_LAYOUT};h.getLayoutOptions=function(a){return(a=(a.jquery?a:c(a)).attr("data-atlassian-layout"))?JSON.parse(a):h.DEFAULT_LAYOUT};h.needsContentEditableBody=function(a){return!(a.header||a.footer||a.columns)};var l=function(a){a=a.jquery?a:c(a);if(a.length)for(var g=a[0].childNodes,b=0;b<g.length;b++){var d=g[b];if(!("P"===d.nodeName&&1===d.childNodes.length&&"BR"===d.firstChild.nodeName))return a.html()}return""},n=function(a){for(var g,b,a=c(".cell, .header, .footer",a),d=0,e=a.length;d<
e;d++)g=c(a[d]),b=g.html(),c(".innerCell",g).length||(g.removeAttr("contenteditable"),g.html('<div class="innerCell">'+b+"</div>"))},o=function(a,g,b){var d=require("tinymce");g.attr("contenteditable","false");c(".innerCell",a).each(function(){var a=c(this);a.attr("contenteditable","true");a.children().length||a.append("<p><br /></p>")});d.isIE&&g.delegate(".innerCell","focus.pageLayout",function(){b.dom.settings.root_element=this})},q=function(a){return c(".columnLayout > .cell:first-child .innerCell",
a)},p=function(a){return c(".columnLayout",a).append(k.PageLayout.cellLayout())};return h});require("confluence/module-exporter").exportModuleAsGlobal("confluence-page-layout/pagelayout/page-layout","tinymce.plugins.PageLayoutPlugin.PageLayout");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-layout:pagelayout-frontend', location = 'js/pagelayout/page-layout-2.js' */
define("confluence-page-layout/pagelayout/page-layout-2",["jquery","confluence/templates","ajs"],function(f,o,g){function q(a,b,c,d){var e=a.find(".cell"),g=e.length,n=f(),k=b.cells.length,i=[],l=[],h,j;a.attr("class","columnLayout");a.addClass(b.id);a.attr("data-layout",b.id);h=0;for(j=g;h<j;h++)l=e.eq(h).detach(),i.push(t(l.children(".innerCell")));h=0;for(j=k;h<j;h++)n=n.add(o.PageLayout.cell2({type:b.cells[h].type||""}));if(g<=k)l=i;else{l=i.slice(0,k);h=k;for(j=g;h<j;h++)l[k-1]+=i[h]}a.prepend(n);
h=0;for(j=k;h<j;h++)n.eq(h).find(".innerCell").html(l[h]);p(a,c,d)}var e=function(a){this.editor=a;this.body=f(a.getBody());this.setup()};e.prototype.setup=function(){var a=this.body.find(".contentLayout2");a.length?(p(a,this.body,this.editor),this.body.find("> p").each(function(){""===this.id.trim()&&0===this.classList.length&&f(this).remove()}),this.body.find(".contentLayout2 .cell").filter(function(){return 1<f(this).find(".innerCell").length}).each(function(a,c){for(var d=f(c).find(".innerCell"),
e=d[0],g=1;g<d.length;g++){var i=f(d[g]);f(e).append(i.children());i.remove()}}),this.editor.undoManager.add()):this.body.attr("contenteditable","true")};e.prototype.addSection=function(a){var b=this,c=f(o.PageLayout.newSection2()),d=a||i(this.body,this.editor,!0);if(d.length){var s=e.Layouts.get(d.attr("data-layout"));this.editor.undoManager.ignore(function(){q(c,s,b.body,b.editor);d.after(c)});m(this.editor,c);g.trigger("editor.page-layout.add-section",{section:c})}else this.createInitialLayoutIfNone()};
e.prototype.changeSection=function(a,b){var c=this;e.isPageLayout()||this.createInitialLayoutIfNone();var d=b||i(this.body,this.editor,!1);if(d.length){var f=e.Layouts.get(d.attr("data-layout"));this.editor.undoManager.ignore(function(){q(d,a,c.body,c.editor)});m(this.editor,d);g.trigger("editor.page-layout.change-layout",{section:d,originalLayout:f,currentLayout:a})}};e.prototype.removeSection=function(a){if(e.isPageLayout()){var a=a||i(this.body,this.editor,!0),b=a.next(),c=a.prev(),d;b.length?
(d=b,a.remove()):c.length?(d=c,a.remove()):(a.closest(".contentLayout2").remove(),a=this.body.find(".contentLayout2").find(".columnLayout").first(),a.length?d=a:(a=this.editor,a.getBody().setAttribute("contenteditable",!0),a.setContent("<p></p>"),r(a),a=f("#rte-button-pagelayout-2"),a.hasClass("active")&&a.click()));d&&d.length&&m(this.editor,d);g.trigger("editor.page-layout.remove-section",{})}};e.prototype.moveSectionUp=function(a){if(e.isPageLayout()){var a=a||i(this.body,this.editor,!0),b=a.prev();
b.length&&(a.detach(),b.before(a),m(this.editor,a));g.trigger("editor.page-layout.move-section-up",{section:a})}};e.prototype.moveSectionDown=function(a){if(e.isPageLayout()){var a=a||i(this.body,this.editor,!0),b=a.next();b.length&&(a.detach(),b.after(a),m(this.editor,a));g.trigger("editor.page-layout.move-section-down",{section:a})}};e.prototype.createInitialLayoutIfNone=function(){if(!e.isPageLayout()){var a=f(o.PageLayout.emptyLayout2()),b=a.find(".innerCell"),c=this.body.children().detach();
b.append(c);this.body.append(a);p(a,this.body,this.editor);r(this.editor)}};e.isPageLayout=function(){return!!f(g.Rte.getEditor().getBody()).find("div.contentLayout2").length};e.needsContentEditableBody=function(){return!e.isPageLayout()};e.Layouts=[{id:"single",icon:"1col",name:"\u5355\u5217\u8282",cells:[{type:"normal"}]},{id:"two-equal",icon:"2col",name:"\u4e24\u5217\u8282",cells:[{type:"normal"},{type:"normal"}]},{id:"two-left-sidebar",icon:"2col-right",
name:"\u542b\u5de6\u4fa7\u8fb9\u680f\u7684\u4e24\u5217\u8282",cells:[{type:"aside"},{type:"normal"}]},{id:"two-right-sidebar",icon:"2col-left",name:"\u542b\u53f3\u4fa7\u8fb9\u680f\u7684\u4e24\u5217\u8282",cells:[{type:"normal"},{type:"aside"}]},{id:"three-equal",icon:"3col",name:"\u4e09\u5217\u8282",cells:[{type:"normal"},{type:"normal"},{type:"normal"}]},{id:"three-with-sidebars",icon:"3col-center",name:"\u5305\u542b\u8fb9\u680f\u7684\u4e09\u5217\u8282",cells:[{type:"sidebars"},
{type:"normal"},{type:"sidebars"}]}];e.Layouts.get=function(a){for(var b=e.Layouts,c=0,d=b.length;c<d;c++)if(b[c].id===a)return b[c];return null};e.Layouts.findNearestSection=function(a){var b=g.Rte.getEditor(),c=f(b.getBody());return i(c,b,a)};var t=function(a){a=f(a);if(a.length)for(var b=a[0].childNodes,c=0;c<b.length;c++){var d=b[c];if(!("P"===d.nodeName&&1===d.childNodes.length&&"BR"===d.firstChild.nodeName))return a.html()}return""},i=function(a,b,c){b=f(b.selection.getRng(!0).startContainer).closest(".columnLayout");
!b.length&&c&&(b=a.find(".columnLayout").last());return b},p=function(a,b,c){var d=require("tinymce");b.attr("contenteditable","false");f(".innerCell",a).each(function(){var a=f(this);a.attr("contenteditable","true");a.children().length||a.append("<p><br /></p>")});d.isIE&&b.delegate(".innerCell","focus.pageLayout",function(){c.dom.settings.root_element=this})},r=function(a){var b=a.selection,c=b.getRng(!0),d=f('[contenteditable="true"]',a.getBody());d.length?(a.focus(),d[0].focus(),a=d.children()[0],
c.setStart(a,0),c.setEnd(a,0),b.setRng(c)):a.focus()},m=function(a,b){var c=a.selection,d=c.getRng(!0),e=b.find('[contenteditable="true"]').first(),f=e.children();f.length?(a.focus(),e[0].focus(),e=f[0],d.setStart(e,0),d.setEnd(e,0),c.setRng(d),g.Rte.showElement(e)):a.focus()};return e});require("confluence/module-exporter").exportModuleAsGlobal("confluence-page-layout/pagelayout/page-layout-2","tinymce.plugins.PageLayoutPlugin.PageLayout2");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-layout:pagelayout-frontend', location = 'js/pagelayout/tinymce-page-layout-toolbar.js' */
define("confluence-page-layout/pagelayout/tinymce-page-layout-toolbar",["jquery","ajs","tinymce","document","confluence/legacy"],function(d,b,e,f,a){var i=function(a){var a=a||e.plugins.PageLayoutPlugin.PageLayout2.Layouts.findNearestSection(),c=a.attr("data-layout"),a=d("#rte-toolbar-row-pl2-toolbar").find(".layouts button"),c=a.find(".pl2-layout-"+c).closest(".aui-button");c.hasClass("active")||(a.filter(".active").removeClass("active"),c.addClass("active"))};return{initContextToolbars:function(p,
c){var j=d(f),m=d("#page-layout-2"),g=d("#rte-button-pagelayout-2");c.addCommand("mcePageLayoutsToolbar",function(){g.hasClass("active")?j.trigger("removeContextToolbarRow.Toolbar",{id:"pl2-toolbar",animate:!0}):(j.trigger("createContextToolbarRow.Toolbar",{id:"pl2-toolbar",buttons:a.Editor.PageLayoutToolbar.Buttons,topToolbar:!0,animate:!0}),i(),c.execCommand("mcePageLayoutInitialize"));g.toggleClass("active")});g.click(function(a){a.preventDefault();m.hasClass("disabled")||c.execCommand("mcePageLayoutsToolbar",
!1,null)});c.onNodeChange.add(function(a,c,b){a=d(b).closest(".columnLayout");i(a)});for(var k=e.plugins.PageLayoutPlugin.PageLayout2.Layouts,l=[],n=function(b){l.push(new a.Editor.Toolbar.Components.Button({text:b.name,iconClass:"aui-icon aui-icon-small aui-iconfont-layout-"+b.icon+"-large",click:function(){c.execCommand("mcePageLayoutChangeSection",!1,{layout:b})}}))},h=0,o=k.length;h<o;h++)n(k[h]);return{Buttons:[new a.Editor.Toolbar.Components.Group([new a.Editor.Toolbar.Components.Button({triggerText:"\u6dfb\u52a0\u8282",
id:"add-layout-section",tooltip:"\u5728\u4e0b\u65b9\u6dfb\u52a0\u4e00\u4e2a\u65b0\u8282",iconClass:"aui-icon aui-icon-small aui-iconfont-add",click:function(){c.execCommand("mcePageLayoutAddSection")}}),new a.Editor.Toolbar.Components.Button({triggerText:"\u5220\u9664\u8282",id:"remove-layout-section",tooltip:"\u5220\u9664\u5f53\u524d\u8282",iconClass:"aui-icon aui-icon-small aui-iconfont-delete",click:function(){c.execCommand("mcePageLayoutRemoveSection")}})]),
new a.Editor.Toolbar.Components.Group([new a.Editor.Toolbar.Components.Button({triggerText:"\u4e0a\u79fb",id:"move-up-layout-section",tooltip:"\u8282\u4e0a\u79fb",iconClass:"aui-icon aui-icon-small aui-iconfont-up",click:function(){c.execCommand("mcePageLayoutMoveSectionUp")}}),new a.Editor.Toolbar.Components.Button({triggerText:"\u4e0b\u79fb",id:"move-down-layout-section",tooltip:"\u8282\u4e0b\u79fb",
iconClass:"aui-icon aui-icon-small aui-iconfont-down",click:function(){c.execCommand("mcePageLayoutMoveSectionDown")}})]),new a.Editor.Toolbar.Components.Group(l,{id:"pagelayout2-toolbar",text:"\u5e94\u7528\u5e03\u5c40",groupClass:"layouts"}),new a.Editor.Toolbar.Components.Group([new a.Editor.Toolbar.Components.Button({text:"\u5173\u95ed\u5de5\u5177\u680f",iconClass:"aui-icon aui-icon-small aui-iconfont-close-dialog",click:function(){c.execCommand("mcePageLayoutsToolbar",!1,
null)}})],{groupClass:"close"})],Events:[]}}}});require("confluence/module-exporter").safeRequire("confluence-page-layout/pagelayout/tinymce-page-layout-toolbar",function(d){var b=require("confluence/meta"),e=require("jquery"),f=require("document"),a=require("confluence/legacy");"comment"!==b.get("content-type")&&e(f).bind("initContextToolbars.Toolbar",function(b,e){a.Editor.PageLayoutToolbar=d.initContextToolbars(b,e)})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:space-page-picker-shim', location = 'js/space-page-picker-shim.js' */
define("confluence-inline-tasks/space-page-picker-shim",["confluence-ui-components/js/space-page-picker"],function(d){function c(e){var g=e.space;var h=e.page;var f=[];if(g){f=f.concat(_.map(g.split(","),function(i){return"space:"+i}))}if(h){f=f.concat(_.map(h.split(","),function(i){return"page:"+i}))}return f.join(",")}function b(f){var e={page:[],space:[]};if(!f){return e}var g=f.split(",");g.forEach(function(h){var k=h.split(":");var j=k[0];var i=k[1];e[j].push(i)});return e}function a(e){return b(e.val())}return{build:function(e){return d.build(e)},setValue:function(f,e){return d.setValue(f,e)},splitStringToMap:b,combineMapToString:c,getValueAsMap:a}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:inline-tasks-macro-browser', location = 'js/macro-browser-overrides.js' */
define("confluence-inline-tasks/macro-browser-overrides",["jquery","ajs","confluence/templates","confluence-macro-browser/macro-browser","confluence-inline-tasks/space-page-picker-shim"],function(e,a,d,c,b){return{fields:{string:{spaceAndPage:function(i){var h=i.multiple?"autocomplete-multi-space-and-page":"autocomplete-space-and-page";var g=e(d.MacroBrowser.macroParameter());var j=g.find("input[type='text']");j.addClass(h).attr("data-none-message","\u672a\u627e\u5230");if(i.required){j.keyup(c.processRequiredParameters)}j.auiSelect2(b.build({multiple:i.multiple,orgElement:j,inputSpaceId:"legacy-macro-param-spaces",inputSpaceCatId:"legacy-macro-param-space-cats",inputPageId:"legacy-macro-param-pages"}));var f={setValue:function(k){b.setValue(k,j)}};return c.Field(g,j,f)}}},beforeParamsSet:function(f){var g=b.combineMapToString({page:f.pages,space:f.spaces});if(g){f.spaceAndPage=g}delete f.pages;delete f.spaces;return f},beforeParamsRetrieved:function(g){var f=b.splitStringToMap(g.spaceAndPage);if(f.page.length){g.pages=f.page.join(",")}if(f.space.length){g.spaces=f.space.join(",")}delete g.spaceAndPage;return g}}});require("confluence/module-exporter").safeRequire("confluence-inline-tasks/macro-browser-overrides",function(a){require("confluence-macro-browser/macro-browser").setMacroJsOverride("tasks-report-macro",a)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:confluence-inlineTasks-utils', location = '/js/util.js' */
define("confluence-inline-tasks/util",["jquery"],function(a){return{NODE_TYPE:{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},KEY:{BACKSPACE:8,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,INS:45,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,META:91},addContentEditableIfApplicable:function(d){var b=a(d);var c=require("tinymce");b.attr({contenteditable:false,"class":"non-editable",onselectstart:"return false;"});c.isIE&&b.attr({contenteditable:true,unselectable:"on",oncontrolselect:"return false;"})}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-inline-tasks/util","Confluence.InlineTasks.Util");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:datepicker1', location = '/js/date-picker1.js' */
define("confluence-inline-tasks/date-picker1",["jquery","ajs","confluence-editor/utils/tinymce-node-utils"],function(c,b){var d=0;function a(k,g){var j;var f;var h;var i;var e;j={};i=d++;h=c(k);h.attr("data-aui-dp-uuid",i);g=c.extend(undefined,a.prototype.defaultOptions,g);j.getField=function(){return h};j.getOptions=function(){return g};f=function(){var r;var o;var x;var s;var v;var u;var y;var t;var l;var n;j.hide=function(){l.hide()};j.show=function(){l.show()};j.setDate=function(A){if(typeof r!=="undefined"){r.datepicker("setDate",A)}};j.getDate=function(){if(typeof r!=="undefined"){return r.datepicker("getDate")}};u=function(B){n.off();if(g.hint){var C=c("<div/>").addClass("aui-datepicker-hint");C.append("<span/>").text(g.hint);n.append(C)}r=c("<div/>");r.attr("data-aui-dp-popup-uuid",i);n.append(r);var A={dateFormat:g.dateFormat,defaultDate:h.val(),maxDate:h.attr("max"),minDate:h.attr("min"),nextText:">",onSelect:function(D){h.val(D);h.change();j.hide();y=true;h.focus();g.onSelect&&g.onSelect.call(this,D)},onChangeMonthYear:function(){setTimeout(l.refresh,0)},prevText:"<"};c.extend(A,B);if(g.firstDay>-1){A.firstDay=g.firstDay}if(typeof h.attr("step")!=="undefined"){b.debug("WARNING: The date picker polyfill currently does not support the step attribute!")}r.datepicker(A);c("body").on("keydown",o);h.on("focusout keydown",x);h.on("propertychange keyup input paste",v)};o=function(C){var A=c(C.target);var D=A.closest(n).length||A.is(h);var B=A.closest(".ui-datepicker-header").length;if((!D&&!B)||C.keyCode===b.keyCode.ESCAPE){j.hide();return}if(A[0]!==h[0]){C.preventDefault()}};x=function(){if(!(t)){c("body").on("focus blur click mousedown","*",o);t=true}};s=function(){if(!(y)){j.show()}else{y=false}};v=function(){var A=c(this).val();if(A){r.datepicker("setDate",h.val());r.datepicker("option",{maxDate:h.attr("max"),minDate:h.attr("min")})}};j.destroyPolyfill=function(){j.hide();h.attr("placeholder",null);h.off("propertychange keyup input paste",v);h.off("focus click",s);h.off("focusout keydown",x);c("body").off("keydown",o);if(a.prototype.browserSupportsDateField){h[0].type="date"}if(typeof r!=="undefined"){r.datepicker("destroy")}delete j.destroyPolyfill;delete j.show;delete j.hide};y=false;t=false;if(!(g.languageCode in a.prototype.localisations)){g.languageCode=""}var q=a.prototype.localisations;var z="";var m=240;if(q.size==="large"){m=325;z="aui-datepicker-dialog-large"}var p={hideCallback:function(){c("body").off("focus blur click mousedown","*",o);t=false;if(e&&e._datePickerPopup){delete e._datePickerPopup}},hideDelay:null,noBind:true,persistent:true,closeOthers:false,width:m};if(g.position){p.calculatePositions=function(A,C){var B=c(A[0]);return g.position.call(this,B,C)}}l=b.InlineDialog(h,undefined,function(B,A,C){if(typeof r==="undefined"){n=B;u(q)}e=c(A).closest(".aui-inline-dialog").get(0);if(e){e._datePickerPopup=l}C()},p);l.addClass("aui-datepicker-dialog");l.addClass(z);h.on("focus click",s);h.attr("placeholder",g.dateFormat);if(g.overrideBrowserDefault&&a.prototype.browserSupportsDateField){h[0].type="text";var w=h[0].getAttribute("value");if(w){h[0].value=w}}};j.reset=function(){if(typeof j.destroyPolyfill==="function"){j.destroyPolyfill()}if((!(a.prototype.browserSupportsDateField))||g.overrideBrowserDefault){f()}};j.reset();return j}a.prototype.browserSupportsDateField=b.DatePicker.prototype.browserSupportsDateField;a.prototype.defaultOptions={overrideBrowserDefault:false,firstDay:-1,languageCode:c("html").attr("lang")||"en-AU",dateFormat:c.datepicker.W3C};a.prototype.localisations=b.DatePicker.prototype.localisations;c.fn.inlineTasksDatePicker1=function(e){return new a(this,e)}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:dateutil', location = '/js/dateutil.js' */
define("confluence-inline-tasks/dateutil",["jquery","ajs","moment","confluence/position","confluence-inline-tasks/util","aui/inline-dialog2","confluence-inline-tasks/date-picker1"],function(e,c,f,b,d){var a={PATTERN_INSERTING:"DD-MM-YYYY",PATTERN_LOZENGE:"DD MMM YYYY",PATTERN_INSIDE_TIME_ELE:"YYYY-MM-DD",convertDateIntoHtml:function(i,j,k,l){if(!l){l=a.PATTERN_INSERTING}if(!k){k=""}if(!j){j="<time>"}var g=e("<div>");var h="";var m=i.format(l);if(j.indexOf("time")>=0){h=e(j,{datetime:i.format(a.PATTERN_INSIDE_TIME_ELE)});d.addContentEditableIfApplicable(h);k&&h.attr("class",k);h.text(m)}else{h=e(j);k&&h.attr("class",k);h.text(m)}g.append(h);return g.html()},insertDateIntoCurrentCursor:function(j,h,p,o,s){var r=require("tinymce");var q=require("confluence-editor/utils/tinymce-node-utils");var m=r.activeEditor;var n=a.convertDateIntoHtml(j,h,p,o);var i=e(n,m.getDoc())[0];var k=q.replaceSelection(i);if(s){m.execCommand("mceInsertContent",false,s,{skip_undo:true})}var g=e(m.selection.getRng(true).startContainer).closest("li[data-inline-task-id]").length?"task":"page";var l={context:g,trigger:"character"};c.trigger("analyticsEvent",{name:"confluence-spaces.date.added",data:l});return k},parse:function(h,i){if(!i){i=a.PATTERN_INSIDE_TIME_ELE}var g=f(e.trim(h),i,true);return g.isValid()?g:null},format:function(g,h){if(!h){h=a.PATTERN_INSIDE_TIME_ELE}return g?g.format(h):null},guessPartialDate:function(g,l){if(g==null){return null}g=e.trim(g.replace(/[-\.\/]/g,"-"));var k=g.split("-");var j=f().format(l).split("-");for(var h=0;h<3;h++){if(!k[h]){k[h]=j[h]}if(/^\d$/.test(k[h])){k[h]="0"+k[h]}}return a.parse(k.join("-"),l)},datepicker:{POSITION_ABOVE:true,POSITION_BELOW:false,POSITION_RIGHT:true,POSITION_LEFT:false,dropDownStillFitsVertically:function(h,i,g){if(h===this.POSITION_ABOVE){return i.above>=g}return i.below>=g},dropDownStillFitsHorizontally:function(h,i,g){if(h===this.POSITION_RIGHT){return i.right>=g}return i.left>=g},getPreferredHorizontalPosition:function(h,g){if(h.right>=g){return this.POSITION_RIGHT}else{if(h.left>=g){return this.POSITION_LEFT}}return h.right>h.left?this.POSITION_RIGHT:this.POSITION_LEFT},getPreferredVerticalPosition:function(h,g){if(h.below>=g){return this.POSITION_BELOW}else{if(h.above>=g){return this.POSITION_ABOVE}}return h.below>h.above?this.POSITION_BELOW:this.POSITION_ABOVE},calculateDatepickerPosition:function(g){var h=this;return function(j,s){var p;var u;var w;var m;var n;var y=16;var A=0;var i;var l;var o;var q;var t=require("confluence-editor/editor/atlassian-editor");var z=require("confluence-editor/editor/atlassian-editor-content");var r=t.Rte.getEditorFrame();if(b.spaceLeftRight===undefined){b.spaceLeftRight=function(F,E){var D=E.position().left;return{left:D,right:e(F).width()-D}}}p=b.spaceAboveBelow(r,g);u=b.spaceLeftRight(r,g);n=z.offset(g);i=j.outerHeight(true);l=j.outerWidth(true);o=i+y;q=l+A;var C=h.POSITION_BELOW;var B=h.POSITION_RIGHT;if(C){if(!h.dropDownStillFitsVertically(C,p,o)){C=null}}if(!C){C=h.getPreferredVerticalPosition(p,o)}if(B){if(!h.dropDownStillFitsHorizontally(B,u,o)){B=null}}B=h.getPreferredHorizontalPosition(u,q);if(C===h.POSITION_ABOVE){w=n.top-i-y}else{w=n.top+g.height()+y}if(B===h.POSITION_RIGHT){m=n.left-A}else{m=(n.left+g.outerWidth())-l}var x={top:w,left:m};var k=(B===h.POSITION_RIGHT)?g.outerWidth()/2:l-g.outerWidth()/2;if((k<0)||(k>l)){k=(l/10)}var v={left:k,top:(C===h.POSITION_ABOVE)?i:-y/2};return{displayAbove:C,popupCss:x,arrowCss:v}}},getHintTextOfDatePicker:function(g){return g?"\u4e3a\u6b64\u4efb\u52a1\u9009\u62e9\u5230\u671f\u65f6\u95f4":"\u9009\u62e9\u4e00\u4e2a\u65e5\u671f\u3002"},create:function(o){var n=o.$attachTo;var h=o.$positionTo;var g=o.startDate;var m=o.onSelect;var i=o.isSetDueDate;var l=e("<input>").attr("type","date").addClass("aui-date-picker").css("display","none");var k=l.inlineTasksDatePicker1({overrideBrowserDefault:true,dateFormat:"yy-mm-dd",languageCode:c.Meta.get("user-locale")&&c.Meta.get("user-locale").split("_")[0],position:this.calculateDatepickerPosition(h),onSelect:function(p){m(a.parse(p));j()},hint:this.getHintTextOfDatePicker(i)});var j=function(){k&&k.destroyPolyfill&&k.destroyPolyfill();l&&l.remove();e(".aui-datepicker-dialog").remove();k=null;l=null};k.show();k.setDate(a.format(g));e(".aui-datepicker-dialog .aui-datepicker-hint").addClass(i?"set-duedate":"set-date");n.before(l);return{die:function(){j()},show:function(){k.show()},hide:function(){k.hide()},getContainer:function(){return l},setDate:function(q){var p=a.guessPartialDate(q,a.PATTERN_INSERTING);c.debug("Set date: "+q);p&&k.setDate(a.format(p))},placeDatePicker:function(){var q=c.InlineDialog.current;var p=q&&q.popup;p&&p.refresh()}}}}};return a});require("confluence/module-exporter").exportModuleAsGlobal("confluence-inline-tasks/dateutil","Confluence.InlineTasks.DateUtil",function(a){var b=require("ajs");var c=require("underscore");var d=require("confluence/meta");var e=require("moment");b.toInit(function(){var g=function(l,i,k){if(i&&i.toLowerCase()==="en_us"){return"MM"+k+"DD"+k+"YYYY"}var j=c.uniq(l.replace(/[^MDY]/g,"").split(""));return j.join(k).replace("D","DD").replace("M","MM").replace("Y","YYYY")};var h=d.get("user-locale");if(h){e.lang(h.split("_")[0].toLowerCase())}var f=d.get("user-date-pattern");if(f){a.PATTERN_LOZENGE=f.toUpperCase();a.PATTERN_INSERTING=g(f.toUpperCase(),h,"-");a.PATTERN_INSERTING_ALTERNATE=g(f.toUpperCase(),h,"/")}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/lib/lang/de.js' */
(function(a){if(typeof define==="function"&&define.amd){define(["moment"],a)}else{if(typeof exports==="object"){module.exports=a(require("../moment"))}else{a(window.moment)}}}(function(b){function a(e,d,c,g){var f={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[e+" Tage",e+" Tagen"],M:["ein Monat","einem Monat"],MM:[e+" Monate",e+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[e+" Jahre",e+" Jahren"]};return d?f[c][0]:f[c][1]}return b.lang("de",{months:"Januar_Februar_März_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Febr._Mrz._Apr._Mai_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),longDateFormat:{LT:"H:mm [Uhr]",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[Heute um] LT",sameElse:"L",nextDay:"[Morgen um] LT",nextWeek:"dddd [um] LT",lastDay:"[Gestern um] LT",lastWeek:"[letzten] dddd [um] LT"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",m:a,mm:"%d Minuten",h:a,hh:"%d Stunden",d:a,dd:a,M:a,MM:a,y:a,yy:a},ordinal:"%d.",week:{dow:1,doy:4}})}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/lib/lang/es.js' */
(function(a){if(typeof define==="function"&&define.amd){define(["moment"],a)}else{if(typeof exports==="object"){module.exports=a(require("../moment"))}else{a(window.moment)}}}(function(c){var b="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),a="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_");return c.lang("es",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(d,e){if(/-MMM-/.test(e)){return a[d.month()]}else{return b[d.month()]}},weekdays:"domingo_lunes_martes_miércoles_jueves_viernes_sábado".split("_"),weekdaysShort:"dom._lun._mar._mié._jue._vie._sáb.".split("_"),weekdaysMin:"Do_Lu_Ma_Mi_Ju_Vi_Sá".split("_"),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY LT",LLLL:"dddd, D [de] MMMM [de] YYYY LT"},calendar:{sameDay:function(){return"[hoy a la"+((this.hours()!==1)?"s":"")+"] LT"},nextDay:function(){return"[mañana a la"+((this.hours()!==1)?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+((this.hours()!==1)?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+((this.hours()!==1)?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+((this.hours()!==1)?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un año",yy:"%d años"},ordinal:"%dº",week:{dow:1,doy:4}})}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/lib/lang/fr.js' */
(function(a){if(typeof define==="function"&&define.amd){define(["moment"],a)}else{if(typeof exports==="object"){module.exports=a(require("../moment"))}else{a(window.moment)}}}(function(a){return a.lang("fr",{months:"janvier_février_mars_avril_mai_juin_juillet_août_septembre_octobre_novembre_décembre".split("_"),monthsShort:"janv._févr._mars_avr._mai_juin_juil._août_sept._oct._nov._déc.".split("_"),weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[Aujourd'hui à] LT",nextDay:"[Demain à] LT",nextWeek:"dddd [à] LT",lastDay:"[Hier à] LT",lastWeek:"dddd [dernier à] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},ordinal:function(b){return b+(b===1?"er":"")},week:{dow:1,doy:4}})}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/lib/lang/ja.js' */
(function(a){if(typeof define==="function"&&define.amd){define(["moment"],a)}else{if(typeof exports==="object"){module.exports=a(require("../moment"))}else{a(window.moment)}}}(function(a){return a.lang("ja",{months:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"日曜日_月曜日_火曜日_水曜日_木曜日_金曜日_土曜日".split("_"),weekdaysShort:"日_月_火_水_木_金_土".split("_"),weekdaysMin:"日_月_火_水_木_金_土".split("_"),longDateFormat:{LT:"Ah時m分",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日LT",LLLL:"YYYY年M月D日LT dddd"},meridiem:function(b,d,c){if(b<12){return"午前"}else{return"午後"}},calendar:{sameDay:"[今日] LT",nextDay:"[明日] LT",nextWeek:"[来週]dddd LT",lastDay:"[昨日] LT",lastWeek:"[前週]dddd LT",sameElse:"L"},relativeTime:{future:"%s後",past:"%s前",s:"数秒",m:"1分",mm:"%d分",h:"1時間",hh:"%d時間",d:"1日",dd:"%d日",M:"1ヶ月",MM:"%dヶ月",y:"1年",yy:"%d年"}})}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/lib/lang/en-gb.js' */
(function(a){if(typeof define==="function"&&define.amd){define(["moment"],a)}else{if(typeof exports==="object"){module.exports=a(require("../moment"))}else{a(window.moment)}}}(function(a){return a.lang("en-gb",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(e){var c=e%10,d=(~~(e%100/10)===1)?"th":(c===1)?"st":(c===2)?"nd":(c===3)?"rd":"th";return e+d},week:{dow:1,doy:4}})}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:editor-autocomplete-date-js', location = '/js/editor-plugin/date-autocomplete-help-dialog.js' */
AJS.toInit(function(){if(!(Confluence.KeyboardShortcuts&&Confluence.KeyboardShortcuts.Autoformat)){return}Confluence.KeyboardShortcuts.Autoformat.push({action:"//",context:"autoformat.autocomplete",description:"\u65e5\u671f"})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:editor-autocomplete-date-js', location = '/js/editor-plugin/autocomplete-manager.js' */
(function(d){var f=window.Confluence||{};var e="confluence.date-autocomplete-manager.plugin";f.Editor=f.Editor||{};f.Editor.AutoComplete=f.Editor.AutoComplete||{};var b=f.InlineTasks.Util.KEY,a=f.InlineTasks.DateUtil,c=f.Editor.AutoComplete;c.SETTING_DEFAULT={leadingChar:"",isDataValid:function(g){return false},backWords:0,onBeforeDie:function(){},onAfterStart:function(){},onScroll:function(){}};c.Manager=function(g){this.ed=AJS.Rte.getEditor();this.settings=d.extend({},c.SETTING_DEFAULT,g);this.log=AJS.debug;this.control=null};c.Manager.prototype={start:function(g){AJS.trigger("synchrony.stop",{id:e});this.log("startAutoComplete - Started");var h=d.extend({},this.settings,g);this.control=f.Editor.Autocompleter.Control(this.ed,h);if(!this.control){return false}this.attachEventsToControl();h.onAfterStart&&h.onAfterStart({date:g.date,isTriggerFromOrphan:g.isTriggerFromOrphan?true:false});return true},attachEventsToControl:function(){var k=this,n=k.control,i=k.log,h=k.settings;if(typeof this.settings.onBeforeDie==="function"){var m=this.control.die;var j=false;this.control.die=function(){if(j){return}j=true;k.settings.onBeforeDie.apply(k.control,arguments);if(k.dateInserted()){m.apply(k.control,[true]);AJS.trigger("analyticsEvent",{name:"confluence-spaces.tasks.daterecognition.killed"})}else{m.apply(k.control,arguments)}}}var g=_.bind(_.throttle(k.settings.onScroll,40),this);var l={onBeforeKey:function(o,p){if(o.keyCode!==b.ESCAPE&&o.keyCode!==b.ENTER){k.control&&k.control.getContainer().addClass("isDirty")}if(o.keyCode===b.DOWN||o.keyCode===b.UP||o.keyCode===b.ENTER){tinymce.dom.Event.cancel(o);return false}if(o.keyCode===b.ESCAPE||o.keyCode===b.TAB||o.keyCode===b.BACKSPACE&&!p){i("autoCompleteControl.onBeforeKey - killing autoCompleteControl");this.die(o.keyCode===b.BACKSPACE);return false}return true},onKeyPress:function(q,r){var o=AJS.$.browser.msie?q.keyCode:q.which;if(q.keyCode===b.ENTER){tinymce.dom.Event.cancel(q);return false}var p=String.fromCharCode(o);if(this.settings.endChars.includes(p)){i("autoCompleteControl.onKeyPress - caught autocomplete-closing char - character");n.die()}return true},onAfterKey:function(q,r){var p=d("#autocomplete-trigger",k.control.getContainer()),o=p.text();if(p.length>0&&o!==k.settings.leadingChar){i("after","dying because of: trigger text is modified");k.reset();return false}if(q.keyCode===b.ENTER){if(h.isDataValid(r)){n.update(r)}else{i("autoCompleteControl.onAfterKey - closing autocomplete due to invalid data - "+r);n.die(false)}return false}if(k.dateInserted()&&(r.length>10)&&(!a.parse(r,[a.PATTERN_INSERTING,a.PATTERN_INSERTING_ALTERNATE]))){k.reset();return false}if(q.keyCode===b.SPACE){k.reset();return false}return true},onDeath:function(){k.reset()},onScroll:function(){if(!k.isAlive()){return}g()}};d.extend(n,l)},isAlive:function(){return this.control&&!this.control.dying},reset:function(){if(!this.control){return}this.control.die();this.control=null;AJS.trigger("synchrony.start",{id:e})},dateInserted:function(g){if(g===true){return this.control.getContainer().addClass("hasDateInserted")}else{if(g===false){return this.control.getContainer().removeClass("hasDateInserted")}else{return this.control.getContainer().hasClass("hasDateInserted")}}},dirty:function(g){if(g===true){return this.control.getContainer().addClass("isDirty")}else{return this.control.getContainer().hasClass("isDirty")}},reattach:function(){var g=f.Editor.Autocompleter.Control.removeOrphanedControl();if(g&&g.leadingChar===this.settings.leadingChar){this.reset();return this.start({backWords:1,isTriggerFromOrphan:true})}return false}}})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:editor-autocomplete-date-js', location = '/js/editor-plugin/date-autocomplete.js' */
(function(h,e){var r="dateautocomplete",m="tinymce.plugins.DateAutocomplete",p="mceConfInsertDateAutocomplete",t="confMenuInsertDate",k="//";var q="confluence.date-autocomplete.plugin";var s=Confluence.InlineTasks.Util,n=s.NODE_TYPE,d=s.KEY,b=Confluence.InlineTasks.DateUtil,g=null,o=null,c=false,i=e.dom.TreeWalker;var j={initDateAutoCompleteObject:function(u){if(!Confluence.Editor.Autocompleter){Confluence.Editor.Autocompleter=e.confluence.Autocompleter}Confluence.Editor.Autocompleter.Settings[k]={ch:k,endChars:[],update:function(y,x){o.picker.die();var w=(x==b.PATTERN_INSERTING.toLowerCase())?moment():b.guessPartialDate(x,b.PATTERN_INSERTING);w&&b.insertDateIntoCurrentCursor(w,"<time>","",b.PATTERN_LOZENGE,"&nbsp;");if(o.dateInserted()){AJS.trigger("analyticsEvent",{name:"confluence-spaces.tasks.daterecognition.used"})}o.reset();u.undoManager.add();AJS.trigger("synchrony.start",{id:q})}};var v={leadingChar:k,isDataValid:function(w){return !o.dirty()||b.guessPartialDate(w,b.PATTERN_INSERTING)!=null},onBeforeDie:function(){o.picker&&o.picker.die();if(o.control){var w=h(o.control.getContainer());if(!o.dirty()){w.find("#autocomplete-search-text").remove()}}},onAfterStart:function(x){if(x&&x.date){j.fillPlaceholderDateAutoComplete(u,x.date,true);o.dirty(true);o.dateInserted(true)}else{if(x&&!x.isTriggerFromOrphan){j.fillPlaceholderDateAutoComplete(u,b.PATTERN_INSERTING.toLowerCase(),false);o.dateInserted(false)}}var w=o.control.text();var y=b.guessPartialDate(w,b.PATTERN_INSERTING)||moment();j.bindDatePickerToAutoComplete(y)},onScroll:function(){o.picker&&o.picker.placeDatePicker()}};o=new Confluence.Editor.AutoComplete.Manager(v)},activateDateAutocomplete:function(w,x,v){var y=Object.assign({},v,x);if(!y.hasOwnProperty("insertedFromMenu")){y.insertedFromMenu=false}if(!o.isAlive()){var u=o.start(y);if(!u&&!y.insertedFromMenu){g.execCommand("mceInsertContent",false,k,{skip_undo:true});return false}}},bindDatePickerToAutoComplete:function(x){var u=o.control&&o.control.getContainer();if(!u.length){return}u.addClass("date-autocomplete");u.find("#autocomplete-search-text span").addClass("inserting");var w=function(y){o.control.update(y.format(b.PATTERN_INSERTING))},v=j.isInsideTaskAndFirstTimeNode(u);o.picker=b.datepicker.create({$attachTo:u,$positionTo:u,startDate:x,onSelect:w,isSetDueDate:v})},fillPlaceholderDateAutoComplete:function(v,y,x){var u=o.control.getContainer().find("#autocomplete-search-text span");u.text(AJS.Rte.HIDDEN_CHAR+y);var w=v.dom.createRng();w.setStart(u[0].firstChild,1);w.setEnd(u[0].firstChild,y.length+1);x&&w.collapse(false);v.selection.setRng(w)},autocompleteDoubleSlash:function(z,y){var w=y.handlerManager,v=y.ed,x=y.createHandler;var u=x(/(?:\s|\xA0|^|\ufeff|\u200b)(\/)$/,function(){v.execCommand(p,false,{},{skip_undo:true})},true,"#autocomplete");w.registerHandler("/".charCodeAt(0),u)},registerTriggerDoubleSlash:function(u){u.addCommand(p,j.activateDateAutocomplete);u.addCommand(t,function(){AJS.trigger("analytics",{name:"editor.insert-data-from-menu"});g.execCommand("mceConfInsertDateAutocomplete",false,{insertedFromMenu:true},{skip_undo:true})}.bind(this));AJS.bind("confluence.editor.registerHandlers",this.autocompleteDoubleSlash)},isTimeNode:function(u){return u&&u.nodeType===n.ELEMENT_NODE&&u.tagName.toLowerCase()==="time"},getTimeNodeAtCursor:function(u){if(!u){u=g}var v=u.selection.getNode();if(j.isTimeNode(v)){return v}v=u.selection.getStart();if(j.isTimeNode(v)){return v}v=u.selection.getEnd();if(j.isTimeNode(v)){return v}},makeTimeNodesUnEditable:function(u){u.each(function(){var v=h(this);if(h.trim(v.text())===""){v.remove()}e.isWebKit&&v.remove("br.Apple-interchange-newline");s.addContentEditableIfApplicable(this)})},wrapTimeNodesWithHiddenChar:function(u){u.each(function(){var v=h(this);if(!this.previousSibling||this.previousSibling.nodeType!==n.TEXT_NODE||this.previousSibling.nodeValue===""){v.before(AJS.Rte.HIDDEN_CHAR)}if(!this.nextSibling||this.nextSibling.nodeType!==n.TEXT_NODE||this.previousSibling.nodeValue===""){v.after(AJS.Rte.HIDDEN_CHAR)}})},putCursorAtEdge:function(v,x,u){u=!!u;if(u){if(!x.nextSibling||x.nextSibling.nodeType!==n.TEXT_NODE){h(x).after(v.dom.doc.createTextNode(""))}}else{if(!x.previousSibling||x.previousSibling.nodeType!==n.TEXT_NODE){h(x).before(v.dom.doc.createTextNode(""))}}var w=v.selection.dom.createRng();w.selectNode(u?x.nextSibling:x.previousSibling);w.collapse(u);v.selection.setRng(w)},findFirstTimeNodeInClosestBlock:function(v,A,x){var z=new i(A,v.getBody());var y=A,w=0;do{if(w==1&&j.isTimeNode(A)){return A}var u=x?A.previousSibling:A.nextSibling;if(A!==y&&u&&(v.dom.isBlock(A)||v.dom.isBlock(u))){w++}}while((A=x?z.next():z.prev())&&w<2)},findFirstTimeNodeNearby:function(u,y,v){var x=y;var w=new i(y,u.getBody());do{if(j.isTimeNode(y)){return y}if(u.dom.isBlock(y)||(y!==x&&y.nodeType===n.TEXT_NODE&&y.nodeValue!=="")){return}}while(y=v?w.next():w.prev())},convertInvalidTimeNodeToPlainText:function(u){u.each(function(){var x=h(this);var v=x.attr("datetime");var w=b.parse(v);if(!w){x.before(x.text());x.remove()}})},isInsideTaskAndFirstTimeNode:function(v){var u=h(v),w=u.closest("ul.inline-task-list > li[data-inline-task-id]");if(!w.length){return false}return w.find("time, span.date-autocomplete")[0]===u[0]}};var a={handleRemoveDateLozenge:function(v,B){var A=B.keyCode;if(A!==d.BACKSPACE&&A!==d.DELETE){return}var y=(A===d.DELETE),u=v.selection.getRng(true),w=u.startContainer,x=w;if(w.nodeType==n.TEXT_NODE&&(y?u.startOffset!=w.nodeValue.length:u.startOffset!=0)){return}if(w.nodeType===n.ELEMENT_NODE){if(y){x=(w.childNodes.length===u.startOffset)?w:w.childNodes.item(u.startOffset)}else{x=(u.startOffset===0)?w:w.childNodes.item(u.startOffset-1)}}var z=j.findFirstTimeNodeNearby(v,x,y);z&&v.dom.remove(z)},handleClickingDateLozenge:function(z,C){var w=h(C.target);if(!w.is("time")){return}AJS.trigger("synchrony.stop",{id:q});var u=(w.closest("li[data-inline-task-id]").length)?"task":"page";var x={mode:"editor",context:u};AJS.trigger("analyticsEvent",{name:"confluence-spaces.date.clicked",data:x});var F=w.closest("body");var B=function(){AJS.Rte.unbindScroll("date-lozenge-date-picker");A.die();AJS.trigger("synchrony.start",{id:q})};F.one("keydown click",B);var E=function(H){var I=H.format(b.PATTERN_INSIDE_TIME_ELE);var G=H.format(b.PATTERN_LOZENGE);if(I!==w.attr("datetime")){var J={context:u};AJS.trigger("analyticsEvent",{name:"confluence-spaces.date.changed",data:J})}w.attr("datetime",I);w.text(G);F.unbind("keydown click",B);AJS.trigger("synchrony.start",{id:q})};var v=b.parse(w.attr("datetime")),y=j.isInsideTaskAndFirstTimeNode(w),A=b.datepicker.create({$attachTo:w,$positionTo:w,startDate:v,onSelect:E,isSetDueDate:y});var D=_.bind(_.throttle(function(){if(A&&AJS.Rte.isAnyPartShown(w)){A.placeDatePicker()}else{B()}},40),this);AJS.Rte.bindScroll("date-lozenge-date-picker",D)},handleTypingDate:function(v,x){var w=x.keyCode;if(w===d.UP||w===d.DOWN||w===d.LEFT||w===d.RIGHT||w===d.HOME||w===d.END||w===d.PAGEDOWN||w===d.PAGEUP||x.metaKey||x.ctrlKey||x.altKey){return}if(o.control&&o.picker){var u=o.control.text();o.picker.setDate(u)}},handleOnLoadContent:function(u){var w=h(u.dom.doc),v=w.find("time");j.makeTimeNodesUnEditable(v);j.wrapTimeNodesWithHiddenChar(v)},handlePostPaste:function(v,u,w){j.convertInvalidTimeNodeToPlainText(h(w.node).find("time"))},handlePostPasteContent:function(w,u,x){var v=h(x.node).find("time");j.makeTimeNodesUnEditable(v)},handlePrePasteContent:function(v,u,w){if(j.getTimeNodeAtCursor(g)){w.content="";return false}},fixWhenUpDownNavOnList:function(v,B){var x=B.keyCode;if(x!==d.UP&&x!==d.DOWN){return}var u=v.selection.getRng(true),w=u.startContainer,y=w,z=x===d.DOWN;if(w.nodeType===n.ELEMENT_NODE){if(z){y=(w.childNodes.length===u.startOffset)?w:w.childNodes.item(u.startOffset)}else{y=(u.startOffset===0)?w:w.childNodes.item(u.startOffset-1)}}var A=j.findFirstTimeNodeInClosestBlock(v,y,z);if(A){j.wrapTimeNodesWithHiddenChar(h(A))}},preventCursorInsideDateLozenge:function(v,u,x){var w=(x.nodeType===n.TEXT_NODE)?x.parentNode:x;if(j.isTimeNode(w)){if(c||v.selection.getRng().startOffset>1){j.putCursorAtEdge(v,w,true)}else{j.putCursorAtEdge(v,w,false)}}},handleUndoRedo:function(){o&&o.reattach()}};var f={init:function(u){j.initDateAutoCompleteObject(u);j.registerTriggerDoubleSlash(u);g=u;u.onContextMenu.add(function(){o.reset()});u.onSetContent.add(a.handleOnLoadContent);u.onClick.add(a.handleClickingDateLozenge);u.onKeyUp.add(a.handleTypingDate);if(e.isWebKit){u.onKeyDown.add(a.fixWhenUpDownNavOnList);u.onInit.add(function(){h(document).bind("postPaste",a.handlePostPasteContent)});u.onRemove.add(function(){h(document).unbind("postPaste",a.handlePostPasteContent)})}u.onKeyUp.add(function(A,C){c=(C.keyCode===d.RIGHT);var z=A.selection.getRng(true);var y=z.commonAncestorContainer;var B=!!y&&y.data;if(!!B&&!AJS.$(y).closest("pre,.text-placeholder").length){var D=String.prototype.slice.apply(B,[-11]);if((C.keyCode>=48&&C.keyCode<=57)||(C.keyCode>=96&&C.keyCode<=105)){var v=/(^| )\d{2}[\/\-]\d{2}[\/\-]\d{4}$/;var x=String.prototype.slice.apply(B,[-10]);if(v.test(B)&&b.parse(x,[b.PATTERN_INSERTING,b.PATTERN_INSERTING_ALTERNATE])){var w=z.commonAncestorContainer;z.setStart(w,z.endOffset-x.length);A.undoManager.add();A.undoManager.beforeChange();A.selection.setRng(z);A.execCommand("mceConfInsertDateAutocomplete",false,{date:x},{skip_undo:true});AJS.trigger("analyticsEvent",{name:"confluence-spaces.tasks.daterecognition.triggered"})}}}});if(e.isGecko){u.onKeyDown.add(a.handleRemoveDateLozenge);u.onInit.add(function(){h(document).bind("prePaste",a.handlePrePasteContent)});u.onRemove.add(function(){h(document).unbind("prePaste",a.handlePrePasteContent)})}if(e.isWebKit||e.isGecko){u.onNodeChange.add(a.preventCursorInsideDateLozenge)}u.onUndo.add(a.handleUndoRedo);u.onRedo.add(a.handleUndoRedo);u.onInit.add(function(){h(document).bind("postPaste",a.handlePostPaste)});u.onRemove.add(function(){h(document).unbind("postPaste",a.handlePostPaste);AJS.unbind("confluence.editor.registerHandlers",j.autocompleteDoubleSlash)});AJS.bind("editor.remote.change",function(){j.makeTimeNodesUnEditable(h(u.dom.doc).find("time"))})},getInfo:function(){return{longname:"Insert Date Autocomplete",author:"Atlassian",authorurl:"http://www.atlassian.com",version:e.majorVersion+"."+e.minorVersion}}};function l(){e.create(m,f);e.PluginManager.add(r,e.plugins.DateAutocomplete);AJS.Rte.BootstrapManager.addTinyMcePluginInit(function(u){u.plugins+=","+r})}l()})(AJS.$,tinymce);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:drag-and-drop-overlay', location = 'js/drag-and-drop-overlay.js' */
define("confluence-drag-and-drop/drag-and-drop-overlay",["ajs","jquery"],function(g,e){var h;return{bindFileDragOverlay:function(a){var f=a.$dragZone,d=a.$overlayZone||f.eq(0),i=a.isTransparent||!1,j=a.zIndex||1;f.on("dragover",function(c){c=c.originalEvent.dataTransfer.types;if(-1!==e.inArray("Files",c)&&(!e.browser.mozilla||-1!==e.inArray("application/x-moz-file",c))){var c=!!i,b;if(!h){var a=g.DragAndDrop.Templates.dragOverlay();h=e(a)}b=h;if(b.parent()[0]!==d[0]){a=0<d.closest(".quick-comment-container, .ic-container, .cp-editor").length;
b.toggleClass("dnd-small",a);var f=b.find(".overlay-center p");a?f.text("\u5728\u8fd9\u91cc\u653e\u4e00\u4e2a\u6587\u4ef6"):f.text("\u62d6\u62fd\u6587\u4ef6\u5230\u6b64\u9875\u9762\u4ee5\u63d2\u5165\u4ed6\u4eec");b.toggleClass("dnd-overlay-transparent",c);c=getComputedStyle(d[0]);b.css({"z-index":j});b.css({"margin-left":"-"+c.paddingLeft,"margin-top":"-"+c.paddingTop,width:d.innerWidth()+"px",height:d.innerHeight()+"px"}).prependTo(d);b.off("dragleave").on("dragleave",function(a){(!a.relatedTarget||!e.contains(b[0],a.relatedTarget))&&
b.remove()});b.off("drop").on("drop",function(){b.remove()})}}})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:image-dialog-client', location = 'js/insert-dialog-upload-controller.js' */
define("confluence-drag-and-drop/insert-dialog-upload-controller",["confluence/meta","ajs","jquery"],function(d,e,c){var b=function(a){this.messageHandler=null;this.context=a;a=this.getForm();d.getBoolean("can-attach-files")||a.remove()};b.prototype.getForm=function(){return c("form",this.context.baseElement)};b.prototype.pack=function(){};b.prototype.displayErrors=function(a){this.getMessageHandler().displayMessages(a);a=this.getMessageHandler().getMessageContainer().find("ul");a.toggleClass("one-message",
1===a.find("li").length);this.pack()};b.prototype.clearErrors=function(){this.getMessageHandler().clearMessages();this.pack()};b.prototype.getMessageHandler=function(){this.messageHandler||(this.messageHandler=e.MessageHandler({baseElement:c(".aui-message",this.context.baseElement)}));return this.messageHandler};return b});require("confluence/module-exporter").exportModuleAsGlobal("confluence-drag-and-drop/insert-dialog-upload-controller","Confluence.DragAndDrop.UploadClientController");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:image-dialog-client', location = 'js/image-dialog-client.js' */
define("confluence-drag-and-drop/image-dialog-client","jquery confluence/legacy ajs confluence/meta underscore confluence/message-controller".split(" "),function(k,g,f,h,m,l){var j=function(){this._workIdToBytesUploaded={};this._totalBytes=0};j.prototype={update:function(a,b,e){if(!(a in this._workIdToBytesUploaded))this._totalBytes=this._totalBytes+e;this._workIdToBytesUploaded[a]=b},percentComplete:function(){var a=0;k.each(this._workIdToBytesUploaded,function(b,e){a=a+e});return Math.round(a*100/
this._totalBytes)}};var i=function(a){this.urlHandleUpload="/plugins/drag-and-drop/upload.action";this.pageId=parseInt(h.get("page-id"),10);this.draftId=parseInt(h.get("draft-id"),10);this.dragAndDropEntityId=h.get("drag-and-drop-entity-id");this.spaceKey=h.get("space-key")||"";this.atlToken=h.get("atl-token");this.base=/^\w+:\/\/[^/?#]+/.exec(location.href);this.metaMaxFileSize=h.get("global-settings-attachment-max-size");this.errors=[];this.batchProgress=new j;this.attachmentPanelComponent=a.attachmentPanelComponent;
this.dropZone=a.dropZone;this.browserButtonId=a.browserButtonId;this.uploader=null;this.isUploadUsingDragAndDrop=false;var b=this;k(this.dropZone).bind("drop",function(){b.isUploadUsingDragAndDrop=true})};i.prototype.createPlupload=function(){var a=this,b=new plupload.Uploader({runtimes:"html5",dragdrop:true,drop_element:a.dropZone,browse_button:a.browserButtonId,multipart:false,stop_propagation:true,max_file_size:parseInt(a.metaMaxFileSize,10),inputFileClazz:"file-library-input-file"});b.init();
b.bind("Started",function(e,c){a.errors=[];a.attachmentPanelComponent.clearErrors();a.batchProgress=new j;require(["confluence-drag-and-drop/analytics/files-upload-analytics"],function(d){d.triggerEvent(a.isUploadUsingDragAndDrop?"confluence.insert-files-dialog.drag-and-drop":"confluence.insert-files-dialog.upload",c);a.isUploadUsingDragAndDrop=false})});b.bind("FilesAdded",function(e,c){function d(c,d){for(var e=0;e<d.length;e++)if(d[e].status===plupload.FAILED)c.removeFile(d[e]);else{var b=m.find(c.files,
function(a){return a.name===d[e].name&&a.id!==d[e].id});b&&c.removeFile(b);a.metaMaxFileSize>d[e].size&&a.attachmentPanelComponent.addPreviewImage(d[e])}c.start()}if(c.length>0){a.attachmentPanelComponent.getNoFileContainer().hide();f.UploadUtils.filterFiles(e,c,d)}});b.bind("BeforeUpload",function(e,c){var d=a.base+f.contextPath()+a.urlHandleUpload,b={},g=c.name.substr(c.name.lastIndexOf(".")+1);a.pageId?b.pageId=a.pageId:b.draftId=a.draftId;if(a.dragAndDropEntityId)b.dragAndDropEntityId=a.dragAndDropEntityId;
b.filename=c.name;b.size=c.size;b.minorEdit=true;b.spaceKey=a.spaceKey;b.mimeType=plupload.mimeTypes[g.toLowerCase()]||f.DragAndDropUtils.defaultMimeType;b.atl_token=a.atlToken;e.settings.url=plupload.buildUrl(d,b);a.batchProgress=new j});b.bind("UploadProgress",function(b,c){a.batchProgress.update(c.id,c.loaded,c.size);a.attachmentPanelComponent.setUploadInProgress(a.batchProgress.percentComplete()/100,c.id)});b.bind("FileUploaded",function(b,c,d){if(b.getFile(c.id)){b=JSON.parse(d.response).data.id;
a.attachmentPanelComponent.attachmentUploaded(c.id,b)}else a.attachmentPanelComponent.attachmentUploadingCancelled(c.id)});b.bind("Error",function(b,c){var d="";if(c.response){try{d=JSON.parse(c.response).actionErrors[0]}catch(g){d=l.parseError(c.xhr,c.message)}f.trigger("analyticsEvent",{name:"confluence.image-dialog.upload.error.server-unknown"})}else if(c.message){var d=c.message,h=c.file.name;if(c.code===plupload.FILE_SIZE_ERROR){d=f.DragAndDropUtils.niceSize(a.metaMaxFileSize).toString();d=f.format("{0} \u592a\u5927\u4e86\u4e0d\u80fd\u4e0a\u4f20\u3002\u6587\u4ef6\u5fc5\u987b\u5c0f\u4e8e {1}.",
h,d);f.trigger("analyticsEvent",{name:"confluence.image-dialog.upload.error.file-size"})}else if(c.code===f.UploadUtils.ErrorCode.FILE_IS_A_FOLDER_ERROR){d=f.format("\u65e0\u6cd5\u4e0a\u4f20 {0} \u2014\u2014\u5b83\u53ef\u80fd\u662f\u4e00\u4e2a\u6587\u4ef6\u5939\u6216\u8005\u4e00\u4e2a\u4e0d\u652f\u6301\u7684\u6587\u4ef6\u7c7b\u578b\u3002",h);f.trigger("analyticsEvent",{name:"confluence.image-dialog.upload.error.file-type"})}}else{d=l.parseError(c.xhr);f.trigger("analyticsEvent",{name:"confluence.image-dialog.upload.error.server-unknown"})}a.attachmentPanelComponent.displayErrors([d]);a.errors.push(d)});require(["confluence-drag-and-drop/drag-and-drop-overlay"],
function(b){b.bindFileDragOverlay({$dragZone:k(a.dropZone),zIndex:3005})});return b};i.prototype.init=function(){this.uploader=this.createPlupload()};i.prototype.cancelUpload=function(a){(a=this.uploader.getFile(a))&&this.uploader.removeFile(a)};if(g.Editor&&g.Editor.FileDialog)g.Editor.FileDialog.eventListener.on("AttachmentsPanelView.render",function(a){a.getUploaderController=function(){return new g.DragAndDrop.UploadClientController(a.context)}});f.toInit(function(){if(g.Editor&&g.Editor.ImageDialog){var a=
g.Editor.ImageDialog.beforeShowListeners,b=g.Editor.ImageDialog.findPanelComponentById("attachments");a&&a.push(function(){if(b){var a=b.getPanelElement();if(a.length&&h.getBoolean("can-attach-files")){var c=new i({dropZone:a[0],browserButtonId:"upload-files-button",attachmentPanelComponent:b});c.init();g.Editor.FileDialog.eventListener.on("uploadingfile.cancelled",function(a){c.cancelUpload(a)})}}else f.debug("Do not support Attachment Panel and Drag-Drop in Insert Image Dialog (ex: in creating Template)")})}});
return i});require("confluence/module-exporter").exportModuleAsGlobal("confluence-drag-and-drop/image-dialog-client","Confluence.DragAndDrop.UploadClient");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:drag-and-drop-tip', location = 'js/drag-and-drop-tip.js' */
define("confluence-drag-and-drop/drag-and-drop-tip",["ajs","confluence/legacy"],function(b,g){return function(d){function h(c,a){"true"===a&&(c.append(b.DragAndDrop.Templates.dragAndDropTip()),c.find(".attach-tip-discovery .close-tip").on("click",function(a){a.preventDefault();d(this).closest(".attach-tip-discovery").remove();c.sizeToFit();d.ajax({url:b.contextPath()+"/rest/drag-and-drop/1/tip/disable",type:"POST",contentType:"application/json",dataType:"json",success:function(){e.setItem(f,!1)}})}))}
var f="show-drag-and-drop-tip",e=g.storageManager("confluence-editor");g.Editor.ImageDialog.beforeShowListeners.push(function(){var c=d("#attached-files");if(b.Meta.getBoolean("can-attach-files")){var a=e.getItem(f);null===a?d.ajax({url:b.contextPath()+"/rest/drag-and-drop/1/tip/setting",contentType:"application/json",dataType:"json",success:function(b){a=(!1!==b).toString();e.setItem(f,a);h(c,a)}}):h(c,a)}})}});
require("confluence/module-exporter").safeRequire("confluence-drag-and-drop/drag-and-drop-tip",function(b){require("ajs").toInit(b)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:drag-and-drop-for-editor-common', location = 'js/editor.js' */
require("ajs jquery confluence-drag-and-drop/analytics/files-upload-analytics confluence-drag-and-drop/drag-and-drop-overlay document confluence/message-controller".split(" "),function(a,s,p,q,m,n){a.toInit(function(i){var e,r=/^\w+:\/\/[^/?#]+/.exec(location.href),o=false;a.Rte.BootstrapManager.addOnInitCallback(function(){var j=a.Rte.getEditor().getBody().parentNode,k=m.getElementById("fileuploadShim"),l=false;if(!k){k=m.createElement("div");k.setAttribute("id","fileuploadShim");m.body.appendChild(k)}i.browser.mozilla&&
i.browser.version.indexOf("1.9.2")>-1&&j.addEventListener("drop",function(a){a.stopPropagation()},false);var c=new plupload.Uploader({runtimes:"html5",dragdrop:true,drop_element:j,browse_button:k.getAttribute("id"),multipart:false,max_file_size:+a.Meta.get("global-settings-attachment-max-size")});e||(e=new a.DragAndDropProgressDialog);c.init();c.bind("Started",function(a,b){p.triggerEvent("confluence.editor.files.drag-and-drop",b)});c.bind("FilesAdded",function(h,b){a.UploadUtils.filterFiles(h,b,
function(a,b){for(var d=0;d<b.length;d++){var h=b[d];h.status!==plupload.FAILED&&e.render({workId:h.id,status:h.status,file:h})}c.start()})});c.bind("BeforeUpload",function(h,b){if(a.Meta.get("content-type")==="template"){h.stop();if(!o){var g=new a.Dialog(450,180);g.addHeader("\u672a\u63d0\u4f9b\u652f\u6301");g.addSubmit("\u786e\u5b9a",function(){g.remove()});g.addPanel("Panel 1","panel1");g.getCurrentPanel().html("\u003cp\u003e\u6a21\u677f\u4e0d\u652f\u6301\u9644\u4ef6\uff0c\u003c/p\u003e \u003cp\u003e\u6587\u4ef6\u53ef\u4ee5\u9644\u52a0\u5230\u9875\u9762\uff0c\u5e76\u901a\u8fc7\u0027\u63d2\u5165\u0027\u83dc\u5355\u6dfb\u52a0\u4e3a\u56fe\u7247\u3002\u003c/p\u003e");
g.show();o=true}}else{var f=r+a.contextPath()+"/plugins/drag-and-drop/upload.action",d={},c=a.Meta.get("page-id");if(c)d.pageId=c;var i=a.Meta.get("draft-id");if(c==0&&i>0)d.draftId=i;if(c=a.Meta.get("drag-and-drop-entity-id"))d.dragAndDropEntityId=c;c=b.name.substr(b.name.lastIndexOf(".")+1);d.filename=b.name;d.size=b.size;d.minorEdit=true;d.spaceKey=a.Meta.get("space-key")||"";d.mimeType=plupload.mimeTypes[c.toLowerCase()]||a.DragAndDropUtils.defaultMimeType;d.atl_token=a.Meta.get("atl-token");
d.contentType=a.Meta.get("content-type");d.isVFMSupported=!!a.MacroBrowser.getMacroMetadata("view-file");h.settings.url=plupload.buildUrl(f,d);e.cancelListeners.push(function(b,c){var d=h.getFile(c.workId);d&&h.removeFile(d);e.renderInfo(c.workId,"\u6587\u4ef6\u88ab\u624b\u52a8\u4ece\u961f\u5217\u79fb\u9664\u3002")});e.show()}});c.bind("UploadProgress",function(a,b){e.renderUpdateToBytesUploaded(b.id,b.loaded,b.size);e.hideCloseButton()});i.browser.mozilla&&plupload.addEvent(j,"dragenter",function(a){l=a.rangeParent&&
a.rangeOffset!==void 0?{startElement:a.rangeParent,startOffset:a.rangeOffset}:false});c.bind("FileUploaded",function(c,b,g){if(g.status){if(g.response)try{var f=i.parseJSON(g.response);l&&i(l.startElement.parentNode).closest('[contenteditable="true"]',j).length&&tinymce.activeEditor.selection.setCursorLocation(l.startElement,l.startOffset);f.htmlForEditor.substr(0,4)==="<img"?tinymce.confluence.ImageUtils.insertImagePlaceholder(f.htmlForEditor):a.Rte.getEditor().execCommand("mceInsertContent",false,
f.htmlForEditor,{skip_focus:true})}catch(d){a.log("FileUploaded threw an exception "+d)}e.renderComplete(b.id)}else e.renderError(b.id,"\u670d\u52a1\u5668\u65e0\u54cd\u5e94\uff0c\u8bf7\u68c0\u67e5\u670d\u52a1\u5668\u662f\u5426\u6b63\u5728\u8fd0\u884c\u3002")});c.bind("Error",function(c,b){var g,f="";if(b.response){try{g=JSON.parse(b.response);f=g.actionErrors[0]}catch(d){f=d.name==="SyntaxError"?"\u4ece\u670d\u52a1\u5668\u63a5\u6536\u5230\u65e0\u6548\u7684\u54cd\u5e94\u3002":n.parseError(b.xhr,b.message)}e.renderError(b.file.id,f);a.trigger("analyticsEvent",{name:"confluence.editor.upload.error.server-unknown"})}else if(b.message){f=
b.message;if(b.code===plupload.FILE_SIZE_ERROR){f=a.format("\u4e0a\u4f20\u6587\u4ef6\u592a\u5927\u3002\u6587\u4ef6\u5fc5\u987b\u5c0f\u4e8e{0}.",a.DragAndDropUtils.niceSize(a.Meta.get("global-settings-attachment-max-size")));a.trigger("analyticsEvent",{name:"confluence.editor.upload.error.file-size"})}else if(b.code===a.UploadUtils.ErrorCode.FILE_IS_A_FOLDER_ERROR){f="\u53ef\u80fd\u662f\u4e00\u4e2a\u6587\u4ef6\u5939\u6216\u4e00\u4e2a\u4e0d\u652f\u6301\u7684\u6587\u4ef6\u7c7b\u578b\u3002";a.trigger("analyticsEvent",{name:"confluence.editor.upload.error.file-type"})}e.render({workId:b.file.id,status:b.file.status,
file:b.file,errorMessage:f});if(!e.isVisible()){e.show();e.showCloseButton()}}else{f=n.parseError(b.xhr);e.renderError(b.file.id,f);a.trigger("analyticsEvent",{name:"confluence.editor.upload.error.server-unknown"})}});c.bind("UploadComplete",function(){if(!c.total.queued){c.stop();e.showCloseButton();e.hasErrors()||setTimeout(function(){e.hide();e.clearRenderOutput();a.Rte.BookmarkManager.restoreBookmark()},1E3)}});a.Confluence.Uploader=c;a.Confluence.EditorUploadProgressDialog=e;q.bindFileDragOverlay({$dragZone:i(j).add("#toolbar ~ #editor-precursor"),
$overlayZone:i("#rte"),isTransparent:true})})})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:drag-and-drop-for-editor-common', location = 'js/link-dialog-drop-zone.js' */
define("confluence-drag-and-drop/link-dialog-drop-zone",["ajs"],function(a){return function(b){a.bind("dialog-shown.link-browser",function(){a.DragAndDropUtils.bindDrop(b("#insert-link-dialog")[0],function(a){a.preventDefault();a.stopPropagation()})})}});require("confluence/module-exporter").safeRequire("confluence-drag-and-drop/link-dialog-drop-zone",function(a){require("ajs").toInit(a)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:drop-zone-for-image-dialog', location = 'js/image-dialog-drop-zone.js' */
define("confluence-drag-and-drop/image-dialog-drop-zone",["ajs","confluence/legacy"],function(a,g){return function(c){if(a.Meta.get("remote-user")){var d=g.Editor.ImageDialog.findPanelComponentById("attachments");d?c(d).bind("afterThumbnail",function(d,e){if(!e.find(".image-dialog-drop-zone-container").length){var f=c("<li/>").addClass("attached-image"),b=c("<div/>").addClass("image-dialog-drop-zone-container image-container");c("<div/>").addClass("drop-zone-image").attr("title","\u5c06\u6587\u4ef6\u62d6\u653e\u5230\u8fd9\u91cc\u4e0a\u4f20").appendTo(b);
c("<div/>").addClass("drop-zone-text").text("\u62d6\u653e\u5230\u8fd9\u91cc").appendTo(b);b.appendTo(f);e.prepend(f);a.DragAndDropUtils.bindDragEnter(b[0],function(){b.addClass("drop-zone-on-hover")});a.DragAndDropUtils.bindDragOver(b[0],function(){b.addClass("drop-zone-on-hover")});a.DragAndDropUtils.bindDragLeave(b[0],function(){b.removeClass("drop-zone-on-hover")})}}):a.log("Skipping image attachment drop-zone - no Image Dialog attachment panel")}else a.debug("Skipping image attachment drop-zone for anonymous user creating new content")}});
require("confluence/module-exporter").safeRequire("confluence-drag-and-drop/image-dialog-drop-zone",function(a){require("ajs").toInit(a)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/rpc.js' */
var gadgets=gadgets||{};gadgets.rpc=function(){var CALLBACK_NAME="__cb";var DEFAULT_NAME="";var FE_G2C_CHANNEL="__g2c_rpc";var FE_C2G_CHANNEL="__c2g_rpc";var services={};var iframePool=[];var relayUrl={};var useLegacyProtocol={};var authToken={};var callId=0;var callbacks={};var setup={};var sameDomain={};var params={};if(gadgets.util){params=gadgets.util.getUrlParameters()}authToken[".."]=params.rpctoken||params.ifpctok||0;function getRelayChannel(){return typeof window.postMessage==="function"?"wpm":typeof document.postMessage==="function"?"dpm":navigator.product==="Gecko"?"fe":"ifpc"}function setupChannel(){if(relayChannel==="dpm"||relayChannel==="wpm"){window.addEventListener("message",function(packet){try{if(packet&&packet.origin&&packet.origin!=="null"&&typeof packet.data==="string"){if(packet.origin===location.origin){process(gadgets.json.parse(packet.data))}else{AJS.$.get(AJS.contextPath()+"/rest/whitelist/1/check",{url:packet.origin}).done(function(result){if(result&&result.inbound&&result.inbound===true){process(gadgets.json.parse(packet.data))}else{if(AJS.debug){AJS.log("RPC: request rejected (bad origin): "+(packet&&packet.origin?packet.origin:"undefined origin"))}}}).fail(function(jqXHR,textStatus,errorThrown){AJS.log("RPC: REST "+textStatus,errorThrown)})}}else{if(AJS.debug){AJS.log("RPC: request rejected (bad origin): "+(packet&&packet.origin?packet.origin:"undefined origin"))}}}catch(e){if(AJS.debug){var origin=packet&&packet.origin?packet.origin:"undefined origin";AJS.log("Error processing gadget rpc message from '"+origin+"': "+e)}}},false)}}var relayChannel=getRelayChannel();setupChannel();services[DEFAULT_NAME]=function(){throw new Error("Unknown RPC service: "+this.s)};services[CALLBACK_NAME]=function(callbackId,result){var callback=callbacks[callbackId];if(callback){delete callbacks[callbackId];callback(result)}};function setupFrame(frameId){if(setup[frameId]){return }if(relayChannel==="fe"){try{var frame=document.getElementById(frameId);frame[FE_G2C_CHANNEL]=function(args){process(gadgets.json.parse(args))}}catch(e){}}setup[frameId]=true}function encodeLegacyData(args){var stringify=gadgets.json.stringify;var argsEscaped=[];for(var i=0,j=args.length;i<j;++i){argsEscaped.push(encodeURIComponent(stringify(args[i])))}return argsEscaped.join("&")}function process(rpc){if(rpc&&typeof rpc.s==="string"&&typeof rpc.f==="string"&&rpc.a instanceof Array){if(authToken[rpc.f]){if(authToken[rpc.f]!=rpc.t){if(AJS.debug){console.log("Invalid auth token received for operation: "+rpc.s)}return }}if(rpc.c){rpc.callback=function(result){gadgets.rpc.call(rpc.f,CALLBACK_NAME,null,rpc.c,result)}}var result=(services[rpc.s]||services[DEFAULT_NAME]).apply(rpc,rpc.a);if(rpc.c&&typeof result!="undefined"){gadgets.rpc.call(rpc.f,CALLBACK_NAME,null,rpc.c,result)}}}function callFrameElement(targetId,serviceName,from,rpcData,callArgs){try{if(from!=".."){var fe=window.frameElement;if(typeof fe[FE_G2C_CHANNEL]==="function"){if(typeof fe[FE_G2C_CHANNEL][FE_C2G_CHANNEL]!=="function"){fe[FE_G2C_CHANNEL][FE_C2G_CHANNEL]=function(args){process(gadgets.json.parse(args))}}fe[FE_G2C_CHANNEL](rpcData);return }}else{var frame=document.getElementById(targetId);if(typeof frame[FE_G2C_CHANNEL]==="function"&&typeof frame[FE_G2C_CHANNEL][FE_C2G_CHANNEL]==="function"){frame[FE_G2C_CHANNEL][FE_C2G_CHANNEL](rpcData);return }}}catch(e){}callIfpc(targetId,serviceName,from,rpcData,callArgs)}function callIfpc(targetId,serviceName,from,rpcData,callArgs){var relay=gadgets.rpc.getRelayUrl(targetId);if(!relay){throw new Error("No relay file assigned for IFPC")}var src=null;if(useLegacyProtocol[targetId]){src=[relay,"#",encodeLegacyData([from,callId,1,0,encodeLegacyData([from,serviceName,"","",from].concat(callArgs))])].join("")}else{src=[relay,"#",targetId,"&",from,"@",callId,"&1&0&",encodeURIComponent(rpcData)].join("")}emitInvisibleIframe(src)}function emitInvisibleIframe(src){var iframe;for(var i=iframePool.length-1;i>=0;--i){var ifr=iframePool[i];try{if(ifr&&(ifr.recyclable||ifr.readyState==="complete")){ifr.parentNode.removeChild(ifr);if(window.ActiveXObject){iframePool[i]=ifr=null;iframePool.splice(i,1)}else{ifr.recyclable=false;iframe=ifr;break}}}catch(e){}}if(!iframe){iframe=document.createElement("iframe");iframe.style.border=iframe.style.width=iframe.style.height="0px";iframe.style.visibility="hidden";iframe.style.position="absolute";iframe.onload=function(){this.recyclable=true};iframePool.push(iframe)}iframe.src=src;setTimeout(function(){document.body.appendChild(iframe)},0)}function callSameDomain(target,rpc){if(typeof sameDomain[target]==="undefined"){sameDomain[target]=false;var targetEl=null;if(target===".."){targetEl=parent}else{targetEl=frames[target]}try{sameDomain[target]=targetEl.gadgets.rpc.receiveSameDomain}catch(e){}}if(typeof sameDomain[target]==="function"){sameDomain[target](rpc);return true}return false}if(gadgets.config){function init(config){if(config.rpc.parentRelayUrl.substring(0,7)==="http://"){relayUrl[".."]=config.rpc.parentRelayUrl}else{var params=document.location.search.substring(0).split("&");var parentParam="";for(var i=0,param;param=params[i];++i){if(param.indexOf("parent=")===0){parentParam=decodeURIComponent(param.substring(7));break}}relayUrl[".."]=parentParam+config.rpc.parentRelayUrl}useLegacyProtocol[".."]=!!config.rpc.useLegacyProtocol}var requiredConfig={parentRelayUrl:gadgets.config.NonEmptyStringValidator};gadgets.config.register("rpc",requiredConfig,init)}return{register:function(serviceName,handler){if(serviceName==CALLBACK_NAME){throw new Error("Cannot overwrite callback service")}if(serviceName==DEFAULT_NAME){throw new Error("Cannot overwrite default service:"+" use registerDefault")}services[serviceName]=handler},unregister:function(serviceName){if(serviceName==CALLBACK_NAME){throw new Error("Cannot delete callback service")}if(serviceName==DEFAULT_NAME){throw new Error("Cannot delete default service:"+" use unregisterDefault")}delete services[serviceName]},registerDefault:function(handler){services[""]=handler},unregisterDefault:function(){delete services[""]},call:function(targetId,serviceName,callback,var_args){++callId;targetId=targetId||"..";if(callback){callbacks[callId]=callback}var from="..";if(targetId===".."){from=window.name}var rpc={s:serviceName,f:from,c:callback?callId:0,a:Array.prototype.slice.call(arguments,3),t:authToken[targetId]};if(callSameDomain(targetId,rpc)){return }var rpcData=gadgets.json.stringify(rpc);var channelType=relayChannel;if(useLegacyProtocol[targetId]){channelType="ifpc"}switch(channelType){case"dpm":var targetDoc=targetId===".."?parent.document:frames[targetId].document;targetDoc.postMessage(rpcData);break;case"wpm":var targetWin=targetId===".."?parent:frames[targetId];targetWin.postMessage(rpcData,relayUrl[targetId]);break;case"fe":callFrameElement(targetId,serviceName,from,rpcData,rpc.a);break;default:callIfpc(targetId,serviceName,from,rpcData,rpc.a);break}},getRelayUrl:function(targetId){return relayUrl[targetId]},setRelayUrl:function(targetId,url,opt_useLegacy){relayUrl[targetId]=url;useLegacyProtocol[targetId]=!!opt_useLegacy},setAuthToken:function(targetId,token){authToken[targetId]=token;setupFrame(targetId)},getRelayChannel:function(){return relayChannel},receive:function(fragment){if(fragment.length>4){process(gadgets.json.parse(decodeURIComponent(fragment[fragment.length-1])))}},receiveSameDomain:function(rpc){rpc.a=Array.prototype.slice.call(rpc.a);window.setTimeout(function(){process(rpc)},0)}}}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/util.js' */
Function.prototype.inherits=function(parentCtor){function tempCtor(){}tempCtor.prototype=parentCtor.prototype;this.superClass_=parentCtor.prototype;this.prototype=new tempCtor();this.prototype.constructor=this};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/json.js' */
var gadgets=gadgets||{};gadgets.json=function(){function f(n){return n<10?"0"+n:n}Date.prototype.toJSON=function(){return[this.getUTCFullYear(),"-",f(this.getUTCMonth()+1),"-",f(this.getUTCDate()),"T",f(this.getUTCHours()),":",f(this.getUTCMinutes()),":",f(this.getUTCSeconds()),"Z"].join("")};var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function stringify(value){var a,i,k,l,r=/["\\\x00-\x1f\x7f-\x9f]/g,v;switch(typeof value){case"string":return r.test(value)?'"'+value.replace(r,function(a){var c=m[a];if(c){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"':'"'+value+'"';case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}a=[];if(typeof value.length==="number"&&!(value.propertyIsEnumerable("length"))){l=value.length;for(i=0;i<l;i+=1){a.push(stringify(value[i])||"null")}return"["+a.join(",")+"]"}for(k in value){if(value.hasOwnProperty(k)){if(typeof k==="string"){v=stringify(value[k]);if(v){a.push(stringify(k)+":"+v)}}}}return"{"+a.join(",")+"}"}}return{stringify:stringify,parse:function(text){if(/^[\],:{}\s]*$/.test(text.replace(/\\["\\\/b-u]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){return eval("("+text+")")}return false}}}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/gadgets-core.js' */
var gadgets=gadgets||{};gadgets.error={};gadgets.error.SUBCLASS_RESPONSIBILITY="subclass responsibility";gadgets.error.TO_BE_DONE="to be done";gadgets.log=function(message){if(window.console&&console.log){console.log(message)}else{var logEntry=document.createElement("div");logEntry.className="gadgets-log-entry";logEntry.innerHTML=message;document.body.appendChild(logEntry)}};gadgets.Extensible=function(){};gadgets.Extensible.prototype.setDependencies=function(dependencies){for(var p in dependencies){this[p]=dependencies[p]}};gadgets.Extensible.prototype.getDependencies=function(name){return this[name]};gadgets.UserPrefStore=function(){};gadgets.UserPrefStore.prototype.getPrefs=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.UserPrefStore.prototype.savePrefs=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.DefaultUserPrefStore=function(){gadgets.UserPrefStore.call(this)};gadgets.DefaultUserPrefStore.inherits(gadgets.UserPrefStore);gadgets.DefaultUserPrefStore.prototype.getPrefs=function(gadget){};gadgets.DefaultUserPrefStore.prototype.savePrefs=function(gadget){};gadgets.GadgetService=function(){};gadgets.GadgetService.prototype.setHeight=function(elementId,height){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.GadgetService.prototype.setTitle=function(gadget,title){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.GadgetService.prototype.setUserPref=function(id){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.IfrGadgetService=function(){gadgets.GadgetService.call(this);var service=this;gadgets.rpc.register("resize_iframe",function(){service.setHeight.apply(this,arguments)});gadgets.rpc.register("set_pref",function(){service.setUserPref.apply(this,arguments)});gadgets.rpc.register("set_title",function(){service.setTitle.apply(this,arguments)});gadgets.rpc.register("requestNavigateTo",function(){service.requestNavigateTo.apply(this,arguments)})};gadgets.IfrGadgetService.inherits(gadgets.GadgetService);gadgets.IfrGadgetService.prototype.setHeight=function(height){if(height>gadgets.container.maxheight_){height=gadgets.container.maxheight_}var element=document.getElementById(this.f);if(element){element.style.height=height+"px"}};gadgets.IfrGadgetService.prototype.requestNavigateTo=function(view,opt_params){var id=this.getGadgetIdFromModuleId(this.f);var url=this.getUrlForView(view);if(opt_params){var paramStr=JSON.stringify(opt_params);if(paramStr.length>0){url+="&appParams="+encodeURIComponent(paramStr)}}if(url&&document.location.href.indexOf(url)==-1){document.location.href=url}};gadgets.IfrGadgetService.prototype.getUrlForView=function(view){if(view==="canvas"){return"/canvas"}else{if(view==="profile"){return"/profile"}else{return null}}};gadgets.IfrGadgetService.prototype.getGadgetIdFromModuleId=function(moduleId){return parseInt(moduleId.match(/_([0-9]+)$/)[1],10)};gadgets.LayoutManager=function(){};gadgets.LayoutManager.prototype.getGadgetChrome=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.StaticLayoutManager=function(){gadgets.LayoutManager.call(this)};gadgets.StaticLayoutManager.inherits(gadgets.LayoutManager);gadgets.StaticLayoutManager.prototype.setGadgetChromeIds=function(gadgetChromeIds){this.gadgetChromeIds_=gadgetChromeIds};gadgets.StaticLayoutManager.prototype.getGadgetChrome=function(gadget){var chromeId=this.gadgetChromeIds_[gadget.id];return chromeId?document.getElementById(chromeId):null};gadgets.FloatLeftLayoutManager=function(layoutRootId){gadgets.LayoutManager.call(this);this.layoutRootId_=layoutRootId};gadgets.FloatLeftLayoutManager.inherits(gadgets.LayoutManager);gadgets.FloatLeftLayoutManager.prototype.getGadgetChrome=function(gadget){var layoutRoot=document.getElementById(this.layoutRootId_);if(layoutRoot){var chrome=document.createElement("div");chrome.className="gadgets-gadget-chrome";chrome.style.cssFloat="left";layoutRoot.appendChild(chrome);return chrome}else{return null}};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.gadgets:macro-browser-for-gadgetsplugin', location = 'script/gadget-macro-browser.js' */
AJS.toInit(function(a){var b={};b.postPreview=function(h,d){var f=h.contentWindow.AJS;var c={};var k=a("#macro-param-div-preferences input").val().split("&");for(var j=0,o=k.length;j<o;j++){var g=k[j].split("=");try{c[decodeURI(g[0])]=decodeURI(g[1])}catch(l){}}if(d.needsConfig&&f){var m=!!c.isConfigured;if(!m){var n=a("#macro-browser-dialog .dialog-button-panel .ok");a("#save-warning-span").addClass("gadget-not-configured-warning").text("\u8bf7\u9996\u5148\u4e8e\u9884\u89c8\u533a\u57df\u5b8c\u6210\u914d\u7f6e").removeClass("hidden");n.prop("disabled",true)}}};b.beforeParamsSet=function(j,c){var h=j.preferences;if(!c&&h){var g=h.split("&");for(var d=0,f=g.length;d<f;d++){var e=g[d].split("=");j[decodeURI(e[0])]=decodeURI(e[1])}}return j};b.updateMacroParametersForPreview=function(c){c.forceWrite=true;return c};b.manipulateMarkup=function(f){if(AJS.MacroBrowser.gadgetPrefsChanged){var d=top.document.getElementById("macro-insert-container");var g=a("#macro-param-div-preferences input",d);var c="";for(var e in AJS.MacroBrowser.gadgetPrefs){if(c.length!=0){c+="&"}c=c+encodeURI(e)+"="+encodeURI(AJS.MacroBrowser.gadgetPrefs[e])}g.val(c)}};b.getMacroDetailsFromSelectedMacro=function(f,g){var c=g.params.url;for(var e=0,h=f.length;e<h;e++){var d=f[e];if(d.macroName===g.name&&d.gadgetUrl===c){return d}}};b.beforeParamsRetrieved=function(p,h,j){var s="";if(h.nonHiddenUserPrefs){var m=true;var d={},f=p.preferences;if(f){var n=f.split("&");for(var l=0,q=n.length;l<q;l++){var k=n[l].split("=");var o=decodeURI(k[0]);var r=decodeURI(k[1]);d[o]=r}}for(var e in j){d[e]=j[e]}var c=function(v,t,w){var x=v.formDetails.parameters;for(var u=0;u<x.length;u++){if(x[u].name==t){return w==x[u].defaultValue}}AJS.log("Unable to find matching param for "+t);return false};for(var g in d){if(!c(h,g,d[g])){if(!m){s+="&"}m=false;s=s+encodeURI(g)+"="+encodeURI(d[g])}}p.preferences=s}return p};AJS.MacroBrowser.setMacroJsOverride("gadget",b)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = 'templates/view-file-macro-editor.soy' */
// This file was automatically generated from view-file-macro-editor.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.ViewFileMacro.Templates.Editor.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.ViewFileMacro == 'undefined') { Confluence.ViewFileMacro = {}; }
if (typeof Confluence.ViewFileMacro.Templates == 'undefined') { Confluence.ViewFileMacro.Templates = {}; }
if (typeof Confluence.ViewFileMacro.Templates.Editor == 'undefined') { Confluence.ViewFileMacro.Templates.Editor = {}; }


Confluence.ViewFileMacro.Templates.Editor.viewFilePropertyPanelHeader = function(opt_data, opt_ignored) {
  return '<div class="view-file-property-panel-header"><span class="file-name"><span class="aui-icon aui-icon-small ' + soy.$$escapeHtml(opt_data.fileIcon) + '"></span>' + soy.$$escapeHtml(opt_data.fileName) + '</span></div>';
};
if (goog.DEBUG) {
  Confluence.ViewFileMacro.Templates.Editor.viewFilePropertyPanelHeader.soyTemplateName = 'Confluence.ViewFileMacro.Templates.Editor.viewFilePropertyPanelHeader';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = '/js/components/view-file-macro-properties-panel.js' */
define("vfm/components/view-file-macro-properties-panel",["jquery","underscore","ajs","confluence/legacy","confluence/jsUri","tinymce","vfm/view-file-macro-utils"],function(d,x,f,l,m,b,r){var t="view-file";var a="macro-placeholder-property-panel-edit-button";var y="macro-placeholder-property-panel-remove-button";var c="placeholder/unknown-attachment";var i="data-macro-parameters";var q={"view-file-size-small":"150","view-file-size-medium":"250","view-file-size-large":"400"};var h=[{className:"macro-property-panel-view-file-size-small editor-resize resize-small",text:"",tooltip:"\u5c0f\u578b\u7f29\u7565\u56fe",iconClass:"aui-icon aui-icon-small aui-iconfont-image-resize",click:j},{className:"macro-property-panel-view-file-size-medium editor-resize resize-medium",text:"",tooltip:"\u4e2d\u7f29\u7565\u56fe",iconClass:"aui-icon aui-icon-small aui-iconfont-image-resize",click:j},{className:"macro-property-panel-view-file-size-large editor-resize resize-large",text:"",tooltip:"\u5927\u7f29\u7565\u56fe",iconClass:"aui-icon aui-icon-small aui-iconfont-image-resize",click:j},null,{className:"macro-property-panel-view-file-convert-to-link",text:"\u4f5c\u4e3a\u94fe\u63a5\u663e\u793a",tooltip:"\u4f5c\u4e3a\u94fe\u63a5\u663e\u793a",click:g}];function u(E,B){var F=x.find(Object.keys(q),function(G){return q[G]===B});if(F){for(var A=0,D=E.length;A<D;A++){var z=E[A];var C=z.className.replace(" active","");if(C.indexOf("macro-property-panel-"+F)!==-1){C+=" active"}z.className=C}}}function s(A){var B=x.reject(A,function(C){return C.className.indexOf(a)>-1||C.className.indexOf(y)>-1});A.splice(0,A.length);for(var z=0;z<B.length;z++){A.push(B[z])}}function k(A,z){var B=d(A);B.attr("height",z);var C=B.attr("src");if(o(C)){B.attr("src",p(B.attr("src"),z));B.attr("data-mce-src",p(B.attr("data-mce-src"),z));if(b.isGecko){f.Rte.getEditor().execCommand("mceRepaint",false)}}v(B,z);b.activeEditor.undoManager.add()}function o(z){return(z!=null&&z.indexOf("/servlet/view-file-macro/placeholder")>=0)}function p(B,z){var A=new m(B);if(A.getQueryParamValue("height")!==""){A.replaceQueryParam("height",z)}return A.toString()}function w(C){var z=C.attr(i);var D=[];var A="";for(var B=0;B<z.length;B++){var E=z[B];if(E==="\\"){A+=E;if(B+1!==z.length){A+=z[++B]}}else{if(E==="|"){D.push(A);A=""}else{A+=E}}}D.push(A);return D}function v(C,A){var B="height="+A;var E=w(C);var D=e(C,"height");if(D){var z=x.indexOf(E,"height="+D);E[z]=B}else{E.push(B)}C.attr(i,E.join("|"))}function e(B,z){var C=w(B);var A=x.find(C,function(D){return(D.indexOf(z+"=")>=0)});return A?A.split("=")[1]:null}function j(B,z){if(d(B).attr("class").indexOf("active")!==-1){return}f.Confluence.PropertyPanel.destroy();var C=Object.keys(q);var D=d(B).attr("class");for(var A=0;A<C.length;A++){if(D.indexOf(C[A])!==-1){k(z,q[C[A]]);d(z).click();f.trigger("analyticsEvent",{name:"confluence.view-file.resize."+C[A].substring(C[A].lastIndexOf("-")+1,C[A].length)});return}}}function g(B,z){f.trigger("analyticsEvent",{name:"confluence.view-file.convert.to-link-trigger"});f.Confluence.PropertyPanel.destroy();A(z);function A(C){var E=r.getParameterByName(d(C).attr("src"),"attachmentId");var D=f.REST.makeUrl("attachment/"+E+".json");d.ajax({type:"GET",url:D,contentType:"application/json; charset=utf-8",dataType:"json"}).success(function(H){var F=l.Link.fromREST(H);var G=F.insert();b.activeEditor.undoManager.add();b.activeEditor.focus();G.click()})}}function n(){f.bind("created.property-panel",function(G,F){var H=d(F.anchor);var C=H.attr("data-macro-name");if(C!==t){return}var D=l.ViewFileMacro.Templates.Editor.viewFilePropertyPanelHeader;var E=e(H,"name");var B=r.getParameterByName(H.attr("src"),"mimeType");var A=f.Confluence.FileTypesUtils.getAUIIconFromMime(B);var z=d(D({fileName:E,fileIcon:A}));F.panel.find(".aui-property-panel").prepend(z);if(F.shouldFlip){F.tip.css({top:F.panel.outerHeight()})}})}return{init:function(){f.Confluence.PropertyPanel.Macro.registerInitHandler(function(G,D,z){s(D);var E=d(G);var B=E.attr("data-mce-src");if(B&&B.indexOf(c)>-1){return}for(var A=0,C=h.length;A<C;A++){D.push(h[A])}var F=E.attr("height");if(!F){F=(f.Meta.get("content-type")==="comment")?r.DEFAULT_HEIGHT_IN_COMMENT:r.DEFAULT_HEIGHT}u(D,F)},t);n()}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = '/js/components/view-file-macro-link-properties-panel.js' */
define("vfm/components/view-file-macro-link-properties-panel",["jquery","ajs","tinymce","vfm/view-file-macro-utils"],function(g,b,e,a){var c="view-file";function f(h){if(h){var k=g(h);var i=k.attr("data-linked-resource-type");var j=k.attr("data-linked-resource-content-type");return b.MacroBrowser.getMacroMetadata(c)&&i==="attachment"&&!(j&&j.indexOf("image")===0)}return false}function d(h){var i=b.REST.makeUrl("attachment/"+g(h).attr("data-linked-resource-id")+".json");g.ajax({type:"GET",url:i,contentType:"application/json; charset=utf-8",dataType:"json"}).success(function(k){var n={name:k.fileName};if(b.Data.get("content-id")!==k.ownerId){n.page=k.parentTitle;n.space=k.space.key;if(k.parentContentType==="blogpost"){var l=k.createdDate.date.split("-");n.date=l[0]+"/"+l[1]+"/"+l[2].substring(0,2)+"/"}}n.height=(b.Meta.get("content-type")==="comment")?a.DEFAULT_HEIGHT_IN_COMMENT:a.DEFAULT_HEIGHT;var j={contentId:b.Meta.get("content-id")||"0",macro:{name:c,params:n}};var m=e.confluence.MacroUtils.insertMacro(j,h);m.done(function(o){g(o).click()})})}return{init:function(){b.bind("link-property-panel-buttons.created",function(j,k){var i=k.buttons;var h=k.link;if(f(h)){i.push({className:"link-property-panel-convert-to-thumbnail-button",text:"\u4f5c\u4e3a\u7f29\u7565\u56fe\u663e\u793a",tooltip:"\u4f5c\u4e3a\u7f29\u7565\u56fe\u663e\u793a",click:function(){b.Confluence.PropertyPanel.destroy();d(h);b.trigger("analyticsEvent",{name:"confluence.view-file.convert.to-thumbnail-trigger"})}})}})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = '/js/components/vfm-editor-poller.js' */
define("vfm/components/vfm-editor-poller",["ajs","jquery","underscore","tinymce","vfm/view-file-macro-utils","vfm/services/conversion-service"],function(k,e,m,p,q,c){var o;var l=false;var d={};var f=q.THUMBNAIL_POLLING_PERIOD;var h=q.THUMBNAIL_POLLING_BACKOFF_RATIO;function a(){if(!p.activeEditor||!l){return}var s=e("img[data-macro-name='view-file'][src*='thumbnailStatus="+q.THUMBNAIL_STATUS_IN_PROGRESS+"'][data-thumbnail-status!='"+q.THUMBNAIL_STATUS_ERROR+"']",p.activeEditor.dom.doc);if(s.length>0){var r=false;s.each(function(){var u=e(this);var w=u.attr("src");var v=q.getParameterByName(w,"attachmentId");var t=q.getParameterByName(w,"version");if(!d[v]||d[v].version!==t){d[v]={version:t};r=true}});if(r){j()}c.postThumbnailConversionResults(d).then(function(t){if(!p.activeEditor||!l){return}m.each(t,function(x,y){if(!d[y]){return}var w=e("img[data-macro-name='view-file'][src*='attachmentId="+y+"']",p.activeEditor.dom.doc);var v=d[y].version;w.attr("data-thumbnail-status",x);if(x===q.THUMBNAIL_STATUS_CONVERTED){var u=w.attr("src");var z=c.getThumbnailUrl(y,v);z=q.addParamsToUrl(z,{attachmentId:y,mimeType:q.getParameterByName(u,"mimeType")});w.attr("src",z);delete d[y]}else{if(x===q.THUMBNAIL_STATUS_ERROR){delete d[y]}}});if(!m.isEmpty(d)){n()}else{j()}i()})}else{if(s.length===0){j();i()}}}function n(){f=f*h}function j(){f=q.THUMBNAIL_POLLING_PERIOD}function i(){l=true;if(o){clearTimeout(o)}o=setTimeout(a,f)}function g(){if(o){clearTimeout(o);o=undefined}l=false;d={};j()}var b={startPolling:i,stopPolling:g};return b});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = '/js/vfm-editor.js' */
require(["ajs","tinymce","vfm/components/view-file-macro-properties-panel","vfm/components/view-file-macro-link-properties-panel","vfm/components/vfm-editor-poller"],function(a,d,b,c,e){a.toInit(function(){a.MacroBrowser.setMacroJsOverride("view-file",{opener:function(f){}});b.init();c.init()});d.create("tinymce.plugins.ViewFilePoller",{init:function(f){a.bind("rte-ready",function(){e.startPolling()});a.bind("rte-destroyed",function(){e.stopPolling()})}});d.PluginManager.add("viewFilePoller",d.plugins.ViewFilePoller);a.Rte.BootstrapManager.addTinyMcePluginInit(function(f){f.plugins+=",viewFilePoller"})},undefined,true);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:f1306800353dff1e89554619ba3fdbea', location = 'build/448.js' */
(self.webpackChunk=self.webpackChunk||[]).push([[448],{10028:function(){window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(o,t){t=t||window;for(var e=0;e<this.length;e++)o.call(t,this[e],e,this)})}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:common-resources', location = 'build/common.js' */
!function(){"use strict";var t={53973:function(t,e,r){r.r(e);r(10028);var o={stringPrototype:{},regExpPrototype:{},isNative:function(t){return-1!=t.toString().indexOf("native code")},isNeedLoadNativeFunctions:function(){return $("div[data-macro-name=code]").length&&!this.isNative(String.prototype.replace)},saveOriginalNativeFunctions:function(){var t=this;!t.stringPrototype.replaceOriginal&&t.isNative(String.prototype.replace)&&(t.stringPrototype.replaceOriginal=String.prototype.replace,t.stringPrototype.matchOriginal=String.prototype.match,t.stringPrototype.splitOriginal=String.prototype.split,t.regExpPrototype.execOriginal=RegExp.prototype.exec,t.regExpPrototype.testOriginal=RegExp.prototype.test,t.regExpPrototype.applyOriginal=RegExp.prototype.apply,t.regExpPrototype.callOriginal=RegExp.prototype.call)},loadOriginalNativeFunctions:function(){var t=this;t.stringPrototype.replaceOriginal&&(t.isNeedLoadNativeFunctions()?(t.stringPrototype.replaceSave=String.prototype.replace,t.stringPrototype.matchSave=String.prototype.match,t.stringPrototype.splitSave=String.prototype.split,t.regExpPrototype.execSave=RegExp.prototype.exec,t.regExpPrototype.testSave=RegExp.prototype.test,t.regExpPrototype.applySave=RegExp.prototype.apply,t.regExpPrototype.callSave=RegExp.prototype.call,String.prototype.replace=t.stringPrototype.replaceOriginal,String.prototype.match=t.stringPrototype.matchOriginal,String.prototype.split=t.stringPrototype.splitOriginal,RegExp.prototype.exec=t.regExpPrototype.execOriginal,RegExp.prototype.test=t.regExpPrototype.testOriginal,RegExp.prototype.apply=t.regExpPrototype.applyOriginal,RegExp.prototype.call=t.regExpPrototype.callOriginal):t.stringPrototype.replaceSave=null)},loadSavedCurrentNativeFunctions:function(){var t=this;t.stringPrototype.replaceOriginal&&t.stringPrototype.replaceSave&&(String.prototype.replace=t.stringPrototype.replaceSave,String.prototype.match=t.stringPrototype.matchSave,String.prototype.split=t.stringPrototype.splitSave,RegExp.prototype.exec=t.regExpPrototype.execSave,RegExp.prototype.test=t.regExpPrototype.testSave,RegExp.prototype.apply=t.regExpPrototype.applySave,RegExp.prototype.call=t.regExpPrototype.callSave)}};window.TFSolutionBug=o,o.saveOriginalNativeFunctions()}},e={};function r(o){if(e[o])return e[o].exports;var p=e[o]={exports:{}};return t[o](p,p.exports,r),p.exports}r.m=t,r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},function(){var t={592:0},e=[[53973,448]],o=function(){};function p(){for(var o,p=0;p<e.length;p++){for(var i=e[p],n=!0,a=1;a<i.length;a++){var g=i[a];0!==t[g]&&(n=!1)}n&&(e.splice(p--,1),o=r(r.s=i[0]))}return 0===e.length&&(r.x(),r.x=function(){}),o}r.x=function(){r.x=function(){},n=n.slice();for(var t=0;t<n.length;t++)i(n[t]);return(o=p)()};var i=function(p){for(var i,n,g=p[0],l=p[1],y=p[2],c=p[3],s=0,x=[];s<g.length;s++)n=g[s],r.o(t,n)&&t[n]&&x.push(t[n][0]),t[n]=0;for(i in l)r.o(l,i)&&(r.m[i]=l[i]);for(y&&y(r),a(p);x.length;)x.shift()();return c&&e.push.apply(e,c),o()},n=self.webpackChunk=self.webpackChunk||[],a=n.push.bind(n);n.push=i}(),r.x()}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:editor-extensions', location = 'build/editor-extensions.js' */
/*! For license information please see editor-extensions.js.LICENSE.txt */
(function(){var __webpack_modules__={18758:function(){function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function($){$.extend({tablesorterEditor:new function(){this.version="2.3.10";var parsers=[],widgets=[];function log(e){"undefined"!=typeof console&&void 0!==console.log||alert(e)}function benchmark(e,t){log(e+" ("+((new Date).getTime()-t.getTime())+"ms)")}function getElementText(e,t,r){if(!t)return"";var o=e.config,a=o.textExtraction,n="";return n="simple"===a?o.supportsTextContent?t.textContent:t.childNodes[0]&&t.childNodes[0].hasChildNodes()?t.childNodes[0].innerHTML:t.innerHTML:"function"==typeof a?a(t,e,r):"object"===_typeof(a)&&a.hasOwnProperty(r)?a[r](t,e,r):o.supportsTextContent?t.textContent:$(t).text(),$.trim(n)}function getParserById(e){var t,r=parsers.length;for(t=0;t<r;t++)if(parsers[t].id.toLowerCase()===e.toString().toLowerCase())return parsers[t];return!1}function detectParserForColumn(e,t,r,o){for(var a,n=parsers.length,i=!1,s="",c=!0;""===s&&c;)t[++r]?(s=getElementText(e,i=t[r].cells[o],o),e.config.debug&&log("Checking if value was empty on row "+r+", column: "+o+": "+s)):c=!1;for(a=1;a<n;a++)if(parsers[a].is(s,e,i))return parsers[a];return parsers[0]}function buildParserCache(e,t){var r,o,a,n,i,s,c,d=e.config,l=$(e.tBodies).filter(":not(."+d.cssInfoBlock+")"),u=$.tablesorterEditor,f="";if(0!==l.length){if((r=l[0].rows)[0])for(o=[],a=r[0].cells.length,n=0;n<a;n++)i=t.filter(':not([colspan])[data-column="'+n+'"]:last,[colspan="1"][data-column="'+n+'"]:last'),s=d.headers[n],c=getParserById(u.getData(i,s,"sorter")),d.empties[n]=u.getData(i,s,"empty")||d.emptyTo||(d.emptyToBottom?"bottom":"top"),d.strings[n]=u.getData(i,s,"string")||d.stringTo||"max",c||(c=detectParserForColumn(e,r,r.length>1?0:-1,n)),d.debug&&(f+="column:"+n+"; parser:"+c.id+"; string:"+d.strings[n]+"; empty: "+d.empties[n]+"\n"),o.push(c);return d.debug&&log(f),o}}function buildCache(e){var t,r,o,a,n,i,s,c,d,l=e.tBodies,u=e.config,f=u.parsers;for(u.cache={},u.debug&&(d=new Date),i=0;i<l.length;i++)if(u.cache[i]={row:[],normalized:[]},!$(l[i]).hasClass(u.cssInfoBlock)){for($(l[i]).addClass("tablesorter-hidden"),t=l[i]&&l[i].rows.length||0,r=l[i].rows[0]&&l[i].rows[0].cells.length||0,a=0;a<t;++a)if(!$(l[i].rows[a]).hasClass("tablesorter-header"))if(c=[],(s=$(l[i].rows[a])).hasClass(u.cssChildRow))u.cache[i].row[u.cache[i].row.length-1]=u.cache[i].row[u.cache[i].row.length-1].add(s);else{for(u.cache[i].row.push(s),n=0;n<r;++n)o=getElementText(e,s[0].cells[n],n),c.push(f[n].format(o,e,s[0].cells[n],n));c.push(u.cache[i].normalized.length),u.cache[i].normalized.push(c)}$(l[i]).removeClass("tablesorter-hidden")}u.debug&&benchmark("Building cache for "+t+" rows",d)}function getWidgetById(e){var t,r,o=widgets.length;for(t=0;t<o;t++)if((r=widgets[t])&&r.hasOwnProperty("id")&&r.id.toLowerCase()===e.toLowerCase())return r}function applyWidget(e,t){var r,o,a,n=e.config,i=n.widgets,s=i.length;for(n.debug&&(r=new Date),o=0;o<s;o++)(a=getWidgetById(i[o]))&&(!0===t&&a.hasOwnProperty("init")?a.init(e,widgets,a):!t&&a.hasOwnProperty("format")&&a.format(e));n.debug&&benchmark("Completed "+(!0===t?"initializing":"applying")+" widgets",r)}function appendToTable(e,t){var r,o,a,n,i,s,c,d,l,u,f,p=e.config,h=e.tBodies,g=[],m=p.cache;for(p.debug&&(f=new Date),d=0;d<h.length;d++)if(!$(h[d]).hasClass(p.cssInfoBlock)){for($(h[d]).addClass("tablesorter-hidden"),i=document.createDocumentFragment(),r=m[d].row,n=(a=(o=m[d].normalized).length)?o[0].length-1:0,s=0;s<a;s++)if(u=o[s][n],g.push(r[u]),!p.appender||!p.removeRows)for(l=r[u].length,c=0;c<l;c++)i.appendChild(r[u][c]);e.tBodies[d].appendChild(i),$(h[d]).removeClass("tablesorter-hidden")}p.appender&&p.appender(e,g),p.debug&&benchmark("Rebuilt table",f),t||applyWidget(e),$(e).trigger("sortEnd",e)}function computeThIndexes(e){var t,r,o,a,n,i,s,c,d,l,u,f,p=[],h={},g=$(e).find("tr:has(td,th):first");for(t=0;t<g.length;t++)for(i=g[t].cells,r=0;r<i.length;r++){for(c=(s=(n=i[r]).parentNode.rowIndex)+"-"+n.cellIndex,d=n.rowSpan||1,l=n.colSpan||1,void 0===p[s]&&(p[s]=[]),o=0;o<p[s].length+1;o++)if(void 0===p[s][o]){u=o;break}for(h[c]=u,$(n).attr({"data-column":u}),o=s;o<s+d;o++)for(void 0===p[o]&&(p[o]=[]),f=p[o],a=u;a<u+l;a++)f[a]="x"}return h}function formatSortingOrder(e){return/^d/i.test(e)||1===e}function buildHeaders(e){var t,r,o,a,n,i=computeThIndexes(e),s=e.config,c=$.tablesorterEditor;return s.headerList=[],s.debug&&(a=new Date),n=$(e).find(s.selectorHeaders).each((function(e){r=$(this),t=s.headers[e],s.onRenderHeader&&s.onRenderHeader.apply(r,[e]),this.column=i[this.parentNode.rowIndex+"-"+this.cellIndex],this.order=formatSortingOrder(c.getData(r,t,"sortInitialOrder")||s.sortInitialOrder)?[1,0,2]:[0,1,2],this.count=-1,"false"===c.getData(r,t,"sorter")&&(this.sortDisabled=!0),this.lockedOrder=!1,void 0!==(o=c.getData(r,t,"lockedOrder")||!1)&&!1!==o&&(this.order=this.lockedOrder=formatSortingOrder(o)?[1,1,1]:[0,0,0]),this.sortDisabled||r.addClass(s.cssHeader),s.headerList[e]=this,r.parent().addClass(s.cssHeader)})),e.config.debug&&(benchmark("Built headers:",a),log(n)),n}function isValueInArray(e,t){var r,o=t.length;for(r=0;r<o;r++)if(t[r][0]===e)return!0;return!1}function setHeadersCss(e,t,r){var o,a,n,i,s=[],c=[e.config.cssDesc,e.config.cssAsc];for(t.removeClass(c.join(" ")).each((function(){this.sortDisabled||(s[this.column]=$(this))})),i=r.length,a=0;a<i;a++)if(2!==r[a][1]&&(s[r[a][0]]&&s[r[a][0]].addClass(c[r[a][1]]),o=t.filter('[data-column="'+r[a][0]+'"]'),i>1&&o.length))for(n=0;n<o.length;n++)o[n].sortDisabled||$(o[n]).addClass(c[r[a][1]])}function fixColumnWidth(e){if(e.config.widthFixed){var t=$("<colgroup>");$("tr:first td",e.tBodies[0]).each((function(){t.append($("<col>").css("width",$(this).width()))})),$(e).prepend(t)}}function updateHeaderSortCount(e,t){var r,o,a,n=e.config,i=t.length;for(r=0;r<i;r++)o=t[r],(a=n.headerList[o[0]])&&(a.count=o[1]%(n.sortReset?3:2))}function getCachedSortType(e,t){return e&&e[t]&&e[t].type||""}function multisort(table,sortList){var dynamicExp,col,mx=0,dir=0,tc=table.config,l=sortList.length,bl=table.tBodies.length,sortTime,i,j,k,c,cache,lc,s,e,order,orgOrderCol;for(tc.debug&&(sortTime=new Date),k=0;k<bl;k++){for(dynamicExp="var sortWrapper = function(a,b) {",cache=tc.cache[k],lc=cache.normalized.length,i=0;i<l;i++){if(c=sortList[i][0],order=sortList[i][1],s=/n/i.test(getCachedSortType(tc.parsers,c))?"Numeric":"Text",s+=0===order?"":"Desc",e="e"+i,/Numeric/.test(s)&&tc.strings[c]){for(j=0;j<lc;j++)col=Math.abs(parseFloat(cache.normalized[j][c])),mx=Math.max(mx,isNaN(col)?0:col);dir="boolean"==typeof tc.string[tc.strings[c]]?(0===order?1:-1)*(tc.string[tc.strings[c]]?-1:1):tc.strings[c]&&tc.string[tc.strings[c]]||0}dynamicExp+="var "+e+" = sort"+s+"(table,a["+c+"],b["+c+"],"+c+","+mx+","+dir+"); ",dynamicExp+="if ("+e+") { return "+e+"; } ",dynamicExp+="else { "}for(orgOrderCol=cache.normalized&&cache.normalized[0]?cache.normalized[0].length-1:0,dynamicExp+="return a["+orgOrderCol+"]-b["+orgOrderCol+"];",i=0;i<l;i++)dynamicExp+="}; ";dynamicExp+="return 0; ",dynamicExp+="}; ",eval(dynamicExp),cache.normalized.sort(sortWrapper)}tc.debug&&benchmark("Sorting on "+sortList.toString()+" and dir "+order+" time",sortTime)}function sortText(e,t,r,o){if(t===r)return 0;var a,n,i,s,c,d,l,u,f=e.config,p=f.string[f.empties[o]||f.emptyTo],h=$.tablesorterEditor.regex;if(""===t&&0!==p)return"boolean"==typeof p?p?-1:1:-p||-1;if(""===r&&0!==p)return"boolean"==typeof p?p?1:-1:p||1;if("function"==typeof f.textSorter)return f.textSorter(t,r,e,o);if(a=t.replace(h[0],"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),i=r.replace(h[0],"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),n=parseInt(t.match(h[2]))||1!==a.length&&t.match(h[1])&&Date.parse(t),s=parseInt(r.match(h[2]))||n&&r.match(h[1])&&Date.parse(r)||null){if(n<s)return-1;if(n>s)return 1}for(u=Math.max(a.length,i.length),l=0;l<u;l++){if(c=!(a[l]||"").match(h[3])&&parseFloat(a[l])||a[l]||0,d=!(i[l]||"").match(h[3])&&parseFloat(i[l])||i[l]||0,isNaN(c)!==isNaN(d))return isNaN(c)?1:-1;if(_typeof(c)!==_typeof(d)&&(c+="",d+=""),c<d)return-1;if(c>d)return 1}return 0}function sortTextDesc(e,t,r,o){if(t===r)return 0;var a=e.config,n=a.string[a.empties[o]||a.emptyTo];return""===t&&0!==n?"boolean"==typeof n?n?-1:1:n||1:""===r&&0!==n?"boolean"==typeof n?n?1:-1:-n||-1:"function"==typeof a.textSorter?a.textSorter(r,t,e,o):sortText(e,r,t)}function getTextValue(e,t,r){if(t){var o,a=e.length,n=t+r;for(o=0;o<a;o++)n+=e.charCodeAt(o);return r*n}return 0}function sortNumeric(e,t,r,o,a,n){if(t===r)return 0;var i=e.config,s=i.string[i.empties[o]||i.emptyTo];return""===t&&0!==s?"boolean"==typeof s?s?-1:1:-s||-1:""===r&&0!==s?"boolean"==typeof s?s?1:-1:s||1:(isNaN(t)&&(t=getTextValue(t,a,n)),isNaN(r)&&(r=getTextValue(r,a,n)),t-r)}function sortNumericDesc(e,t,r,o,a,n){if(t===r)return 0;var i=e.config,s=i.string[i.empties[o]||i.emptyTo];return""===t&&0!==s?"boolean"==typeof s?s?-1:1:s||1:""===r&&0!==s?"boolean"==typeof s?s?1:-1:-s||-1:(isNaN(t)&&(t=getTextValue(t,a,n)),isNaN(r)&&(r=getTextValue(r,a,n)),r-t)}function checkResort(e,t,r){var o=e[0];!1!==t?e.trigger("sorton",[o.config.sortList,function(){e.trigger("updateComplete"),"function"==typeof r&&r(o)}]):(e.trigger("updateComplete"),"function"==typeof r&&r(o))}this.defaults={widthFixed:!1,cancelSelection:!0,dateFormat:"mmddyyyy",sortMultiSortKey:"shiftKey",usNumberFormat:!0,delayInit:!1,headers:{},ignoreCase:!1,sortForce:null,sortList:[],sortAppend:null,sortInitialOrder:"asc",sortLocaleCompare:!1,sortReset:!1,sortRestart:!1,emptyTo:"bottom",stringTo:"max",textExtraction:"simple",textSorter:function(e,t){return e.localeCompare(t)},widgets:[],widgetOptions:{zebra:["even","odd"]},initWidgets:!0,initialized:null,onRenderHeader:null,tableClass:"tablesorter",cssAsc:"tablesorter-headerSortUp",cssChildRow:"expand-child",cssDesc:"tablesorter-headerSortDown",cssHeader:"tablesorter-header",cssInfoBlock:"tablesorter-infoOnly",selectorHeaders:"tr:has(td,th):first td, tr:has(td,th):first th",selectorRemove:"tr.remove-me",debug:!1,headerList:[],empties:{},strings:{},parsers:[]},this.benchmark=benchmark,this.hasInitialized=!1,this.construct=function(e){return this.each((function(){if(0!==this.tBodies.length){var t,r,o,a,n,i,s,c,d,l,u=$.metadata;this.config={},(o=$.extend(!0,this.config,$.tablesorterEditor.defaults,e)).debug&&$.data(this,"startoveralltimer",new Date),r=$(this).addClass(o.tableClass),$.data(this,"tablesorter",o),o.supportsTextContent="x"===$("<span>x</span>")[0].textContent,o.string={max:1,min:-1,"max+":1,"max-":-1,zero:0,none:0,null:0,top:!0,bottom:!1},t=buildHeaders(this),o.parsers=buildParserCache(this,t),o.delayInit||buildCache(this),fixColumnWidth(this),t.bind("mousedown.tablesorter mouseup.tablesorter",(function(e,u){if(e.ctrlKey||e.metaKey){if("mousedown"===e.type)return l=(new Date).getTime(),!o.cancelSelection;if(!0!==u&&(new Date).getTime()-l>500)return!1;if(o.delayInit&&!o.cache&&buildCache(r[0]),!this.sortDisabled){if(r.trigger("sortStart",r[0]),$(this),i=!e[o.sortMultiSortKey],this.count=(this.count+1)%(o.sortReset?3:2),o.sortRestart&&(a=this,t.each((function(){this===a||!i&&$(this).is("."+o.cssDesc+",."+o.cssAsc)||(this.count=-1)}))),a=this.column,i){if(o.sortList=[],null!==o.sortForce)for(s=o.sortForce,n=0;n<s.length;n++)s[n][0]!==a&&o.sortList.push(s[n]);if((d=this.order[this.count])<2&&(o.sortList.push([a,d]),this.colSpan>1))for(n=1;n<this.colSpan;n++)o.sortList.push([a+n,d])}else if(isValueInArray(a,o.sortList))for(n=0;n<o.sortList.length;n++)c=o.sortList[n],d=o.headerList[c[0]],c[0]===a&&(c[1]=d.order[d.count],2===c[1]&&(o.sortList.splice(n,1),d.count=-1));else if((d=this.order[this.count])<2&&(o.sortList.push([a,d]),this.colSpan>1))for(n=1;n<this.colSpan;n++)o.sortList.push([a+n,d]);if(null!==o.sortAppend)for(s=o.sortAppend,n=0;n<s.length;n++)s[n][0]!==a&&o.sortList.push(s[n]);return r.trigger("sortBegin",r[0]),setHeadersCss(r[0],t,o.sortList),multisort(r[0],o.sortList),appendToTable(r[0]),!1}}})),o.cancelSelection&&t.each((function(){this.onselectstart=function(){return!1}})),r.bind("update",(function(e,a,n){$(o.selectorRemove,this).remove(),o.parsers=buildParserCache(this,t),buildCache(this),checkResort(r,a,n)})).bind("updateCell",(function(e,t,a,n){var i,s=this,c=$(this).find("tbody"),d=c.index($(t).closest("tbody"));i=[c.eq(d).find("tr").index($(t).closest("tr")),t.cellIndex],s.config.cache[d].normalized[i[0]][i[1]]=o.parsers[i[1]].format(getElementText(s,t,i[1]),s,t,i[1]),checkResort(r,a,n)})).bind("addRows",(function(e,t,a,i){var s,c=t.filter("tr").length,d=[],l=t[0].cells.length,u=$(this).find("tbody").index(t.closest("tbody"));for(s=0;s<c;s++){for(n=0;n<l;n++)d[n]=o.parsers[n].format(getElementText(this,t[s].cells[n],n),this,t[s].cells[n],n);d.push(o.cache[u].row.length),o.cache[u].row.push([t[s]]),o.cache[u].normalized.push(d),d=[]}checkResort(r,a,i)})).bind("sorton",(function(e,r,a,n){$(this).trigger("sortStart",this);var i=o.headerList.length;o.sortList=[],$.each(r,(function(e,t){t[0]<i&&o.sortList.push(r[e])})),updateHeaderSortCount(this,o.sortList),setHeadersCss(this,t,o.sortList),multisort(this,o.sortList),appendToTable(this,n),"function"==typeof a&&a(this)})).bind("appendCache",(function(e,t){appendToTable(this,t)})).bind("applyWidgetId",(function(e,t){getWidgetById(t).format(this)})).bind("applyWidgets",(function(e,t){applyWidget(this,t)})).bind("destroy",(function(e,t){$.tablesorterEditor.destroy(this,t)})),r.data()&&void 0!==r.data().sortlist?o.sortList=r.data().sortlist:u&&r.metadata()&&r.metadata().sortlist&&(o.sortList=r.metadata().sortlist),applyWidget(this,!0),o.sortList.length>0?r.trigger("sorton",[o.sortList,{},!o.initWidgets]):o.initWidgets&&applyWidget(this),this.hasInitialized=!0,o.debug&&$.tablesorterEditor.benchmark("Overall initialization time",$.data(this,"startoveralltimer")),r.trigger("tablesorter-initialized",this),"function"==typeof o.initialized&&o.initialized(this)}}))},this.destroy=function(e,t){var r=$(e),o=e.config;r.find("thead:first .tablesorter-resizer").remove(),r.unbind("update updateCell addRows sorton appendCache applyWidgetId applyWidgets destroy mouseup mouseleave").find(o.selectorHeaders).unbind("click mousedown mousemove mouseup").removeClass(o.cssHeader+" "+o.cssAsc+" "+o.cssDesc),!1!==t&&r.removeClass(o.tableClass)},this.addParser=function(e){var t,r=parsers.length,o=!0;for(t=0;t<r;t++)parsers[t].id.toLowerCase()===e.id.toLowerCase()&&(o=!1);o&&parsers.push(e)},this.addWidget=function(e){widgets.push(e)},this.formatFloat=function(e,t){if("string"!=typeof e||""===e)return e;e=!1!==t.config.usNumberFormat?e.replace(/,/g,""):e.replace(/[\s|\.]/g,"").replace(/,/g,"."),/^\s*\([.\d]+\)/.test(e)&&(e=e.replace(/^\s*\(/,"-").replace(/\)/,""));var r=parseFloat(e);return isNaN(r)?$.trim(e):r},this.isDigit=function(e){return/^[\-+(]?\d+[)]?$/.test(e.replace(/[,.'\s]/g,""))},this.regex=[/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,/^0x[0-9a-f]+$/i,/^0/],this.characterEquivalents={a:"áàâãä",A:"ÁÀÂÃÄ",c:"ç",C:"Ç",e:"éèêë",E:"ÉÈÊË",i:"íìİîï",I:"ÍÌİÎÏ",o:"óòôõö",O:"ÓÒÔÕÖ",S:"ß",u:"úùûü",U:"ÚÙÛÜ"},this.replaceAccents=function(e){var t,r="[",o=this.characterEquivalents;if(!this.characterRegex){for(t in this.characterRegexArray={},o)"string"==typeof t&&(r+=o[t],this.characterRegexArray[t]=new RegExp("["+o[t]+"]","g"));this.characterRegex=new RegExp(r+"]")}if(this.characterRegex.test(e))for(t in o)"string"==typeof t&&(e=e.replace(this.characterRegexArray[t],t));return e},this.getData=function(e,t,r){var o,a,n="",i=$(e);return i.length?(o=!!$.metadata&&i.metadata(),a=" "+(i.attr("class")||""),!i.data()||void 0===i.data(r)&&void 0===i.data(r.toLowerCase())?o&&void 0!==o[r]?n+=o[r]:t&&void 0!==t[r]?n+=t[r]:a&&a.match(" "+r+"-")&&(n=a.match(new RegExp(" "+r+"-(\\w+)"))[1]||""):n+=i.data(r)||i.data(r.toLowerCase()),$.trim(n)):""},this.clearTableBody=function(e){$(e.tBodies).filter(":not(."+e.config.cssInfoBlock+")").empty()}}})();var ts=$.tablesorterEditor;$.fn.extend({tablesorterEditor:ts.construct}),ts.addParser({id:"text",is:function(e,t,r){return!0},format:function(e,t,r,o){var a=t.config;return e=$.trim(a.ignoreCase?e.toLocaleLowerCase():e),a.sortLocaleCompare?ts.replaceAccents(e):e},type:"text"}),ts.addParser({id:"currency",is:function(e){return/^\(?[\u00a3$\u20ac\u00a4\u00a5\u00a2?.]\d+/.test(e)},format:function(e,t){return ts.formatFloat(e.replace(/[^\w,. \-()]/g,""),t)},type:"numeric"}),ts.addParser({id:"ipAddress",is:function(e){return/^\d{2,3}[\.]\d{2,3}[\.]\d{1,3}[\.]\d{1,3}$/.test(e)},format:function(e,t){var r,o,a=e.split("."),n="",i=a.length;for(r=0;r<i;r++)2===(o=a[r]).length?n+="0"+o:n+=o;return ts.formatFloat(n,t)},type:"numeric"}),ts.addParser({id:"url",is:function(e){return/^(https?|ftp|file):\/\//.test(e)},format:function(e){return $.trim(e.replace(/(https?|ftp|file):\/\//,""))},type:"text"}),ts.addParser({id:"isoDate",is:function(e){return/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(e)},format:function(e,t){return ts.formatFloat(""!==e&&new Date(e.replace(/-/g,"/")).getTime()||"",t)},type:"numeric"}),ts.addParser({id:"percent",is:function(e){return/\d%\)?$/.test(e)},format:function(e,t){return ts.formatFloat(e.replace(/%/g,""),t)},type:"numeric"}),ts.addParser({id:"usLongDate",is:function(e){return e.match(/^[A-Za-z]{3,10}\.? [0-9]{1,2}, ([0-9]{4}|'?[0-9]{2}) (([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(AM|PM)))$/)},format:function(e,t){return ts.formatFloat(new Date(e).getTime()||"",t)},type:"numeric"}),ts.addParser({id:"date",is:function(e,t){try{return TableUtils.parseDate(e,t.config.dateFormat,t.config.locale),!0}catch(e){return!1}},format:function(e,t){try{return TableUtils.parseDate(e,t.config.dateFormat,t.config.locale).getTime()}catch(e){return""}},type:"numeric"}),ts.addParser({id:"shortDate",is:function(e){return/^(\d{2}|\d{4})[\/\-\,\.\s+]\d{2}[\/\-\.\,\s+](\d{2}|\d{4})$/.test(e)},format:function(e,t,r,o){var a=t.config,n=a.headerList[o],i=n.shortDateFormat;return void 0===i&&(i=n.shortDateFormat=ts.getData(n,a.headers[o],"dateFormat")||a.dateFormat),e=e.replace(/\s+/g," ").replace(/[\-|\.|\,]/g,"/"),"mmddyyyy"===i?e=e.replace(/(\d{1,2})[\/\s](\d{1,2})[\/\s](\d{4})/,"$3/$1/$2"):"ddmmyyyy"===i?e=e.replace(/(\d{1,2})[\/\s](\d{1,2})[\/\s](\d{4})/,"$3/$2/$1"):"yyyymmdd"===i&&(e=e.replace(/(\d{4})[\/\s](\d{1,2})[\/\s](\d{1,2})/,"$1/$2/$3")),ts.formatFloat(new Date(e).getTime()||"",t)},type:"numeric"}),ts.addParser({id:"time",is:function(e){return/^(([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(am|pm)))$/.test(e)},format:function(e,t){return ts.formatFloat(new Date("2000/01/01 "+e).getTime()||"",t)},type:"numeric"}),ts.addParser({id:"digit",is:function(e){return ts.isDigit(e)},format:function(e,t){return ts.formatFloat(e.replace(/[^\w,. \-()]/g,""),t)},type:"numeric"}),ts.addParser({id:"metadata",is:function(e){return!1},format:function(e,t,r){var o=t.config,a=o.parserMetadataName?o.parserMetadataName:"sortValue";return $(r).metadata()[a]},type:"numeric"}),ts.addWidget({id:"zebra",format:function(e){var t,r,o,a,n,i,s,c=e.config,d=new RegExp(c.cssChildRow,"i"),l=$(e).children("tbody:not(."+c.cssInfoBlock+")"),u=["even","odd"];for(u=c.widgetZebra&&c.hasOwnProperty("css")?c.widgetZebra.css:c.widgetOptions&&c.widgetOptions.hasOwnProperty("zebra")?c.widgetOptions.zebra:u,c.debug&&(i=new Date),s=0;s<l.length;s++)(t=$(l[s])).children("tr").length>1&&(a=0,r=t.find("tr:visible"),t.addClass("tablesorter-hidden"),r.each((function(){o=$(this),d.test(this.className)||a++,n=a%2==0,o.removeClass(u[n?1:0]).addClass(u[n?0:1])})),t.removeClass("tablesorter-hidden"));c.debug&&ts.benchmark("Applying Zebra widget",i)}})}(jQuery)},47521:function(e,t,r){"use strict";r.r(t);r(18758);var o=r(36845);!function(e){try{AJS.bind("init.rte",(function(){function t(t,r){Confluence.Editor.tableToolbar?Confluence.Editor.tableToolbar.Buttons.splice(Confluence.Editor.tableToolbar.Buttons.length-r,0,t):e(document).bind("createContextToolbarRow.Toolbar.tf",(function(){var o=e(tinymce.activeEditor.plugins.customtoolbar.getToolbarRow());if(o.length){e(document).unbind("createContextToolbarRow.Toolbar.tf");var a=o.children();a.eq(a.length-r-1).after(t.render())}}))}var r=function(){var t=e(tinymce.activeEditor.selection.getNode());return t.is("table")||(t=t.parents("table").eq(0)),tinymce.activeEditor.selection.select(t[0]),t},a=function(t){if(!e("#rte-toolbar-row-default").is(".disabled")){var o,a=r(),n='<table class="wysiwyg-macro" data-macro-name="table-filter" data-macro-parameters="" data-macro-schema-version="1" data-macro-body-type="RICH_TEXT"><tbody><tr><td class="wysiwyg-macro-body">'+AJS.Rte.getEditor().serializer.serialize(a.clone()[0],{forced_root_block:!1})+"</td></tr></tbody></table>";e.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:Confluence.getContextPath()+"/rest/tinymce/1/macro/definition",async:!1,data:e.toJSON({contentId:AJS.params.contentId||AJS.Meta.get("content-id")||AJS.params.pageId||AJS.Meta.get("page-id"),macroHtml:n}),dataType:"text",success:function(t){o=e.secureEvalJSON(t)}}),tinymce.confluence.macrobrowser.macroBrowserToolbarButtonClicked({presetMacroName:t,selectedMacro:o})}};t(new Confluence.Editor.Toolbar.Components.Group([new Confluence.Editor.Toolbar.Components.Button({text:"Filter table data",iconClass:"table-filter-insert",click:function(){a("table-filter")}}),new Confluence.Editor.Toolbar.Components.Button({text:"Create a pivot table",iconClass:"pivot-table-insert",click:function(){a("pivot-table")}}),new Confluence.Editor.Toolbar.Components.Button({text:"Create a chart from data series",iconClass:"table-chart-insert",click:function(){a("table-chart")}}),new Confluence.Editor.Toolbar.Components.Button({text:"Join, merge and query tables",iconClass:"table-joiner-insert",click:function(){a("table-joiner")}})]),2);var n=e("#wysiwygTextarea_ifr")[0].contentDocument;t(new Confluence.Editor.Toolbar.Components.Group([new Confluence.Editor.Toolbar.Components.Button({text:"Copy table",iconClass:"tf-copy-table",click:function(){if(!e("#rte-toolbar-row-default").is(".disabled")){tinymce.activeEditor.focus();var t=tinymce.activeEditor.selection.getRng(),o=r().addClass("tf-copy-table");n.execCommand("copy"),tinymce.activeEditor.selection.setRng(t),o.removeClass("tf-copy-table")}}})]),2),AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("unwrap-tf",(function(t,r){o.default.gaUnwrapMacro(),AJS.Rte.BookmarkManager.storeBookmark();var a=e(r);AJS.trigger("tf-unwrap",a.attr("id")),AJS.Rte.getEditor().selection.select(r),AJS.Rte.getEditor().execCommand("mceInsertContent",!1,a.find(".wysiwyg-macro-body").html()),AJS.Rte.BookmarkManager.restoreBookmark()}))}))}catch(e){}}(jQuery)}},__webpack_module_cache__={};function __webpack_require__(e){if(__webpack_module_cache__[e])return __webpack_module_cache__[e].exports;var t=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(t.exports,t,t.exports,__webpack_require__),t.loaded=!0,t.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.amdD=function(){throw new Error("define cannot be used indirect")},__webpack_require__.amdO={},__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=function(e,t){for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){var e={101:0},t=[[47521,248,961,266]],r=function(){};function o(){for(var r,o=0;o<t.length;o++){for(var a=t[o],n=!0,i=1;i<a.length;i++){var s=a[i];0!==e[s]&&(n=!1)}n&&(t.splice(o--,1),r=__webpack_require__(__webpack_require__.s=a[0]))}return 0===t.length&&(__webpack_require__.x(),__webpack_require__.x=function(){}),r}__webpack_require__.x=function(){__webpack_require__.x=function(){},n=n.slice();for(var e=0;e<n.length;e++)a(n[e]);return(r=o)()};var a=function(o){for(var a,n,s=o[0],c=o[1],d=o[2],l=o[3],u=0,f=[];u<s.length;u++)n=s[u],__webpack_require__.o(e,n)&&e[n]&&f.push(e[n][0]),e[n]=0;for(a in c)__webpack_require__.o(c,a)&&(__webpack_require__.m[a]=c[a]);for(d&&d(__webpack_require__),i(o);f.length;)f.shift()();return l&&t.push.apply(t,l),r()},n=self.webpackChunk=self.webpackChunk||[],i=n.push.bind(n);n.push=a}(),__webpack_require__.x()})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:ff8c1cbbceb8d9ca974be636ec146611', location = 'build/944.js' */
(self.webpackChunk=self.webpackChunk||[]).push([[944],{93880:function(e){if(window.TableFilterTemplate=window.TableFilterTemplate||{},void 0===t)var t={};t.totalRow=function(e,t){for(var a='<tr class="total-row synchrony-exclude">',l=e.length,i=0;i<l;i++)a+=1==e.numbering&&0==i?'<td class="confluenceTd" '+(e.isFireFox?"":'contenteditable="false"')+"></td>":'<th class="confluenceTh '+(e.totals[i]?"number":"")+" "+soy.$$escapeHtml(e.classes[i])+'" '+(e.isFireFox?"":'contenteditable="false"')+">"+(e.totals[i]?soy.$$escapeHtml(e.totals[i].total):i-e.numbering==0?e.title?soy.$$escapeHtml(e.title):soy.$$escapeHtml("Total\u200b"):"")+"</th>";return a+="</tr>"},goog.DEBUG&&(t.totalRow.soyTemplateName="TableFilterTemplate.totalRow"),t.totalCol=function(e,t){return'<th class="total-col synchrony-exclude confluenceTh '+(e.rowNumber>0?"number":"")+'" contenteditable="false"><p></p></th>'},goog.DEBUG&&(t.totalCol.soyTemplateName="TableFilterTemplate.totalCol"),t.labelChanger=function(e,t){return'<input class="tf-label-changer text" onfocus="this.select();" type="text" value="'+soy.$$escapeHtml(e.value)+'" style="width: '+soy.$$escapeHtml(e.width)+';" title="'+soy.$$escapeHtml("Press the Enter button to change the filter label")+'">'},goog.DEBUG&&(t.labelChanger.soyTemplateName="TableFilterTemplate.labelChanger"),t.editorCloseButton=function(e,t){return'<div class="aui-buttons close"><button type="button" class="aui-button" data-tooltip="'+soy.$$escapeHtml("Close")+'" original-title=""><span class="icon icon-close aui-icon aui-icon-small aui-iconfont-close-dialog">'+soy.$$escapeHtml("Close")+"</span></button></div>"},goog.DEBUG&&(t.editorCloseButton.soyTemplateName="TableFilterTemplate.editorCloseButton"),t.addFilterDialog=function(e,t){var a='<form class="aui top-label inline-dialog-form tf-add-filter-dialog" style="padding: 10px">';if(e.filters.length>0||e.globalfilter||e.columnhider){for(var l=e.filters,i=l.length,r=0;r<i;r++){var s=l[r];a+='<div class="'+soy.$$escapeHtml(s.type)+' tf-add-filter-column"><label for="'+soy.$$escapeHtml(s.type)+'">'+soy.$$escapeHtml("Filter Column")+'</label><select class="select '+soy.$$escapeHtml(s.type)+'" name="'+soy.$$escapeHtml(s.type)+'">';for(var n=s.columns,o=n.length,c=0;c<o;c++){var d=n[c];a+='<option value="'+soy.$$escapeHtml(d)+'">'+soy.$$escapeHtml(d)+"</option>"}a+="</select></div>"}a+='<div><label for="filter-type">'+soy.$$escapeHtml("Filter Type")+'</label><select class="select filter-type" name="filter-type">';for(var f=e.filters,p=f.length,u=0;u<p;u++){var m=f[u];a+='<option value="'+soy.$$escapeHtml(m.type)+'" title="'+soy.$$escapeHtml(m.desc)+'">'+soy.$$escapeHtml(m.name)+"</option>"}a+=(e.globalfilter?'<option value="globalfilter" title="'+soy.$$escapeHtml("Enter custom text query or regular expression to filter data in the whole table")+'">'+soy.$$escapeHtml("Filter whole table")+"</option>":"")+(e.columnhider?'<option value="columnhider" title="'+soy.$$escapeHtml("Select table columns to hide")+'">'+soy.$$escapeHtml("Hide Columns")+"</option>":"")+'</select></div><div class="date-format-param"><label for="date-format-input">'+soy.$$escapeHtml("Date format")+'</label><input class="date-format-input text" type="text" value="'+soy.$$escapeHtml(e.dateFormat)+'"></div><div class="buttons-container"><div class="buttons"><input class="aui-button" type="button" value="'+soy.$$escapeHtml("Add filter")+'" id="save"/><a class="cancel" id="cancel">'+soy.$$escapeHtml("Cancel")+"</a></div></div>"}else a+='<div class="aui-message info aui-message-info"><p>'+soy.$$escapeHtml("Filters are not available")+'</p></div><div class="buttons-container"><div class="buttons"><a class="cancel" id="cancel">'+soy.$$escapeHtml("Cancel")+"</a></div></div>";return a+="</form>"},goog.DEBUG&&(t.addFilterDialog.soyTemplateName="TableFilterTemplate.addFilterDialog"),t.changeSettingsDialog=function(e,t){return'<form class="aui top-label inline-dialog-form" style="padding: 10px" action="javascript: void(0)"><div class="change-settings-dialog-parameter"><label for="tf-cs-dialog-datepattern">'+soy.$$escapeHtml("Date format")+'</label><input type="text" class="text" id="tf-cs-dialog-datepattern" value="'+soy.$$escapeHtml(e.datepattern)+'"></div><div class="buttons-container"><div class="buttons"><input class="aui-button" type="button" value="'+soy.$$escapeHtml("Update")+'" id="tf-cs-save"/><a class="cancel" id="tf-cs-cancel">'+soy.$$escapeHtml("Cancel")+"</a></div></div></form>"},goog.DEBUG&&(t.changeSettingsDialog.soyTemplateName="TableFilterTemplate.changeSettingsDialog"),t.filter=function(e,a){return"selectfilter"==e.type?'<div class="filter-container selectfilter-element sortable"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(e.column)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><select class="select" name="'+soy.$$escapeHtml(e.column)+'" style="width: 150px;" multiple data-width="150px"></select>'+t.crossIcon(null)+"</div>":"userfilter"==e.type?'<div class="filter-container userfilter-element sortable input"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(e.column)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><div class="tf-resizeable" style="width: 150px;"><input class="user-filter text" type="text" name="'+soy.$$escapeHtml(e.column)+'" style="width: 100%; max-width: none;" placeholder="'+soy.$$escapeHtml("Start typing...\u200b")+'" data-width="150px"/></div>'+t.crossIcon(null)+"</div>":"numberfilter"==e.type?'<div class="filter-container numberfilter-element sortable"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(e.column)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><div class="range numbers" name="'+soy.$$escapeHtml(e.column)+'">'+soy.$$escapeHtml("from")+'<input class="number from text" type="text" name="'+soy.$$escapeHtml(e.column)+'" style="width: 90px;" placeholder="'+soy.$$escapeHtml("Type value")+'"/>'+soy.$$escapeHtml("to")+'<input class="number to text" type="text" name="'+soy.$$escapeHtml(e.column)+'" style="width: 90px;" placeholder="'+soy.$$escapeHtml("Type value")+'"/></div>'+t.crossIcon(null)+"</div>":"datefilter"==e.type?'<div class="filter-container datefilter-element sortable"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(e.column)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><div class="range dates" name="'+soy.$$escapeHtml(e.column)+'">'+soy.$$escapeHtml("from")+'<input class="date from text" type="text" name="'+soy.$$escapeHtml(e.column)+'" style="width: 93px;" autocomplete="off" placeholder="'+soy.$$escapeHtml("Pick date")+'"/>'+soy.$$escapeHtml("to")+'<input class="date to text" type="text" name="'+soy.$$escapeHtml(e.column)+'" style="width: 93px;" autocomplete="off" placeholder="'+soy.$$escapeHtml("Pick date")+'"/></div>'+t.crossIcon(null)+"</div>":"globalfilter"==e.type?'<div class="filter-container globalfilter-element sortable input"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml("Filter whole table")+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><div class="tf-resizeable" style="width: 150px;"><input class="global-filter text" type="text" style="width: 100%; max-width: none;" placeholder="'+soy.$$escapeHtml("Start typing...\u200b")+'" data-width="150px"/></div></div>':"columnhider"==e.type?'<div class="filter-container columnhider-element sortable"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml("Hide columns")+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><select class="column-select" style="width: 150px;" multiple data-width="150px"></select>'+t.crossIcon(null)+"</div>":"iconfilter"==e.type?'<div class="filter-container iconfilter-element sortable"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(e.column)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><select class="icon-select" name="'+soy.$$escapeHtml(e.column)+'" style="width: 150px;" multiple data-width="150px" data-html="true"></select>'+t.crossIcon(null)+"</div>":""},goog.DEBUG&&(t.filter.soyTemplateName="TableFilterTemplate.filter"),t.panel=function(e,a){return'<div class="tablefilter-outer-wrapper'+(e.isCloud?" tf-cloud-macro":"")+" "+(e.hideLabels?"hide-labels":"")+" "+("true"==e.hidePane?"hide-pane":"")+(e.hideControls?" hide-controls":"")+'" data-id="'+soy.$$escapeHtml(e.macroId)+'" data-pageid="'+soy.$$escapeHtml(e.pageId)+'" data-export-hash="'+soy.$$escapeHtml(e.exportHash)+'" data-sessionid="'+soy.$$escapeHtml(e.sessionId)+'">'+(e.isEmail?"":(e.isCloud?'<div id="tf-preview-tutorial" class="preview-tutorial"><h2>'+soy.$$escapeHtml("Welcome to Table Filter!")+"</h2><h3>"+soy.$$escapeHtml("To start filtering:")+'</h3><ol type="1"><li>'+soy.$$filterNoAutoescape("Click \u003cdiv class=\u0022tutorial-img img-insert-btn\u0022\u003e\u003c/div\u003e to add the macro to the page")+"</li><li>"+soy.$$escapeHtml("Place one or multiple tables (including macros outputting tables) within the macro body")+"</li><li>"+soy.$$escapeHtml("Edit the macro in the page view or edit mode")+'</li></ol><div class="tf-tutorial-img tutorial-img"></div></div>':"")+("Table header"!=e.hidePane||e.isEditor?'<div id="comboBoxDiv-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.sessionId)+'" class="tableFilterCbStyle"><div class="lockDisabled not-empty"><form class="aui tf-form" name="inlinecommentform" action="javascript: void(0)"><div class="filter-container filter-icon filter-logo default '+(e.fd?"tf-fd":"")+'" title="'+soy.$$escapeHtml(AJS.format("Nothing filtered. Showing {0} rows",0))+'"></div><div class="filter-buttons-container"><div class="tf-menu-buttons aui-toolbar2" role="toolbar"><div class="aui-toolbar2-inner"><div class="aui-toolbar2-primary"><div class="tf-btn-container"><div id="tf-settings-row-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.sessionId)+'" class="tf-btn-row"><div class="tf-settings-wrapper"><button id=\'filter-settings-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.sessionId)+'\' class="filter-settings aui-button aui-button-subtle aui-dropdown2-trigger" aria-owns="filter-menu-view-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.pageId)+"-"+soy.$$escapeHtml(e.sessionId)+'" aria-haspopup="true" data-container="" resolved="" aria-expanded="false"><span class="aui-icon aui-icon-small aui-iconfont-configure"></span><span class="tfac-unsaved">*</span></button>'+t.menu({macroId:e.macroId,pageId:e.pageId,sessionId:e.sessionId,editable:e.editable,disableSave:e.disableSave,isCloud:e.isCloud,inHeader:!1,isMacroViewContext:e.isMacroViewContext})+"</div></div></div></div></div></div></div>"+t.filters(e)+'<div class="filter-container show-n-rows-only-message"><label>'+soy.$$escapeHtml(AJS.format("Showing the first {0} rows",e.showNRowsifNotFiltered))+'</label></div><div class="filter-container empty-message"><label>'+soy.$$filterNoAutoescape("Start \u003ca class=\u0022tf-add-start\u0022\u003eadding filters\u003c/a\u003e in the filter tools menu.")+'</label></div></form></div><div class="lockEnabled"><div class="filter-container filter-icon filter-logo default" title="'+soy.$$escapeHtml(AJS.format("Nothing filtered. Showing {0} rows",0))+'"></div><div class="lockPosition"><div class="filter-container"><label class="hideble">'+soy.$$escapeHtml("The filter is disabled at the moment.")+'</label></div><div class="tf-menu-buttons aui-toolbar2" role="toolbar"><div class="aui-toolbar2-inner"><div class="aui-toolbar2-primary"><div class="tf-btn-container"><div class="tf-btn-row settings-row"><div class="tf-settings-wrapper"><button class="filter-settings aui-button aui-button-subtle aui-dropdown2-trigger" aria-owns="filter-menu-view-lock-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.pageId)+"-"+soy.$$escapeHtml(e.sessionId)+'"><span class="aui-icon aui-icon-small aui-iconfont-configure"></span></button><div id="filter-menu-view-lock-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.pageId)+"-"+soy.$$escapeHtml(e.sessionId)+'" class="aui-style-default aui-dropdown2 tfac-menu" style="display: none; z-index: 3001;"><div class="aui-dropdown2-section"><ul class="aui-list-truncate first"><li><a class="enableLock cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-successful-build"></span>'+soy.$$escapeHtml("Enable all filters")+'</a></li></ul></div><div class="aui-dropdown2-section"><ul class="aui-list-truncate"><li><a class="export-file-pdf cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-pdf"></span>'+soy.$$escapeHtml("Export to PDF")+'</a></li><li><a class="export-file-csv cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-table"></span>'+soy.$$escapeHtml("Export to CSV")+'</a></li><li><a class="export-file-doc cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-document"></span>'+soy.$$escapeHtml("Export to Word")+'</a></li></ul></div><div class="aui-dropdown2-section"><ul class="aui-list-truncate"><li><a target="_blank" href="https://docs.stiltsoft.com/display/TFAC/How+to+use+Table+filter+macro?from=tf-view"><span class="aui-icon aui-icon-small aui-iconfont-document-filled"></span>'+soy.$$escapeHtml("Documentation")+'</a></li><li><a target="_blank" href="https://docs.stiltsoft.com/display/public/TFAC/Table+Filter+and+Charts+6.3.0?from=tf-view"><span class="aui-icon aui-icon-small aui-iconfont-new-help"></span>'+soy.$$escapeHtml("What\u0027s new")+'</a></li><li><a target="_blank" class="tf-menu-star" href="https://www.surveygizmo.com/s3/3338736/Table-Filter-and-Charts-Survey?platform='+(e.isCloud?"cloud":"server")+'"><span class="aui-icon aui-icon-small aui-iconfont-star"></span>'+soy.$$escapeHtml("Rate our app")+'</a></li></ul></div></div></div></div></div></div></div></div></div></div><div class="filter-container no-table-message"><div class="aui-message info aui-message-info"><p>'+soy.$$escapeHtml("Oops, it seems that you need to place a table or a macro generating a table within the Table Filter macro.")+'</p></div></div><div class="filter-container waiting-for-table"><div class="aui-message info aui-message-info"><p>'+soy.$$escapeHtml("The table is being loaded. Please wait for a bit ...")+'<span class="aui-icon aui-icon-wait" style="margin-left: 5px"></span></p></div></div><div class="tf-hider-wrapper" title="'+soy.$$escapeHtml("Hide filtration pane")+'"><div class="tf-hider"><span class="tf-hide-show-icon"></span></div></div></div><div id="tf-shower-'+soy.$$escapeHtml(e.macroId)+'" class="tf-shower-wrapper" title="'+soy.$$escapeHtml("Show filtration pane")+'"><div class="tf-shower"><span class="tf-hide-show-icon"></span></div></div>':'<div class="tf-floating-btn-container"><button id=\'filter-settings-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.sessionId)+"' class=\"aui-button aui-button-compact aui-button-subtle filter-container filter-icon filter-logo default floating aui-dropdown2-trigger "+(e.fd?"tf-fd":"")+'" title="'+soy.$$escapeHtml(AJS.format("Nothing filtered. Showing {0} rows",0))+'" aria-owns="filter-menu-view-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.pageId)+"-"+soy.$$escapeHtml(e.sessionId)+'" aria-haspopup="true" aria-expanded="false"><span class="aui-icon aui-icon-small"></span><span class="tfac-unsaved">*</span></button></div>'+t.menu({macroId:e.macroId,pageId:e.pageId,sessionId:e.sessionId,editable:e.editable,disableSave:e.disableSave,isCloud:e.isCloud,inHeader:!0,isMacroViewContext:e.isMacroViewContext})+'<aui-inline-dialog id="comboBoxDiv-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.sessionId)+'" alignment="top center" class="tf-inline-filters wiki-content"><div class="tableFilterCbStyle"><form class="aui tf-form" name="inlinecommentform" action="javascript: void(0)">'+t.filters(e)+'</form></div></aui-inline-dialog><span data-aui-trigger aria-controls="comboBoxDiv-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.sessionId)+'" class="tf-inline-filter trigger" title="'+soy.$$escapeHtml("Filter column")+'"></span><span class="tf-inline-filter btn" title="'+soy.$$escapeHtml("Filter column")+'"></span>'))+(e.isEditor?"":'<div id="tf-table-'+soy.$$escapeHtml(e.macroId)+'" class="tablefilter-table-wrapper '+(e.isCloud?"tf-cloud-table "+soy.$$escapeHtml(e.hidePane):"")+'">'+soy.$$filterNoAutoescape(e.body)+"</div>")+"</div>"},goog.DEBUG&&(t.panel.soyTemplateName="TableFilterTemplate.panel"),t.filters=function(e,a){for(var l='<div class="sortable-container">',i=e.comboBoxes,r=i.length,s=0;s<r;s++){var n=i[s];l+='<div class="filter-container selectfilter-element sortable '+(n.inverse?"inverse":"")+'"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(n.label)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><select class="select '+(n.inverse?"inverse":"")+'" name="'+soy.$$escapeHtml(n.name)+'" style="width: '+soy.$$escapeHtml(n.columnWidth)+'px;" multiple data-width="'+soy.$$escapeHtml(n.columnWidth)+'px">';for(var o=n.options,c=o.length,d=0;d<c;d++){var f=o[d];l+='<option selected="selected"'+("-Empty-"==f?'class="tf-empty-option">'+soy.$$escapeHtml("-Empty-"):">"+soy.$$escapeHtml(f))+"</option>"}l+="</select>"+t.crossIcon(null)+"</div>"}for(var p=e.edits,u=p.length,m=0;m<u;m++){var h=p[m];l+='<div class="filter-container userfilter-element sortable input '+(h.inverse?"inverse":"")+'"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(h.label)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><div class="tf-resizeable" style="width: '+soy.$$escapeHtml(h.columnWidth)+'px;"><input class="user-filter text '+(h.inverse?"inverse":"")+'" type="text" name="'+soy.$$escapeHtml(h.name)+'" style="width: 100%; max-width: none;" value="'+soy.$$escapeHtml(h.defaultValue)+'" placeholder="'+soy.$$escapeHtml("Start typing...\u200b")+'" data-width="'+soy.$$escapeHtml(h.columnWidth)+'px"/></div>'+t.crossIcon(null)+"</div>"}for(var b=e.numberFilters,v=b.length,g=0;g<v;g++){var w=b[g];l+='<div class="filter-container numberfilter-element sortable '+(w.inverse?"inverse":"")+'"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(w.label)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><div class="range numbers" name="'+soy.$$escapeHtml(w.name)+'">'+soy.$$escapeHtml("from")+'<input class="number from text '+(w.inverse?"inverse":"")+'" type="text" name="'+soy.$$escapeHtml(w.name)+'" style="width: 90px;" value="'+soy.$$escapeHtml(w.defaultFromValue)+'" placeholder="'+soy.$$escapeHtml("Type value")+'"/>'+soy.$$escapeHtml("to")+'<input class="number to text '+(w.inverse?"inverse":"")+'" type="text" name="'+soy.$$escapeHtml(w.name)+'" style="width: 90px;" value="'+soy.$$escapeHtml(w.defaultToValue)+'" placeholder="'+soy.$$escapeHtml("Type value")+'"/></div>'+t.crossIcon(null)+"</div>"}for(var y=e.dateFilters,$=y.length,x=0;x<$;x++){var T=y[x];l+='<div class="filter-container datefilter-element sortable '+(T.inverse?"inverse":"")+'"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(T.label)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><div class="range dates" name="'+soy.$$escapeHtml(T.name)+'">'+soy.$$escapeHtml("from")+'<input class="date from text '+(T.inverse?"inverse":"")+'" type="text" autocomplete="off" name="'+soy.$$escapeHtml(T.name)+'" style="width: 93px;" value="'+soy.$$escapeHtml(T.defaultFromValue)+'" placeholder="'+soy.$$escapeHtml("Pick date")+'"/>'+soy.$$escapeHtml("to")+'<input class="date to text '+(T.inverse?"inverse":"")+'" type="text" autocomplete="off" name="'+soy.$$escapeHtml(T.name)+'" style="width: 93px;" value="'+soy.$$escapeHtml(T.defaultToValue)+'" placeholder="'+soy.$$escapeHtml("Pick date")+'"/></div>'+t.crossIcon(null)+"</div>"}for(var C=e.iconFilters,I=C.length,S=0;S<I;S++){var F=C[S];l+='<div class="filter-container iconfilter-element sortable '+(F.inverse?"inverse":"")+'"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(F.label)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><select class="icon-select '+(F.inverse?"inverse":"")+'" name="'+soy.$$escapeHtml(F.name)+'" style="width: '+soy.$$escapeHtml(F.columnWidth)+'px;" multiple data-width="'+soy.$$escapeHtml(F.columnWidth)+'px" data-html="true">';for(var k=F.options,H=k.length,A=0;A<H;A++){var D=k[A];l+='<option selected="selected"'+("-Empty-"==D?'class="tf-empty-option">'+soy.$$escapeHtml("-Empty-"):">"+soy.$$escapeHtml(D))+"</option>"}l+="</select>"+t.crossIcon(null)+"</div>"}if(l+=e.globalFilter?'<div class="filter-container globalfilter-element sortable input '+(e.globalFilter.inverse?"inverse":"")+'"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(e.globalFilter.label)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><div class="tf-resizeable" style="width: '+soy.$$escapeHtml(e.globalFilter.columnWidth)+'px;"><input class="global-filter text '+(e.globalFilter.inverse?"inverse":"")+'" type="text" style="width: 100%; max-width: none;" value="'+soy.$$escapeHtml(e.globalFilter.defaultValue)+'" placeholder="'+soy.$$escapeHtml("Start typing...\u200b")+'" data-width="'+soy.$$escapeHtml(e.globalFilter.columnWidth)+'px"/></div>'+t.crossIcon(null)+"</div>":"",e.hideColumns){l+='<div class="filter-container columnhider-element sortable '+(e.hideColumns.inverse?"inverse":"")+'"><label class="hideble"><span class="tf-label-name" title="'+soy.$$escapeHtml("Drag to reorder/remove the filter\nDouble-click to edit the filter label")+'">'+soy.$$escapeHtml(e.hideColumns.label)+'</span><span class="eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;=</span><span class="not-eq" title="'+soy.$$escapeHtml("Click to reverse the filter")+'">&nbsp;&ne;</span></label><select class="column-select '+(e.hideColumns.inverse?"inverse":"")+'" style="width: '+soy.$$escapeHtml(e.hideColumns.columnWidth)+'px;" multiple data-width="'+soy.$$escapeHtml(e.hideColumns.columnWidth)+'px">';for(var B=e.hideColumns.options,J=B.length,R=0;R<J;R++){var M=B[R];l+='<option selected="selected"'+("-Empty-"==M?'class="tf-empty-option">'+soy.$$escapeHtml("-Empty-"):">"+soy.$$escapeHtml(M))+"</option>"}l+="</select>"+t.crossIcon(null)+"</div>"}return l+="</div>"},goog.DEBUG&&(t.filters.soyTemplateName="TableFilterTemplate.filters"),t.menu=function(e,t){return'<div id="filter-menu-view-'+soy.$$escapeHtml(e.macroId)+"-"+soy.$$escapeHtml(e.pageId)+"-"+soy.$$escapeHtml(e.sessionId)+'" class="aui-style-default aui-dropdown2 tfac-menu" style="display: none; z-index: 3001;"><div class="aui-dropdown2-section"><ul class="aui-list-truncate first">'+(e.editable&&!e.disableSave?'<li><a class="filter-save cursor-pointer tf-disabled-link"><span class="aui-icon aui-icon-small aui-iconfont-check"></span>'+soy.$$escapeHtml("Save changes")+'<span class="tfac-unsaved">*</span></a></li>':"")+(e.inHeader?'<li><a class="show-filter cursor-pointer" data-filter-type="globalfilter"><span class="aui-icon aui-icon-small aui-iconfont-search"></span>'+soy.$$escapeHtml("Filter whole table")+'</a></li><li><a class="show-filter cursor-pointer" data-filter-type="columnhider"><span class="aui-icon aui-icon-small aui-iconfont-remove-column"></span>'+soy.$$escapeHtml("Hide columns")+"</a></li>":'<li><a class="filter-add cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-add"></span>'+soy.$$escapeHtml("Add filter")+"</a></li>")+'<li><a class="filter-reset cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-cross"></span>'+soy.$$escapeHtml("Reset all filters")+"</a></li>"+(e.inHeader?"":'<li><a class="disableLock cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-plan-disabled"></span>'+soy.$$escapeHtml("Disable all filters")+'</a></li><li><a class="filter-sort-reset cursor-pointer tf-disabled-link"><span class="aui-icon aui-icon-small aui-iconfont-refresh"></span>'+soy.$$escapeHtml("Reset column sorting")+'</a></li><li><a class="tf-change-settings cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-more"></span>'+soy.$$escapeHtml("Modify Settings")+"</a></li>")+'<li><a class="get-tf-url cursor-pointer" '+(e.isCloud?'style="display: none;"':"")+'><span class="aui-icon aui-icon-small aui-iconfont-copy"></span>'+soy.$$escapeHtml("Copy the filter URL")+"</a></li>"+(e.editable?'<li><a class="tf-remove" '+(e.isMacroViewContext?"":'style="display: none;"')+'><span class="aui-icon aui-icon-small aui-iconfont-trash"></span>'+soy.$$escapeHtml("Remove the macro")+"</a></li>":"")+'</ul></div><div class="aui-dropdown2-section"><ul class="aui-list-truncate"><li><a class="export-file-pdf cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-pdf"></span>'+soy.$$escapeHtml("Export to PDF")+'</a></li><li><a class="export-file-csv cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-table"></span>'+soy.$$escapeHtml("Export to CSV")+'</a></li><li><a class="export-file-doc cursor-pointer"><span class="aui-icon aui-icon-small aui-iconfont-document"></span>'+soy.$$escapeHtml("Export to Word")+'</a></li></ul></div><div class="aui-dropdown2-section"><ul class="aui-list-truncate"><li><a target="_blank" href="https://docs.stiltsoft.com/display/TFAC/How+to+use+Table+filter+macro?from=tf-view"><span class="aui-icon aui-icon-small aui-iconfont-document-filled"></span>'+soy.$$escapeHtml("Documentation")+'</a></li><li><a target="_blank" href="https://docs.stiltsoft.com/display/TFAC/Table+Filter+and+Charts+6.3.0?from=tf-view"><span class="aui-icon aui-icon-small aui-iconfont-new-help"></span>'+soy.$$escapeHtml("What\u0027s new")+'</a></li><li><a target="_blank" class="tf-menu-star" href="https://www.surveygizmo.com/s3/3338736/Table-Filter-and-Charts-Survey?platform='+(e.isCloud?"cloud":"server")+'"><span class="aui-icon aui-icon-small aui-iconfont-star"></span>'+soy.$$escapeHtml("Rate our app")+"</a></li></ul></div></div>"},goog.DEBUG&&(t.menu.soyTemplateName="TableFilterTemplate.menu"),t.fail=function(e,t){return'<div class="tablefilter-outer-wrapper error"><div class="tableFilterCbStyle"><div class="filter-container"><div class="aui-message warning aui-message-warning"><p>'+("no_table"==e.failureCause?soy.$$escapeHtml("Oops, it seems that you need to place a table or a macro generating a table within the Table Filter macro."):"license"==e.failureCause?soy.$$filterNoAutoescape(AJS.format("Table Filter Plugin license is not active, please \u003ca href=\u0022{0}/plugins/servlet/upm#manage/com.stiltsoft.confluence.plugin.tablefilter.tablefilter\u0022\u003egenerate a trial license or purchase\u003c/a\u003e the product.",e.contextPath)):"bad_request"==e.failureCause?soy.$$escapeHtml("Oops! We are sorry but the Table Filter macro cannot be previewed on Confluence page."):"no_params"==e.failureCause?soy.$$escapeHtml("Oops! It seems that the macro body is not reachable as the macro ID parameter is missing."):soy.$$escapeHtml("Oops! We are sorry but the current complex table cannot be filtered."))+'</p></div></div></div><div class="tablefilter-table-wrapper">'+soy.$$filterNoAutoescape(e.body)+"</div></div>"},goog.DEBUG&&(t.fail.soyTemplateName="TableFilterTemplate.fail"),t.crossIcon=function(e,t){return'<span class="aui-icon aui-icon-small aui-iconfont-cross" title="'+soy.$$escapeHtml("Clear filter")+'"></span>'},goog.DEBUG&&(t.crossIcon.soyTemplateName="TableFilterTemplate.crossIcon"),e.exports=t},96288:function(){$.fn.tableHeadFixer=function(e){return this.each((function(){t.call(this)}));function t(){var t=$.extend({},{head:!0,foot:!1,left:0,right:0,"z-index":1},e);function a(){if(t.head>0){var e=t.parent.scrollTop();t.headCells.forEach((function(t){t.style.top="".concat(e,"px")}))}if(t.left>0){var a=t.parent.scrollLeft();t.leftColumns.forEach((function(e){e.style.left="".concat(a,"px")}))}}function l(e,a){for(var l=t.left,r=0;r<l;r++){var s=e.children[r];if(s){var n=s.colSpan>1;n&&(r+=s.colSpan-1),s&&(!n||$(s).position().left+s.clientWidth<i())&&a(s)}}}function i(){return void 0===t.parentWidth&&(t.parentWidth=t.parent.width()),t.parentWidth}t.table=this,t.parent.bind("scroll.tf scroll-tf",a),t.head>0&&function(){for(var e=[],a=t.table.rows,l=0;l<t.head;l++){var i=a[l];if(i){var r=i.children;if(r.length)for(var s=0;s<r.length;s++){var n=r[s];n&&(n.classList.add("tf-floating"),n.classList.add("tf-float-head"),n.style.top=0,e.push(n))}else t.head++}}t.headCells=e}(),t.left>0&&function(){for(var e=t.table,a=[],i=e.rows,r=0;r<i.length;r++)l(i[r],(function(e){e.classList.add("tf-floating"),e.style.left=0,a.push(e)}));t.leftColumns=a}(),function(){if(t.head>0&&t.left>0)for(var e=t.table.rows,a=0;a<t.head;a++){var l=e[a];if(l)for(var i=l.children,r=0;r<t.left;r++)i[r]&&(i[r].style["z-index"]=3)}}(),$(window).resize(a)}}},1143:function(e,t,a){"use strict";a.r(t);a(96288);var l=a(45546),i=a(22166),r=a.n(i),s=a(14978),n=a(22017),o=a(16951),c=a.n(o),d=a(14731),f=a(36845),p=a(93880),u=a.n(p),m=a(46401);function h(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return b(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,l=new Array(t);a<t;a++)l[a]=e[a];return l}var v=function(e){var t=this;if(d.default.adaptOldParamsTF(e),t.params=e,t.editorMacro=e.editorMacro,t.macroParams=e.macroParams,t.pageId=e.pageId,t.macroId=e.id,t.sessionId=e.sessionId||1,t.params.showNRows=e.showNRowsifNotFiltered,t.numbering=!!e.numbering&&e.numbering.toLocaleLowerCase(),t.dateFormat=(e.datepattern||"yy-mm-dd").replace("yyyy","yy"),t.localeDateFormat=s.default.getLocaleDateFormat(t.dateFormat),t.separator=e.separator,t.fixedRows="true"==e.limitHeight?1:e.limitHeight,t.fixedCols=e.fixedCols,t.heightValue=!!e.heightValue&&parseInt(e.heightValue),t.sorts=e.sorts,t.totalRow=e.totalrow?e.totalrow.split(","):[],t.totalCol=e.totalcol,t.cbState=null,t.allowRowList=null,t.tdNumbers=null,t.tables=null,t.rows=null,t.outerWrapper=$('.tablefilter-outer-wrapper[data-id="'+t.macroId+'"][data-pageid="'+t.pageId+'"][data-sessionid="'+t.sessionId+'"]'),t.tableWrapper=t.editorMacro?t.editorMacro.find(".tablefilter-table-wrapper"):t.outerWrapper.find("div#tf-table-"+t.macroId),t.tableWrapper=s.default.addExcerpt(t.tableWrapper,"tablefilter-table-wrapper").attr("id","tf-table-"+t.macroId).trigger("tf-added","tf-table-"+t.macroId),t.tableWrapper=s.default.addIframe(t.tableWrapper,"tablefilter-table-wrapper",(function(e){t.tableWrapper=e,t.getTable(),t.addNumbering(),t.setFiltrationPanel(),t.tableUpdated=!0,t.filterTable()})),t.previewTutorial=t.outerWrapper.find(".preview-tutorial"),t.comboBoxDiv=t.outerWrapper.find("#comboBoxDiv-".concat(t.macroId,"-").concat(t.sessionId)),t.filterIcon=t.outerWrapper.find(".filter-logo"),t.lockDisabled=t.comboBoxDiv.find("div.lockDisabled"),t.lockEnabled=t.comboBoxDiv.find("div.lockEnabled"),t.showBtn=t.outerWrapper.children(".tf-shower-wrapper").find(".tf-shower"),t.rawTables=null,t.columns=null,t.locale=s.default.getLocale(),t.hideParamName=t.pageId+"_"+t.macroId+"_hidden",t.menu=t.outerWrapper.find("#filter-menu-view-".concat(t.macroId,"-").concat(t.pageId,"-").concat(t.sessionId,", #filter-menu-view-lock-").concat(t.macroId,"-").concat(t.pageId,"-").concat(t.sessionId)),t.saveBtn=t.menu.find(".filter-save").not("body.content-preview .filter-save"),t.removeBtn=t.menu.find(".tf-remove"),t.resetSortBtn=t.menu.find(".filter-sort-reset"),t.isLockEnabled=e.isLockEnabled,t.tabs=e.tabs,t.worklog=s.default.getWorklog(e.worklog),t.sparkline=e.sparkline,t.sparkName="$sparkName"==e.sparkName?"":e.sparkName,t.isAND="OR"!=e.isOR,t.ddSeparator=e.ddSeparator,t.totalRows=[],t.tableUpdated=!0,t.outerWrapper.data("tf",t),t.shouldUpdateSelectOptions=e.updateSelectOptions,t.totalColName=e.totalColName,t.totalRowName=e.totalRowName,t.formatDecimal=r()({mark:t.separator,thousand:e.thousandSeparator!==t.separator?e.thousandSeparator:" "}),t.spakLinesFinished=!0,t.isCloud=t.outerWrapper.hasClass("tf-cloud-macro"),t.isEditor=e.isEditor,t.isPreview=n.default.isPreview(),0==t.tableWrapper.length)return null;t.fixURIHash(),t.orderFilters(e.order),t.getTable(),t.addNumbering(),t.sortTable(),t.appendTotalCol(),t.createSelects(t.comboBoxDiv),t.createDatePickers(t.comboBoxDiv),t.bindInputs(),t.bindReset(),t.bindDisable(),t.bindDOMChange(),t.bindInnerFiltration(),t.bindHideBtn(),t.bindAddFilter(),t.bindChangeSettings(),t.bindSave(),t.bindRemove(),t.bindExport(),t.bindSortReset(),t.bindCopyUrl(),t.bindGetUrlValues(),t.bindMakeInverse(),t.bindChangeLabel(),t.setFiltrationPanel(),t.makeSortable(),t.makeResizable(t.comboBoxDiv),t.filterTable(),t.makeTablesScrollable(),t.comboBoxDiv.find("form").bind("keydown",(function(e){return 13!=e.keyCode})),!t.editorMacro&&window.KarmaUser&&t.tables.find("a[data-username]").length&&setTimeout((function(){t.setFiltrationPanel(),t.filterTable()}),1e3)};function g(e){void 0!==this.total?this.total=s.default.multFloats(e,this.total):this.total=e}function w(e){this.total?this.total=s.default.addFloats(e,this.total):this.total=e}function y(e){null!=this.sum?(this.sum=s.default.addFloats(e,this.sum),this.count++):(this.sum=e,this.count=1),this.total=this.sum/this.count}function x(e){null!=this.total?this.total=Math.min(e,this.total):this.total=e}function T(e){null!=this.total?this.total=Math.max(e,this.total):this.total=e}function C(){null!=this.total?this.total++:this.total=1}function I(e){var t=2,a=Math.abs(e);a<1&&a>0&&(t=Math.ceil(Math.log(a)/Math.LN10*-1)+2);var l=Math.pow(10,t);return Math.round(e*l)/l}function S(e){return e.hasClass("selectfilter-element")?"Dropdown Filter":e.hasClass("userfilter-element")?"Free Text Filter":e.hasClass("numberfilter-element")?"Number Filter":e.hasClass("datefilter-element")?"Date Filter":e.hasClass("iconfilter-element")?"Icon Filter":e.hasClass("globalfilter-element")?"Global Filter":e.hasClass("columnhider-element")?"Hide Columns":void 0}function F(e,t){"undefined"!=typeof AP&&AP.resize(e,t)}v.prototype.orderFilters=function(e){if(e){var t=this.comboBoxDiv.find(".sortable-container");t.append(t.find(".iconfilter-element"));for(var a=t.find(".filter-container"),l=e.split(","),i=0;i<l.length;i++)t.append(a.eq($.inArray(i.toString(),l)))}},v.prototype.sortTable=function(){var e=this;function t(){e.sortOneTable($(this))}e.tables.bind("tablesorter-initialized.tf",(function(){var t=$(this),a=s.default.getTablesorterDateFormat(e.dateFormat);a&&t.find("thead th").addClass("dateFormat-"+a),t.append(t.children("div.resize-sensor"));var l=t.data("tablesorter");l&&(l.textSorter=function(e,t){return e.localeCompare(t)},l.ignoreCase=!1)})),e.sorts.length&&(e.tables.filter(".pivot-table-result").one("pivot-sorted",t),e.tables.not(".pivot-table-result").one("tablesorter-initialized.tf",t),e.tables.filter(".tablesorter").each(t))},v.prototype.sortTables=function(){var e=this;e.tables.each((function(){e.sortOneTable($(this))}))},v.prototype.sortOneTable=function(e){var t=this;if(t.sorts.length){var a=[];if($.each(t.sorts,(function(l,i){var r=-1===(i=i.replace(" (‍Asc)"," ⇧").replace(" (‍Desc)"," ⇩")).indexOf("⇧")?1:0,n=i.replace("⇧","").replace("⇩","").trim();s.default.getCellPositions(t.rawTables[t.tables.index(e)],n).forEach((function(e){a.push([e,r])}))})),0===a.length)return void t.prepareExport(!0);t.sortWait=!0,t.resorting=!0,t.setMutationObserver(),e.hasClass("pivot-table-result")||t.updateSorter(e),t.restoreNumbering=!0,e.trigger("sorton",[a]),t.resorting=!1,t.resetSortBtn.addClass("tf-disabled-link"),t.setMutationObserver()}},v.prototype.normalizeTable=function(){var e=this;e.pauseUpdate=!0,e.setMutationObserver(!0),s.default.normalizeTable(e.tables),e.pauseUpdate=!1,e.setMutationObserver(!0),s.default.processMergedCells(e.tables.not(".pivot-table-result"))},v.prototype.addNumbering=function(){var e=this;s.default.hasLoadingContent(e.tableWrapper)||(e.numbering?(e.pauseUpdate=!0,e.setMutationObserver(),e.tables.each((function(t){var a=$(this),l=a.find("tr.pivot-header:eq(0)");if(0==l.find(".tf-numbering").length){var i=a.find("tr.pivot-header").length;l.prepend('<th class="confluenceTh tf-numbering" rowspan="'.concat(i,'"/>'))}var r,n=e.rows[t];0==a.find("colgroup col.tfn").length&&(r=a.hasClass("relative-table")?"0.1%":29+8*((""+n.length).length-1)+"px",a.find("colgroup").prepend('<col class="tfn synchrony-exclude" style="width: '+r+'"> '));n.each((function(a){for(var l=$(this),i=this.children,r=null,o=null,c=0;c<i.length;c++)if(!i[c].classList.contains("fake")){r=$(i[c]);break}i[0].classList.contains("tf-numbering")&&(o=$(i[0]));var d=r.attr("class");if(0===a)o?o.attr("contenteditable",!1):("th"===r.prop("tagName").toLowerCase()?l.prepend('<th class="'+d+' tf-numbering synchrony-exclude" contenteditable="false"/>'):l.prepend('<td class="'+d+' tf-numbering synchrony-exclude" contenteditable="false"/>'),e.rawTables[t][a].unshift(""),e.columns=s.default.getColumns(e.rawTables),e.rawIconTables&&e.rawIconTables[t][a].unshift(""));else{var f=-1!==e.numbering.indexOf("desc")?n.length-a:a;o?(o.attr("contenteditable",!1).html("<span>"+f+"</span>"),e.rawTables[t][a][0]=""+f):(l.prepend('<td class="'+d+' tf-numbering synchrony-exclude" contenteditable="false"><span>'+f+"</span></td>"),e.rawTables[t][a].unshift(""+f),e.rawIconTables&&e.rawIconTables[t][a].unshift(""))}})),e.updateSorter(a,!0),a.hasClass("metadata-summary-macro")&&e.tableWrapper.find("ol.aui-nav").eq(t).find("li a[href]").one("mouseup",(function(){e.pauseUpdate=!0,a.find(".tf-numbering").remove(),a[0].config&&a[0].config.headerContent&&a[0].config.headerContent.splice(0,1),a.trigger("updateAll",!1),e.pauseUpdate=!1}))})),e.pauseUpdate=!1,e.setMutationObserver()):(e.tables.find(".tf-numbering").remove(),e.tables.find("colgroup col.tfn").remove()))},v.prototype.updateSorter=function(e,t){var a=this;if(e.hasClass("appfire-table-plus-parms")){if(t&&!a.appFireUpdated&&org_swift_TableSorter&&getTableParms){a.appFireUpdated=!0;var l=new org_swift_TableSorter,i=getTableParms(e);l.customizeMacroTable(e,i.tableParms,i.columnAttributes)}}else if(e.trigger("update",!1),!a.resorting&&!e.hasClass("merged-header")){var r=$.tablesorter||$.tablesorterEditor,s=r.restoreHeaders;r.restoreHeaders=function(){};try{e.trigger("updateAll",!1)}catch(e){r.restoreHeaders=s,AJS.log("Error while updating sorting: ",e)}e.one("updateComplete",(function(){r.restoreHeaders=s})),setTimeout((function(){r.restoreHeaders=s}),2e3)}},v.prototype.createSelects=function(e){var t=this;e.find("select").change((function(e,a){var l=$(this);a.selected?l.find("option").filter((function(){return this.textContent===a.selected})).prop("selected",!0):a.deselected&&l.find("option").filter((function(){return this.textContent===a.deselected})).prop("selected",!1),t.comboBoxDiv.find(".search-choice").filter((function(){return s.default.clearString(this.textContent)==="-Empty-"})).addClass("tf-empty-option"),t.enableSaveBtn(),t.filterTable(l)})).each((function(){var e=$(this);e.data("html")&&e.find("option").each((function(){this.textContent=c().sanitize(this.textContent)})),e.chosenTF({no_results_text:e.data("html")?"No matches found":"No matches found. Press \u0027Enter\u0027 to add",placeholder_text_multiple:e.is(".icon-select")?"Select items...":"Click and start typing...",display_selected_options:!1,width:e.data("width"),addUserOption:!e.data("html"),search_contains:!e.data("html"),isHtml:e.data("html")})}))},v.prototype.createDatePickers=function(e){var t=this;AJS.DatePicker.prototype.localisations||(AJS.DatePicker.prototype.localisations=[]),t.datePickerOptions={overrideBrowserDefault:!0,languageCode:t.locale},e.find("input.date").each((function(){var e=$(this),a=t.getDateFormat(e),l=a.dateFormat,i=a.locale;s.default.initDatePickerLocalisations(i),t.initDatePicker(e,l,i);var r=e.val();e.val(s.default.convertToDate(r,l,i))}))},v.prototype.bindInputs=function(){var e=this,t=[];e.comboBoxDiv.delegate("input.user-filter, input.global-filter, input.date, input.number","input keyup",(function(){var a=$(this);clearTimeout(t[a]),t[a]=setTimeout((function(){e.enableSaveBtn(),e.filterTable(a)}),330)})),e.comboBoxDiv.delegate("input.date","change",(function(){e.enableSaveBtn(),e.filterTable($(this))}))},v.prototype.bindReset=function(){var e=this;e.menu.find(".filter-reset").click((function(t){$("body").trigger("filter-options-disable-and-reset",{type:"Reset Filters",pageMode:e.isPreview?"Macro Preview":"Page View"}),f.default.gaTFResetFilters(e.isPreview?"preview":"view"),e.clearFilters(e.comboBoxDiv),e.filterTable(),t.preventDefault()})),e.comboBoxDiv.on("click",".aui-iconfont-cross",(function(){var t=$(this).parent();e.hasFilterValues(t.find("select, input.text"))&&(e.clearFilters(t),e.filterTable())}))},v.prototype.clearFilters=function(e){e.find("input.user-filter, input.global-filter, input.date, input.number").val("");var t=e.find("select");t.find("option:selected").removeAttr("selected"),t.trigger("chosen:updated"),this.enableSaveBtn()},v.prototype.bindDisable=function(){var e=this,t=e.lockEnabled.show().width()+2;e.lockEnabled.hide(),e.comboBoxDiv.find("div.lockDisabled.not-empty").css("min-width",t>270?t:"270px"),e.menu.find(".disableLock").click((function(t){$("body").trigger("filter-options-disable-and-reset",{type:"Disable All Filters",pageMode:e.isPreview?"Macro Preview":"Page View"}),f.default.gaTFDisableFilters(e.isPreview?"preview":"view",!0),e.editorMacro||e.lockEnabled.width(e.lockDisabled.width()),e.lockEnabled.height(e.lockDisabled.height()),e.lockDisabled.hide(),e.lockEnabled.show(),e.isLockEnabled=!0,e.showTableWithoutFilters(),t.preventDefault()})),e.menu.find(".enableLock").click((function(t){f.default.gaTFDisableFilters(e.isPreview?"preview":"view",!1),e.editorMacro||e.lockEnabled.width(""),e.lockDisabled.show(),e.lockEnabled.hide(),e.isLockEnabled=!1,e.filterTable(),t.preventDefault()}))},v.prototype.bindDOMChange=function(){var e=this,t=null,a=null;if(e.editorMacro){var l,i=!1,r=e.tableWrapper.html(),n=!1,o=function(t,l){if(t.is("td")||t.is("th")||(t=t.parents("td, th").eq(0)),(parseInt(t.attr("rowspan"))>1||parseInt(t.attr("colspan"))>1)&&(e.normalizeTable(),e.showOrHideTables()),t.hasClass("tablesorter-header"))e.comboBoxDiv.find("[name]").filterByAttr("name",a).attr("name",l).each((function(){var e=$(this).parents(".filter-container:eq(0)").find("label .tf-label-name");e.text(e.text().replace(a,l))})),e.updateRawTables(!0);else{if(t.length){var i=t[0].parentNode,r=e.tables.index($(i).parents("table").eq(0));if(r>=0){var s=e.rawTables[r][i.rowIndex];s&&(s[t[0].cellIndex]=t.text())}e.setTextForFakeCells(t)}else e.updateRawTables();e.appendTotalRow(),e.appendTotalCol()||(e.tables.trigger("update",!1),e.updateRawTables()),e.appendSparklines(),e.sparkline&&e.fixedRows>0&&e.updateFixedCells()}a=null,e.setFiltrationPanel()},c=function(a,s){if(!(i||e.pauseUpdate||e.sorting||e.resorting||e.editorSave||a.hasClass("tablefilter-pagination")||a.parents(".tablefilter-pagination").length||a.is("br")||a.hasClass("tablesorter-savemyplace")))if(a.is(".tf-numbering")){var c=Confluence.MacroParameterSerializer.deserialize(e.editorMacro.attr("data-macro-parameters"));e.numbering=c.numbering?c.numbering:""}else{if(a.hasClass("fake")){if(a.attr("colspan")||a.attr("rowspan"))return;a.removeClass("fake synchrony-exclude"),a.removeClass(a.getClassStartsWith(/tf-colspan-\d+/)),a.removeClass(a.getClassStartsWith(/tf-rowspan-\d+/)),a.css("display","")}clearTimeout(t);var d=l&&!l.is("td"),f=function(){if(l=null,"DOMNodeInserted"!==s||a.is("table")||0!==a.parents(".confluenceTable").length){var t=e.tableWrapper.html();if(t!=r)if(r=t,a.is("tr")||a.is("td")||a.is("th")||a.is("table")||n)n=!1,i=!0,e.getTable(),e.addNumbering(),e.setFiltrationPanel(),a.is("tr")?(e.addToAllowRowList(a),e.filterTable(),e.allowRowList=null):e.filterTable(),a.find("tr").show(),!d&&a.is("td")||a.parents("tr").show(),e.tables.not(".tablesorter").tablesorterEditor({cancelSelection:!1,dateFormat:e.dateFormat,locale:e.localeDateFormat}),a.is(".tablesorter-header")&&a.parents("table").eq(0).tablesorterEditor({cancelSelection:!1,dateFormat:e.dateFormat,locale:e.localeDateFormat}),e.appendTotalRow(),e.appendTotalCol()||e.tables.trigger("update",!1),e.appendSparklines(),a.is("table")?e.makeTablesScrollable():(e.sparkline&&e.fixedRows>0||a.is("th")||a.is("td")||a.is("tr"))&&e.updateFixedCells(),m.default.create(e,!0),i=!1;else o(a,a.text())}};a.is("table")?f():((a.is("tr")||a.hasClass("numberingColumn"))&&(n=!0),t=setTimeout(f,500)),l=a}};e.observerCallback=function(l){l.forEach((function(l){if(l.addedNodes.length)c($(l.addedNodes),"DOMNodeInserted");else if(l.removedNodes.length)c($(l.removedNodes),"DOMNodeRemoved");else if("characterData"==l.type){var i=$(l.target);!function(l,i,s){e.editorSave||e.sorting||e.resorting||(clearTimeout(t),null==a&&(a=i),t=setTimeout((function(){r=e.tableWrapper.html(),o(l,s)}),500))}(i,l.oldValue,i.text())}}))},e.observer=new MutationObserver(e.observerCallback),e.observerParams={childList:!0,subtree:!0,characterData:!0,characterDataOldValue:!0},e.observer.observe(e.tableWrapper[0],e.observerParams),e.observersTd=[],e.tableWrapper.find("td").each((function(){var t=new MutationObserver((function(e){e.forEach((function(e){var a=$(e.target),l=a.hasClass("tf-hidden-column");!l&&s.default.isRowVisible(a.parent()[0])||(t.disconnect(),a.attr(e.attributeName,e.oldValue),l?a.addClass("tf-hidden-column"):a.removeClass("tf-hidden-column"),t.observe(a[0],{attributes:!0,attributeOldValue:!0,attributeFilter:["class","data-highlight-colour"]}))}))}));t.observe(this,{attributes:!0,attributeOldValue:!0,attributeFilter:["class","data-highlight-colour"]}),e.observersTd.push(t)})),m.default.create(e,!1)}else{c=function(a,l){if(e.sorting||e.resorting||e.pauseUpdate)return!0;if(!a.hasClass("tablefilter-pagination")&&!a.parents(".tablefilter-pagination").length){if(s.default.isIgnoreUpdateNode(a))return!0;if(l&&l.id=="tf-table-"+e.macroId||s.default.hasTableForUpdate(a)){var i=function(){e.getTable(),e.addNumbering()},r=function(){e.sortTables(),e.setFiltrationPanel(),e.tableUpdated=!0,e.filterTable(),(e.fixedRows||e.fixedCols)&&e.makeTablesScrollable()};if(clearTimeout(t),a.hasClass("tfac-tj")){if(a.closest('.tj-source:not(.table-excerpt)[data-tj-not-ready="false"]').length)return!0;i(),r()}else t=setTimeout((function(){i(),setTimeout(r,1e3)}),50);return!0}return s.default.hasRowForUpdate(a)?(clearTimeout(t),t=setTimeout((function(){e.getTable(),e.addNumbering(),e.setFiltrationPanel(),e.sortTables(),e.tableUpdated=!0,e.filterTable(),(e.fixedRows||e.fixedCols)&&e.updateFixedCells()}),10),!0):s.default.hasCharsForUpdate(a,l)?(clearTimeout(t),t=setTimeout((function(){e.updateRawTables(),e.setFiltrationPanel(),e.filterTable()}),10),!0):void 0}};e.observerCallback=function(e){s.default.mutationObserverFilter(e,c)},e.observer=new MutationObserver(e.observerCallback),e.observerParams={childList:!0,subtree:!0},e.tableWrapper.each((function(){e.observer.observe(this,e.observerParams)})),e.tableWrapper.bind("DOMCharacterDataModified changed.chk",(function(a){s.default.isIgnoreCharacterModified(a)||(clearTimeout(t),t=setTimeout((function(){e.updateRawTables(!0),e.setFiltrationPanel()}),50))})),e.tabs&&s.default.onTabChange(e.tableWrapper,(function(){e.getTable(),e.addNumbering(),e.setFiltrationPanel(),e.sortTables(),e.tableUpdated=!0,e.filterTable(),(e.fixedRows||e.fixedCols)&&e.updateFixedCells()})),e.tableWrapper.bind("tf-save",(function(){return e.outerWrapper.trigger("tf-save"),!1}))}},v.prototype.setMutationObserver=function(e){var t=this;if(t.observer)if(t.sorting||t.resorting||t.pauseUpdate)e||(t.prevRowsLength=0,t.rows.forEach((function(e){t.prevRowsLength+=e.length}))),t.observerCallback(t.observer.takeRecords()),t.observer.disconnect();else{if(!e){if(t.observerRestoring)return;t.observerRestoring=!0,t.getTable(!0);var a=0;t.rows.forEach((function(e){a+=e.length})),null!=t.prevRowsLength&&a!=t.prevRowsLength&&(t.prevRowsLength=a,t.tableUpdated=!0,t.setFiltrationPanel(),t.filterTable()),t.observerRestoring=!1}t.tableWrapper.each((function(){t.observer.observe(this,t.observerParams)}))}},v.prototype.processInnerFiltration=function(e,t){var a=!1;return e&&e.tf&&(e.tf.blockEvent=!0,e.tf.filterTable(),e.tf.pauseUpdate=!0,e.tf.setMutationObserver(!0),e.tf.tables.each((function(t){var l=e.tf.tables.eq(t);if(e.tf.rows[t].each((function(l){var i=$(this);if(l>e.tf.headerSize[t]&&(e.tf.cbState[t][l-1]||(i.remove(),a=!0)),e.tf.tdNumbers[t].length){var r=i.children("td,th");$.each(e.tf.tdNumbers[t],(function(e,t){r.eq(t).remove(),a=!0}))}})),e.tf.tdNumbers[t].length){var i=l.hasClass("relative-table"),r=0,s=$(this).children("colgroup").find("col");$.each(e.tf.tdNumbers[t],(function(e,t){s.eq(t).remove(),i&&"none"!==s[t].style.display&&(r+=parseFloat(s[t].style.width))})),r>0&&(l.css("width",parseFloat(l[0].style.width)*(1-r/100)+"%"),s.each((function(a){-1===e.tf.tdNumbers[t].indexOf(a)&&(this.style.width=parseFloat(this.style.width)/(1-r/100)+"%")})))}}))),a&&(e.tf.tables.find(".fake").each((function(){var e=$(this);"none"!==e.css("display")&&e.removeClass("fake")})),s.default.processMergedCells(e.tf.tables,!0)),t&&e&&e.tf&&this.filterTable(),e&&e.tf&&(e.tf.pauseUpdate=!1,e.tf.setMutationObserver(!0),e.tf.blockEvent=!1),a},v.prototype.bindInnerFiltration=function(){var e=this,t=[];e.tableWrapper.find(".pivot-content, .tablefilter-table-wrapper").each((function(){var a=$(this);a.parents("table, .tablefilter-table-wrapper, .pivot-content, .table-joiner").eq(0).is(e.tableWrapper)&&t.push(a.attr("id"))})),t.length&&(e.tableWrapper.bind("tf-filtered pt-calculated",(function(a,l){if(-1!==t.indexOf(l.id)){"tf-filtered"!==a.type&&(e.tableUpdated=!0);var i=e.processInnerFiltration(l,!0);return e.getTable(!0),i&&e.setFiltrationPanel(),l.tf||(e.addNumbering(),(e.fixedRows||e.fixedCols)&&e.makeTablesScrollable(),e.setFiltrationPanel()),e.filterTable(),!1}})),e.tableWrapper.bind("pivot-collapse-change",(function(a,l){if(-1!==t.indexOf(l.id))return e.showOrHideTables(),!1})),e.tableWrapper.bind("pivot-collapse-change pivot-collapsed",(function(){e.addNumbering(),e.appendTotalRow(),e.appendTotalCol()}))),e.tableWrapper.bind("tf-export-ready",(function(t,a){return e.macroId===a.macroId})),e.processInnerFiltration(e.tableWrapper.data("inner-filter"),!1)&&e.getTable(!0)},v.prototype.bindHideBtn=function(){var e=this,t=parseInt(e.outerWrapper.css("margin-top"));e.comboBoxDiv.find(".tf-hider").click((function(){var a=e.tables.eq(0),l=e.comboBoxDiv.outerHeight(!0);e.comboBoxDiv.css({position:"absolute",top:e.comboBoxDiv.position().top-l});var i=a.outerWidth()-2,r={"margin-top":2*t+l+"px"};e.outerWrapper.css(r),e.comboBoxDiv.animate({top:a.position().top,opacity:0,width:i,height:14},{complete:function(){e.comboBoxDiv.hide().css({width:"",height:"",position:""}),r={"margin-top":t+"px"},e.outerWrapper.animate(r,{complete:function(){e.outerWrapper.css("width","")}}),e.showBtn.show().width(i)},duration:300}),n.default.setCookie(e.hideParamName,!0)})),e.showBtn.click((function(){var a=e.tables.eq(0);e.showBtn.hide(),e.comboBoxDiv.show();var l=e.comboBoxDiv.width(),i=e.comboBoxDiv.height(),r=e.comboBoxDiv.outerHeight(!0);e.comboBoxDiv.css({position:"absolute",opacity:0}),e.comboBoxDiv.css({width:a.width()-2,height:14});var s={"margin-top":2*t+r+"px"};e.outerWrapper.animate(s,{complete:function(){e.comboBoxDiv.css({top:0}).animate({top:-r,opacity:1,width:l,height:i},{complete:function(){e.comboBoxDiv.css({position:"",width:"",height:""}),e.outerWrapper.css({"margin-top":t+"px",width:""})},duration:300})}}),n.default.setCookie(e.hideParamName,!1)}))},v.prototype.bindTableEvents=function(){var e=this;if(!e.editorMacro)if("Table header"===e.params.hidePane)e.initInlineFilterButton();else{var t=e.fixedRows>0?e.tables.eq(0).parent():e.tables.eq(0);t.unbind("mouseover.tf"+e.macroId).bind("mouseover.tf"+e.macroId,(function(){var a=t.offset();e.showBtn.parent().offset({top:a.top-14,left:a.left+t.parent().scrollLeft()}),e.showBtn.css("visibility","visible"),e.showBtn.width(t.outerWidth()-2),e.showBtn.css("max-width",e.outerWrapper.width()-2+"px")})).unbind("mouseout.tf"+e.macroId).bind("mouseout.tf"+e.macroId,(function(){e.showBtn.css("visibility","")}))}e.tables.unbind("sortStart.tfs"+e.macroId).bind("sortStart.tfs"+e.macroId,(function(){e.sorting=!0,e.setMutationObserver()})).unbind("sortEnd.tfs"+e.macroId).bind("sortEnd.tfs"+e.macroId,(function(){if(e.sorting=!1,e.getTable(!0),e.resetSortBtn.removeClass("tf-disabled-link"),e.restoreNumbering?(e.restoreNumbering=!1,e.addNumbering(),e.filterTable()):e.filtered?e.filterContainer(e.getFilterContainers()):e.params.showNRows>0&&!e.isLockEnabled&&e.showOrHideTables(),e.totalRows){var t=e.totalRows[e.tables.index(this)];t&&$(this).append(t)}e.fixedRows>1&&e.updateFixedCells(),e.setMutationObserver(),m.default.create(e)}))},v.prototype.bindAddFilter=function(){var e=this,t=AJS.InlineDialog(e.comboBoxDiv.find(".lockDisabled .filter-settings"),"tf-add-filter-"+e.macroId,(function(t,a,l){t.css({"min-height":"166px"});var i=[],r=e.getFilters(),s=[{type:"selectfilter",name:"Dropdown Filter",desc:"Select from the list of column unique values",columns:[],existing:r.selectfilters},{type:"userfilter",name:"Free Text Filter",desc:"Enter custom text query or regular expression to filter data in the selected column",columns:[],existing:r.userfilters},{type:"numberfilter",name:"Number Filter",desc:"Specify the number range to filter data in the selected column",columns:[],existing:r.numberfilters},{type:"datefilter",name:"Date Filter",desc:"Select the time period to filter dates in the selected column",columns:[],existing:r.datefilters},{type:"iconfilter",name:"Visual Filter",desc:"Select icons, emoticons, images or state of checkboxes from the list of unique column values",columns:[],existing:r.iconfilters}];$.each(s,(function(t,a){$.each(e.columns,(function(e,t){-1==$.inArray(t.replace(/\,/g,"‚"),a.existing)&&a.columns.push(t)})),a.columns.length&&i.push(a)})),t.html(u().addFilterDialog({filters:i,globalfilter:!r.globalfilter,columnhider:!r.columnhider,dateFormat:e.dateFormat})),l()}),{offsetX:-20,width:270,noBind:!0,gravity:"n",initCallback:function(){var t=this,a=t.popup.find(".filter-type"),l=t.popup.find(".date-format-param"),i=l.find(".date-format-input"),r=t.popup.find(".tf-add-filter-column select");r.filter(":not(:first)").parent().hide(),a.change((function(){var e=a.val(),i=r.filter((function(){return"none"!==this.parentNode.style.display})).val();t.popup.find("div.tf-add-filter-column").hide(),t.popup.find("div."+e).show().find("option").filter((function(){return this.textContent==i})).attr("selected","selected"),"datefilter"===e?l.fadeIn():l.fadeOut(),a.attr("title",a.find("option:selected").attr("title"))})),a.trigger("change");var n=new Set;e.comboBoxDiv.find("span.tf-label-name").each((function(){n.add(this.innerText)})),r.change((function(){if(!n.has(this.value)){var t=e.dateFormat,l=e.detectFilterType(this.value);if(l){"datefilter"===l&&(i.val(e.dateFormat),e.dateFormat=t);var r=a.find("option[value=".concat(l,"]"));r.length&&(r.attr("selected","selected"),a.change())}}})),r.first().find("option").each((function(){if(!n.has(this.value))return $(this).attr("selected","selected").parent().trigger("change"),!1})),t.popup.find("#cancel").click((function(){return t.hide(),F(),!1})),t.popup.find("#save").click((function(){$(this).prop("disabled",!0);var l=a.val();return"datefilter"===l&&e.changeSettings(i.val().trim()),e.addFilter(l,t.popup.find("select."+l).val()),t.hide(),$("body").trigger("filter-added-deleted",{action:"Filter Added",type:l,pageMode:e.isPreview?"Macro Preview":"Page View"}),F(),!1})),s.default.dateFormatAutocomplete(i,t.popup),e.editorMacro&&t.popup.click((function(){return!1}))},hideCallback:function(){F()}});e.menu.find(".filter-add").bind("click",(function(a){return"undefined"!=typeof AP&&a.clientY+190>$("body").height()-10&&a.clientY-240<0&&AP.resize("100%",a.clientY+190),t.show(),"false"==e.menu.attr("aria-hidden")&&e.comboBoxDiv.find("#filter-settings-".concat(e.macroId,"-").concat(e.sessionId)).trigger("aui-button-invoke"),!1})),e.comboBoxDiv.find(".tf-add-start").click((function(t){return e.isCloud?(e.comboBoxDiv.find("#filter-settings-".concat(e.macroId,"-").concat(e.sessionId)).trigger("mousedown",[t]),setTimeout((function(){e.comboBoxDiv.find("#filter-settings-".concat(e.macroId,"-").concat(e.sessionId)).trigger("aui-button-invoke")}),100)):e.comboBoxDiv.find("#filter-settings-".concat(e.macroId,"-").concat(e.sessionId)).trigger("aui-button-invoke"),e.menu.find(".filter-add").blinkFromClass("active"),!1}))},v.prototype.addFilter=function(e,t){var a=this,l=$(u().filter({type:e,column:t}));return a.comboBoxDiv.find(".sortable-container").append(l),"selectfilter"==e||"columnhider"==e||"iconfilter"==e?("iconfilter"!==e||a.rawIconTables||a.updateRawIconTables(),a.createSelects(l)):"datefilter"==e&&a.createDatePickers(l),a.setFiltrationPanel(),a.makeResizable(l),a.enableSaveBtn(),l},v.prototype.bindChangeSettings=function(){var e=this,t=AJS.InlineDialog(e.outerWrapper.find(".lockDisabled .filter-settings, .filter-logo.floating"),"tf-change-settings-"+e.macroId,(function(t,a,l){t.css({"min-height":"120px"}),t.html(u().changeSettingsDialog({datepattern:e.dateFormat})),l()}),{offsetX:-20,width:270,noBind:!0,gravity:"n",arrowOffsetX:"Table header"!==e.params.hidePane?0:-12,initCallback:function(){var t=this,a=t.popup.find("#tf-cs-dialog-datepattern");s.default.dateFormatAutocomplete(a,t.popup),t.popup.find("#tf-cs-cancel").click((function(){return t.hide(),F(),!1})),t.popup.find("#tf-cs-save").click((function(){return e.changeSettings(a.val()),t.hide(),F(),!1})),e.editorMacro&&t.popup.click((function(){return!1}))},hideCallback:function(){F()}});e.menu.find(".tf-change-settings").bind("click",(function(a){return t.show(),"false"==e.menu.attr("aria-hidden")&&e.outerWrapper.find("#filter-settings-".concat(e.macroId,"-").concat(e.sessionId)).trigger("aui-button-invoke"),!1}))},v.prototype.changeSettings=function(e){var t=this;t.dateFormat!=e&&(t.enableSaveBtn(),t.dateFormat=e,t.updateDateFilters(),t.filterTable())},v.prototype.updateDateFilters=function(){var e=this;e.comboBoxDiv.find("input.date").each((function(){var t=$(this),a=e.getDateFormat(t),l=a.dateFormat,i=a.locale,r=t.attr("dateformat");if(l!=r){var n=t.val(),o=null;try{o=s.default.parseDate(n,r,i)}catch(e){}var c=$(t[0].outerHTML);t.replaceWith(c),c.attr("value",null!=o?s.default.formatDate(o,l,i):n),$(".aui-datepicker-dialog").remove(),e.initDatePicker(c,l,i)}}))},v.prototype.initDatePicker=function(e,t,a){var l=this;if(e.attr("dateformat",t),e.attr("locale",a),e.attr("placeholder",t),!t.match(/[iw]/)){l.datePickerOptions.dateFormat=s.default.getDateFormatWithoutTime(t),l.datePickerOptions.languageCode=a;var i=e.datePicker(l.datePickerOptions)}t.toLowerCase().indexOf("hh:mm")>=0?(e.width(120),e.bind("focus click keyup input paste",(function(){setTimeout((function(){i.setDate(s.default.getDateTimeObject(e.val(),t).dateString)}),1)}))):e.width(93)},v.prototype.getDateFormat=function(e){var t=this,a=e.attr("name"),l=t.dateFormat,i=t.locale;return t.getDateMacroFormatIfPresent(a)||{dateFormat:l,locale:i}},v.prototype.getDateMacroFormatIfPresent=function(e){for(var t=this,a=0;a<t.rows.length;a++){var l=s.default.getCellPosition(t.rawTables[a],e);if(null!=l){var i=t.rows[a];if(0===i.parents("#issuetable, .spreadsheets-sheet").length)for(var r=1;r<i.length;r++){var n=i[r].children;if(n.length>l){var o=n[l].getElementsByTagName("time");if(o.length){var c=$(o);if(c.is('[data-macro-name="page-info"]'))break;return s.default.getDateMacroDateFormat(c,t.locale,[t.localeDateFormat,t.dateFormat])}}}}}},v.prototype.bindSave=function(){var e=this;e.saveBtn.click((function(t){var a=e.saveBtn;if(!a.hasClass("tf-disabled-link")){$("body").trigger("filter-options-save");var l=e.getFilters(),i={pageId:e.pageId,id:e.macroId,defaults:l.defaults.join(","),width:l.width.join(","),inverse:l.inverse.join(","),order:l.order.join(","),labels:e.getFilterLabels(),datepattern:e.dateFormat,hidePane:e.params.hidePane},r=function(e){for(var t=[],a=0;a<e.length;a++)""==e[a]?t.push("‌"):t.push(e[a]);return t.join(",")};l.selectfilters.length&&(i.column=r(l.selectfilters)),l.userfilters.length&&(i.userfilter=r(l.userfilters)),l.numberfilters.length&&(i.numberfilter=r(l.numberfilters)),l.datefilters.length&&(i.datefilter=r(l.datefilters)),l.iconfilters.length&&(i.iconfilter=r(l.iconfilters)),l.globalfilter&&(i.globalfilter="true"),l.columnhider&&(i.columnhider="true");var s=function(){a.addClass("tf-disabled-link"),e.outerWrapper.add(a).find(".tfac-unsaved").hide(),e.filterIcon.removeClass("unsaved"),e.removeBtn.css("display","")};e.editorMacro?(i.column?e.macroParams.column=i.column:delete e.macroParams.column,i.userfilter?e.macroParams.userfilter=i.userfilter:delete e.macroParams.userfilter,i.numberfilter?e.macroParams.numberfilter=i.numberfilter:delete e.macroParams.numberfilter,i.datefilter?e.macroParams.datefilter=i.datefilter:delete e.macroParams.datefilter,i.globalfilter?e.macroParams.globalFilter=i.globalfilter:delete e.macroParams.globalFilter,i.columnhider?e.macroParams.hideColumns=i.columnhider:delete e.macroParams.hideColumns,i.iconfilter?e.macroParams.iconfilter=i.iconfilter:delete e.macroParams.iconfilter,i.width?e.macroParams["cell-width"]=i.width:delete e.macroParams["cell-width"],i.defaults?e.macroParams.default=i.defaults:delete e.macroParams.default,i.inverse?e.macroParams.inverse=i.inverse:delete e.macroParams.inverse,i.datepattern?e.macroParams.datepattern=i.datepattern:delete e.macroParams.datepattern,i.labels?e.macroParams.labels=i.labels:delete e.macroParams.labels,e.editorMacro.attr("data-macro-parameters",Confluence.MacroParameterSerializer.serialize(e.macroParams)),s()):(n.default.saveMacroParams(i,e.outerWrapper),s(),e.tableWrapper.trigger("tf-save")),t.preventDefault()}}))},v.prototype.bindRemove=function(){var e=this;e.removeBtn.click((function(t){t.preventDefault(),s.default.createDialogRemoveMacro(e,"Table Filter","Table Filter")}))},v.prototype.bindExport=function(){var e=this;void 0===l.saveAs?(e.menu.find(".export-file-pdf").hide(),e.menu.find(".export-file-doc").hide(),e.menu.find(".export-file-csv").hide()):(e.menu.find(".export-file-pdf").bind("click",(function(t){n.default.loadScriptsBeforeExport((function(){s.default.exportToPdf(e.tableWrapper)})),t.preventDefault()})),e.menu.find(".export-file-doc").bind("click",(function(t){s.default.exportToDoc(e.tableWrapper),t.preventDefault()})),e.menu.find(".export-file-csv").click((function(t){s.default.createDialog(e.tables,e.rows[0],e.macroId),t.preventDefault()})))},v.prototype.bindSortReset=function(){var e=this;e.resetSortBtn.bind("click",(function(t){f.default.qaResetColumnSorting(),t.preventDefault(),e.resetSortBtn.hasClass("tf-disabled-link")||(e.sorts.length?e.sortTables():e.tables.trigger("sorton",[[]]),e.resetSortBtn.addClass("tf-disabled-link"))}))},v.prototype.bindCopyUrl=function(){var e=this;e.menu.find(".get-tf-url").bind("click",(function(t){var a=e.getFilters();a.sorts=[],e.tables.each((function(t){this.config&&this.config.sortList&&this.config.sortList.forEach((function(l){var i=0===l[1]?"⇧":"⇩";a.sorts.push(e.rawTables[t][0][l[0]]+" "+i)}))}));var l=window.location.hash,i=window.location.href.replace(l,""),r=$.getUrlHashVar("tf-filters");if(r){var s="tf-filters="+encodeURIComponent(r);l=(l=l.replace("&"+s,"")).replace("#"+s,"")}i=i+l+(l?"&":"#");var n=$("<span></span>");$("body").append(n),n.text(i+"tf-filters="+encodeURIComponent(JSON.stringify(a)));var o=document.createRange();o.selectNode(n[0]);var c=window.getSelection();c.removeAllRanges(),c.addRange(o),document.execCommand("copy"),n.remove(),t.preventDefault(),f.default.gaTFCopyFilterURL()}))},v.prototype.bindGetUrlValues=function(){var e=this,t=function(){var t=$.getUrlHashVar("tf-filters");if(t){var a=JSON.parse(t);e.setFilters(a),f.default.gaTFApplyFilterURL()}};$(window).bind("hashchange",t),$(".tablefilter-table-wrapper").one("tf-filtered",t)},v.prototype.setFilters=function(e){var t=this,a=function(e,t){e?(t.addClass("inverse"),t.parents(".filter-container:eq(0)").addClass("inverse")):(t.removeClass("inverse"),t.parents(".filter-container:eq(0)").removeClass("inverse"))},l=function(e,t){return e.filterByAttr("name",t)};s.default.i18nFilterValues(e.defaults);var i=0;(t.clearFilters(t.comboBoxDiv),e.selectfilters.forEach((function(r){r=r.replace(/\‚/g,",");var n=l(t.comboBoxDiv.find("select.select"),r);0==n.length&&(n=t.addFilter("selectfilter",r).find("select")),a(e.inverse[i],n);var o=e.defaults[i++].replace(/\‚/g,","),c=s.default.clearStringLowerCase(o).split("&&");o=o.split("&&");var d=[];n.find("option:selected").prop("selected",!1),n.find("option").each((function(){var e=$(this),t=$.inArray(s.default.clearStringLowerCase(e[0].textContent),c);-1!=t&&(e.prop("selected",!0),d.push(t))})),o.forEach((function(e,t){e&&-1==$.inArray(t,d)&&n.append($('<option selected="selected"></option>').text(e))})),n.trigger("chosen:updated")})),e.userfilters.forEach((function(r){r=r.replace(/\‚/g,",");var s=l(t.comboBoxDiv.find("input.user-filter"),r);0==s.length&&(s=t.addFilter("userfilter",r).find("input")),a(e.inverse[i],s),s.val(e.defaults[i++].replace(/\‚/g,","))})),e.numberfilters.forEach((function(r){r=r.replace(/\‚/g,",");var s=l(t.comboBoxDiv.find("input.number.from"),r);0==s.length&&(s=t.addFilter("numberfilter",r).find("input.from"));var n=l(t.comboBoxDiv.find("input.number.to"),r);a(e.inverse[i],s),a(e.inverse[i],n);var o=e.defaults[i++].replace(/\‚/g,",").split("->");s.val(o[0]),n.val(o[1])})),e.datefilters.forEach((function(r){r=r.replace(/\‚/g,",");var n=l(t.comboBoxDiv.find("input.date.from"),r);0==n.length&&(n=t.addFilter("datefilter",r).find("input.from"));var o=l(t.comboBoxDiv.find("input.date.to"),r);a(e.inverse[i],n),a(e.inverse[i],o);var c=e.defaults[i++].replace(/\‚/g,",").split("->");n.val(s.default.convertToDate(c[0],n.attr("dateformat"),n.attr("locale"))),o.val(s.default.convertToDate(c[1],o.attr("dateformat"),n.attr("locale")))})),e.globalfilter)&&(0==(r=t.comboBoxDiv.find("input.global-filter")).length&&(r=t.addFilter("globalfilter","").find("input")),a(e.inverse[i],r),r.val(e.defaults[i++].replace(/\‚/g,",")));if(e.columnhider){var r;0==(r=t.comboBoxDiv.find("select.column-select")).length&&(r=t.addFilter("columnhider","").find("select")),a(e.inverse[i],r);var n=e.defaults[i++].replace(/\‚/g,","),o=s.default.clearStringLowerCase(n).split("&&");n=n.split("&&");var c=[];r.find("option:selected").prop("selected",!1),r.find("option").each((function(){var e=$(this),t=$.inArray(s.default.clearStringLowerCase(e.text()),o);-1!=t&&(e.prop("selected",!0),c.push(t))})),n.forEach((function(e,t){e&&-1==$.inArray(t,c)&&r.append($('<option selected="selected"></option>').text(e))})),r.trigger("chosen:updated")}e.iconfilters.forEach((function(r){r=r.replace(/\‚/g,",");var n=l(t.comboBoxDiv.find("select.icon-select"),r);0==n.length&&(n=t.addFilter("iconfilter",r).find("select")),a(e.inverse[i],n);var o=s.default.clearStringLowerCase(e.defaults[i++].replace(/\‚/g,",")).split("&&");n.find("option:selected").prop("selected",!1),n.find("option").each((function(){var e=$(this);-1!=$.inArray(s.default.clearStringLowerCase(e[0].textContent),o)&&e.prop("selected",!0)})),n.trigger("chosen:updated")})),e.sorts&&(t.sorts=e.sorts,t.sortTables()),t.filterTable()},v.prototype.fixURIHash=function(){var e=$.getUrlHashVar("tf-filters");if(e){var t=location.hash,a=location.hash.replace("&tf-filters="+encodeURIComponent(e),"");t!=a&&(location.hash=a,location.hash=t)}},v.prototype.bindMakeInverse=function(){var e=this;e.comboBoxDiv.delegate(".eq","click",(function(){var t=$(this).parents(".filter-container:eq(0)");t.addClass("inverse");var a=t.find("input, select").addClass("inverse");$("body").trigger("filter-inverse-direct",{type:S(t),pageMode:e.isPreview?"Macro Preview":"Page View",filterMode:"Inverse"}),e.enableSaveBtn(),e.filterTable(a)})),e.comboBoxDiv.delegate(".not-eq","click",(function(){var t=$(this).parents(".filter-container:eq(0)");t.removeClass("inverse");var a=t.find("input, select").removeClass("inverse");$("body").trigger("filter-inverse-direct",{type:S(t),pageMode:$("body").find("div#macro-browser-preview").length?"Macro Preview":"Page View",filterMode:"Normal"}),e.enableSaveBtn(),e.filterTable(a)}))},v.prototype.setFiltrationPanel=function(){var e=this,t=e.columns.map((function(e){return e.toLocaleLowerCase()})),a=e.comboBoxDiv.find("select.select, input.user-filter, div.range, select.icon-select");a.each((function(){var e=$(this);-1==$.inArray(s.default.clearStringLowerCase(e.attr("name")),t)?e.parents(".filter-container").eq(0).hide():e.parents(".filter-container").eq(0).show()})),e.setSelectOptions();var l=e.comboBoxDiv.find("select.column-select");l.find("option:not(:selected)").remove();var i=[];l.find("option").each((function(){i.push($(this).hasClass("tf-empty-option")?"":s.default.clearString(this.textContent))})),$.each(e.columns,(function(e,t){if(-1==$.inArray(t,i)){var a="",r=t;""==t&&(a=' class="tf-empty-option"',r="-Empty-"),l.append($("<option"+a+"></option>").text(r))}})),l.trigger("chosen:updated"),e.comboBoxDiv.find(".search-choice").filter((function(){return s.default.clearString(this.textContent)=="-Empty-"})).addClass("tf-empty-option"),e.updateDateFilters();var r=a.filter((function(){return"none"!=$(this).parent().css("display")})).length>0||l.length>0||e.comboBoxDiv.find(".global-filter").length>0,o=e.params.showNRows>=0;if(0==e.rawTables.length)e.isEditor&&e.isCloud&&!e.tableWrapper.data("hasFrame")?(e.previewTutorial.show(),e.comboBoxDiv.hide()):(e.previewTutorial.hide(),e.comboBoxDiv.show(),e.tableWrapper.data("hasFrame")||s.default.hasLoadingContent(e.tableWrapper)?(e.comboBoxDiv.find(".waiting-for-table").show(),e.comboBoxDiv.find(".no-table-message").hide()):(e.comboBoxDiv.find(".no-table-message").show(),e.comboBoxDiv.find(".waiting-for-table").hide()),e.comboBoxDiv.find(".empty-message").hide(),e.lockDisabled.hide(),e.lockEnabled.hide(),e.outerWrapper.addClass("no-table"),e.comboBoxDiv.find(".tf-hider-wrapper").hide());else if(e.previewTutorial.hide(),e.comboBoxDiv.find(".tf-hider-wrapper").show(),e.outerWrapper.removeClass("no-table"),e.comboBoxDiv.find(".no-table-message").hide(),e.comboBoxDiv.find(".waiting-for-table").hide(),e.isLockEnabled=e.isLockEnabled&&(r||o),e.isLockEnabled?(e.lockDisabled.hide(),e.lockEnabled.show()):(e.lockDisabled.show(),e.lockEnabled.hide()),r||o||!(e.numbering||e.fixedRows||e.sorts.length||e.sparkline||e.fixedCols||e.totalRow.join("")||e.totalCol)?e.editorMacro||"true"!=n.default.getCookie(e.hideParamName)?(e.comboBoxDiv.show(),e.showBtn.hide()):(e.comboBoxDiv.hide(),e.showBtn.show()):e.editorMacro||(e.comboBoxDiv.hide(),e.showBtn.show()),!r&&o?(e.menu.find(".disableLock").show(),e.comboBoxDiv.find(".show-n-rows-only-message").show()):e.comboBoxDiv.find(".show-n-rows-only-message").hide(),r||o){e.comboBoxDiv.find(".filter-buttons-container").show(),e.comboBoxDiv.find(".empty-message").hide(),e.lockDisabled.addClass("not-empty").removeClass("empty");var c=e.outerWrapper.css("display");e.outerWrapper.show();var d=e.comboBoxDiv.css("display");if(e.comboBoxDiv.show(),!e.editorMacro){e.lockEnabled.css("width","").css("display","inline-flex");var f=Math.max(302,Math.ceil(e.lockEnabled.show().width())+1);e.lockDisabled.css("min-width",f+"px")}e.lockDisabled.show(),e.editorMacro||e.lockEnabled.width(Math.max(302,Math.ceil(e.lockDisabled.width()))),e.lockEnabled.height(Math.max(40,e.lockDisabled.height())),e.comboBoxDiv.css("display",d),e.outerWrapper.css("display",c),e.lockEnabled.css("display","block"),e.isLockEnabled?e.lockDisabled.hide():e.lockEnabled.hide()}else e.lockDisabled.addClass("empty").removeClass("not-empty").css("min-width",""),e.comboBoxDiv.find(".filter-buttons-container").show(),e.comboBoxDiv.find(".empty-message").show();e.outerWrapper.css("visibility","visible")},v.prototype.setSelectOptions=function(){var e=this,t=e.comboBoxDiv.find("select.select, select.icon-select").filter((function(){return"none"!=$(this).parent().css("display")}));if(t.find("option:not(:selected)").remove(),e.shouldUpdateSelectOptions)var a=e.getFilterContainers().not(".columnhider-element");t.each((function(){var t=$(this),l=t.attr("name").toLocaleLowerCase(),i=t.data("html"),r=!0,n=[],o=[];t.find("option").each((function(){if(i){var e=this.textContent;if(e!="-Empty-"){var t=$(e);t.is("img")&&(e=t[0].src,e=s.default.clearIconSrc(e))}else o.push("");o.push(e.toLocaleLowerCase())}else o.push($(this).hasClass("tf-empty-option")?"":s.default.clearStringLowerCase(this.textContent))})),$.each(e.rawTables,(function(d,f){var p=s.default.getCellPositions(f,l);if(e.shouldUpdateSelectOptions&&f.length){for(var u=new Array(f.length-1),m=0;m<u.length;m++)u[m]=!0;a.not(t.parent()).each((function(){var t=$(this).data("state");if(t&&t[d])for(var a=0;a<t[d].length;a++)e.isAND?u[a]=u[a]&&t[d][a]:u[a]=u[a]&&!t[d][a]}))}p.forEach((function(t){if($.each(i?e.rawIconTables[d]:f,(function(a,l){if(0!=a&&(!u||u[a-1])){var d=l[t];if(null==d)return;if(i&&d){var f=$(d);f.filter("img").each((function(){d=s.default.clearStringLowerCase(this.src),d=s.default.clearIconSrc(d),-1==$.inArray(d,o)&&(o.push(d),n.push(c().sanitize(this.outerHTML)))})),f.filter("ul").length&&r&&(r=!1,-1==$.inArray('<ul class="inline-task-list"><li></li></ul>',o)&&(n.push('<ul class="inline-task-list"><li></li></ul>'),o.push('<ul class="inline-task-list"><li></li></ul>')),-1==$.inArray('<ul class="inline-task-list"><li class="checked"></li></ul>',o)&&(n.push('<ul class="inline-task-list"><li class="checked"></li></ul>'),o.push('<ul class="inline-task-list"><li class="checked"></li></ul>')))}else e.ddSeparator&&""!=d?d.split(e.ddSeparator).forEach((function(e){(e=e.trim())&&(d=s.default.clearStringLowerCase(e),-1==$.inArray(d,o)&&(o.push(d),n.push(e)))})):(d=s.default.clearStringLowerCase(d),-1==$.inArray(d,o)&&(o.push(d),n.push(l[t])))}})),!i&&-1==$.inArray("@currentuser",o)){var a=e.tables.eq(d),l=!1;if(e.rows[d].length>1&&a.hasClass("tasks-report")&&s.default.getNthTdElem(e.rows[d][1],t).hasClass("tasks-report-assignee"))l=!0;else if(t++,a.find(".confluence-userlink").length){var p=a.find("tr td:nth-child("+t+"), tr th:nth-child("+t+")").find(".confluence-userlink").eq(0);p.length&&p.parents("td").eq(0).text().trim()==p.text().trim()&&(l=!0)}l&&(o.push("@currentuser"),n.push("@currentUser"))}}))})),n.sort((function(e,t){return e.localeCompare(t)}));var d="";$.each(n,(function(e,t){var a="",l=t;""==t&&(a=' class="tf-empty-option"',l="-Empty-"),d+=$("<option"+a+"></option>").text(l)[0].outerHTML})),t.append(d),t.trigger("chosen:updated")}))},v.prototype.makeSortable=function(){var e=this;-1===["Table header","true"].indexOf(e.params.hidePane)&&e.comboBoxDiv.find(".sortable-container").sortable({cancel:"input,textarea,button,select,option,.chosen-drop",scroll:!1,items:".sortable",start:function(e,t){t.item.width(Math.ceil(t.item.width())+1)},sort:function(t,a){e.highlightRemoveFilter(a.offset,a.helper)},beforeStop:function(t,a){e.enableSaveBtn(),e.removeFilter(a.offset,a.item)},update:function(t,a){$("body").trigger("filter-reordered",{type:S(a.item),pageMode:e.isPreview?"Macro Preview":"Page View"})}})},v.prototype.makeResizable=function(e){var t=this;if(0==$("body.content-preview").length){var a=e.find(".chosen-container, div.tf-resizeable");a.length>0&&a.resizable({handles:"e",resize:function(e,a){a.element.hasClass("chosen-container")?a.element.parent().find("select").attr("data-width",a.size.width):a.element.find("input").attr("data-width",a.size.width),t.enableSaveBtn()}})}},v.prototype.makeTablesScrollable=function(){var e=this;s.default.hasLoadingContent(e.tableWrapper)||(e.pauseUpdate=!0,e.setMutationObserver(!0),e.tables.find(".tf-fixed-column-border").remove(),e.tables.parents(".table-wrap, .table-wrap-aui").unbind("scroll.fh scroll-tf"),e.tables.find("td.tf-floating,th.tf-floating").removeClass("tf-floating").removeClass("tf-float-head").css({top:"",left:""}),e.tableWrapper.find(e.editorMacro?".table-wrap.tf-fixed-rows":".table-wrap.editor, .table-wrap-aui").each((function(){var e=$(this);e.before(e.children("table, .table-wrap")),e.remove()})),e.tableWrapper.removeClass("fixed"),e.editorMacro&&e.tableWrapper.find(".resize-sensor, .resize-sensor-shrink, .resize-sensor-expand").remove(),e.fixColumns(),e.pauseUpdate=!1,e.setMutationObserver(!0))},v.prototype.fixColumns=function(){var e=this;if(e.fixedCols>0&&!e.editorMacro||e.fixedRows>0){var t=window.navigator.userAgent.indexOf("MSIE ")>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)||/Edge/.test(navigator.userAgent);e.tables.each((function(a){var l=$(this);e.editorMacro?l.wrap('<div class="table-wrap editor"></div>'):e.fixedRows>0&&l.hasClass("aui")?l.wrap('<div class="table-wrap-aui"></div>'):0==l.parents(".table-wrap").length&&l.wrap('<div class="table-wrap"></div>');var i=l.parents(".table-wrap, .table-wrap-aui").eq(0);if(i.addClass("tf-fixed"),t&&i.addClass("ie"),l.find(".tableFloatingHeader").remove(),e.fixedRows>0){var r=e.rows[a].length>e.fixedRows?2*(e.rows[a].eq(e.fixedRows).offset().top-l.offset().top):l.height(),s=e.heightValue?e.heightValue:Math.floor(.7*window.innerHeight)||600;i.css("max-height",Math.max(r,s)+"px"),i.addClass("tf-fixed-rows")}l.tableHeadFixer({left:e.editorMacro?0:e.fixedCols,head:parseInt(e.fixedRows)+l.find("tr.tf-header-hidden").length,parent:i})})),e.tableWrapper.addClass("fixed")}},v.prototype.updateFixedCells=function(){var e=this;(e.fixedCols>0&&!e.editorMacro||e.fixedRows>0)&&(e.pauseUpdate=!0,e.setMutationObserver(!0),e.tables.parents(".table-wrap, .table-wrap-aui").unbind("scroll.tf scroll-tf"),e.tables.find("td.tf-floating,th.tf-floating").removeClass("tf-floating").css({top:"",left:""}),e.tables.each((function(){var t=$(this),a=t.parents(".table-wrap, .table-wrap-aui").eq(0);t.tableHeadFixer({left:e.editorMacro?0:e.fixedCols,head:parseInt(e.fixedRows)+t.find("tr.tf-header-hidden").length,parent:a})})),e.pauseUpdate=!1,e.setMutationObserver(!0))},v.prototype.enableSaveBtn=function(){this.saveBtn.removeClass("tf-disabled-link"),this.outerWrapper.add(this.saveBtn).find(".tfac-unsaved").show(),this.filterIcon.addClass("unsaved")},v.prototype.shouldRemoveFilter=function(e){var t=this,a=t.comboBoxDiv.offset(),l=a.left+t.comboBoxDiv.width()+10,i=a.left-10,r=a.top+t.comboBoxDiv.height()-10,s=a.top-20;return e.top<s||e.top>r||e.left>l||e.left<i},v.prototype.removeFilter=function(e,t){var a=this;a.outerWrapper.click(),a.shouldRemoveFilter(e)?(t.remove(),$("body").trigger("filter-added-deleted",{action:"Filter Deleted",type:S(t),pageMode:a.isPreview?"Macro Preview":"Page View"}),setTimeout((function(){a.filterTable(),a.setFiltrationPanel()}),500)):t.removeClass("filter-removing")},v.prototype.highlightRemoveFilter=function(e,t){this.shouldRemoveFilter(e)?t.addClass("filter-removing"):t.removeClass("filter-removing")},v.prototype.getFilters=function(){var e=this,t={selectfilters:[],userfilters:[],numberfilters:[],datefilters:[],globalfilter:e.comboBoxDiv.find("input.global-filter"),columnhider:e.comboBoxDiv.find("select.column-select"),iconfilters:[],defaults:[],width:[],inverse:[],order:[]},a=e.comboBoxDiv.find(".sortable-container .filter-container");if(e.comboBoxDiv.find("select.select").each((function(){var e=[],l=$(this);t.selectfilters.push(l.attr("name").replace(/\,/g,"‚")),t.width.push(l.attr("data-width").replace("px","")),l.find("option:selected").each((function(){e.push(this.textContent.replace(/\,/g,"‚"))})),t.defaults.push(e.join("&&")),t.inverse.push(l.hasClass("inverse")),t.order.push(a.index(l.parents(".filter-container")))})),e.comboBoxDiv.find("input.user-filter").each((function(){var e=$(this);t.userfilters.push(e.attr("name").replace(/\,/g,"‚")),t.width.push(e.attr("data-width").replace("px","")),t.defaults.push(e.val().replace(/\,/g,"‚")),t.inverse.push(e.hasClass("inverse")),t.order.push(a.index(e.parents(".filter-container")))})),e.comboBoxDiv.find(".range.numbers").each((function(){var e=[],l=$(this);t.numberfilters.push(l.attr("name").replace(/\,/g,"‚")),l.find("input.number").each((function(){e.push($(this).val().replace(/\,/g,"‚"))})),t.defaults.push(e.join("->")),t.inverse.push(l.parent().hasClass("inverse")),t.order.push(a.index(l.parents(".filter-container")))})),e.comboBoxDiv.find(".range.dates").each((function(){var e=[],l=$(this);t.datefilters.push(l.attr("name").replace(/\,/g,"‚")),l.find("input.date").each((function(){var t=$(this),a=t.val();e.push(s.default.dateToUTCTimestamp(a,t.attr("dateformat"),t.attr("locale")))})),t.defaults.push(e.join("->")),t.inverse.push(l.parent().hasClass("inverse")),t.order.push(a.index(l.parents(".filter-container")))})),t.globalfilter.length?(t.defaults.push(t.globalfilter.val().replace(/\,/g,"‚")),t.width.push(t.globalfilter.attr("data-width").replace("px","")),t.inverse.push(t.globalfilter.hasClass("inverse")),t.order.push(a.index(t.globalfilter.parents(".filter-container"))),t.globalfilter=!0):t.globalfilter=!1,t.columnhider.length){var l=[];t.columnhider.find("option:selected").each((function(){l.push(this.textContent.replace(/\,/g,"‚"))})),t.defaults.push(l.join("&&")),t.width.push(t.columnhider.attr("data-width").replace("px","")),t.inverse.push(t.columnhider.hasClass("inverse")),t.order.push(a.index(t.columnhider.parents(".filter-container"))),t.columnhider=!0}else t.columnhider=!1;return e.comboBoxDiv.find("select.icon-select").each((function(){var e=[],l=$(this);t.iconfilters.push(l.attr("name").replace(/\,/g,"‚")),t.width.push(l.attr("data-width").replace("px","")),l.find("option:selected").each((function(){e.push(this.textContent.replace(/\,/g,"‚"))})),t.defaults.push(e.join("&&")),t.inverse.push(l.hasClass("inverse")),t.order.push(a.index(l.parents(".filter-container")))})),s.default.unI18nFilterValues(t.defaults),t},v.prototype.getTable=function(e){var t=this,a=t.tabs&&s.default.hasTabs(t.tableWrapper);t.tables=s.default.getTableNodes(t.tableWrapper,t.editorMacro?"table.confluenceTable":"table").filter((function(){var e=$(this);if(a&&s.default.hasInactiveTab(e))return!1;var l=e.parents("table:not(.wysiwyg-macro), .tablefilter-table-wrapper");return l.eq(0).is(t.tableWrapper)||l.eq(0).is(".tablefilter-table-wrapper")&&l.eq(1).is(t.tableWrapper)})),e||t.normalizeTable(),t.rows=[],t.headerSize=[],t.tables.each((function(){var e=s.default.getRows(this);t.rows.push(e),t.headerSize.push(s.default.getMaxRowspan($(e[0])))})),t.updateRawTables(),s.default.setPaginationMsg(t.tableWrapper),e||t.bindTableEvents()},v.prototype.updateRawTables=function(e){var t=this;t.rawTables=s.default.getTablesRowsValues(t.rows,t.editorMacro?s.default.editorType:s.default.textType),e||(t.rawIconTables=null,(t.comboBoxDiv.find("select.icon-select").length||-1!==t.totalRow.indexOf("Count not empty"))&&t.updateRawIconTables()),t.columns=s.default.getColumns(t.rawTables)},v.prototype.updateRawIconTables=function(){this.rawIconTables=s.default.getTablesRowsValues(this.rows,s.default.visualType)},v.prototype.filterTable=function(e){var t=this;if(!s.default.hasLoadingContent(t.tableWrapper)){if(t.isLockEnabled)return t.appendTotalRow(),t.appendTotalCol(),t.appendSparklines(),t.setTablesReady(),void t.prepareExport();var a=t.getFilterContainers();e?t.filterContainer(e.parents(".filter-container.sortable")):t.filterContainer(a),t.showTable(t.isAND),t.filtered=!1,a.not(".columnhider-element").each((function(){var e=$(this);t.filtered=t.filtered||e.data("filtered");var a=e.data("state");if(a)for(var l=0;l<a.length;l++)for(var i=0;i<a[l].length;i++)t.isAND?t.cbState[l][i]=t.cbState[l][i]&&a[l][i]:t.cbState[l][i]=t.cbState[l][i]||a[l][i];t.correctionWithAllowRowList()})),t.filtered||t.isAND||t.showTable(!0);var l=a.filter(".columnhider-element").data("state");l&&l.length&&(t.tdNumbers=l),t.setTablesReady(),t.showOrHideTables(),t.appendTotalRow(),(t.updateSparkline||t.tableUpdated)&&(t.rows[0]&&!t.rows[0].eq(0).find(".total-col.tf-hidden-column").length&&t.appendTotalCol(),t.appendSparklines(),t.updateSparkline=!1,t.tableUpdated=!1,t.sparkline&&t.fixedRows>0&&t.updateFixedCells()),t.blockEvent||t.tableWrapper.trigger("tf-filtered-total",t.getEventData()),t.shouldUpdateSelectOptions&&t.setSelectOptions(),t.filtered||l&&l.length?(t.menu.find(".filter-reset").removeClass("tf-disabled-link"),t.menu.find(".disableLock").removeClass("tf-disabled-link")):(t.menu.find(".filter-reset").addClass("tf-disabled-link"),t.params.showNRows>=0||t.menu.find(".disableLock").addClass("tf-disabled-link")),t.prepareExport(),t.editorMacro&&t.editorMacro.data("tf-self",!0).attr("type",JSON.stringify(t.getFilters())),m.default.create(t,t.editorMacro)}},v.prototype.prepareExport=function(e){var t=this;t.sortWait=t.sortWait||!t.sorts.length||e,t.blockEvent||s.default.hasLoadingContent(t.tableWrapper)||!t.sortWait||(clearTimeout(t.exportTimer),t.exportTimer=setTimeout((function(){t.tableWrapper.trigger("tf-export-ready",{macroId:t.macroId})}),300))},v.prototype.setTablesReady=function(){this.tables.data("tf-ready",!0)},v.prototype.getFilterContainers=function(){return this.comboBoxDiv.find(".filter-container.sortable").filter((function(){return"none"!==this.style.display}))},v.prototype.filterContainer=function(e){var t=this;e.find("select, input").each((function(){var e=$(this);if(e.is(".select"))t.treatSelectFilter(e);else if(e.is(".user-filter"))t.treatUserFilter(e);else if(e.is(".number"))t.treatNumberFilter(e);else if(e.is(".date"))t.treatDateFilter(e);else if(e.is(".global-filter"))t.treatGlobalFilter(e);else if(e.is(".column-select"))t.treatColumnFilter(e);else{if(!e.is(".icon-select"))return;t.treatIconFilter(e)}t.highlightFilteredColumn(e)}))},v.prototype.showTable=function(e){var t=this,a=t.tables.length;t.cbState=new Array(a),t.tdNumbers=new Array(a);for(var l=0;l<a;l++){t.tdNumbers[l]=[],t.cbState[l]=new Array(t.rows[l].length>0?t.rows[l].length-1:0);for(var i=0;i<t.cbState[l].length;i++)t.cbState[l][i]=e}},v.prototype.treatSelectFilter=function(e){var t=this,a=[];e.find("option:selected").each((function(){var e=$.trim(this.textContent);e==="-Empty-"?e="":"@currentUser"===e&&(e=n.default.getCurrentUserFullName(),a.push(n.default.getCurrentUserName())),a.push(s.default.clearStringLowerCase(e))}));var l=e.parent();if(0===a.length)return l.data("state",[]),void l.data("filtered",!1);var i,r=e.attr("name"),o=e.hasClass("inverse");i=t.ddSeparator?function(e,a){if(""===e)return-1===$.inArray(e,a);var l=!0;return e.split(t.ddSeparator).some((function(e){return(e=e.trim())&&(l=-1===$.inArray(e,a)),!l})),l}:function(e,t){return-1==$.inArray(e,t)};var c=[];t.rawTables.forEach((function(e,l){var n=s.default.getCellPositions(e,r);c[l]=[],n.length&&e.forEach((function(e,r){if(r>0){var d=!0;n.forEach((function(t){var l=s.default.clearStringLowerCase(e[t]);d=d&&i(l,a)})),d=t.isAND?d:!d,c[l][r-1]=o!=d?!t.isAND:t.isAND}}))})),l.data("state",c),l.data("filtered",!0)},v.prototype.treatIconFilter=function(e){var t=this,a=[],l=[],i=!1;e.find("option:selected").each((function(){var e=$.trim(this.textContent);if(e=="-Empty-")i=!0;else{var t=$(e);t.length&&(t.is("ul")?l.push("ul.inline-task-list li"+(t.find("li").hasClass("checked")?".checked":":not(.checked)")):((e=t[0].src)&&(e=s.default.clearStringLowerCase(e),e=s.default.clearIconSrc(e)),a.push(e)))}}));var r=e.parent();if(0==a.length&&0==l.length&&!i)return r.data("state",[]),void r.data("filtered",!1);l=l.join(",");var n=e.attr("name"),o=e.hasClass("inverse"),c=[];t.tables.each((function(e){var r=t.rows[e],d=s.default.getCellPositions(t.rawTables[e],n);c[e]=[],d.length&&r.each((function(r){if(r>0){var n=!0,f=this;d.forEach((function(e){var t,r,o,c=s.default.getNthTdElem(f,e);a.length&&s.default.getTdIconsSrc(c).some((function(e){return e&&(e=s.default.clearStringLowerCase(e),e=s.default.clearIconSrc(e)),!(t=-1==$.inArray(e,a))})),l&&(r=0==c.find(l).length),i&&(o=c.find("ul.inline-task-list li, img[src]").length>0),n=n&&(!1!==t&&!1!==o&&!0===r||!0===t&&!1!==o&&!1!==r||!1!==t&&!0===o&&!1!==r)})),n=t.isAND?n:!n,c[e][r-1]=o!=n?!t.isAND:t.isAND}}))})),r.data("state",c),r.data("filtered",!0)},v.prototype.treatInputFilter=function(e,t){var a,l=this,i=e.val(),r=s.default.clearStringLowerCase(i);if("@currentUser"==i&&(i=n.default.getCurrentUserFullName()+"|"+n.default.getCurrentUserName()),r.indexOf("&")>0){var o="";$.each(i.split("&"),(function(e,t){o+="(?=.*"+t.trim()+")"})),i=o}try{var c=new RegExp(i,"i")}catch(e){}t&&(a=e.attr("name"));var d=e.parents(".filter-container.sortable");if(""==r)return d.data("state",[]),void d.data("filtered",!1);var f=e.hasClass("inverse"),p=[];l.rawTables.forEach((function(e,i){var n=s.default.getCellPositions(e,a);p[i]=[],t&&!n.length||e.forEach((function(e,a){if(a>0){var o="";t?(n.forEach((function(t){e[t]&&(o=o+" "+e[t])})),o=o.trim()):o=e.join(" ");var d=-1==s.default.clearStringLowerCase(o).indexOf(r)&&(!c||null==o.match(c));d=l.isAND?d:!d,p[i][a-1]=f!=d?!l.isAND:l.isAND}}))})),d.data("state",p),d.data("filtered",!0)},v.prototype.treatGlobalFilter=function(e){this.treatInputFilter(e,!1)},v.prototype.treatUserFilter=function(e){this.treatInputFilter(e,!0)},v.prototype.treatDateFilter=function(e){var t=this,a=$.trim(e.val()),l=e.attr("name"),i=e.attr("dateformat"),r=e.attr("locale"),n=e.hasClass("from"),o=e.hasClass("inverse");if(n)t.rangeFilterValues={from:f()};else{var c=e.parent().parent();if(t.rangeFilterValues.to=f(),t.rangeFilterValues.from||t.rangeFilterValues.to){var d=[];t.rawTables.forEach((function(e,a){var n=s.default.getCellPositions(e,l);d[a]=[],n.length&&e.forEach((function(e,l){if(l>0){var c=!0;n.forEach((function(a){var l=e[a]||"";try{var n=s.default.parseDate(l,i,r);n?o?t.rangeFilterValues.from?c=t.rangeFilterValues.to?c&&t.rangeFilterValues.from<=n&&t.rangeFilterValues.to>=n:c&&t.rangeFilterValues.from<=n:t.rangeFilterValues.to&&(c=c&&t.rangeFilterValues.to>=n):t.rangeFilterValues.from?c=t.rangeFilterValues.to?c&&(t.rangeFilterValues.from>n||t.rangeFilterValues.to<n):c&&t.rangeFilterValues.from>n:t.rangeFilterValues.to&&(c=c&&t.rangeFilterValues.to<n):c=c&&!o}catch(e){c=!1,AJS.log("Error while filtering date '"+l+"': "+e)}})),c=t.isAND?c:!c,d[a][l-1]=c?!t.isAND:t.isAND}}))})),c.data("state",d),c.data("filtered",!0)}else c.data("state",[]),c.data("filtered",!1)}function f(){try{var e;if("today"==a||"heute"==a)return(e=new Date).setHours(0,0,0,0);var t=["y","m","w","d"],l=!1;return t.some((function(e){if(new RegExp("^[+-]?\\d+"+e).test(a))return l=!0,!0})),l?((e=new Date).setHours(0,0,0,0),t.forEach((function(t,l){var i=a.split(t);if(2==i.length){var r=parseInt(i[0]);3==l?e.setDate(e.getDate()+r):2==l?e.setDate(e.getDate()+7*r):1==l?e.setMonth(e.getMonth()+r):e.setYear(e.getFullYear()+r),a=i[1]}})),e):s.default.parseDate(a,i,r)}catch(e){return AJS.log("Error while filtering by date '"+a+"': "+e),!1}}},v.prototype.treatNumberFilter=function(e){var t=this,a=$.trim(e.val()).toLocaleLowerCase(),l=e.attr("name"),i=e.hasClass("inverse"),r=e.hasClass("from"),n=s.default.getValueType(a,t.separator,t.worklog),o=s.default.parseValueByType(n,a,t.separator,t.worklog);if(o=!isNaN(o)&&o,r)t.rangeFilterValues={from:o,type:n};else{t.rangeFilterValues.type&&(n=t.rangeFilterValues.type),t.rangeFilterValues.to=o;var c=e.parent().parent();if(!1!==t.rangeFilterValues.from||!1!==t.rangeFilterValues.to){var d=[];t.rawTables.forEach((function(e,a){var r=s.default.getCellPositions(e,l);d[a]=[],r.length&&e.forEach((function(e,l){if(l>0){var o=!0;r.forEach((function(a){var l=e[a]||"";try{var r=s.default.parseValueByType(n,l,t.separator,t.worklog);isNaN(r)?o=o&&!i:i?!1!==t.rangeFilterValues.from?o=!1!==t.rangeFilterValues.to?o&&t.rangeFilterValues.from<=r&&t.rangeFilterValues.to>=r:o&&t.rangeFilterValues.from<=r:!1!==t.rangeFilterValues.to&&(o=o&&t.rangeFilterValues.to>=r):!1!==t.rangeFilterValues.from?o=!1!==t.rangeFilterValues.to?o&&(t.rangeFilterValues.from>r||t.rangeFilterValues.to<r):o&&t.rangeFilterValues.from>r:!1!==t.rangeFilterValues.to&&(o=o&&t.rangeFilterValues.to<r)}catch(e){o=!1,AJS.log("Error while filtering number '"+l+"': "+e)}})),o=t.isAND?o:!o,d[a][l-1]=o?!t.isAND:t.isAND}}))})),c.data("state",d),c.data("filtered",!0)}else c.data("state",[]),c.data("filtered",!1)}},v.prototype.treatColumnFilter=function(e){var t=this;t.updateSparkline=!0;var a=[];e.find("option:selected").each((function(){var e=$.trim(this.textContent);e=="-Empty-"&&(e=""),a.push(e.toLocaleLowerCase())}));var l=e.hasClass("inverse"),i=e.parent();if(0!=a.length){var r=[];t.rawTables.forEach((function(e,i){r[i]=[];var n=e[0]||[];n.forEach((function(e,o){l!=$.inArray(s.default.clearStringLowerCase(e),a)>=0&&(r[i].push(o),o==n.length-1&&(t.updateSparkline=!1))}))})),i.data("state",r)}else i.data("state",[])},v.prototype.showOrHide=function(e,t,a,l,i){var r=this,s=0;if(t>r.headerSize[e])if(!r.cbState[e][t-1]&&i<t)$(a).find("td[rowspan], th[rowspan]").trigger("hideCell"),a.style.display="none";else if(r.numbering&&(-1!=r.numbering.indexOf("dynamic")||"true"==r.numbering)){var n=a.children[0];n.classList.contains("tf-numbering")&&(n.children[0].textContent=l,r.rawTables[e][t][0]=""+l),s=1}if(r.tdNumbers&&r.tdNumbers[e].length){var o=a.children;$.each(r.tdNumbers[e],(function(e,t){$(o[t]).trigger("hideCol").addClass("tf-hidden-column")}))}return s},v.prototype.showTableWithoutFilters=function(){var e=this;e.showTable(!0),e.showOrHideTables(),e.appendTotalRow(),e.appendTotalCol(),e.appendSparklines(),e.blockEvent||e.tableWrapper.trigger("tf-filtered-total",e.getEventData()),e.sparkline&&e.fixedRows>0&&e.updateFixedCells(),m.default.create(e)},v.prototype.showOrHideTables=function(){var e=this,t=0,a=0,l=e.params.showNRows;e.isLockEnabled&&(e.params.showNRows="all"),e.tables.each((function(l){var i=$(this),r=e.rows[l],n=i.hasClass("relative-table");r.children(".tf-hidden-column").removeClass("tf-hidden-column"),r.children("[colspan]").each((function(){var e=$.data(this,"colspan");e&&(this.colSpan=e)}));var o=i.children("colgroup").children("col");if(n){var c=0,d=[];o.each((function(){"none"===this.style.display?c+=parseFloat(this.style.width):d.push(this)})),c>0&&(i.css("width",parseFloat(i[0].style.width)/(1-c/100)+"%"),d.forEach((function(e){e.style.width=parseFloat(e.style.width)*(1-c/100)+"%"})))}o.show();var f=i.find("tr.pivot-header, thead.tableFloatingHeader tr");if(f.children(".tf-hidden-column").removeClass("tf-hidden-column"),e.tdNumbers&&e.tdNumbers[l].length){c=0;$.each(e.tdNumbers[l],(function(e,t){o.eq(t).hide(),n&&(c+=parseFloat(o[t].style.width)),f.each((function(){$(this).find("th, td").eq(t).trigger("hideCol").addClass("tf-hidden-column")}))})),c>0&&(i.css("width",parseFloat(i[0].style.width)*(1-c/100)+"%"),o.each((function(t){-1===e.tdNumbers[l].indexOf(t)&&(this.style.width=parseFloat(this.style.width)/(1-c/100)+"%")})))}i.is(".attachments")&&i.find(".attachment-summary").each((function(t){e.cbState[l][t]||($(this).addClass("hidden"),r.eq(t+1).find(".icon-section-opened").removeClass("icon-section-opened").addClass("icon-section-closed"))}));var p=r.children(".fake").hide();r.children("td[rowspan], th[rowspan]").each((function(){this.rowSpan=$.data(this,"rowspan")||1})),r.each((function(){this.style.display=""})),t+=r.length-1;var u=e.params.ignoreFirstNrows,m=$.grep(e.cbState[l],(function(e,t){return e||u>t})).length,h=1,b=1;if(e.numbering&&-1!=e.numbering.indexOf("desc")&&(h=m,b=-1),r.each((function(t){h+=e.showOrHide(l,t,this,h,u)*b})),"all"!=e.params.showNRows&&e.params.showNRows>=0&&!e.filtered){var v=e.params.showNRows;r.filter((function(){return s.default.isRowVisible(this)})).filter(":gt("+v+")").hide(),m=Math.min(m,v)}e.editorMacro&&(p.filter("[rowspan]:not(:visible)").attr("rowspan",-1),p.filter("[colspan]:not(:visible)").attr("colspan",-1)),a+=m})),t===a?e.filterIcon.removeClass("filtered").addClass("default").attr("title",AJS.format("Nothing filtered. Showing {0} rows",t)):e.filterIcon.removeClass("default").addClass("filtered").attr("title",AJS.format("Showing {0} of {1} rows",a,t)),e.filterIcon.attr("data-count","".concat(a,"/").concat(t)),e.resize&&e.resize(),e.params.showNRows=l;var i=e.getEventData();e.blockEvent||e.tableWrapper.trigger("tf-filtered",i),e.tables.trigger("tf-filtered-charts").trigger("scroll-tf"),e.comboBoxDiv.parents(".tablefilter-table-wrapper, .pivot-content, table").eq(0).data("inner-filter",i)},v.prototype.getEventData=function(){return{id:"tf-table-"+this.macroId,tf:this,macroId:this.macroId}},v.prototype.appendSparklines=function(){var e=this;if(e.pauseUpdate=!0,e.setMutationObserver(!0),e.spakLinesFinished=!0,e.sparkline)e.rows.forEach((function(t,a){!function(t,a){var l=null,i=0;function r(e){return(e.find(":first-child").attr("class")||"").replace("tf-numbering","").replace("tf-hidden-column","")}function n(e,t){var a=100,l=25,i=$('<svg xmlns="http://www.w3.org/2000/svg"/>').attr("width",a).attr("height",l);function r(e){if(e.length>1){var t=a/(e.length-1),i=Math.min.apply(Math,h(e)),r=Math.max.apply(Math,h(e))-i,s=0===r?l/2:l/r,n=e.map((function(e,a){return[t*a,0===r?s:l-s*(e-i)]}));return"M".concat(n.join("L"))}return""}var s=$(document.createElementNS("http://www.w3.org/2000/svg","path")).attr("d",r(t)).attr("style","stroke: rgb(100, 100, 255); stroke-width: 1; fill: none;");i.append(s),e.append(i)}t.each((function(o,c){var d=$(c);d.find(".tf-sparkline-header, .tf-sparkline-container").remove();var f=r(d);if(0===o){if(d.append($('<th class="'.concat(f,' tf-sparkline-header synchrony-exclude" contenteditable="false" data-sorter="false"></th>')).text(e.sparkName)),c.classList.contains("tf-header-hidden")){var p=$(a).find("tr.pivot-header"),u=p.eq(0);u.find(".tf-sparkline-header").remove(),u.append($('<th class="'.concat(r(u),' tf-sparkline-header synchrony-exclude" contenteditable="false" data-sorter="false" rowspan="').concat(p.length,'">\n                              </th>')).text(e.sparkName))}}else{var m=[];d.children("td, th").not(".tf-numbering, .total-col, .numberingColumn").each((function(t){if($(this).hasClass("tf-hidden-column"))return!0;var a=s.default.clearString(this.textContent);null==l&&a&&(l=s.default.getValueType(a,e.separator,e.worklog,!0));var i=s.default.parseValueByType(l,a,e.separator,e.worklog,!0);isNaN(i)||m.push(i)}));var h=$('<td class="'.concat(f,' tf-sparkline-container synchrony-exclude" contenteditable="false"></td>'));if(n(h,m),d.append(h),!e.editorMacro){var b=d.find("svg").attr("version",1.1).prop("outerHTML");if("undefined"!=typeof btoa&&b){h.append("<canvas></canvas>");var v="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(b))),g=d.find("canvas").attr("width",100).attr("height",25)[0],w=g.getContext("2d"),y=new Image;y.src=v,y.onload=function(){w.drawImage(y,0,0);var e=g.toDataURL("image/png"),l='<img src="'.concat(e,'">');h.html(l),++i===t.length-1&&$(a).trigger("sparklines-converted")}}}}}))}(t.add(e.totalRows[a]),e.tables[a])})),e.updateSorterAndRawTables(!0),e.pauseUpdate=!1,e.setMutationObserver(!0);else{var t=e.tableWrapper.find(".tf-sparkline-header, .tf-sparkline-container"),a=t.length;t.remove(),e.updateSorterAndRawTables(a>0),e.pauseUpdate=!1,e.setMutationObserver(!0)}},v.prototype.appendTotalRow=function(){var e=this;if(e.pauseUpdate=!0,e.setMutationObserver(!0),e.tables.find("tr.total-row").remove(),e.totalRows=[],e.totalRow.length){var t=0;e.tableUpdated=!0,e.rawTables.forEach((function(a,l){for(var i={},r=e.numbering?1:0,n=e.rows[l].eq(0).children().not(".tf-sparkline-header, .total-col").length-r,o={},c=t;c<n+t;c++){var d=c-t+r;if(e.totalRow[c]){var f=y,p=!1,m=!1,h=!1;"Sum"==e.totalRow[c]?f=w:"Min"==e.totalRow[c]?f=x:"Max"==e.totalRow[c]?f=T:"Multiplication"==e.totalRow[c]?f=g:"Count"==e.totalRow[c]?(f=C,m=!0):"Count not empty"==e.totalRow[c]?(f=C,h=!0):p=!0,i[d]={calc:f,isAvg:p,isCount:m,isCountA:h}}o[d]=e.getTotalCellClasses(l,d)}t+=n;var b=null;if(Object.keys(i).length){var v={},S={};a.forEach((function(t,a){a>0&&s.default.isRowVisible(e.rows[l][a])&&$.each(i,(function(i,r){if(r.isCount)r.calc();else if(r.isCountA)(t[i]||e.rawIconTables[l][a][i])&&r.calc();else{null==v[i]&&t[i]&&(v[i]=s.default.getValueType(t[i],e.separator,e.worklog));var n=s.default.parseValueByType(v[i],t[i],e.separator,e.worklog);s.default.isNumber(n)&&(r.calc(n),v[i]!==s.default.number||S[i]||(S[i]=s.default.getNumberFormatter(t[i],e.separator)))}}))}));var F=!1,k=!0;if($.each(i,(function(t,a){a.total=s.default.formatValueByType(a.total,v[t],(function(l){if(void 0!==l){F=!0,a.isAvg&&(l=I(l));var i=e.formatDecimal.to(l);return S[t]?S[t](i):i}return""}),e.worklog),""!==a.total&&(F=!0)})),F){if(b=$(u().totalRow({title:e.totalRowName,length:n+r,totals:i,numbering:r,isFireFox:s.default.isFireFox(),classes:o})),e.tdNumbers&&e.tdNumbers[l].length){k=!1;var H=b.children("td,th");$.each(e.tdNumbers[l],(function(e,t){H.eq(t).addClass("tf-hidden-column")})),$.each(H,(function(e,t){if(t.textContent&&!$(t).hasClass("tf-hidden-column"))return k=!0,!1}))}k&&e.tables.eq(l).append(b)}}e.totalRows.push(b),e.updateSorterAndRawTables(!1,!0)}))}e.pauseUpdate=!1,e.setMutationObserver(!0)},v.prototype.getTotalCellClasses=function(e,t){var a="";return a+=this.rows[e][0].cells[t].classList.contains("pivot-hidden-column")?"pivot-hidden-column":""},v.prototype.appendTotalCol=function(){var e=this;if(!s.default.hasLoadingContent(e.tableWrapper)){e.pauseUpdate=!0,e.setMutationObserver(!0);var t=!1;if(e.totalCol){var a=y,l=!1,i=e.totalCol;"Sum"==e.totalCol?a=w:"Min"==e.totalCol?a=x:"Max"==e.totalCol?a=T:"Multiplication"==e.totalCol?(a=g,i="Product"):l=!0,i=e.totalColName?e.totalColName:i,e.tables.each((function(t){var r=null,n=null;if(e.rows[t].length&&e.rows[t][0].classList.contains("tf-header-hidden")){var o=$(this).find("tr.pivot-header"),c=o.eq(0);if(0===c.children("th.total-col").length){var d=$('<th class="total-col confluenceTh" rowspan="'.concat(o.length,'"></th>')).text(i);c.append(d)}}e.rows[t].add(e.totalRows[t]).each((function(t){for(var o={calc:a},c=this.children,d=null,f=c.length-1;f>=0;f--)if(c[f].classList.contains("total-col")){d=$(c[f]);break}if(d||(d=$(u().totalCol({rowNumber:t})),$(this).append(d)),0===t)d.find("p").text(i);else{for(f=0;f<c.length;f++){var p=c[f];if(!(p.classList.contains("tf-numbering")||p.classList.contains("total-col")||p.classList.contains("numberingColumn")||p.classList.contains("pivot-hidden-column"))){if(!p.classList.contains("tf-hidden-column")){var m=s.default.clearString(p.textContent);null==r&&m&&(r=s.default.getValueType(m,e.separator,e.worklog,!0));var h=s.default.parseValueByType(r,m,e.separator,e.worklog,!0);s.default.isNumber(h)&&(o.calc(h),r!==s.default.number||n||(n=s.default.getNumberFormatter(m,e.separator)))}0}}var b=s.default.formatValueByType(o.total,r,(function(t){if(void 0===t)return"";l&&(t=I(t));var a=e.formatDecimal.to(t);return n?n(a):a}),e.worklog),v=d.attr("contenteditable","false").children("p");v.length||(v=$("<p></p>"),d.prepend(v)),v.text(b)}}))})),t=!0}else{var r=e.tables.find("th.total-col");r.length&&(t=!0,r.remove())}return t&&e.updateSorterAndRawTables(!0,!0),e.pauseUpdate=!1,e.setMutationObserver(!0),t}},v.prototype.updateSorterAndRawTables=function(e,t){var a=this;a.shouldUpdateSorter=a.shouldUpdateSorter||t,a.shouldUpdateRawTables=a.shouldUpdateRawTables||e,a.spakLinesFinished&&(a.shouldUpdateSorter&&(a.tables.not(".pivot-table-result,.merged-header").trigger("updateAll",!1),a.tables.not(".pivot-table-result").trigger("update",!1)),a.shouldUpdateRawTables&&a.updateRawTables(),a.shouldUpdateSorter=!1,a.shouldUpdateRawTables=!1,a.spakLinesFinished=!1)},v.prototype.bindChangeLabel=function(){var e=this;e.comboBoxDiv.delegate(".filter-container label.hideble","dblclick",(function(){var t=$(this).find(".tf-label-name"),a=!0,l=$(this).parent(),i=t.css("width");t.hide(),l.prepend(u().labelChanger({value:t.text(),width:parseInt(i,10)+6+"px"}));var r=!1,s=l.find(".tf-label-changer");s.focus(),s.bind("keydown",(function(l){13==l.keyCode&&(t.text(s.val()),s.remove(),t.show(),a=!1,e.enableSaveBtn()),32==l.keyCode&&(r=!0)})),s.bind("input",(function(){var e=s.textWidth(s.html())+6;r&&(e+=4,r=!1),s.css("width",(e<10?10:e)+"px")})),$(document).one("click",(function(e){!$(e.target).closest(".tf-label-changer").length&&a&&(s.remove(),t.show(),a=!1)}))})),$.fn.textWidth=function(e,t){return $.fn.textWidth.fakeEl||($.fn.textWidth.fakeEl=$("<span>").hide().appendTo(document.body)),$.fn.textWidth.fakeEl.text(e||this.val()||this.text()).css("font",t||this.css("font")),$.fn.textWidth.fakeEl.width()}},v.prototype.getFilterLabels=function(){var e=this,t=[];return a(".selectfilter-element"),a(".userfilter-element"),a(".numberfilter-element"),a(".datefilter-element"),a(".globalfilter-element"),a(".columnhider-element"),a(".iconfilter-element"),t.join("‚");function a(a){e.comboBoxDiv.find(a+" .tf-label-name").each((function(){t.push($(this).text())}))}},v.prototype.initInlineFilterButton=function(){var e=this,t=this,a=t.tables.eq(0),l=t.filterIcon.parent();t.inlineFilterBtns=t.outerWrapper.find(".tf-inline-filter"),t.inlineFilterBtn=t.inlineFilterBtns.filter(".btn"),t.inlineFilterTrigger=t.inlineFilterBtns.filter(".trigger");var i,r,n,o,c,d,f,p=!1;function u(){f&&(f.unwrap(),f.css(f.orig_sizes),f.elclone.before(f),f.elclone.remove(),f=null)}function m(){i&&h(i,t.inlineFilterBtn),r&&(h(r,t.inlineFilterTrigger),p&&(t.comboBoxDiv.find("select").trigger("chosen:close"),t.comboBoxDiv.removeAttr("open"),p=!0,t.comboBoxDiv.attr("open",!0)))}function h(e,a){var l=e.offset();a.offset({top:d?void 0:l.top-3,left:Math.min(l.left+e.outerWidth(),t.tableWrapper.offset().left+t.tableWrapper.width())-16}).addClass("visible")}function b(){var e=t.tables.eq(0).offset(),i=t.tableWrapper.eq(0).offset();l.offset({top:Math.max(e.top,i.top)+5,left:Math.max(e.left,i.left)+Math.min(a.width(),t.tableWrapper.width())-2})}t.inlineFilterBtn.unbind("click").click((function(a){h(r=i,t.inlineFilterTrigger),e.comboBoxDiv.removeAttr("open"),e.comboBoxDiv.attr("open",!0),a.stopPropagation()})),this.comboBoxDiv.unbind("aui-hide aui-show").bind("aui-hide",(function(){p=!1,t.inlineFilterTrigger.removeClass("active mimic"),t.filterIcon.removeClass("open"),u(),F()})).bind("aui-show",(function(){var a;p||(r=i),p=!0,t.inlineFilterTrigger.addClass("active"),t.inlineFilterTrigger.removeClass("visible");var l="";r?(l=s.default.getCellText(r[0]),a='[name="'.concat(l,'"]')):a="."+("globalfilter"===n?"global-filter":"column-select");var c=e.comboBoxDiv.find(".filter-container").addClass("hidden").find("input,select").filter(a).parents(".filter-container").removeClass("hidden");c.length||(c=e.addFilter(r?e.detectFilterType(l):n,l)),clearTimeout(o),o=setTimeout((function(){return c.find("input").eq(0).focus()}),100)})),this.menu.find(".show-filter").unbind("click").click((function(){i=null,r=null;var e=t.tables.eq(0).offset();t.inlineFilterTrigger.addClass("mimic").offset({top:e.top+5,left:Math.max(e.left,t.tableWrapper.offset().left)+Math.min(a.width(),t.tableWrapper.width())+11}),t.filterIcon.addClass("open"),n=$(this).attr("data-filter-type"),t.comboBoxDiv[0].open=!0})),this.rows.forEach((function(e){var a=$(e[0]).children(),l=t.numbering&&!a[0].classList.contains("tf-numbering")?1:0;e.find("td,th").unbind("mouseleave.tf mouseenter.tf").bind("mouseleave.tf",(function(){!p&&t.inlineFilterTrigger.removeClass("visible"),t.inlineFilterBtn.removeClass("visible")})).bind("mouseenter.tf",(function(){i=a.eq(this.cellIndex-l);var e=!1;t.getFilterByCell(i).each((function(){$(this).val()&&(e=!0)})),t.inlineFilterBtn.toggleClass("filtered",e),h(i,t.inlineFilterBtn),p||(r=i,t.inlineFilterTrigger.toggleClass("filtered",e),h(i,t.inlineFilterTrigger))}))})),this.tables.parents(".table-wrap, .table-wrap-aui").unbind("scroll.live").bind("scroll.live",(function(){d=!0,m(),clearTimeout(c),c=setTimeout((function(){return d=!1}),50)})),this.tableWrapper.unbind("tf-filtered.live").bind("tf-filtered.live",(function(){setTimeout((function(){m(),b()}),20)})),a.unbind("mouseleave.tf mouseover.tf").bind("mouseover.tf",(function(){b(),t.filterIcon.addClass("visible")})).bind("mouseleave.tf",(function(){return t.filterIcon.removeClass("visible")})),this.comboBoxDiv.undelegate("chosen:showing_dropdown.live").delegate("select","chosen:showing_dropdown.live",(function(e,a){if(u(),"true"!==t.comboBoxDiv.attr("aria-hidden")){var l=(f=a.chosen.container)[0],i=l.style,r=l.getBoundingClientRect();f.orig_sizes={width:f.width(),height:f.height(),position:i.position,top:i.top,left:i.left,zIndex:i.zIndex};var s=$.extend({},f.orig_sizes);s.position="absolute",s.top=r.top+window.pageYOffset,s.left=r.left+window.pageXOffset,s.zIndex=999999;var n=f.elclone=f.clone();n.find(".chosen-drop").remove(),f.before(n),f.css(s),$("body").append($('<div class="wiki-content"></div>').append(f)),f.click((function(e){return e.stopPropagation()}))}})).undelegate("chosen:hiding_dropdown.live tf-close.live").delegate("select","chosen:hiding_dropdown.live tf-close.live",u)},v.prototype.highlightFilteredColumn=function(e){var t=this;if("Table header"===this.params.hidePane&&!this.editorMacro){var a=this.hasFilterValues(e),l=e.attr("name");this.rawTables.forEach((function(e,i){s.default.getCellPositions(e,l).forEach((function(e){s.default.getNthTdElem(t.rows[i][0],e).toggleClass("filtered-header",a),t.inlineFilterTrigger.toggleClass("filtered",a)}))}))}},v.prototype.hasFilterValues=function(e){var t=Boolean(e.val());return(e.hasClass("date")||e.hasClass("number"))&&(t=t||Boolean(e.parents(".range").find("input").not(e).val())),t},v.prototype.getFilterByCell=function(e){var t=s.default.getCellText(e[0]);return this.comboBoxDiv.find("input,select").filter('[name="'.concat(t,'"]'))},v.prototype.detectFilterType=function(e){var t=this;if(this.getDateMacroFormatIfPresent(e))return"datefilter";var a="userfilter";return this.rawTables.some((function(l,i){var r=s.default.getCellPosition(l,e);if(null!=r){var n=l.map((function(e){return e[r]})).filter((function(e,t){return t&&e}));if(n.length){var o=s.default.getDateFormat(n,t.locale,t.dateFormat);if(o)t.dateFormat=o,a="datefilter";else if(null!==s.default.getValueType(n[0],t.separator,t.worklog,!0))a="numberfilter";else if(new Set(n).size<n.length)a="selectfilter";else if(n.length<51){n.reduce((function(e,t){return e+t})).length/n.length<30&&(a="selectfilter")}return!0}if(t.rawIconTables||t.updateRawIconTables(),t.rawIconTables[i].map((function(e){return e[r]})).filter((function(e){return e})).length)return a="iconfilter",!0}})),a},v.prototype.addToAllowRowList=function(e){var t=this,a=e.closest("table");if(a.length){var l=t.tables.index(a),i=t.rows[l].index(e);t.allowRowList||(t.allowRowList=new Array(t.tables.length)),t.allowRowList[l]||(t.allowRowList[l]=[]),t.allowRowList[l].push(i)}},v.prototype.correctionWithAllowRowList=function(){var e=this;e.allowRowList&&e.allowRowList.forEach((function(t,a){t&&t.forEach((function(t){e.cbState[a][t-1]=!0}))}))},v.prototype.setTextForFakeCells=function(e){for(var t=e.html(),a=e;a.data("childCell");)(a=a.data("childCell")).html(t);for(var l=e;l.data("parentCell");)(l=l.data("parentCell")).html(t)},t.default=v}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:e734d1c0109eddb349b4493fa42e5e4a', location = 'build/401.js' */
(self.webpackChunk=self.webpackChunk||[]).push([[401],{46401:function(a,e,t){"use strict";t.r(e);var i=t(16951),n=t.n(i),r=t(14978);function s(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}var o=function a(e,t,i,o,l,g){var d=this;!function(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),s(this,"removePaginationAttribute",(function(){d.removeRowsPaginationAttribute($(d.rows).add(d.rowHeader)),$(d.table).removeAttr("pagination")})),s(this,"removeRowsPaginationAttribute",(function(a){var e=a.filter("[visibleForPagination]");e.removeAttr("visibleForPagination visibleForPaginationAnim"),e.children("td[visibleForPagination]").each((function(a,e){var t=$(e);t.removeAttr("visibleForPagination");var i=t.data("savedRowSpan");i&&t.attr("rowspan",i);var n=t.data("savedColSpan");n&&t.attr("colspan",n)}))})),s(this,"getParrentTableElement",(function(a){var e=$(a).closest(".tablefilter-table-wrapper .table-wrap");return e.length?e[0]:d.tablefilter.isCloud?a.parentNode:d.findParrentTableElement(a)})),s(this,"findParrentTableElement",(function(a){var e=$(a).parent();return e.length?e.hasClass("tablefilter-table-wrapper")?a:d.findParrentTableElement(e[0]):null})),s(this,"getPaginationPages",(function(a){d.removeRowsPaginationAttribute($(d.rows));var e=[],t=0,i=0;e[t]=[];var n=d.rows.length,s=!1;d.tablefilter.filtered||(s=!0,d.tablefilter.params.showNRows>0&&(n=Math.min(n,parseInt(d.tablefilter.params.showNRows))));for(var o=0;o<n;o++){var l=d.rows[o];(s||r.default.isRowVisible(l))&&(i>=a&&(i=0,e[++t]=[]),e[t][i]=l,i++)}return e})),s(this,"addPaginationPanel",(function(a){var e=$(d.render());$(a).after(e),d.panel=e,d.paginationItems=e.find("li:not(.aui-nav-pages)"),d.itemPrev=$(d.paginationItems[0]),d.itemFirst=$(d.paginationItems[1]),d.itemTruncationLeft=$(d.paginationItems[2]),d.itemTruncationRight=$(d.paginationItems[d.paginationItems.length-3]),d.itemLast=$(d.paginationItems[d.paginationItems.length-2]),d.itemNext=$(d.paginationItems[d.paginationItems.length-1]),d.items=d.paginationItems.slice(3,d.paginationItems.length-3);var t=d;return d.paginationItems.off("click").click((function(){return t.showPaginationsPage($(this).data("index-page"),t.pages),!1})),e})),s(this,"showPaginationsPage",(function(a,e){a=a||0,a=Math.min(Math.max(a,0),d.pages.length-1);var t=$(e[d.indexCurrentPage]);d.removeRowsPaginationAttribute(t),d.indexCurrentPage=a;var i=$(e[a]);i.attr("visibleForPagination","true"),setTimeout((function(){i.attr("visibleForPaginationAnim","true")}),0),d.showMergeCells(i),d.selectedPagination()})),s(this,"showMergeCells",(function(a){a.children("td.fake").each((function(a,e){for(var t=$(e),i=t;i.data("parentCell");){var n=i.data("parentCell"),s=n.parent();if(s.attr("visibleForPagination"))break;if("none"!==n[0].style.display&&r.default.isRowVisible(s[0])){t.attr("visibleForPagination","true");var o=t.attr("rowspan");if("-1"==o){var l=d.findRowSpan(t);t.data("savedRowSpan",o),t.attr("rowspan",l)}var g=t.attr("colspan"),p=n.attr("colspan");"-1"==g&&p>0&&(t.data("savedColSpan",g),t.attr("colspan",p));break}i=n}}))})),s(this,"findRowSpan",(function(a){for(var e=1,t=a;t.data("childCell");){var i=(t=t.data("childCell")).parent();i.length&&i.attr("visibleForPagination")&&e++}return e})),s(this,"selectedPagination",(function(){var a=0,e=d.pages.length-1;d.pages.length>9&&(a=d.indexCurrentPage-3,e=d.indexCurrentPage+3,a<0?(e+=-a,a=0):e>=d.pages.length&&(a-=e-(d.pages.length-1),e=d.pages.length-1)),0==a?d.itemTruncationLeft.addClass("hidePaginationBtn"):d.itemTruncationLeft.removeClass("hidePaginationBtn"),e==d.pages.length-1?d.itemTruncationRight.addClass("hidePaginationBtn"):d.itemTruncationRight.removeClass("hidePaginationBtn"),0==d.indexCurrentPage?(d.itemPrev.addClass("passivePaginationBtn"),d.itemFirst.addClass("aui-nav-selected")):(d.itemPrev.removeClass("passivePaginationBtn"),d.itemFirst.removeClass("aui-nav-selected")),d.indexCurrentPage==d.pages.length-1?(d.itemNext.addClass("passivePaginationBtn"),d.itemLast.addClass("aui-nav-selected")):(d.itemNext.removeClass("passivePaginationBtn"),d.itemLast.removeClass("aui-nav-selected")),d.items.addClass("hidePaginationBtn"),d.items.filter("li.aui-nav-selected").removeClass("aui-nav-selected"),$(d.items[d.indexCurrentPage-1]).addClass("aui-nav-selected"),d.items.slice(a,e-1).removeClass("hidePaginationBtn"),d.itemTruncationLeft.data("index-page",a),d.itemTruncationRight.data("index-page",e),d.itemPrev.data("index-page",d.indexCurrentPage-1),d.itemNext.data("index-page",d.indexCurrentPage+1)})),s(this,"render",(function(){for(var a="",e=1;e<d.pages.length-1;e++){a+='<li data-index-page="'.concat(e,'"><a>').concat(e+1,"</a></li>")}return n().sanitize('\n     <div contenteditable = "false" class="tablefilter-pagination synchrony-exclude">\n       <ol class="aui-nav aui-nav-pagination" style = "display: inline-block; padding: 0;">\n            <li class="aui-nav-previous"><a>'.concat("Prev",'</a></li>\x3c!--\n         --\x3e<li class="aui-nav-first" data-index-page="0"><a>1</a></li>\x3c!--\n         --\x3e<li class="aui-nav-truncation"><a>&hellip;</a></li>\x3c!--\n         --\x3e<li class="aui-nav-pages">\n           <ol class="aui-nav aui-nav-pagination" style="padding: 0;">').concat(a,'</ol>\n         </li>\x3c!--\n         --\x3e<li class="aui-nav-truncation"><a>&hellip;</a></li>\x3c!--\n         --\x3e<li class="aui-nav-last" data-index-page="').concat(d.pages.length-1,'"><a>').concat(d.pages.length,'</a></li>\x3c!--\n         --\x3e<li class="aui-nav-next"><a>').concat("Next","</a></li>\n       </ol>\n     </div>"),{ADD_ATTR:["contenteditable"]})})),this.tablefilter=e,this.table=t,this.wrapper=o,this.rows=i.slice(1);var p=$(i[0]);p.hasClass("tf-header-hidden")?this.rowHeader=$(t).find("tr.pivot-header"):this.rowHeader=p,this.indexCurrentPage=g,this.parentTableElement=this.getParrentTableElement(t),this.parentTableElement&&(this.pages=this.getPaginationPages(l),this.pages.length>1?(this.addPaginationPanel(this.parentTableElement),this.showPaginationsPage(this.indexCurrentPage,this.pages),$(this.table).attr("pagination","true"),this.rowHeader.attr("visibleForPagination","true").attr("visibleForPaginationAnim","true")):this.removePaginationAttribute())};s(o,"create",(function(a,e){if(a.params.rowsPerPage>0&&a.tables.length){var t=[];a.tableWrapper.find(".tablefilter-pagination").remove();var i=e?o.getIndexesCurrentPage(a):null;a.tables.each((function(e,n){var r=0;i&&(r=i[e]),t.push(new o(a,n,a.rows[e].add(a.totalRows[e]),a.tableWrapper,a.params.rowsPerPage,r))})),a.paginations=t}else o.remove(a.tableWrapper),a.paginations=null})),s(o,"remove",(function(a){a.find(".tablefilter-pagination").remove(),a.find("table[pagination]").removeAttr("pagination").find("tr[visibleForPagination]").removeAttr("visibleForPagination visibleForPaginationAnim").children("[visibleForPagination]").removeAttr("visibleForPagination")})),s(o,"getIndexesCurrentPage",(function(a){var e=null;if(a.paginations){e=[];for(var t=0;t<a.paginations.length;t++)e.push(a.paginations[t].indexCurrentPage)}return e})),e.default=o},14731:function(a,e,t){"use strict";t.r(e);t(58711),t(46401);var i,n,r,s=function a(){!function(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a)};r=function(a){var e=parseInt(a.showNRowsifNotFiltered),t=parseInt(a.ignoreFirstNrows),i=parseInt(a.rowsPerPage);e>=0||(a.showNRowsifNotFiltered="all"),t>0||(a.ignoreFirstNrows=""),i>0||(a.rowsPerPage=""),0==parseInt(a.showNRows)&&(a.showNRows="0+"),a.showNRows&&(-1!=a.showNRows.indexOf("*")?a.ignoreFirstNrows=a.showNRows.replace("*",""):-1!=a.showNRows.indexOf("+")?a.showNRowsifNotFiltered=a.showNRows.replace("+",""):a.showNRows>0&&(a.rowsPerPage=a.showNRows.replace("+","")),a.showNRows="")},(n="adaptOldParamsTF")in(i=s)?Object.defineProperty(i,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[n]=r,e.default=s}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:8aea884e7989f3930562a6d174117f48', location = 'build/166.js' */
(self.webpackChunk=self.webpackChunk||[]).push([[166],{22166:function(e,n){var t,r,i;r=[],void 0===(i="function"==typeof(t=function(){"use strict";var e=["decimals","thousand","mark","prefix","suffix","encoder","decoder","negativeBefore","negative","edit","undo"];function n(e){return e.split("").reverse().join("")}function t(e,n){return e.substring(0,n.length)===n}function r(e,n){return e.slice(-1*n.length)===n}function i(e,n,t){if((e[n]||e[t])&&e[n]===e[t])throw new Error(n)}function o(e){return"number"==typeof e&&isFinite(e)}function f(e,n){return e=e.toString().split("e"),(+((e=(e=Math.round(+(e[0]+"e"+(e[1]?+e[1]+n:n)))).toString().split("e"))[0]+"e"+(e[1]?+e[1]-n:-n))).toFixed(n)}function u(e,t,r,i,u,s,a,c,p,l,h,d){var g,v,w,x=d,m="",y="";return s&&(d=s(d)),!!o(d)&&(!1!==e&&0===parseFloat(d.toFixed(e))&&(d=0),d<0&&(g=!0,d=Math.abs(d)),!1!==e&&(d=f(d,e)),-1!==(d=d.toString()).indexOf(".")?(w=(v=d.split("."))[0],r&&(m=r+v[1])):w=d,t&&(w=n(w).match(/.{1,3}/g),w=n(w.join(n(t)))),g&&c&&(y+=c),i&&(y+=i),g&&p&&(y+=p),y+=w,y+=m,u&&(y+=u),l&&(y=l(y,x)),y)}function s(e,n,i,f,u,s,a,c,p,l,h,d){var g,v="";return h&&(d=h(d)),!(!d||"string"!=typeof d)&&(c&&t(d,c)&&(d=d.replace(c,""),g=!0),f&&t(d,f)&&(d=d.replace(f,"")),p&&t(d,p)&&(d=d.replace(p,""),g=!0),u&&r(d,u)&&(d=d.slice(0,-1*u.length)),n&&(d=d.split(n).join("")),i&&(d=d.replace(i,".")),g&&(v+="-"),""!==(v=(v+=d).replace(/[^0-9\.\-.]/g,""))&&(v=Number(v),a&&(v=a(v)),!!o(v)&&v))}function a(n){var t,r,o,f={};for(void 0===n.suffix&&(n.suffix=n.postfix),t=0;t<e.length;t+=1)if(void 0===(o=n[r=e[t]]))"negative"!==r||f.negativeBefore?"mark"===r&&"."!==f.thousand?f[r]=".":f[r]=!1:f[r]="-";else if("decimals"===r){if(!(o>=0&&o<8))throw new Error(r);f[r]=o}else if("encoder"===r||"decoder"===r||"edit"===r||"undo"===r){if("function"!=typeof o)throw new Error(r);f[r]=o}else{if("string"!=typeof o)throw new Error(r);f[r]=o}return i(f,"mark","thousand"),i(f,"prefix","negative"),i(f,"prefix","negativeBefore"),f}function c(n,t,r){var i,o=[];for(i=0;i<e.length;i+=1)o.push(n[e[i]]);return o.push(r),t.apply("",o)}function p(e){if(!(this instanceof p))return new p(e);"object"==typeof e&&(e=a(e),this.to=function(n){return c(e,u,n)},this.from=function(n){return c(e,s,n)})}return p})?t.apply(n,r):t)||(e.exports=i)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:tf-editor-resources', location = 'build/tf-editor.js' */
!function(){"use strict";var e={95035:function(e,t,a){a.r(t);var r=a(1143),i=a(14978),n=a(93880),l=a.n(n),o=a(46401),s={contents:null,tfs:{},panels:[],init:function(){var e=this;$.ajax({contentType:"application/x-www-form-urlencoded; charset=utf-8",type:"GET",cache:!1,url:Confluence.getContextPath()+"/rest/table-filter/1.0/service/license",dataType:"json",success:function(t){t&&(e.initFilters(),e.bindEvents(),AJS.Rte.Content.editorResetContentChanged())}})},initFilters:function(){var e=this;e.contents=$("#wysiwygTextarea_ifr").contents(),e.toolbar=$("#rte-toolbar"),e.contents.find('[data-macro-name="table-filter"]').each((function(){e.createFilter($(this))}))},bindEvents:function(){var e=this;new MutationObserver((function(t){t.forEach((function(t){Array.prototype.forEach.call(t.addedNodes,(function(t){var a;(a=t).attributes&&a.attributes["data-macro-name"]&&"table-filter"===a.attributes["data-macro-name"].value?e.createFilter($(a)):a.querySelectorAll&&$(a.querySelectorAll('[data-macro-name="table-filter"]')).each((function(){e.createFilter($(this))}))}))}))})).observe(e.contents[0],{childList:!0,subtree:!0}),AJS.bind("created.property-panel",(function(t,a){if("macro"==a.type){var r=$(a.anchor);if("table-filter"==r.attr("data-macro-name")){var i=r.attr("id"),n=e.tfs[i];if(n&&n.tables.length)e.toolbar.find(".tablefilter-outer-wrapper").data("id")==i?a.panel.find(".macro-property-panel-show-tf").addClass("hide-tf").addClass("visible").find(".panel-button-text").text("Hide filter"):a.panel.find(".macro-property-panel-show-tf").removeClass("hide-tf").addClass("visible").find(".panel-button-text").text("Show filter");else a.panel.find(".macro-property-panel-show-tf").hide()}}})),$(document).bind("enableContextToolbarRow.Toolbar",(function(){$(s.toolbar.find(".tablefilter-outer-wrapper")).appendTo(s.toolbar)})),e.bindSave(),tinymce.activeEditor.onUndo.listeners?(tinymce.activeEditor.onUndo.listeners.push({cb:function(){e.updateFilters()}}),tinymce.activeEditor.onRedo.listeners.push({cb:function(){e.updateFilters()}})):(tinymce.activeEditor.onUndo.add((function(){e.updateFilters()})),tinymce.activeEditor.onRedo.add((function(){e.updateFilters()})));var t,a=function(e,t){var a=$("<div/>").append(t.content),n=a.find('table[data-macro-name="table-filter"], table[data-macro-name="pivot-table"], table[data-macro-name="table-chart"], table[data-macro-name="table-joiner"]').each((function(e){var t=$(this),a=Confluence.MacroParameterSerializer.deserialize(t.attr("data-macro-parameters"));a.id=(new Date).getTime()+e+"_"+i.default.hashCode(this.outerHTML),t.attr("id",a.id),t.attr("data-macro-parameters",Confluence.MacroParameterSerializer.serialize(a))}));if(r.default.prototype.tableWrapper=a.find(".tablefilter-table-wrapper"),r.default.prototype.tables=r.default.prototype.tableWrapper.find("table"),r.default.prototype.editorMacro=!0,r.default.prototype.makeTablesScrollable(),0===n.length){var l=a.find("table.tf-copy-table");l.length&&(l.removeClass("tf-copy-table"),l.find("tr").filter((function(){return!i.default.isRowVisible(this)})).remove(),l.find(".fake").removeClass("fake").filter((function(){return"none"===this.style.display})).remove(),l.find(".tf-hidden-column, .tf-header-hidden").remove(),l.find('[class*="tf-rowspan-"]').each((function(){var e=$(this);e.removeClass(e.getClassStartsWith(/tf-rowspan-\d+/))})),l.find('[class*="tf-colspan-"]').each((function(){var e=$(this);e.removeClass(e.getClassStartsWith(/tf-colspan-\d+/))})))}t.content=a.html()},n=function(){clearTimeout(t),t=setTimeout((function(){$.each(e.tfs,(function(t,a){if(0==a.tableWrapper.closest("body").length){var r=e.contents.find('[id="'+t+'"]');r.length&&(r.attr("id",""),e.panels[t]&&(e.panels[t].remove(),e.panels[t]=null),e.createFilter(r))}}))}),100)},l=tinymce.activeEditor.plugins.confluencepaste||tinymce.activeEditor.plugins.aePaste;l.onPreProcess?(l.onPreProcess.listeners.push({cb:a}),l.onPostProcess.listeners.push({cb:n})):(tinymce.activeEditor.on("PastePreProcess",(function(e){a(tinymce.activeEditor,e)})),tinymce.activeEditor.on("PastePostProcess",n));var o=function(e,t){if("mceTableInsertRowAfter"===e||"mceTableInsertRowBefore"===e||"mceTableDeleteRow"===e){var a=$(tinymce.activeEditor.selection.getNode()),r=a.closest("td.tablefilter-table-wrapper table");if(r.length&&(r.find("td[rowspan]:not(.fake)").each((function(e,a){var r=$(a);t?r.attr("rowspan",r.data("rowspan")):r.data("rowspan",r.attr("rowspan"))})),t)){var i=a.closest("td.fake");if(i.length){var n=i.siblings("td:not(.fake)");n.length&&tinymce.activeEditor.selection.setCursorLocation(n[0])}r.find(".fake[rowspan]").remove()}}};tinymce.activeEditor.onBeforeExecCommand.add((function(e,t,a,r){o(t,!0)})),tinymce.activeEditor.onExecCommand.add((function(e,t,a,r){o(t,!1)})),$("#content-title").bind("focus click",(function(){e.toolbar.find(".tablefilter-outer-wrapper .disabled").removeClass("disabled").removeAttr("disabled"),e.toolbar.find(".tablefilter-outer-wrapper .lockEnabled").find(".filter-reset, .filter-settings").attr("disabled","disabled")})),e.contents.click((function(){e.toolbar.find(".tablefilter-outer-wrapper .lockEnabled").find(".filter-reset, .filter-settings").attr("disabled","disabled")})),e.toolbar.delegate(".tablefilter-outer-wrapper .aui-buttons.close","click",(function(){var e=s.toolbar.find(".tablefilter-outer-wrapper"),t=e.data("id");e.hide(),$("body").append(e),$("#inline-dialog-tf-add-filter-"+t).hide(),"false"==$("#filter-menu-view-"+t+"-"+AJS.params.pageId).attr("aria-hidden")&&$("#filter-settings-"+t).trigger("aui-button-invoke")})),tinymce.activeEditor.onBeforeExecCommand.add((function(e,t,a,r){if("mceTableDeleteRow"===t){var i=$(tinymce.activeEditor.selection.getNode());i.is("td,th")&&(i=i.parent()),i.children(".fake").remove(),i.children('[rowspan="-1"]').attr("rowspan","1")}})),AJS.bind("tf-unwrap",(function(t,a){var r=e.tfs[a];r&&(e.destroyFilterWithObservers(a,r),delete e.tfs[a])}))},bindSave:function(){var e=this;setTimeout((function(){!Confluence.Editor.UI.isButtonEnabled||Confluence.Editor.UI.isButtonEnabled(Confluence.Editor.UI.saveButton)?(AJS.Editor.addSaveHandler((function(){e.destroyFilters()})),AJS.bind("rte-changeMode",(function(t,a){a==Confluence.Editor.MODE_PREVIEW?e.destroyFilters():a==Confluence.Editor.MODE_RICHTEXT&&($(".tablefilter-outer-wrapper").remove(),e.initFilters())}))):e.bindSave()}),200)},createFilter:function(e){var t=s,a=Confluence.MacroParameterSerializer.deserialize(e.attr("data-macro-parameters"));if(a.id)if(e.data("tf-init")||0!==e.find('[data-macro-name="pivot-table"],[data-macro-name="table-joiner"],[data-macro-name="table-filter"]').length)t.tfs[a.id]&&(t.tfs[a.id].tables.trigger("destroy"),t.makeTablesSortable(t.tfs[a.id]));else{if(t.contents.find('[id="'+a.id+'"]').length>1)return;if(e.data("tf-init",!0),e.attr("id",a.id),e.find(".wysiwyg-macro-body:eq(0)").addClass("tablefilter-table-wrapper"),t.panels[a.id])return t.tfs[a.id].tableWrapper=e.find(".tablefilter-table-wrapper"),t.tfs[a.id].getTable(),t.tfs[a.id].normalizeTable(),t.tfs[a.id].addNumbering(),t.tfs[a.id].appendSparklines(),t.tfs[a.id].bindDOMChange(),t.tfs[a.id].makeTablesScrollable(),t.tfs[a.id].filterTable(),t.tfs[a.id].tables.trigger("destroy"),t.tfs[a.id].editorMacro=e,t.makeTablesSortable(t.tfs[a.id]),void t.bindSynchronyFiltration(e,t.tfs[a.id]);var i=a["cell-width"]?a["cell-width"].split(","):[],n=a.default?a.default.split(","):[],o=a.inverse?a.inverse.split(","):[],d=a.labels?a.labels.split("‚"):[],c=0,f=0,u=0,b=null!=a.column?a.column.split(","):[],p=t.getFilterObjects(b,d,n,i,o,c,f,u);c+=b.length,f+=b.length,u+=b.length,b=null!=a.userfilter?a.userfilter.split(","):[];var h=t.getFilterObjects(b,d,n,i,o,c,f,u);c+=b.length,f+=b.length,u+=b.length,b=null!=a.numberfilter?a.numberfilter.split(","):[];var m=t.getFilterObjects(b,d,n,i,o,c,-1,u);c+=b.length,u+=b.length,b=null!=a.datefilter?a.datefilter.split(","):[];var v=t.getFilterObjects(b,d,n,i,o,c,-1,u);c+=b.length,u+=b.length;var g=(b="true"==a.globalFilter?["Filter whole table"]:[]).length?t.getFilterObjects(b,d,n,i,o,c,f,u)[0]:null;c+=b.length,f+=b.length,u+=b.length;var y=(b="true"==a.hideColumns?["Hide columns"]:[]).length?t.getFilterObjects(b,d,n,i,o,c,f,u)[0]:null;c+=b.length,f+=b.length,u+=b.length,b=null!=a.iconfilter?a.iconfilter.split(","):[];var w=t.getFilterObjects(b,d,n,i,o,c,f,u),F=$(l().panel({macroId:a.id,pageId:AJS.params.pageId,comboBoxes:p,edits:h,numberFilters:m,dateFilters:v,globalFilter:g,hideColumns:y,iconFilters:w,showNRowsifNotFiltered:a.showNRowsifNotFiltered,hideLabels:a.hidelabels,disableSave:a.disableSave,hideControls:a.hideControls,hidePane:!1,fd:!1,editable:!0,isEditor:!0,sessionId:1,isMacroViewContext:!1}));F.addClass("toolbar-contextual"),F.append(l().editorCloseButton()),t.panels[a.id]=F,$("body").append(F);var S=$.extend(!0,{},a);S.macroParams=a,S.showNRows=S.showNRows||"all",S.heightValue=S.heightValue||"",S.numbering=S.numbering||"",S.sorts=a.sort?$.map(a.sort.split(","),(function(e){return e.replace(/\‚/g,",")})):[],S.separator=S.separator?S.separator.replace("Point (.)",".").replace("Comma (,)",","):".",S.pageId=AJS.params.pageId,S.sparkline="true"==S.sparkline,S.sparkName=S.sparkName||"",S.isLockEnabled=!0,S.thousandSeparator=(a.thousandSeparator||"").replace("\\u0020"," "),S.tabs=!1,S.editorMacro=e,t.tfs[a.id]=new r.default(S),t.tfs[a.id].showTable(!0),t.makeTablesSortable(t.tfs[a.id]),F.hide();var E=s.toolbar.find(".tablefilter-outer-wrapper");E.length>0&&0===t.tfs[E.data("id")].tableWrapper.parents("body").length&&(E.remove(),F.show(),F.find(".enableLock:visible").click(),s.toolbar.append(F)),t.bindSynchronyFiltration(e,t.tfs[a.id])}},bindSynchronyFiltration:function(e,t){var a=this;e.attr("type")?(t.isLockEnabled=!1,t.setFilters(JSON.parse(e.attr("type")))):t.cbState.length&&t.showOrHideTables(),t.observerMacro||(t.observerMacro=new MutationObserver((function(r,i){r.forEach((function(r){if("type"===r.attributeName)e.data("tf-self")?e.data("tf-self",!1):(t.isLockEnabled=!1,t.setFilters(JSON.parse(e.attr("type"))));else if("id"===r.attributeName&&e.data("tf-init")&&r.oldValue&&e.attr("id")&&r.oldValue!==e.attr("id")||"class"===r.attributeName&&r.oldValue&&-1!=r.oldValue.indexOf("tablefilter-table-wrapper")&&r.target.className&&-1==r.target.className.indexOf("tablefilter-table-wrapper"))return a.destroyFilterWithObservers(t.macroId,t),delete a.panels[t.macroId],delete a.tfs[t.macroId],e.data("tf-init",""),void a.createFilter(e)}))})),t.observerMacro.observe(e[0],{attributes:!0,attributeOldValue:!0,attributeFilter:["type","id","class"]}),t.observerMacro.observe(t.tableWrapper[0],{attributes:!0,attributeOldValue:!0,attributeFilter:["class"]}))},makeTablesSortable:function(e){e.sorting=!0,e.setMutationObserver(!0),e.tables.tablesorterEditor({cancelSelection:!1,dateFormat:e.dateFormat,locale:e.localeDateFormat,textExtraction:function(e){return i.default.getEditorCellText(e)}}),e.sorting=!1,e.setMutationObserver(!0)},destroyFilters:function(){var e=this;$.each(e.tfs,(function(t,a){e.destroyFilterWithObservers(t,a)})),e.tfs={}},destroyFilterWithObservers:function(e,t){var a=this;t.observer&&t.observer.disconnect(),t.observerMacro&&t.observerMacro.disconnect(),t.observersTd&&t.observersTd.length&&t.observersTd.forEach((function(e){e.disconnect()})),a.destroyFilter(t),a.cleanMacro(e),a.removePanel(e)},cleanMacro:function(e){return this.contents.find('[id="'+e+'"]').data("tf-init",!1).attr("id","")},removePanel:function(e){var t=this;t.panels[e]&&(t.panels[e].remove(),t.panels[e]=null)},destroyFilter:function(e){e.numbering="",e.fixedRows=0,e.editorSave=!0,e.showTableWithoutFilters(),e.addNumbering(),e.makeTablesScrollable(),e.tables.data("tf-merged-done",!1),e.tables.find(".fake").remove(),e.tables.trigger("destroy"),e.tables.find(".tablesorter-header").removeClass("tablesorter-header"),e.tables.find(".pivot-header").removeClass("pivot-header"),e.tables.find('[data-mce-style="display: none;"]').removeAttr("data-mce-style"),e.tables.find(".tf-sparkline-header, .tf-sparkline-container, .total-row, .total-col, .tf-header-hidden").remove(),e.tables.each((function(){$(this).data("fixed-header",!1)})),o.default.remove(e.tableWrapper)},updateFilters:function(){var e=this;$.each(e.tfs,(function(t,a){if(a.editorMacro.parent().length)a.tables.trigger("destroy"),e.makeTablesSortable(a),a.bindDOMChange();else{var r=e.cleanMacro(t);e.removePanel(t),e.createFilter(r)}}))},getFilterObjects:function(e,t,a,r,i,n,l,o){var s=[];return $.each(e,(function(e,d){var c=n+e,f=a.length>c?a[c].replace(/\‚/g,",").trim():"",u=f?f.replace(new RegExp("-Empty-","g"),"").split("&&"):[],b=f.split("->");s.push({label:t.length>o+e&&t[o+e]||d,name:d,defaultValue:f,columnWidth:l>-1&&r.length>l+e&&r[l+e]||"150",options:u,defaultFromValue:b[0],defaultToValue:b.length>1?b[1]:"",inverse:i.length>c&&"true"==i[c]})})),s}},d=s,c=a(36845);try{AJS.bind("init.rte",(function(){d.init(),AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("show-tf",(function(e,t){var a=$(t),r=d.toolbar.find(".tablefilter-outer-wrapper"),i=r.data("id");r.hide(),$("body").append(r),$("#inline-dialog-tf-add-filter-"+i).hide(),"false"==$("#filter-menu-view-"+i+"-"+AJS.params.pageId).attr("aria-hidden")&&$("#filter-settings-"+i).trigger("aui-button-invoke");var n=$(".macro-property-panel-show-tf").hasClass("hide-tf");if(c.default.gaShowFilter(n),!n){var l=d.panels[a.attr("id")];l.show(),l.find(".enableLock").click(),d.toolbar.append(l)}})),$("body").delegate("button:has(.aui-iconfont-table-split, .aui-iconfont-table-col-left, .aui-iconfont-table-col-right, .aui-iconfont-table-row-remove, .aui-iconfont-table-col-remove, .table-split-cells, .table-insert-column-before,.table-insert-column-after, .table-delete-row, .table-delete-column)","mouseup",(function(){if(!$(this).is(".disabled")){var e=$(tinymce.activeEditor.selection.getNode());e.is("table")||(e=e.parents("table").eq(0)),e.find(".fake").remove()}}))}))}catch(e){}}},t={};function a(r){if(t[r])return t[r].exports;var i=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(i.exports,i,i.exports,a),i.loaded=!0,i.exports}a.m=e,a.amdD=function(){throw new Error("define cannot be used indirect")},a.amdO={},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,{a:t}),t},a.d=function(e,t){for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){var e={709:0},t=[[95035,248,961,166,266,401,944]],r=function(){};function i(){for(var r,i=0;i<t.length;i++){for(var n=t[i],l=!0,o=1;o<n.length;o++){var s=n[o];0!==e[s]&&(l=!1)}l&&(t.splice(i--,1),r=a(a.s=n[0]))}return 0===t.length&&(a.x(),a.x=function(){}),r}a.x=function(){a.x=function(){},l=l.slice();for(var e=0;e<l.length;e++)n(l[e]);return(r=i)()};var n=function(i){for(var n,l,s=i[0],d=i[1],c=i[2],f=i[3],u=0,b=[];u<s.length;u++)l=s[u],a.o(e,l)&&e[l]&&b.push(e[l][0]),e[l]=0;for(n in d)a.o(d,n)&&(a.m[n]=d[n]);for(c&&c(a),o(i);b.length;)b.shift()();return f&&t.push.apply(t,f),r()},l=self.webpackChunk=self.webpackChunk||[],o=l.push.bind(l);l.push=n}(),a.x()}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tngtech.confluence.plugins.tableenhancer:fixedheaders-general-resources', location = '/js/fixedheaders-general.js' */
/*global AJS:false Confluence:false */
AJS.toInit(function() {

var activateFixedHeaders = function (event, environment) {
    /*
     * PART 1: General configuration and variable declaration
     */

    // - COVER_BEFORE_SCROLL_OUT: between 0 and 1, minimum of the screen covered by the table
    // before the table header scrolls out
    // - MAX_NUMBER_OF_KEPT_ROWS: max number of rows below the header when the header scrolls out of view
    var COVER_BEFORE_SCROLL_OUT = 0.6,
        MAX_NUMBER_OF_KEPT_ROWS = 20,
        winObj, docObj, browser,
        number_of_tables_with_macro,
        table_top_correction, div_top_correction, table_left_correction, div_left_correction,
        height_of_bottom_x_rows = [],
        number_of_bottom_rows_kept = [],
        scroll_top, scroll_bottom, element_top, element_bottom, element_height, anchor_bottom,
        table_in_macro, fixed_row_element, fixed_column_element, originating_div,
        current_table_number,
        scroll_left, element_left, element_right, element_width,
        anchors_for_refresh, iframe, $ = AJS.$;;


    /*
     * PART 2: Environment specific setup
     */

    if (environment === "editor") {
        var iframe = $("#wysiwygTextarea_ifr");
        docObj = iframe.contents();
        winObj = iframe[0].contentWindow ? iframe[0].contentWindow : iframe[0].contentDocument.defaultView;
    } else {
        docObj = document;
        winObj = window;
    }


    /*
     * PART 3: Initialize the macro: Setup and Event Handler Registration
     */

    number_of_tables_with_macro = $(".fixed-headers-container", docObj).length;

    // wrap the table within the macro and add an anchor to mark the end of the macro
    $(".fixed-headers-container table:not(.clone):not(.confluenceTable .confluenceTable):not(.wysiwyg-macro)", docObj)
        .after('<div class="fixed-headers-bottom-anchor synchrony-exclude"></div>');

    // label the wrappers and anchors, in case the macro appears several times on a page
    $(".fixed-headers-container", docObj).addClass(function (index) {
        return(index.toString());
    });
    $(".fixed-headers-bottom-anchor", docObj).addClass(function (index) {
        return(index.toString());
    });

    if ($(".fixed-headers-bottom-anchor", docObj).length > 0) {
        anchors_for_refresh = $("div.fixed-headers-bottom-anchor", docObj);
    }


    $(".fixed-headers-container", docObj).each(function (index, element) {
        var table = $(element).find("table:not(.clone):not(.confluenceTable .confluenceTable)");
        if (table.length > 1) {
            Confluence.Editor.addErrorMessage(
                'com_tngtech_confluence_plugins_tableenhancer_error_nested-table', // may not contain "." !!!
                'Fixing rows/columns is only supported for top level tables, nested tables may not display correctly!',
                false // showInAllModes
            );
        }

        //Checks if the table contains cells spanning more rows/columns as confluence disables sorting for this and we also need to do this
        var hasRowOrColSpan = false;
        $(table.find("[colspan]")).each(function (index, element){
            if($(element).attr("colspan") > 1){
                hasRowOrColSpan = true;
            }
        });
        $(table.find("[rowspan]")).each(function (index, element){
            if($(element).attr("rowspan") > 1){
                hasRowOrColSpan = true;
            }
        });

        if (hasRowOrColSpan || environment === "editor") { // JIRA does not supported sorting in this case, so can proceed right away
            markFixedRowsAndColumns(element);
        } else {
            // if more than one fixed row need to disable sorting once tableenhancer is done
            $(table).on("tableenhancer-rownums-completed", function () {
                markFixedRowsAndColumns(element);
            });
        }

        //If sorting gets updated also update fixed rows and columns
        $(table).on("tableenhancer-rownums-completed", function () {
            markFixedRowsAndColumnsAndRemoveOldFix(element);
        });


    });

    initializeBrowserDependentCorrections();


    /*
     * PART 4: Register the event handlers
     */

    $(winObj).scroll(scrollingHandler_window);
    $(".fixed-headers-container", docObj).scroll(scrollingHandler_LeftRight);

    $(winObj).on("load resize", refreshClones);

    // Provide an external trigger for the refresh function
    $(winObj).on("refreshClones.tableenhancer", refreshClones);

    if (environment !== "editor") {
        // handle mousedown on the cloned elements
        $(".fixed-headers-container", docObj).on("mousedown", "div.clone", cloneClickHandler);

        // handle sorting events
        $(".fixed-headers-container > table", docObj).on("sortEnd click", ".sortableHeader", refreshClones);
    }


    /*
     * PART 5: Function definitions
     */

    // Event handlers

    function scrollingHandler_window() {

        // Remove stickyTableHeaders, if they exist (must be done here, to always remove them, e.g. in case of reload, different loading order etc.)
        if (typeof $().stickyTableHeaders === "function") {
            $(".fixed-headers-container table").stickyTableHeaders("destroy");
        }

        // iterate over the tables within the macro on the page
        for (current_table_number = 0; current_table_number < number_of_tables_with_macro; current_table_number++) {
            scrollingHandler_UpDown();
            if (environment === "editor") {
                scrollingHandler_LeftRight();
            }
        }
    }

    function scrollingHandler_UpDown() {
        table_in_macro = $("div." + current_table_number, docObj).find("table:not(.clone):not(.confluenceTable .confluenceTable)");
        fixed_row_element = table_in_macro.find(".tableenhancer-fixed-row");
        if (fixed_row_element.length > 0) {
            updateScrollPosition("UpDown");
            if (isTableInView() && isFixedElementOutOfView_UpDown()) {
                if ($('.vert_clone.' + current_table_number, docObj).length === 0) {
                    createClone("UpDown");
                    configureVertCloneWrapperDiv();
                    createCornerCloneFromHoriClone();
                } else {
                    updateExistingClones("UpDown");
                }
            }
            else { // so table is not in view or the fixed row is, so delete row & corner clones
                removeClones("UpDown");
            }
        }
    }

    function scrollingHandler_LeftRight() {
        originating_div = (environment === "editor" ? $(".fixed-headers-container." + current_table_number, docObj) : $(this));
        table_in_macro = originating_div.find("table:not(.clone):not(.confluenceTable .confluenceTable)");
        fixed_column_element = table_in_macro.find(".tableenhancer-fixed-column");
        if (fixed_column_element.length > 0) {
            current_table_number = $.trim(originating_div.attr("class").match(/(\s[0-9]+$|^[0-9]+\s|\s[0-9]+\s|^[0-9]+$)/g));
            updateScrollPosition("LeftRight");
            if (isFixedElementOutOfView_LeftRight()) {
                if ($('.hori_clone.' + current_table_number, docObj).length === 0) {
                    createClone("LeftRight");
                    configureHoriCloneWrapperDiv();
                    createCornerCloneFromVertClone();
                } else {
                    updateExistingClones("LeftRight");
                }
                redrawIfNecessary();
            }
            else {
                removeClones("LeftRight");
            }
        }
    }

    function refreshClones() {
        calculateNumberAndHeightOfBottomRows();
        removeClones("All");
        scrollingHandler_window();
        if (environment !== "editor") {
            $(".fixed-headers-container", docObj).each(scrollingHandler_LeftRight);
        }
    }

    function cloneClickHandler(eventObj) {
        var target = $(eventObj.target).closest(".fixed-headers-container th, .fixed-headers-container td");
        if (target.hasClass('sortableHeader')) {
            var cell_index = $(target).index();
            var parent_wrapper_div = $(target).parents('.fixed-headers-container');
            var matching_element = $(parent_wrapper_div).children("table").find("thead > tr > *").eq(cell_index);
            $(matching_element[0]).mousedown(); // mousedown on the matching_element to kick off the sorting
            $(matching_element[0]).mouseup();
            $(matching_element[0]).click();
        }
    }


    // Helper functions

    function isTableInView() {
        return ((scroll_bottom > element_top) && (scroll_top < anchor_bottom));
    }

    function isFixedElementOutOfView_UpDown() {
        return (scroll_top > element_top);
    }

    function isFixedElementOutOfView_LeftRight() {
        if (environment === "editor") {
            return (element_left < scroll_left);
        } else {
            return ((0 > element_left));
        }
    }

    function createClone(scrollDirection) {
        var created_clone = table_in_macro
            .clone()
            .addClass('clone synchrony-exclude ')
            .appendTo($(".fixed-headers-container." + current_table_number, docObj));
        if (scrollDirection === "UpDown") {
            $(created_clone)
                .addClass('vert_clone ' + current_table_number)
                .css({
                    width: table_in_macro.outerWidth() + 'px',
                    top: table_top_correction + 'px'
                })
                .wrap('<div class="clone vert_clone synchrony-exclude ' + current_table_number + '"></div>');
        } else if (scrollDirection === "LeftRight") {
            $(created_clone)
                .addClass('hori_clone ' + current_table_number)
                .css({
                    height: table_in_macro.outerHeight() + 'px',
                    left: table_left_correction + 'px'
                })
                .wrap('<div class="clone hori_clone synchrony-exclude ' + current_table_number + '"></div>');
        } else {
            throw new Error("Unknown scroll direction!");
        }
    }

    function configureVertCloneWrapperDiv() {
        var wrapperDiv = $("div.vert_clone." + current_table_number, docObj)
            .css({
                height: (element_height + 1) + 'px',
                width: table_in_macro.outerWidth() - 1 + 'px'
            });
        configureOffsetTopBottomForDiv(wrapperDiv);
    }

    function configureHoriCloneWrapperDiv() {
        $("div.hori_clone." + current_table_number, docObj)
            .css({
                height: table_in_macro.outerHeight() + getSizeOfAutoCursorTargetIfExistent() + 'px',
                width: (element_width + 2) + 'px',
                top: getMarginTopOfConfluenceTableInEditor() + 'px',
                left: (environment === "editor" ? (scroll_left - element_left) : (scroll_left)) + div_left_correction + 'px'
            });
    }

    function createCornerCloneFromVertClone() {
        var vert_clone_div = $("div.vert_clone." + current_table_number, docObj);
        if (vert_clone_div.length > 0) { // if a vertical clone exists, create a corner clone
            updateScrollPosition("UpDown");
            var cornerClone = vert_clone_div.clone()
                .addClass('clone corner_clone synchrony-exclude ' + current_table_number)
                .css({
                    height: (element_height + 1) + 'px',
                    width: (element_width + 1) + 'px',
                    left: (environment === "editor" ? (scroll_left - element_left) : (scroll_left)) + div_left_correction + 'px'
                })
                .appendTo(vert_clone_div.parent());
            cornerClone.children('table')
                .removeClass('vert_clone hori_clone')
                .addClass('clone corner_clone synchrony-exclude ' + current_table_number)
                .css({
                    height: table_in_macro.outerHeight() + 'px',
                    left: table_left_correction + 'px'
                });
        }
    }

    function createCornerCloneFromHoriClone() {
        var hori_clone_div = $("div.hori_clone." + current_table_number, docObj);
        if (hori_clone_div.length > 0) { // if a horizontal clone exists, create a corner clone
            originating_div = hori_clone_div.parent();
            updateScrollPosition("LeftRight");
            var cornerClone = hori_clone_div.clone()
                .addClass('clone corner_clone synchrony-exclude ' + current_table_number)
                .css({
                    height: (element_height + 1) + 'px',
                    width: (element_width + 1) + 'px'
                })
                .appendTo(originating_div);
            configureOffsetTopBottomForDiv(cornerClone);
            cornerClone.children('table')
                .removeClass('vert_clone hori_clone')
                .addClass('clone corner_clone synchrony-exclude ' + current_table_number)
                .css({
                    width: table_in_macro.outerWidth() + 'px',
                    top: table_top_correction + 'px'
                });
        }
    }

    function configureOffsetTopBottomForDiv(passed_div) {
        // The Auto cursor gets added by collaborative editing
        var autocursor_p_size = getSizeOfAutoCursorTargetIfExistent() + getMarginTopOfConfluenceTableInEditor();
        if (scroll_top > anchor_bottom - element_height - height_of_bottom_x_rows[current_table_number]) {
            $(passed_div).css({
                top: '',
                bottom: height_of_bottom_x_rows[current_table_number] + 'px'
            });
        } else {
            $(passed_div).css({
                bottom: '',
                top: div_top_correction + ((scroll_top + autocursor_p_size - element_top > 0) ? (scroll_top + autocursor_p_size - element_top) : 0) + 'px'
            });
        }
    }

    function getSizeOfAutoCursorTargetIfExistent() {
        if (environment === "editor") {
            var autocursor_p_tags = $("#wysiwygTextarea_ifr").contents().find(".fixed-headers-container").children("p.auto-cursor-target");
            if (autocursor_p_tags.length > 0) {
                return autocursor_p_tags[0].offsetHeight;
            }
        }
        return 0;
    }

    function getMarginTopOfConfluenceTableInEditor() {
        if (environment === "editor") {
            return parseInt($(table_in_macro).css("margin-top"));
        }
        return 0;
    }

    function updateExistingClones(scrollDirection) {
        if (scrollDirection === "UpDown") {
            configureOffsetTopBottomForDiv($("div.vert_clone." + current_table_number, docObj));
            configureOffsetTopBottomForDiv($("div.corner_clone." + current_table_number, docObj));
        } else if (scrollDirection === "LeftRight") {
            $("div.hori_clone." + current_table_number, docObj).css({
                left: (environment === "editor" ? (scroll_left - element_left) : (scroll_left)) + div_left_correction + 'px'
            });
            $("div.corner_clone." + current_table_number, docObj).css({
                left: (environment === "editor" ? (scroll_left - element_left) : (scroll_left)) + div_left_correction + 'px'
            });
        } else {
            throw new Error("Unknown scroll direction!");
        }
    }

    function removeClones(scrollDirection) {
        if (scrollDirection === "UpDown") {
            $(".vert_clone." + current_table_number, docObj).remove();
        } else if (scrollDirection === "LeftRight") {
            $(".hori_clone." + current_table_number, docObj).remove();
        } else if (scrollDirection === "All") {
            $(".clone", docObj).remove();
        } else {
            throw new Error("unknown scroll direction!");
        }
        $(".corner_clone." + current_table_number, docObj).remove();
    }

    function updateScrollPosition(scrollDirection) {
        if (scrollDirection === "UpDown") {
            var header_correction = 0;
            if (environment === "display") {
                var mainHeaderAsOverlay = AJS.$("#main-header.overlay-header"),
                    mainHeaderCssTop = mainHeaderAsOverlay.css("top");
                if (mainHeaderCssTop === undefined || mainHeaderCssTop === "auto") {
                    header_correction = AJS.$("header#header.fixed-header").outerHeight();
                } else {
                    header_correction = mainHeaderAsOverlay.outerHeight() + parseInt(mainHeaderCssTop);
                }
            }
            scroll_top = $(winObj).scrollTop() + header_correction;
            element_top = table_in_macro.offset().top;
            fixed_row_element = table_in_macro.find(".tableenhancer-fixed-row");
            element_bottom = fixed_row_element.offset().top + fixed_row_element.outerHeight();
            element_height = Math.ceil(element_bottom - element_top);
            scroll_bottom = scroll_top + $(winObj).height();
            anchor_bottom = $("." + current_table_number + ".fixed-headers-bottom-anchor", docObj).offset().top;
        } else if (scrollDirection === "LeftRight") {
            fixed_column_element = table_in_macro.find(".tableenhancer-fixed-column");
            if (environment === "editor") {
                scroll_left = $(winObj).scrollLeft();
                element_left = table_in_macro.offset().left;
                element_right = fixed_column_element.offset().left + fixed_column_element.outerWidth();
            } else {
                scroll_left = originating_div.scrollLeft();
                element_left = table_in_macro.position().left;
                element_right = fixed_column_element.position().left + fixed_column_element.outerWidth();
            }
            element_width = Math.ceil(element_right - element_left);
        } else {
            throw new Error("unknown scroll direction!");
        }
    }

    function redrawIfNecessary() {
        if (browser === "Chrome") { // Chrome sometimes fails to redraw properly when scrolling horizontally
            $(anchors_for_refresh).hide().show(1);
        }
    }

    function markFixedRowsAndColumns(containerElement) {
        // - <tr> marked as class "tableenhancer-fixed-row"
        // - <td> or <th> in second-last row marked as class "tableenhancer-fixed-column", to avoid merged cells e.g. in header
        var fixed_rows = $(containerElement).attr("data-fixed-rows");
        var fixed_columns = $(containerElement).attr("data-fixed-columns");

        if (fixed_rows > 0) {
            $(containerElement).find("table > :not(tfoot) > tr:eq(" + (fixed_rows - 1) + ")").addClass("tableenhancer-fixed-row");
        }
        if (fixed_columns > 0) {
            $(containerElement).find("table tr").eq(-2).children(":nth-child(" + fixed_columns + ")").addClass("tableenhancer-fixed-column");
        }
        if (fixed_rows > 1) {
            if (environment !== "editor") {
                disableSorting(containerElement);
            }
        }

        calculateNumberAndHeightOfBottomRows();
    }

    function markFixedRowsAndColumnsAndRemoveOldFix(containerElement) {
        //remove old fixed-rows
        $(containerElement).find(".tableenhancer-fixed-row").removeClass("tableenhancer-fixed-row");
        $(containerElement).find(".tableenhancer-fixed-column").removeClass("tableenhancer-fixed-column");
        markFixedRowsAndColumns(containerElement);
    }

    function calculateNumberAndHeightOfBottomRows() {
        for (current_table_number = 0; current_table_number < number_of_tables_with_macro; current_table_number++) {
            table_in_macro = $("div." + current_table_number, docObj).find("table:not(.clone):not(.confluenceTable .confluenceTable)");
            fixed_row_element = table_in_macro.find(".tableenhancer-fixed-row");
            if (fixed_row_element.length > 0) {
                updateScrollPosition("UpDown");
                var covered_part_of_screen = COVER_BEFORE_SCROLL_OUT * $(winObj).height();
                var curr_height_of_bottom_x_rows = 0;
                var current_element_height;
                for (var x = 1; x < MAX_NUMBER_OF_KEPT_ROWS + 1; x++) {
                    current_element_height = table_in_macro.find("tr").eq(-x).height();
                    curr_height_of_bottom_x_rows = curr_height_of_bottom_x_rows + current_element_height;
                    if (curr_height_of_bottom_x_rows > covered_part_of_screen - element_height) {
                        break;
                    }
                }
                height_of_bottom_x_rows[current_table_number] = curr_height_of_bottom_x_rows - current_element_height;
                number_of_bottom_rows_kept[current_table_number] = x - 1;
            } else {
                height_of_bottom_x_rows[current_table_number] = 0;
                number_of_bottom_rows_kept[current_table_number] = 0;
            }
        }
    }

    function initializeBrowserDependentCorrections() {
        // determine the browser and adjust accordingly
        browser = getBrowser();
        if (browser === "Firefox") {
            div_top_correction = -1;
            table_top_correction = 1;
            div_left_correction = -1;
            table_left_correction = 1;
        } else {
            div_top_correction = 0;
            table_top_correction = 0;
            div_left_correction = 0;
            table_left_correction = 0;
        }
    }


    // Sorting related functions

    function disableSorting(container_element) {
        $(container_element).find("table").trigger("destroy");
        setTimeout(function () { // remove the CSS classes for the sorting (e.g. to remove hover effect)
            removeSortingFromTablesInside(container_element);
        }, 500);
    }

    function removeSortingFromTablesInside(container) {
        $(container).find(".tablesorter").removeClass("tablesorter");
        $(container).find(".sortableHeader").removeClass("sortableHeader");
        $(container).find(".tablesorter-header-inner").removeClass("tablesorter-header-inner");
    }


    // Table-unrelated helper functions

    function getBrowser() {
        var ua = navigator.userAgent, tem, M;
        M = ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i) || [];
        if (/trident/i.test(M[1])) {
            tem = /\brv[ :]+(\d+)/g.exec(ua) || [];
            return 'IE';
        }
        if (M[1] === 'Chrome') {
            tem = ua.match(/\bOPR\/(\d+)/);
            if (tem !== null) {
                return 'Opera';
            }
        }
        M = M[2] ? [M[1], M[2]] : [navigator.appName, navigator.appVersion, '-?'];
        if ((tem = ua.match(/version\/(\d+)/i)) !== null) { M.splice(1, 1, tem[1]); }
        return M[0];
    }
};

AJS.$(window).on("activateFixedHeaders.tableenhancer", function(event, environment) {
    try {
        activateFixedHeaders(event, environment);
    } catch (e) {
        AJS.logError("table enhancer: error activating fixed headers", e);
    }
});

AJS.$(window).trigger("activateFixedHeaders.tableenhancer", ["display"]);
}); // AJS.toInit
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.tngtech.confluence.plugins.tableenhancer:fixedheaders-editor-resources', location = '/js/fixedheaders-in-editor.js' */
/*global AJS:false tinymce:false */
(function () {

var init = function () {
    var inactivityTimeoutID = 0,
        $ = AJS.$,
        iframe = $('#wysiwygTextarea_ifr');

    /*
     * Handle events, which require updating
     */
    // Save Handler
    var saveHandler = function () {
        try {
            $("#wysiwygTextarea_ifr").contents().find("body").off("keyup paste");
            removeFixedHeadersHTMLFromIframe();
        } catch (e) {
            AJS.logError("table enhancer: error in save handler", e);
        }
    };
    Confluence.Editor.addSaveHandler(saveHandler);

    // the quick edit bar removes all save/cancel handlers on init, so we have to bind to a later event to re-add it
    AJS.bind("rte-quick-edit-ready", function () {
        Confluence.Editor.addSaveHandler(saveHandler);
    });

    // Preview Button Handler
    $('#rte-button-preview').mousedown(function (eventObject) {
        // need to be ahead of other event handlers for this button, so bind to mousedown
        if (eventObject.which === 1) { // left mouse button
            try {
                removeFixedHeadersHTMLFromIframe();
                $('#rte-button-preview').click();
            } catch (e) {
                AJS.logError("table enhancer: error in preview handler", e);
            }
        }
    });

    // Edit Button Handler (when returning from preview mode)
    $('#rte-button-edit').click(setupMacro);

    // Initial Setup and Reload Handler
    AJS.Rte.getEditor().setContent = appendToFunction(AJS.Rte.getEditor().setContent,
        function () {
            setupMacroAfterDelay();
        });


    // New Macro via AutoComplete Handler and Macro Configuration Handler for the Macro Browser (changes or new macro)
    tinymce.confluence.MacroUtils.insertMacro = appendToFunction(tinymce.confluence.MacroUtils.insertMacro, setupMacroAfterDelay);

    // Table Insertion Handler
    AJS.Rte.getEditor().plugins.table.insertTable = appendToFunction(AJS.Rte.getEditor().plugins.table.insertTable, setupMacroAfterDelay)


    /*
     * Function definitions
     */

    // Full setup function

    function setupMacro() {
        try {
            $("#wysiwygTextarea_ifr").contents().find("body").off("keyup paste", iframeEditingHandler);
            $("#wysiwygTextarea_ifr").contents().find("body").off("paste", function () {
                setTimeout(checkIfSetupNecessary, 100);
            });
            $("#wysiwygTextarea_ifr").contents().find("body").off("keyup paste", restartInactivityCountDown);
            $("#rte-toolbar").off("click", iframeEditingHandler);
            $("#wysiwygTextarea_ifr").contents().find(".fixed-headers-container").off("click", ".clone", onClickOnClone);

            removeFixedHeadersHTMLFromIframe();
            initializeTableContainers();
            initializeTableSetup();

            iframe.trigger("refreshClones.tableenhancer");

            restartInactivityCountDown();

            $("#wysiwygTextarea_ifr").contents().find("body").on("keyup paste", restartInactivityCountDown);
            $("#wysiwygTextarea_ifr").contents().find("body").on("keyup paste", iframeEditingHandler);
            $("#wysiwygTextarea_ifr").contents().find("body").on("paste", function () {
                setTimeout(checkIfSetupNecessary, 100);
            });
            $("#rte-toolbar").on("click", iframeEditingHandler);

            $("#wysiwygTextarea_ifr").contents().find(".fixed-headers-container").on("click", "div.clone", onClickOnClone);
        } catch (e) {
            AJS.logError("table enhancer: error in setup", e);
        }
    }

    function setupMacroAfterDelay() {
        setTimeout(setupMacro, 500);
    }

    function restartInactivityCountDown() {
        window.clearTimeout(inactivityTimeoutID);
        inactivityTimeoutID = window.setTimeout(checkIfSetupNecessary, 5000);
    }

    // Event Handlers

    function onClickOnClone(eventObject) {
        var closestCellElement = $(eventObject.target).closest("td, th"),
            closestRowElement = $(eventObject.target).closest("tr"),
            triggeringClone = $(eventObject.target).closest(".clone"),
            activeContainer = $(eventObject.target).closest(".fixed-headers-container"),
            index_in_row = 0,
            index_of_row = 0,
            type_of_row_container = "TBODY";

        if (closestCellElement.length > 0) {
            index_in_row = closestCellElement.index();
            index_of_row = closestRowElement.index();
            type_of_row_container = closestRowElement.parent("tbody, thead").prop("tagName");
        } else if (closestRowElement.length > 0) {
            index_of_row = closestRowElement.index();
            type_of_row_container = closestRowElement.parent("tbody, thead").prop("tagName");
        } else {
            // leave defaults
        }
        var startOffset = AJS.Rte.getEditor().selection.getRng().startOffset || 0;

        var targetInOriginalTable = $(activeContainer).find(type_of_row_container + "> tr:eq(" + index_of_row + ")> :eq(" + index_in_row + ")");

        AJS.Rte.getEditor().selection.select(targetInOriginalTable.contents()[targetInOriginalTable.contents().length - 1]);
        AJS.Rte.getEditor().selection.collapse(false);

        if (triggeringClone.hasClass("vert_clone")) {
            $("#wysiwygTextarea_ifr")[0].contentWindow.scrollTo(iframe.scrollLeft(), activeContainer.offset().top - 10);
        } else if (triggeringClone.hasClass("hori_clone")) {
            $("#wysiwygTextarea_ifr")[0].contentWindow.scrollTo(activeContainer.offset().left - 10, iframe.scrollTop());
        } else {
            $("#wysiwygTextarea_ifr")[0].contentWindow.scrollTo(activeContainer.offset().left - 10, activeContainer.offset().top - 10);
        }
    }

    function iframeEditingHandler() {
        var currentRange = AJS.Rte.getEditor().selection.getRng();

        checkForAndRemoveInsertedParagraphs();

        if (($(currentRange.startContainer).closest(".fixed-headers-container").length > 0) ||
            ($(currentRange.endContainer).closest(".fixed-headers-container").length > 0)) {
            // so change happened within an active macro

            iframe.trigger("refreshClones.tableenhancer");
        }
    }

    // Remover functions

    function removeFixedHeadersHTMLFromIframe() {
        var iframeContent = $("#wysiwygTextarea_ifr").contents();
        $(".clone", iframeContent).remove();
        $(".tableenhancer-fixed-row", iframeContent).removeClass("tableenhancer-fixed-row");
        $(".tableenhancer-fixed-column", iframeContent).removeClass("tableenhancer-fixed-column");
        $(".fixed-headers-bottom-anchor", iframeContent).remove();
        $(".fixed-headers-container", iframeContent).each(function (index, containerElement) {
            $(containerElement, iframeContent).children("p:first-child, p:last-child").children("br:only-child").parent().remove();
            if ($(containerElement, iframeContent).prev().length > 0) {
                $(containerElement, iframeContent).contents().insertAfter($(containerElement, iframeContent).prev());
            } else {
                $(containerElement, iframeContent).contents().appendTo($(containerElement, iframeContent).parent());
            }
            $(containerElement, iframeContent).remove();
        });
    }

    function checkForAndRemoveInsertedParagraphs() {
        //Dont remove the auto-cursor target as this gets immediately inserted again and so looks strange
        //additional shifting for the clones is handled
        $("#wysiwygTextarea_ifr").contents().find(".fixed-headers-container").children("p:not(.auto-cursor-target)").remove();
    }

    // Scan iframe content for unhandled tables/non-initialized tableenhancer macros

    function checkIfSetupNecessary() {
        var iframeContent = $("#wysiwygTextarea_ifr").contents();
        $("table[data-macro-name=tableenhancer]", iframeContent).each(function (index, tableElement) {
            if ($(tableElement, iframeContent).find("table:not(.clone):not(.confluenceTable .confluencTable):not(.fixed-headers-container table)").length > 0) {
                setupMacro();
            }
        });
    }

    // Container Initialization

    function initializeTableContainers() {
        $("#wysiwygTextarea_ifr").contents().find("table[data-macro-name=tableenhancer]").each(
            function (index, element) {
                var settingsObject = getMacroSettings(element);
                configureTableContainersForMacro(
                    element,
                    settingsObject.numberOfFixedRows,
                    (settingsObject.isRowNumberingActivated ? settingsObject.numberOfFixedColumns - 1 : settingsObject.numberOfFixedColumns)
                ); // if row numbering is active, the numbering column doesn't appear in the editor, so reduce the number of fixed columns in the editor by 1
            }
        );
    }

    function getMacroSettings(macroElement) {
        var parameters = $(macroElement).data("macro-parameters"),
            numberOfFixedRows = 0, 				// default
            numberOfFixedColumns = 0, 			// default
            isRowNumberingActivated = false; 	// default

        if (parameters !== undefined) {
            var paramArray = parameters.split(/[\|=]/g);
            numberOfFixedRows = ( (paramArray.indexOf("numberOfFixedRows") >= 0) ? paramArray[paramArray.indexOf("numberOfFixedRows") + 1] : 0);
            numberOfFixedColumns = ( (paramArray.indexOf("numberOfFixedColumns") >= 0) ? paramArray[paramArray.indexOf("numberOfFixedColumns") + 1] : 0);
            isRowNumberingActivated = (paramArray.indexOf("rowNumbers") >= 0);
        }

        return {
            numberOfFixedRows: numberOfFixedRows,
            numberOfFixedColumns: numberOfFixedColumns,
            isRowNumberingActivated: isRowNumberingActivated
        };
    }

    function configureTableContainersForMacro(macroElement, numOfFixedRows, numOfFixedColumns) {
        $(macroElement).find("tbody > tr > td.wysiwyg-macro-body table.confluenceTable:not(.confluenceTable .confluenceTable)").each( // iterate over all top-level tables within the macro
            function (index, tableElement) {
                $(tableElement).wrap('<div class="fixed-headers-container" data-fixed-rows=' + numOfFixedRows + ' data-fixed-columns=' + numOfFixedColumns + '></div>');
            }
        );
    }

    // Table Setup

    function initializeTableSetup() {
        $(window).trigger("activateFixedHeaders.tableenhancer", ["editor"]);
    }

    // Helper Functions

    function appendToFunction(targetFunction, functionToAppend) {
        if (typeof targetFunction === "function") {
            return function () {
                var targetOutput = targetFunction.apply(this, arguments);
                functionToAppend();
                return targetOutput;
            };
        } else {
            AJS.log("tableenhancer warning: appendToFunction expected a function, but got", targetFunction);
        }
    }
};

AJS.bind("init.rte", function () {
    try {
        init();
    } catch (e) {
        AJS.logError("table enhancer: error in initialization", e);
    }
});

}());

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-mentions-plugin:smart-mentions-editor-resources', location = 'templates/mentions.soy' */
// This file was automatically generated from mentions.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Mentions.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Mentions == 'undefined') { Confluence.Templates.Mentions = {}; }


Confluence.Templates.Mentions.userNotFoundResult = function(opt_data, opt_ignored) {
  return '<div class="mention-error no-result">' + soy.$$escapeHtml('\u62b1\u6b49\uff0c\u6211\u4eec\u65e0\u6cd5\u627e\u5230\u8fd9\u4e2a\u4eba') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Mentions.userNotFoundResult.soyTemplateName = 'Confluence.Templates.Mentions.userNotFoundResult';
}


Confluence.Templates.Mentions.searchFailureResult = function(opt_data, opt_ignored) {
  return '<div class="mention-error search-failure"><div class="search-failure-title">' + soy.$$escapeHtml('\u51fa\u73b0\u9519\u8bef') + '</div><div class="search-failure-body">' + soy.$$escapeHtml('\u6211\u4eec\u73b0\u5728\u65e0\u6cd5\u83b7\u53d6\u4eba\u5458\u4fe1\u606f\u3002 \u51e0\u5206\u949f\u540e\u518d\u8bd5\u3002') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Mentions.searchFailureResult.soyTemplateName = 'Confluence.Templates.Mentions.searchFailureResult';
}


Confluence.Templates.Mentions.loadingPlaceholder = function(opt_data, opt_ignored) {
  return '<div class="mention-loading"><div class="avatar-placeholder"></div><div class="text-container"><div class="text-placeholder lg"></div><div class="text-placeholder sm"></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Mentions.loadingPlaceholder.soyTemplateName = 'Confluence.Templates.Mentions.loadingPlaceholder';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-mentions-plugin:smart-mentions-editor-resources', location = '/js-target/bundle.js' */
define("confluence-mentions", ["ajs","confluence/meta","jquery","confluence/legacy","confluence/templates","confluence-editor/tinymce3/plugins/autocomplete/autocomplete-manager","tinymce","confluence/storage-manager","confluence/dark-features","confluence/analytics-support","confluence-link-browser/link-object","confluence-editor/tinymce3/plugins/autocomplete/autocomplete-settings"], function(__WEBPACK_EXTERNAL_MODULE_0__, __WEBPACK_EXTERNAL_MODULE_2__, __WEBPACK_EXTERNAL_MODULE_3__, __WEBPACK_EXTERNAL_MODULE_11__, __WEBPACK_EXTERNAL_MODULE_16__, __WEBPACK_EXTERNAL_MODULE_18__, __WEBPACK_EXTERNAL_MODULE_19__, __WEBPACK_EXTERNAL_MODULE_37__, __WEBPACK_EXTERNAL_MODULE_45__, __WEBPACK_EXTERNAL_MODULE_51__, __WEBPACK_EXTERNAL_MODULE_52__, __WEBPACK_EXTERNAL_MODULE_53__) { return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 20);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_0__;

/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    'use strict';

    exports.default = {
        CURRENT: 'current',
        RELATED: 'related',
        RECENT: 'recent',
        SERVER: 'server'
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 2 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_2__;

/***/ }),
/* 3 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_3__;

/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(29), __webpack_require__(37), __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _lruCache, _storageManager, _userSupplierKeys) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var LRU = _interopRequireDefault(_lruCache).default;

    var StorageManager = _interopRequireDefault(_storageManager).default;

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    /**
     * Returns users from a localstorage-backed LRU (least-recently-used) cache, and adds entries to that cache.
     */
    var inMemoryCache = void 0;
    var persistentCache = void 0;

    var CACHE_PREFIX = 'mentions';
    var CACHE_ID = 'recently-mentioned-users';
    var CACHE_ITEMS_KEY = 'items';

    /**
     * The maximum number of recently-mentioned users to keep in the cache.
     * @type {number}
     */
    var RECENT_USER_LIMIT = 20;
    /**
     * WaterTightValidation means that any users at or past this expiry _must_ be refreshed before being displayed in the UI.
     * @type {{expireTimeMillis: number}}
     */
    var WATERTIGHT_VALIDATION = { expireTimeMillis: 29 * 24 * 60 * 60 * 1000 }; //29 days in millis
    /**
     * EarlyValidation means that any users at or past this expiry _should_ be refreshed after the UI is completed (so as to not block users)
     * @type {{expireTimeMillis: number}}
     */
    var EARLY_VALIDATION = { expireTimeMillis: 7 * 24 * 60 * 60 * 1000 }; //7 days in millis
    /**
     * stores the enums used for calls to {getStaleUsers()}.
     * @type {{WATERTIGHT_VALIDATION: {expireTimeMillis: number}, EARLY_VALIDATION: {expireTimeMillis: number}}}
     */
    var ValidationType = { WATERTIGHT_VALIDATION: WATERTIGHT_VALIDATION, EARLY_VALIDATION: EARLY_VALIDATION };

    // Lazy-initialise to avoid interacting with localStorage when it isn't required.
    function loadCache() {
        inMemoryCache = LRU(RECENT_USER_LIMIT);
        persistentCache = new StorageManager(CACHE_PREFIX, CACHE_ID);

        var recentUsersDump = persistentCache.getItem(CACHE_ITEMS_KEY);
        if (recentUsersDump) {
            var recentUsersJson = JSON.parse(recentUsersDump);
            inMemoryCache.load(recentUsersJson);
        }
    }

    function getUsers() {
        return new Promise(function (resolve) {
            inMemoryCache || loadCache();

            // Add users with order of most-recently-mentioned first
            var users = [];
            var index = 0;
            inMemoryCache.forEach(function (user) {
                user.supplier = UserSupplier.RECENT;
                user.role = null;
                user.sortIndex = index++;
                users.push(user);
            });
            AJS.debug('Found ' + users.length + ' recently-mentioned users');
            resolve(users);
        });
    }

    /**
     * Store a recently-mentioned User in the cache.
     * @param user
     * @param refreshed {Boolean} true if the user is from the server. This will update the timestamp of the last refresh to now().
     *                            Defaults to false if not passed in.
     */
    function store(user, refreshed) {
        inMemoryCache || loadCache();
        var oldUser = inMemoryCache.peek(user.username);
        var oldRefreshDate = oldUser ? oldUser.refreshedAt || 0 : 0;
        var refreshedAt = refreshed || !oldUser ? new Date().getTime() : oldRefreshDate;
        inMemoryCache.set(user.username, Object.assign({}, user.model ? user.model : user, { timestamp: user.timestamp, refreshedAt: refreshedAt }));
        persistentCache.setItemQuietly(CACHE_ITEMS_KEY, JSON.stringify(inMemoryCache.dump()));
    }

    function remove(username) {
        inMemoryCache || loadCache();
        inMemoryCache.del(username);
        persistentCache.setItemQuietly(CACHE_ITEMS_KEY, JSON.stringify(inMemoryCache.dump()));
    }

    /**
     * A stale user is one which has not been refreshed from the server for X days or more, X being calculated from the validation type.
     * @param validationType {{expireTimeMillis: number}} an enum to flag what kind of stale users to return. Use a value from ValidationType
     * @return {Array} a list of stale usersnames (NOTE: not the user objects - just the usernames)
     */
    function getStaleUsers(validationType) {
        inMemoryCache || loadCache();
        var stale = [];
        var now = new Date().getTime();
        //use a hack to iterate the keys to prevent the LRU from changing the ordering
        var existingKeys = inMemoryCache.keys();
        existingKeys.map(function (k) {
            return [inMemoryCache.peek(k), k];
        }).forEach(function (entry) {
            var val = entry[0];
            var key = entry[1];
            if (!val.refreshedAt || now - val.refreshedAt > validationType.expireTimeMillis) {
                stale.push(key);
            }
        });
        return stale;
    }

    function refresh(users) {
        inMemoryCache || loadCache();
        users.forEach(function (user) {
            if (inMemoryCache.has(user.username)) {
                var entry = inMemoryCache.peek(user.username);
                var timestamp = entry.timestamp || 0;
                //treat no timestamp as though it is stale, and refresh it
                if (!user.timestamp || !timestamp || user.timestamp > timestamp) {
                    store(user, true);
                }
            }
        });
    }

    // Used in tests
    function _clear() {
        loadCache();
    }

    exports.default = {
        getUsers: getUsers,
        store: store,
        remove: remove,
        getStaleUsers: getStaleUsers,
        refresh: refresh,
        _clear: _clear,
        RECENT_USER_LIMIT: RECENT_USER_LIMIT,
        ValidationType: ValidationType
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 5 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(6), __webpack_require__(4), __webpack_require__(10), __webpack_require__(41), __webpack_require__(13)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _relatedUsersSupplier, _recentUsersSupplier, _serverUsersSupplier, _currentUserSupplier, _userCache) {
    'use strict';

    var RelatedUsersSupplier = _interopRequireDefault(_relatedUsersSupplier).default;

    var RecentUsersSupplier = _interopRequireDefault(_recentUsersSupplier).default;

    var ServerUsersSupplier = _interopRequireDefault(_serverUsersSupplier).default;

    var CurrentUserSupplier = _interopRequireDefault(_currentUserSupplier).default;

    var UserCache = _interopRequireDefault(_userCache).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var _slicedToArray = function () {
        function sliceIterator(arr, i) {
            var _arr = [];
            var _n = true;
            var _d = false;
            var _e = undefined;

            try {
                for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
                    _arr.push(_s.value);

                    if (i && _arr.length === i) break;
                }
            } catch (err) {
                _d = true;
                _e = err;
            } finally {
                try {
                    if (!_n && _i["return"]) _i["return"]();
                } finally {
                    if (_d) throw _e;
                }
            }

            return _arr;
        }

        return function (arr, i) {
            if (Array.isArray(arr)) {
                return arr;
            } else if (Symbol.iterator in Object(arr)) {
                return sliceIterator(arr, i);
            } else {
                throw new TypeError("Invalid attempt to destructure non-iterable instance");
            }
        };
    }();

    "use strict";

    /**
     *
     * @param {string}   query              User's query
     * @param {object}   editor             the currently-active editor
     */
    function search(query, editor) {

        var serverUsersPromise = ServerUsersSupplier.getUsers(query);
        var relatedUsersPromise = RelatedUsersSupplier.getUsers(editor);
        var recentUsersPromise = RecentUsersSupplier.getUsers();
        var currentUserPromise = CurrentUserSupplier.getCurrentUser();

        var fastPromises = [relatedUsersPromise, recentUsersPromise, currentUserPromise];

        return {
            client: Promise.all(fastPromises).then(function (_ref) {
                var _ref2 = _slicedToArray(_ref, 3),
                    relatedUsers = _ref2[0],
                    recentUsers = _ref2[1],
                    currentUser = _ref2[2];

                UserCache.addAll(relatedUsers);
                UserCache.addAll(recentUsers, true);
                if (currentUser) {
                    // May be undefined if anonymous.
                    UserCache.add(currentUser, true);
                }
            }),
            server: serverUsersPromise.then(function (serverUsers) {
                UserCache.addAll(serverUsers);
                RecentUsersSupplier.refresh(serverUsers);
            })
        };
    }

    function prefetchSuppliers(editor) {
        var waterTightValidationCheck = RecentUsersSupplier.getStaleUsers(RecentUsersSupplier.ValidationType.WATERTIGHT_VALIDATION);
        if (waterTightValidationCheck.length > 0) {
            //found some users whose stale for longer than 30 days. Must revalidate and delete if needed, before showing in UI.
            deleteStaleUsers(waterTightValidationCheck, RecentUsersSupplier.ValidationType.WATERTIGHT_VALIDATION);
        }
        // This will load related users into the cache in 'service/content-users/users-related-to-content'.
        RelatedUsersSupplier.getUsers(editor);
    }

    function deleteStaleUsers(usersToCheck, validationType) {
        ServerUsersSupplier._searchWithUsernames(usersToCheck).then(function (resultUsers) {
            RecentUsersSupplier.refresh(resultUsers);
            //if users are still stale after a refresh, it means they've not been returned by the server
            //time to delete 'em
            var usersToDelete = RecentUsersSupplier.getStaleUsers(validationType);
            usersToDelete.forEach(function (u) {
                return RecentUsersSupplier.remove(u);
            });
        });
    }

    // Reset any of the suppliers that hold state. Used in testing.
    function reset() {
        RelatedUsersSupplier.reset();
        ServerUsersSupplier.reset();
        RecentUsersSupplier._clear();
    }

    exports.default = {
        search: search,
        prefetchSuppliers: prefetchSuppliers,
        deleteStaleUsers: deleteStaleUsers,
        reset: reset
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 6 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(24), __webpack_require__(25)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _draftContentSupplier, _usersRelatedToContent) {
    'use strict';

    var getDraft = _interopRequireDefault(_draftContentSupplier).default;

    var UsersRelatedToContent = _interopRequireDefault(_usersRelatedToContent).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    /**
     Returns users related to the Content currently in the Editor, optionally filtered by a search string.
    
     You can test this logic in your browser console against a running instance by running something like :
    
     `require('confluence-mentions').userSuppliers.contentRelated.getUsers().then((result) => { window.relatedUsers = result; });`
    
     and then viewing the `window.relatedUsers` value.
     */
    function getUsers(editor) {
        var content = getDraft(editor);
        return UsersRelatedToContent.getUsers(content);
    }

    /*
     We assume that all useful information is returned in the getUsersRelatedTo call.
     */
    function isExhausted() {
        return true;
    }

    // Clears the related user cache, used in testing.
    function reset() {
        UsersRelatedToContent.reset();
    }

    exports.default = {
        getUsers: getUsers,
        isExhausted: isExhausted,
        reset: reset
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 7 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(8)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _i18n) {
    'use strict';

    var I18n = _interopRequireDefault(_i18n).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var newRole = function newRole(role) {
        return {
            role: role,
            i18n: I18n('user.role.' + role)
        };
    }; /**
        A simple User Role bean that can provide its i18n'd display name.
        */
    exports.default = {
        CREATOR: newRole('creator'),
        CONTRIBUTOR: newRole('contributor'),
        COMMENTER: newRole('commenter'),
        ANCESTOR_COMMENTER: newRole('ancestorCommenter') // never shown, but available
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 8 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var i18nMap = {
        'user.role.creator': "\u521b\u5efa\u8005",
        'user.role.contributor': "\u8d21\u732e\u8005",
        'user.role.commenter': "\u8bc4\u8bba\u5458",
        'user.supplier.recent': "\u6700\u8fd1\u7684"
    }; /**
        A way to get the i18nTransformer away from all-the-JS, this module allows clients to get I18n text using
        dynamic keys. Normally the i18nTransformer would fail to handle this and the developer would be forced to add
       
        "foo100"
       
        entries for each case. By extracting those invocations of AJS.I18n.getText to a single place, we can plan for a future
        where the transformer is not necessary and we can serve one set of JS resources for all locales.
       
        A future improvement might be to generate an i18n.js file directly from a plugin's
        i18n.properties file at build time.
        */

    exports.default = function (key) {
        // TODO - could interpolate args, etc. dT
        return i18nMap[key];
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 9 */
/***/ (function(module, exports) {

// shim for using process in browser
var process = module.exports = {};

// cached from whatever global is present so that test runners that stub it
// don't break things.  But we need to wrap it in a try catch in case it is
// wrapped in strict mode code which doesn't define any globals.  It's inside a
// function because try/catches deoptimize in certain engines.

var cachedSetTimeout;
var cachedClearTimeout;

function defaultSetTimout() {
    throw new Error('setTimeout has not been defined');
}
function defaultClearTimeout () {
    throw new Error('clearTimeout has not been defined');
}
(function () {
    try {
        if (typeof setTimeout === 'function') {
            cachedSetTimeout = setTimeout;
        } else {
            cachedSetTimeout = defaultSetTimout;
        }
    } catch (e) {
        cachedSetTimeout = defaultSetTimout;
    }
    try {
        if (typeof clearTimeout === 'function') {
            cachedClearTimeout = clearTimeout;
        } else {
            cachedClearTimeout = defaultClearTimeout;
        }
    } catch (e) {
        cachedClearTimeout = defaultClearTimeout;
    }
} ())
function runTimeout(fun) {
    if (cachedSetTimeout === setTimeout) {
        //normal enviroments in sane situations
        return setTimeout(fun, 0);
    }
    // if setTimeout wasn't available but was latter defined
    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
        cachedSetTimeout = setTimeout;
        return setTimeout(fun, 0);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedSetTimeout(fun, 0);
    } catch(e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
            return cachedSetTimeout.call(null, fun, 0);
        } catch(e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
            return cachedSetTimeout.call(this, fun, 0);
        }
    }


}
function runClearTimeout(marker) {
    if (cachedClearTimeout === clearTimeout) {
        //normal enviroments in sane situations
        return clearTimeout(marker);
    }
    // if clearTimeout wasn't available but was latter defined
    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
        cachedClearTimeout = clearTimeout;
        return clearTimeout(marker);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedClearTimeout(marker);
    } catch (e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
            return cachedClearTimeout.call(null, marker);
        } catch (e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
            // Some versions of I.E. have different rules for clearTimeout vs setTimeout
            return cachedClearTimeout.call(this, marker);
        }
    }



}
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    if (!draining || !currentQueue) {
        return;
    }
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = runTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            if (currentQueue) {
                currentQueue[queueIndex].run();
            }
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    runClearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        runTimeout(drainQueue);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;
process.prependListener = noop;
process.prependOnceListener = noop;

process.listeners = function (name) { return [] }

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };


/***/ }),
/* 10 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(11), __webpack_require__(2), __webpack_require__(3), __webpack_require__(12), __webpack_require__(39), __webpack_require__(1), __webpack_require__(40)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _legacy, _meta, _jquery, _userRanker, _serverUserCache, _userSupplierKeys, _luceneQuery) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var Confluence = _interopRequireDefault(_legacy).default;

    var Meta = _interopRequireDefault(_meta).default;

    var $ = _interopRequireDefault(_jquery).default;

    var UserRanker = _interopRequireDefault(_userRanker).default;

    var Cache = _interopRequireDefault(_serverUserCache).default;

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    var LuceneQuery = _interopRequireDefault(_luceneQuery).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    /**
     * Wait this long after REST call triggers before actually doing a search - results in fewer HTTP requests.
     */
    var DEBOUNCE_WAIT_MS = 250;

    // 1 char query is now supported by CQL.
    var MIN_CHARS_TO_SEARCH = 1;

    var limit = 100;
    var cache = Cache(limit);

    /**
     * The id of the last timeout to be created for a REST call. We cancel this timeout if
     * a scheduled call becomes stale.
     */
    var lastTimeout = void 0;

    /**
     Returns users from the backend via a CQL search.
     */
    function getUsers(query) {
        return new Promise(function (resolve, reject) {

            if (!query || query.length < MIN_CHARS_TO_SEARCH) {
                // No query - no server results.
                return resolve([]);
            }

            AJS.debug('server-users-supplier: Looking in cache for ' + query);
            var cacheEntry = cache.getClosest(query);
            if (cacheEntry) {
                AJS.debug('server-users-supplier: Found cache entry with query ' + cacheEntry.query);
                if (cacheEntry.query === query) {
                    // Exact match - just serve these results.
                    return resolve(cacheEntry.users);
                }

                // Not an exact match. Might need a REST call, but we can show results based on what we have cached.
                var rankedUsers = UserRanker(cacheEntry.users, query);
                cache.add(query, rankedUsers);

                // TODO Always resolve with what we have from the cache - this is information that can be put in front of
                // the user immediately. We then decide whether to follow up the local results with remote ones.
                // However, we need the ability to 'resolve' multiple times - to call the render once with the cached
                // results and again (if not debounced, stale, etc, etc) with the server results.
                if (cacheEntry.isExhausted) {
                    return resolve(rankedUsers);
                }

                // Else we might be searching for "John" but "Joh" already has >={limit} users.
                // We need to hit the server!
                // TODO - can we resolve multiple times?
            }

            var contextPath = Meta.get('context-path');
            var escapedQuery = LuceneQuery.escape(query);
            var queryParameters = {
                cql: 'user ~ "' + Confluence.unescapeEntities(escapedQuery) + '"',
                start: 0,
                limit: limit
            };
            var url = contextPath + '/rest/api/search';
            var success = function success(response) {
                var results = response.results;
                var users = results.map(function (result) {
                    var user = result.user;
                    user.supplier = UserSupplier.SERVER;
                    user.timestamp = result.timestamp;
                    AJS.debug('server-users-supplier: Adding user to cache: ' + user.username);
                    return user;
                });
                cache.add(query, users);
                resolve(users);
            };

            // Debounce
            clearTimeout(lastTimeout);
            lastTimeout = setTimeout(function () {
                $.getJSON(url, queryParameters, success).fail(reject);
            }, DEBOUNCE_WAIT_MS);
        });
    }

    /**
     * Forces a search for exact usernames. Use this to ensure the cached entries in
     * other suppliers are not stale.
     * @param usernames {Array} Array of username strings
     * @returns {Promise} a promise which will resolve with an array of user objects from the search that matched any of the input usernames.
     * @private
     */
    function _searchWithUsernames(usernames) {
        return new Promise(function (resolve, reject) {
            if (!usernames || usernames.length === 0) {
                return resolve([]);
            }
            var contextPath = Meta.get('context-path');
            var queryParameters = {
                cql: 'user in (' + usernames.map(function (u) {
                    return '"' + u + '"';
                }).join(",") + ')',
                start: 0,
                limit: usernames.length
            };
            AJS.debug('querying with \'' + queryParameters.cql + '\'');
            var url = contextPath + '/rest/api/search';
            var success = function success(response) {
                var results = response.results;
                var users = results.map(function (result) {
                    var user = result.user;
                    user.supplier = UserSupplier.SERVER;
                    user.timestamp = result.timestamp;
                    return user;
                });
                resolve(users);
            };

            // Debounce
            clearTimeout(lastTimeout);
            lastTimeout = setTimeout(function () {
                $.getJSON(url, queryParameters, success).fail(reject);
            }, DEBOUNCE_WAIT_MS);
        });
    }

    /**
     If a given search returns less that the specified limit, we say that that query is exhausted - adding more
     characters to the query will return a subset of users from the shorter query.
     */
    function isExhausted(query) {
        return true;
    }

    // Flushes the cache between tests.
    function reset() {
        cache.reset();
        AJS.debug('server-users-supplier: Cache reset');
    }

    exports.default = {
        getUsers: getUsers,
        _searchWithUsernames: _searchWithUsernames,
        isExhausted: isExhausted,
        reset: reset,
        DEBOUNCE_WAIT_MS: DEBOUNCE_WAIT_MS
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 11 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_11__;

/***/ }),
/* 12 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(11), __webpack_require__(38)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _legacy, _fuse) {
    'use strict';

    var Confluence = _interopRequireDefault(_legacy).default;

    var Fuse = _interopRequireDefault(_fuse).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    /**
     * Details for these options are available at http://fusejs.io/, but the basic gist is:
     *
     * - tokenize is required so that first and last names are searched from their first character
     * - matchAllTokens so that tokenize will match all words in the query
     * - threshold close to 0 to avoid unhelpful results, but this can be tweaked because...
     * - shouldSort will put the best matches at the top of the result array.
     * - location means that matching should start at the beginning of words, which is usually
     *     what name searches will want
     */
    /**
     * Ranks users, given a query.
     */
    var options = {
        includeMatches: true,
        includeScore: true,
        tokenize: true,
        matchAllTokens: true,
        threshold: 0.1,
        location: 0,
        distance: 0,
        maxPatternLength: 16,
        minMatchCharLength: 1,
        keys: [{
            name: 'displayName',
            weight: 0.7
        }, {
            name: 'username',
            weight: 0.3
        }]
    };

    exports.default = function (users, query) {
        if (!query) {
            return users;
        }

        // TODO Depending on what kind of setup is done in the Fuse constructor, we might want to
        // optimise by keeping an instance around that has all of the users currently-known to the
        // frontend: including cached Server search results.
        var fuse = new Fuse(users, options);
        var results = fuse.search(Confluence.unescapeEntities(query));
        return results.map(function (result) {
            var item = result.item;
            item.fuseMatches = result.matches;
            item.fuseScore = result.score;
            return item;
        });
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 13 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    /**
     * Where all the aggregation and caching happens
     */
    "use strict";

    function _toConsumableArray(arr) {
        if (Array.isArray(arr)) {
            for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {
                arr2[i] = arr[i];
            }

            return arr2;
        } else {
            return Array.from(arr);
        }
    }

    var userCache = new Map();

    /**
     * Updates the incoming User object to split "displayName" into "firstName" and "lastNames" to aid Fuse matching.
     * @param user
     * @private
     */
    function _splitNames(user) {
        if (!user || !user.displayName) {
            return;
        }

        // We store first and last names separately to enable search weightings in Fuse.
        // JS String.split doesn't quite do what we need so we just use a substring.
        var firstSpace = user.displayName.indexOf(' ');
        if (firstSpace > 0) {
            user.firstName = user.displayName.substring(0, firstSpace);
            user.lastNames = user.displayName.substring(firstSpace + 1);
        } else {
            // A user display name in a language without spaces. Setting the firstName should work in most cases.
            user.firstName = user.displayName;
            user.lastNames = '';
        }
    }

    function _isStaleEntry(user) {
        if (!userCache.has(user.username)) {
            return true;
        }
        var entry = userCache.get(user.username);
        var timestamp = entry.timestamp || 0;
        return user.timestamp > timestamp;
    }

    exports.default = {
        /**
         * Will add the user to the user cache, if it's not already present.
         * @param {user}    user     A single user in API format
         * @param {boolean} force    if true, any cached user with the same username will be replaced with this user
         */
        add: function add(user) {
            var force = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

            // Existing cache entries may have a different Supplier for a given user - don't overwrite.
            if (user && user.hasOwnProperty("username") && (force === true || _isStaleEntry(user))) {
                _splitNames(user);
                userCache.set(user.username, user);
            }
        },

        /**
         * Will add all the supplied users by individually calling add
         * @param users an array of users
         */
        addAll: function addAll(users, force) {
            var _this = this;

            users.forEach(function (user) {
                _this.add(user, force);
            });
        },

        /**
         * @returns an array of all the users in the cache
         */
        getAll: function getAll() {
            return [].concat(_toConsumableArray(userCache.values()));
        },

        /**
         * Used for testing
         * @private
         */
        _get: function _get(username) {
            return userCache.get(username);
        },

        /**
         * Used for testing
         * @private
         */
        _clear: function _clear() {
            userCache.clear();
        }
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 14 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(5), __webpack_require__(13), __webpack_require__(42), __webpack_require__(49), __webpack_require__(17)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _userSupplierManager, _userCache, _pipelines, _executor, _scoreBooster) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var userSupplierManager = _interopRequireDefault(_userSupplierManager).default;

    var UserCache = _interopRequireDefault(_userCache).default;

    var Pipelines = _interopRequireDefault(_pipelines).default;

    var PipelineExecutor = _interopRequireDefault(_executor).default;

    var ScoreBooster = _interopRequireDefault(_scoreBooster).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    /**
     * The maximum number of Users that will be displayed in the Mentions dropdown.
     */
    var DISPLAY_LIMIT = 5;
    var NON_BREAKING_SPACE = String.fromCharCode(160);

    // The last query to be triggered, used when server responses return out of order and we need to skip the render of
    // stale responses.
    var latestQuery = void 0;

    /**
     *
     * @param {string}   query              User's query
     * @param {function} renderCallback     Callback function to render the results
     * @param {function} selectedUser       (optional) the currently-selected user in the dropdown
     * @param {object} editor               the currently-active editor
     */
    function searchAndRender(query, renderCallback, selectedUser, editor) {
        // Trim the query but don't convert to lowercase just yet - the ranker should handle this. (i.e. upper case
        // letters could be weighted higher in matches).
        // Note that 160 is the non-breaking-space character and is not handled by trim().
        // It IS handled by $.trim(str) but noooooo, noooooo.
        query = query.replace(NON_BREAKING_SPACE, ' ').trim();
        latestQuery = query;

        var promises = userSupplierManager.search(query, editor);

        promises.client.then(function () {
            resolveClientUsers();
            // Guarantee that server results are handled after local ones - chain the promises!
            promises.server.then(resolveServerUsers, renderErrorOnReject);
        }, renderErrorOnReject);

        function resolveClientUsers() {
            renderPipeline(UserCache.getAll(), query, renderCallback, selectedUser, false);
        }

        function resolveServerUsers() {
            // We could in future wrap the renderCallback so that if the server render would have the same values as the
            // client render, we skip it and avoid a browser repaint.
            renderPipeline(UserCache.getAll(), query, renderCallback, selectedUser, true);
        }

        function renderErrorOnReject() {
            var iterator = new PipelineExecutor(Pipelines.error(renderCallback));
            iterator.execute([]);
        }
    }

    function renderPipeline(users, query, renderCallback, selectedUser, isServerCall) {
        var context = {
            query: query,
            latestQuery: latestQuery,
            selectedUser: selectedUser,
            isServerCall: isServerCall,
            DISPLAY_LIMIT: DISPLAY_LIMIT
        };

        var pipeline = void 0;
        if (!query) {
            pipeline = Pipelines.default(renderCallback);
        } else {
            pipeline = isServerCall ? Pipelines.server(renderCallback) : Pipelines.client(renderCallback);
        }

        var executor = new PipelineExecutor(pipeline, context);
        executor.execute(users);
    }

    // Called during testing to clear caches.
    function reset() {
        userSupplierManager.reset();
        UserCache._clear();
        ScoreBooster.reset();
    }

    exports.default = {
        searchAndRender: searchAndRender,
        prefetchSuppliers: userSupplierManager.prefetchSuppliers,
        reset: reset
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 15 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    "use strict";

    exports.default = {
        resultWithHtml: function resultWithHtml(html) {
            return {
                html: html
            };
        }
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 16 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_16__;

/***/ }),
/* 17 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _userSupplierKeys) {
    'use strict';

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var suggestedUsers = [];

    /**
     * When searching for a user you're likely to want a user you've recently mentioned, even if other Fuse matches have
     * slightly better (lower) scores. For now we boost all recent matches, but we could adjust this to only the recent match
     * with the best score.
     *
     * Also, contributors should bubble to the top in the search results, at least until the search token is compelling enough
     * to switch.
     */
    function boostScores(users, next, context) {
        var query = context && context.query || '';
        if (query.indexOf(' ') > 0) {
            // Don't boost on supplier once multiple names are being added - the user seems to know who they're after so
            // let Fuse do its job.
            return next(users);
        }

        // The pipeline could be ensuring that users passed down the pipe are immutable, but for now just clone. fuseScore
        // should NOT be making its way into the user cache.
        var boostedUsers = users.map(function (userIn) {
            var user = Object.assign({}, userIn);
            if (suggestedUsers.includes(user.username)) {
                user.fuseScore /= 1000; // keep ordering for multiple matched suggestions
            } else if (typeof user.fuseScore === 'number') {
                switch (user.supplier) {
                    case UserSupplier.RECENT:
                        user.fuseScore /= 5;
                        break;
                    case UserSupplier.RELATED:
                        user.fuseScore /= 10;
                        break;
                }
            }
            return user;
        });
        return next(boostedUsers);
    }

    function setSuggestedUsers(users, next) {
        suggestedUsers = users.map(function (user) {
            return user.username;
        });
        return next(users);
    }

    function reset() {
        suggestedUsers = [];
    }

    exports.default = {
        boostScores: boostScores,
        setSuggestedUsers: setSuggestedUsers,
        reset: reset
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 18 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_18__;

/***/ }),
/* 19 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_19__;

/***/ }),
/* 20 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(21);


/***/ }),
/* 21 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(22), __webpack_require__(6), __webpack_require__(4), __webpack_require__(10), __webpack_require__(19)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _editorPluginInit, _relatedUsersSupplier, _recentUsersSupplier, _serverUsersSupplier, _tinymce) {
    'use strict';

    var editorPluginInit = _interopRequireDefault(_editorPluginInit).default;

    var RelatedUsersSupplier = _interopRequireDefault(_relatedUsersSupplier).default;

    var RecentUsersSupplier = _interopRequireDefault(_recentUsersSupplier).default;

    var ServerUsersSupplier = _interopRequireDefault(_serverUsersSupplier).default;

    var tinymce = _interopRequireDefault(_tinymce).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    function init(e, context) {
        var editor = context && context.editor; // in case the initCallback internal code breaks API

        tinymce.create('tinymce.plugins.InsertMentions', {
            init: editorPluginInit(editor),

            getInfo: function getInfo() {
                return {
                    longname: 'Insert Mentions',
                    author: 'Atlassian',
                    authorurl: 'http://www.atlassian.com',
                    version: tinymce.majorVersion + "." + tinymce.minorVersion
                };
            }
        });

        tinymce.PluginManager.add('insertmentions', tinymce.plugins.InsertMentions);
    }

    /**
     * This is the main export from the Mentions module set.
     */
    exports.default = {
        init: init,
        userSuppliers: {
            // Users from localstorage
            recent: RecentUsersSupplier,
            // Users from the server
            serverSearch: ServerUsersSupplier,
            // Users from the front-end cache of the Content in the editor
            contentRelated: RelatedUsersSupplier
        }
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 22 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(3), __webpack_require__(23), __webpack_require__(14), __webpack_require__(18), __webpack_require__(53)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _jquery, _autocompleteAdapter, _Mentions, _autocompleteManager, _autocompleteSettings) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var $ = _interopRequireDefault(_jquery).default;

    var Adapter = _interopRequireDefault(_autocompleteAdapter).default;

    var Mentions = _interopRequireDefault(_Mentions).default;

    var AutocompleteManager = _interopRequireDefault(_autocompleteManager).default;

    var AutocompleteSettings = _interopRequireDefault(_autocompleteSettings).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    function activateMentions() {
        AJS.EventQueue.push({ name: 'confluencementioninsert' });
        AutocompleteManager.shortcutFired("@");
    }

    function onClickEvent(event) {
        event.stopPropagation();
        event.preventDefault();
        AJS.Rte.getEditor().focus();
        activateMentions();
    }

    function editorPluginInit(editor) {
        AJS.EventQueue = AJS.EventQueue || [];
        Mentions.prefetchSuppliers(editor);

        AutocompleteSettings.Settings["@"] = {
            ch: "@",
            cache: true,
            endChars: [],
            dropDownClassName: "autocomplete-mentions fabric",
            autocompleteClassNames: "fabric",
            dropDownDelay: 0, // No delay needed because there is no AJAX request involved
            selectFirstItem: true,
            minLengthForGetData: 1,
            displayHandler: function displayHandler(user) {
                // Use Jquery to encode the user name
                return $('<div/>').text(user.name).html();
            },

            getHeaderText: function getHeaderText() {
                return null; // HACK this could be an option in core, the header is currently being hidden with CSS.
            },

            getAdditionalLinks: function getAdditionalLinks(autoCompleteControl, value, callback) {
                var additionalLinks = [];
                if (callback) callback(value, additionalLinks);
                return additionalLinks;
            },

            /**
             *
             * @param autoCompleteControl
             * @param value     The user's input
             * @param {function} renderResults  function to run with the resulting users (from input-driven-dropdown in
             *                                  Core)
             */
            getDataAndRunCallback: function getDataAndRunCallback(autoCompleteControl, value, renderResults) {
                Adapter.search(autoCompleteControl, value, renderResults, editor);
            },

            /**
             * Overrides the confluence/highlighter used to highlight query term matches in results
             */
            // For now, this override is ignored: we're getting better results from the default highlighter than with the
            // highlighting based on Fuse.js output.
            // Highlighter,

            update: Adapter.insert
        };

        $('#insertmention-button').on('click', onClickEvent);

        if (AJS.Rte.Placeholder && AJS.Rte.Placeholder.addPlaceholderType) {
            AJS.Rte.Placeholder.addPlaceholderType({
                type: 'mention',
                label: "\u7528\u6237\u63d0\u53ca",
                tooltip: "\u5f53\u7528\u6237\u8f93\u5165\u65f6\uff0c\u5f15\u5bfc\u6027\u6587\u5b57\u5c06\u88ab\u63a8\u8350\u4eba\u5458\u66ff\u6362\u3002"
            });
        }
    }

    exports.default = editorPluginInit;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 23 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(14), __webpack_require__(4), __webpack_require__(5), __webpack_require__(50), __webpack_require__(2), __webpack_require__(52), __webpack_require__(19)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _Mentions, _recentUsersSupplier, _userSupplierManager, _mentionAnalytics, _meta, _linkObject, _tinymce) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var Mentions = _interopRequireDefault(_Mentions).default;

    var RecentUsers = _interopRequireDefault(_recentUsersSupplier).default;

    var UserSupplierManager = _interopRequireDefault(_userSupplierManager).default;

    var MentionsAnalytics = _interopRequireDefault(_mentionAnalytics).default;

    var Meta = _interopRequireDefault(_meta).default;

    var Link = _interopRequireDefault(_linkObject).default;

    var tinymce = _interopRequireDefault(_tinymce).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    var BASE_URL = Meta.get('base-url');

    function search(autoCompleteControl, value, renderResults, editor) {
        MentionsAnalytics.updateSession(autoCompleteControl);

        // The && guard here can be removed once the core tinymce3/plugins/autocomplete/autocomplete-manager.js code is released.
        // Hacky try catch to work around CONFSRVDEV-3101 and CONFSRVDEV-3138
        var selectedUser = void 0;
        try {
            var selectedItem = autoCompleteControl.getCurrentItem && autoCompleteControl.getCurrentItem();
            selectedUser = selectedItem && selectedItem.model;
        } catch (ignored) {
            console.log('Error retrieving currently-selected autoComplete item');
            console.log(ignored);
        }

        // renderResults likes a 2D array, and the query tokens in an array for highlighting
        var tokens = value && value.split(' ') || [];
        var render = function render(results, next, context) {
            return renderResults([results], value, null, tokens, context);
        };
        Mentions.searchAndRender(value, render, selectedUser, editor);
    }

    function insert(autoCompleteControl, user) {
        MentionsAnalytics.publishEventForSelection(user, autoCompleteControl.analytics);

        // Add this user to the cache - it will be retrieved with the recent-users-supplier module.
        RecentUsers.store(user);

        var earlyValidationCheck = RecentUsers.getStaleUsers(RecentUsers.ValidationType.EARLY_VALIDATION);
        if (earlyValidationCheck.length > 0) {
            //asynchronously attempt to update the recently mentioned cache to remove any stale users, after the UI insert is completed
            setTimeout(function () {
                return UserSupplierManager.deleteStaleUsers(earlyValidationCheck, RecentUsers.ValidationType.EARLY_VALIDATION);
            }, 0);
        }

        var link = {
            attrs: {
                href: user.link,
                'userkey': user.model.userKey, // required to unmarshall ResourceIdentifier
                'data-base-url': BASE_URL,
                'data-linked-resource-type': 'userinfo',
                'data-linked-resource-default-alias': user.name
            },
            body: {
                html: AJS.escapeHtml(user.name)
            },
            classes: ['confluence-link']
        };
        Link.fromData(link).insert();
        tinymce.activeEditor.selection.setContent(" ");
    }

    // Called during testing
    function reset() {
        Mentions.reset();
    }

    exports.default = {
        search: search,
        insert: insert,
        reset: reset
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 24 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(2), __webpack_require__(3)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _meta, _jquery) {
    'use strict';

    var Meta = _interopRequireDefault(_meta).default;

    var $ = _interopRequireDefault(_jquery).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    // Adapted from confluence-quick-edit/src/main/resources/jscripts/handlers/comment.js.
    /**
     Supplies the Content API model object associated with the current draft in the editor.
    
     This is basically a shim for something that the Editor JS API *should* provide but currently doesn't
     */
    function getParameter(url, paramName) {
        if (!url) {
            return '';
        }
        var regex = new RegExp("[?&]" + paramName + "=(\\d+)");
        var match = url.match(regex);
        return match && match.length > 1 ? match[1] : '';
    }

    function safeGetDraft(editor) {
        if (!editor) {
            return null;
        }

        try {
            return getDraft(editor);
        } catch (e) {
            // This might happen if the Editor is being initialised in a context we don't yet support.
            console.error(e.message);
            return null;
        }
    }

    function getDraft(editor) {
        var id = Meta.get('page-id');

        var form = editor.formElement;
        var action = form.action || '';

        if (action.indexOf('/doaddcomment.action') > -1 || action.indexOf('/doeditcomment.action') > -1 || $(form).closest('.ic-sidebar').length) {
            var commentId = getParameter(action, "commentId") || '0';

            var content = {
                id: commentId,
                type: 'comment',
                status: 'draft',
                container: {
                    id: id
                }
            };

            var parentCommentId = getParameter(action, "parentId");
            if (parentCommentId) {
                content.ancestors = [{
                    id: parentCommentId
                }];
            }

            return content;
        }

        var previewContainer = $(form).closest('.cp-container');
        if (previewContainer.length) {
            // This is a comment for a Preview. Until we have a proper API, scrape the DOM and shed a single tear.
            var previewTitle = previewContainer.find('.cp-file-title').text().replace(/"/g, "\\\"");
            // CONFSRVDEV-11704 because the previewer can be triggered from like million places, and because we suck
            // and don't set the alias for attachment titles consistently , which means we need to look for them with spaces
            // a well as with + for space
            var alternateTitle = escape(previewTitle.replace(/\s/g, "+"));
            var $element = $('body').find('*[data-linked-resource-default-alias="' + previewTitle + '"], *[data-linked-resource-default-alias="' + alternateTitle + '"]');
            if ($element.length) {
                var attachmentId = $element.attr('data-linked-resource-id');
                // Again, until Previews exposes an API, and the Editor consumes it in a way that THIS code can consume,
                // we're limited in how Smart the suggestions here can be. For now, editing an existing comment or replying
                // to a comment are treated the same as creating a new comment.
                return {
                    id: 0,
                    type: 'comment',
                    status: 'draft',
                    container: {
                        id: attachmentId
                    }
                };
            }
        }

        var newPage = Meta.get('new-page');

        var type = Meta.get('content-type');
        return {
            id: newPage ? '0' : id,
            type: type,
            status: 'draft'
        };
    }

    exports.default = safeGetDraft;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 25 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(2), __webpack_require__(3), __webpack_require__(26), __webpack_require__(27), __webpack_require__(28)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _meta, _jquery, _aggregateUsers, _restParameters, _relatedUserTransformer) {
    'use strict';

    var Meta = _interopRequireDefault(_meta).default;

    var $ = _interopRequireDefault(_jquery).default;

    var aggregateUsers = _interopRequireDefault(_aggregateUsers).default;

    var getRestParameters = _interopRequireDefault(_restParameters).default;

    var flattenUsers = _interopRequireDefault(_relatedUserTransformer).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict"; /**
                   Supplies Users that are related to a piece of Content, calculated from server data via the Content API.
                   */


    var cache = {};

    var getUsers = function getUsers(contentStub) {
        var restParams = getRestParameters(contentStub);
        if (!restParams) {
            // Will be null for new pages and blogposts: don't make a REST call, don't cache
            return Promise.resolve([]);
        }

        if (restParams.contentId in cache) {
            return cache[restParams.contentId];
        }

        var promise = new Promise(function (resolve, reject) {
            var contextPath = Meta.get('context-path');
            var url = contextPath + '/rest/api/content/' + restParams.contentId;
            var queryParameters = {
                expand: restParams.expand
            };

            $.getJSON(url, queryParameters, function (content) {
                resolve(flattenUsers(aggregateUsers(content)));
            }).fail(reject);
        });

        cache[restParams.contentId] = promise;
        return promise;
    };

    // Used in testing.
    function reset() {
        cache = {};
    }

    exports.default = {
        getUsers: getUsers,
        reset: reset,
        _cache: cache //exposed for testing
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 26 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(7), __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _userRole, _userSupplierKeys) {
    'use strict';

    var UserRole = _interopRequireDefault(_userRole).default;

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    exports.default = function (content) {
        var relatedUsers = {};

        // Used to track users that have already been added to relatedUsers
        var usernames = new Set();

        // Skip anonymous users, disabled/deleted users, and users already in the result
        function shouldAddUser(user) {
            if (user.type === 'anonymous') {
                return false;
            }

            if (typeof user.status === 'undefined') {
                console.error("User status is undefined. Not adding to relatedUsers aggregate.");
                return false;
            }
            return user.status === 'current' && !usernames.has(user.username);
        }

        function addUser(user, role) {
            user.role = role;
            user.supplier = UserSupplier.RELATED;
            var roleKey = role.role;
            relatedUsers[roleKey] = relatedUsers[roleKey] || [];
            relatedUsers[roleKey].push(user);
            usernames.add(user.username);
        }

        function addUserWithRole(user, role) {
            if (shouldAddUser(user)) {
                addUser(user, role);
            }
        }

        var page = content.type === 'comment' ? content.container : content;

        addUserWithRole(page.history.createdBy, UserRole.CREATOR);

        // Contributors are reversed to descending chronological order - users are more likely to mention contributors who
        // edited the content more recently.
        page.history.contributors.publishers.users.reverse().forEach(function (contributor) {
            addUserWithRole(contributor, UserRole.CONTRIBUTOR);
        });

        if (content.type === 'comment' && content.ancestors) {
            // A new or existing comment that is a reply to another comment. We catch ancestor commenters before other
            // commenters because they are more likely to be mentioned.
            // Ancestor order is not reversed because they are already ordered youngest to oldest.
            content.ancestors.forEach(function (ancestorComment) {
                addUserWithRole(ancestorComment.version.by, UserRole.ANCESTOR_COMMENTER);
            });
        }

        // Page commenters are also listed in reverse order
        page.children.comment.results.reverse().forEach(function (comment) {
            addUserWithRole(comment.version.by, UserRole.COMMENTER);
        });

        return relatedUsers;
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 27 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    'use strict';

    /**
     Calculations the content id and expansions that should be used in the REST API call when building the
     list of users related to a piece of Content in the editor.
     */

    var PAGE_REST_EXPANSIONS = 'history.createdBy.status,history.contributors.publishers.users.status,children.comment.version.by.status';
    var COMMENT_REST_EXPANSIONS = 'ancestors.version.by.status,container.history.createdBy.status,container.history.contributors.publishers.users.status,container.children.comment.version.by.status';

    function restParams(id, expansions) {
        return {
            contentId: id,
            expand: expansions
        };
    }

    function isBlankId(val) {
        return !val || val === '0';
    }

    exports.default = function (contentStub) {
        if (!contentStub) {
            return null;
        }

        if (contentStub.type === 'page' || contentStub.type === 'blogpost') {
            var pageId = contentStub.id;
            if (isBlankId(pageId)) {
                // A new page/blogpost has no related users.
                return null;
            }
            // Editing an existing page or blogpost
            return restParams(pageId, PAGE_REST_EXPANSIONS);
        }

        if (contentStub.type === 'comment') {
            var commentId = contentStub.id;
            if (!isBlankId(commentId)) {
                // Editing an existing comment
                return restParams(commentId, COMMENT_REST_EXPANSIONS);
            }

            // A new comment: the stub will include the id of the comment it is replying to, unless this is a top-level
            // comment. NOTE: if we end up with access to a Draft comment, we should be able to use its id as the
            // content id, and not use the parent-comment or page ids here.
            var parentCommentId = contentStub.ancestors && contentStub.ancestors[0] && contentStub.ancestors[0].id;
            if (!isBlankId(parentCommentId)) {
                // A new reply
                return restParams(parentCommentId, COMMENT_REST_EXPANSIONS);
            }

            // A new top-level comment
            var _pageId = contentStub.container.id;
            return restParams(_pageId, PAGE_REST_EXPANSIONS);
        }
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 28 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(7)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _userRole) {
    "use strict";

    var UserRole = _interopRequireDefault(_userRole).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    /**
     * Converts the map of users by role into a list of users.
     */

    exports.default = function (usersMap) {
        var transformedList = [];

        function addUsersWithRoleToList(userRole) {
            var users = usersMap[userRole.role];
            if (users && users.length) {
                transformedList = transformedList.concat(users);
            }
        }

        addUsersWithRoleToList(UserRole.CREATOR);
        addUsersWithRoleToList(UserRole.CONTRIBUTOR);
        addUsersWithRoleToList(UserRole.COMMENTER);
        addUsersWithRoleToList(UserRole.ANCESTOR_COMMENTER);

        return transformedList;
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 29 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = LRUCache

// This will be a proper iterable 'Map' in engines that support it,
// or a fakey-fake PseudoMap in older versions.
var Map = __webpack_require__(30)
var util = __webpack_require__(32)

// A linked list to keep track of recently-used-ness
var Yallist = __webpack_require__(36)

// use symbols if possible, otherwise just _props
var hasSymbol = typeof Symbol === 'function'
var makeSymbol
if (hasSymbol) {
  makeSymbol = function (key) {
    return Symbol.for(key)
  }
} else {
  makeSymbol = function (key) {
    return '_' + key
  }
}

var MAX = makeSymbol('max')
var LENGTH = makeSymbol('length')
var LENGTH_CALCULATOR = makeSymbol('lengthCalculator')
var ALLOW_STALE = makeSymbol('allowStale')
var MAX_AGE = makeSymbol('maxAge')
var DISPOSE = makeSymbol('dispose')
var NO_DISPOSE_ON_SET = makeSymbol('noDisposeOnSet')
var LRU_LIST = makeSymbol('lruList')
var CACHE = makeSymbol('cache')

function naiveLength () { return 1 }

// lruList is a yallist where the head is the youngest
// item, and the tail is the oldest.  the list contains the Hit
// objects as the entries.
// Each Hit object has a reference to its Yallist.Node.  This
// never changes.
//
// cache is a Map (or PseudoMap) that matches the keys to
// the Yallist.Node object.
function LRUCache (options) {
  if (!(this instanceof LRUCache)) {
    return new LRUCache(options)
  }

  if (typeof options === 'number') {
    options = { max: options }
  }

  if (!options) {
    options = {}
  }

  var max = this[MAX] = options.max
  // Kind of weird to have a default max of Infinity, but oh well.
  if (!max ||
      !(typeof max === 'number') ||
      max <= 0) {
    this[MAX] = Infinity
  }

  var lc = options.length || naiveLength
  if (typeof lc !== 'function') {
    lc = naiveLength
  }
  this[LENGTH_CALCULATOR] = lc

  this[ALLOW_STALE] = options.stale || false
  this[MAX_AGE] = options.maxAge || 0
  this[DISPOSE] = options.dispose
  this[NO_DISPOSE_ON_SET] = options.noDisposeOnSet || false
  this.reset()
}

// resize the cache when the max changes.
Object.defineProperty(LRUCache.prototype, 'max', {
  set: function (mL) {
    if (!mL || !(typeof mL === 'number') || mL <= 0) {
      mL = Infinity
    }
    this[MAX] = mL
    trim(this)
  },
  get: function () {
    return this[MAX]
  },
  enumerable: true
})

Object.defineProperty(LRUCache.prototype, 'allowStale', {
  set: function (allowStale) {
    this[ALLOW_STALE] = !!allowStale
  },
  get: function () {
    return this[ALLOW_STALE]
  },
  enumerable: true
})

Object.defineProperty(LRUCache.prototype, 'maxAge', {
  set: function (mA) {
    if (!mA || !(typeof mA === 'number') || mA < 0) {
      mA = 0
    }
    this[MAX_AGE] = mA
    trim(this)
  },
  get: function () {
    return this[MAX_AGE]
  },
  enumerable: true
})

// resize the cache when the lengthCalculator changes.
Object.defineProperty(LRUCache.prototype, 'lengthCalculator', {
  set: function (lC) {
    if (typeof lC !== 'function') {
      lC = naiveLength
    }
    if (lC !== this[LENGTH_CALCULATOR]) {
      this[LENGTH_CALCULATOR] = lC
      this[LENGTH] = 0
      this[LRU_LIST].forEach(function (hit) {
        hit.length = this[LENGTH_CALCULATOR](hit.value, hit.key)
        this[LENGTH] += hit.length
      }, this)
    }
    trim(this)
  },
  get: function () { return this[LENGTH_CALCULATOR] },
  enumerable: true
})

Object.defineProperty(LRUCache.prototype, 'length', {
  get: function () { return this[LENGTH] },
  enumerable: true
})

Object.defineProperty(LRUCache.prototype, 'itemCount', {
  get: function () { return this[LRU_LIST].length },
  enumerable: true
})

LRUCache.prototype.rforEach = function (fn, thisp) {
  thisp = thisp || this
  for (var walker = this[LRU_LIST].tail; walker !== null;) {
    var prev = walker.prev
    forEachStep(this, fn, walker, thisp)
    walker = prev
  }
}

function forEachStep (self, fn, node, thisp) {
  var hit = node.value
  if (isStale(self, hit)) {
    del(self, node)
    if (!self[ALLOW_STALE]) {
      hit = undefined
    }
  }
  if (hit) {
    fn.call(thisp, hit.value, hit.key, self)
  }
}

LRUCache.prototype.forEach = function (fn, thisp) {
  thisp = thisp || this
  for (var walker = this[LRU_LIST].head; walker !== null;) {
    var next = walker.next
    forEachStep(this, fn, walker, thisp)
    walker = next
  }
}

LRUCache.prototype.keys = function () {
  return this[LRU_LIST].toArray().map(function (k) {
    return k.key
  }, this)
}

LRUCache.prototype.values = function () {
  return this[LRU_LIST].toArray().map(function (k) {
    return k.value
  }, this)
}

LRUCache.prototype.reset = function () {
  if (this[DISPOSE] &&
      this[LRU_LIST] &&
      this[LRU_LIST].length) {
    this[LRU_LIST].forEach(function (hit) {
      this[DISPOSE](hit.key, hit.value)
    }, this)
  }

  this[CACHE] = new Map() // hash of items by key
  this[LRU_LIST] = new Yallist() // list of items in order of use recency
  this[LENGTH] = 0 // length of items in the list
}

LRUCache.prototype.dump = function () {
  return this[LRU_LIST].map(function (hit) {
    if (!isStale(this, hit)) {
      return {
        k: hit.key,
        v: hit.value,
        e: hit.now + (hit.maxAge || 0)
      }
    }
  }, this).toArray().filter(function (h) {
    return h
  })
}

LRUCache.prototype.dumpLru = function () {
  return this[LRU_LIST]
}

LRUCache.prototype.inspect = function (n, opts) {
  var str = 'LRUCache {'
  var extras = false

  var as = this[ALLOW_STALE]
  if (as) {
    str += '\n  allowStale: true'
    extras = true
  }

  var max = this[MAX]
  if (max && max !== Infinity) {
    if (extras) {
      str += ','
    }
    str += '\n  max: ' + util.inspect(max, opts)
    extras = true
  }

  var maxAge = this[MAX_AGE]
  if (maxAge) {
    if (extras) {
      str += ','
    }
    str += '\n  maxAge: ' + util.inspect(maxAge, opts)
    extras = true
  }

  var lc = this[LENGTH_CALCULATOR]
  if (lc && lc !== naiveLength) {
    if (extras) {
      str += ','
    }
    str += '\n  length: ' + util.inspect(this[LENGTH], opts)
    extras = true
  }

  var didFirst = false
  this[LRU_LIST].forEach(function (item) {
    if (didFirst) {
      str += ',\n  '
    } else {
      if (extras) {
        str += ',\n'
      }
      didFirst = true
      str += '\n  '
    }
    var key = util.inspect(item.key).split('\n').join('\n  ')
    var val = { value: item.value }
    if (item.maxAge !== maxAge) {
      val.maxAge = item.maxAge
    }
    if (lc !== naiveLength) {
      val.length = item.length
    }
    if (isStale(this, item)) {
      val.stale = true
    }

    val = util.inspect(val, opts).split('\n').join('\n  ')
    str += key + ' => ' + val
  })

  if (didFirst || extras) {
    str += '\n'
  }
  str += '}'

  return str
}

LRUCache.prototype.set = function (key, value, maxAge) {
  maxAge = maxAge || this[MAX_AGE]

  var now = maxAge ? Date.now() : 0
  var len = this[LENGTH_CALCULATOR](value, key)

  if (this[CACHE].has(key)) {
    if (len > this[MAX]) {
      del(this, this[CACHE].get(key))
      return false
    }

    var node = this[CACHE].get(key)
    var item = node.value

    // dispose of the old one before overwriting
    // split out into 2 ifs for better coverage tracking
    if (this[DISPOSE]) {
      if (!this[NO_DISPOSE_ON_SET]) {
        this[DISPOSE](key, item.value)
      }
    }

    item.now = now
    item.maxAge = maxAge
    item.value = value
    this[LENGTH] += len - item.length
    item.length = len
    this.get(key)
    trim(this)
    return true
  }

  var hit = new Entry(key, value, len, now, maxAge)

  // oversized objects fall out of cache automatically.
  if (hit.length > this[MAX]) {
    if (this[DISPOSE]) {
      this[DISPOSE](key, value)
    }
    return false
  }

  this[LENGTH] += hit.length
  this[LRU_LIST].unshift(hit)
  this[CACHE].set(key, this[LRU_LIST].head)
  trim(this)
  return true
}

LRUCache.prototype.has = function (key) {
  if (!this[CACHE].has(key)) return false
  var hit = this[CACHE].get(key).value
  if (isStale(this, hit)) {
    return false
  }
  return true
}

LRUCache.prototype.get = function (key) {
  return get(this, key, true)
}

LRUCache.prototype.peek = function (key) {
  return get(this, key, false)
}

LRUCache.prototype.pop = function () {
  var node = this[LRU_LIST].tail
  if (!node) return null
  del(this, node)
  return node.value
}

LRUCache.prototype.del = function (key) {
  del(this, this[CACHE].get(key))
}

LRUCache.prototype.load = function (arr) {
  // reset the cache
  this.reset()

  var now = Date.now()
  // A previous serialized cache has the most recent items first
  for (var l = arr.length - 1; l >= 0; l--) {
    var hit = arr[l]
    var expiresAt = hit.e || 0
    if (expiresAt === 0) {
      // the item was created without expiration in a non aged cache
      this.set(hit.k, hit.v)
    } else {
      var maxAge = expiresAt - now
      // dont add already expired items
      if (maxAge > 0) {
        this.set(hit.k, hit.v, maxAge)
      }
    }
  }
}

LRUCache.prototype.prune = function () {
  var self = this
  this[CACHE].forEach(function (value, key) {
    get(self, key, false)
  })
}

function get (self, key, doUse) {
  var node = self[CACHE].get(key)
  if (node) {
    var hit = node.value
    if (isStale(self, hit)) {
      del(self, node)
      if (!self[ALLOW_STALE]) hit = undefined
    } else {
      if (doUse) {
        self[LRU_LIST].unshiftNode(node)
      }
    }
    if (hit) hit = hit.value
  }
  return hit
}

function isStale (self, hit) {
  if (!hit || (!hit.maxAge && !self[MAX_AGE])) {
    return false
  }
  var stale = false
  var diff = Date.now() - hit.now
  if (hit.maxAge) {
    stale = diff > hit.maxAge
  } else {
    stale = self[MAX_AGE] && (diff > self[MAX_AGE])
  }
  return stale
}

function trim (self) {
  if (self[LENGTH] > self[MAX]) {
    for (var walker = self[LRU_LIST].tail;
         self[LENGTH] > self[MAX] && walker !== null;) {
      // We know that we're about to delete this one, and also
      // what the next least recently used key will be, so just
      // go ahead and set it now.
      var prev = walker.prev
      del(self, walker)
      walker = prev
    }
  }
}

function del (self, node) {
  if (node) {
    var hit = node.value
    if (self[DISPOSE]) {
      self[DISPOSE](hit.key, hit.value)
    }
    self[LENGTH] -= hit.length
    self[CACHE].delete(hit.key)
    self[LRU_LIST].removeNode(node)
  }
}

// classy, since V8 prefers predictable objects.
function Entry (key, value, length, now, maxAge) {
  this.key = key
  this.value = value
  this.length = length
  this.now = now
  this.maxAge = maxAge || 0
}


/***/ }),
/* 30 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(process) {if (process.env.npm_package_name === 'pseudomap' &&
    process.env.npm_lifecycle_script === 'test')
  process.env.TEST_PSEUDOMAP = 'true'

if (typeof Map === 'function' && !process.env.TEST_PSEUDOMAP) {
  module.exports = Map
} else {
  module.exports = __webpack_require__(31)
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(9)))

/***/ }),
/* 31 */
/***/ (function(module, exports) {

var hasOwnProperty = Object.prototype.hasOwnProperty

module.exports = PseudoMap

function PseudoMap (set) {
  if (!(this instanceof PseudoMap)) // whyyyyyyy
    throw new TypeError("Constructor PseudoMap requires 'new'")

  this.clear()

  if (set) {
    if ((set instanceof PseudoMap) ||
        (typeof Map === 'function' && set instanceof Map))
      set.forEach(function (value, key) {
        this.set(key, value)
      }, this)
    else if (Array.isArray(set))
      set.forEach(function (kv) {
        this.set(kv[0], kv[1])
      }, this)
    else
      throw new TypeError('invalid argument')
  }
}

PseudoMap.prototype.forEach = function (fn, thisp) {
  thisp = thisp || this
  Object.keys(this._data).forEach(function (k) {
    if (k !== 'size')
      fn.call(thisp, this._data[k].value, this._data[k].key)
  }, this)
}

PseudoMap.prototype.has = function (k) {
  return !!find(this._data, k)
}

PseudoMap.prototype.get = function (k) {
  var res = find(this._data, k)
  return res && res.value
}

PseudoMap.prototype.set = function (k, v) {
  set(this._data, k, v)
}

PseudoMap.prototype.delete = function (k) {
  var res = find(this._data, k)
  if (res) {
    delete this._data[res._index]
    this._data.size--
  }
}

PseudoMap.prototype.clear = function () {
  var data = Object.create(null)
  data.size = 0

  Object.defineProperty(this, '_data', {
    value: data,
    enumerable: false,
    configurable: true,
    writable: false
  })
}

Object.defineProperty(PseudoMap.prototype, 'size', {
  get: function () {
    return this._data.size
  },
  set: function (n) {},
  enumerable: true,
  configurable: true
})

PseudoMap.prototype.values =
PseudoMap.prototype.keys =
PseudoMap.prototype.entries = function () {
  throw new Error('iterators are not implemented in this version')
}

// Either identical, or both NaN
function same (a, b) {
  return a === b || a !== a && b !== b
}

function Entry (k, v, i) {
  this.key = k
  this.value = v
  this._index = i
}

function find (data, k) {
  for (var i = 0, s = '_' + k, key = s;
       hasOwnProperty.call(data, key);
       key = s + i++) {
    if (same(data[key].key, k))
      return data[key]
  }
}

function set (data, k, v) {
  for (var i = 0, s = '_' + k, key = s;
       hasOwnProperty.call(data, key);
       key = s + i++) {
    if (same(data[key].key, k)) {
      data[key].value = v
      return
    }
  }
  data.size++
  data[key] = new Entry(k, v, key)
}


/***/ }),
/* 32 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global, process) {// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

var formatRegExp = /%[sdj%]/g;
exports.format = function(f) {
  if (!isString(f)) {
    var objects = [];
    for (var i = 0; i < arguments.length; i++) {
      objects.push(inspect(arguments[i]));
    }
    return objects.join(' ');
  }

  var i = 1;
  var args = arguments;
  var len = args.length;
  var str = String(f).replace(formatRegExp, function(x) {
    if (x === '%%') return '%';
    if (i >= len) return x;
    switch (x) {
      case '%s': return String(args[i++]);
      case '%d': return Number(args[i++]);
      case '%j':
        try {
          return JSON.stringify(args[i++]);
        } catch (_) {
          return '[Circular]';
        }
      default:
        return x;
    }
  });
  for (var x = args[i]; i < len; x = args[++i]) {
    if (isNull(x) || !isObject(x)) {
      str += ' ' + x;
    } else {
      str += ' ' + inspect(x);
    }
  }
  return str;
};


// Mark that a method should not be used.
// Returns a modified function which warns once by default.
// If --no-deprecation is set, then it is a no-op.
exports.deprecate = function(fn, msg) {
  // Allow for deprecating things in the process of starting up.
  if (isUndefined(global.process)) {
    return function() {
      return exports.deprecate(fn, msg).apply(this, arguments);
    };
  }

  if (process.noDeprecation === true) {
    return fn;
  }

  var warned = false;
  function deprecated() {
    if (!warned) {
      if (process.throwDeprecation) {
        throw new Error(msg);
      } else if (process.traceDeprecation) {
        console.trace(msg);
      } else {
        console.error(msg);
      }
      warned = true;
    }
    return fn.apply(this, arguments);
  }

  return deprecated;
};


var debugs = {};
var debugEnviron;
exports.debuglog = function(set) {
  if (isUndefined(debugEnviron))
    debugEnviron = process.env.NODE_DEBUG || '';
  set = set.toUpperCase();
  if (!debugs[set]) {
    if (new RegExp('\\b' + set + '\\b', 'i').test(debugEnviron)) {
      var pid = process.pid;
      debugs[set] = function() {
        var msg = exports.format.apply(exports, arguments);
        console.error('%s %d: %s', set, pid, msg);
      };
    } else {
      debugs[set] = function() {};
    }
  }
  return debugs[set];
};


/**
 * Echos the value of a value. Trys to print the value out
 * in the best way possible given the different types.
 *
 * @param {Object} obj The object to print out.
 * @param {Object} opts Optional options object that alters the output.
 */
/* legacy: obj, showHidden, depth, colors*/
function inspect(obj, opts) {
  // default options
  var ctx = {
    seen: [],
    stylize: stylizeNoColor
  };
  // legacy...
  if (arguments.length >= 3) ctx.depth = arguments[2];
  if (arguments.length >= 4) ctx.colors = arguments[3];
  if (isBoolean(opts)) {
    // legacy...
    ctx.showHidden = opts;
  } else if (opts) {
    // got an "options" object
    exports._extend(ctx, opts);
  }
  // set default options
  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;
  if (isUndefined(ctx.depth)) ctx.depth = 2;
  if (isUndefined(ctx.colors)) ctx.colors = false;
  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;
  if (ctx.colors) ctx.stylize = stylizeWithColor;
  return formatValue(ctx, obj, ctx.depth);
}
exports.inspect = inspect;


// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics
inspect.colors = {
  'bold' : [1, 22],
  'italic' : [3, 23],
  'underline' : [4, 24],
  'inverse' : [7, 27],
  'white' : [37, 39],
  'grey' : [90, 39],
  'black' : [30, 39],
  'blue' : [34, 39],
  'cyan' : [36, 39],
  'green' : [32, 39],
  'magenta' : [35, 39],
  'red' : [31, 39],
  'yellow' : [33, 39]
};

// Don't use 'blue' not visible on cmd.exe
inspect.styles = {
  'special': 'cyan',
  'number': 'yellow',
  'boolean': 'yellow',
  'undefined': 'grey',
  'null': 'bold',
  'string': 'green',
  'date': 'magenta',
  // "name": intentionally not styling
  'regexp': 'red'
};


function stylizeWithColor(str, styleType) {
  var style = inspect.styles[styleType];

  if (style) {
    return '\u001b[' + inspect.colors[style][0] + 'm' + str +
           '\u001b[' + inspect.colors[style][1] + 'm';
  } else {
    return str;
  }
}


function stylizeNoColor(str, styleType) {
  return str;
}


function arrayToHash(array) {
  var hash = {};

  array.forEach(function(val, idx) {
    hash[val] = true;
  });

  return hash;
}


function formatValue(ctx, value, recurseTimes) {
  // Provide a hook for user-specified inspect functions.
  // Check that value is an object with an inspect function on it
  if (ctx.customInspect &&
      value &&
      isFunction(value.inspect) &&
      // Filter out the util module, it's inspect function is special
      value.inspect !== exports.inspect &&
      // Also filter out any prototype objects using the circular check.
      !(value.constructor && value.constructor.prototype === value)) {
    var ret = value.inspect(recurseTimes, ctx);
    if (!isString(ret)) {
      ret = formatValue(ctx, ret, recurseTimes);
    }
    return ret;
  }

  // Primitive types cannot have properties
  var primitive = formatPrimitive(ctx, value);
  if (primitive) {
    return primitive;
  }

  // Look up the keys of the object.
  var keys = Object.keys(value);
  var visibleKeys = arrayToHash(keys);

  if (ctx.showHidden) {
    keys = Object.getOwnPropertyNames(value);
  }

  // IE doesn't make error fields non-enumerable
  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx
  if (isError(value)
      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {
    return formatError(value);
  }

  // Some type of object without properties can be shortcutted.
  if (keys.length === 0) {
    if (isFunction(value)) {
      var name = value.name ? ': ' + value.name : '';
      return ctx.stylize('[Function' + name + ']', 'special');
    }
    if (isRegExp(value)) {
      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');
    }
    if (isDate(value)) {
      return ctx.stylize(Date.prototype.toString.call(value), 'date');
    }
    if (isError(value)) {
      return formatError(value);
    }
  }

  var base = '', array = false, braces = ['{', '}'];

  // Make Array say that they are Array
  if (isArray(value)) {
    array = true;
    braces = ['[', ']'];
  }

  // Make functions say that they are functions
  if (isFunction(value)) {
    var n = value.name ? ': ' + value.name : '';
    base = ' [Function' + n + ']';
  }

  // Make RegExps say that they are RegExps
  if (isRegExp(value)) {
    base = ' ' + RegExp.prototype.toString.call(value);
  }

  // Make dates with properties first say the date
  if (isDate(value)) {
    base = ' ' + Date.prototype.toUTCString.call(value);
  }

  // Make error with message first say the error
  if (isError(value)) {
    base = ' ' + formatError(value);
  }

  if (keys.length === 0 && (!array || value.length == 0)) {
    return braces[0] + base + braces[1];
  }

  if (recurseTimes < 0) {
    if (isRegExp(value)) {
      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');
    } else {
      return ctx.stylize('[Object]', 'special');
    }
  }

  ctx.seen.push(value);

  var output;
  if (array) {
    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);
  } else {
    output = keys.map(function(key) {
      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);
    });
  }

  ctx.seen.pop();

  return reduceToSingleString(output, base, braces);
}


function formatPrimitive(ctx, value) {
  if (isUndefined(value))
    return ctx.stylize('undefined', 'undefined');
  if (isString(value)) {
    var simple = '\'' + JSON.stringify(value).replace(/^"|"$/g, '')
                                             .replace(/'/g, "\\'")
                                             .replace(/\\"/g, '"') + '\'';
    return ctx.stylize(simple, 'string');
  }
  if (isNumber(value))
    return ctx.stylize('' + value, 'number');
  if (isBoolean(value))
    return ctx.stylize('' + value, 'boolean');
  // For some reason typeof null is "object", so special case here.
  if (isNull(value))
    return ctx.stylize('null', 'null');
}


function formatError(value) {
  return '[' + Error.prototype.toString.call(value) + ']';
}


function formatArray(ctx, value, recurseTimes, visibleKeys, keys) {
  var output = [];
  for (var i = 0, l = value.length; i < l; ++i) {
    if (hasOwnProperty(value, String(i))) {
      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,
          String(i), true));
    } else {
      output.push('');
    }
  }
  keys.forEach(function(key) {
    if (!key.match(/^\d+$/)) {
      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,
          key, true));
    }
  });
  return output;
}


function formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {
  var name, str, desc;
  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };
  if (desc.get) {
    if (desc.set) {
      str = ctx.stylize('[Getter/Setter]', 'special');
    } else {
      str = ctx.stylize('[Getter]', 'special');
    }
  } else {
    if (desc.set) {
      str = ctx.stylize('[Setter]', 'special');
    }
  }
  if (!hasOwnProperty(visibleKeys, key)) {
    name = '[' + key + ']';
  }
  if (!str) {
    if (ctx.seen.indexOf(desc.value) < 0) {
      if (isNull(recurseTimes)) {
        str = formatValue(ctx, desc.value, null);
      } else {
        str = formatValue(ctx, desc.value, recurseTimes - 1);
      }
      if (str.indexOf('\n') > -1) {
        if (array) {
          str = str.split('\n').map(function(line) {
            return '  ' + line;
          }).join('\n').substr(2);
        } else {
          str = '\n' + str.split('\n').map(function(line) {
            return '   ' + line;
          }).join('\n');
        }
      }
    } else {
      str = ctx.stylize('[Circular]', 'special');
    }
  }
  if (isUndefined(name)) {
    if (array && key.match(/^\d+$/)) {
      return str;
    }
    name = JSON.stringify('' + key);
    if (name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)) {
      name = name.substr(1, name.length - 2);
      name = ctx.stylize(name, 'name');
    } else {
      name = name.replace(/'/g, "\\'")
                 .replace(/\\"/g, '"')
                 .replace(/(^"|"$)/g, "'");
      name = ctx.stylize(name, 'string');
    }
  }

  return name + ': ' + str;
}


function reduceToSingleString(output, base, braces) {
  var numLinesEst = 0;
  var length = output.reduce(function(prev, cur) {
    numLinesEst++;
    if (cur.indexOf('\n') >= 0) numLinesEst++;
    return prev + cur.replace(/\u001b\[\d\d?m/g, '').length + 1;
  }, 0);

  if (length > 60) {
    return braces[0] +
           (base === '' ? '' : base + '\n ') +
           ' ' +
           output.join(',\n  ') +
           ' ' +
           braces[1];
  }

  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];
}


// NOTE: These type checking functions intentionally don't use `instanceof`
// because it is fragile and can be easily faked with `Object.create()`.
function isArray(ar) {
  return Array.isArray(ar);
}
exports.isArray = isArray;

function isBoolean(arg) {
  return typeof arg === 'boolean';
}
exports.isBoolean = isBoolean;

function isNull(arg) {
  return arg === null;
}
exports.isNull = isNull;

function isNullOrUndefined(arg) {
  return arg == null;
}
exports.isNullOrUndefined = isNullOrUndefined;

function isNumber(arg) {
  return typeof arg === 'number';
}
exports.isNumber = isNumber;

function isString(arg) {
  return typeof arg === 'string';
}
exports.isString = isString;

function isSymbol(arg) {
  return typeof arg === 'symbol';
}
exports.isSymbol = isSymbol;

function isUndefined(arg) {
  return arg === void 0;
}
exports.isUndefined = isUndefined;

function isRegExp(re) {
  return isObject(re) && objectToString(re) === '[object RegExp]';
}
exports.isRegExp = isRegExp;

function isObject(arg) {
  return typeof arg === 'object' && arg !== null;
}
exports.isObject = isObject;

function isDate(d) {
  return isObject(d) && objectToString(d) === '[object Date]';
}
exports.isDate = isDate;

function isError(e) {
  return isObject(e) &&
      (objectToString(e) === '[object Error]' || e instanceof Error);
}
exports.isError = isError;

function isFunction(arg) {
  return typeof arg === 'function';
}
exports.isFunction = isFunction;

function isPrimitive(arg) {
  return arg === null ||
         typeof arg === 'boolean' ||
         typeof arg === 'number' ||
         typeof arg === 'string' ||
         typeof arg === 'symbol' ||  // ES6 symbol
         typeof arg === 'undefined';
}
exports.isPrimitive = isPrimitive;

exports.isBuffer = __webpack_require__(34);

function objectToString(o) {
  return Object.prototype.toString.call(o);
}


function pad(n) {
  return n < 10 ? '0' + n.toString(10) : n.toString(10);
}


var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',
              'Oct', 'Nov', 'Dec'];

// 26 Feb 16:19:34
function timestamp() {
  var d = new Date();
  var time = [pad(d.getHours()),
              pad(d.getMinutes()),
              pad(d.getSeconds())].join(':');
  return [d.getDate(), months[d.getMonth()], time].join(' ');
}


// log is just a thin wrapper to console.log that prepends a timestamp
exports.log = function() {
  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));
};


/**
 * Inherit the prototype methods from one constructor into another.
 *
 * The Function.prototype.inherits from lang.js rewritten as a standalone
 * function (not on Function.prototype). NOTE: If this file is to be loaded
 * during bootstrapping this function needs to be rewritten using some native
 * functions as prototype setup using normal JavaScript does not work as
 * expected during bootstrapping (see mirror.js in r114903).
 *
 * @param {function} ctor Constructor function which needs to inherit the
 *     prototype.
 * @param {function} superCtor Constructor function to inherit prototype from.
 */
exports.inherits = __webpack_require__(35);

exports._extend = function(origin, add) {
  // Don't do anything if add isn't an object
  if (!add || !isObject(add)) return origin;

  var keys = Object.keys(add);
  var i = keys.length;
  while (i--) {
    origin[keys[i]] = add[keys[i]];
  }
  return origin;
};

function hasOwnProperty(obj, prop) {
  return Object.prototype.hasOwnProperty.call(obj, prop);
}

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(33), __webpack_require__(9)))

/***/ }),
/* 33 */
/***/ (function(module, exports) {

var g;

// This works in non-strict mode
g = (function() {
	return this;
})();

try {
	// This works if eval is allowed (see CSP)
	g = g || Function("return this")() || (1,eval)("this");
} catch(e) {
	// This works if the window reference is available
	if(typeof window === "object")
		g = window;
}

// g can still be undefined, but nothing to do about it...
// We return undefined, instead of nothing here, so it's
// easier to handle this case. if(!global) { ...}

module.exports = g;


/***/ }),
/* 34 */
/***/ (function(module, exports) {

module.exports = function isBuffer(arg) {
  return arg && typeof arg === 'object'
    && typeof arg.copy === 'function'
    && typeof arg.fill === 'function'
    && typeof arg.readUInt8 === 'function';
}

/***/ }),
/* 35 */
/***/ (function(module, exports) {

if (typeof Object.create === 'function') {
  // implementation from standard node.js 'util' module
  module.exports = function inherits(ctor, superCtor) {
    ctor.super_ = superCtor
    ctor.prototype = Object.create(superCtor.prototype, {
      constructor: {
        value: ctor,
        enumerable: false,
        writable: true,
        configurable: true
      }
    });
  };
} else {
  // old school shim for old browsers
  module.exports = function inherits(ctor, superCtor) {
    ctor.super_ = superCtor
    var TempCtor = function () {}
    TempCtor.prototype = superCtor.prototype
    ctor.prototype = new TempCtor()
    ctor.prototype.constructor = ctor
  }
}


/***/ }),
/* 36 */
/***/ (function(module, exports) {

module.exports = Yallist

Yallist.Node = Node
Yallist.create = Yallist

function Yallist (list) {
  var self = this
  if (!(self instanceof Yallist)) {
    self = new Yallist()
  }

  self.tail = null
  self.head = null
  self.length = 0

  if (list && typeof list.forEach === 'function') {
    list.forEach(function (item) {
      self.push(item)
    })
  } else if (arguments.length > 0) {
    for (var i = 0, l = arguments.length; i < l; i++) {
      self.push(arguments[i])
    }
  }

  return self
}

Yallist.prototype.removeNode = function (node) {
  if (node.list !== this) {
    throw new Error('removing node which does not belong to this list')
  }

  var next = node.next
  var prev = node.prev

  if (next) {
    next.prev = prev
  }

  if (prev) {
    prev.next = next
  }

  if (node === this.head) {
    this.head = next
  }
  if (node === this.tail) {
    this.tail = prev
  }

  node.list.length--
  node.next = null
  node.prev = null
  node.list = null
}

Yallist.prototype.unshiftNode = function (node) {
  if (node === this.head) {
    return
  }

  if (node.list) {
    node.list.removeNode(node)
  }

  var head = this.head
  node.list = this
  node.next = head
  if (head) {
    head.prev = node
  }

  this.head = node
  if (!this.tail) {
    this.tail = node
  }
  this.length++
}

Yallist.prototype.pushNode = function (node) {
  if (node === this.tail) {
    return
  }

  if (node.list) {
    node.list.removeNode(node)
  }

  var tail = this.tail
  node.list = this
  node.prev = tail
  if (tail) {
    tail.next = node
  }

  this.tail = node
  if (!this.head) {
    this.head = node
  }
  this.length++
}

Yallist.prototype.push = function () {
  for (var i = 0, l = arguments.length; i < l; i++) {
    push(this, arguments[i])
  }
  return this.length
}

Yallist.prototype.unshift = function () {
  for (var i = 0, l = arguments.length; i < l; i++) {
    unshift(this, arguments[i])
  }
  return this.length
}

Yallist.prototype.pop = function () {
  if (!this.tail) {
    return undefined
  }

  var res = this.tail.value
  this.tail = this.tail.prev
  if (this.tail) {
    this.tail.next = null
  } else {
    this.head = null
  }
  this.length--
  return res
}

Yallist.prototype.shift = function () {
  if (!this.head) {
    return undefined
  }

  var res = this.head.value
  this.head = this.head.next
  if (this.head) {
    this.head.prev = null
  } else {
    this.tail = null
  }
  this.length--
  return res
}

Yallist.prototype.forEach = function (fn, thisp) {
  thisp = thisp || this
  for (var walker = this.head, i = 0; walker !== null; i++) {
    fn.call(thisp, walker.value, i, this)
    walker = walker.next
  }
}

Yallist.prototype.forEachReverse = function (fn, thisp) {
  thisp = thisp || this
  for (var walker = this.tail, i = this.length - 1; walker !== null; i--) {
    fn.call(thisp, walker.value, i, this)
    walker = walker.prev
  }
}

Yallist.prototype.get = function (n) {
  for (var i = 0, walker = this.head; walker !== null && i < n; i++) {
    // abort out of the list early if we hit a cycle
    walker = walker.next
  }
  if (i === n && walker !== null) {
    return walker.value
  }
}

Yallist.prototype.getReverse = function (n) {
  for (var i = 0, walker = this.tail; walker !== null && i < n; i++) {
    // abort out of the list early if we hit a cycle
    walker = walker.prev
  }
  if (i === n && walker !== null) {
    return walker.value
  }
}

Yallist.prototype.map = function (fn, thisp) {
  thisp = thisp || this
  var res = new Yallist()
  for (var walker = this.head; walker !== null;) {
    res.push(fn.call(thisp, walker.value, this))
    walker = walker.next
  }
  return res
}

Yallist.prototype.mapReverse = function (fn, thisp) {
  thisp = thisp || this
  var res = new Yallist()
  for (var walker = this.tail; walker !== null;) {
    res.push(fn.call(thisp, walker.value, this))
    walker = walker.prev
  }
  return res
}

Yallist.prototype.reduce = function (fn, initial) {
  var acc
  var walker = this.head
  if (arguments.length > 1) {
    acc = initial
  } else if (this.head) {
    walker = this.head.next
    acc = this.head.value
  } else {
    throw new TypeError('Reduce of empty list with no initial value')
  }

  for (var i = 0; walker !== null; i++) {
    acc = fn(acc, walker.value, i)
    walker = walker.next
  }

  return acc
}

Yallist.prototype.reduceReverse = function (fn, initial) {
  var acc
  var walker = this.tail
  if (arguments.length > 1) {
    acc = initial
  } else if (this.tail) {
    walker = this.tail.prev
    acc = this.tail.value
  } else {
    throw new TypeError('Reduce of empty list with no initial value')
  }

  for (var i = this.length - 1; walker !== null; i--) {
    acc = fn(acc, walker.value, i)
    walker = walker.prev
  }

  return acc
}

Yallist.prototype.toArray = function () {
  var arr = new Array(this.length)
  for (var i = 0, walker = this.head; walker !== null; i++) {
    arr[i] = walker.value
    walker = walker.next
  }
  return arr
}

Yallist.prototype.toArrayReverse = function () {
  var arr = new Array(this.length)
  for (var i = 0, walker = this.tail; walker !== null; i++) {
    arr[i] = walker.value
    walker = walker.prev
  }
  return arr
}

Yallist.prototype.slice = function (from, to) {
  to = to || this.length
  if (to < 0) {
    to += this.length
  }
  from = from || 0
  if (from < 0) {
    from += this.length
  }
  var ret = new Yallist()
  if (to < from || to < 0) {
    return ret
  }
  if (from < 0) {
    from = 0
  }
  if (to > this.length) {
    to = this.length
  }
  for (var i = 0, walker = this.head; walker !== null && i < from; i++) {
    walker = walker.next
  }
  for (; walker !== null && i < to; i++, walker = walker.next) {
    ret.push(walker.value)
  }
  return ret
}

Yallist.prototype.sliceReverse = function (from, to) {
  to = to || this.length
  if (to < 0) {
    to += this.length
  }
  from = from || 0
  if (from < 0) {
    from += this.length
  }
  var ret = new Yallist()
  if (to < from || to < 0) {
    return ret
  }
  if (from < 0) {
    from = 0
  }
  if (to > this.length) {
    to = this.length
  }
  for (var i = this.length, walker = this.tail; walker !== null && i > to; i--) {
    walker = walker.prev
  }
  for (; walker !== null && i > from; i--, walker = walker.prev) {
    ret.push(walker.value)
  }
  return ret
}

Yallist.prototype.reverse = function () {
  var head = this.head
  var tail = this.tail
  for (var walker = head; walker !== null; walker = walker.prev) {
    var p = walker.prev
    walker.prev = walker.next
    walker.next = p
  }
  this.head = tail
  this.tail = head
  return this
}

function push (self, item) {
  self.tail = new Node(item, self.tail, null, self)
  if (!self.head) {
    self.head = self.tail
  }
  self.length++
}

function unshift (self, item) {
  self.head = new Node(item, null, self.head, self)
  if (!self.tail) {
    self.tail = self.head
  }
  self.length++
}

function Node (value, prev, next, list) {
  if (!(this instanceof Node)) {
    return new Node(value, prev, next, list)
  }

  this.list = list
  this.value = value

  if (prev) {
    prev.next = this
    this.prev = prev
  } else {
    this.prev = null
  }

  if (next) {
    next.prev = this
    this.next = next
  } else {
    this.next = null
  }
}


/***/ }),
/* 37 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_37__;

/***/ }),
/* 38 */
/***/ (function(module, exports, __webpack_require__) {

/*!
 * Fuse.js v3.2.0 - Lightweight fuzzy-search (http://fusejs.io)
 * 
 * Copyright (c) 2012-2017 Kirollos Risk (http://kiro.me)
 * All Rights Reserved. Apache Software License 2.0
 * 
 * http://www.apache.org/licenses/LICENSE-2.0
 */
(function webpackUniversalModuleDefinition(root, factory) {
	if(true)
		module.exports = factory();
	else if(typeof define === 'function' && define.amd)
		define("Fuse", [], factory);
	else if(typeof exports === 'object')
		exports["Fuse"] = factory();
	else
		root["Fuse"] = factory();
})(this, function() {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// identity function for calling harmony imports with the correct context
/******/ 	__webpack_require__.i = function(value) { return value; };
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 8);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function (obj) {
  return Object.prototype.toString.call(obj) === '[object Array]';
};

/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var bitapRegexSearch = __webpack_require__(5);
var bitapSearch = __webpack_require__(7);
var patternAlphabet = __webpack_require__(4);

var Bitap = function () {
  function Bitap(pattern, _ref) {
    var _ref$location = _ref.location,
        location = _ref$location === undefined ? 0 : _ref$location,
        _ref$distance = _ref.distance,
        distance = _ref$distance === undefined ? 100 : _ref$distance,
        _ref$threshold = _ref.threshold,
        threshold = _ref$threshold === undefined ? 0.6 : _ref$threshold,
        _ref$maxPatternLength = _ref.maxPatternLength,
        maxPatternLength = _ref$maxPatternLength === undefined ? 32 : _ref$maxPatternLength,
        _ref$isCaseSensitive = _ref.isCaseSensitive,
        isCaseSensitive = _ref$isCaseSensitive === undefined ? false : _ref$isCaseSensitive,
        _ref$tokenSeparator = _ref.tokenSeparator,
        tokenSeparator = _ref$tokenSeparator === undefined ? / +/g : _ref$tokenSeparator,
        _ref$findAllMatches = _ref.findAllMatches,
        findAllMatches = _ref$findAllMatches === undefined ? false : _ref$findAllMatches,
        _ref$minMatchCharLeng = _ref.minMatchCharLength,
        minMatchCharLength = _ref$minMatchCharLeng === undefined ? 1 : _ref$minMatchCharLeng;

    _classCallCheck(this, Bitap);

    this.options = {
      location: location,
      distance: distance,
      threshold: threshold,
      maxPatternLength: maxPatternLength,
      isCaseSensitive: isCaseSensitive,
      tokenSeparator: tokenSeparator,
      findAllMatches: findAllMatches,
      minMatchCharLength: minMatchCharLength
    };

    this.pattern = this.options.isCaseSensitive ? pattern : pattern.toLowerCase();

    if (this.pattern.length <= maxPatternLength) {
      this.patternAlphabet = patternAlphabet(this.pattern);
    }
  }

  _createClass(Bitap, [{
    key: 'search',
    value: function search(text) {
      if (!this.options.isCaseSensitive) {
        text = text.toLowerCase();
      }

      // Exact match
      if (this.pattern === text) {
        return {
          isMatch: true,
          score: 0,
          matchedIndices: [[0, text.length - 1]]
        };
      }

      // When pattern length is greater than the machine word length, just do a a regex comparison
      var _options = this.options,
          maxPatternLength = _options.maxPatternLength,
          tokenSeparator = _options.tokenSeparator;

      if (this.pattern.length > maxPatternLength) {
        return bitapRegexSearch(text, this.pattern, tokenSeparator);
      }

      // Otherwise, use Bitap algorithm
      var _options2 = this.options,
          location = _options2.location,
          distance = _options2.distance,
          threshold = _options2.threshold,
          findAllMatches = _options2.findAllMatches,
          minMatchCharLength = _options2.minMatchCharLength;

      return bitapSearch(text, this.pattern, this.patternAlphabet, {
        location: location,
        distance: distance,
        threshold: threshold,
        findAllMatches: findAllMatches,
        minMatchCharLength: minMatchCharLength
      });
    }
  }]);

  return Bitap;
}();

// let x = new Bitap("od mn war", {})
// let result = x.search("Old Man's War")
// console.log(result)

module.exports = Bitap;

/***/ }),
/* 2 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var isArray = __webpack_require__(0);

var deepValue = function deepValue(obj, path, list) {
  if (!path) {
    // If there's no path left, we've gotten to the object we care about.
    list.push(obj);
  } else {
    var dotIndex = path.indexOf('.');
    var firstSegment = path;
    var remaining = null;

    if (dotIndex !== -1) {
      firstSegment = path.slice(0, dotIndex);
      remaining = path.slice(dotIndex + 1);
    }

    var value = obj[firstSegment];

    if (value !== null && value !== undefined) {
      if (!remaining && (typeof value === 'string' || typeof value === 'number')) {
        list.push(value.toString());
      } else if (isArray(value)) {
        // Search each item in the array.
        for (var i = 0, len = value.length; i < len; i += 1) {
          deepValue(value[i], remaining, list);
        }
      } else if (remaining) {
        // An object. Recurse further.
        deepValue(value, remaining, list);
      }
    }
  }

  return list;
};

module.exports = function (obj, path) {
  return deepValue(obj, path, []);
};

/***/ }),
/* 3 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function () {
  var matchmask = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  var minMatchCharLength = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;

  var matchedIndices = [];
  var start = -1;
  var end = -1;
  var i = 0;

  for (var len = matchmask.length; i < len; i += 1) {
    var match = matchmask[i];
    if (match && start === -1) {
      start = i;
    } else if (!match && start !== -1) {
      end = i - 1;
      if (end - start + 1 >= minMatchCharLength) {
        matchedIndices.push([start, end]);
      }
      start = -1;
    }
  }

  // (i-1 - start) + 1 => i - start
  if (matchmask[i - 1] && i - start >= minMatchCharLength) {
    matchedIndices.push([start, i - 1]);
  }

  return matchedIndices;
};

/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function (pattern) {
  var mask = {};
  var len = pattern.length;

  for (var i = 0; i < len; i += 1) {
    mask[pattern.charAt(i)] = 0;
  }

  for (var _i = 0; _i < len; _i += 1) {
    mask[pattern.charAt(_i)] |= 1 << len - _i - 1;
  }

  return mask;
};

/***/ }),
/* 5 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var SPECIAL_CHARS_REGEX = /[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;

module.exports = function (text, pattern) {
  var tokenSeparator = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : / +/g;

  var regex = new RegExp(pattern.replace(SPECIAL_CHARS_REGEX, '\\$&').replace(tokenSeparator, '|'));
  var matches = text.match(regex);
  var isMatch = !!matches;
  var matchedIndices = [];

  if (isMatch) {
    for (var i = 0, matchesLen = matches.length; i < matchesLen; i += 1) {
      var match = matches[i];
      matchedIndices.push([text.indexOf(match), match.length - 1]);
    }
  }

  return {
    // TODO: revisit this score
    score: isMatch ? 0.5 : 1,
    isMatch: isMatch,
    matchedIndices: matchedIndices
  };
};

/***/ }),
/* 6 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function (pattern, _ref) {
  var _ref$errors = _ref.errors,
      errors = _ref$errors === undefined ? 0 : _ref$errors,
      _ref$currentLocation = _ref.currentLocation,
      currentLocation = _ref$currentLocation === undefined ? 0 : _ref$currentLocation,
      _ref$expectedLocation = _ref.expectedLocation,
      expectedLocation = _ref$expectedLocation === undefined ? 0 : _ref$expectedLocation,
      _ref$distance = _ref.distance,
      distance = _ref$distance === undefined ? 100 : _ref$distance;

  var accuracy = errors / pattern.length;
  var proximity = Math.abs(expectedLocation - currentLocation);

  if (!distance) {
    // Dodge divide by zero error.
    return proximity ? 1.0 : accuracy;
  }

  return accuracy + proximity / distance;
};

/***/ }),
/* 7 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var bitapScore = __webpack_require__(6);
var matchedIndices = __webpack_require__(3);

module.exports = function (text, pattern, patternAlphabet, _ref) {
  var _ref$location = _ref.location,
      location = _ref$location === undefined ? 0 : _ref$location,
      _ref$distance = _ref.distance,
      distance = _ref$distance === undefined ? 100 : _ref$distance,
      _ref$threshold = _ref.threshold,
      threshold = _ref$threshold === undefined ? 0.6 : _ref$threshold,
      _ref$findAllMatches = _ref.findAllMatches,
      findAllMatches = _ref$findAllMatches === undefined ? false : _ref$findAllMatches,
      _ref$minMatchCharLeng = _ref.minMatchCharLength,
      minMatchCharLength = _ref$minMatchCharLeng === undefined ? 1 : _ref$minMatchCharLeng;

  var expectedLocation = location;
  // Set starting location at beginning text and initialize the alphabet.
  var textLen = text.length;
  // Highest score beyond which we give up.
  var currentThreshold = threshold;
  // Is there a nearby exact match? (speedup)
  var bestLocation = text.indexOf(pattern, expectedLocation);

  var patternLen = pattern.length;

  // a mask of the matches
  var matchMask = [];
  for (var i = 0; i < textLen; i += 1) {
    matchMask[i] = 0;
  }

  if (bestLocation !== -1) {
    var score = bitapScore(pattern, {
      errors: 0,
      currentLocation: bestLocation,
      expectedLocation: expectedLocation,
      distance: distance
    });
    currentThreshold = Math.min(score, currentThreshold);

    // What about in the other direction? (speed up)
    bestLocation = text.lastIndexOf(pattern, expectedLocation + patternLen);

    if (bestLocation !== -1) {
      var _score = bitapScore(pattern, {
        errors: 0,
        currentLocation: bestLocation,
        expectedLocation: expectedLocation,
        distance: distance
      });
      currentThreshold = Math.min(_score, currentThreshold);
    }
  }

  // Reset the best location
  bestLocation = -1;

  var lastBitArr = [];
  var finalScore = 1;
  var binMax = patternLen + textLen;

  var mask = 1 << patternLen - 1;

  for (var _i = 0; _i < patternLen; _i += 1) {
    // Scan for the best match; each iteration allows for one more error.
    // Run a binary search to determine how far from the match location we can stray
    // at this error level.
    var binMin = 0;
    var binMid = binMax;

    while (binMin < binMid) {
      var _score3 = bitapScore(pattern, {
        errors: _i,
        currentLocation: expectedLocation + binMid,
        expectedLocation: expectedLocation,
        distance: distance
      });

      if (_score3 <= currentThreshold) {
        binMin = binMid;
      } else {
        binMax = binMid;
      }

      binMid = Math.floor((binMax - binMin) / 2 + binMin);
    }

    // Use the result from this iteration as the maximum for the next.
    binMax = binMid;

    var start = Math.max(1, expectedLocation - binMid + 1);
    var finish = findAllMatches ? textLen : Math.min(expectedLocation + binMid, textLen) + patternLen;

    // Initialize the bit array
    var bitArr = Array(finish + 2);

    bitArr[finish + 1] = (1 << _i) - 1;

    for (var j = finish; j >= start; j -= 1) {
      var currentLocation = j - 1;
      var charMatch = patternAlphabet[text.charAt(currentLocation)];

      if (charMatch) {
        matchMask[currentLocation] = 1;
      }

      // First pass: exact match
      bitArr[j] = (bitArr[j + 1] << 1 | 1) & charMatch;

      // Subsequent passes: fuzzy match
      if (_i !== 0) {
        bitArr[j] |= (lastBitArr[j + 1] | lastBitArr[j]) << 1 | 1 | lastBitArr[j + 1];
      }

      if (bitArr[j] & mask) {
        finalScore = bitapScore(pattern, {
          errors: _i,
          currentLocation: currentLocation,
          expectedLocation: expectedLocation,
          distance: distance
        });

        // This match will almost certainly be better than any existing match.
        // But check anyway.
        if (finalScore <= currentThreshold) {
          // Indeed it is
          currentThreshold = finalScore;
          bestLocation = currentLocation;

          // Already passed `loc`, downhill from here on in.
          if (bestLocation <= expectedLocation) {
            break;
          }

          // When passing `bestLocation`, don't exceed our current distance from `expectedLocation`.
          start = Math.max(1, 2 * expectedLocation - bestLocation);
        }
      }
    }

    // No hope for a (better) match at greater error levels.
    var _score2 = bitapScore(pattern, {
      errors: _i + 1,
      currentLocation: expectedLocation,
      expectedLocation: expectedLocation,
      distance: distance
    });

    if (_score2 > currentThreshold) {
      break;
    }

    lastBitArr = bitArr;
  }

  // Count exact matches (those with a score of 0) to be "almost" exact
  return {
    isMatch: bestLocation >= 0,
    score: finalScore === 0 ? 0.001 : finalScore,
    matchedIndices: matchedIndices(matchMask, minMatchCharLength)
  };
};

/***/ }),
/* 8 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Bitap = __webpack_require__(1);
var deepValue = __webpack_require__(2);
var isArray = __webpack_require__(0);

var Fuse = function () {
  function Fuse(list, _ref) {
    var _ref$location = _ref.location,
        location = _ref$location === undefined ? 0 : _ref$location,
        _ref$distance = _ref.distance,
        distance = _ref$distance === undefined ? 100 : _ref$distance,
        _ref$threshold = _ref.threshold,
        threshold = _ref$threshold === undefined ? 0.6 : _ref$threshold,
        _ref$maxPatternLength = _ref.maxPatternLength,
        maxPatternLength = _ref$maxPatternLength === undefined ? 32 : _ref$maxPatternLength,
        _ref$caseSensitive = _ref.caseSensitive,
        caseSensitive = _ref$caseSensitive === undefined ? false : _ref$caseSensitive,
        _ref$tokenSeparator = _ref.tokenSeparator,
        tokenSeparator = _ref$tokenSeparator === undefined ? / +/g : _ref$tokenSeparator,
        _ref$findAllMatches = _ref.findAllMatches,
        findAllMatches = _ref$findAllMatches === undefined ? false : _ref$findAllMatches,
        _ref$minMatchCharLeng = _ref.minMatchCharLength,
        minMatchCharLength = _ref$minMatchCharLeng === undefined ? 1 : _ref$minMatchCharLeng,
        _ref$id = _ref.id,
        id = _ref$id === undefined ? null : _ref$id,
        _ref$keys = _ref.keys,
        keys = _ref$keys === undefined ? [] : _ref$keys,
        _ref$shouldSort = _ref.shouldSort,
        shouldSort = _ref$shouldSort === undefined ? true : _ref$shouldSort,
        _ref$getFn = _ref.getFn,
        getFn = _ref$getFn === undefined ? deepValue : _ref$getFn,
        _ref$sortFn = _ref.sortFn,
        sortFn = _ref$sortFn === undefined ? function (a, b) {
      return a.score - b.score;
    } : _ref$sortFn,
        _ref$tokenize = _ref.tokenize,
        tokenize = _ref$tokenize === undefined ? false : _ref$tokenize,
        _ref$matchAllTokens = _ref.matchAllTokens,
        matchAllTokens = _ref$matchAllTokens === undefined ? false : _ref$matchAllTokens,
        _ref$includeMatches = _ref.includeMatches,
        includeMatches = _ref$includeMatches === undefined ? false : _ref$includeMatches,
        _ref$includeScore = _ref.includeScore,
        includeScore = _ref$includeScore === undefined ? false : _ref$includeScore,
        _ref$verbose = _ref.verbose,
        verbose = _ref$verbose === undefined ? false : _ref$verbose;

    _classCallCheck(this, Fuse);

    this.options = {
      location: location,
      distance: distance,
      threshold: threshold,
      maxPatternLength: maxPatternLength,
      isCaseSensitive: caseSensitive,
      tokenSeparator: tokenSeparator,
      findAllMatches: findAllMatches,
      minMatchCharLength: minMatchCharLength,
      id: id,
      keys: keys,
      includeMatches: includeMatches,
      includeScore: includeScore,
      shouldSort: shouldSort,
      getFn: getFn,
      sortFn: sortFn,
      verbose: verbose,
      tokenize: tokenize,
      matchAllTokens: matchAllTokens
    };

    this.setCollection(list);
  }

  _createClass(Fuse, [{
    key: 'setCollection',
    value: function setCollection(list) {
      this.list = list;
      return list;
    }
  }, {
    key: 'search',
    value: function search(pattern) {
      this._log('---------\nSearch pattern: "' + pattern + '"');

      var _prepareSearchers2 = this._prepareSearchers(pattern),
          tokenSearchers = _prepareSearchers2.tokenSearchers,
          fullSearcher = _prepareSearchers2.fullSearcher;

      var _search2 = this._search(tokenSearchers, fullSearcher),
          weights = _search2.weights,
          results = _search2.results;

      this._computeScore(weights, results);

      if (this.options.shouldSort) {
        this._sort(results);
      }

      return this._format(results);
    }
  }, {
    key: '_prepareSearchers',
    value: function _prepareSearchers() {
      var pattern = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';

      var tokenSearchers = [];

      if (this.options.tokenize) {
        // Tokenize on the separator
        var tokens = pattern.split(this.options.tokenSeparator);
        for (var i = 0, len = tokens.length; i < len; i += 1) {
          tokenSearchers.push(new Bitap(tokens[i], this.options));
        }
      }

      var fullSearcher = new Bitap(pattern, this.options);

      return { tokenSearchers: tokenSearchers, fullSearcher: fullSearcher };
    }
  }, {
    key: '_search',
    value: function _search() {
      var tokenSearchers = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
      var fullSearcher = arguments[1];

      var list = this.list;
      var resultMap = {};
      var results = [];

      // Check the first item in the list, if it's a string, then we assume
      // that every item in the list is also a string, and thus it's a flattened array.
      if (typeof list[0] === 'string') {
        // Iterate over every item
        for (var i = 0, len = list.length; i < len; i += 1) {
          this._analyze({
            key: '',
            value: list[i],
            record: i,
            index: i
          }, {
            resultMap: resultMap,
            results: results,
            tokenSearchers: tokenSearchers,
            fullSearcher: fullSearcher
          });
        }

        return { weights: null, results: results };
      }

      // Otherwise, the first item is an Object (hopefully), and thus the searching
      // is done on the values of the keys of each item.
      var weights = {};
      for (var _i = 0, _len = list.length; _i < _len; _i += 1) {
        var item = list[_i];
        // Iterate over every key
        for (var j = 0, keysLen = this.options.keys.length; j < keysLen; j += 1) {
          var key = this.options.keys[j];
          if (typeof key !== 'string') {
            weights[key.name] = {
              weight: 1 - key.weight || 1
            };
            if (key.weight <= 0 || key.weight > 1) {
              throw new Error('Key weight has to be > 0 and <= 1');
            }
            key = key.name;
          } else {
            weights[key] = {
              weight: 1
            };
          }

          this._analyze({
            key: key,
            value: this.options.getFn(item, key),
            record: item,
            index: _i
          }, {
            resultMap: resultMap,
            results: results,
            tokenSearchers: tokenSearchers,
            fullSearcher: fullSearcher
          });
        }
      }

      return { weights: weights, results: results };
    }
  }, {
    key: '_analyze',
    value: function _analyze(_ref2, _ref3) {
      var key = _ref2.key,
          _ref2$arrayIndex = _ref2.arrayIndex,
          arrayIndex = _ref2$arrayIndex === undefined ? -1 : _ref2$arrayIndex,
          value = _ref2.value,
          record = _ref2.record,
          index = _ref2.index;
      var _ref3$tokenSearchers = _ref3.tokenSearchers,
          tokenSearchers = _ref3$tokenSearchers === undefined ? [] : _ref3$tokenSearchers,
          _ref3$fullSearcher = _ref3.fullSearcher,
          fullSearcher = _ref3$fullSearcher === undefined ? [] : _ref3$fullSearcher,
          _ref3$resultMap = _ref3.resultMap,
          resultMap = _ref3$resultMap === undefined ? {} : _ref3$resultMap,
          _ref3$results = _ref3.results,
          results = _ref3$results === undefined ? [] : _ref3$results;

      // Check if the texvaluet can be searched
      if (value === undefined || value === null) {
        return;
      }

      var exists = false;
      var averageScore = -1;
      var numTextMatches = 0;

      if (typeof value === 'string') {
        this._log('\nKey: ' + (key === '' ? '-' : key));

        var mainSearchResult = fullSearcher.search(value);
        this._log('Full text: "' + value + '", score: ' + mainSearchResult.score);

        if (this.options.tokenize) {
          var words = value.split(this.options.tokenSeparator);
          var scores = [];

          for (var i = 0; i < tokenSearchers.length; i += 1) {
            var tokenSearcher = tokenSearchers[i];

            this._log('\nPattern: "' + tokenSearcher.pattern + '"');

            // let tokenScores = []
            var hasMatchInText = false;

            for (var j = 0; j < words.length; j += 1) {
              var word = words[j];
              var tokenSearchResult = tokenSearcher.search(word);
              var obj = {};
              if (tokenSearchResult.isMatch) {
                obj[word] = tokenSearchResult.score;
                exists = true;
                hasMatchInText = true;
                scores.push(tokenSearchResult.score);
              } else {
                obj[word] = 1;
                if (!this.options.matchAllTokens) {
                  scores.push(1);
                }
              }
              this._log('Token: "' + word + '", score: ' + obj[word]);
              // tokenScores.push(obj)
            }

            if (hasMatchInText) {
              numTextMatches += 1;
            }
          }

          averageScore = scores[0];
          var scoresLen = scores.length;
          for (var _i2 = 1; _i2 < scoresLen; _i2 += 1) {
            averageScore += scores[_i2];
          }
          averageScore = averageScore / scoresLen;

          this._log('Token score average:', averageScore);
        }

        var finalScore = mainSearchResult.score;
        if (averageScore > -1) {
          finalScore = (finalScore + averageScore) / 2;
        }

        this._log('Score average:', finalScore);

        var checkTextMatches = this.options.tokenize && this.options.matchAllTokens ? numTextMatches >= tokenSearchers.length : true;

        this._log('\nCheck Matches: ' + checkTextMatches);

        // If a match is found, add the item to <rawResults>, including its score
        if ((exists || mainSearchResult.isMatch) && checkTextMatches) {
          // Check if the item already exists in our results
          var existingResult = resultMap[index];
          if (existingResult) {
            // Use the lowest score
            // existingResult.score, bitapResult.score
            existingResult.output.push({
              key: key,
              arrayIndex: arrayIndex,
              value: value,
              score: finalScore,
              matchedIndices: mainSearchResult.matchedIndices
            });
          } else {
            // Add it to the raw result list
            resultMap[index] = {
              item: record,
              output: [{
                key: key,
                arrayIndex: arrayIndex,
                value: value,
                score: finalScore,
                matchedIndices: mainSearchResult.matchedIndices
              }]
            };

            results.push(resultMap[index]);
          }
        }
      } else if (isArray(value)) {
        for (var _i3 = 0, len = value.length; _i3 < len; _i3 += 1) {
          this._analyze({
            key: key,
            arrayIndex: _i3,
            value: value[_i3],
            record: record,
            index: index
          }, {
            resultMap: resultMap,
            results: results,
            tokenSearchers: tokenSearchers,
            fullSearcher: fullSearcher
          });
        }
      }
    }
  }, {
    key: '_computeScore',
    value: function _computeScore(weights, results) {
      this._log('\n\nComputing score:\n');

      for (var i = 0, len = results.length; i < len; i += 1) {
        var output = results[i].output;
        var scoreLen = output.length;

        var totalScore = 0;
        var bestScore = 1;

        for (var j = 0; j < scoreLen; j += 1) {
          var weight = weights ? weights[output[j].key].weight : 1;
          var score = weight === 1 ? output[j].score : output[j].score || 0.001;
          var nScore = score * weight;

          if (weight !== 1) {
            bestScore = Math.min(bestScore, nScore);
          } else {
            output[j].nScore = nScore;
            totalScore += nScore;
          }
        }

        results[i].score = bestScore === 1 ? totalScore / scoreLen : bestScore;

        this._log(results[i]);
      }
    }
  }, {
    key: '_sort',
    value: function _sort(results) {
      this._log('\n\nSorting....');
      results.sort(this.options.sortFn);
    }
  }, {
    key: '_format',
    value: function _format(results) {
      var finalOutput = [];

      this._log('\n\nOutput:\n\n', JSON.stringify(results));

      var transformers = [];

      if (this.options.includeMatches) {
        transformers.push(function (result, data) {
          var output = result.output;
          data.matches = [];

          for (var i = 0, len = output.length; i < len; i += 1) {
            var item = output[i];

            if (item.matchedIndices.length === 0) {
              continue;
            }

            var obj = {
              indices: item.matchedIndices,
              value: item.value
            };
            if (item.key) {
              obj.key = item.key;
            }
            if (item.hasOwnProperty('arrayIndex') && item.arrayIndex > -1) {
              obj.arrayIndex = item.arrayIndex;
            }
            data.matches.push(obj);
          }
        });
      }

      if (this.options.includeScore) {
        transformers.push(function (result, data) {
          data.score = result.score;
        });
      }

      for (var i = 0, len = results.length; i < len; i += 1) {
        var result = results[i];

        if (this.options.id) {
          result.item = this.options.getFn(result.item, this.options.id)[0];
        }

        if (!transformers.length) {
          finalOutput.push(result.item);
          continue;
        }

        var data = {
          item: result.item
        };

        for (var j = 0, _len2 = transformers.length; j < _len2; j += 1) {
          transformers[j](result, data);
        }

        finalOutput.push(data);
      }

      return finalOutput;
    }
  }, {
    key: '_log',
    value: function _log() {
      if (this.options.verbose) {
        var _console;

        (_console = console).log.apply(_console, arguments);
      }
    }
  }]);

  return Fuse;
}();

module.exports = Fuse;

/***/ })
/******/ ]);
});
//# sourceMappingURL=fuse.js.map

/***/ }),
/* 39 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    "use strict";

    /**
     * Stores user search results for the server-users-supplier
     */
    // TODO CONFSRVDEV-2015 - shouldn't store the same User object more than once. Should only store lists of keys in the query map,
    // and then have a separate cross-supplier Map of User objects by key. dT
    var cache = {};
    var queries = [];

    exports.default = function (limit) {
        return {
            add: function add(query, users) {
                cache[query] = {
                    query: query,
                    users: users,
                    isExhausted: users.length < limit
                };

                // Queries list is alph sorted descending so that longer queries are above the shorter queries that
                // they contain.
                queries.push(query);
                queries.sort();
                queries.reverse();
            },

            /**
             * Look in the cache for this query or a shorter one.
             */
            getClosest: function getClosest(query) {
                if (cache[query]) {
                    return cache[query];
                }

                // Else find the longest matching substring of the query.
                // The query list is sorted, so the first item found should be the longest one.
                var queryMatch = queries.find(function (subquery) {
                    return query.indexOf(subquery) === 0;
                });
                if (queryMatch) {
                    return cache[queryMatch];
                }

                return null; // just to make this obvious...
            },

            // Used in tests.
            reset: function reset() {
                cache = {};
                queries = [];
            }
        };
    };

    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 40 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    "use strict";

    function escape(query) {
        return [].map.call(query, function escapeSpecialCharacter(char) {
            if (char === '+' || char === '-' || char === '&' || char === '|' || char === '!' || char === '(' || char === ')' || char === '{' || char === '}' || char === '[' || char === ']' || char === '^' || char === '"' || char === '~' || char === '*' || char === '?' || char === ':' || char === '\\') return '\\' + char;
            return char;
        }).join('');
    }

    exports.default = {
        escape: escape
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 41 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(2), __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _meta, _userSupplierKeys) {
    'use strict';

    var Meta = _interopRequireDefault(_meta).default;

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    function getCurrentUser() {
        return new Promise(function (resolve) {

            var username = Meta.get('remote-user');
            if (!username) {
                // Anonymous user.
                return resolve();
            }

            var userKey = Meta.get('remote-user-key');
            var displayName = Meta.get('current-user-fullname');
            var path = Meta.get('current-user-avatar-uri-reference');

            resolve({
                type: "known",
                username: username,
                userKey: userKey,
                profilePicture: {
                    path: path,
                    width: 48,
                    height: 48
                },
                displayName: displayName,
                supplier: UserSupplier.CURRENT
            });
        });
    }

    exports.default = {
        getCurrentUser: getCurrentUser
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 42 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(16), __webpack_require__(43), __webpack_require__(12), __webpack_require__(44), __webpack_require__(15), __webpack_require__(46), __webpack_require__(47), __webpack_require__(48), __webpack_require__(17)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _templates, _resultPlaceholder, _userRanker, _userConverter, _utils, _defaultOrdering, _scoreLogger, _defaultFiltering, _scoreBooster) {
    'use strict';

    var Templates = _interopRequireDefault(_templates).default;

    var ResultPlaceholder = _interopRequireDefault(_resultPlaceholder).default;

    var SearchUsers = _interopRequireDefault(_userRanker).default;

    var ConvertUsers = _interopRequireDefault(_userConverter).default;

    var RenderUtils = _interopRequireDefault(_utils).default;

    var ensureDefaultOrder = _interopRequireDefault(_defaultOrdering).default;

    var scoreLogger = _interopRequireDefault(_scoreLogger).default;

    var filterServerResults = _interopRequireDefault(_defaultFiltering).default;

    var ScoreBooster = _interopRequireDefault(_scoreBooster).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict"; /**
                   * The contents of the UserCache is passed through the user pipeline which filters, ranks and modifies
                   * the list until we arrive at the final 5 elements to display.
                   *
                   * Want To add another function to the user pipeline? Easy...
                   *
                   * Define a function like the following and add it to a pipeline. Ordering is very important.
                   *
                   * @param results   The results array as supplied by the previous function
                   * @param next      Call this function and pass some results to trigger the next stage of the pipeline
                   * @param context   Some context about the current rendering request. See Mentions.js
                   *
                   * function pipelineTransformation(results, next, context) {
                   *      //Do some things on results
                   *      results.forEach((results) => transform(result))
                   *
                   *      //Remember to call next
                   *      next(results);
                   * }
                   */

    function filterUsingQuery(results, next, context) {
        next(SearchUsers(results, context.query));
    }

    function moveSelectedUserToTop(oldUsers, next, context) {
        if (!context.selectedUser) {
            return next(oldUsers);
        }

        var index = oldUsers.findIndex(function (user) {
            return user.username === context.selectedUser.username;
        });
        // Note that > -1 means that the user IS in the array. If index is 0, the user is already in the correct position
        // at the start of the array and there is nothing to do.
        if (index <= 0) {
            return next(oldUsers);
        }

        // Put this user at the start of the array.
        var user = oldUsers[index];
        var newUsers = oldUsers.slice(0); // clone the array to avoid modifying the original
        newUsers.splice(index, 1);
        newUsers.unshift(user);

        return next(newUsers);
    }

    /**
     * fuseScore is available on all user results for a query-term search, so we can sort at any point in the pipeline.
     */
    function sortOnScore(users, next) {
        if (users.length && typeof users[0].fuseScore === 'number') {
            // If the first result has a fuseScore they all will.
            users.sort(function (user1, user2) {
                return user1.fuseScore - user2.fuseScore;
            });
        }
        next(users);
    }

    function limit(array, next, context) {
        next(array.slice(0, context.DISPLAY_LIMIT));
    }

    // Called in the Server pipeline when there are no results.
    function userNotFound(results, next) {
        if (!results.length) {
            var notFoundResult = RenderUtils.resultWithHtml(Templates.Mentions.userNotFoundResult());
            results = [notFoundResult];
        }

        next(results);
    }

    function empty(results, next) {
        if (!results.length) {
            next([RenderUtils.resultWithHtml(Templates.Mentions.loadingPlaceholder())]);
        } else {
            next(results);
        }
    }

    function addErrorResult(results, next) {
        var failureResult = RenderUtils.resultWithHtml(Templates.Mentions.searchFailureResult());
        next([failureResult]);
    }

    /**
     * This function convert Users from API format to something that the Dropdown can display.
     *
     * All elements in the results array should be Users in API format.
     * If you want to add other elements to the results array, do this *after* convertUsers in the pipeline
     *
     * @param results
     * @param next
     */
    function convertUsers(results, next) {
        next(ConvertUsers(results));
    }

    // Don't continue the render if the query is stale.
    function staleServerResponseFilter(results, next, context) {
        if (context.latestQuery === context.query) {
            next(results);
        }
    }

    exports.default = {

        default: function _default(renderCallback) {
            return [ResultPlaceholder.cancelTimeout, filterServerResults, ensureDefaultOrder, limit, ScoreBooster.setSuggestedUsers, convertUsers, renderCallback];
        },

        client: function client(renderCallback) {
            return [ResultPlaceholder.cancelTimeout, filterUsingQuery, ScoreBooster.boostScores, sortOnScore, limit, moveSelectedUserToTop, convertUsers, ResultPlaceholder.startTimeout, empty, renderCallback];
        },
        server: function server(renderCallback) {
            return [ResultPlaceholder.cancelTimeout, staleServerResponseFilter, filterUsingQuery, ScoreBooster.boostScores, sortOnScore, limit, moveSelectedUserToTop, scoreLogger, convertUsers, userNotFound, renderCallback];
        },

        error: function error(renderCallback) {
            return [ResultPlaceholder.cancelTimeout, addErrorResult, renderCallback];
        },

        _functions: {
            moveSelectedUserToTop: moveSelectedUserToTop,
            sortOnScore: sortOnScore
        }
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 43 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(15), __webpack_require__(16)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _utils, _templates) {
    'use strict';

    var RenderUtils = _interopRequireDefault(_utils).default;

    var Templates = _interopRequireDefault(_templates).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var displayTimeout = void 0;

    function _padResults(results, context) {
        var additionalElements = context.DISPLAY_LIMIT - results.length;
        if (additionalElements > 0) {
            var placeholder = RenderUtils.resultWithHtml(Templates.Mentions.loadingPlaceholder());
            for (var index = 0; index < additionalElements; index++) {
                results.push(placeholder);
            }
        }
        return results;
    }

    function startTimeout(results, next, context) {
        displayTimeout = setTimeout(function () {
            results = _padResults(results, context);
            next(results);
        }, window.skeletonPlaceholder || 3000); // CONFSRVDEV-3833 Remove once an appropriate value has been found.
        next(results);
    }

    function cancelTimeout(results, next) {
        clearTimeout(displayTimeout);
        next(results);
    }

    exports.default = {
        startTimeout: startTimeout,
        cancelTimeout: cancelTimeout
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 44 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(2), __webpack_require__(8), __webpack_require__(1), __webpack_require__(45)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _meta, _i18n, _userSupplierKeys, _darkFeatures) {
    'use strict';

    var Meta = _interopRequireDefault(_meta).default;

    var I18n = _interopRequireDefault(_i18n).default;

    var UserSupplier = _interopRequireDefault(_userSupplierKeys).default;

    var DarkFeatures = _interopRequireDefault(_darkFeatures).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    /**
     * Converts Users from API format to something that the Dropdown can display.
     */
    var contextPath = Meta.get('context-path');

    function getProfilePicture(user) {
        if (user && user.profilePicture && Meta.get('can-view-profile')) {
            // HACK - work around CONFSRVDEV-2936 by removing the dud context-path from the path.
            return user.profilePicture.path.replace('/_' + contextPath, '/_');
        }
        return contextPath + '/images/icons/profilepics/anonymous.svg';
    }

    var converter = function converter(users) {
        var addRecentLozenge = DarkFeatures.isEnabled('smart.mentions.recent.lozenge');
        var linkBase = Meta.get('base-url') + '/display/~';

        return users.map(function (user) {
            var link = linkBase + user.username;

            var lozenge = user.supplier === UserSupplier.RELATED && user.role && user.role.i18n;

            if (!lozenge && addRecentLozenge) {
                // Including a lozenge for Recent helps us see why an item is promoted, but make it opt-in.
                lozenge = user.supplier === UserSupplier.RECENT && I18n('user.supplier.recent');
            }
            // Uncomment this line to see why the results are in the order they are.
            // const lozenge = "" + user.fuseScore;

            return {
                className: 'insert-mentions-dropdown-option',
                name: user.displayName,
                username: user.username,
                href: link, // only used if the user tries to middle-click/open-in-new-tab the dropdown item
                icon: getProfilePicture(user),
                lozenge: lozenge,
                link: link,
                model: user,
                fuseMatches: user.fuseMatches
            };
        });
    };

    // Available for unit testing.
    converter._getProfilePicture = getProfilePicture;

    exports.default = converter;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 45 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_45__;

/***/ }),
/* 46 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(4)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _recentUsersSupplier) {
    "use strict";

    var RecentUsers = _interopRequireDefault(_recentUsersSupplier).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) {
        return typeof obj;
    } : function (obj) {
        return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
    };

    var supplierToScoreMap = {
        "current": 1,
        "recent": 2,
        "related": {
            "creator": 3,
            "contributor": 4,
            "commenter": 5
        },
        "server": 6
    };

    var MAX_SCORE = 100;

    function scoreUser(user) {
        var potentialScore = supplierToScoreMap[user.supplier];

        if (typeof potentialScore === "number") {
            if (typeof user.sortIndex === "number") {
                // This allows us to sort recent users coming out of the cache. The highest calculated score will be just < 3.
                potentialScore += user.sortIndex / (RecentUsers.RECENT_USER_LIMIT + 1);
            }
            return potentialScore;
        }

        // Not a number, probably another object, index into it with role
        // Otherwise, it might have been undefined
        return (typeof potentialScore === "undefined" ? "undefined" : _typeof(potentialScore)) === "object" ? potentialScore[user.role.role] : MAX_SCORE;
    }

    function ensureDefaultOrder(results, next) {
        var sorted = results.sort(function (user1, user2) {
            return scoreUser(user1) - scoreUser(user2);
        });
        next(sorted);
    }

    exports.default = ensureDefaultOrder;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 47 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs) {
    "use strict";

    exports.default = logScores;

    var AJS = _interopRequireDefault(_ajs).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    /**
     * Just used during development, logs result score information to help us figure out reasons for result order.
     */
    function logScores(results, next, context) {
        if (context.query) {
            AJS.debug("*** Mentions *** user-pipeline/logger: Logging search results for " + context.query);

            results.forEach(function (user) {
                AJS.debug("*** Mentions *** user-pipeline/logger: " + user.displayName + " has a score of " + user.fuseScore);
            });
        }

        next(results);
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 48 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(1)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _userSupplierKeys) {
    "use strict";

    var DEFAULT_SUPPLIERS = [_userSupplierKeys.RECENT, _userSupplierKeys.CURRENT, _userSupplierKeys.RELATED];

    function filterServerResults(results, next) {
        var filteredUsers = results.filter(function (user) {
            return DEFAULT_SUPPLIERS.indexOf(user.supplier) !== -1;
        });
        next(filteredUsers);
    }

    exports.default = filterServerResults;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 49 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports) {
    "use strict";

    function PipelineExecutor(pipeline, context) {
        this.pipeline = pipeline;
        this.context = context;
    }

    PipelineExecutor.prototype.execute = function (input) {
        this._next(0, input);
    };

    PipelineExecutor.prototype._next = function (index, results) {
        this.pipeline[index](results, this._next.bind(this, index + 1), this.context);
    };

    exports.default = PipelineExecutor;
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 50 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, exports, __webpack_require__(0), __webpack_require__(51), __webpack_require__(18)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (module, exports, _ajs, _analyticsSupport, _autocompleteManager) {
    'use strict';

    var AJS = _interopRequireDefault(_ajs).default;

    var Analytics = _interopRequireDefault(_analyticsSupport).default;

    var AutocompleteManager = _interopRequireDefault(_autocompleteManager).default;

    function _interopRequireDefault(obj) {
        return obj && obj.__esModule ? obj : {
            default: obj
        };
    }

    "use strict";

    function publishEventForSelection(user) {
        var context = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

        var idd = typeof AutocompleteManager.getInputDrivenDropdown === 'function' && AutocompleteManager.getInputDrivenDropdown();
        if (!idd || !user) {
            AJS.debug("Cannot publish 'confluence.mention.selection' analytics with missing dropdown, user or context.");
            return;
        }

        var query = idd._value || '';
        var dd = idd.dd;
        var index = dd && typeof dd.getFocusIndex === 'function' && dd.getFocusIndex();

        var analyticsData = {
            source: user.model.supplier,
            queryLength: query.length,
            queryWords: query.split(' ').length,
            index: index,
            numberOfSearches: context.numGetDataAndRunCallbackCalls
        };

        // By publishing the supplier source of the selected User, we can determine whether users are finding
        // the users they need from the Smart mentions or whether they still have to wait for the Dumb (server)
        // ones.
        Analytics.publish('confluence.mention.selection', analyticsData);
        AJS.debug("Published 'confluence.mention.selection' event with supplier: " + user.model.supplier);
    }

    /**
     * Updates the state of the current Mention interaction.
     * @param autoCompleteControl
     */
    function updateSession(autoCompleteControl) {
        autoCompleteControl.analytics = Object.assign({
            numGetDataAndRunCallbackCalls: 0
        }, autoCompleteControl.analytics);

        autoCompleteControl.analytics.numGetDataAndRunCallbackCalls += 1;
    }

    exports.default = {
        updateSession: updateSession,
        publishEventForSelection: publishEventForSelection
    };
    module.exports = exports['default'];
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

/***/ }),
/* 51 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_51__;

/***/ }),
/* 52 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_52__;

/***/ }),
/* 53 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_53__;

/***/ })
/******/ ])});;
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-mentions-plugin:smart-mentions-editor-resources', location = '/js/smart-mentions-init.js' */
require([
    'confluence-editor/loader/tinymce-bootstrap',
    'confluence-mentions'
], function (BootstrapManager,
             Mentions) {
    // Main entry point to Smart Mentions logic. To lower page weight, we could potentially pull in the Mentions
    // bundle.js via a WRM.require on the bootstrap init.
    BootstrapManager.addOnInitCallback(Mentions.init);
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/vendor/jquery.stickytableheaders.js' */
/*! Modified by Atlassian | Copyright (c) 2011 by Jonas Mosbech - https://github.com/jmosbech/StickyTableHeaders
	MIT license info: https://github.com/jmosbech/StickyTableHeaders/blob/master/license.txt */
(function(d,c,f){var a="stickyTableHeaders",g=0,e={fixedOffset:0,leftOffset:0,marginTop:0,objDocument:document,objHead:"head",objWindow:c,scrollableArea:c,cacheHeaderHeight:false};function b(i,h){var j=this;j.$el=d(i);j.el=i;j.id=g++;j.$el.bind("destroyed",d.proxy(j.teardown,j));j.$clonedHeader=null;j.$originalHeader=null;j.cachedHeaderHeight=null;j.isSticky=false;j.hasBeenSticky=false;j.leftOffset=null;j.topOffset=null;j.init=function(){j.setOptions(h);j.$el.each(function(){var k=d(this);k.css("padding",0);j.$originalHeader=d("thead:first",this);j.$clonedHeader=j.$originalHeader.clone();k.trigger("clonedHeader."+a,[j.$clonedHeader]);j.$clonedHeader.addClass("tableFloatingHeader");j.$clonedHeader.css("display","none");j.$originalHeader.addClass("tableFloatingHeaderOriginal");j.$originalHeader.after(j.$clonedHeader);j.$printStyle=d('<style type="text/css" media="print">.tableFloatingHeader{display:none !important;}.tableFloatingHeaderOriginal{position:static !important;}</style>');j.$head.append(j.$printStyle)});j.updateWidth();j.toggleHeaders();j.bind()};j.destroy=function(){j.$el.unbind("destroyed",j.teardown);j.teardown()};j.teardown=function(){if(j.isSticky){j.$originalHeader.css("position","static")}d.removeData(j.el,"plugin_"+a);j.unbind();j.$clonedHeader.remove();j.$originalHeader.removeClass("tableFloatingHeaderOriginal");j.$originalHeader.css("visibility","visible");j.$printStyle.remove();j.el=null;j.$el=null};j.bind=function(){j.$scrollableArea.on("scroll."+a,j.toggleHeaders);if(!j.isWindowScrolling){j.$window.on("scroll."+a+j.id,j.setPositionValues);j.$window.on("resize."+a+j.id,j.toggleHeaders)}j.$scrollableArea.on("resize."+a,j.toggleHeaders);j.$scrollableArea.on("resize."+a,j.updateWidth)};j.unbind=function(){j.$scrollableArea.off("."+a,j.toggleHeaders);if(!j.isWindowScrolling){j.$window.off("."+a+j.id,j.setPositionValues);j.$window.off("."+a+j.id,j.toggleHeaders)}j.$scrollableArea.off("."+a,j.updateWidth)};j.debounce=function(l,k){var m=null;return function(){var o=this,n=arguments;clearTimeout(m);m=setTimeout(function(){l.apply(o,n)},k)}};j.toggleHeaders=j.debounce(function(){if(j.$el){j.$el.each(function(){var q=d(this),r,n=j.isWindowScrolling?(isNaN(j.options.fixedOffset)?j.options.fixedOffset.outerHeight():j.options.fixedOffset):j.$scrollableArea.offset().top+(!isNaN(j.options.fixedOffset)?j.options.fixedOffset:0),m=q.offset(),k=j.$scrollableArea.scrollTop()+n,l=j.$scrollableArea.scrollLeft(),o=j.options.cacheHeaderHeight?j.cachedHeaderHeight:j.$clonedHeader.height(),p=j.isWindowScrolling?k>m.top:n>m.top,s=(j.isWindowScrolling?k:0)<(m.top+q.height()-o-(j.isWindowScrolling?0:n));if(p&&s){r=m.left-l+j.options.leftOffset;j.$originalHeader.css({position:"fixed","margin-top":j.options.marginTop,left:r,"z-index":3});j.leftOffset=r;j.topOffset=n;j.$clonedHeader.css("display","");if(!j.isSticky){j.isSticky=true;j.updateWidth();q.trigger("enabledStickiness."+a)}j.setPositionValues()}else{if(j.isSticky){j.$originalHeader.css("position","static");j.$clonedHeader.css("display","none");j.isSticky=false;j.resetWidth(d("td,th",j.$clonedHeader),d("td,th",j.$originalHeader));q.trigger("disabledStickiness."+a)}}})}},0);j.setPositionValues=j.debounce(function(){var k=j.$window.scrollTop(),l=j.$window.scrollLeft();if(!j.isSticky||k<0||k+j.$window.height()>j.$document.height()||l<0||l+j.$window.width()>j.$document.width()){return}j.$originalHeader.css({top:j.topOffset-(j.isWindowScrolling?0:k),left:j.leftOffset-(j.isWindowScrolling?0:l)})},0);j.updateWidth=j.debounce(function(){if(!j.isSticky){return}if(!j.$originalHeaderCells){j.$originalHeaderCells=d("th,td",j.$originalHeader)}if(!j.$clonedHeaderCells){j.$clonedHeaderCells=d("th,td",j.$clonedHeader)}var k=j.getWidth(j.$clonedHeaderCells);j.setWidth(k,j.$clonedHeaderCells,j.$originalHeaderCells);j.$originalHeader.css("width",j.$clonedHeader.width());if(j.options.cacheHeaderHeight){j.cachedHeaderHeight=j.$clonedHeader.height()}},0);j.getWidth=function(k){var l=[];k.each(function(p){var r,s=d(this);if(s.css("box-sizing")==="border-box"){var t=s[0].getBoundingClientRect();if(t.width){r=t.width}else{r=t.right-t.left}}else{var n=d("th",j.$originalHeader);if(n.css("border-collapse")==="collapse"){if(c.getComputedStyle){r=parseFloat(c.getComputedStyle(this,null).width)}else{var q=parseFloat(s.css("padding-left"));var m=parseFloat(s.css("padding-right"));var o=parseFloat(s.css("border-width"));r=s.outerWidth()-q-m-o}}else{r=s.width()}}l[p]=r});return l};j.setWidth=function(m,k,l){k.each(function(n){var o=m[n];l.eq(n).css({"min-width":o,"max-width":o})})};j.resetWidth=function(k,l){k.each(function(m){var n=d(this);l.eq(m).css({"min-width":n.css("min-width"),"max-width":n.css("max-width")})})};j.setOptions=function(k){j.options=d.extend({},e,k);j.$window=d(j.options.objWindow);j.$head=d(j.options.objHead);j.$document=d(j.options.objDocument);j.$scrollableArea=d(j.options.scrollableArea);j.isWindowScrolling=j.$scrollableArea[0]===j.$window[0]};j.updateOptions=function(k){j.setOptions(k);j.unbind();j.bind();j.updateWidth();j.toggleHeaders()};j.init()}d.fn[a]=function(h){return this.each(function(){var i=d.data(this,"plugin_"+a);if(i){if(typeof h==="string"){i[h].apply(i)}else{i.updateOptions(h)}}else{if(h!=="destroy"){d.data(this,"plugin_"+a,new b(this,h))}}})}})(jQuery,window);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/lib/utils.js' */
define("sticky-table-headers/utils",["jquery"],function(d){var c=function(m){return !m.hasClass("stickyTableHeaders")};var f=function(m){return !m.parents("table").length>0};var l=function(m){return m.find("> thead:first").is(":visible")};var b=function(m){return m.find("thead").children().length===1};var i=function(m){return !m.closest(".columnLayout").length>0};var h=function(){return !d("body").hasClass("theme-documentation")};var a=function(m){return m.find(".confluenceTh").parent().length===1};var j=function(m){return m.find(".confluenceTh").siblings().hasClass("confluenceTh")};var g=function(n){var m=d(n);return h()&&c(m)&&i(m)&&f(m)&&l(m)&&b(m)&&a(m)&&j(m)};var k=function(m,o){var n=o||d(window);m.closest(".table-wrap").scroll(function(){n.trigger("scroll.stickyTableHeaders")})};var e=function(m){d(m).each(function(){var r=d(this);var s=r.find(".confluenceTh[rowspan]").length>0;var o=r.find("> :first-child > :first-child .confluenceTh");var n=o.length&&o.closest("thead").length>0;var q=o.length&&o.parent().index()===0;if(f(r)&&i(r)&&!n&&q&&!s){var p=d("<thead />").append(o.parent());r.prepend(p)}})};return{isAValidTable:g,bindHorizontalScrolling:k,moveHeaderRowsToTHead:e,isNotDocumentationTheme:h}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/lib/viewpage.js' */
define("sticky-table-headers/viewpage",["jquery","ajs","sticky-table-headers/utils"],function(g,c,f){var b;var e;var d=function(j,i){var h=g(j).filter(function(){return f.isAValidTable(this)});h.stickyTableHeaders(i).addClass("stickyTableHeaders");var k=function(l,m){h.stickyTableHeaders(m)};if(e){c.unbind("sticky-table-headers.change.options",e)}c.bind("sticky-table-headers.change.options",k);e=k;f.bindHorizontalScrolling(h)};var a=function(){var i=g(".confluenceTable:not(.stickyTableHeaders)");var l=g(window);if(!f.isNotDocumentationTheme()){return}f.moveHeaderRowsToTHead(i);if(window.MutationObserver){var k=document.querySelector("#page")||document.querySelector("#confluence-ui");var j=/sticky|tableFloating|confluenceTh/;var h=new MutationObserver(g.debounce(function(n){var p=false;var q;for(var o=0,m=n.length;o<m;o++){q=n[o].target.className;if(!j.test(q)){p=true;break}}if(p){l.trigger("resize.stickyTableHeaders")}},0));if(b&&b.unobserve){b.unobserve()}h.observe(k,{subtree:true,attributes:true,childList:true});b=h}d(i,{cacheHeaderHeight:true})};return{initialize:a,setupTable:d}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/lib/editor.js' */
define("sticky-table-headers/editor",["ajs","jquery","sticky-table-headers/utils",],function(b,f,e){var d=function(g){var h={};h.objWindow=f(g.getWin());h.scrollableArea=h.objWindow;h.objDocument=f(g.getDoc());h.objHead=h.objDocument.find("head");return h};var c=function(k,h){var j=b.Rte.getEditor();if(j){var l=d(j);var i=f.extend({},l,h);var g=f(k).filter(function(){return e.isAValidTable(this)});g.stickyTableHeaders(i).addClass("stickyTableHeaders");e.bindHorizontalScrolling(g,i.objWindow)}};var a=function(){var h=b.Rte.getEditor();if(h){var g=f(h.getBody()).find(".confluenceTable");e.moveHeaderRowsToTHead(g);c(g)}};return{initialize:a,setupTable:c}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/stickytableheaders.js' */
define("sticky-table-headers",["ajs","sticky-table-headers/viewpage","sticky-table-headers/editor","skate"],function(c,g,f,b){var e=false;var d=c.debounce(g.initialize,0);function a(i,h){if(h<0){return}if(i.getElementsByTagName("thead").length===0){if(!e){setTimeout(a.bind(null,i,--h),50);e=true}}else{d();e=false}}return{initialize:function(){if(!c.DarkFeatures.isEnabled("confluence-table-enhancements.sticky-headers.disabled")){b("confluenceTable",{type:b.types.CLASS,attached:function(h){a(h,5)}})}if(c.DarkFeatures.isEnabled("confluence-table-enhancements.sticky-headers-editor")){c.bind("rte-ready",f.initialize);c.bind("rte-quick-edit-push-state",f.initialize);c.bind("rte-quick-edit-push-hash",f.initialize)}}}});require("sticky-table-headers").initialize();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.adaptavist.confluence.contentFormattingMacros:macro-analytics-bundle', location = 'frontend/bundles/macro-analytics.bundle.js' */
!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="http://localhost:8080/target/classes/frontend/bundles",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);var n={reportMacroInserted:function(e){var t=this.buildAnalyticData("Macro-Inserted",e);return this.reportAnalyticsToBackend(t)},reportMacroEdited:function(e){var t=this.buildAnalyticData("Macro-Edited",e);return this.reportAnalyticsToBackend(t)},reportMacrosDeleted:function(e){var t=this,r=(Array.isArray(e)?e:[e]).map(function(e){return t.buildAnalyticData("Macro-Deleted",e)});return this.reportAnalyticsToBackend(r)},buildAnalyticData:function(e,t){return{eventType:[e],spaceKey:[AJS.params.spaceKey],pageId:[AJS.params.pageId],macroName:[t]}},reportAnalyticsToBackend:function(e){var t=Array.isArray(e)?e:[e];return $.ajax({type:"POST",contentType:"application/json",async:!0,url:AJS.params.baseUrl+"/plugins/servlet/cfm/analytics/macro-usage",data:JSON.stringify(t)}).error(function(){})}};var a="com.adaptavist.confluence.contentFormattingMacros",o=function(e,t){for(var r=[],n=i(),a=e(),o=0;o<a.length;o++){var c=t(a[o]),u=n.filter(function(e){return e.macroName===c});1===u.length&&r.push(u[0])}return r};function i(){return AJS.MacroBrowser.metadataList.filter(function(e){return e.pluginKey===a})}var c=function(){return $("#wysiwygTextarea_ifr")[0].contentWindow.getSelection().getRangeAt(0).cloneContents().querySelectorAll("table.wysiwyg-macro, img.editor-inline-macro")},u=function(e){return e.dataset.macroName},d=function(){return $('div.aui-dropdown ol li.active a[class^="autocomplete-macro"]')},l=function(e){var t=$(e).attr("class");return t.substring("autocomplete-macro-".length+t.indexOf("autocomplete-macro-"))},s=function(){return $("div#macro-insert-container input.macro-name")},f=function(){return $("#avst-custom-dialog-macro-name")},m=function(e){return e.value},p=function(e,t){if("Insert"===e){var r=o(s,m);n.reportMacroInserted(r[0].macroName)}else if("InsertCustomDialog"===e){var a=o(f,m);n.reportMacroInserted(a[0].macroName)}else if("Save"===e){var i=o(c,u);n.reportMacroEdited(i[0].macroName)}else if("SaveCustomDialog"===e){var d=o(function(){return t},function(){return t.find("#avst-custom-dialog-macro-name").attr("value")});n.reportMacroEdited(d[0].macroName)}},v=function(e){if($(e.target).is('a[class*="autocomplete-macro"] span:first-child')){var t=o(d,l);if(!t.length)return;var r=t[0];r.anyParameterRequired||n.reportMacroInserted(r.macroName)}},g=function(e){var t=e.target;if(13===e.keyCode){var r=t.matches("div.macro-input-fields form div.macro-param-div .macro-param-input"),n="submit"===t.type,a=$("#macro-details-page").is(":visible")&&1===$("#macro-details-page").find(".button-panel-button.ok").size();if(!n&&(r||a)){var o=$("div#macro-details-page div.dialog-button-panel button.button-panel-button.ok")[0];p(o.innerText)}}},y=function(){var e=$(".macro-placeholder-property-panel-remove-button"),t=o(c,u);e.size()>0&&e.one("click.removeMacro",function(){n.reportMacrosDeleted([t[0].macroName])})},b=function(e){if(46===e.keyCode||8===e.keyCode){var t=o(c,u);if(!t||!t[0])return;var r=t.map(function(e){return e.macroName});n.reportMacrosDeleted(r)}else if(13===e.keyCode){if($("#autocomplete-dropdown li.active").size()){var a=$("#autocomplete-dropdown li.active").text(),d=(l=a,i().find(function(e){return e.title===l}));d&&!d.anyParameterRequired&&n.reportMacroInserted(d.macroName)}}var l},M=function(e,t){var r=e.target;if(function(e){return e.matches("#buttongroup-dialog #insertButtonGroup")}(r)){var n=r.innerText;p(n+"CustomDialog",t)}else p(e.target.innerText)};function k(){var e;$("#editPageLink").off("click.enterEditMode",k),document.addEventListener("click",y,!0),document.addEventListener("click",v,!0),document.addEventListener("keydown",g,!0),function e(t,r){var n=$(t);if(n.size())return n.ready(function(){r(n)});window.requestAnimationFrame(function(){return e(t,r)})}("#wysiwygTextarea_ifr",function(e){(e.get(0).contentDocument||e.get(0).contentWindow.document).addEventListener("keydown",b,!0)}),e=function(e){e.find(".button-panel-button.ok")[0].addEventListener("click",M(event,e),!0)},document.addEventListener("click",function(){var t=$("#buttongroup-dialog").size()?$("#buttongroup-dialog"):$("#macro-details-page");t.size()&&"hiddenButton"!==event.target.id&&e(t)},!0)}AJS.toInit(function(){AJS.Editor.isVisible()?k():$("#editPageLink").on("click.enterEditMode",k)})}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.adaptavist.confluence.contentFormattingMacros:rest-table-js', location = 'soy/common.soy' */
// This file was automatically generated from common.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace ContentFormatting.Macro.Common.
 */

if (typeof ContentFormatting == 'undefined') { var ContentFormatting = {}; }
if (typeof ContentFormatting.Macro == 'undefined') { ContentFormatting.Macro = {}; }
if (typeof ContentFormatting.Macro.Common == 'undefined') { ContentFormatting.Macro.Common = {}; }


ContentFormatting.Macro.Common.requiredIcon = function(opt_data, opt_ignored) {
  return '<span class="aui-icon icon-required icon-required-moved"> required</span>';
};
if (goog.DEBUG) {
  ContentFormatting.Macro.Common.requiredIcon.soyTemplateName = 'ContentFormatting.Macro.Common.requiredIcon';
}


ContentFormatting.Macro.Common.descriptionDesc = function(opt_data, opt_ignored) {
  return '<div class="description">' + soy.$$escapeHtml('Displayed below the field') + '</div>';
};
if (goog.DEBUG) {
  ContentFormatting.Macro.Common.descriptionDesc.soyTemplateName = 'ContentFormatting.Macro.Common.descriptionDesc';
}


ContentFormatting.Macro.Common.velocityValueLink = function(opt_data, opt_ignored) {
  return '' + soy.$$escapeHtml('ID (relating to data attribute)');
};
if (goog.DEBUG) {
  ContentFormatting.Macro.Common.velocityValueLink.soyTemplateName = 'ContentFormatting.Macro.Common.velocityValueLink';
}


ContentFormatting.Macro.Common.footerContent = function(opt_data, opt_ignored) {
  return '<div class="custom-macro-footer"><div class="aui-group aui-group-split"><div class="aui-item"><a class="" href="' + soy.$$escapeHtml(opt_data.docHrefHtml) + '" target="_blank">' + soy.$$escapeHtml('Documentation') + '</a></div><div class="aui-item"><button class="aui-button aui-button-primary button-panel-button ok" id="insertButtonGroup" type="submit">' + soy.$$escapeHtml(opt_data.buttonTitle) + '</button><a class="aui-button aui-button-link" href="#" id="cancelButtonGroup">' + soy.$$escapeHtml('Cancel') + '</a></div></div></div>';
};
if (goog.DEBUG) {
  ContentFormatting.Macro.Common.footerContent.soyTemplateName = 'ContentFormatting.Macro.Common.footerContent';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.adaptavist.confluence.contentFormattingMacros:rest-table-js', location = 'soy/rest-table-macro.soy' */
// This file was automatically generated from rest-table-macro.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace ContentFormatting.Macro.RestTable.
 */

if (typeof ContentFormatting == 'undefined') { var ContentFormatting = {}; }
if (typeof ContentFormatting.Macro == 'undefined') { ContentFormatting.Macro = {}; }
if (typeof ContentFormatting.Macro.RestTable == 'undefined') { ContentFormatting.Macro.RestTable = {}; }


ContentFormatting.Macro.RestTable.dialog = function(opt_data, opt_ignored) {
  return '' + aui.dialog.dialog2({id: 'buttongroup-dialog', titleText: opt_data.title, modal: true, size: 'xlarge', content: '' + ContentFormatting.Macro.RestTable.content(opt_data), footerActionContent: '' + ContentFormatting.Macro.Common.footerContent(soy.$$augmentMap(opt_data, {docHrefHtml: 'https://www.adaptavist.com/doco/display/CFP/Restful+Table', buttonTitle: opt_data.buttonTitle}))});
};
if (goog.DEBUG) {
  ContentFormatting.Macro.RestTable.dialog.soyTemplateName = 'ContentFormatting.Macro.RestTable.dialog';
}


ContentFormatting.Macro.RestTable.content = function(opt_data, opt_ignored) {
  var output = '<div class="module custom-macro-dialog"><form id="buttonGroupForm" class="aui rest-table"><div role="application" class="aui-tabs horizontal-tabs"><ul role="tablist" class="tabs-menu"><li role="presentation" class="menu-item active-tab"><a aria-selected="true" role="tab" id="link-details" href="#tabs-details"><strong>' + soy.$$escapeHtml('Macro Options') + '</strong></a></li></ul><div aria-hidden="false" role="tabpanel" class="tabs-pane active-pane" id="tabs-details"><input id="avst-custom-dialog-macro-name" type="hidden" value="rest-table"><fieldset class="details"><legend>' + soy.$$escapeHtml('Rest Table Details') + '</legend><div class="aui-group aui-group-split"><div class="aui-item group-label"><label for="restURL">' + soy.$$escapeHtml('Resource URL') + '</label><input id="restURL" name="restURL" type="text" value="' + soy.$$escapeHtml(opt_data.restURL ? opt_data.restURL : '') + '" class="text" required="required"/><div class="description">' + soy.$$escapeHtml('URL of json data for table') + '</div></div></div></fieldset><fieldset class="rows"><legend>' + soy.$$escapeHtml('Add Table Column') + '</legend><div class="aui-group"><div class="aui-item create-button-rows"><table class="aui" id="dataTable"><thead><tr><th class="buttonLabel">' + soy.$$escapeHtml('Header') + '</th><th class="buttonValue">' + ContentFormatting.Macro.Common.velocityValueLink(null) + '</th><th class="actions">' + soy.$$escapeHtml('Actions') + '</th></tr></thead><tbody>';
  var valueList34 = opt_data.values;
  var valueListLen34 = valueList34.length;
  for (var valueIndex34 = 0; valueIndex34 < valueListLen34; valueIndex34++) {
    var valueData34 = valueList34[valueIndex34];
    output += ContentFormatting.Macro.RestTable.addRestTableRow({rowIndex: valueIndex34, size: opt_data.values.length, label: valueData34.label, value: valueData34.value});
  }
  output += '</tbody></table></div></div></fieldset></div></div><button class="hiddenButton" id="hiddenButton" type="submit"></button></form></div>';
  return output;
};
if (goog.DEBUG) {
  ContentFormatting.Macro.RestTable.content.soyTemplateName = 'ContentFormatting.Macro.RestTable.content';
}


ContentFormatting.Macro.RestTable.addRestTableRow = function(opt_data, opt_ignored) {
  return '<tr id="groupRow' + soy.$$escapeHtml(opt_data.rowIndex) + '"><td class="buttonLabel"><input class="text buttonInputLabel" name="buttonLabel" type="text" value="' + soy.$$escapeHtml(opt_data.label) + '"/></td><td class="buttonValue"><input class="text buttonInputValue" name="buttonValue" type="text" value="' + soy.$$escapeHtml(opt_data.value) + '"/></td><td class="actions"><input onclick="addRestTableRow(' + soy.$$escapeHtml(opt_data.rowIndex) + ')" type="button" class="aui-button" value="+"/><input onclick="removeRestTableGroupRow(' + soy.$$escapeHtml(opt_data.rowIndex) + ')" id="removeButton-' + soy.$$escapeHtml(opt_data.rowIndex) + '" type="button" class="aui-button" value="-" ' + ((opt_data.size == 1) ? 'disabled' : '') + '/></td></tr>';
};
if (goog.DEBUG) {
  ContentFormatting.Macro.RestTable.addRestTableRow.soyTemplateName = 'ContentFormatting.Macro.RestTable.addRestTableRow';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.adaptavist.confluence.contentFormattingMacros:rest-table-js', location = 'js/rest-table-macro.js' */
AJS.bind("init.rte", function () {

    //Model for a Rest Table
    function RestTable(params) {

        this.getRestURL = function () {
            return params === undefined ? '' : params.restURL;
        };


        this.getValues = function () {
            if (params === undefined) {
                return [{
                    label: '',
                    value: ''
                }];
            } else {
                var counter = Number(params['counter']);
                var values = [];

                //Unfortunately, Confluence cannot parse a JSON string, so one needs to write each parameter individually
                for (var i = 0; i < counter; i++) {
                    values.push({
                        label: params[i.toString() + '_label'] === undefined ? "" : params[i.toString() + '_label'],
                        value: params[i.toString() + '_value'] === undefined ? "" : params[i.toString() + '_value']
                    });
                }
                return values;
            }
        };
    }

    //Fetches all Label/Values from each row, plus if it's selected.
    function getRowValues(values) {
        var counter = 0;

        //Unfortunately, Confluence cannot parse a JSON string, so one needs to write each parameter individually
        AJS.$('[id^="groupRow"]').each(function () {
            var label = $(this).find("input[name='buttonLabel']").val();
            var value = $(this).find("input[name='buttonValue']").val();

            values[counter + '_label'] = label;
            values[counter + '_value'] = value;

            counter++;
        });

        values['counter'] = counter;

        return values;
    }

    function getRestTableParams() {
        var values = {
            restURL: AJS.$('#restURL').val()
        };

        return getRowValues(values);
    }

    function setupEvents() {
        // Setups Tabs in AJS
        AJS.tabs.setup();

        //Hooks up the Cancel Button
        AJS.$('#cancelButtonGroup').click(function (e) {
            e.preventDefault();
            AJS.dialog2('#buttongroup-dialog').remove();
        });

        //Hooks up the Insert Button
        // The hidden button is required to submit the form because the dialog submit button is outside the form element.
        AJS.$('#insertButtonGroup').click(function () {
            AJS.$('#buttonGroupForm').submit();
        });
    }

    function createRestTable(macro) {

        //Creates a new Rest Table object that holds the parameters
        var restTable = new RestTable(macro.params);

        var dialogAndButtonTitle = macro.body === undefined ?
            "Insert" :
            "Save";
        //Calls the dialog with Edit or Insert accordingly.
        AJS.dialog2(ContentFormatting.Macro.RestTable.dialog({
            title: dialogAndButtonTitle + ' ' + "\u0027Restful Table\u0027 Macro",
            buttonTitle: dialogAndButtonTitle,
            restURL: restTable.getRestURL(),
            values: restTable.getValues()
        })).show();

        AJS.$('#insertButtonGroup').on('click', function (event) {
            AJS.$('#hiddenButton').click();
        });

        AJS.$('#buttonGroupForm').on('submit', function (e) {
            e.preventDefault();

                var t = tinymce.confluence.macrobrowser;

                AJS.Rte.BookmarkManager.restoreBookmark();

                if (t.editedMacroDiv) {
                    delete t.editedMacroDiv;
                }

                //Saves the Macro. Since the values is an array, it needs to convert it to JSON and then parse it back to display.
                tinymce.confluence.macrobrowser.macroBrowserComplete({
                    name: "rest-table",
                    "bodyHtml": undefined,
                    "params": getRestTableParams(),
                    "values": restTable.getValues()
                });

                AJS.dialog2('#buttongroup-dialog').remove();
        });

        setupEvents();
    }

    AJS.MacroBrowser.setMacroJsOverride('rest-table', {opener: createRestTable});
});

//Adds a new row Macro
function addRestTableRow(rowIndex) {
    AJS.$('#dataTable > tbody > tr#groupRow' + rowIndex).after(ContentFormatting.Macro.RestTable.addRestTableRow({
        rowIndex: AJS.$('[id^="groupRow"]').length,
        label: '',
        value: ''
    }));

    AJS.$('[id^="removeButton-"]')[0].disabled = false;
}
//Removes a row from Macro
function removeRestTableGroupRow(rowIndex) {
    AJS.$('#groupRow' + rowIndex).remove();

    if (AJS.$('[id^="removeButton-"]').length == 1) {
        AJS.$('[id^="removeButton-"]')[0].disabled = true;
    }
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.profile-picture:profile-picture-editor_resources', location = 'js/profile-picture.js' */
AJS.bind("init.rte",function(){AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("viewProfile",function(d,a){var b=AJS.$(a);var f={};if(b.attr("data-macro-parameters")){AJS.$.each(b.attr("data-macro-parameters").split("|"),function(e,g){var h=g.split("=");f[h[0]]=h[1]})}var c=window.open(AJS.Confluence.getBaseUrl()+"/display/~"+f.user);c.opener=null})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.extra.officeconnector:macro-browser-smart-fields', location = 'javascript/office-connector-macro-fields.js' */
(function(a){AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("viewdoc",["doc","docx"]);AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("viewpdf",["pdf"]);AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("viewxls",["xls","xlsx"]);AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("viewppt",["ppt","pptx"]);AJS.MacroBrowser.Macros.viewfile={updateSelectedMacro:function(c){var e=c.params[""]||c.params.name;if(e){var d=e.lastIndexOf(".");if(d>0){var b=e.substring(d+1);if(b){(b=="doc")&&(b=="docx")&&(c.name="viewdoc");(b=="pdf")&&(c.name="viewpdf");(b=="ppt")&&(b=="pptx")&&(c.name="viewppt");(b=="xls")&&(b=="xlsx")&&(c.name="viewxls")}}}}}})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:0488db8efe8b33990894080ed5d9d8c4', location = 'build/734.js' */
/*! For license information please see 734.js.LICENSE.txt */
(self.webpackChunk=self.webpackChunk||[]).push([[734],{4298:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return Vt}});var i=a(67945),n=a.n(i),r=a(89976);r.selection.prototype.filterByAttr=function(t,e){return this.filter((function(){return this.attributes[t].textContent===e}))},r.transition.prototype.filterByAttr=r.selection.prototype.filterByAttr;var o=r,s=a(50593),l=a(64932),u=a.n(l),c=a(13335);function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var p="d3pie",g=0,f={header:{title:{text:"",color:"#333333",fontSize:18,font:"arial"},subtitle:{text:"",color:"#666666",fontSize:14,font:"arial"},location:"top-center",titleSubtitlePadding:8},footer:{text:"",color:"#666666",fontSize:14,font:"arial",location:"left"},size:{canvasHeight:500,canvasWidth:500,pieInnerRadius:"0%",pieOuterRadius:null},data:{sortOrder:"none",ignoreSmallSegments:{enabled:!1,valueType:"percentage",value:null},smallSegmentGrouping:{enabled:!1,value:1,valueType:"percentage",label:"Other",color:"#cccccc"},content:[]},labels:{outer:{format:"label",hideWhenLessThanPercentage:null,pieDistance:30},inner:{format:"percentage",hideWhenLessThanPercentage:null},mainLabel:{color:"#333333",font:"arial",fontSize:10},percentage:{color:"#dddddd",font:"arial",fontSize:10,decimalPlaces:0},value:{color:"#cccc44",font:"arial",fontSize:10},lines:{enabled:!0,style:"curved",color:"segment"},truncation:{enabled:!1,truncateLength:30},formatter:null},effects:{load:{effect:"default",speed:1e3},pullOutSegmentOnClick:{effect:"bounce",speed:300,size:10},highlightSegmentOnMouseover:!0,highlightLuminosity:-.2},tooltips:{enabled:!1,type:"placeholder",string:"",placeholderParser:null,styles:{fadeInSpeed:250,backgroundColor:"#000000",backgroundOpacity:.5,color:"#efefef",borderRadius:2,font:"arial",fontSize:10,padding:4}},misc:{colors:{background:null,segments:["#2484c1","#65a620","#7b6888","#a05d56","#961a1a","#d8d23a","#e98125","#d0743c","#635222","#6ada6a","#0c6197","#7d9058","#207f33","#44b9b0","#bca44a","#e4a14b","#a3acb2","#8cc3e9","#69a6f9","#5b388f","#546e91","#8bde95","#d2ab58","#273c71","#98bf6e","#4daa4b","#98abc5","#cc1010","#31383b","#006391","#c2643f","#b0a474","#a5a39c","#a9c2bc","#22af8c","#7fcecf","#987ac6","#3d3b87","#b77b1c","#c9c2b6","#807ece","#8db27c","#be66a2","#9ed3c6","#00644b","#005064","#77979f","#77e079","#9c73ab","#1f79a7"],segmentStroke:"#ffffff"},gradient:{enabled:!1,percentage:95,color:"#000000"},canvasPadding:{top:5,right:5,bottom:5,left:5},pieCenterOffset:{x:0,y:0},cssPrefix:null},callbacks:{onload:null,onMouseoverSegment:null,onMouseoutSegment:null,onClickSegment:null}},m=function(t){var e=t.cssPrefix,a=t.element,i=t.options;if(!(a instanceof HTMLElement||a instanceof SVGElement))return!1;if(!/[a-zA-Z][a-zA-Z0-9_-]*$/.test(e))return!1;if(!x.isArray(i.data.content))return!1;if(0===i.data.content.length)return!1;for(var n=[],r=0;r<i.data.content.length;r++)"number"!=typeof i.data.content[r].value||isNaN(i.data.content[r].value)||i.data.content[r].value<=0||n.push(i.data.content[r]);return t.options.data.content=n,!0},x={addSVGSpace:function(t){var e=t.element,a=t.options.size.canvasWidth,i=t.options.size.canvasHeight,n=t.options.misc.colors.background,r=o.select(e).append("svg:svg").attr("width",a).attr("height",i);return"transparent"!==n&&r.style("background-color",(function(){return n})),r},whenIdExists:function(t,e){var a=1,i=setInterval((function(){document.getElementById(t)&&(clearInterval(i),e()),a>1e3&&clearInterval(i),a++}),1)},whenElementsExist:function(t,e){var a=1,i=setInterval((function(){for(var n=!0,r=0;r<t.length;r++)if(!document.getElementById(t[r])){n=!1;break}n&&(clearInterval(i),e()),a>1e3&&clearInterval(i),a++}),1)},shuffleArray:function(t){for(var e,a,i=t.length;0!==i;)a=Math.floor(Math.random()*i),e=t[i-=1],t[i]=t[a],t[a]=e;return t},processObj:function(t,e,a){return"string"==typeof e?x.processObj(t,e.split("."),a):1===e.length&&void 0!==a?(t[e[0]]=a,t[e[0]]):0===e.length?t:x.processObj(t[e[0]],e.slice(1),a)},getDimensions:function(t){var e=document.getElementById(t),a=0,i=0;if(e){var n=e.getBBox();a=n.width,i=n.height}return{w:a,h:i}},rectIntersect:function(t,e){return!(e.x>t.x+t.w||e.x+e.w<t.x||e.y+e.h<t.y||e.y>t.y+t.h)},getColorShade:function(t,e){(t=String(t).replace(/[^0-9a-f]/gi,"")).length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),e=e||0;for(var a="#",i=0;i<3;i++){var n=parseInt(t.substr(2*i,2),16);a+=("00"+(n=Math.round(Math.min(Math.max(0,n+n*e),255)).toString(16))).substr(n.length)}return a},initSegmentColors:function(t){for(var e=t.options.data.content,a=t.options.misc.colors.segments,i=[],n=0;n<e.length;n++)e[n].hasOwnProperty("color")?i.push(e[n].color):i.push(a[n]);return i},applySmallSegmentGrouping:function(t,e){var a;"percentage"===e.valueType&&(a=v.getTotalPieSize(t));for(var i=[],n=[],r=0,o=0;o<t.length;o++)if("percentage"===e.valueType){if(t[o].value/a*100<=e.value){n.push(t[o]),r+=t[o].value;continue}t[o].isGrouped=!1,i.push(t[o])}else{if(t[o].value<=e.value){n.push(t[o]),r+=t[o].value;continue}t[o].isGrouped=!1,i.push(t[o])}return n.length&&i.push({color:e.color,label:e.label,value:r,isGrouped:!0,groupedData:n}),i},showPoint:function(t,e,a){t.append("circle").attr("cx",e).attr("cy",a).attr("r",2).style("fill","black")},isFunction:function(t){return t&&"[object Function]"==={}.toString.call(t)},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)}},y=function t(){var e,a,i,n,r,o,s=arguments[0]||{},l=1,u=arguments.length,c=!1,d=Object.prototype.toString,p=Object.prototype.hasOwnProperty,g={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},f={isFunction:function(t){return"function"===f.type(t)},isArray:Array.isArray||function(t){return"array"===f.type(t)},isWindow:function(t){return null!==t&&t===t.window},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},type:function(t){return null===t?String(t):g[d.call(t)]||"object"},isPlainObject:function(t){if(!t||"object"!==f.type(t)||t.nodeType)return!1;try{if(t.constructor&&!p.call(t,"constructor")&&!p.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}var e;for(e in t);return void 0===e||p.call(t,e)}};for("boolean"==typeof s&&(c=s,s=arguments[1]||{},l=2),"object"===h(s)||f.isFunction(s)||(s={}),u===l&&(s=this,--l);l<u;l++)if(null!==(e=arguments[l]))for(a in e)i=s[a],s!==(n=e[a])&&(c&&n&&(f.isPlainObject(n)||(r=f.isArray(n)))?(r?(r=!1,o=i&&f.isArray(i)?i:[]):o=i&&f.isPlainObject(i)?i:{},s[a]=t(c,o,n)):void 0!==n&&(s[a]=n));return s},v={toRadians:function(t){return t*(Math.PI/180)},toDegrees:function(t){return t*(180/Math.PI)},computePieRadius:function(t){var e=t.options.size,a=t.options.misc.canvasPadding,i=e.canvasWidth-a.left-a.right,n=e.canvasHeight-a.top-a.bottom;"pie-center"!==t.options.header.location&&(n-=t.textComponents.headerHeight),t.textComponents.footer.exists&&(n-=t.textComponents.footer.h);var r,o,s=(i<(n=n<0?0:n)?i:n)/("none"===t.options.labels.outer.format?2:3);if(null!==e.pieOuterRadius)if(/%/.test(e.pieOuterRadius)){o=(o=(o=parseInt(e.pieOuterRadius.replace(/[\D]/,""),10))>99?99:o)<0?0:o;var l=i<n?i:n;if("none"!==t.options.labels.outer.format){var u=2*parseInt(t.options.labels.outer.pieDistance,10);l-u>0&&(l-=u)}s=Math.floor(l/100*o)/2}else s=parseInt(e.pieOuterRadius,10);/%/.test(e.pieInnerRadius)?(o=(o=(o=parseInt(e.pieInnerRadius.replace(/[\D]/,""),10))>99?99:o)<0?0:o,r=Math.floor(s/100*o)):r=parseInt(e.pieInnerRadius,10),t.innerRadius=r,t.outerRadius=s},getTotalPieSize:function(t){for(var e=0,a=0;a<t.length;a++)e+=t[a].value;return e},sortPieData:function(t){var e=t.options.data.content;switch(t.options.data.sortOrder){case"none":break;case"random":e=x.shuffleArray(e);break;case"value-asc":e.sort((function(t,e){return t.value<e.value?-1:1}));break;case"value-desc":e.sort((function(t,e){return t.value<e.value?1:-1}));break;case"label-asc":e.sort((function(t,e){return t.label.toLowerCase()>e.label.toLowerCase()?1:-1}));break;case"label-desc":e.sort((function(t,e){return t.label.toLowerCase()<e.label.toLowerCase()?1:-1}))}return e},getPieTranslateCenter:function(t){return"translate("+t.x+","+t.y+")"},calculatePieCenter:function(t){var e=t.options.misc.pieCenterOffset,a=t.textComponents.title.exists&&"pie-center"!==t.options.header.location,i=t.textComponents.subtitle.exists&&"pie-center"!==t.options.header.location,n=t.options.misc.canvasPadding.top;a&&i?n+=t.textComponents.title.h+t.options.header.titleSubtitlePadding+t.textComponents.subtitle.h:a?n+=t.textComponents.title.h:i&&(n+=t.textComponents.subtitle.h);var r=0;t.textComponents.footer.exists&&(r=t.textComponents.footer.h+t.options.misc.canvasPadding.bottom);var o=(t.options.size.canvasWidth-t.options.misc.canvasPadding.left-t.options.misc.canvasPadding.right)/2+t.options.misc.canvasPadding.left,s=(t.options.size.canvasHeight-r-n)/2+n;o+=e.x,s+=e.y,t.pieCenter={x:o,y:s}},rotate:function(t,e,a,i,n){n=n*Math.PI/180;var r=Math.cos,o=Math.sin;return{x:(t-a)*r(n)-(e-i)*o(n)+a,y:(t-a)*o(n)+(e-i)*r(n)+i}},translate:function(t,e,a,i){var n=v.toRadians(i);return{x:t+a*Math.sin(n),y:e-a*Math.cos(n)}},pointIsInArc:function(t,e,a){var i=a.innerRadius()(e),n=a.outerRadius()(e),r=a.startAngle()(e),o=a.endAngle()(e),s=t.x*t.x+t.y*t.y,l=Math.atan2(t.x,-t.y);return l=l<0?l+2*Math.PI:l,i*i<=s&&s<=n*n&&r<=l&&l<=o}},b={add:function(t,e,a){var i=b.getIncludes(a),n=t.options.labels,r=t.svg.insert("g","."+t.cssPrefix+"labels-"+e).attr("class",t.cssPrefix+"labels-"+e).selectAll("."+t.cssPrefix+"labelGroup-"+e).data(t.options.data.content).enter().append("g").attr("id",(function(a,i){return t.cssPrefix+"labelGroup"+i+"-"+e})).attr("data-index",(function(t,e){return e})).attr("class",t.cssPrefix+"labelGroup-"+e).style("opacity",0),o={section:e,sectionDisplayType:a};i.mainLabel&&r.append("text").attr("id",(function(a,i){return t.cssPrefix+"segmentMainLabel"+i+"-"+e})).attr("class",t.cssPrefix+"segmentMainLabel-"+e).text((function(t,e){var a=t.label;return n.formatter?(o.index=e,o.part="mainLabel",o.value=t.value,o.label=a,a=n.formatter(o)):n.truncation.enabled&&t.label.length>n.truncation.truncateLength&&(a=t.label.substring(0,n.truncation.truncateLength)+"..."),a})).style("font-size",n.mainLabel.fontSize+"px").style("font-family",n.mainLabel.font).style("fill",n.mainLabel.color),i.percentage&&r.append("text").attr("id",(function(a,i){return t.cssPrefix+"segmentPercentage"+i+"-"+e})).attr("class",t.cssPrefix+"segmentPercentage-"+e).text((function(t,e){var a=t.percentage;return n.formatter?(o.index=e,o.part="percentage",o.value=t.value,o.label=t.percentage,a=n.formatter(o)):a+="%",a})).style("font-size",n.percentage.fontSize+"px").style("font-family",n.percentage.font).style("fill",n.percentage.color),i.value&&r.append("text").attr("id",(function(a,i){return t.cssPrefix+"segmentValue"+i+"-"+e})).attr("class",t.cssPrefix+"segmentValue-"+e).text((function(t,e){return o.index=e,o.part="value",o.value=t.value,o.label=t.value,n.formatter?n.formatter(o,t.value):t.value})).style("font-size",n.value.fontSize+"px").style("font-family",n.value.font).style("fill",n.value.color)},positionLabelElements:function(t,e,a){b["dimensions-"+e]=[],o.selectAll("."+t.cssPrefix+"labelGroup-"+e).each((function(a,i){var n=o.select(this).selectAll("."+t.cssPrefix+"segmentMainLabel-"+e),r=o.select(this).selectAll("."+t.cssPrefix+"segmentPercentage-"+e),s=o.select(this).selectAll("."+t.cssPrefix+"segmentValue-"+e);b["dimensions-"+e].push({mainLabel:null!==n.node()?n.node().getBBox():null,percentage:null!==r.node()?r.node().getBBox():null,value:null!==s.node()?s.node().getBBox():null})}));var i=b["dimensions-"+e];switch(a){case"label-value1":o.selectAll("."+t.cssPrefix+"segmentValue-"+e).attr("dx",(function(t,e){return i[e].mainLabel.width+5}));break;case"label-value2":o.selectAll("."+t.cssPrefix+"segmentValue-"+e).attr("dy",(function(t,e){return i[e].mainLabel.height}));break;case"label-percentage1":o.selectAll("."+t.cssPrefix+"segmentPercentage-"+e).attr("dx",(function(t,e){return i[e].mainLabel.width+5}));break;case"label-percentage2":o.selectAll("."+t.cssPrefix+"segmentPercentage-"+e).attr("dx",(function(t,e){return i[e].mainLabel.width/2-i[e].percentage.width/2})).attr("dy",(function(t,e){return i[e].mainLabel.height}));break;case"value-percentage":o.selectAll("."+t.cssPrefix+"segmentValue-"+e).attr("dx",(function(t,e){return i[e].percentage.width/2-i[e].value.width/2})).attr("dy",(function(t,e){return-i[e].percentage.height/2})),o.selectAll("."+t.cssPrefix+"segmentPercentage-"+e).attr("dy",(function(t,e){return i[e].percentage.height/2}));break;case"percentage-value":o.selectAll("."+t.cssPrefix+"segmentValue-"+e).attr("dx",(function(t,e){return i[e].percentage.width/2-i[e].value.width/2})).attr("dy",(function(t,e){return i[e].percentage.height/2})),o.selectAll("."+t.cssPrefix+"segmentPercentage-"+e).attr("dy",(function(t,e){return-i[e].percentage.height/2}))}},computeLabelLinePositions:function(t){t.lineCoordGroups=[],o.selectAll("."+t.cssPrefix+"labelGroup-outer").each((function(e,a){return b.computeLinePosition(t,a)}))},computeLinePosition:function(t,e){var a,i,n,r,o=_.getSegmentAngle(e,t.options.data.content,t.totalSize,{midpoint:!0}),s=v.rotate(t.pieCenter.x,t.pieCenter.y-t.outerRadius,t.pieCenter.x,t.pieCenter.y,o),l=t.outerLabelGroupData[e].h/5,u=Math.floor(o/90);switch(2===u&&180===o&&(u=1),u){case 0:a=t.outerLabelGroupData[e].x-6-(t.outerLabelGroupData[e].x-6-s.x)/2,i=t.outerLabelGroupData[e].y+(s.y-t.outerLabelGroupData[e].y)/4,n=t.outerLabelGroupData[e].x-6,r=t.outerLabelGroupData[e].y-l;break;case 1:a=s.x+(t.outerLabelGroupData[e].x-s.x)/4,i=s.y+(t.outerLabelGroupData[e].y-s.y)/4,n=t.outerLabelGroupData[e].x-6,r=t.outerLabelGroupData[e].y-l;break;case 2:var c=t.outerLabelGroupData[e].x+t.outerLabelGroupData[e].w+6;a=s.x-(s.x-c)/4,i=s.y+(t.outerLabelGroupData[e].y-s.y)/4,n=t.outerLabelGroupData[e].x+t.outerLabelGroupData[e].w+6,r=t.outerLabelGroupData[e].y-l;break;case 3:var h=t.outerLabelGroupData[e].x+t.outerLabelGroupData[e].w+6;a=h+(s.x-h)/4,i=t.outerLabelGroupData[e].y+(s.y-t.outerLabelGroupData[e].y)/4,n=t.outerLabelGroupData[e].x+t.outerLabelGroupData[e].w+6,r=t.outerLabelGroupData[e].y-l}"straight"===t.options.labels.lines.style?t.lineCoordGroups[e]=[{x:s.x,y:s.y},{x:n,y:r}]:t.lineCoordGroups[e]=[{x:s.x,y:s.y},{x:a,y:i},{x:n,y:r}]},addLabelLines:function(t){var e=t.svg.insert("g","."+t.cssPrefix+"pieChart").attr("class",t.cssPrefix+"lineGroups").style("opacity",0).selectAll("."+t.cssPrefix+"lineGroup").data(t.lineCoordGroups).enter().append("g").attr("class",t.cssPrefix+"lineGroup"),a=o.line().curve(o.curveBasis).x((function(t){return t.x})).y((function(t){return t.y}));e.append("path").attr("d",a).attr("stroke",(function(e,a){return"segment"===t.options.labels.lines.color?t.options.colors[a]:t.options.labels.lines.color})).attr("stroke-width",1).attr("fill","none").style("opacity",(function(e,a){var i=t.options.labels.outer.hideWhenLessThanPercentage;return null!==i&&e.percentage<i||""===t.options.data.content[a].label?0:1}))},positionLabelGroups:function(t,e){"none"!==t.options.labels[e].format&&o.selectAll("."+t.cssPrefix+"labelGroup-"+e).style("opacity",0).attr("transform",(function(a,i){var n,r;if("outer"===e)n=t.outerLabelGroupData[i].x,r=t.outerLabelGroupData[i].y;else{var o=y(!0,{},t.pieCenter);if(t.innerRadius>0){var s=_.getSegmentAngle(i,t.options.data.content,t.totalSize,{midpoint:!0}),l=v.translate(t.pieCenter.x,t.pieCenter.y,t.innerRadius,s);o.x=l.x,o.y=l.y}var u=x.getDimensions(t.cssPrefix+"labelGroup"+i+"-inner"),c=u.w/2,h=u.h/4;n=o.x+(t.lineCoordGroups[i][0].x-o.x)/1.8,r=o.y+(t.lineCoordGroups[i][0].y-o.y)/1.8,n-=c,r+=h}return"translate("+n+","+r+")"}))},fadeInLabelsAndLines:function(t){var e="default"===t.options.effects.load.effect?t.options.effects.load.speed:1;setTimeout((function(){var e="default"===t.options.effects.load.effect?400:1;o.selectAll("."+t.cssPrefix+"labelGroup-outer").transition().duration(e).style("opacity",(function(e,a){var i=t.options.labels.outer.hideWhenLessThanPercentage;return null!==i&&e.percentage<i?0:1})),o.selectAll("."+t.cssPrefix+"labelGroup-inner").transition().duration(e).style("opacity",(function(e,a){var i=t.options.labels.inner.hideWhenLessThanPercentage;return null!==i&&e.percentage<i?0:1})),o.selectAll("g."+t.cssPrefix+"lineGroups").transition().duration(e).style("opacity",1),x.isFunction(t.options.callbacks.onload)&&setTimeout((function(){try{t.options.callbacks.onload()}catch(t){}}),e)}),e)},getIncludes:function(t){var e=!1,a=!1,i=!1;switch(t){case"label":e=!0;break;case"value":a=!0;break;case"percentage":i=!0;break;case"label-value1":case"label-value2":e=!0,a=!0;break;case"label-percentage1":case"label-percentage2":e=!0,i=!0;break;case"value-percentage":case"percentage-value":a=!0,i=!0}return{mainLabel:e,value:a,percentage:i}},computeOuterLabelCoords:function(t){t.svg.selectAll("."+t.cssPrefix+"labelGroup-outer").each((function(e,a){return b.getIdealOuterLabelPositions(t,a)})),b.resolveOuterLabelCollisions(t)},resolveOuterLabelCollisions:function(t){if("none"!==t.options.labels.outer.format){var e=t.options.data.content.length;b.checkConflict(t,0,"clockwise",e),b.checkConflict(t,e-1,"anticlockwise",e)}},checkConflict:function(t,e,a,i){var n,r;if(!(i<=1)){var o=t.outerLabelGroupData[e].hs;if(!("clockwise"===a&&"right"!==o||"anticlockwise"===a&&"left"!==o)){var s="clockwise"===a?e+1:e-1,l=t.outerLabelGroupData[e],u=t.outerLabelGroupData[s],c={labelHeights:t.outerLabelGroupData[0].h,center:t.pieCenter,lineLength:t.outerRadius+t.options.labels.outer.pieDistance,heightChange:t.outerLabelGroupData[0].h+1};if("clockwise"===a){for(n=0;n<=e;n++)if(r=t.outerLabelGroupData[n],!b.isLabelHidden(t,n)&&x.rectIntersect(r,u)){b.adjustLabelPos(t,s,l,c);break}}else for(n=i-1;n>=e;n--)if(r=t.outerLabelGroupData[n],!b.isLabelHidden(t,n)&&x.rectIntersect(r,u)){b.adjustLabelPos(t,s,l,c);break}b.checkConflict(t,s,a,i)}}},isLabelHidden:function(t,e){var a=t.options.labels.outer.hideWhenLessThanPercentage;return null!==a&&d.percentage<a||""===t.options.data.content[e].label},adjustLabelPos:function(t,e,a,i){var n,r,o,s;s=a.y+i.heightChange,r=i.center.y-s,n=Math.abs(i.lineLength)>Math.abs(r)?Math.sqrt(i.lineLength*i.lineLength-r*r):Math.sqrt(r*r-i.lineLength*i.lineLength),o="right"===a.hs?i.center.x+n:i.center.x-n-t.outerLabelGroupData[e].w,t.outerLabelGroupData[e].x=o,t.outerLabelGroupData[e].y=s},getIdealOuterLabelPositions:function(t,e){var a=o.select("#"+t.cssPrefix+"labelGroup"+e+"-outer").node();if(a){var i=a.getBBox(),n=_.getSegmentAngle(e,t.options.data.content,t.totalSize,{midpoint:!0}),r=t.pieCenter.x,s=t.pieCenter.y-(t.outerRadius+t.options.labels.outer.pieDistance),l=v.rotate(r,s,t.pieCenter.x,t.pieCenter.y,n),u="right";n>180?(l.x-=i.width+8,u="left"):l.x+=8,t.outerLabelGroupData[e]={x:l.x,y:l.y,w:i.width,h:i.height,hs:u}}}},_={effectMap:{none:o.easeLinear,bounce:o.easeBounce,linear:o.easeLinear,sin:o.easeSin,elastic:o.easeElastic,back:o.easeBack,quad:o.easeQuad,circle:o.easeCircle,exp:o.easeExp},create:function(t){var e=t.pieCenter,a=t.options.colors,i=t.options.effects.load,n=t.options.misc.colors.segmentStroke,r=t.svg.insert("g","#"+t.cssPrefix+"title").attr("transform",(function(){return v.getPieTranslateCenter(e)})).attr("class",t.cssPrefix+"pieChart"),s=o.arc().innerRadius(t.innerRadius).outerRadius(t.outerRadius).startAngle(0).endAngle((function(e){return e.value/t.totalSize*2*Math.PI})),l=r.selectAll("."+t.cssPrefix+"arc").data(t.options.data.content).enter().append("g").attr("class",t.cssPrefix+"arc"),u=i.speed;"none"===i.effect&&(u=0),l.append("path").attr("id",(function(e,a){return t.cssPrefix+"segment"+a})).attr("fill",(function(e,i){var n=a[i];return t.options.misc.gradient.enabled&&(n="url(#"+t.cssPrefix+"grad"+i+")"),n})).style("stroke",n).style("stroke-width",1).transition().ease(o.easeCubicInOut).duration(u).attr("data-index",(function(t,e){return e})).attrTween("d",(function(e){var a=o.interpolate({value:0},e);return function(e){return t.arc(a(e))}})),t.svg.selectAll("g."+t.cssPrefix+"arc").attr("transform",(function(e,a){var i=0;return a>0&&(i=_.getSegmentAngle(a-1,t.options.data.content,t.totalSize)),"rotate("+i+")"})),t.arc=s},addGradients:function(t){var e=t.svg.append("defs").selectAll("radialGradient").data(t.options.data.content).enter().append("radialGradient").attr("gradientUnits","userSpaceOnUse").attr("cx",0).attr("cy",0).attr("r","120%").attr("id",(function(e,a){return t.cssPrefix+"grad"+a}));e.append("stop").attr("offset","0%").style("stop-color",(function(e,a){return t.options.colors[a]})),e.append("stop").attr("offset",t.options.misc.gradient.percentage+"%").style("stop-color",t.options.misc.gradient.color)},addSegmentEventHandlers:function(t){var e=o.selectAll("."+t.cssPrefix+"arc,."+t.cssPrefix+"labelGroup-inner,."+t.cssPrefix+"labelGroup-outer");e.on("click",(function(){var e,a=o.select(this);if(a.attr("class")===t.cssPrefix+"arc")e=a.select("path");else{var i=a.attr("data-index");e=o.select("#"+t.cssPrefix+"segment"+i)}var n=e.attr("class")===t.cssPrefix+"expanded";_.onSegmentEvent(t,t.options.callbacks.onClickSegment,e,n),"none"!==t.options.effects.pullOutSegmentOnClick.effect&&(n?_.closeSegment(t,e.node()):_.openSegment(t,e.node()))})),e.on("mouseover",(function(){var e,a,i=o.select(this);if(i.attr("class")===t.cssPrefix+"arc"?e=i.select("path"):(a=i.attr("data-index"),e=o.select("#"+t.cssPrefix+"segment"+a)),t.options.effects.highlightSegmentOnMouseover){a=e.attr("data-index");var n=t.options.colors[a];e.style("fill",x.getColorShade(n,t.options.effects.highlightLuminosity))}t.options.tooltips.enabled&&(a=e.attr("data-index"),S.showTooltip(t,a));var r=e.attr("class")===t.cssPrefix+"expanded";_.onSegmentEvent(t,t.options.callbacks.onMouseoverSegment,e,r)})),e.on("mousemove",(function(){S.moveTooltip(t)})),e.on("mouseout",(function(){var e,a,i=o.select(this);if(i.attr("class")===t.cssPrefix+"arc"?e=i.select("path"):(a=i.attr("data-index"),e=o.select("#"+t.cssPrefix+"segment"+a)),t.options.effects.highlightSegmentOnMouseover){a=e.attr("data-index");var n=t.options.colors[a];t.options.misc.gradient.enabled&&(n="url(#"+t.cssPrefix+"grad"+a+")"),e.style("fill",n)}t.options.tooltips.enabled&&(a=e.attr("data-index"),S.hideTooltip(t,a));var r=e.attr("class")===t.cssPrefix+"expanded";_.onSegmentEvent(t,t.options.callbacks.onMouseoutSegment,e,r)}))},onSegmentEvent:function(t,e,a,i){if(x.isFunction(e)){var n=parseInt(a.attr("data-index"),10);e({segment:a.node(),index:n,expanded:i,data:t.options.data.content[n]})}},openSegment:function(t,e){t.isOpeningSegment||(t.isOpeningSegment=!0,_.maybeCloseOpenSegment(t),o.select(e).transition().ease(_.effectMap[t.options.effects.pullOutSegmentOnClick.effect]).duration(t.options.effects.pullOutSegmentOnClick.speed).attr("transform",(function(e,a){var i=t.arc.centroid(e),n=i[0],r=i[1],o=Math.sqrt(n*n+r*r),s=parseInt(t.options.effects.pullOutSegmentOnClick.size,10);return"translate("+n/o*s+","+r/o*s+")"})).on("end",(function(a,i){t.currentlyOpenSegment=e,t.isOpeningSegment=!1,o.select(e).attr("class",t.cssPrefix+"expanded")})))},maybeCloseOpenSegment:function(t){o.selectAll("."+t.cssPrefix+"expanded").size()>0&&_.closeSegment(t,o.select("."+t.cssPrefix+"expanded").node())},closeSegment:function(t,e){o.select(e).transition().duration(400).attr("transform","translate(0,0)").on("end",(function(a,i){o.select(e).attr("class",""),t.currentlyOpenSegment=null}))},getCentroid:function(t){var e=t.getBBox();return{x:e.x+e.width/2,y:e.y+e.height/2}},getSegmentAngle:function(t,e,a,i){var n,r=y({compounded:!0,midpoint:!1},i),o=e[t].value;if(r.compounded){n=0;for(var s=0;s<=t;s++)n+=e[s].value}void 0===n&&(n=o);var l=n/a*360;r.midpoint&&(l-=o/a*360/2);return l}},w={offscreenCoord:-1e4,addTitle:function(t){t.svg.selectAll("."+t.cssPrefix+"title").data([t.options.header.title]).enter().append("text").text((function(t){return t.text})).attr("id",t.cssPrefix+"title").attr("class",t.cssPrefix+"title").attr("x",w.offscreenCoord).attr("y",w.offscreenCoord).attr("text-anchor",(function(){return"top-center"===t.options.header.location||"pie-center"===t.options.header.location?"middle":"left"})).attr("fill",(function(t){return t.color})).style("font-size",(function(t){return t.fontSize+"px"})).style("font-family",(function(t){return t.font}))},positionTitle:function(t){var e,a=t.textComponents,i=t.options.header.location,n=t.options.misc.canvasPadding,r=t.options.size.canvasWidth,o=t.options.header.titleSubtitlePadding;e="top-left"===i?n.left:(r-n.right)/2+n.left,e+=t.options.misc.pieCenterOffset.x;var s=n.top+a.title.h;"pie-center"===i&&(s=t.pieCenter.y,a.subtitle.exists?s=s-(a.title.h+o+a.subtitle.h)/2+a.title.h:s+=a.title.h/4);t.svg.select("#"+t.cssPrefix+"title").attr("x",e).attr("y",s)},addSubtitle:function(t){var e=t.options.header.location;t.svg.selectAll("."+t.cssPrefix+"subtitle").data([t.options.header.subtitle]).enter().append("text").text((function(t){return t.text})).attr("x",w.offscreenCoord).attr("y",w.offscreenCoord).attr("id",t.cssPrefix+"subtitle").attr("class",t.cssPrefix+"subtitle").attr("text-anchor",(function(){return"top-center"===e||"pie-center"===e?"middle":"left"})).attr("fill",(function(t){return t.color})).style("font-size",(function(t){return t.fontSize+"px"})).style("font-family",(function(t){return t.font}))},positionSubtitle:function(t){var e,a=t.options.misc.canvasPadding,i=t.options.size.canvasWidth;e="top-left"===t.options.header.location?a.left:(i-a.right)/2+a.left,e+=t.options.misc.pieCenterOffset.x;var n=w.getHeaderHeight(t);t.svg.select("#"+t.cssPrefix+"subtitle").attr("x",e).attr("y",n)},addFooter:function(t){t.svg.selectAll("."+t.cssPrefix+"footer").data([t.options.footer]).enter().append("text").text((function(t){return t.text})).attr("x",w.offscreenCoord).attr("y",w.offscreenCoord).attr("id",t.cssPrefix+"footer").attr("class",t.cssPrefix+"footer").attr("text-anchor",(function(){var e="left";return"bottom-center"===t.options.footer.location?e="middle":"bottom-right"===t.options.footer.location&&(e="left"),e})).attr("fill",(function(t){return t.color})).style("font-size",(function(t){return t.fontSize+"px"})).style("font-family",(function(t){return t.font}))},positionFooter:function(t){var e,a=t.options.footer.location,i=t.textComponents.footer.w,n=t.options.size.canvasWidth,r=t.options.size.canvasHeight,o=t.options.misc.canvasPadding;e="bottom-left"===a?o.left:"bottom-right"===a?n-i-o.right:n/2,t.svg.select("#"+t.cssPrefix+"footer").attr("x",e).attr("y",r-o.bottom)},getHeaderHeight:function(t){var e;if(t.textComponents.title.exists){var a=t.textComponents.title.h+t.options.header.titleSubtitlePadding+t.textComponents.subtitle.h;e="pie-center"===t.options.header.location?t.pieCenter.y-a/2+a:a+t.options.misc.canvasPadding.top}else if("pie-center"===t.options.header.location){var i=t.options.misc.canvasPadding.bottom+t.textComponents.footer.h;e=(t.options.size.canvasHeight-i)/2+t.options.misc.canvasPadding.top+t.textComponents.subtitle.h/2}else e=t.options.misc.canvasPadding.top+t.textComponents.subtitle.h;return e}},S={addTooltips:function(t){var e=t.svg.insert("g").attr("class",t.cssPrefix+"tooltips");e.selectAll("."+t.cssPrefix+"tooltip").data(t.options.data.content).enter().append("g").attr("class",t.cssPrefix+"tooltip").attr("id",(function(e,a){return t.cssPrefix+"tooltip"+a})).style("opacity",0).append("rect").attr("rx",t.options.tooltips.styles.borderRadius).attr("ry",t.options.tooltips.styles.borderRadius).attr("x",-t.options.tooltips.styles.padding).attr("opacity",t.options.tooltips.styles.backgroundOpacity).style("fill",t.options.tooltips.styles.backgroundColor),e.selectAll("."+t.cssPrefix+"tooltip").data(t.options.data.content).append("text").attr("fill",(function(e){return t.options.tooltips.styles.color})).style("font-size",(function(e){return t.options.tooltips.styles.fontSize})).style("font-family",(function(e){return t.options.tooltips.styles.font})).text((function(e,a){var i=t.options.tooltips.string;return"caption"===t.options.tooltips.type&&(i=e.caption),S.replacePlaceholders(t,i,a,{label:e.label,value:e.value,percentage:e.percentage})})),e.selectAll("."+t.cssPrefix+"tooltip rect").attr("width",(function(e,a){return x.getDimensions(t.cssPrefix+"tooltip"+a).w+2*t.options.tooltips.styles.padding})).attr("height",(function(e,a){return x.getDimensions(t.cssPrefix+"tooltip"+a).h+2*t.options.tooltips.styles.padding})).attr("y",(function(e,a){return-x.getDimensions(t.cssPrefix+"tooltip"+a).h/2+1}))},showTooltip:function(t,e){var a=t.options.tooltips.styles.fadeInSpeed;S.currentTooltip===e&&(a=1),S.currentTooltip=e,o.select("#"+t.cssPrefix+"tooltip"+e).transition().duration(a).style("opacity",(function(){return 1})),S.moveTooltip(t)},moveTooltip:function(t){o.selectAll("#"+t.cssPrefix+"tooltip"+S.currentTooltip).attr("transform",(function(e){var a=o.pointer(event,this.parentNode);return"translate("+(a[0]+t.options.tooltips.styles.padding+2)+","+(a[1]-2*t.options.tooltips.styles.padding-2)+")"}))},hideTooltip:function(t,e){o.select("#"+t.cssPrefix+"tooltip"+e).style("opacity",(function(){return 0})),o.select("#"+t.cssPrefix+"tooltip"+S.currentTooltip).attr("transform",(function(e,a){return"translate("+(t.options.size.canvasWidth+1e3)+","+(t.options.size.canvasHeight+1e3)+")"}))},replacePlaceholders:function(t,e,a,i){x.isFunction(t.options.tooltips.placeholderParser)&&t.options.tooltips.placeholderParser(a,i);return e.replace(/\{(\w+)\}/g,(function(t){var e=arguments[1];return i.hasOwnProperty(e)?i[arguments[1]]:arguments[0]}))}},k=function(t,e){if(this.element=t,"string"==typeof t){var a=t.replace(/^#/,"");this.element=document.getElementById(a)}var i={};y(!0,i,f,e),this.options=i,null!==this.options.misc.cssPrefix?this.cssPrefix=this.options.misc.cssPrefix:(this.cssPrefix="p"+g+"_",g++),m(this)&&(o.select(this.element).attr(p,"0.2.1"),T.call(this),P.call(this))};k.prototype.recreate=function(){m(this)&&(T.call(this),P.call(this))},k.prototype.redraw=function(){this.element.innerHTML="",P.call(this)},k.prototype.destroy=function(){this.element.innerHTML="",o.select(this.element).attr(p,null)},k.prototype.getOpenSegment=function(){var t=this.currentlyOpenSegment;if(null!=t){var e=parseInt(o.select(t).attr("data-index"),10);return{element:t,index:e,data:this.options.data.content[e]}}return null},k.prototype.openSegment=function(t){(t=parseInt(t,10))<0||t>this.options.data.content.length-1||_.openSegment(this,o.select("#"+this.cssPrefix+"segment"+t).node())},k.prototype.closeSegment=function(t){_.maybeCloseOpenSegment(t)},k.prototype.updateProp=function(t,e){switch(t){case"header.title.text":var a=x.processObj(this.options,t);x.processObj(this.options,t,e),o.select("#"+this.cssPrefix+"title").html(e),(""===a&&""!==e||""!==a&&""===e)&&this.redraw();break;case"header.subtitle.text":var i=x.processObj(this.options,t);x.processObj(this.options,t,e),o.select("#"+this.cssPrefix+"subtitle").html(e),(""===i&&""!==e||""!==i&&""===e)&&this.redraw();break;case"callbacks.onload":case"callbacks.onMouseoverSegment":case"callbacks.onMouseoutSegment":case"callbacks.onClickSegment":case"effects.pullOutSegmentOnClick.effect":case"effects.pullOutSegmentOnClick.speed":case"effects.pullOutSegmentOnClick.size":case"effects.highlightSegmentOnMouseover":case"effects.highlightLuminosity":x.processObj(this.options,t,e);break;default:x.processObj(this.options,t,e),this.destroy(),this.recreate()}};var T=function(){this.options.data.content=v.sortPieData(this),this.options.data.smallSegmentGrouping.enabled&&(this.options.data.content=x.applySmallSegmentGrouping(this.options.data.content,this.options.data.smallSegmentGrouping)),this.options.colors=x.initSegmentColors(this),this.totalSize=v.getTotalPieSize(this.options.data.content);for(var t=this.options.labels.percentage.decimalPlaces,e=0;e<this.options.data.content.length;e++)this.options.data.content[e].percentage=C(this.options.data.content[e].value,this.totalSize,t);for(var a=0,i=0;i<this.options.data.content.length;i++)i===this.options.data.content.length-1&&(this.options.data.content[i].percentage=(100-a).toFixed(t)),a+=parseFloat(this.options.data.content[i].percentage)},P=function(){this.svg=x.addSVGSpace(this),this.textComponents={headerHeight:0,title:{exists:""!==this.options.header.title.text,h:0,w:0},subtitle:{exists:""!==this.options.header.subtitle.text,h:0,w:0},footer:{exists:""!==this.options.footer.text,h:0,w:0}},this.outerLabelGroupData=[],this.textComponents.title.exists&&w.addTitle(this),this.textComponents.subtitle.exists&&w.addSubtitle(this),w.addFooter(this);var t=this;x.whenIdExists(this.cssPrefix+"footer",(function(){w.positionFooter(t);var e=x.getDimensions(t.cssPrefix+"footer");t.textComponents.footer.h=e.h,t.textComponents.footer.w=e.w}));var e=[];this.textComponents.title.exists&&e.push(this.cssPrefix+"title"),this.textComponents.subtitle.exists&&e.push(this.cssPrefix+"subtitle"),this.textComponents.footer.exists&&e.push(this.cssPrefix+"footer"),x.whenElementsExist(e,(function(){if(t.textComponents.title.exists){var e=x.getDimensions(t.cssPrefix+"title");t.textComponents.title.h=e.h,t.textComponents.title.w=e.w}if(t.textComponents.subtitle.exists){var a=x.getDimensions(t.cssPrefix+"subtitle");t.textComponents.subtitle.h=a.h,t.textComponents.subtitle.w=a.w}if(t.textComponents.title.exists||t.textComponents.subtitle.exists){var i=0;t.textComponents.title.exists&&(i+=t.textComponents.title.h,t.textComponents.subtitle.exists&&(i+=t.options.header.titleSubtitlePadding)),t.textComponents.subtitle.exists&&(i+=t.textComponents.subtitle.h),t.textComponents.headerHeight=i}v.computePieRadius(t),v.calculatePieCenter(t),w.positionTitle(t),w.positionSubtitle(t),t.options.misc.gradient.enabled&&_.addGradients(t),_.create(t),b.add(t,"inner",t.options.labels.inner.format),b.add(t,"outer",t.options.labels.outer.format),b.positionLabelElements(t,"inner",t.options.labels.inner.format),b.positionLabelElements(t,"outer",t.options.labels.outer.format),b.computeOuterLabelCoords(t),b.positionLabelGroups(t,"outer"),b.computeLabelLinePositions(t),t.options.labels.lines.enabled&&"none"!==t.options.labels.outer.format&&b.addLabelLines(t),b.positionLabelGroups(t,"inner"),b.fadeInLabelsAndLines(t),t.options.tooltips.enabled&&S.addTooltips(t),_.addSegmentEventHandlers(t)}))},C=function(t,e,a){var i=t/e;return a<=0?Math.round(100*i):(100*i).toFixed(a)},F=k,A=a(45546),L=a(69264),M=a(22166),D=a.n(M),B={};function I(t,e,a,i){if(t.endAngle-t.startAngle==0)return"M 0 0";var n=e*Math.cos(t.startAngle),r=a*Math.sin(t.startAngle),o=e*Math.cos(6.283185307179587===t.endAngle?6.283185307179586:t.endAngle),s=a*Math.sin(6.283185307179587===t.endAngle?6.283185307179586:t.endAngle),l=[];return l.push("M",n,r,"A",e,a,"0",t.endAngle-t.startAngle>Math.PI?1:0,"1",o,s,"L",i*o,i*s),l.push("A",i*e,i*a,"0",t.endAngle-t.startAngle>Math.PI?1:0,"0",i*n,i*r,"z"),l.join(" ")}function V(t,e,a,i){var n=t.startAngle>Math.PI?Math.PI:t.startAngle,r=t.endAngle>Math.PI?Math.PI:t.endAngle,o=e*Math.cos(n),s=a*Math.sin(n),l=e*Math.cos(r),u=a*Math.sin(r),c=[];return c.push("M",o,i+s,"A",e,a,"0 0 1",l,i+u,"L",l,u,"A",e,a,"0 0 0",o,s,"z"),c.join(" ")}function O(t,e,a,i,n){var r=t.startAngle<Math.PI?Math.PI:t.startAngle,o=t.endAngle<Math.PI?Math.PI:t.endAngle,s=n*e*Math.cos(r),l=n*a*Math.sin(r),u=n*e*Math.cos(o),c=n*a*Math.sin(o),h=[];return h.push("M",s,l,"A",n*e,n*a,"0 0 1",u,c,"L",u,i+c,"A",n*e,n*a,"0 0 0",s,i+l,"z"),h.join(" ")}function E(t,e,a,i,n,r,o){t.data(e).enter().append("text").attr("class","percent").attr("x",(function(t){var e=AJS.$("<span></span>").text(o(t));e.appendTo("body");var n=e.width();e.remove();var r=i*a,s=Math.cos(.5*(t.startAngle+t.endAngle));return.5*(i-r)*s+r*s-n/2})).attr("y",(function(t){var e=n*a,i=Math.sin(.5*(t.startAngle+t.endAngle));return.5*(n-e)*i+e*i+r})).text((function(t){return o(t)})).style("fill",(function(t){return t.data.textColor})).each((function(t){this._current=t}))}B.getPercent=function(t){return Math.round(1e3*(t.endAngle-t.startAngle)/(2*Math.PI))/10+"%"},B.transition=function(t,e,a,i,n,r){var s=o.pie().sort(null).value((function(t){return t.value}))(e);o.select("#"+t).selectAll(".innerSlice").data(s).transition().duration(750).attrTween("d",(function(t){var e=o.interpolate(this._current,t);return this._current=e(0),function(t){return O(e(t),a+.5,i+.5,n,r)}})),o.select("#"+t).selectAll(".topSlice").data(s).transition().duration(750).attrTween("d",(function(t){var e=o.interpolate(this._current,t);return this._current=e(0),function(t){return I(e(t),a,i,r)}})),o.select("#"+t).selectAll(".outerSlice").data(s).transition().duration(750).attrTween("d",(function(t){var e=o.interpolate(this._current,t);return this._current=e(0),function(t){return V(e(t),a-.5,i-.5,n)}})),o.select("#"+t).selectAll(".percent").data(s).transition().duration(750).attrTween("x",(function(t){var e=o.interpolate(this._current,t);return this._current=e(0),function(t){return.6*a*Math.cos(.5*(e(t).startAngle+e(t).endAngle))}})).attrTween("y",(function(t){var e=o.interpolate(this._current,t);return this._current=e(0),function(t){return.6*a*Math.sin(.5*(e(t).startAngle+e(t).endAngle))}})).text(B.getPercent)},B.draw=function(t,e,a,i,n,r,s,l,u,c,h,d){var p=o.pie().sort(null).value((function(t){return t.value}))(e),g=o.select("#"+t).append("g").attr("transform","translate("+a+","+i+")").attr("class","slices");g.selectAll(".innerSlice").data(p).enter().append("path").attr("class","innerSlice").style("fill",(function(t){return o.hsl(t.data.color).darker(.7)})).attr("d",(function(t){return O(t,n+.5,r+.5,s,l)})).each((function(t){this._current=t})),g.selectAll(".topSlice").data(p).enter().append("path").attr("class","topSlice").style("fill",(function(t){return t.data.color})).style("stroke",(function(t){return t.data.color})).attr("d",(function(t){return I(t,n,r,l)})).each((function(t){this._current=t})),g.selectAll(".outerSlice").data(p).enter().append("path").attr("class","outerSlice").style("fill",(function(t){return o.hsl(t.data.color).darker(.7)})).attr("d",(function(t){return V(t,n-.5,r-.5,s)})).each((function(t){this._current=t}));var f=l||.25,m=g.selectAll(".percent"),x=d?0:-10;if(u){var y=function(){E(m,p,f,n,r,x,(function(t){return B.getPercent(t)})),x-=20},v=function(){E(m,p,f,n,r,x,(function(t){return h(t.value)})),x-=20};c.value_percentage?(x+=20,y(),v()):c.percentage_value?(x+=20,v(),y()):(x+=10,c.value?v():y())}d&&E(m,p,f,n,r,x,(function(t){return t.data.label}))};var N=B,z=function(){var t=[],e={axisLength:600},a=null,i=null,n=o.timeFormat("%d%b"),r=null,s=null;function l(){}return l.init=function(){a=o.scaleTime().domain([t[0],t[1]]).range([0,e.axisLength]).clamp(!0),i=o.axisBottom(a).tickSize(5).ticks(l.getTicks()).tickFormat(n)},l.getTicks=function(){return r===o.timeDay&&1!==s?r.filter((function(e){return o.timeDay.count(t[0],e)%s==0})):r?r.every(s):void 0},l.ticks=function(){return a.ticks(l.getTicks()).map((function(t){return a(t)}))},l.position=function(t){return a(t)},l.draw=function(t){t.call(i).selectAll("text").attr("transform","translate(0,0)")},l.getAxisLine=function(){return a},l.getAxis=function(){return i},l.domain=function(e){return arguments.length?(t=e,l):t},l.ticksConfig=function(t){return r=t.ticksSize,s=t.ticksStep,l},l.config=function(t){if(!arguments.length)return e;for(var a in e)e[a]=t[a];return l},l.configValue=function(t,a){return e[t]=a,l},l.tickFormat=function(t){return arguments.length?(n=t,l):n},l},W=function(){var t,e=1,a=[],i={},n=0,r=Vt.maxTextWidth,o={axisLength:null,barHeight:15,progressBarPorcHeight:100,barPadding:5,barMargin:5,minTaskBandHeight:30,mileStoneHeight:0};p.init=function(){for(var t,e=0,r=0,o=0;o<a.length;o++){t=a[o];var u=s(t);r=e+u+l(t),i[t]={taskIni:e,taskEnd:e+u,mStoneIni:e+u,mStoneEnd:r},e=r}return n=r,p},p.ticks=function(){for(var t,e,i=[],n=0;n<a.length;n++)t=a[n],e=c(t),i.push(p.scaleValue(e[0]));return null!=e&&i.push(p.scaleValue(e[1])),i},p.position=function(e){if(H(e,"startDate"))var a=t.taskTotalOverlaps(e),i=h(e.category)[0]+o.barMargin+a*(o.barHeight+o.barPadding);else{if(!H(e,"date"))return null;i=d(e.category)[0]+o.mileStoneHeight-6}return p.scaleValue(i)},p.textWidth=function(t){return r=t||r},p.draw=function(t){return t.selectAll("line.axisY").remove(),t.append("line").attr("x1","0").attr("y1","0").attr("x2","0").attr("y2",p.scaleValue(n)).attr("class","axisY").attr("style","stroke:black"),t.selectAll("g").remove(),t.selectAll("g").data(a,(function(t){return t})).enter().append("g").attr("transform",u).append("text").attr("x","-5").attr("style","text-anchor: end").attr("class","tickY-label").text((function(t){return t})).call(Vt.textsToMultiline,r),t.selectAll("line.tickY").remove(),t.selectAll("line.tickY").data(p.ticks()).enter().append("line").attr("class","tickY").attr("x1","0").attr("y1",(function(t){return t})).attr("x2","-5").attr("y2",(function(t){return t})),p};var s=function(e){var a=t.categoryMaxOverlaps(e),i=o.minTaskBandHeight;return a>0&&(i=o.barMargin+(a-1)*(o.barHeight+o.barPadding)+o.barHeight+o.barMargin),i},l=function(){return o.mileStoneHeight},u=function(t){var e=c(t),a=e[0]+(e[1]-e[0])/2;return"translate(0,"+p.scaleValue(a)+")"};p.scaleValue=function(t){var e=1;return null!=o.axisLength&&n>0&&(e=o.axisLength/n),t*e};var c=function(t){return[i[t].taskIni,i[t].mStoneEnd]},h=function(t){return[i[t].taskIni,i[t].taskEnd]},d=function(t){return[i[t].mStoneIni,i[t].mStoneEnd]};function p(){}return p.overlappingResolver=function(e){return arguments.length?(t=e,p):t},p.categories=function(t){return arguments.length?(a=t,p):a},p.scale=function(t){return arguments.length?(e=t,p):e},p.config=function(t){if(!arguments.length)return o;for(var e in o)o[e]=t[e];return p},p.configValue=function(t,e){return o[t]=e,p},p.calculatedLength=function(){return n},p},G=function(){var t=[],e=[],a={},i=[];function n(t,e){if(H(a,t))for(var i=0;i<a[t].length;i++)n(a[t][i],e),e.push(a[t][i])}s.categories=function(e){return arguments.length?(t=e,s):t},s.tasks=function(t){return arguments.length?(e=t,a={},i=[],s):e},s.categoryMaxOverlaps=function(t){return i[t]?i[t].length:0},s.taskOverlaps=function(t){return a[t.id]},s.taskTotalOverlapsOld=function(t){var e=[];return n(t.id,e),e.filter((function(t,a){return e.indexOf(t)==a}))},s.taskTotalOverlaps=function(t){var e=t.id;return null!=a[e]?a[e].length:0};s.calculateOverlapping=function(){for(var e=0;e<t.length;e++){var a=[];i[t[e]]=a,r(t[e],a)}return s};var r=function(t,a){var i=e.filter((function(e){return e.category==t}));if(null!=i&&i.length>0)for(var n=0;n<i.length;n++)o(i[n],a)},o=function(t,e){for(var i,n,r=e.length,o=0;o<e.length;o++){if(!(t.startDate<e[o].endDate)){r=o;break}i=t,n=e[o],H(a,i.id)||(a[i.id]=[]),a[i.id].push(n.id)}e[r]=t};function s(){return s}return s};function H(t,e){var a=t.__proto__||t.constructor.prototype;return e in t&&(!(e in a)||a[e]!==t[e])}var R=function(t){var e={axisLength:600,barHeight:15,progressBarHeight:5},a=null,i=null,n=function(t){for(var e in i)t.on(e,i[e])};function r(){}return r.draw=function(i){i.append("rect").attr("y",0).attr("height",t.scaleValue(e.barHeight)).attr("width",a).attr("class",(function(t){return H(t,"class")?t.class+"-bar":"task-bar"})).attr("style",(function(t){return t.style})).attr("rx",3).attr("ry",3).call(n),i.append("rect").attr("y",t.scaleValue((e.barHeight-e.progressBarHeight)/2)).attr("height",t.scaleValue(e.progressBarHeight)).attr("width",(function(t){return H(t,"progress")?a(t):0})).attr("style",(function(t){return t.todoStyle})).attr("class","task-progress-bar-total"),i.append("rect").attr("y",t.scaleValue((e.barHeight-e.progressBarHeight)/2)).attr("height",t.scaleValue(e.progressBarHeight)).attr("width",(function(t){return H(t,"progress")?t.progress*a(t):0})).attr("class",(function(t){return H(t,"class")?t.class+"-progress-bar":"task-progress-bar"})).attr("style",(function(t){return t.doneStyle})).call(n),i.append("text").attr("y",(function(a){var i=t.scaleValue(e.barHeight);return null==a.progress?i/2+5:i-3})).attr("x",5).attr("class",(function(t){return H(t,"class")?t.class+"-label":"task-label"})).attr("style",(function(t){return t.labelStyle})).text((function(t){if(!t.label)return"";var e=a(t)-10,i=t.label,n=t.label.length;if(this.textContent=t.label,this.getComputedTextLength())for(;n>0&&this.getSubStringLength(0,n)>e;)n--;return n===t.label.length?i:0===n?"":i.substring(0,n)+"…"}))},r.eventHandlers=function(t){return arguments.length?(i=t,r):i},r.calculateBarWidth=function(t){return arguments.length?(a=t,r):a},r.config=function(t){if(!arguments.length)return e;for(var a in e)e[a]=t[a];return r},r.configValue=function(t,a){return e[t]=a,r},r},X=function(){var t=null,e={mileStoneRadius:2},a=function(e){for(var a in t)e.on(a,t[a])};function i(){}return i.draw=function(t){t.append("polygon").attr("points","10,1 4,19.8 19,7.8 1,7.8 16,19.8").attr("class",(function(t){return H(t,"class")?t.class+"-mark":"milestone-mark"})).attr("style",(function(t){return t.style})).call(a),t.append("text").attr("x",2).attr("y",30).attr("style",(function(t){return t.style+";font-size: 14px"})).attr("class",(function(t){return H(t,"class")?t.class+"-label":"milestone-label"})).text((function(t){return t.label}))},i.eventHandlers=function(e){return arguments.length?(t=e,i):t},i.config=function(t){if(!arguments.length)return e;for(var a in e)e[a]=t[a];return i},i.configValue=function(t,a){return e[t]=a,i},i},Y=function(){var t=null,e={chartHeight:100};function a(){}return a.draw=function(t){t.append("line").attr("x1","0").attr("y1","0").attr("x2","0").attr("y2",e.chartHeight).attr("class",(function(t){return H(t,"class")?t.class+"-line":"dateline-line"})).attr("style",(function(t){return t.style}));var a=t.append("text").attr("y",-4).attr("class",(function(t){return H(t,"class")?t.class+"-label":"dateline-label"})).style("text-anchor","middle").text((function(t){return t.label})),i=[];a.each((function(){var t=this.getBoundingClientRect(),e=0;i.some((function(a){if(a<t.x)return!0;e++})),i[e]=t.x+t.width,this.setAttribute("y",parseFloat(this.getAttribute("y"))+16*e),e>0&&(i[e]=i[e]+5,this.setAttribute("x",0))}))},a.eventHandlers=function(e){return arguments.length?(t=e,a):t},a.config=function(t){if(!arguments.length)return e;for(var i in e)e[i]=t[i];return a},a.configValue=function(t,i){return e[t]=i,a},a},j=function(t,e,a){t=t;var i=Math.floor(1e6*Math.random()+1),n={top:20,right:40,bottom:140,left:150},r=(e=null,a=null,null),s=null,l="fit",u="%d/%b",c=null,h=null,d=!0,p=[],g=[],f=[],m=[],x=G(),y=W(),v=z(),b=R(y),_=X(),w=Y(),S={task:{},milestone:{},dateline:{}},k=function(){return null!=e&&e>0?e:y.calculatedLength()},T=function(){return null!=a&&a>0?a-n.right-n.left-5:document.body.clientWidth-n.right-n.left-5},P=function(t){return"t_"+t.id},C=function(t){return"ms_"+t.id},F=function(t){return"translate("+v.position(t.startDate)+","+y.position(t)+")"},A=function(t){var e=L(t);return"translate("+e.x+","+e.y+")"},L=function(t){var e=v.position(t.date)-10,a=y.position(t),i=$.grep(g,(function(e){return e.category===t.category}));if(i.length){var n=i[0];i.some((function(e){if(!(e.startDate<=t.date))return!0;n=e})),a=y.position(n)+y.scaleValue(15)/2}return{x:e,y:a-10}},M=function(t){return"translate("+v.position(t.date)+",0)"},D=function(){return t.selectAll("svg").data([i],(function(t){return t})).selectAll(".gantt-chart")},B=function(t,e){var a=S[e],i=function(a){t.on(a,(function(t){S[e].hasOwnProperty(a)&&S[e][a](t)}))};for(var n in a)i(n)},I=function(){v.domain([r,s]).tickFormat(u).ticksConfig({ticksSize:c,ticksStep:h}).configValue("axisLength",T()),v.init(),null==p&&(p=function(t){var e={};t.map((function(t){e.hasOwnProperty(e,t.category)||(e[t.category]=!0)}));var a=[];for(var i in e)a.push(i);return a}(g)),y.overlappingResolver(x).categories(p),null!=e&&y.configValue("axisLength",e),y.init()},V=function(){var t=D(),e=t.select("g.yaxis-group");y.draw(e);var a=t.select("g.xaxis-group");a.attr("transform","translate(0, "+k()+")"),v.draw(a),a.selectAll(".tick").classed("minor",(function(t){return t.getMonth()}))},O=function(){var t=D().select("g.grid-group");t.selectAll("line.gridX").remove(),t.selectAll("line.gridX").data(v.ticks(),(function(t){return t})).enter().append("line").attr("class","gridX").attr("x1",(function(t){return t})).attr("x2",(function(t){return t})).attr("y1",0).attr("y2",k()).style("stroke","#ccc");var e=T();t.selectAll("line.gridY").remove(),t.selectAll("line.gridY").data(y.ticks(),(function(t){return t})).enter().append("line").attr("class","gridY").attr("x1",0).attr("x2",e).attr("y1",(function(t){return t})).attr("y2",(function(t){return t})).style("stroke","#ccc")},E=function(){var u;!function(t){if("fit"===l){if(void 0===t||t.length<1)return r=o.timeDay.offset(new Date,-3),void(s=o.timeHour.offset(new Date,3));r=t.reduce((function(t,e){return t.startDate<e.startDate?t:e})).startDate,s=t.reduce((function(t,e){return t.endDate>e.endDate?t:e})).endDate,v.domain([r,s]).init()}}(g),(u=t.selectAll("svg").data([i],(function(t){return t})).enter().append("svg").attr("class","chart").attr("width",a).attr("height",e).append("g").attr("class","gantt-chart").attr("transform","translate("+n.left+", "+n.top+")")).append("g").attr("class","grid-group"),u.append("g").attr("class","gantt-bars"),u.append("g").attr("class","yaxis-group"),u.append("g").attr("class","xaxis-group")},N=function(t){var e=16*(t.length-1);t.forEach((function(t,a){t.forEach((function(t){var i=L(t.d);AJS.$(t.el).attr("transform","translate("+i.x+","+(i.y-e+32*a)+")")}))}))},H=function(t){return t.endDate>r&&t.startDate<s},j=function(t){return t.date>=r&&t.date<=s},K=function(t){return t.date>=r&&t.date<=s},U=function(t){var e=Math.max(r,t.startDate),a=Math.min(s,t.endDate);return v.position(a)-v.position(e)};function J(){return J}return J.draw=function(){t.selectAll("svg").data([i],(function(t){return t})).empty()?E():t.selectAll("svg").data([i],(function(t){return t})).selectAll("g.gantt-chart").attr("transform","translate("+n.left+", "+n.top+")");var e=g.filter(H);return x.tasks(e).calculateOverlapping(),I(),d&&O(),V(),function(t){var e=t.filter(H),a=D().select(".gantt-bars");a.selectAll("g").remove();var i=a.selectAll("g.g_task").data(e,P).enter().append("g").attr("class","g_task").attr("y",0).attr("transform",F);b.calculateBarWidth(U).eventHandlers(S.task).draw(i)}(g),function(t){var e=t.filter(K).sort((function(t,e){return t.date.getTime()-e.date.getTime()})),a=D().select(".gantt-bars");a.selectAll("g.g_dateline").remove();var i=a.selectAll("g").data(e,(function(t){return t.date})).enter().append("g").attr("class","g_dateline").attr("y",0).attr("transform",M).call(B,"dateline");w.configValue("chartHeight",k()).eventHandlers(S.dateline).draw(i)}(m),function(t){var e=t.filter(j).sort((function(t,e){return t.date.getTime()-e.date.getTime()})),a=D().select(".gantt-bars");a.selectAll("g.g_mileStone").remove();var i=a.selectAll("g.g_milestone").data(e,C).enter().append("g").attr("class","g_milestone").attr("y",0).attr("transform",A);_.eventHandlers(S.milestone).draw(i);var n=[],r=[];i.each((function(t){var e=this.getBoundingClientRect();e.y=Math.round(e.y),n[e.y]||(n[e.y]=[],r[e.y]=[]);var a=0,i=!0,o=!1;n[e.y].some((function(t){if(t<e.x)o=!0;else{if(i=!1,o)return!0;a++}})),i&&(N(r[e.y]),n[e.y]=[],r[e.y]=[]),n[e.y][a]=e.x+e.width,r[e.y][a]||(r[e.y][a]=[]),r[e.y][a].push({el:this,d:t})})),r.forEach((function(t){N(t)}))}(f),o.select("body").select("svg").data([i],(function(t){return t})).style("height",k()+n.top+n.bottom),J},J.init=function(){E(),I()},J.getTimeAxisRenderer=function(){return v},J.margin=function(t){return arguments.length?(n=t,J):n},J.timeDomain=function(t){return arguments.length?(r=+t[0],s=+t[1],J):[r,s]},J.timeDomainMode=function(t){return arguments.length?(l=t,J):l},J.ticks=function(t){return c=t.ticksSize,h=t.ticksStep,J},J.container=function(e){return t=e,J},J.grid=function(t){return d=t,J},J.id=function(t){return arguments.length?(i=t,J):i},J.width=function(t){return arguments.length?(a=t,J):a},J.height=function(t){return arguments.length?(e=t,J):e},J.tickFormat=function(t){return arguments.length?(u=t,J):u},J.categories=function(t){return arguments.length?(p=t,x.categories(p),J):p},J.tasks=function(t){return arguments.length?(g=t,J):g},J.mileStones=function(t){return arguments.length?(f=t,J):f},J.dateLines=function(t){return arguments.length?(m=t,J):m},J.overlappingResolver=function(t){return arguments.length?(x=t,J):x},J.categoryAxisRenderer=function(t){return arguments.length?(y=t,J):y},J.taskRenderer=function(t){return arguments.length?(b=t,J):b},J.msRenderer=function(t){return arguments.length?(_=t,J):_},J.datelineRenderer=function(t){return arguments.length?(w=t,J):w},J.taskEventHandler=function(t,e){return S.task[t]=e,J},J.milestoneEventHandler=function(t,e){return S.milestone[t]=e,J},J.datelineEventHandler=function(t,e){return S.dateline[t]=e,J},J},K=a(14978),U={draw:function(t,e,a){var i=this,n={nodeRadius:5,factorLegend:.85,radians:2*Math.PI,opacityArea:.1,padding:{left:20,right:20,top:20,bottom:20},maxValue:0,grid:!0};if(void 0!==a)for(var r in a)void 0!==a[r]&&(n[r]=a[r]);var l={},u={},c=[];e.forEach((function(t){u[t.aggregation]=Math.max(Math.max(t.value,u[t.aggregation]?u[t.aggregation]:0),n.maxValue),l[t.label]||(l[t.label]=[]),l[t.label].push({axis:t.aggregation,value:t.value}),-1===c.indexOf(t.aggregation)&&c.push(t.aggregation)}));var h=c.length;n.chartDimension={w:n.w-n.padding.left-n.padding.right,h:n.h-n.padding.top-n.padding.bottom},n.radius=Math.min(n.chartDimension.w/2,n.chartDimension.h/2),n.center={x:n.chartDimension.w/2+n.padding.left,y:n.radius+n.padding.top},n.angle=n.radians/h;var d=t.append("svg").attr("width",n.w).attr("height",n.center.y+n.radius+n.padding.bottom).append("g");if(n.maxValue>0&&n.grid){var p=[];if(n.scaleStep)for(var g=0;g<=n.maxValue;g=K.default.addFloats(g,n.scaleStep))p.push(g);else{var f=o.scaleLinear();f.domain([0,n.maxValue]),p=f.ticks(3)}p.forEach((function(t){if(t>0){var e=n.radius*t/n.maxValue;d.selectAll(".levels").data(c).enter().append("svg:line").attr("x1",(function(t,a){return n.center.x-e*Math.sin(a*n.angle)})).attr("y1",(function(t,a){return n.center.y-e*Math.cos(a*n.angle)})).attr("x2",(function(t,a){return n.center.x-e*Math.sin((a+1)*n.angle)})).attr("y2",(function(t,a){return n.center.y-e*Math.cos((a+1)*n.angle)})).attr("class","line").style("stroke","#d3d3d3").style("stroke-width","1px"),d.append("text").attr("class","axis-text").text(n.formatter(t,c[0])).style("font-size","14px").attr("y",n.center.y-e+19).attr("x",n.center.x+5)}}))}var m=d.selectAll(".axis").data(c).enter().append("g").attr("class","axis");m.append("line").attr("x1",n.center.x).attr("y1",n.center.y).attr("x2",(function(t,e){return n.center.x-n.radius*Math.sin(e*n.angle)})).attr("y2",(function(t,e){return n.center.y-n.radius*Math.cos(e*n.angle)})).attr("class","line").style("stroke","grey").style("stroke-width","1px"),m.append("text").attr("class","axis-text").text((function(t){return t})).style("font-size","14px").attr("text-anchor","middle").attr("transform",(function(t,e){var a=i.calcTextAngle(n,e);return"rotate("+a/Math.PI*180+" "+i.calcAxisTextX(n,e,a)+","+i.calcAxisTextY(n,e,a)+")"})).attr("x",(function(t,e){return i.calcAxisTextX(n,e,i.calcTextAngle(n,e))})).attr("y",(function(t,e){return i.calcAxisTextY(n,e,i.calcTextAngle(n,e))})),Object.keys(l).forEach((function(t,e){var a=l[t],r=[];d.selectAll(".nodes").data(a,(function(t,e){r.push([i.calcCY(n,t,u,e),i.calcCX(n,t,u,e)])})),r.push(r[0]),d.selectAll(".area").data([r]).enter().append("polygon").attr("class","radar-chart-serie"+e).attr("key",t).style("stroke-width","2px").style("stroke",n.color(t)).attr("points",(function(t){for(var e="",a=0;a<t.length;a++)e=e+t[a][0]+","+t[a][1]+" ";return e})).style("fill",(function(){return n.color(t)})).style("fill-opacity",n.opacityArea).on("mouseover",(function(){var t="polygon."+o.select(this).attr("class");d.selectAll("polygon").transition(200).style("fill-opacity",0),d.selectAll(t).transition(200).style("fill-opacity",.5)})).on("mouseout",(function(){d.selectAll("polygon").transition(200).style("fill-opacity",n.opacityArea)}))}));var x=(0,s.default)().attr("class","d3-tip chart"+n.id).offset([-8,0]).html((function(t){return K.default.escapeString(t.key+" ("+n.formatter(t.data.value,t.data.axis)+")")}));return d.call(x),Object.keys(l).forEach((function(t,e){var a=l[t];d.selectAll(".nodes").data(a).enter().append("svg:circle").attr("class","radar-chart-serie"+e).attr("key",t).attr("r",n.nodeRadius).attr("cx",(function(t,e){return i.calcCY(n,t,u,e)})).attr("cy",(function(t,e){return i.calcCX(n,t,u,e)})).attr("data-id",(function(t){return t.axis})).style("fill",n.color(t)).style("fill-opacity",.9).on("mouseover",(function(e,a){x.show({key:t,data:a},this);var i="polygon."+o.select(this).attr("class");d.selectAll("polygon").transition(200).style("fill-opacity",.1),d.selectAll(i).transition(200).style("fill-opacity",.7)})).on("mouseout",(function(){x.hide(),d.selectAll("polygon").transition(200).style("fill-opacity",n.opacityArea)}))})),{svg:d,cfg:n}},calcCY:function(t,e,a,i){return t.center.x-t.radius*Math.sin(i*t.angle)*Math.max(e.value,0)/a[e.axis]},calcCX:function(t,e,a,i){return t.center.y-t.radius*Math.cos(i*t.angle)*Math.max(e.value,0)/a[e.axis]},calcAxisTextX:function(t,e,a){var i=e*t.angle;return t.center.x-t.radius*Math.sin(i)-(t.nodeRadius+4+9.5*Math.min(1,i+a))*Math.sin(i)},calcAxisTextY:function(t,e,a){var i=e*t.angle;return t.center.y-t.radius*Math.cos(i)-(t.nodeRadius+4+9.5*Math.min(1,i+a))*Math.cos(i)},calcTextAngle:function(t,e){var a=-e*t.angle;return a<-Math.PI/2&&a>1.5*-Math.PI&&(a+=Math.PI),a}},J=a(51855),q=a(22017),Z={saveChanges:function(t,e,a,i,n,r,o,s,l,u,c,h,d,p,g,f,m){$.ajax({contentType:"application/x-www-form-urlencoded; charset=utf-8",type:"POST",cache:!1,url:Confluence.getContextPath()+"/rest/table-filter/1.0/service/save-chart",dataType:"json",data:{pageId:t,id:e,column:a,aggregation:i,type:$.trim(n),height:r,width:o,hide:s,version:p,colors:l,pieKeys:u,interpolation:g,is3D:c,lineSettings:f,innerLabels:m},success:h,error:function(t){q.default.showError(t,d)}})},saveDateFormat:function(t,e,a){$.ajax({contentType:"application/x-www-form-urlencoded; charset=utf-8",type:"POST",cache:!1,url:Confluence.getContextPath()+"/rest/table-filter/1.0/service/save-chart/dateformat",dataType:"json",data:{pageId:t,id:e,dateformat:a}})}},Q=a(36845),tt=a(25681),et=JSON.parse('{"0":7.55,"1":7.55,"2":7.55,"3":7.55,"4":7.55,"5":7.55,"6":7.55,"7":7.55,"8":7.55,"9":7.55," ":3.83,"!":3.98,"#":8.27,"$":7.55,"%":11.46,"&":11.2,"\'":3.22,"(":4.22,")":4.22,"*":5.84,"+":9.58,",":3.04,"-":5.6,".":3.04,"/":5.46,":":3.04,";":3.04,"<":9.58,"=":9.58,">":9.58,"?":6.28,"@":13.37,"A":9.03,"B":8.03,"C":8.67,"D":9.82,"E":7.08,"F":6.84,"G":9.6,"H":9.94,"I":3.73,"J":5,"K":8.12,"L":6.59,"M":12.57,"N":10.47,"O":10.55,"P":7.84,"Q":10.55,"R":8.37,"S":7.44,"T":7.33,"U":9.62,"V":8.7,"W":13.08,"X":8.26,"Y":7.74,"Z":7.98,"[":4.22,"]":4.22,"^":9.58,"_":5.81,"`":3.75,"a":7.12,"b":8.23,"c":6.47,"d":8.24,"e":7.32,"f":4.38,"g":8.24,"h":7.92,"i":3.39,"j":3.39,"k":6.96,"l":3.39,"m":12.06,"n":7.92,"o":8.2,"p":8.23,"q":8.24,"r":4.87,"s":5.94,"t":4.74,"u":7.92,"v":6.71,"w":10.12,"x":6.43,"y":6.77,"z":6.33,"{":4.22,"|":3.35,"}":4.22,"~":9.58,"":7," ":3.83,"¡":3.98,"¢":7.55,"£":7.55,"¤":7.78,"¥":7.55,"¦":3.35,"§":6.28,"¨":5.8,"©":12.46,"ª":5.49,"«":7.08,"¬":9.58,"­":0,"®":12.46,"¯":5.81,"°":5.28,"±":9.58,"²":5.13,"³":5.13,"´":3.95,"µ":8.08,"¶":6.41,"·":3.04,"¸":2.87,"¹":4.92,"º":6.03,"»":7.08,"¼":12.69,"½":13.03,"¾":13.33,"¿":6.28,"À":9.03,"Á":9.03,"Â":9.03,"Ã":9.03,"Ä":9.03,"Å":9.03,"Æ":12.04,"Ç":8.67,"È":7.08,"É":7.08,"Ê":7.08,"Ë":7.08,"Ì":3.73,"Í":3.73,"Î":3.73,"Ï":3.73,"Ð":9.82,"Ñ":10.47,"Ò":10.55,"Ó":10.55,"Ô":10.55,"Õ":10.55,"Ö":10.55,"×":9.58,"Ø":10.55,"Ù":9.62,"Ú":9.62,"Û":9.62,"Ü":9.62,"Ý":7.74,"Þ":7.84,"ß":7.62,"à":7.12,"á":7.12,"â":7.12,"ã":7.12,"ä":7.12,"å":7.12,"æ":11.65,"ç":6.47,"è":7.32,"é":7.32,"ê":7.32,"ë":7.32,"ì":3.39,"í":3.39,"î":3.39,"ï":3.39,"ð":7.83,"ñ":7.92,"ò":8.2,"ó":8.2,"ô":8.2,"õ":8.2,"ö":8.2,"÷":9.58,"ø":8.2,"ù":7.92,"ú":7.92,"û":7.92,"ü":7.92,"ý":6.77,"þ":8.23,"ÿ":6.77,"Ѐ":7.08,"Ё":7.08,"Ђ":9.8,"Ѓ":6.6,"Є":8.64,"Ѕ":7.44,"І":3.73,"Ї":3.73,"Ј":5,"Љ":13.73,"Њ":13.77,"Ћ":10.12,"Ќ":8.12,"Ѝ":10.49,"Ў":7.94,"Џ":9.92,"А":9.03,"Б":8,"В":8.03,"Г":6.6,"Д":9.71,"Е":7.08,"Ж":12.13,"З":7.56,"И":10.49,"Й":10.49,"К":8.12,"Л":9.42,"М":12.57,"Н":9.94,"О":10.55,"П":9.98,"Р":7.84,"С":8.67,"Т":7.33,"У":7.94,"Ф":10.17,"Х":8.26,"Ц":10.39,"Ч":9.26,"Ш":13.29,"Щ":13.72,"Ъ":9.88,"Ы":10.96,"Ь":8.07,"Э":8.63,"Ю":14.26,"Я":8.27,"а":7.12,"б":8.11,"в":7.42,"г":5.36,"д":7.66,"е":7.32,"ж":10.45,"з":6.24,"и":8.13,"й":8.13,"к":6.96,"л":7.38,"м":9.83,"н":8.08,"о":8.2,"п":8.08,"р":8.23,"с":6.47,"т":5.74,"у":6.77,"ф":9.6,"х":6.43,"ц":8.4,"ч":7.91,"ш":11.2,"щ":11.54,"ъ":8.27,"ы":9.93,"ь":7.05,"э":6.47,"ю":11.38,"я":7.04,"ѐ":7.32,"ё":7.32,"ђ":8.08,"ѓ":5.36,"є":6.47,"ѕ":5.94,"і":3.39,"ї":3.39,"ј":3.39,"љ":11.06,"њ":11.29,"ћ":7.94,"ќ":6.96,"ѝ":8.13,"ў":6.77,"џ":8.08,"Ѡ":12.09,"ѡ":9.49,"Ѣ":9.04,"ѣ":8.12,"Ѥ":12.71,"ѥ":10.01,"Ѧ":9.31,"ѧ":6.99,"Ѩ":12.22,"ѩ":9.67,"Ѫ":10.19,"ѫ":7.91,"Ѭ":13.02,"ѭ":10.49,"Ѯ":7.56,"ѯ":6.3,"Ѱ":10.96,"ѱ":10.64,"Ѳ":10.55,"ѳ":8.2,"Ѵ":10.08,"ѵ":8.09,"Ѷ":10.08,"ѷ":8.09,"Ѹ":18.37,"ѹ":15.65,"Ѻ":11.57,"ѻ":9.1,"Ѽ":15.8,"ѽ":12.52,"Ѿ":12.09,"ѿ":9.49,"Ҁ":8.23,"ҁ":6.13,"҂":7,"҃":0,"҄":0,"҅":0,"҆":0,"҇":5.93,"҈":0,"҉":0,"Ҋ":10.98,"ҋ":8.84,"Ҍ":8.07,"ҍ":7.08,"Ҏ":7.85,"ҏ":8.24,"Ґ":6.56,"ґ":5.47,"Ғ":7.21,"ғ":5.74,"Ҕ":7.96,"ҕ":7.03,"Җ":12.74,"җ":10.92,"Ҙ":7.56,"ҙ":6.36,"Қ":8.57,"қ":7.42,"Ҝ":8.12,"ҝ":6.93,"Ҟ":8.12,"ҟ":6.96,"Ҡ":9.94,"ҡ":8.13,"Ң":10.39,"ң":8.4,"Ҥ":11.76,"ҥ":9.28,"Ҧ":14.15,"ҧ":11.7,"Ҩ":10.1,"ҩ":7.79,"Ҫ":8.67,"ҫ":6.47,"Ҭ":7.36,"ҭ":5.74,"Ү":7.74,"ү":6.77,"Ұ":7.74,"ұ":6.77,"Ҳ":8.78,"ҳ":6.9,"Ҵ":12.21,"ҵ":9.58,"Ҷ":9.62,"ҷ":8.23,"Ҹ":9.17,"ҹ":7.91,"Һ":9.26,"һ":7.92,"Ҽ":11.69,"ҽ":8.86,"Ҿ":11.69,"ҿ":8.86,"Ӏ":3.73,"Ӂ":12.13,"ӂ":10.45,"Ӄ":8.12,"ӄ":7.08,"Ӆ":9.91,"ӆ":8.09,"Ӈ":9.94,"ӈ":8.08,"Ӊ":10.45,"ӊ":8.79,"Ӌ":9.17,"ӌ":7.91,"Ӎ":13.07,"ӎ":10.54,"ӏ":3.39,"Ӑ":9.03,"ӑ":7.12,"Ӓ":9.03,"ӓ":7.12,"Ӕ":12.04,"ӕ":11.65,"Ӗ":7.08,"ӗ":7.32,"Ә":10.09,"ә":7.32,"Ӛ":10.09,"ӛ":7.32,"Ӝ":12.13,"ӝ":10.45,"Ӟ":7.56,"ӟ":6.24,"Ӡ":7.32,"ӡ":6.19,"Ӣ":10.49,"ӣ":8.13,"Ӥ":10.49,"ӥ":8.13,"Ӧ":10.55,"ӧ":8.2,"Ө":10.55,"ө":8.2,"Ӫ":10.55,"ӫ":8.2,"Ӭ":8.63,"ӭ":6.47,"Ӯ":7.94,"ӯ":6.77,"Ӱ":7.94,"ӱ":6.77,"Ӳ":7.94,"ӳ":6.77,"Ӵ":9.26,"ӵ":7.91,"Ӷ":6.6,"ӷ":5.36,"Ӹ":10.96,"ӹ":9.93,"Ӻ":7.21,"ӻ":5.74,"Ӽ":8.67,"ӽ":6.78,"Ӿ":8.26,"ӿ":6.43," ":7," ":14," ":7," ":14," ":4.66," ":3.5," ":2.33," ":7.55," ":3.04," ":2.8," ":1.75,"​":0,"‌":0,"‍":0,"‎":0,"‏":0,"‐":5.6,"‑":5.6,"‒":7.55,"–":7,"—":14,"―":14,"‖":6.43,"‗":5.81,"‘":3.21,"’":3.21,"‚":3.21,"‛":3.21,"“":5.28,"”":5.28,"„":5.28,"‟":5.28,"†":5.25,"‡":5.25,"•":5.69,"‣":4.9,"․":4.66,"‥":9.32,"…":10.26,"‧":3.5,"\u2028":0,"\u2029":0,"‪":0,"‫":0,"‬":0,"‭":0,"‮":0," ":1.91,"‰":16.94,"‱":18.55,"′":3.21,"″":5.28,"‴":7.2,"‵":3.06,"‶":5.83,"‷":5.83,"‸":4.37,"‹":4.42,"›":4.42,"※":14,"‼":6.72,"‽":6.28,"‾":5.81,"‿":13.39,"⁀":13.39,"⁁":4.57,"⁂":13.15,"⁃":4.66,"⁄":2.42,"⁅":4.66,"⁆":4.66,"⁇":11.92,"⁈":9.44,"⁉":9.37,"⁊":6.83,"⁋":6.34,"⁌":6.34,"⁍":6.34,"⁎":7,"⁏":3.89,"⁐":13.39,"⁑":7,"⁒":7,"⁓":7.57,"⁔":13.39,"⁕":7,"⁖":6.99,"⁗":7.79,"⁘":8.61,"⁙":8.95,"⁚":3.83,"⁛":12.36,"⁜":8.95,"⁝":3.83,"⁞":3.04," ":3.11,"⁠":0,"⁡":0,"⁢":0,"⁣":0,"⁤":0,"⁥":0,"⁦":0,"⁧":0,"⁨":0,"⁩":0,"⁪":0,"⁫":0,"⁬":0,"⁭":0,"⁮":0,"⁯":0,"⁰":5.13,"ⁱ":2.41,"⁲":9.04,"⁳":9.04,"⁴":4.92,"⁵":5.13,"⁶":5.13,"⁷":5.13,"⁸":5.13,"⁹":5.13,"⁺":5.13,"⁻":5.13,"⁼":5.13,"⁽":4.22,"⁾":4.22,"ⁿ":5.49,"₀":5.13,"₁":4.92,"₂":5.13,"₃":5.13,"₄":4.92,"₅":5.13,"₆":5.13,"₇":5.13,"₈":5.13,"₉":5.13,"₊":5.13,"₋":5.13,"₌":5.13,"₍":4.22,"₎":4.22,"₏":9.04,"ₐ":4.41,"ₑ":4.35,"ₒ":4.79,"ₓ":3.74,"ₔ":4.35,"ₕ":4.7,"ₖ":4.22,"ₗ":2.27,"ₘ":6.96,"ₙ":4.7,"ₚ":4.8,"ₛ":3.56,"ₜ":2.82,"₝":9.04,"₞":9.04,"₟":9.04,"₠":8.74,"₡":7.55,"₢":7.55,"₣":6.84,"₤":7.55,"₥":12.06,"₦":9.04,"₧":15.54,"₨":11.99,"₩":10.42,"₪":7.38,"₫":8.24,"€":7.55,"₭":7,"₮":6.28,"₯":15.75,"₰":6.37,"₱":8.24,"₲":7.55,"₳":7.55,"₴":7.55,"₵":7.55,"₶":7.55,"₷":8.05,"₸":7.55,"₹":7.55,"₺":7.55,"₻":8.65,"₼":10.66,"₽":7.55,"₾":9.56,"₿":7.55,"⃀":9.04,"⃁":9.04,"⃂":9.04,"⃃":9.04,"⃄":9.04,"⃅":9.04,"⃆":9.04,"⃇":9.04,"⃈":9.04,"⃉":9.04,"⃊":9.04,"⃋":9.04,"⃌":9.04,"⃍":9.04,"⃎":9.04,"⃏":9.04}');et['"']=5.489,et["\\"]=5.305;var at=function(t){for(var e=0,a=0;a<t.length;a++)e+=et[t[a]]||nt(t[a]);return e},it=function(t){return 1==t.length?{text:t[0],width:at(t[0])}:{text:t.reduce((function(t,a,i){1==i&&(e=at(t));var n=at(a);return n>e?(e=n,a):t})),width:e};var e},nt=function t(e){return t.context.measureText(e).width};function rt(t,e,a,i,n,r,o){try{var s=t[r](o),l=s.value}catch(t){return void a(t)}s.done?e(l):Promise.resolve(l).then(i,n)}function ot(t){return function(){var e=this,a=arguments;return new Promise((function(i,n){var r=t.apply(e,a);function o(t){rt(r,i,n,o,s,"next",t)}function s(t){rt(r,i,n,o,s,"throw",t)}o(void 0)}))}}nt.context=document.createElement("canvas").getContext("2d"),nt.context.font='14px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif';var st="dash",lt="circle",ut=function t(e){var a=this;a.palette=K.default.chartColors,a.colors=e.colors?e.colors.split(","):[],a.pieKeys=e.pieKeys?e.pieKeys.split("‚"):[],a.ganttCatColors=a.pieKeys.slice(),a.visiblePieKeysLength=a.pieKeys.length,a.macroId=e.macroId,a.pageId=e.pageId,a.dateFormat=e.dateFormat||"yy-mm-dd",a.dateFormat=a.dateFormat.replace("yyyy","yy"),a.hasTimeFormat=a.dateFormat.toLowerCase().indexOf("hh:mm")>=0,a.localeDateFormat=K.default.getLocaleDateFormat(a.dateFormat),a.separator=e.separator,a.worklog=K.default.getWorklog(e.worklog),a.columns=e.columns?e.columns.split("‚"):[],a.aggregation=e.aggregation?e.aggregation.split("‚"):[],a.trimParams(a.columns),a.trimParams(a.aggregation),a.aggregationCache=a.aggregation.slice(),a.columnsCache=a.columns.slice(),a.transpose="Horizontal"===e.dataorientation,a.grid=e.grid,a.legend=e.legend&&"none"!=e.legend,a.isLegendUnderGraph="under"==e.legend,a.xValueType=null,a.valueType=K.default.getValueType(e.minvalue,a.separator,a.worklog)||K.default.getValueType(e.maxvalue,a.separator,a.worklog)||K.default.getValueType(e.scalestep,a.separator,a.worklog)||null,a.minvalue=K.default.parseValueByType(a.valueType,e.minvalue,a.separator,a.worklog),a.minvalue=!1===a.minvalue?NaN:a.minvalue,a.maxvalue=K.default.parseValueByType(a.valueType,e.maxvalue,a.separator,a.worklog),a.maxvalue=!1===a.maxvalue?NaN:a.maxvalue,a.xminvalue=e.xminvalue,a.xmaxvalue=e.xmaxvalue,a.yminvalue=e.minvalue,a.ymaxvalue=e.maxvalue,a.scaleStep=K.default.parseValueByType(a.valueType,e.scalestep,a.separator,a.worklog),a.scaleStep=!1===a.scaleStep?NaN:a.scaleStep,a.xScaleStep=e.xscalestep,a.yScaleStep=e.scalestep,a.locale=K.default.getLocale(),a.title=e.title,a.xtitle=e.xtitle,a.ytitle=e.ytitle,a.isLog=e.isLog,a.isXLog=e.isXLog,a.titleHeight=e.title?20:0,a.xtitleHeight=e.xtitle?20:0,a.ytitleHeight=e.ytitle?20:0,a.showTrendLine="string"==typeof e.showTrendLine?"true"==e.showTrendLine:1==e.showTrendLine,a.tabs=e.tabs,a.hide=1==e.hide,a.textWidth=0,a.bubleMaxTextWidthX=t.maxTextWidth,a.bubleMaxTextWidthY=t.maxTextWidth,a.argumentWidth=0,a.lineSettings=e.lineSettings?e.lineSettings.split(","):{},a.version=3,a.interpolation=e.interpolation?e.interpolation.split(","):["Linear"],a.defaultInterpolation=e.version>=3?"Linear":a.interpolation[0],a.barColoringType=e.barColoringType,a.outerLabels=e.outerLabels,a.storedParams={},a.sessionId=e.sessionId||1,a.isEditor=e.isEditor,a.isCloud=e.isCloud,a.isWasSavedEarlier=!(!a.columns.length||!a.aggregation.length),e.version>=3?(a.showInnerLabels="None"!==e.showInnerLabels,a.innerLabelsType={percentage:"Percentage"===e.showInnerLabels,value_percentage:"Value (Percentage)"===e.showInnerLabels,percentage_value:"Percentage (Value)"===e.showInnerLabels,value:"Value"===e.showInnerLabels||!e.showInnerLabels}):(a.showInnerLabels="string"==typeof e.showInnerLabels?"false"!=e.showInnerLabels:0!=e.showInnerLabels,a.innerLabelsType={}),Mt(a.colors,a.palette),a.colorsCache=a.colors.slice(),"editor"!==a.macroId&&(a.initElements(e),a.initFormaters(),a.content.data("rendered")||(a.content.data("rendered",!0),a.isPivot&&(a.separator=a.pivotContent.data("decimalseparator")),a.getOriginalTable(),a.getDimension(),a.getType(),a.colorKeyMap=a.setColorKeyMap({},a.getAllChartColorLabels(),a.colors),a.bindUpdate(),tt.default.bindUnloadPage(a,a.settings),a.setChosen(),a.bindUI(),a.setControls(),a.draw(),a.bindTips(),a.bindPageResize(),a.setStoreParams()))};function ct(t,e,a){return t[e]||(t[e]=[0]),t[e].push(a),t}function ht(t){return"Line"===t||"Time Line"===t}function dt(t){if(window.XMLSerializer&&t.length){var e=(new XMLSerializer).serializeToString(t[0]);return(e=e.replace(/xmlns="http:\/\/www.w3.org\/2000\/svg"/g,"")).substring(0,4)+' xmlns="http://www.w3.org/2000/svg"'+e.substring(4,e.length)}return t.prop("outerHTML")}function pt(t){var e=0;t.forEach((function(t){e+=t.value}));var a=0,i={},n=0,r=[],o=$.grep(t,(function(t){var o,s,l=Math.round(1e3*t.value/e)/10;if(t.percent=l,l>1)return!0;a=K.default.addFloats(a,t.value),n++,r.push({label:t.label,value:t.value,percent:l}),o=i,s=t.rowNumber,$.each(s,(function(t,e){o[t]||(o[t]=[]),o[t]=o[t].concat(e)})),i=o}));return a&&n>1&&o.push({label:"Other",value:a,percent:Math.round(1e3*a/e)/10,other:!0,rowNumber:i}),{data:o,smallData:r,count:n}}function gt(t,e,a){var i=t;return i=Math.max(e,i),i=Math.min(a,i)}function ft(t,e,a){var i=0,n=0;return e.length===a.length?e.length&&(a[0].absTotal?n=a[0].absTotal:(n=0,a.forEach((function(t){n+=t.total})),a[0].absTotal=n)):a.some((function(e){if(e.label===t.label)return n=e.total,!0})),n&&(i=100*t.value/n),i.toFixed(1)+"%"}function mt(t){var e=yt(t);return(299*e.r+587*e.g+114*e.b)/1e3>=128?"black":"white"}function xt(t,e){var a=yt(t);return a.r=Math.min(parseInt(a.r/e),255),a.g=Math.min(parseInt(a.g/e),255),a.b=Math.min(parseInt(a.b/e),255),"#"+a.r.toString(16)+a.g.toString(16)+a.b.toString(16)}function yt(t){return{r:parseInt(t.substr(1,2),16),g:parseInt(t.substr(3,2),16),b:parseInt(t.substr(5,2),16)}}function vt(t,e){for(var a=[],i=Math.ceil(t[0]/e)*e;i<=t[1];i=K.default.addFloats(i,e))a.push(i);return a}function bt(t,e,a,i,n,r){var o=parseFloat(t);if(0==o)return"";var s=8*r(o).length+4,l=n?kt(e):Tt(e);if(s>=l&&(i||s>=a-l)){if(o>0&&o<1e-4||o>99999.999)return o.toExponential(1);var u=5-Math.floor(o).toString().length;return r(parseFloat(o.toFixed(u>0?u:0)))}return r(o)}function _t(t,e,a,i){for(var n,r=0,o=[],s=Bt(t,a,i),l=n=s.width<=e?e/2-s.width/2:20,u=0;u<t.length;u++)0!==u&&n+s.values[u-1].width+s.values[u].width<e?n+=s.values[u-1].width:(o.push(u),r+=1,n=s.width<=e?e/2-s.width/2:20);return{rows:r,maxWidth:s.keysWidth,firstInRow:o,posX:l}}function wt(t){var e=t.offset().left,a=kt(t);return{left:e,right:e+a,width:a}}function St(t){var e=t.offset().top,a=Tt(t);return{top:e,bottom:e+a,height:a}}function kt(t){return t[0].getBoundingClientRect().width}function Tt(t){return t[0].getBoundingClientRect().height}function Pt(t,e){var a=wt(t);0!==a.width&&e.each((function(){for(var t=$(this),e=wt(t),i=13,n=parseFloat(t.attr("x"))||0;(e.left<a.left||e.right>a.right)&&i>0;){t.css("font-size",i--);var r=e.width;(e=wt(t)).left<a.left&&e.right<=a.right?(n=n+r-kt(t),t.attr("x",n)):e.right>a.right&&e.left>=a.left&&(n=n-r+kt(t),t.attr("x",n))}}))}function Ct(t,e){var a=0,i=$("<span/>");return $("body").append(i),t.ticks().forEach((function(n){i[0].textContent=(e.tickFormat()||t.tickFormat())(n),a=Math.max(i.width(),a)})),i.remove(),a}function Ft(t){return"M"+(t=t.map((function(t){return t.join(",")}))).join("L")+"Z"}function At(){return $("body").css("font-family")}function Lt(t,e,a,i){var n;e.selectAll(a).on("mouseover",(function(e,i){clearTimeout(n);var r=$(this);r.is(a)||(r=r.parent()),t.show(i,r[0])})).on("mouseout",(function(){n=setTimeout((function(){n=null,i.tipHover||t.hide()}),50)}))}function Mt(t,e){e.forEach((function(e){-1===$.inArray(e,t)&&t.push(e)}))}function Dt(t,e){if(t.isGantt)return e?t.pieKeys:t.ganttCatColors||[];if(t.multiple){var a=t.chartKeys?t.chartKeys.slice():[];return e&&a.length<t.columnsCache.length*t.aggregationCache.length&&(t.columnsCache.length>1&&t.aggregation.length>1?t.columnsCache.forEach((function(e){t.aggregationCache.forEach((function(t){var i=t+" - "+e;-1===a.indexOf(i)&&a.push(i)}))})):t.columnsCache.length>1?t.columnsCache.forEach((function(t){-1===a.indexOf(t)&&a.push(t)})):t.aggregationCache.forEach((function(t){-1===a.indexOf(t)&&a.push(t)}))),a}return e?t.pieKeys:t.pieKeys.slice(0,t.visiblePieKeysLength)}function Bt(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30,i=$("<span></span>");$("body").append(i);var n={values:It(t,e),width:0,keysWidth:0};return n.values.forEach((function(t){t.view.length>ut.textMaxLength&&(t.view=t.view.substr(0,ut.textMaxLength-1)+"…"),t.width=parseInt(i.text(t.view).width())+a,n.width+=t.width,n.keysWidth=Math.max(n.keysWidth,t.width-a)})),i.remove(),n}function It(t,e){var a=[],i=e?function(t){var e=t.concat().sort((function(t,e){return t.localeCompare(e)})),a=e[0],i=e[e.length-1],n=a.length,r=0;for(;r<n&&a.charAt(r)===i.charAt(r);)r++;return Math.min(r,a.substring(0,r).lastIndexOf(" ")+1)}(t):0;return t.forEach((function(t){var e=i>3?t.substring(i):t;!e&&t&&(e="Total"),a.push({key:t,view:e})})),a}ut.textMaxLength=20,ut.maxTextWidth=150,ut.minHorizontalTextWidth=200,ut.prototype.initElements=function(t){var e=this;e.content=$('[id="chart'+e.macroId+'"][data-pageid="'+e.pageId+'"][data-sessionid="'+e.sessionId+'"]'),e.chartBody=e.content.find(".chart-body"),e.chartBody=K.default.addExcerpt(e.chartBody,"chart-body"),e.chartBody=K.default.addIframe(e.chartBody,"chart-body",(function(t){e.chartBody=t,e.getOriginalTable(),e.setControls(),e.draw()})),e.wrapper=e.content.find(".chart-wrapper"),e.svgWrapper=e.wrapper.find(".svg-wrapper"),e.chart=o.selectAll('[id="chart'+e.macroId+'"][data-pageid="'+e.pageId+'"][data-sessionid="'+e.sessionId+'"] .svg-wrapper'),e.canvas=e.content.find("canvas"),e.png=e.content.find("#pngdataurl"),e.columnSelect=e.content.find(".chart-column"),e.aggregationSelect=e.content.find(".chart-aggregation"),e.typeSelect=e.content.find(".chart-type"),e.is3DInput=e.content.find(".is3d"),e.is3D=e.is3DInput.is(":checked"),e.heightInput=e.content.find(".chart-height"),e.widthInput=e.content.find(".chart-width"),e.is3DWrapper=e.content.find(".is3d-wrapper"),e.noTableMessage=e.wrapper.find(".no-table-message"),e.previewTutorial=e.content.find(".preview-tutorial"),e.badSettings=e.wrapper.find(".bad-settings-message"),e.wrongDateFormat=e.wrapper.find(".wrong-date-message"),e.noDataMessage=e.wrapper.find(".no-data-message"),e.customMessage=e.wrapper.find(".custom-message"),e.logZeroMessage=e.wrapper.find(".log-zero-message"),e.loader=e.wrapper.find("#chart-loading"),e.controls=e.wrapper.find(".chart-controls"),e.settings=e.controls.find(".chart-settings"),e.menu=e.content.find("#chart-menu-view-".concat(e.macroId,"-").concat(e.pageId,"-").concat(e.sessionId)),e.showRawDataItem=e.menu.find(".chart-showrawdata"),e.hideRawDataItem=e.menu.find(".chart-hiderawdata"),e.selectColors=e.menu.find(".chart-change-color"),e.btn=e.menu.find(".chart-save").not("body.content-preview .chart-save"),e.download=e.menu.find(".save-as-png"),e.dateFormatInput=e.wrongDateFormat.find(".chart-date-format"),e.setInterpolationBtn=e.menu.find(".chart-set-interpolation"),e.changeLineSettingsBtn=e.menu.find(".chart-set-line-settings"),e.checkPivotContent()},ut.prototype.setStoreParams=function(){var t=this;t.storedParams={column:t.getSaveParams(t.columns),aggregation:t.getSaveParams(t.aggregation),type:t.type,"tfc-height":t.heightInput.val(),"tfc-width":t.widthInput.val(),hide:t.hide,colors:t.colors,pieKeys:t.pieKeys,is3d:t.is3D,lineSettings:t.lineSettings,interpolation:t.interpolation}},ut.prototype.getStoreParams=function(){return this.storedParams},ut.prototype.checkPivotContent=function(){var t=this;t.pivotContent=t.chartBody.find(".pivot-content"),t.isPivot=t.pivotContent.length>0},ut.prototype.initFormaters=function(){var t=this;t.formatNum=D()({mark:t.separator,thousand:" "}),t.formatNumShort=D()({mark:t.separator,thousand:""}),t.formatNumTo=function(e,a){var i=K.default.formatValueByType(e,a&&t.valueType instanceof Object?t.valueType[a]:t.valueType,(function(e){return Math.abs(e)>=1e4?t.formatNum.to(e):t.formatNumShort.to(e)}),t.worklog),n=a&&t.valueFormatter instanceof Object&&"function"!=typeof t.valueFormatter?t.valueFormatter[a]:t.valueFormatter;return n?n(i):i},t.formatNumToX=function(e){var a=K.default.formatValueByType(e,t.xValueType,(function(e){return Math.abs(e)>=1e4?t.formatNum.to(e):t.formatNumShort.to(e)}),t.worklog);return t.xValueFormatter?t.xValueFormatter(a):a}},ut.prototype.trimParams=function(t){for(var e=0;e<t.length;e++)t[e]=t[e].replace("‌",""),t.indexOf(t[e])!==e&&t.splice(e--,1)},ut.prototype.getSaveParams=function(t){for(var e=[],a=0;a<t.length;a++)""==t[a]?e.push("‌"):e.push(t[a]);return e.length?e.join("‚"):""},ut.prototype.getDimension=function(){var t=this;if(t.height=t.heightInput.val(),t.width=t.widthInput.val(),t.adaptiveDimensions=!1,K.default.isNumber(t.width))t.width=parseInt(t.width);else{for(var e=t.content;!e.is(":visible")&&e.length;)e=e.parent();t.width=e.width()-20;var a=$("body.content-preview").length>0;a||"none"===t.controls.css("display")||(t.width-=190),a&&(t.width=t.width>300?t.width:$(window.parent).width()-250),t.adaptiveDimensions=!0}K.default.isNumber(t.height)?t.height=parseInt(t.height):("undefined"!=typeof AP?t.height=Math.round(9*t.width/16):(t.height=Math.min(.7*window.innerHeight,600),t.height=t.height<300?300:t.height),t.adaptiveDimensions=!0)},ut.prototype.bindPageResize=function(){var t=this;if(t.widthInput.val().trim())t.resizeSensor&&t.resizeSensor.detach();else{var e=$(".wiki-content, .ac-content, .touch-tile"),a=e.width();t.resizeSensor=new L.ResizeSensor(e[0],(function(){var i=e.width();Math.abs(i-a)>17&&(a=i,t.getDimension(),t.draw(!0))}))}},ut.prototype.getType=function(){var t=this;t.type=t.typeSelect.val(),t.isTime=-1!=t.type.indexOf("Time"),t.isSeries="Line"==t.type||"Area"==t.type||"Stacked Area"==t.type,t.isArea=-1!=t.type.indexOf("Area"),t.isBar=t.type.indexOf("Bar")>=0||t.type.indexOf("Column")>=0,t.isGantt=t.type.indexOf("Gantt")>=0,t.isBubblePie="Bubble Pie"===t.type,t.isRadar="Radar"===t.type,t.multiple=t.isBar||t.isSeries||t.isTime||t.isGantt,t.isTime?(t.content.find("label.simple-text, label.series-text, label.bubble-text").hide(),t.content.find("label.time-text").show()):t.isSeries?(t.content.find("label.simple-text, label.time-text, label.bubble-text").hide(),t.content.find("label.series-text").show()):t.isBubblePie?(t.content.find("label.simple-text, label.time-text, label.series-text").hide(),t.content.find("label.bubble-text").show()):(t.content.find("label.time-text, label.series-text, label.bubble-text").hide(),t.content.find("label.simple-text").show()),t.isTime||t.isSeries||t.isGantt||t.isBubblePie||t.isRadar?(t.is3DWrapper.hide(),t.typeSelect.removeClass("short")):(t.is3DWrapper.show(),t.typeSelect.addClass("short"))},ut.prototype.getOriginalTable=function(){var t=this,e=t.tabs&&K.default.hasTabs(t.chartBody);t.originalTable=K.default.getTableNodes(t.chartBody).filter((function(){var t=$(this);return!(e&&K.default.hasInactiveTab(t))})),t.isPivot||(K.default.normalizeTable(t.originalTable),K.default.processMergedCells(t.originalTable)),t.originalTable.unbind("sortEnd.tfchart-".concat(t.macroId)).bind("sortEnd.tfchart-".concat(t.macroId),(function(){t.sorting=!1,t.setMutationObserver(),t.getTable(),t.draw(!0)})).unbind("sortStart.tfchart-".concat(t.macroId)).bind("sortStart.tfchart-".concat(t.macroId),(function(){t.sorting=!0,t.setMutationObserver()})),t.resetDateFormats(),K.default.setPaginationMsg(t.chartBody),t.getTable()},ut.prototype.resetDateFormats=function(){var t=this;t.dateFormats=[],t.locales=[],t.originalTable.each((function(){t.dateFormats.push([]),t.locales.push([])}))},ut.prototype.updateSettingsForPivot=function(){var t=this;t.isPivot&&(t.columnSelect.parent().hide(),t.aggregationSelect.parent().hide(),t.columnHidden=!0,t.aggregationHidden=!0,(K.default.getRawColumns(t.tables).length>2||t.isGantt)&&(t.aggregationSelect.parent().show(),t.aggregationHidden=!1,t.columnSelect.parent().show(),t.columnHidden=!1))},ut.prototype.bindUpdate=function(){var t=this,e=function(e){e&&(t.getOriginalTable(),t.setControls()),t.draw()};K.default.bindTFACEvents(t.chartBody,".pivot-content, .tablefilter-table-wrapper","tf-filtered pt-calculated",(function(a){return e("tf-filtered"!==a.type||t.isPivot)}))||t.chartBody.bind("tf-filtered-charts",(function(){e(!1)}));var a=null;t.chartBody.bind("tf-jira-updated DOMCharacterDataModified changed.chk",(function(t){K.default.isIgnoreCharacterModified(t)||(clearTimeout(a),a=setTimeout((function(){e(!0)}),100))}));var i=function(i,n){if(!i.parents(".pivot-table").length)return!K.default.isIgnoreUpdateNode(i)&&(n.className===t.chartBody[0].className||K.default.hasRowForUpdate(i)||K.default.hasTableForUpdate(i)||K.default.hasCharsForUpdate(i,n))?(clearTimeout(a),a=setTimeout((function(){a=null,e(!0)}),100),!0):void 0};t.observer=new MutationObserver((function(t){K.default.mutationObserverFilter(t,i)})),t.setMutationObserver(),t.tabs&&K.default.onTabChange(t.chartBody,(function(){e(!0)})),t.chartBody.bind("tf-save",(function(){return t.content.trigger("tf-save"),!1})).bind("tf-export-ready",(function(e,a){return t.macroId===a.macroId}))},ut.prototype.setMutationObserver=function(){var t=this;if(t.observer)if(t.sorting)t.observer.disconnect();else{var e={childList:!0,subtree:!0};t.chartBody.each((function(){t.observer.observe(this,e)}))}},ut.prototype.setChosen=function(){var t=this;t.setChosenSelect(t.columnSelect,t.columns,t.columnsCache,!0),t.setChosenSelect(t.aggregationSelect,t.aggregation,t.aggregationCache,!1)},ut.prototype.setChosenSelect=function(t,e,a,i){var n=this;t.chosenTF({max_selected_options:i&&n.isBubblePie?2:void 0,no_results_text:"No matches for",placeholder_text_multiple:"Click and start typing...",display_selected_options:!1,width:"178px"}).change((function(r,o){null!=o.selected?(t.find("option").filter((function(){return this.textContent==o.selected})).prop("selected","selected"),e.push(o.selected)):null!=o.deselected&&(t.find("option").filter((function(){return this.textContent==o.deselected})).prop("selected",!1),e.splice($.inArray(o.deselected,e),1)),i&&!n.isGantt&&(n.pieKeys=[],n.visiblePieKeysLength=0),a.length=0,$.merge(a,e),n.aggregationChange=!1,n.columnsChange=!1,n.enableSaveBtn(),n.draw()}));var r=t.parent().find(".chosen-choices");r.sortable({tolerance:"pointer",cursor:"move",helper:"clone",items:".search-choice",stop:function(){var t=e.slice();if(e.length=0,r.find(".search-choice").each((function(){e.push(this.textContent)})),a.length=0,$.merge(a,e),!n.isGantt&&n.multiple){var i=n.colors.slice();t.forEach((function(t,a){var r=$.inArray(t,e);r>=0&&i.length>r&&(n.colors[r]=i[a])})),n.colorsCache=n.colors.slice()}n.btn.prop("disabled",!1),n.enableSaveBtn(),n.draw()}})},ut.prototype.bindUI=function(){var t=this;t.typeSelect.change((function(){t.getType(),t.shiftInterpolationBtn(),t.shiftChangeLineSettingsBtn(),t.enableSaveBtn(),t.draw()}));var e=null;t.heightInput.add(t.widthInput).bind("input",(function(){clearTimeout(e),e=setTimeout((function(){t.getDimension(),t.enableSaveBtn(),t.draw(),t.bindPageResize()}),330)})),t.is3DInput.change((function(){t.is3D=t.is3DInput.is(":checked"),t.enableSaveBtn(),t.draw()})),t.btn.click((function(e){var a,i;t.btn.toggleClass("tf-disabled-link"),t.controls.add(t.btn).find(".tfac-unsaved").hide(),tt.default.removeFromUnloadPageAction(t),t.type&&(t.type.indexOf("Line")>=0||t.type.indexOf("Area")>=0)&&(a=t.calcInterpolation(),t.type.indexOf("Line")>=0&&(i=t.calcLineSettings()));var n={column:t.getSaveParams(t.columns),aggregation:t.getSaveParams(t.aggregation),type:t.type,"tfc-height":t.heightInput.val(),"tfc-width":t.widthInput.val(),hide:t.hide,colors:t.colors.slice(0,t.getAllChartColorLabels().length).join(","),pieKeys:t.pieKeys.join("‚"),is3d:t.is3D};Q.default.gaChartSaveChange(n,t.getStoreParams()),Z.saveChanges(t.pageId,t.macroId,n.column,n.aggregation,n.type,n["tfc-height"],n["tfc-width"],n.hide,n.colors,n.pieKeys,n.is3d,void 0,t.content,t.version,a,i,t.getInnerLabelsParam()),t.content.trigger("tf-save",t.getExportEventData()),e.preventDefault()})),t.menu.find(".tf-remove").click((function(e){e.preventDefault(),K.default.createDialogRemoveMacro(t,"Chart from Table","Chart from Table")})),t.showRawDataItem.click((function(e){t.hide=!1,t.hideRawDataItem.parent().show(),t.showRawDataItem.parent().hide(),t.chartBody.removeClass("chart-hidden"),t.enableSaveBtn(),e.preventDefault()})),t.hideRawDataItem.click((function(e){t.hide=!0,t.showRawDataItem.parent().show(),t.hideRawDataItem.parent().hide(),t.chartBody.addClass("chart-hidden"),t.enableSaveBtn(),e.preventDefault()}));var a=t.menu.find(".export-file-pdf"),i=t.menu.find(".export-file-doc");void 0===A.saveAs?(a.hide(),i.hide()):(a.click((function(e){q.default.loadScriptsBeforeExport((function(){K.default.exportToPdf(t.getExportContent(),!0)})),e.preventDefault()})),i.click((function(e){K.default.exportToDoc(t.getExportContent()),e.preventDefault()})));var n=J.default.initChartColorsDialog(t),r=J.default.initInterpolationDialog(t),o=J.default.initLineSettingsDialog(t),s=!1;t.menu.find(".chart-change-color").click((function(e){s=!0,n.show(),t.controls.addClass("active"),e.preventDefault()})),t.setInterpolationBtn.click((function(e){s=!0,r.show(),t.controls.addClass("active"),e.preventDefault()})),t.changeLineSettingsBtn.click((function(e){s=!0,o.show(),t.controls.addClass("active"),e.preventDefault()})),t.controls.find(".aui-dropdown2").bind("aui-dropdown2-show",(function(){t.controls.addClass("active")})).bind("aui-dropdown2-hide",(function(){s?s=!1:t.controls.removeClass("active")}));var l=null;t.dateFormatInput.bind("change selected keyup",(function(e){var a=function(){t.dateFormat=t.dateFormatInput.val().trim(),t.resetDateFormats(),t.draw()&&Z.saveDateFormat(t.pageId,t.macroId,t.dateFormat)};"keyup"===e.type?13===e.which&&a():(clearTimeout(l),l=setTimeout((function(){a()}),300))})),window.MSInputMethodContext&&document.documentMode&&t.download.click((function(){window.navigator.msSaveBlob(t.canvas[0].msToBlob(),"Chart.jpg")})),t.shiftInterpolationBtn(),t.shiftChangeLineSettingsBtn()},ut.prototype.getExportContent=function(){var t=this,e=t.png;return t.hide||(e=e.add(t.chartBody.not(".table-excerpt"))),e},ut.prototype.calcInterpolation=function(){var t=this,e=[];return t.interpolation instanceof Array?t.chartKeys.forEach((function(a,i){e.push(i<t.interpolation.length?t.interpolation[i]:t.defaultInterpolation)})):t.chartKeys.forEach((function(a,i){e.push(t.interpolation[a]?t.interpolation[a]:t.defaultInterpolation)})),e.join(",")},ut.prototype.calcLineSettings=function(){var t=this,e=[],a="solid-1.5";return t.lineSettings instanceof Array?t.chartKeys.forEach((function(i,n){e.push(n<t.lineSettings.length?t.lineSettings[n]:a)})):t.chartKeys.forEach((function(i,n){e.push(t.lineSettings[i]?t.lineSettings[i].type+"-"+t.lineSettings[i].width:a)})),e.join(",")},ut.prototype.getChartColorLabels=function(){return Dt(this)},ut.prototype.getAllChartColorLabels=function(){return Dt(this,!0)},ut.prototype.getTable=function(){var t=this,e=K.default.getTablesAndRowsFromTables(t.originalTable,K.default.mixedType,null,t.transpose);t.rows=e.rows,t.tables=e.tables},ut.prototype.setControls=function(){var t=this;t.updateSettingsForPivot();var e=K.default.getRawColumns(t.tables),a=e.slice().sort((function(t,e){return t.localeCompare(e)}));if(t.columnSelect.empty(),t.aggregationSelect.empty(),a.length){t.tableColumnsCache&&($(t.tableColumnsCache).not(a).length>0||$(a).not(t.tableColumnsCache).length>0)&&(t.aggregationChange&&(t.aggregation.length=0,$.merge(t.aggregation,t.aggregationCache),t.multiple&&!t.isGantt&&(t.colors=t.colorsCache.slice())),t.columnsChange&&(t.columns.length=0,$.merge(t.columns,t.columnsCache))),t.tableColumnsCache=a.slice();var i=document.createDocumentFragment(),n=document.createDocumentFragment();$.each(a,(function(a,r){var o=$.inArray(r,t.columns)>=0||t.isPivot&&($.inArray(r+" "+"Total",t.columns)>=0||$.inArray(r.replace(" "+"Total",""),t.columns)>=0)||!t.isPivot&&0==t.columns.length&&0==$.inArray(r,e)?'selected="selected"':"";i.appendChild($("<option "+o+"></option>").text(r)[0]),o=$.inArray(r,t.aggregation)>=0||t.isPivot&&($.inArray(r+" "+"Total",t.aggregation)>=0||$.inArray(r.replace(" "+"Total",""),t.aggregation)>=0)||!t.isPivot&&0==t.aggregation.length&&1==$.inArray(r,e)?'selected="selected"':"",n.appendChild($("<option "+o+"></option>").text(r)[0])})),t.columnSelect.append(i),t.aggregationSelect.append(n),$.each(t.columns.slice(),(function(e,i){-1!=$.inArray(i,a)||t.isPivot&&(-1!=$.inArray(i+" "+"Total",a)||-1!=$.inArray(i.replace(" "+"Total",""),a))||(t.columns.splice($.inArray(i,t.columns),1),t.columnsChange=!0)})),$.each(t.aggregation.slice(),(function(e,i){if(-1==$.inArray(i,a)&&(!t.isPivot||-1==$.inArray(i+" "+"Total",a)&&-1==$.inArray(i.replace(" "+"Total",""),a))){var n=$.inArray(i,t.aggregation);t.aggregation.splice(n,1),t.aggregationChange=!0,t.multiple&&!t.isGantt&&t.colors.splice(t.aggregationCache.length-1,0,t.colors.splice(n,1)[0])}})),t.isPivot?(0==t.columns.length&&void 0!==e[0]&&(t.columns.push(e[0]),t.columnSelect.find("option").filter((function(){return this.textContent===e[0]})).prop("selected",!0)),0==t.aggregation.length&&void 0!==e[e.length-1]&&(t.aggregation.push(e[e.length-1]),t.aggregationSelect.find("option").filter((function(){return this.textContent===e[e.length-1]})).prop("selected",!0))):(0==t.columns.length&&(t.columns.push(e[0]),t.transpose&&e[0]&&t.columnSelect.find("option").filter((function(){return this.textContent===e[0]})).prop("selected",!0)),0==t.aggregation.length&&(t.aggregation.push(e[1]),t.transpose&&e[1]&&t.aggregationSelect.find("option").filter((function(){return this.textContent===e[1]})).prop("selected",!0)))}t.columnSelect.trigger("chosen:updated"),t.aggregationSelect.trigger("chosen:updated"),K.default.sortSelectedOptions(t.columnSelect,t.columns),K.default.sortSelectedOptions(t.aggregationSelect,t.aggregation)},ut.prototype.getDateFormat=function(t,e){var a=this;return K.default.setDateFormatForColumn(a.dateFormats[t],a.locales[t],a.dateFormat,a.locale,a.localeDateFormat,e,a.rows[t],a.hasTimeFormat,a.tables[t]),a.workingDateFormat=a.dateFormats[t][e],a.dateFormats[t][e]},ut.prototype.calculateBubblePieData=function(t){var e=this,a=[];if(2!==e.columns.length||0===e.aggregation.length)return a;e.bubblePieSetting={},e.bubblePieSetting.axisX={title:e.columns[0],order:[]},e.bubblePieSetting.axisY={title:e.columns[1],order:[]},e.bubblePieSetting.indicator={valueType:null},e.bubblePieSetting.sameValuesCount={},e.bubblePieSetting.filterAggregation=[];var i=[],n=[];e.tables.forEach((function(r,o){r.forEach((function(r,s){if(0===s)i=r.slice(0);else if(t[o][s]){for(var l,u,c,h,d={},p=[],g=0,f=r.length;g<f;g++){var m=e.getDateFormat(o,g),x=e.locales[o][g];if(i[g]===e.bubblePieSetting.axisX.title&&r[g])null===e.xValueType&&(e.xValueType=K.default.getAnyValueType(r[g],e.separator,e.worklog,!0,m,x)),null!==e.xValueType?(e.bubblePieSetting.axisX.dateFormat=m,l=K.default.parseAnyValueByType(e.xValueType,r[g],e.separator,e.worklog,!0,m,x),K.default.isNumber(l)&&e.xValueType===K.default.number&&!e.xValueFormatter&&(e.xValueFormatter=K.default.getNumberFormatter(r[g],e.separator)),(void 0===e.bubblePieSetting.axisX.maxValue||e.bubblePieSetting.axisX.maxValue<l)&&(e.bubblePieSetting.axisX.maxValue=l),(void 0===e.bubblePieSetting.axisX.minValue||e.bubblePieSetting.axisX.minValue>l)&&(e.bubblePieSetting.axisX.minValue=l)):l=r[g],e.bubblePieSetting.axisX.order.includes(l)||e.bubblePieSetting.axisX.order.push(l);else if(i[g]===e.bubblePieSetting.axisY.title&&r[g])null===e.valueType&&(e.valueType=K.default.getAnyValueType(r[g],e.separator,e.worklog,!0,m,x)),n.push(r[g]),null!==e.valueType?(e.bubblePieSetting.axisY.dateFormat=m,u=K.default.parseAnyValueByType(e.valueType,r[g],e.separator,e.worklog,!0,m,x),K.default.isNumber(u)&&e.valueType===K.default.number&&!e.valueFormatter&&(e.valueFormatter=K.default.getNumberFormatter(r[g],e.separator)),(void 0===e.bubblePieSetting.axisY.maxValue||e.bubblePieSetting.axisY.maxValue<u)&&(e.bubblePieSetting.axisY.maxValue=u),(void 0===e.bubblePieSetting.axisY.minValue||e.bubblePieSetting.axisY.minValue>u)&&(e.bubblePieSetting.axisY.minValue=u)):u=r[g],e.bubblePieSetting.axisY.order.includes(u)||e.bubblePieSetting.axisY.order.push(u);else{if(!e.aggregation.includes(i[g])||!r[g])continue;null===e.bubblePieSetting.indicator.valueType&&(e.bubblePieSetting.indicator.valueType=K.default.getAnyValueType(r[g],e.separator,e.worklog,!0,m,x)),[K.default.number,K.default.worklog,K.default.duration].includes(e.bubblePieSetting.indicator.valueType)&&(h=K.default.getAnyValueType(r[g],e.separator,e.worklog,!0,m,x))===e.bubblePieSetting.indicator.valueType&&(c=K.default.parseAnyValueByType(h,r[g],e.separator,e.worklog,!0,m,x),e.bubblePieSetting.filterAggregation.includes(i[g])||e.bubblePieSetting.filterAggregation.push(i[g]),p.push({indicator:i[g],value:c>0?c:null}))}}p.length>0&&l&&u&&p.forEach((function(t){d[e.bubblePieSetting.axisX.title]=l,d[e.bubblePieSetting.axisY.title]=u,d.indicator=t.indicator,d.value=t.value,d.tableI=o,d.rowI=s,a.push(JSON.parse(JSON.stringify(d))),e.valueType!==K.default.number&&e.xValueType!==K.default.number&&e.valueType!==K.default.duration&&e.xValueType!==K.default.duration||(l=JSON.parse(JSON.stringify(l)),u=JSON.parse(JSON.stringify(u)),e.bubblePieSetting.sameValuesCount[l+"_"+u]>0?e.bubblePieSetting.sameValuesCount[l+"_"+u]+=1:e.bubblePieSetting.sameValuesCount[l+"_"+u]=1)}))}}))})),e.bubblePieSetting.filterAggregation.sort((function(t,a){return e.aggregation.indexOf(t)-e.aggregation.indexOf(a)})),e.bubblePieSetting.filterAggregation.length>0&&(e.pieKeys=e.bubblePieSetting.filterAggregation.slice(0)),e.visiblePieKeysLength=e.pieKeys.length,e.colors=e.getColorsFromMap(e.colorKeyMap,e.pieKeys,e.palette),e.colorsCache=e.colors.slice(),e.calcBubbleChartExtremum(),e.filterBubbleChartData(a);var r=function(t){return null==t||t!==K.default.date&&t!==K.default.worklog&&t!==K.default.number&&t!==K.default.duration};e.bubleMaxTextWidthX=ut.maxTextWidth,e.bubleMaxTextWidthY=ut.maxTextWidth,e.bubblePieSetting.axisY.longestTitleObject=it(e.bubblePieSetting.axisY.order);var o=e.bubblePieSetting.axisY.longestTitleObject.width;return e.bubblePieSetting.axisY.longestTitle=(r(e.valueType)?Math.min(o,e.bubleMaxTextWidthY):o)+9,r(e.xValueType)&&(e.bubblePieSetting.axisX.longestTitleObject=it(e.bubblePieSetting.axisX.order)),a},ut.prototype.filterBubbleChartData=function(t){for(var e=this,a=e.bubblePieSetting.axisX.title,i=e.bubblePieSetting.axisY.title,n=e.bubblePieSetting.axisX.minValue,r=e.bubblePieSetting.axisX.maxValue,o=e.bubblePieSetting.axisY.minValue,s=e.bubblePieSetting.axisY.maxValue,l=t.length-1;l>=0;){var u=t[l][i],c=t[l][a],h=e.valueType===K.default.date?K.default.toDateObject(u):u,d=e.xValueType===K.default.date?K.default.toDateObject(c):c;r&&d>r||n&&d<n||s&&h>s||o&&h<o?t.splice(l,1):(e.valueType!==K.default.number&&e.valueType!==K.default.duration||(t[l]["orig_"+i]=u,t[l][i]=parseFloat(u/e.bubblePieSetting.sameValuesCount[c+"_"+u])),e.xValueType!==K.default.number&&e.xValueType!==K.default.duration||(t[l]["orig_"+a]=c,t[l][a]=parseFloat(c/e.bubblePieSetting.sameValuesCount[c+"_"+u]))),l-=1}},ut.prototype.calculate=function(){var t=this,e=[],a={};t.parsedDate=!1,t.ganttCategories=[],t.ganttCatColors=[],t.textWidth=0,t.argumentWidth=0,t.aggregationWidth=0,t.valueType=t.isRadar?{}:null,t.xValueType=null,t.valueFormatter=t.isRadar?{}:null,t.xValueFormatter=null,t.chartKeys=[];var i=$("<span></span>");i.appendTo("body"),t.columnWidth=0;var n=K.default.getRelevantRows(t.rows,t.transpose);if(t.isBubblePie)return t.calculateBubblePieData(n);var r=t.columnHidden,o=t.aggregationHidden;(t.isSeries||t.isTime)&&(r=t.aggregationHidden,o=t.columnHidden);var s=t.isSeries||t.isTime?t.aggregation:t.columns,l=t.isSeries||t.isTime?t.columns:t.aggregation;if($.each(s,(function(e,n){i.text(n),a[n]=[],t.columnWidth=Math.max(t.columnWidth,i.width())})),$.each(l,(function(e,n){i.text(n),a[n]=[],t.aggregationWidth=Math.max(t.aggregationWidth,i.width())})),t.tables.forEach((function(i,u){var c=[],h=[];$.each(s,(function(e,a){var n=r?t.isSeries||t.isTime?1:0:K.default.getCellPosition(i,a);c.push(n)})),$.each(l,(function(e,a){var n=o?t.isSeries||t.isTime?0:1:K.default.getCellPosition(i,a);h.push(n)})),c.length&&h.length&&i.forEach((function(i,r){r>0&&n[u][r]&&c.some((function(n,o){if(null!==n){var d=s[o],p=i[n];if(t.isGantt){var g={id:e.length,category:p,label:c.length>1?d:"",hint:p,rowNumber:ct({},u,r)},f=0,m=!1,x=t.textWidth;-1===$.inArray(p,t.ganttCategories)&&(t.ganttCategories.push(p),m=!0,t.ganttCatColors.push(p),h.length>2&&(t.ganttCatColors.push(p+" - Done"),t.ganttCatColors.push(p+" - Todo")))}if(h.forEach((function(n,o){if(null!=n){var s=l[o],m=i[n];if(t.isGantt){if(2==f)m=K.default.parseNumber(m,t.separator),K.default.isNumber(m)&&(m=m>1?m/100:m,g.progress=m);else try{if(!m)return!0;g.text=m,m=K.default.parseDate(m,t.getDateFormat(u,n),t.locales[u][n]),t.parsedDate=!0,0==f?g.startDate=m:g.endDate=m}catch(t){return AJS.log("Error while parsing date '"+m+"': "+t),!0}f++}else{var x;t.isTime||t.isSeries?(x=d,h.length>1&&(x=c.length>1?x+" - "+s:s)):(x=s,!t.isRadar&&c.length>1&&(x=h.length>1?x+" - "+d:d)),a[x]||(a[x]=[]);var y=t.isRadar?p:x;if(-1===t.chartKeys.indexOf(y)&&t.chartKeys.push(y),t.isTime)try{if(!m)return!0;p&&null==t.valueType&&(t.valueType=K.default.getValueType(p,t.separator,t.worklog));var v=p;if(p=K.default.parseValueByType(t.valueType,p,t.separator,t.worklog),m=K.default.parseDate(m,t.getDateFormat(u,n),t.locales[u][n]),t.parsedDate=!0,!K.default.isNumber(p))return!0;t.valueType!==K.default.number||t.valueFormatter||(t.valueFormatter=K.default.getNumberFormatter(v,t.separator))}catch(t){return AJS.log("Error while parsing date '"+m+"': "+t),!0}else if(t.isSeries){p&&null==t.valueType&&(t.valueType=K.default.getValueType(p,t.separator,t.worklog)),m&&null==t.xValueType&&(t.xValueType=K.default.getValueType(m,t.separator,t.worklog));v=p;var b=m;if(p=K.default.parseValueByType(t.valueType,p,t.separator,t.worklog),m=K.default.parseValueByType(t.xValueType,m,t.separator,t.worklog),K.default.isNumber(p)&&t.valueType===K.default.number&&!t.valueFormatter&&(t.valueFormatter=K.default.getNumberFormatter(v,t.separator)),K.default.isNumber(m)&&t.xValueType===K.default.number&&!t.xValueFormatter&&(t.xValueFormatter=K.default.getNumberFormatter(b,t.separator)),!K.default.isNumber(p)||!K.default.isNumber(m))return!0}else if(t.isRadar){m&&null==t.valueType[x]&&(t.valueType[x]=K.default.getValueType(m,t.separator,t.worklog));b=m;m=K.default.parseValueByType(t.valueType[x],m,t.separator,t.worklog),K.default.isNumber(m)?t.valueType[x]!==K.default.number||t.valueFormatter[x]||(t.valueFormatter[x]=K.default.getNumberFormatter(b,t.separator)):m=0}else{m&&null==t.valueType&&(t.valueType=K.default.getValueType(m,t.separator,t.worklog));b=m;if(m=K.default.parseValueByType(t.valueType,m,t.separator,t.worklog),!K.default.isNumber(m))return!0;t.valueType!==K.default.number||t.valueFormatter||(t.valueFormatter=K.default.getNumberFormatter(b,t.separator))}t.isTime||t.isSeries?-1===a[x].indexOf(m.valueOf())?(e.push({label:p,value:m,key:x,aggregation:s,rowNumber:ct({},u,r)}),a[x].push(m.valueOf())):e.forEach((function(t){t.key===x&&t.value.valueOf()===m.valueOf()&&(t.label=K.default.addFloats(t.label,p),ct(t.rowNumber,u,r))})):-1===a[x].indexOf(p)?(e.push({label:p,value:m,key:d,aggregation:x,rowNumber:ct({},u,r)}),a[x].push(p)):e.forEach((function(t){t.aggregation===x&&t.label===p&&(t.value=K.default.addFloats(t.value,m),ct(t.rowNumber,u,r))}))}t.isTime||t.isSeries||(t.textWidth=Math.max(t.textWidth,Math.min(at(p),ut.maxTextWidth)))}})),t.isGantt){if(g.startDate){var y;for(e.push(g),g.endDate||(g.label=""),y=o+1;y<c.length;y++)if(null!==c[y]&&i[c[y]]){if(g.label)g.label+="‌: ";else if(!m){var v=g.category+": "+i[c[y]];t.ganttCatColors.push(v)}g.label+=i[c[y]],g.hint=(g.hint?g.hint+" - ":"")+i[c[y]],o=y;break}for(y=o+1;y<c.length;y++)null!==c[y]&&i[c[y]]&&(g.hint=(g.hint?g.hint+" - ":"")+i[c[y]]);if(!g.endDate&&!g.label&&!m){var b=g.category+": milestone";-1===t.ganttCatColors.indexOf(b)&&t.ganttCatColors.push(b)}}return!m||g.endDate&&g.startDate||(t.ganttCategories.splice(-1,1),t.textWidth=x),!m||g.endDate||g.startDate||t.ganttCatColors.splice(-1,1),!(m&&h.length>2)||void 0!==g.progress&&g.startDate&&g.endDate||(t.ganttCatColors.splice(-1,1),t.ganttCatColors.splice(-1,1)),!0}}}))}))})),i.remove(),(t.isSeries||t.isTime)&&e.sort((function(t,e){return t.value>e.value?1:-1})),t.isGantt&&"mono"===t.barColoringType)t.ganttCatColors=["Task","Task - Done","Task - Todo","Milestone","Event"];else if(!t.multiple||t.isGantt){var u=[];t.isGantt?u=t.ganttCatColors:$.each(a,(function(t,e){e.forEach((function(t){-1===u.indexOf(t)&&u.push(t)}))})),u&&(t.visiblePieKeysLength=u.length,t.pieKeys=u.concat(t.pieKeys.filter((function(t){return-1===u.indexOf(t)}))))}else t.columns.forEach((function(e){var a=t.chartKeys.indexOf(e);a>=0&&t.chartKeys.push(t.chartKeys.splice(a,1)[0]),t.aggregation.forEach((function(a){var i=t.chartKeys.indexOf(a);i>=0&&t.chartKeys.push(t.chartKeys.splice(i,1)[0]);var n=a+" - "+e,r=t.chartKeys.indexOf(n);r>=0&&t.chartKeys.push(t.chartKeys.splice(r,1)[0])}))}));return t.colors=t.getColorsFromMap(t.colorKeyMap,t.getAllChartColorLabels(),t.palette),t.colorsCache=t.colors.slice(),e},ut.prototype.draw=function(t){var e=this;e.preventExport=t,e.clearTableHighlight(),e.svgWrapper.css({height:"",width:""}),e.svgWrapper.html(""),e.png.html(""),$("body").find("div.d3-tip.chart"+e.macroId+e.pageId).remove();var a=K.default.hasLoadingContent(e.chartBody)||K.default.hasAnyTFACUnfinishedContent(e.originalTable,e.chartBody);if(0===e.originalTable.length||a)e.isEditor&&e.isCloud&&!e.chartBody.data("hasFrame")?(e.previewTutorial.show(),e.loader.hide(),e.wrapper.hide()):(e.previewTutorial.hide(),e.badSettings.hide(),e.logZeroMessage.hide(),e.chartBody.data("hasFrame")||a?(e.noTableMessage.hide(),e.loader.show()):(e.noTableMessage.show(),e.loader.hide()));else{if(clearTimeout(e.timeoutDatePicker),!e.isTime&&!e.isGantt||$.datepicker){e.logZeroMessage.hide(),e.noTableMessage.hide(),e.previewTutorial.hide(),e.badSettings.hide(),e.wrongDateFormat.hide(),e.noDataMessage.hide(),e.customMessage.hide();var i=e.calculate();return e.calculatedData=i,0===i.length?(0===e.columns.length||0===e.aggregation.length?e.badSettings.show():!e.isTime&&!e.isGantt||e.parsedDate?e.noDataMessage.show():(e.wrongDateFormat.show(),e.dateFormatInput.hasClass("autocomplete")||(K.default.dateFormatAutocomplete(e.dateFormatInput),e.dateFormatInput.addClass("autocomplete"))),e.loader.hide(),e.selectColors.hide(),e.setInterpolationBtn.hide(),e.changeLineSettingsBtn.hide(),e.download.hasClass("tf-disabled-link")||e.download.toggleClass("tf-disabled-link"),void e.controls.animate({opacity:1},100)):(e.loader.hide(),e.selectColors.show(),e.shiftInterpolationBtn(),e.shiftChangeLineSettingsBtn(),e.download.hasClass("tf-disabled-link")&&e.download.toggleClass("tf-disabled-link"),e.controls.css("opacity",""),e.drawChart(i),!0)}e.timeoutDatePicker=setTimeout((function(){e.draw()}),100)}},ut.prototype.drawChart=function(t){var e=this;if(clearTimeout(e.chartTimer),e.content.is(":visible")){if("Donut"!==e.type||e.is3D)if(e.type.indexOf("Column")>=0)e.drawColumn(t);else if("Pie"!==e.type||e.is3D)if(e.type.indexOf("Bar")>=0)e.drawBar(t);else if(-1!==e.type.indexOf("Area")||-1!==e.type.indexOf("Line"))e.drawSeries(t);else if("Donut"===e.type&&e.is3D)e.drawDonut3D(t,.4);else if("Pie"===e.type&&e.is3D)e.drawDonut3D(t,0);else if(e.isGantt){if(1===e.aggregation.length)return void e.customMessage.show().find(".text").text("Gantt chart requires projects to have start and end dates. Please select start and end date columns.");e.drawGantt(t)}else e.isBubblePie?e.drawBubblePie(t):e.isRadar&&e.drawRadar(t);else e.drawPie(t,0);else e.drawPie(t,"40%");e.isLog&&e.multiple&&e.svgWrapper.find('[y="NaN"], [x="NaN"], [d*="NaN"]').length&&(e.logZeroMessage.show(),e.svgWrapper.html("")),(e.is3D||"Donut"!==e.type&&"Pie"!==e.type)&&setTimeout((function(){e.convertToImage()}),100)}else e.chartTimer=setTimeout((function(){e.drawChart(t)}),200)},ut.prototype.drawBubblePie=function(t){var e=this,a=u().newSvg(e.svgWrapper[0],e.width,e.height),i=new(u().chart)(a,t),n=e.setBubbleAxisX(i),r=e.setBubbleAxisY(i);e.bubblePieSetting.filterAggregation.map((function(t){i.assignColor(t,e.colorKeyMap[t],e.colorKeyMap[t],1)})),e.setBubbleAxisXScale(n),e.setBubbleAxisYScale(r),e.settingBubbleAxis(n,r),i.addMeasureAxis("p","value"),i.addMeasureAxis("z","value");var o=i.addSeries([e.bubblePieSetting.axisX.title,e.bubblePieSetting.axisY.title,"indicator"],u().plot.pie);null===e.xValueType&&n.addOrderRule(e.bubblePieSetting.axisX.order),null===e.valueType&&r.addOrderRule(e.bubblePieSetting.axisY.order),o.addOrderRule(e.bubblePieSetting.filterAggregation),o.tooltipFontSize="14px",e.calculateBubbleLegendSize();var s,l={top:20+e.titleHeight,right:20+(e.isLegendUnderGraph||!e.legend?0:10+e.bubblePieSetting.legendWidth),bottom:40+e.xtitleHeight+(e.isLegendUnderGraph?5+e.bubblePieSetting.legendHeight+(e.xtitleHeight?10:0):5),left:25+e.bubblePieSetting.axisY.longestTitle+e.ytitleHeight};i.setBounds(l.left,l.top,e.width-l.left-l.right,e.height-l.top-l.bottom),i.draw(),e.formatExtremumAxesX(n,o,l,i),i.draw(),e.maxSizeX=(s=0,n.shapes.selectAll("text").each((function(){s=Math.max(Tt($(this)),s)})),s);var c,h=function(){l={top:20+e.titleHeight,right:20+(e.isLegendUnderGraph||!e.legend?0:10+e.bubblePieSetting.legendWidth),bottom:40+e.maxSizeX+e.xtitleHeight+(e.isLegendUnderGraph?5+e.bubblePieSetting.legendHeight+(e.xtitleHeight?10:0):5),left:25+e.bubblePieSetting.axisY.longestTitle+e.ytitleHeight}};h(),e.optimizeBubbleMultilineWidth(l,n,r,h),e.addTitle(a,e.width+l.left-l.right,{top:0}),e.calculateBubbleLegendSize(),e.legend&&((c=i.addLegend(e.isLegendUnderGraph?l.left+e.bubblePieSetting.posX:e.width-l.right+10,e.isLegendUnderGraph?e.height-e.bubblePieSetting.legendHeight-20+(e.xtitleHeight?5:0):l.top,e.bubblePieSetting.legendWidth||e.width-l.left,e.bubblePieSetting.legendHeight,"left"))._getEntries=function(){var t=[];return Bt(e.bubblePieSetting.filterAggregation,e.isPivot).values.forEach((function(e){t.push({key:e.view,fill:i.getColor(e.key).fill,stroke:i.getColor(e.key).stroke,opacity:i.getColor(e.key).opacity,series:o,aggField:[e.key]})}),this),t}),i.setBounds(l.left,l.top,e.width-l.left-l.right,e.height-l.top-l.bottom),i.draw(),e.formatExtremumAxesY(r,o,l,i),i.draw(),e.settingSeriesTooltip(o),e.eventHandlerSeries(o,t),e.formatDimpleAxisX(n),e.legend&&(e.formatBubbleLegend(c),e.eventHandleLegendClick(i,c,t,(function(){return e.formatDimpleAxisX(n)}))),o.shapes.style("opacity",(function(t){return null===t.angle?0:1}))},ut.prototype.drawPie=function(t,e){var a=this,i=a.calcGroupSize(a.chartKeys.length);a.addGroupTitle();var n=o.scaleOrdinal().range(a.colors);n.domain(a.pieKeys);var r=0,s=[];a.chartKeys.forEach((function(o){var l=$.grep(t,(function(t){return t.aggregation==o})),u=l,c=pt(l);c.count>1&&(l=c.data);var h=[];u.forEach((function(t){-1!=$.inArray(t,l)&&t.value&&h.push(n(t.label))})),h.push("#a3acb2");var d={};(a.title||a.chartKeys.length>1)&&(d={title:{text:a.chartKeys.length>1?o:a.title,color:"#333333",fontSize:16,font:"arial"},location:"top-center"});var p=new F(a.svgWrapper[0],{header:d,data:{content:l},size:{canvasHeight:i.height,canvasWidth:i.width,pieInnerRadius:e},labels:{mainLabel:{fontSize:14},percentage:{color:function(t,e){return mt(h[e%h.length])},decimalPlaces:1,fontSize:14},value:{color:function(t,e){return mt(h[e%h.length])},fontSize:14},inner:{format:a.innerLabelsType.value_percentage?"value-percentage":a.innerLabelsType.percentage_value?"percentage-value":a.innerLabelsType.value?"value":a.showInnerLabels?"percentage":"none",hideWhenLessThanPercentage:4},outer:{format:"None"!==a.outerLabels?"label":"none"},formatter:function(t){var e=t.label;return"inner"===t.section&&("percentage"===t.part?e+="%":"value"===t.part&&(e=a.formatNumTo(t.value))),e}},tooltips:{enabled:!0,type:"placeholder",string:"{label}: {value} ({percentage}%)",placeholderParser:function(t,e){e.value=a.formatNumTo(e.value)},styles:{color:"white",backgroundColor:"black",backgroundOpacity:.8,padding:12,fontSize:14}},callbacks:{onload:function(){var t=$(p.svg._groups[0]),e=t.find('[class$="_segmentMainLabel-outer"]').css({fill:"#333","font-size":"14px","font-weight":"normal"});c.count>1&&e.last().css("font-style","italic"),r++,function(t,e){var a=wt(t);e.each((function(){var t=$(this),e=wt(t),i=parseFloat(t.attr("y"))||0;if(e.left<a.left||e.right>a.right){var n=e.width,r=Math.max(e.left,a.left),o=Math.min(e.right,a.right)-r,s=n-o;if(e.left<a.left){var l=parseFloat(t.attr("x"))||0;l+=s,t.attr("x",l)}var u=t.text(),c=Math.floor(u.length*o/n);if(c>0)for(var h=[];u.length>c;){t.text(u.substring(0,c)),u=u.substring(c);var d=t.clone();i+=7,d.text(u).attr("y",i),t.after(d),h.push(t),t=d,h.forEach((function(t){t.attr("y",(t.attr("y")||0)-7)}))}}}))}(t,e);var i=t.find('[class$="_segmentPercentage-inner"],[class$="_segmentValue-inner"]'),n=t.find('g[class$="_arc"]'),o=i.length/n.length;i.each((function(t){Pt(n.eq(parseInt(t/o)),$(this))})),r===a.chartKeys.length&&a.convertToImage()},onClickSegment:function(t){a.clearTableHighlight(),t.expanded||a.highlightTable({rowNumber:t.data.rowNumber,column:t.data.aggregation.replace(" - "+t.data.key,"")}),s.forEach((function(e){if(p!==e){var i=e.getOpenSegment();i&&a.highlightTable({rowNumber:i.data.rowNumber,column:i.data.aggregation.replace(" - "+t.data.key,"")})}}))}},misc:{colors:{segments:h},canvasPadding:{top:20,right:20,bottom:20,left:20}}});s.push(p)}))},ut.prototype.drawDonut3D=function(t,e){var a=this,i=a.calcGroupSize(a.chartKeys.length),n=a.chartKeys.length>1?20:a.titleHeight,r=Math.min(i.width,i.height-n)/2;a.addGroupTitle();var l=o.scaleOrdinal().range(a.colors);l.domain(a.pieKeys);var u=[];a.hideTips=function(){for(var t=0;t<u.length;t++)u[t].hide()},a.chartKeys.forEach((function(c,h){var d=$.grep(t,(function(t){return t.aggregation===c})),p=d,g=pt(d);g.count>1&&(d=g.data);var f=[];p.forEach((function(t){-1!==$.inArray(t,d)&&f.push(l(t.label))})),f.push("#a3acb2");var m=a.chart.append("svg").attr("width",i.width).attr("height",i.height);m.append("g").attr("id","donut3d"+a.macroId+a.pageId+h);var x=o.scaleOrdinal().range(f),y=d.map((function(t){return{label:t.label,value:t.value,color:x(t.label),textColor:mt(x(t.label)),other:t.other,rowNumber:t.rowNumber,name:c}}));N.draw("donut3d"+a.macroId+a.pageId+h,y,i.width/2,i.height/2,r,.7*r,.2*r,e,a.showInnerLabels,a.innerLabelsType,a.formatNumTo,"None"!==a.outerLabels);var v,b=(0,s.default)().attr("class","d3-tip chart"+a.macroId+a.pageId).offset([-5,0]).html((function(t){var e=K.default.escapeString(t.data.label+": "+a.formatNumTo(t.value)+" ("+N.getPercent(t)+")");return t.data.other&&g.smallData.forEach((function(t){e+="<br>"+K.default.escapeString(t.label+": "+a.formatNumTo(t.value)+" ("+t.percent+"%)")})),e}));u.push(b),a.chartKeys.length>1?a.addTitle(m,i.width,{top:0},{title:c,titleHeight:n}):a.addTitle(m,i.width,{top:0}),m.call(b),m.selectAll(".topSlice, .percent").on("mouseover",(function(t,e){clearTimeout(v);var a=null,i=_.find(".percent").each((function(t,i){if(i.textContent===e.data.label)return a=i,!1}));a=a||i[e.index],b.show(e,a),a.__data__.data.other?b.style("font-style","italic"):b.style("font-style","normal")})).on("mouseout",(function(){v=setTimeout((function(){v=null,a.tipHover||b.hide()}),50)})),a.bindElementSelect(m,".topSlice",(function(t){return{rowNumber:t.__data__.data.rowNumber,column:a.getColumnNameForHighlight(t.__data__.data.name)}})),g.count>1&&a.svgWrapper.find("#donut3d"+a.macroId+a.pageId+h+".percent").last().css("font-style","italic");var _=$(m._groups[0]),w=_.find(".percent"),S=_.find(".topSlice");w.each((function(t){var e=$(this),a=S.eq(t%S.length);Pt(a,e),function(t,e){var a=St(t);if(0===a.height)return;e.each((function(){for(var t=$(this),e=St(t),i=parseInt(t.css("font-size")),n=parseFloat(t.attr("y"))||0,r=parseFloat(t.attr("x"))||0;(e.top<a.top||e.bottom>a.bottom)&&i>0;){var o=kt(t);t.css("font-size",i--);var s=e.height;(e=St(t)).top<a.top&&e.bottom<=a.bottom?(n=n+s-Tt(t),t.attr("y",n),r+=(o-kt(t))/2,t.attr("x",r)):e.bottom>a.bottom&&e.top>=a.top&&(n=n-s+Tt(t),t.attr("y",n),r-=(o-kt(t))/2,t.attr("x",r))}}))}(a,e)}))}))},ut.prototype.drawColumn=function(t){var e=this,a=0,i=e.type.indexOf("Stacked")>=0,n=e.convertData(t),r=e.isLog?o.scaleLog():o.scaleLinear(),l=o.axisLeft(r);e.isLog||l.tickFormat(e.formatNumTo);var u=o.min(i&&!e.isLog?n:t,(function(t){return i&&!e.isLog?t.min:t.value})),c=o.max(i?n:t,(function(t){return i?t.total:t.value}));e.isLog&&0==e.minvalue&&(e.minvalue=Number.MIN_VALUE,c<0&&(e.minvalue*=-1)),e.isLog&&(u=Math.pow(10,Math.floor(Math.log(u)/Math.LN10))),r.domain([isNaN(e.minvalue)?e.isLog?u:Math.min(0,u):e.minvalue,isNaN(e.maxvalue)?Math.max(c,0):e.maxvalue]),isNaN(e.scaleStep)||l.tickValues(vt(r.domain(),e.scaleStep));var h=e.chart.append("svg"),d=h.append("g");e.argumentWidth=Ct(r,l);var p=n.length*o.max(n,(function(t){return t.values.length})),g=_t(i?e.chartKeys.slice().reverse():e.chartKeys.slice(),Math.min(e.width,e.argumentWidth+20+e.ytitleHeight+20+200*p)-(e.argumentWidth+20+e.ytitleHeight)-20,e.isPivot),f={top:20+e.titleHeight+(e.titleHeight&&e.is3D?10:0),right:e.legend&&!e.isLegendUnderGraph&&e.chartKeys.length>1?25+g.maxWidth:20,bottom:20+1.5*e.xtitleHeight+(e.isLegendUnderGraph?20*(g.rows+1)+10:0),left:e.argumentWidth+20+e.ytitleHeight},m=Math.min(e.width,f.left+f.right+200*p)-f.left-f.right,x=e.height-f.top-f.bottom;h.attr("width",m+f.left+f.right).attr("height",e.height),d.attr("transform","translate("+f.left+","+f.top+")");var y=o.scaleBand().rangeRound([0,m]).padding(.1),v=o.scaleBand();r.range([x,0]);var b=o.scaleOrdinal().range(e.colors),_=o.axisBottom(y),w=(0,s.default)().attr("class","d3-tip chart"+e.macroId+e.pageId).offset([-5,0]).html((function(t){return K.default.escapeString(t.name+" ("+e.formatNumTo(t.value)+")")}));e.addTitle(d,m,f),d.call(w),b.domain(e.chartKeys),y.domain(n.map((function(t){return t.label}))),v.domain(e.chartKeys).rangeRound([0,y.bandwidth()]);var S=isNaN(e.minvalue)?e.isLog?u:0:Math.max(0,e.minvalue);if(S=isNaN(e.maxvalue)?S:Math.min(e.maxvalue,S),e.xtitle)var k=d.append("text").attr("x",m/2).attr("y",x+f.bottom-10).attr("class","axis-title").style("text-anchor","middle").style("font-weight","bold").text(e.xtitle);if(e.ytitle)var T=d.append("text").attr("transform","rotate(-90)").attr("y",15-f.left).attr("class","axis-title").attr("x",-x/2).style("text-anchor","middle").style("font-weight","bold").text(e.ytitle);var P,C=d.selectAll(".bar").data(n).enter().append("g").attr("class","g").attr("label",(function(t){return t.label})).attr("transform",(function(t){return"translate("+y(t.label)+",0)"}));e.hideTips=function(){w.hide()};var F,A,L=C.selectAll("rect").data((function(t){return t.values})).enter(),M=function(t){return gt(t.value,r.domain()[0],r.domain()[1])},D=function(t){return i?0:v(t.name)},B=function(t){if(i)return r(gt(t.y1,r.domain()[0],r.domain()[1]));var e=M(t);return r(e)-r(Math.min(S,e))+r(S)},I=function(t){if(i)return r(gt(t.y0,r.domain()[0],r.domain()[1]))-B(t);var e=M(t);return Math.abs(r(e)-r(S))},V=i?y.bandwidth():v.bandwidth();if(e.addBarTrendLine(d,i,t,n,y,r,b,V),e.is3D){V=parseInt(.8*V);var O=parseInt(V/4),E=function(t){if(!t.value)return Ft([[0,0]]);var e=D(t)+V,a=B(t),i=a+I(t);return Ft([[e,parseInt(a)],[e+O,a-20],[e+O,i-20],[e,i]])},N=function(t){if(!t.value)return Ft([[0,0]]);var e=D(t),a=e+V,i=Math.ceil(B(t));return Ft([[e,i],[e+O,i-20],[a+O,i-20],[a,i]])};L.append("path").attr("class","bar-top").attr("key",(function(t){return t.name})).attr("d",N).style("fill",(function(t){return xt(b(t.name),.8)})),L.append("path").attr("class","bar-right").attr("key",(function(t){return t.name})).attr("d",E).style("fill",(function(t){return xt(b(t.name),.9)}))}if(L.append("rect").attr("class",e.is3D?"bar 3d":"bar").attr("width",V).attr("x",D).attr("y",B).attr("height",I).attr("key",(function(t){return t.name})).style("fill",(function(t){return b(t.name)})),!e.isLog)var z=d.append("g").attr("class","y axis").append("line").attr("y1",r(S)).attr("y2",r(S)).attr("x2",m);if(d.append("g").attr("class","x axis").attr("transform","translate(0,"+x+")").call(_).selectAll("text"),d.append("g").attr("class","y axis").call(l).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end"),e.showInnerLabels){var W=$("<span id='inner-value-label-for-bar'></span>");$("body").append(W);var G=function(a,r,o){return e.formatBarInnerLabel((function(){return ft(a,t,n)}),(function(){return bt(a.value,$(o).parent().find(".bar").eq(r),x,i,!1,e.formatNumTo)}))};L.append("text").attr("class","inner-value-label").attr("key",(function(t){return t.name})).attr("x",(function(t,e){var a=W.text(G(t,e,this)).width(),n=I(t);return a>n-5?i?0:5-B(t):-B(t)-n/2-a/2})).attr("y",(function(t){return i?y.bandwidth()/2:v(t.name)+v.bandwidth()/2})).attr("dy",".35em").text((function(t,e){return G(t,e,this)})).style("font-size",(function(t,e){var a=W.text(G(t,e,this)).width(),n=I(t);return V<12||i&&a>n-5?0:14})).style("fill",(function(t,e){return W.text(G(t,e,this)).width()>I(t)-5?"black":mt(b(t.name))})).attr("transform",(function(){return"rotate(-90)"})),W.remove()}d.selectAll(".bar, .inner-value-label").on("mouseover",(function(t,e){clearTimeout(P);var a=$(this);a.is(".inner-value-label")&&(a=a.parent().find(".bar[key]").filterByAttr("key",e.name));var i=e;if(!e.name&&e.values){var n=this.getAttribute("key");i=$.grep(e.values,(function(t){return t.name===n}))[0]}w.show(i,a[0])})).on("mouseout",(function(){P=setTimeout((function(){P=null,e.tipHover||e.hideTips()}),50)})),e.bindElementSelect(d,".bar");var H=function(t){var a=it(y.domain()),i=y.bandwidth();F=a.width>i&&i<ut.minHorizontalTextWidth,e.textWidth=F?ut.calcTextMaxWidth(i,a,ut.maxTextWidth):i,A!=e.textWidth&&(A=e.textWidth,_.tickFormat(ut.formatedMultiline(e.textWidth)),t&&d.selectAll(".x.axis").call(_).selectAll)};H(!0);var R,X,Y,j=parseFloat(e.svgWrapper.find("svg").attr("height")),U=function(t){var i=d.selectAll("g.x.axis text");if(F)R="end",Y="middle",a=e.textWidth+10,X="translate(-14, 7) rotate(-90)",h.transition().duration(t).attr("height",j+e.textWidth),e.xtitle&&k.transition().duration(t).attr("y",x+f.bottom-15+e.textWidth-(e.isLegendUnderGraph?20*(g.rows+1)+10:0));else{R="middle",Y="top";var n=(a=Math.max(22,ut.getMultilineHeight(i)+10))-22;X="translate(0, 0)",h.transition().duration(t).attr("height",j+n),e.xtitle&&k.transition().duration(t).attr("y",x+f.bottom-15+n-(e.isLegendUnderGraph?20*(g.rows+1)+5:0))}i.transition().duration(t).attr("transform",X).style("text-anchor",R).call(ut.multilineAlign,Y)};U(0);if(e.legend&&e.chartKeys.length>1){var J=e.chartKeys.slice();e.addLegend(d,m,x+e.xtitleHeight+a,f.top,b,i?J.reverse():J,e.isLegendUnderGraph,(function(a,n){var s=[];t.forEach((function(t){t.aggregation==a&&(t.hidden=!n),t.hidden||-1!=$.inArray(t.aggregation,s)||s.push(t.aggregation)}));var p=$.grep(t,(function(t){return!t.hidden}));if(p.length){var g=e.convertData(p);y.domain(g.map((function(t){return t.label}))),H(),v.domain(s).rangeRound([0,y.bandwidth()]),u=e.isLog?u:o.min(i?g:p,(function(t){return i?t.min:t.value})),c=o.max(i?g:p,(function(t){return i?t.total:t.value})),r.domain([isNaN(e.minvalue)?e.isLog?u:Math.min(0,u):e.minvalue,isNaN(e.maxvalue)?Math.max(c,0):e.maxvalue]),V=i?y.bandwidth():v.bandwidth(),e.is3D&&(V*=.8,O=parseInt(V/4)),isNaN(e.scaleStep)||l.tickValues(vt(r.domain(),e.scaleStep));var w=$("body").append("<span id='inner-value-label-for-bar'></span>").find("#inner-value-label-for-bar");g.forEach((function(t){var a=d.selectAll("[label]").filterByAttr("label",t.label),r=function(){a.transition().duration(300).attr("transform",(function(t){return"translate("+y(t.label)+",0)"}))};n||r(),t.values.forEach((function(t){var n=B(t),r=I(t);if(a.selectAll(".bar[key]").filterByAttr("key",t.name).transition().duration(300).attr("width",V).attr("x",D(t)).attr("y",n).attr("height",r),e.is3D&&(a.selectAll(".bar-right[key]").filterByAttr("key",t.name).transition().duration(300).attr("d",E(t)),a.selectAll(".bar-top[key]").filterByAttr("key",t.name).transition().duration(300).attr("d",N(t))),e.showInnerLabels){var o=a.selectAll("text[key]").filterByAttr("key",t.name),s=function(t,a){return e.formatBarInnerLabel((function(){return ft(t,p,g)}),(function(){return bt(t.value,$(a._groups[0]).parent().find(".bar[key]").filterByAttr("key",t.name),x,i,!1,e.formatNumTo)}))}(t,o),l=w.text(s).width();o.transition().duration(300).attr("x",i?-n-(r/2+l/2):-n-(l>r?-5:r/2+l/2)).attr("y",i?V/2:v(t.name)+V/2).style("font-size",V<12||i&&l>r-5?0:14).style("fill",l>r-5?"black":mt(b(t.name))).text(s)}})),n&&r()})),w.remove(),d.selectAll(".x.axis").transition().duration(300).on("start",(function(){U(300)})).call(_).selectAll(".x.axis text").style("text-anchor",R).attr("transform",X),d.selectAll(".y.axis").transition().duration(300).on("start",(function(){f.left-=e.argumentWidth,e.argumentWidth=Ct(r,l),f.left+=e.argumentWidth,h.transition().duration(300).attr("width",m+f.left+f.right),d.transition().duration(300).attr("transform","translate("+f.left+","+f.top+")"),e.ytitle&&T.transition().duration(300).attr("y",15-f.left)})).call(l),e.isLog||z.transition().duration(300).attr("y1",r(S)).attr("y2",r(S)),setTimeout((function(){e.convertToImage({noExport:!0})}),400)}}))}},ut.prototype.drawBar=function(t){var e=this,a=e.type.indexOf("Stacked")>=0,i=e.convertData(t),n=e.isLog?o.scaleLog():o.scaleLinear(),r=o.axisTop(n);e.isLog||r.tickFormat(e.formatNumTo);var l=o.min(a&&!e.isLog?i:t,(function(t){return a&&!e.isLog?t.min:t.value})),u=o.max(a?i:t,(function(t){return a?t.total:t.value}));e.isLog&&0==e.minvalue&&(e.minvalue=Number.MIN_VALUE,u<0&&(e.minvalue*=-1)),e.isLog&&(l=Math.pow(10,Math.floor(Math.log(l)/Math.LN10))),n.domain([isNaN(e.minvalue)?e.isLog?l:Math.min(0,l):e.minvalue,isNaN(e.maxvalue)?Math.max(u,0):e.maxvalue]),isNaN(e.scaleStep)||r.tickValues(vt(n.domain(),e.scaleStep));var c=e.chart.append("svg"),h=c.append("g");e.argumentWidth=Ct(n,r);var d,p,g,f,m=e.is3D?20:0,x=function(){d=_t(e.chartKeys.slice(),e.width-(e.textWidth+10+e.ytitleHeight)-40,e.isPivot),p={top:e.argumentWidth+30+e.titleHeight+e.xtitleHeight,right:m+(e.legend&&!e.isLegendUnderGraph&&e.chartKeys.length>1?25+d.maxWidth:40),bottom:10+(e.isLegendUnderGraph?20*(d.rows+1)+10:0),left:e.textWidth+10+e.ytitleHeight},g=e.width-p.left-p.right,f=e.height-p.top-p.bottom},y=i.map((function(t){return t.label}));x();var v=it(y),b=ut.calcTextMaxWidth(f/y.length,v,ut.maxTextWidth);e.textWidth<b&&(e.textWidth=b,x()),n.range([0,g]);var _=o.scaleBand().rangeRound([0,f]).padding(.2),w=o.scaleBand(),S=o.scaleOrdinal().range(e.colors),k=o.axisLeft(_).tickFormat(ut.formatedMultiline(e.textWidth)),T=(0,s.default)().attr("class","d3-tip chart"+e.macroId+e.pageId).offset([-5,0]).html((function(t){return K.default.escapeString(t.name+" ("+e.formatNumTo(t.value)+")")}));c.attr("width",e.width).attr("height",e.height),h.attr("transform","translate("+p.left+","+p.top+")");var P=e.addTitle(h,g,p);if(h.call(T),S.domain(e.chartKeys),_.domain(y),w.domain(e.chartKeys).rangeRound([0,_.bandwidth()]),e.xtitle)var C=h.append("text").attr("x",g/2).attr("y",e.titleHeight+20-p.top).attr("class","axis-title").style("text-anchor","middle").style("font-weight","bold").text(e.xtitle);e.ytitle&&h.append("text").attr("transform","rotate(-90)").attr("y",15-p.left).attr("class","axis-title").attr("x",-f/2).style("text-anchor","middle").style("font-weight","bold").text(e.ytitle);var F=isNaN(e.minvalue)?e.isLog?l:0:Math.max(0,e.minvalue);F=isNaN(e.maxvalue)?F:Math.min(F,e.maxvalue);var A,L=h.selectAll(".bar").data(i).enter().append("g").attr("class","g").attr("label",(function(t){return t.label})).attr("transform",(function(t){return"translate(0,"+_(t.label)+")"}));e.hideTips=function(){T.hide()};var M,D,B=L.selectAll("rect").data((function(t){return t.values})).enter(),I=function(t){return n(a?gt(t.y0,n.domain()[0],n.domain()[1]):Math.min(F,gt(t.value,n.domain()[0],n.domain()[1])))},V=function(t){return a?0:w(t.name)},O=function(t){return a?n(gt(t.y1,n.domain()[0],n.domain()[1]))-I(t):Math.abs(n(gt(t.value,n.domain()[0],n.domain()[1]))-n(F))},E=a?_.bandwidth():w.bandwidth();if(e.addBarTrendLine(h,a,t,i,_,n,S,E,!0),e.is3D){E=parseInt(.8*E);var N=parseInt(E/4),z=function(t){if(!t.value)return Ft([[0,0]]);var e=I(t),a=e+O(t),i=V(t)+E;return Ft([[e,i],[a,i],[a+m,i+N],[e+m,i+N]])},W=function(t){if(!t.value)return Ft([[0,0]]);var e=I(t)+O(t),a=V(t),i=a+E;return Ft([[e,a],[e+m,a+N],[e+m,i+N],[e,i]])};B.append("path").attr("class","bar-right").attr("key",(function(t){return t.name})).attr("d",W).style("fill",(function(t){return xt(S(t.name),.8)})),B.append("path").attr("class","bar-bottom").attr("key",(function(t){return t.name})).attr("d",z).style("fill",(function(t){return xt(S(t.name),.9)}))}if(B.append("rect").attr("class","bar").attr("width",O).attr("x",I).attr("y",V).attr("height",E).attr("key",(function(t){return t.name})).style("fill",(function(t){return S(t.name)})),e.showInnerLabels){var G=$("<span id='inner-value-label-for-bar'></span>");$("body").append(G);var H=function(n,r){return e.formatBarInnerLabel((function(){return ft(n,t,i)}),(function(){return bt(n.value,r,g,a,!0,e.formatNumTo)}))};B.append("text").attr("class","inner-value-label").attr("key",(function(t){return t.name})).attr("x",(function(t,e){var i=$(this).parent().find(".bar").eq(e),r=G.text(H(t,i)).width(),o=kt(i);return n(gt(a?Math.min(t.y0,t.y1):Math.min(t.value,F),n.domain()[0],n.domain()[1]))+(r>o-5?o+5:(o-r)/2)})).attr("y",(function(t){return a?_.bandwidth()/2:w(t.name)+w.bandwidth()/2})).attr("dy",".35em").text((function(t,e){return H(t,$(this).parent().find(".bar").eq(e))})).style("font-size",(function(t,e){var i=$(this).parent().find(".bar").eq(e),n=G.text(H(t,i)).width(),r=kt(i);return(a?_.bandwidth()<14||n>r-5:w.bandwidth()<14)?0:14})).style("fill",(function(t){return mt(S(t.name))})),G.remove()}h.selectAll(".bar, .inner-value-label").on("mouseover",(function(t,e){A&&(clearTimeout(A),A=null);var a=$(this);a.is(".inner-value-label")&&(a=a.parent().find(".bar[key]").filterByAttr("key",e.name));var i=e;if(!e.name){var n=this.getAttribute("key");i=$.grep(e.values,(function(t){return t.name==n}))[0]}T.show(i,a[0])})).on("mouseout",(function(){A=setTimeout((function(){A=null,e.tipHover||e.hideTips()}),50)})),e.bindElementSelect(h,".bar"),h.append("g").attr("class","x axis").call(r);var R=function(t,a){p.top-=e.argumentWidth,e.argumentWidth=Ct(n,r),p.top+=e.argumentWidth,t>e.width/(e.argumentWidth+30)?(M="start",D="translate(12, -4) rotate(-65)",c.transition().duration(a).attr("height",e.height).selectAll("svg > g").attr("transform","translate("+p.left+","+p.top+")"),P&&P.transition().duration(a).attr("y",e.titleHeight-p.top),C&&C.transition().duration(a).attr("y",e.titleHeight+20-p.top)):(M="middle",D="translate(0, 0)",c.transition().duration(a).attr("height",e.height-e.argumentWidth).selectAll("svg > g").attr("transform","translate("+p.left+","+(p.top-e.argumentWidth)+")"),P&&P.transition().duration(a).attr("y",e.titleHeight-p.top+e.argumentWidth),C&&C.transition().duration(a).attr("y",e.titleHeight+20-p.top+e.argumentWidth)),h.selectAll(".x.axis text").transition().duration(a).style("text-anchor",M).attr("transform",D)};R(h.selectAll(".x.axis text").size(),0),h.append("g").attr("class","y axis").call(k);var X=h.append("g").attr("class","y axis").append("line").attr("x1",n(F)).attr("x2",n(F)).attr("y2",f);if(e.legend&&e.chartKeys.length>1){var Y=e.chartKeys.slice();e.addLegend(h,g+m,f,p.top,S,Y,e.isLegendUnderGraph,(function(i,s){var c=[];t.forEach((function(t){t.aggregation==i&&(t.hidden=!s),t.hidden||-1!=$.inArray(t.aggregation,c)||c.push(t.aggregation)}));var d=$.grep(t,(function(t){return!t.hidden}));if(d.length){var p=e.convertData(d);l=e.isLog?l:o.min(a?p:d,(function(t){return a?t.min:t.value})),u=o.max(a?p:d,(function(t){return a?t.total:t.value})),n.domain([isNaN(e.minvalue)?e.isLog?l:Math.min(0,l):e.minvalue,isNaN(e.maxvalue)?Math.max(u,0):e.maxvalue]),_.domain(p.map((function(t){return t.label}))),w.domain(c).rangeRound([0,_.bandwidth()]),isNaN(e.scaleStep)||r.tickValues(vt(n.domain(),e.scaleStep)),E=a?_.bandwidth():w.bandwidth(),e.is3D&&(E=parseInt(.8*E),N=parseInt(E/4));var f=$("body").append("<span id='inner-value-label-for-bar'></span>").find("#inner-value-label-for-bar");p.forEach((function(t){var i=h.selectAll("[label]").filterByAttr("label",t.label),r=function(){i.transition().duration(300).attr("transform",(function(t){return"translate(0,"+_(t.label)+")"}))};s||r(),t.values.forEach((function(t){var r=i.selectAll(".bar[key]").filterByAttr("key",t.name),o=i.selectAll("text[key]").filterByAttr("key",t.name),s=O(t);if(r.transition().duration(300).attr("width",s).attr("x",I(t)).attr("y",V(t)).attr("height",E),e.is3D&&(i.selectAll(".bar-right[key]").filterByAttr("key",t.name).transition().duration(300).attr("d",W(t)),i.selectAll(".bar-bottom[key]").filterByAttr("key",t.name).transition().duration(300).attr("d",z(t))),e.showInnerLabels){var l=$(o._groups[0]).parent().find(".bar[key]").filterByAttr("key",t.name),u=function(t){return e.formatBarInnerLabel((function(){return ft(t,d,p)}),(function(){return bt(t.value,l,g,a,!0,e.formatNumTo)}))},c=u(t),h=f.text(u(t)).width(),m=n(gt(a?Math.min(t.y0,t.y1):Math.min(t.value,F),n.domain()[0],n.domain()[1]));o.transition().duration(300).attr("x",m+(h>s-5?s+5:(s-h)/2)).attr("y",a?_.bandwidth()/2:w(t.name)+w.bandwidth()/2).style("font-size",(a?_.bandwidth()<14||h>s-5:w.bandwidth()<14)?0:14).style("fill",h>s-5?"black":mt(S(t.name))).text(c)}})),s&&r()})),f.remove();var m=h.append("g").attr("class","xaxis-tmp").call(r),x=h.selectAll(".xaxis-tmp .tick").size();m.remove(),h.selectAll(".x.axis").transition().duration(300).on("start",(function(){R(x,300)})).call(r).selectAll(".x.axis text").style("text-anchor",M).attr("transform",D),h.select(".y.axis").transition().duration(300).call(k),X.transition().duration(300).attr("x1",n(F)).attr("x2",n(F)),setTimeout((function(){e.convertToImage({noExport:!0})}),400)}}))}},ut.prototype.drawSeries=function(t){var e=this,a=null,i=null,n=0,r=-1!==e.type.indexOf("Stacked"),s=e.chartKeys,l=K.default.parseValueByType(e.xValueType,e.xScaleStep,e.separator,e.worklog);if(l=isNaN(l)||!1===l?null:l,r&&e.convertSeriesDataStacked(t,s),e.isTime){try{a=K.default.parseDate(e.xminvalue,e.dateFormat,e.locale)}catch(t){a=null}try{i=K.default.parseDate(e.xmaxvalue,e.dateFormat,e.locale)}catch(t){i=null}var u=e.xScaleStep.indexOf("h")>-1?o.timeHour:e.xScaleStep.indexOf("w")>-1?o.timeWeek:e.xScaleStep.indexOf("m")>-1?o.timeMonth:e.xScaleStep.indexOf("y")>-1?o.timeYear:o.timeDay,c=t[t.length-1].value-t[0].value;null==l?c<864e6&&-1===e.workingDateFormat.toLowerCase().indexOf("hh:mm")?(u=o.timeDay,l=1):e.workingDateFormat.indexOf("i")>=0?(u=o.timeMonth,l=3):e.workingDateFormat.indexOf("w")>=0?(u=o.timeWeek,l=Math.floor(c/6048e6)):-1===e.workingDateFormat.toLowerCase().indexOf("m")&&c<31536e7?(u=o.timeYear,l=1):-1===e.workingDateFormat.indexOf("d")&&c<2592e7&&(u=o.timeMonth,l=1):l=Math.floor(l)}else a=K.default.parseValueByType(e.xValueType,e.xminvalue,e.separator,e.worklog),i=K.default.parseValueByType(e.xValueType,e.xmaxvalue,e.separator,e.worklog),a=isNaN(a)||!1===a?null:a,i=isNaN(i)||!1===i?null:i;if(0!==(t=$.grep(t,(function(t){return(null==a||t.value>=a)&&(null==i||t.value<=i)}))).length){var h=e.isTime?o.scaleTime():e.isXLog?o.scaleLog():o.scaleLinear(),d=e.isLog?o.scaleLog():o.scaleLinear(),p=o.axisBottom(h);if(e.isTime){var g=e.getTimeFormat(c);p.tickFormat(g),g}else e.isXLog||(p.tickFormat(e.formatNumToX),e.formatNumToX);var f=o.axisLeft(d);e.isLog||f.tickFormat(e.formatNumTo);var m=o.min(t,(function(t){return t.value})),x=o.max(t,(function(t){return t.value}));!e.isTime&&e.isXLog&&0==a&&(a=Number.MIN_VALUE,x<0&&(a*=-1)),h.domain([null==a?m:a,null==i?x:i]);var y=o.min(t,(function(t){return t.label})),v=o.max(t,(function(t){return r?t.y1:t.label}));e.isLog&&0==e.minvalue&&(e.minvalue=Number.MIN_VALUE,v<0&&(e.minvalue*=-1)),d.domain([isNaN(e.minvalue)?e.isLog?y:Math.min(0,y):e.minvalue,isNaN(e.maxvalue)?v:e.maxvalue]),nt(p),isNaN(e.scaleStep)||f.tickValues(vt(d.domain(),e.scaleStep));var b=e.chart.append("svg"),_=b.append("g");e.argumentWidth=Ct(h,p),e.textWidth=Math.max(Ct(d,f),e.argumentWidth/2);var w,S,k=_t(r?s.slice().reverse():s.slice(),e.width-(e.textWidth+20+e.ytitleHeight)-40,e.isPivot),T={top:20+e.titleHeight,right:e.legend&&!e.isLegendUnderGraph&&s.length>1?k.maxWidth+25:40,bottom:e.argumentWidth+25+e.xtitleHeight+(e.isLegendUnderGraph?20*(k.rows+1)+10:0),left:e.textWidth+20+e.ytitleHeight},P=e.width-T.left-T.right;if(h.range([0,P]),d.range([e.height,0]),b.attr("oncontextmenu","return false;").attr("width",e.width).attr("height",e.height+T.top+T.bottom),_.attr("transform","translate("+T.left+","+T.top+")"),e.addTitle(_,P,T),e.xtitle)var C=_.append("text").attr("x",P/2).attr("y",e.height+T.bottom-10).attr("class","axis-title").style("text-anchor","middle").style("font-weight","bold").text(e.xtitle);if(e.ytitle)var F=_.append("text").attr("transform","rotate(-90)").attr("y",20-T.left).attr("class","axis-title").attr("x",-e.height/2).style("text-anchor","middle").style("font-weight","bold").text(e.ytitle);var A=function(t,a){T.bottom-=e.argumentWidth,e.argumentWidth=Ct(h,p),T.bottom+=e.argumentWidth;var i=e.height+T.top+T.bottom;return t>P/(e.argumentWidth+10)?(w="end",n=e.argumentWidth+10,S="translate(-14, 7) rotate(-65)",e.xtitle&&C.transition().duration(a).attr("y",e.height+T.bottom-15-(e.isLegendUnderGraph?20*(k.rows+1)+5:0))):(w="middle",n=22,S="translate(0, 0)",i-=e.argumentWidth,e.xtitle&&C.transition().duration(a).attr("y",e.height+T.bottom-e.argumentWidth-(e.isLegendUnderGraph?20*(k.rows+1)+5:0))),_.selectAll(".x.axis text").transition().duration(a).style("text-anchor",w).attr("transform",S),i};_.append("clipPath").attr("id","clip"+e.macroId+e.pageId).append("rect").attr("x",1).attr("width",P).attr("height",e.height);var L,M,D=_.append("g").attr("clip-path","url(#clip"+e.macroId+e.pageId+")");_.append("path").datum(t),e.grid&&!e.isArea&&(L=_.append("g"),M=_.append("g"));var B=function(t){var a=$.inArray(t,s);return e.colors[a%e.colors.length]},I=[];o.group(t,(function(t){return t.key})).forEach((function(t,e){I.push({key:e,values:t})}));var V=e.isArea?"area":"line",O=1,E={};if(s.forEach((function(t){var a,i=$.grep(I,(function(e){return e.key===t}));if(a=e.isArea?o.area().curve(e.getInterpolation(t)).x((function(t){return h(t.value)})).y0((function(t){return t.y0?d(t.y0):e.height})).y1((function(t){return d(r?t.y1:t.label)})):o.line().curve(e.getInterpolation(t)).x((function(t){return h(t.value)})).y((function(t){return d(t.label)})),E[t]=a,i.length>0){if(i=i[0],ht(e.type)&&e.getLineType(i.key)===lt)!function(t){var a=o.symbol().type(o.symbolCircle).size(100*e.getLineWidth(t.key));D.selectAll('path[key="'+t.key+'"]').data(t.values).enter().append("path").attr("key",t.key).attr("transform",(function(t){return"translate("+h(t.value)+","+d(t.label)+")"})).attr("d",a()).style("fill",B(t.key))}(i);else{var n=D.append("path").attr("class",V).attr("d",a(i.values)).attr("key",i.key);e.isArea?n.style("fill",B(i.key)).style("opacity",O):(n.style("stroke",B(i.key)).style("stroke-width",e.getLineWidth(i.key)+"px"),ht(e.type)&&e.getLineType(i.key)===st&&n.style("stroke-dasharray","9, 6"))}r||(O*=.8),e.addTrendLine(i,_,h,d,B(i.key))}})),e.grid&&e.isArea&&(L=_.append("g"),M=_.append("g")),e.grid){var N=o.axisLeft(d).tickSize(-P,0,0).tickFormat(""),z=o.axisBottom(h).tickSize(e.height,0,0).tickFormat("");nt(z),isNaN(e.scaleStep)||N.tickValues(vt(d.domain(),e.scaleStep)),L.attr("class","grid").call(N).selectAll("line, .domain").attr("stroke",""),M.attr("class","grid").call(z).selectAll("line, .domain").attr("stroke","")}_.append("g").attr("class","x axis").attr("transform","translate(0,"+e.height+")").call(p).selectAll("text"),_.append("g").attr("class","y axis").call(f).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end"),b.attr("height",A(_.selectAll(".x.axis text").size(),0));var W=o.bisector((function(t){return t.value})).left,G={},H={};I.forEach((function(t){var a=_.append("g").attr("class","focus").style("display","none");a.append("circle").attr("r",4.5).style("fill",B(t.key));var i=$('<div class="d3-tip n chart'+e.macroId+e.pageId+'" style="position: absolute; pointer-events: all; box-sizing: border-box; display: none"></div>');e.svgWrapper.append(i),H[t.key]=i,G[t.key]=a}));var R=null;e.hideTips=function(){for(var t in G)G[t].style("display","none"),H[t].hide()};var X=o.drag(),Y=!1;_.append("rect").attr("class","overlay").attr("width",P).attr("height",e.height).style("fill","none").on("mouseover",(function(){if(!Y)for(var t in clearTimeout(R),G)G[t].style("display",""),H[t].show()})).on("mouseout",(function(){R=setTimeout((function(){R=null,e.tipHover||e.hideTips()}),50)})).on("mousemove",(function(t){if(!Y)if(t.altKey||t.ctrlKey||t.shiftKey)e.hideTips();else{var a=this,i=[];I.forEach((function(n){var s=G[n.key],l=h.invert(o.pointer(t,a)[0]),u=W(n.values,l,1),c=n.values[u-1],p=n.values[u],f=p&&l-c.value>p.value-l?p:c,m=h(f.value),x=d(r?f.y1:f.label);if(!isNaN(m)){if(m<0||m>P||x<0||x>e.height)return H[n.key].hide(),void s.style("display","none");s.style("display",""),s.attr("transform","translate("+m+","+x+")");var y=e.isTime?g(f.value):e.formatNumToX(f.value);H[n.key].show().text(e.formatNumTo(f.label)+" ("+y+")");var v=$(s._groups[0]).offset();v.top-=H[n.key].outerHeight()+6,v.left-=H[n.key].outerWidth()/2-4,i.push({key:n.key,offset:v,y:d(gt(r?f.y1:f.label,d.domain()[0],d.domain()[1]))})}})),i.sort((function(t,e){return t.y-e.y}));var n=0;i.forEach((function(t){n>t.offset.top?(t.offset.top+=60,H[t.key].removeClass("n").addClass("s").offset(t.offset)):H[t.key].removeClass("s").addClass("n").offset(t.offset),n=t.offset.top+45}))}})).on("wheel",(function(t){if(t.altKey||t.ctrlKey){t.preventDefault(),t.stopPropagation();var a=t.deltaY,i=o.pointer(t,this),n=P/10,r=i[0]/P*n,s=(1-i[0]/P)*n,l=e.height/10,u=i[1]/e.height*l,c=(1-i[1]/e.height)*l;a<0?(J.x1=h.invert(r),J.x2=h.invert(P-s),J.y2=d.invert(u),J.y1=d.invert(e.height-c)):(J.x1=Math.max(h.invert(-r),q.x1),J.x2=Math.min(h.invert(P+s),q.x2),J.y2=Math.min(d.invert(-u),q.y2),J.y1=Math.max(d.invert(e.height+c),q.y1)),et()}})).call(X);var j=h.domain(),U=d.domain(),J={x1:j[0],y1:U[0],x2:j[1],y2:U[1]},q={x1:j[0],y1:U[0],x2:j[1],y2:U[1]};e.legend&&s.length>1&&e.addLegend(_,P,e.height+n+5+e.xtitleHeight,T.top,B,r?s.slice().reverse():s,e.isLegendUnderGraph,(function(n,l){t.forEach((function(t){t.key==n&&(t.hidden=!l,H[n].css("visibility",l?"":"hidden"),G[n].style("visibility",l?"":"hidden"))}));var u=$.grep(t,(function(t){return!t.hidden}));u.length&&(r&&e.convertSeriesDataStacked(u,s),m=!e.isTime&&e.isXLog?m:o.min(u,(function(t){return t.value})),x=o.max(u,(function(t){return t.value})),h.domain([null==a?m:a,null==i?x:i]),j=h.domain(),h.domain([j[0]>J.x1?j[0]:J.x1,j[1]<J.x2?j[1]:J.x2]),y=o.min(u,(function(t){return t.label})),v=o.max(u,(function(t){return r?t.y1:t.label})),d.domain([isNaN(e.minvalue)?e.isLog?y:Math.min(0,y):e.minvalue,isNaN(e.maxvalue)?v:e.maxvalue]),U=d.domain(),d.domain([Math.max(U[0],J.y1),Math.min(U[1],J.y2)]),it($.grep(I,(function(t){return t.key==n&&(t.hidden=!l),!t.hidden}))))}));var Z=_.append("rect").attr("width",0).attr("height",0).attr("x",0).attr("y",0).attr("class","band"),Q=[-1,-1];X.filter((function(t){return!t.button})),X.on("end",(function(t){if(Y=!1,0==t.sourceEvent.button&&!(t.sourceEvent.altKey||t.sourceEvent.ctrlKey||t.sourceEvent.shiftKey)){var e=o.pointer(t,this),a=-1==Q[0]||Q[0]==e[0]||Q[1]==e[1];J.x1=h.invert(Q[0]),J.x2=h.invert(e[0]),J.y1=d.invert(e[1]),J.y2=d.invert(Q[1]);var i=Q[0]>e[0];Q=[-1,-1],Z.transition().attr("width",0).attr("height",0).attr("x",Q[0]).attr("y",Q[1]),a||(i?at():et())}})),X.on("drag",(function(t){if(Y=!0,e.hideTips(),0==t.sourceEvent.button){if(t.sourceEvent.altKey||t.sourceEvent.ctrlKey)return a=t.dx,i=t.dy,J.x1=h.invert(-a),J.x2=h.invert(P-a),J.y2=d.invert(-i),J.y1=d.invert(e.height-i),void et(0);var a,i;if(t.sourceEvent.shiftKey)!function(t,a){J.x1=h.invert(t),J.x2=h.invert(P-t),J.y2=d.invert(-a),J.y1=d.invert(e.height+a),et(0)}(t.dx,t.dy);else{var n=o.pointer(t,this);n[0]<Q[0]?Z.attr("stroke","#14892c").attr("transform","translate("+n[0]+","+Q[1]+")"):Z.attr("stroke","#707070"),n[1]<Q[1]&&Z.attr("transform","translate("+n[0]+","+n[1]+")"),n[1]<Q[1]&&n[0]>Q[0]&&Z.attr("transform","translate("+Q[0]+","+n[1]+")"),-1==Q[0]&&(Q=n,Z.attr("transform","translate("+Q[0]+","+Q[1]+")")),Z.transition().duration(1).attr("width",Math.abs(Q[0]-n[0])).attr("height",Math.abs(Q[1]-n[1]))}}}));var tt=null}function et(t){J.x1!=J.x2&&(J.x1>J.x2?at():(h.domain([J.x1,J.x2]),J.y1>J.y2?d.domain([J.y2,J.y1]):d.domain([J.y1,J.y2]),it(dataNest2,t)))}function at(){J={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2},h.domain(j),d.domain(U),it(I)}function it(t,a){a=null==a?300:a;var i=_.transition().duration(a);if(t.forEach((function(t){i.selectAll(".line[key], .area[key]").filterByAttr("key",t.key).attr("d",E[t.key](t.values)),ht(e.type)&&e.getLineType(t.key)==lt&&i.selectAll('path[key="'+t.key+'"]').attr("transform",(function(t){return"translate("+h(t.value)+","+d(t.label)+")"})),e.showTrendLine&&i.selectAll(".trendline[key]").filterByAttr("key",t.key).attr("x1",h(t.trendData.x1)).attr("y1",d(t.trendData.y1)).attr("x2",h(t.trendData.x2)).attr("y2",d(t.trendData.y2))})),null!=l&&e.isSeries){var n=vt(h.domain(),l);p.tickValues(n),e.grid&&z.tickValues(n)}if(!isNaN(e.scaleStep)){n=vt(d.domain(),e.scaleStep);f.tickValues(n),e.grid&&N.tickValues(n)}var r=_.append("g").attr("class","xaxis-tmp").call(p),o=_.selectAll(".xaxis-tmp .tick").size();r.remove(),i.selectAll(".x.axis").call(p).selectAll(".x.axis text").style("text-anchor",w).attr("transform",S),i.selectAll(".y.axis").on("start",(function(){var t=e.textWidth;e.textWidth=Math.max(Ct(d,f),e.argumentWidth/2),t-=e.textWidth,T.left-=t,e.width-=t,b.transition().duration(a).attr("width",e.width).attr("height",A(o,a)),_.transition().duration(a).attr("transform","translate("+T.left+","+T.top+")"),e.ytitle&&F.transition().duration(a).attr("y",20-T.left)})).call(f),e.grid&&(L.transition().duration(a).call(N).selectAll("line").attr("stroke",""),M.transition().duration(a).call(z).selectAll("line").attr("stroke","")),clearTimeout(tt),tt=setTimeout((function(){e.convertToImage({noExport:!0})}),a+100)}function nt(t){null!=l&&(e.isSeries?t.tickValues(vt(h.domain(),l)):u===o.timeDay&&1!==l?t.ticks(u.filter((function(t){return o.timeDay.count(h.domain()[0],t)%l==0}))):t.ticks(u.every(l)))}},ut.prototype.drawGantt=function(t){var e=this,a=o.scaleOrdinal().range(e.colors);a.domain(e.ganttCatColors);var i=[],n=[],r=[],l=[],u=[],c=[];if(t.forEach((function(t,o){if(t.endDate){var s="mono"===e.barColoringType?"Task":t.category;if(t.style="fill:"+a(s),t.doneStyle="fill:"+a(s+" - Done"),t.todoStyle="fill:"+a(s+" - Todo"),t.labelStyle="fill:"+mt(a(s)),t.label){var h=t.label.split("‌: ")[0];-1===r.indexOf(h)&&r.push(h)}e.hasTimeFormat||t.endDate.setHours(23,59,59);var d="";if(t.label){var p=t.label.split("‌: ");p.length>1&&(d="("+t.label.replace(p[0],"").replace("‌: ","")+")")}var g=Math.round((t.endDate-t.startDate)/864e5),f=t.progress>=0?" "+Math.round(100*t.progress)+"%":"";t.hint=t.category+" "+d+": "+g+" "+"days"+f,i.push(t)}else{var m=-1!==e.ganttCategories.indexOf(t.category),x=-1!==e.ganttCategories.indexOf(t.label);if(m||x){if(x&&c.push(t.label+"-"+t.startDate.getTime()),x||-1===c.indexOf(t.category+"-"+t.startDate.getTime())){var y=m?t.label:t.category,v=m?t.category:t.label,b=new RegExp("^"+v+" - ","g"),_="mono"===e.barColoringType?"Milestone":x?y:v+": "+(y||"milestone");t.startDate.setHours(12),l.push({id:o,category:v,label:y,date:t.startDate,style:"fill:"+a(_),hint:t.hint.replace(b,"")}),u.push(y)}}else{var w="mono"===e.barColoringType?"Event":t.category;n.push({date:t.startDate,style:"stroke:"+a(w),label:t.category||t.label,hint:t.hint,text:t.text})}}})),0!==i.length){if(1==r.length&&i.forEach((function(t){t.label=t.label.replace(r[0],"").replace("‌: ","")})),u.length){var h=n.slice();n=[],h.forEach((function(t,e){-1===u.indexOf(t.label)&&n.push(t)}))}i.sort((function(t,e){return t.startDate-e.startDate||(t.label>e.label?1:0)}));var d=null,p=null;try{d=K.default.parseDate(e.xminvalue,e.dateFormat,e.locale)}catch(t){}try{p=K.default.parseDate(e.xmaxvalue,e.dateFormat,e.locale)}catch(t){}if(d||(d=o.min([o.min(i,(function(t){return t.startDate})),o.min(l,(function(t){return t.date})),o.min(n,(function(t){return t.date}))])),!p){var g=$.grep(n,(function(t){return-1===["today","heute"].indexOf(t.text.toLowerCase())}));p=o.max([o.max(i,(function(t){return t.endDate})),o.max(l,(function(t){return t.date})),o.max(g,(function(t){return t.date}))]);var f=K.default.parseDate("today");if(g.length<n.length&&f>p)if(.25*(p-d)>f-p)p=f;else{var m=.25*(p-d)+p.getTime();(p=new Date).setTime(m),n.filter((function(t){return-1!==["today","heute"].indexOf(t.text.toLowerCase())}))[0].date=p}}var x=null,y=null,v=K.default.parseNumber(e.xScaleStep,e.separator);v=isNaN(v)||!1===v?null:v;var b=i[i.length-1].endDate-i[0].startDate;null!=v?(x=e.xScaleStep.indexOf("h")>-1?o.timeHour:e.xScaleStep.indexOf("w")>-1?o.timeWeek:e.xScaleStep.indexOf("m")>-1?o.timeMonth:e.xScaleStep.indexOf("y")>-1?o.timeYear:o.timeDay,y=Math.floor(v)):b<864e6&&-1===e.workingDateFormat.toLowerCase().indexOf("hh:mm")?(x=o.timeDay,y=1):e.workingDateFormat.indexOf("i")>=0?(x=o.timeMonth,y=3):e.workingDateFormat.indexOf("w")>=0?(x=o.timeWeek,y=Math.floor(b/6048e6)):-1===e.workingDateFormat.toLowerCase().indexOf("m")&&b<31536e7?(x=o.timeYear,y=1):-1===e.workingDateFormat.indexOf("d")&&b<2592e7&&(x=o.timeMonth,y=1);var _=j(e.chart).height(e.height).width(e.width).grid(e.grid).categories(e.ganttCategories).tasks(i).dateLines(n).mileStones(l).tickFormat(e.getTimeFormat(b)).ticks({ticksSize:x,ticksStep:y}).timeDomain([d,p]).timeDomainMode("fixed");_.init();var w=e.chart.selectAll("svg");e.argumentWidth=Ct(_.getTimeAxisRenderer().getAxisLine(),_.getTimeAxisRenderer().getAxis());var S={top:20+e.titleHeight,right:40,bottom:e.argumentWidth+25+e.ytitleHeight},k=it(e.ganttCategories),T=_.categoryAxisRenderer().config().axisLength;e.textWidth=ut.calcTextMaxWidth(T/e.ganttCategories.length,k,ut.maxTextWidth),_.categoryAxisRenderer().textWidth(e.textWidth),S.left=e.textWidth+20+e.xtitleHeight,_.margin(S).draw();var P=e.width-S.left-S.right,C=w.selectAll(".gantt-chart");if(e.addTitle(C,P,S),e.ytitle)var F=C.append("text").attr("x",P/2).attr("y",e.height+S.bottom-10).attr("class","axis-title").style("text-anchor","middle").style("font-weight","bold").text(e.ytitle);e.xtitle&&C.append("text").attr("transform","rotate(-90)").attr("y",20-S.left).attr("class","axis-title").attr("x",-e.height/2).style("text-anchor","middle").style("font-weight","bold").text(e.xtitle);!function(t,a){if(t>P/(e.argumentWidth+10)){var i="end",n="translate(-14, 7) rotate(-65)",r=e.height+S.top+S.bottom;w.transition().duration(a).attr("height",r).style("height",r+"px"),e.ytitle&&F.transition().duration(a).attr("y",e.height+S.bottom-10)}else{i="middle",n="translate(0, 0)";r=e.height+S.top+S.bottom-e.argumentWidth;w.transition().duration(a).attr("height",r).style("height",r+"px"),e.ytitle&&F.transition().duration(a).attr("y",e.height+S.bottom-10-e.argumentWidth)}w.selectAll(".xaxis-group text").transition().duration(a).style("text-anchor",i).attr("transform",n)}(w.selectAll(".xaxis-group text").size(),0);var A=(0,s.default)().attr("class","d3-tip chart"+e.macroId+e.pageId).offset([-5,0]).html((function(t){return K.default.escapeString(t.hint)}));e.hideTips=function(){A.hide()},w.call(A),Lt(A,w,".g_task",e),Lt(A,w,".g_dateline",e),Lt(A,w,".g_milestone",e),e.bindElementSelect(w,".g_task")}else e.customMessage.show().find(".text").text("No project data found. Please select project name, start and end date columns.")},ut.prototype.drawRadar=function(t){var e=this,a=o.scaleOrdinal().range(e.colors);a.domain(e.chartKeys);var i=_t(e.chartKeys.slice(),e.width-40,e.isPivot),n={id:e.macroId+""+e.pageId,w:e.width,h:e.height,scaleStep:isNaN(e.scaleStep)?void 0:e.scaleStep,formatter:e.formatNumTo,color:a,padding:{left:20,right:e.legend&&!e.isLegendUnderGraph&&e.chartKeys.length>1?50+i.maxWidth:20,top:20+2*e.titleHeight,bottom:e.isLegendUnderGraph&&e.chartKeys.length>1?30+20*(i.rows+1):20},maxValue:isNaN(e.maxvalue)?0:e.maxvalue,grid:e.grid},r=U.draw(e.chart,t,n);if(e.addTitle(r.svg,2*r.cfg.center.x,{top:0}),e.legend&&e.chartKeys.length>1){var s=e.chartKeys.slice();e.addLegend(r.svg,r.cfg.center.x+r.cfg.radius+n.padding.left,r.cfg.center.y+r.cfg.radius+20,n.padding.top,a,s,e.isLegendUnderGraph,(function(){}))}},ut.prototype.addLegend=function(t,e,a,i,n,r,o,s){var l=0,u=-1,c=Bt(r,this.isPivot),h=t.selectAll(".legend").data(o?c.values:c.values.slice(0,(this.svgWrapper.find("svg").attr("height")-i)/20)).enter().append("g").attr("class","legend").attr("transform",(function(t,i){return o&&(0!==i&&l+c.values[i-1].width+t.width<e?l+=c.values[i-1].width:(u+=1,l=c.width<=e?e/2-c.width/2:20)),"translate("+(o?l:c.keysWidth+26)+","+(o?a+10+20*u:20*i)+")"})).on("click",(function(e,a){var i=t.selectAll("[key]").filterByAttr("key",a.key),n="hidden"==i.style("visibility")?1:0;$(this).css("opacity",0==n?.5:1),n||i.style("visibility","hidden"),s(a.key,n),n&&setTimeout((function(){t.selectAll("[key]").filterByAttr("key",a.key).style("visibility","")}),330)}));h.append("title").text("Click to hide/show this data"),h.append("rect").attr("x",o?0:e-18).attr("width",18).attr("height",18).style("fill",(function(t){return n(t.key)})),h.append("text").attr("x",(function(t){return o?t.width-8:e-21})).attr("y",9).attr("dy",".35em").style("text-anchor","end").text((function(t){return t.view}))},ut.prototype.formatBarInnerLabel=function(t,e){var a=this;return a.innerLabelsType.percentage?t():a.innerLabelsType.value_percentage?e()+" ("+t()+")":a.innerLabelsType.percentage_value?t()+" ("+e()+")":e()},ut.prototype.addTitle=function(t,e,a,i){var n=this;if(n.title||i&&i.title)return t.append("text").attr("x",e/2).attr("y",(i&&i.titleHeight?i.titleHeight:n.titleHeight)-a.top).attr("class","title").attr("text-anchor","middle").style("font-size","16px").style("font-weight","bold").style("fill","#333").text(i&&i.title?i.title:n.title)},ut.prototype.addGroupTitle=function(){var t=this,e=0;if(t.title&&t.chartKeys.length>1){var a=$(document.createElementNS("http://www.w3.org/2000/svg","text")).attr("class","_title").attr("x",t.width/2).attr("y",16).attr("text-anchor","middle").text(t.title).css({"font-size":"16px","font-family":At(),"font-weight":"bold"}),i=$(document.createElementNS("http://www.w3.org/2000/svg","svg")).attr("width",t.width).attr("height",17).append(a);t.svgWrapper.prepend(i),e=i.outerHeight()}t.svgWrapper.height(t.height+e+5).width(t.width)},ut.prototype.convertToImage=function(){var t=ot(n().mark((function t(e){var a,i,r,o,s,l,u,h,d,p;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=this,!document.hidden){t.next=4;break}return $(document).one("visibilitychange",(function(){setTimeout((function(){a.convertToImage(e)}),1e3)})),t.abrupt("return");case 4:if(a.svgWrapper.find(".axis").css("font-size","10"),a.svgWrapper.find(".axis path, .axis line, .xaxis-group path, .xaxis-group line").css({fill:"none",stroke:"#000","shape-rendering":"crispEdges"}),a.svgWrapper.find(".line").css({fill:"none"}),a.svgWrapper.find("text").css({"font-family":At()}),a.svgWrapper.find(".axis-title").css({"font-size":"14px"}),a.svgWrapper.find(':not([class$="_tooltip"]) > text:not(.legend):not(.title):not(.percent):not(.axis-title):not(.milestone-label):not([class$="_title"]):not([class$="_segmentPercentage-inner"]):not([class$="_segmentValue-inner"]):not(.inner-value-label):not([class$="_segmentMainLabel-outer"]):not(.task-label)').css({fill:"#333","font-size":"14px","font-weight":"normal"}),a.svgWrapper.find(".grid .tick").css({stroke:"lightgrey","stroke-opacity":.7,"shape-rendering":"crispEdges"}),a.svgWrapper.find(".grid .path").css({"stroke-width":0}),a.svgWrapper.find('[class$="_title"]').css("font-weight","bold"),a.svgWrapper.find('[class$="_tooltips"], .focus').hide(),a.svgWrapper.find(".tickY, .axisY").css({stroke:"black","shape-rendering":"crispEdges"}),a.svgWrapper.find(".gridX").css({"shape-rendering":"crispEdges"}),a.svgWrapper.find(".tick").css("opacity",""),(i=a.svgWrapper.find("svg")).find("#p0_footer").remove(),i.attr("version",1.1).attr("xmlns","http://www.w3.org/2000/svg"),r=dt(i),"undefined"!=typeof btoa&&r&&!$("body").hasClass("edit")&&!$("body").hasClass("content-preview")){t.next=24;break}return a.download.hide(),t.abrupt("return");case 24:return o=a.canvas.attr("width",a.svgWrapper.width()).attr("height",a.svgWrapper.height())[0],s=o.getContext("2d"),l=a.svgWrapper.offset(),u=[],h=[],i.each(ot(n().mark((function t(){var e,a,i;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=$(this),a=e.offset(),r=dt(e),i=c.default.from(s,r,{offsetX:a.left-l.left,offsetY:a.top-l.top,ignoreDimensions:!0,ignoreClear:!0}),u.push(i),t.t0=h,t.next=8,i;case 8:t.t1=t.sent.render(),t.t0.push.call(t.t0,t.t1);case 10:case"end":return t.stop()}}),t,this)})))),t.next=31,Promise.all(u);case 31:return t.next=33,Promise.all(h);case 33:s.globalCompositeOperation="destination-over",s.fillStyle="#ffffff",s.fillRect(0,0,o.width,o.height),d=o.toDataURL("image/jpeg",1),p='<img src="'+d+'">',a.png.html(p),a.download.attr("href",d),a.preventExport||e&&e.noExport||(clearTimeout(a.exportTimer),a.exportTimer=setTimeout((function(){a.content.trigger("tf-export-ready",a.getExportEventData())}),300)),a.svgWrapper.find('[class$="_tooltips"]').show();case 42:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),ut.prototype.getExportEventData=function(){var t=this;return{macroId:t.macroId,adaptiveDimensions:t.adaptiveDimensions,data:t.calculatedData,params:[t.type,t.columns,t.aggregation,t.hide,t.grid,t.legend,t.minvalue,t.maxvalue,t.xminvalue,t.xmaxvalue,t.scalestep,t.xscalestep,t.title,t.xtitle,t.ytitle,t.isLog,t.isXLog,t.colors,t.pieKeys,t.showInnerLabels,t.showTrendLine,t.worklog,t.interpolation,t.lineSettings,t.is3D]}},ut.prototype.convertData=function(t){var e=this,a=[],i=[];t.forEach((function(t){-1==$.inArray(t.label,i)&&i.push(t.label),a[t.label]||(a[t.label]={label:t.label,values:[]}),a[t.label].values[e.chartKeys.indexOf(t.aggregation)]={name:t.aggregation,value:t.value,label:t.label,rowNumber:t.rowNumber}}));var n=[];return i.forEach((function(t){n.push(a[t])})),n.forEach((function(t){for(var a=e.isLog?Number.MIN_VALUE:0,i=a,n=0;n<t.values.length;n++){var r=t.values[n];r?r.value>=0?(r.y0=a,a+=r.value,r.y1=a):(r.y1=i,i+=r.value,r.y0=i):t.values.splice(n--,1)}t.total=a,t.min=i})),n},ut.prototype.convertSeriesDataStacked=function(t,e){var a=[];e.forEach((function(e){t.forEach((function(t){t.key===e&&(a[t.value]||(a[t.value]=0),t.y0=a[t.value],t.y1=t.y0+t.label,a[t.value]+=t.label)}))}))},ut.prototype.calcGroupSize=function(t){var e=this,a=e.width/e.height,i=Math.ceil(Math.sqrt(t*a)),n=Math.ceil(t/i),r=e.width/i,o=e.height/n,s=Math.min(r,o),l=i-1,u=Math.ceil(t/l);return s<=Math.min(e.width/l,e.height/u)&&(r=e.width/l,o=e.height/u),{width:r,height:o}},ut.prototype.addBarTrendLine=function(t,e,a,i,n,r,o,s,l){var u=this;if(u.showTrendLine){var c={};e?(c._total_={key:"",values:[]},i.forEach((function(t){c._total_.values.push({value:t.label,label:t.total})}))):a.forEach((function(t){c[t.aggregation]||(c[t.aggregation]={key:t.aggregation,values:[]}),c[t.aggregation].values.push({value:t.label,label:t.value})}));var h=0;$.each(c,(function(e,a){u.addTrendLine(a,t,n,r,o(a.key),s*(.5+h++),l)}))}},ut.prototype.addTrendLine=function(t,e,a,i,n,r,o){var s=this;if(s.showTrendLine){var l=t.values.map((function(t){return t.value})),u=l.map((function(t){return a(t)})),c=function(t,e){var a=function(t,e){return t+e},i=1*t.reduce(a)/t.length,n=1*e.reduce(a)/e.length,r=t.map((function(t){return Math.pow(t-i,2)})).reduce(a),o=e.map((function(t){return Math.pow(t-n,2)})).reduce(a),s=t.map((function(t,a){return(t-i)*(e[a]-n)})).reduce(a),l=s/r,u=n-i*l,c=Math.pow(s,2)/(r*o);return[l,u,c]}(u,t.values.map((function(t){return parseFloat(t.label)}))),h=a.domain()[a.domain().length-1];t.trendData={x1:l[0],y1:c[0]*u[0]+c[1],x2:h,y2:c[0]*a(h)+c[1]};var d=a(t.trendData.x1),p=i(t.trendData.y1),g=a(t.trendData.x2),f=i(t.trendData.y2);if(!(isNaN(p)||isNaN(f)||isNaN(d)||isNaN(g)))r=r||0,e.selectAll(".trendline[key]").filterByAttr("key",t.key).data([{}]).enter().append("line").attr("class","trendline").attr("clip-path","url(#clip"+s.macroId+s.pageId+")").attr("key",t.key).attr(o?"y1":"x1",d+r).attr(o?"x1":"y1",p).attr(o?"y2":"x2",g+r).attr(o?"x2":"y2",f).attr("stroke",n).attr("stroke-dasharray","10,10").attr("stroke-width",1)}},ut.prototype.enableSaveBtn=function(){var t=this;t.btn.removeClass("tf-disabled-link"),t.controls.add(t.btn).find(".tfac-unsaved").show(),tt.default.addToUnloadPageAction(t)},ut.prototype.shiftInterpolationBtn=function(){var t=this;!t.type||-1===t.type.indexOf("Line")&&-1===t.type.indexOf("Area")?t.setInterpolationBtn.hide():t.setInterpolationBtn.show()},ut.prototype.shiftChangeLineSettingsBtn=function(){var t=this;t.type&&-1!==t.type.indexOf("Line")?t.changeLineSettingsBtn.show():t.changeLineSettingsBtn.hide()},ut.prototype.bindTips=function(){var t=this;$("body").delegate(".d3-tip.chart"+t.macroId+t.pageId,"mouseover",(function(){t.tipHover=!0})).delegate(".d3-tip.chart"+t.macroId+t.pageId,"mouseout",(function(){t.tipHover=!1,t.hideTips()}))},ut.prototype.getTimeFormat=function(t){var e=this;if(-1===e.workingDateFormat.toLowerCase().indexOf("hh:mm"))return function(t){return K.default.formatDate(t,e.workingDateFormat,e.locale)};var a=K.default.getDateFormatWithoutTime(e.workingDateFormat);return function(i){return 0===i.getHours()&&0===i.getMinutes()&&0===i.getSeconds()?K.default.formatDate(i,a,e.locale):t>864e6?K.default.formatDate(i,e.workingDateFormat,e.locale):K.default.formatTime(i,e.workingDateFormat)}},ut.prototype.getInterpolation=function(t){var e=this;return e.interpolation instanceof Array&&e.updateInterpolation(),e.interpolation[t]||(e.interpolation[t]=e.defaultInterpolation),function(t){switch(t){case"Linear":return o.curveLinear;case"Step":return o.curveStep;case"Natural cubic":return o.curveNatural;case"Monotone X cubic":return o.curveMonotoneX;case"Monotone Y cubic":return o.curveMonotoneY;case"Cubic Catmull–Rom":return o.curveCatmullRom;case"Cubic cardinal":return o.curveCardinal;case"Cubic basis":case"Straightened cubic basis":return o.curveBasis;default:return o.curveLinear}}(e.interpolation[t])},ut.prototype.getLineWidth=function(t){var e=this;return e.lineSettings instanceof Array&&e.updateLineSettings(),e.lineSettings[t]&&e.lineSettings[t].width||1.5},ut.prototype.getLineType=function(t){var e=this;return e.lineSettings instanceof Array&&e.updateLineSettings(),e.lineSettings[t]&&e.lineSettings[t].type||"solid"},ut.prototype.updateInterpolation=function(){var t=this,e={};t.chartKeys.forEach((function(a,i){e[a]=i<t.interpolation.length?t.interpolation[i]:t.defaultInterpolation})),t.interpolation=e},ut.prototype.updateLineSettings=function(){var t=this,e={};t.chartKeys.forEach((function(a,i){e[a]=i<t.lineSettings.length?{type:t.lineSettings[i].split("-")[0],width:parseFloat(t.lineSettings[i].split("-")[1])}:{type:"solid",width:1.5}})),t.lineSettings=e},ut.prototype.getInnerLabelsParam=function(){var t=this;return t.showInnerLabels?t.innerLabelsType.value_percentage?"Value (Percentage)":t.innerLabelsType.percentage_value?"Percentage (Value)":t.innerLabelsType.percentage?"Percentage":t.innerLabelsType.value?"Value":"Donut"===t.type||"Pie"===t.type?"Percentage":"":"None"},ut.prototype.clearTableHighlight=function(){var t=this;t.originalTable.removeClass("tf-chart-highlight"),t.rows.forEach((function(t){t.removeClass("tf-chart-highlight")})),t.originalTable.trigger("tf-chart-highlight-off")},ut.prototype.highlightTable=function(t){var e=this;e.originalTable.addClass("tf-chart-highlight"),$.each(t.rowNumber,(function(a,i){var n=e.rows[a];i.forEach((function(t){n.eq(t).addClass("tf-chart-highlight")})),e.originalTable.eq(a).trigger("tf-chart-highlight-on",{rowNumbers:i,column:t.column})}))},ut.prototype.bindElementSelect=function(t,e,a){var i=this;function n(t){i.clearTableHighlight();var n=o.select(t);n.classed("highlighted",!n.classed("highlighted")),i.svgWrapper.find(e+".highlighted").each((function(){i.highlightTable(a?a(this):{rowNumber:this.__data__.rowNumber,column:i.getColumnNameForHighlight(this.__data__.name)})}))}t.selectAll(e).on("click",(function(){n(this)})),t.selectAll("text.inner-value-label, text.percent").on("click",(function(){var t=$(this.parentNode),a=t.find(e);n(a.eq(t.find("text.inner-value-label, text.percent").index(this)%a.length)[0])}))},ut.prototype.getColumnNameForHighlight=function(t){return t?this.columns.length<2?t:t.substring(0,t.lastIndexOf(" - ")):""},ut.prototype.triggerSettingsButtonInvoke=function(){var t=this;t.settings.trigger("aui-button-invoke"),t.settings.is(".active")&&t.settings.trigger("aui-button-invoke")},ut.prototype.formatBubbleLegend=function(t){var e=this,a=$("<span></span>");$("body").append(a);var i=[];t.shapes._groups[0].forEach((function(t,n){var r=$(t).children("text"),o=$(t).children("rect"),s=r.text();o.attr("height",18).attr("width",18);var l=o.width()+5+a.text(s).width(),u=0,c=0;e.isLegendUnderGraph?(0===n||(e.bubblePieSetting.indexFirstLegendInRow||[]).includes(n)?(0!==n&&(o.attr("y",i[n-1].signaturePosY+5+18),r.attr("y",i[n-1].signaturePosY+5+18)),u=+o.attr("x"),c=+o.attr("y"),r.attr("x",+r.attr("x")+3)):(u=i[n-1].signaturePosX+i[n-1].width+10,c=i[n-1].signaturePosY,o.attr("y",c)),r.attr("y",c+13),i.push({width:l,signaturePosX:u,signaturePosY:c}),0!==n&&((e.bubblePieSetting.indexFirstLegendInRow||[]).includes(n)?0:(1,r.attr("x",+u+23),o.attr("x",+u)))):0!==n?(r.attr("y",+r.attr("y")+3+9*n),o.attr("y",+o.attr("y")+9*n)):r.attr("y",+r.attr("y")+3)})),a.remove()},ut.prototype.calcBubbleChartExtremum=function(){var t,e,a=this,i=31536e6;if(a.xminvalue){var n=K.default.getAnyValueType(a.xminvalue,a.separator,a.worklog,!0,a.dateFormat,a.locale);n===a.xValueType&&(a.bubblePieSetting.axisX.minValue=K.default.parseAnyValueByType(n,a.xminvalue,a.separator,a.worklog,!0,a.dateFormat,a.locale))}if(a.xmaxvalue){var r=K.default.getAnyValueType(a.xmaxvalue,a.separator,a.worklog,!0,a.dateFormat,a.locale);r===a.xValueType&&(a.bubblePieSetting.axisX.maxValue=K.default.parseAnyValueByType(r,a.xmaxvalue,a.separator,a.worklog,!0,a.dateFormat,a.locale))}if(a.bubblePieSetting.axisX.maxValue<a.bubblePieSetting.axisX.minValue){var o=a.bubblePieSetting.axisX.minValue,s=a.bubblePieSetting.axisX.maxValue;a.bubblePieSetting.axisX.minValue=s,a.bubblePieSetting.axisX.maxValue=o}a.bubblePieSetting.axisX.maxValue===a.bubblePieSetting.axisX.minValue&&(a.xValueType===K.default.date?t=i/2:a.xValueType===K.default.worklog?t=K.default.parseAnyValueByType(a.xValueType,"8h",a.separator,a.worklog,!0,a.dateFormat,a.locale):a.xValueType===K.default.number?t=K.default.parseAnyValueByType(a.xValueType,.5*a.bubblePieSetting.axisX.maxValue,a.separator,a.worklog,!0,a.dateFormat,a.locale):a.xValueType===K.default.duration&&(t=K.default.parseAnyValueByType(a.xValueType,"8:00",a.separator,a.worklog,!0,a.dateFormat,a.locale)),a.bubblePieSetting.axisX.maxValue=+a.bubblePieSetting.axisX.maxValue+t,a.bubblePieSetting.axisX.minValue=a.bubblePieSetting.axisX.minValue-t);if(a.yminvalue){var l=K.default.getAnyValueType(a.yminvalue,a.separator,a.worklog,!0,a.dateFormat,a.locale);l===a.valueType&&(a.bubblePieSetting.axisY.minValue=K.default.parseAnyValueByType(l,a.yminvalue,a.separator,a.worklog,!0,a.dateFormat,a.locale))}if(a.ymaxvalue){var u=K.default.getAnyValueType(a.ymaxvalue,a.separator,a.worklog,!0,a.dateFormat,a.locale);u===a.valueType&&(a.bubblePieSetting.axisY.maxValue=K.default.parseAnyValueByType(u,a.ymaxvalue,a.separator,a.worklog,!0,a.dateFormat,a.locale))}if(a.bubblePieSetting.axisY.maxValue<a.bubblePieSetting.axisY.minValue){var c=a.bubblePieSetting.axisY.minValue,h=a.bubblePieSetting.axisY.maxValue;a.bubblePieSetting.axisY.minValue=h,a.bubblePieSetting.axisY.maxValue=c}a.bubblePieSetting.axisY.maxValue===a.bubblePieSetting.axisY.minValue&&(a.valueType===K.default.date?e=i/2:a.valueType===K.default.worklog?e=K.default.parseAnyValueByType(a.valueType,"8h",a.separator,a.worklog,!0,a.dateFormat,a.locale):a.valueType===K.default.number?e=K.default.parseAnyValueByType(a.valueType,.5*a.bubblePieSetting.axisY.maxValue,a.separator,a.worklog,!0,a.dateFormat,a.locale):a.valueType===K.default.duration&&(e=K.default.parseAnyValueByType(a.valueType,"8:00",a.separator,a.worklog,!0,a.dateFormat,a.locale)),a.bubblePieSetting.axisY.maxValue=+a.bubblePieSetting.axisY.maxValue+e,a.bubblePieSetting.axisY.minValue=a.bubblePieSetting.axisY.minValue-e)},ut.prototype.setBubbleAxisX=function(t){var e,a=this;if(a.xValueType===K.default.date){a.workingDateFormat=a.bubblePieSetting.axisX.dateFormat;var i=a.getTimeFormat(a.bubblePieSetting.axisX.maxValue-a.bubblePieSetting.axisX.minValue);(e=t.addTimeAxis("x",a.bubblePieSetting.axisX.title))._getFormat=function(){return i}}else a.xValueType===K.default.worklog?(e=t.addTimeAxis("x",a.bubblePieSetting.axisX.title))._getFormat=function(){return a.formatNumToX}:a.xValueType===K.default.number||a.xValueType===K.default.duration?(e=t.addMeasureAxis("x",a.bubblePieSetting.axisX.title))._getFormat=function(){return function(t){return a.formatNumToX(t)}}:(e=t.addCategoryAxis("x",a.bubblePieSetting.axisX.title))._getFormat=function(){return e.maxTextWidth=a.bubleMaxTextWidthX,ut.formatedMultiline(a.bubleMaxTextWidthX,null!==a.xValueType?a.formatNumToX:null)};return e},ut.prototype.setBubbleAxisY=function(t){var e,a=this;if(a.valueType===K.default.date){a.workingDateFormat=a.bubblePieSetting.axisY.dateFormat;var i=a.getTimeFormat(a.bubblePieSetting.axisY.maxValue-a.bubblePieSetting.axisY.minValue);(e=t.addTimeAxis("y",a.bubblePieSetting.axisY.title))._getFormat=function(){return i}}else a.valueType===K.default.worklog?(e=t.addTimeAxis("y",a.bubblePieSetting.axisY.title))._getFormat=function(){return a.formatNumTo}:a.valueType===K.default.number||a.valueType===K.default.duration?(e=t.addMeasureAxis("y",a.bubblePieSetting.axisY.title))._getFormat=function(){return function(t){return a.formatNumTo(t)}}:(e=t.addCategoryAxis("y",a.bubblePieSetting.axisY.title))._getFormat=function(){return e.maxTextWidth=a.bubleMaxTextWidthY,ut.formatedMultiline(a.bubleMaxTextWidthY,null!==a.valueType?a.formatNumTo:null)};return e},ut.prototype.setBubbleAxisXScale=function(t){var e=this;if(e.bubblePieSetting.axisX.maxValue&&e.bubblePieSetting.axisX.minValue&&e.bubblePieSetting.axisX.maxValue>e.bubblePieSetting.axisX.minValue){if(t.overrideMax=e.bubblePieSetting.axisX.maxValue,t.overrideMin=e.bubblePieSetting.axisX.minValue,!e.xScaleStep&&e.xValueType===K.default.date){var a=e.bubblePieSetting.axisX.maxValue-e.bubblePieSetting.axisX.minValue;a<1728e5?e.xScaleStep=Math.ceil(a/36e5/12)+"h":a<864e6&&(e.xScaleStep="1d")}if(e.xScaleStep){var i=K.default.parseNumber(e.xScaleStep.toString(),e.separator);e.xValueType===K.default.date&&(t.timePeriod=e.xScaleStep.indexOf("h")>-1?o.timeHour:e.xScaleStep.indexOf("w")>-1?o.timeWeek:e.xScaleStep.indexOf("m")>-1?o.timeMonth:e.xScaleStep.indexOf("y")>-1?o.timeYear:o.timeDay,t.timeInterval=i),e.xValueType===K.default.worklog&&(t.timePeriod=e.xScaleStep.indexOf("h")>-1?o.timeHour:e.xScaleStep.indexOf("w")>-1?o.timeWeek:o.timeDay,t.timeInterval=i)}}},ut.prototype.setBubbleAxisYScale=function(t){var e=this;if(e.bubblePieSetting.axisY.maxValue&&e.bubblePieSetting.axisY.minValue&&e.bubblePieSetting.axisY.maxValue>e.bubblePieSetting.axisY.minValue){if(t.overrideMax=e.bubblePieSetting.axisY.maxValue,t.overrideMin=e.bubblePieSetting.axisY.minValue,!e.yScaleStep&&e.valueType===K.default.date){var a=e.bubblePieSetting.axisY.maxValue-e.bubblePieSetting.axisY.minValue;a<1728e5?e.yScaleStep=Math.ceil(a/36e5/12)+"h":a<864e6&&(e.yScaleStep="1d")}if(e.yScaleStep){var i=K.default.parseNumber(e.yScaleStep.toString(),e.separator);e.valueType===K.default.date&&(t.timePeriod=e.yScaleStep.indexOf("h")>-1?o.timeHour:e.yScaleStep.indexOf("w")>-1?o.timeWeek:e.yScaleStep.indexOf("m")>-1?o.timeMonth:e.yScaleStep.indexOf("y")>-1?o.timeYear:o.timeDay,t.timeInterval=i),e.valueType===K.default.worklog&&(t.timePeriod=e.yScaleStep.indexOf("h")>-1?o.timeHour:e.yScaleStep.indexOf("w")>-1?o.timeWeek:o.timeDay,t.timeInterval=i)}}},ut.prototype.settingBubbleAxis=function(t,e){var a=this;t.showGridlines=a.grid,e.showGridlines=a.grid,t.title=a.xtitle||"",e.title=a.ytitle||"",t.fontSize="14px",e.fontSize="14px"},ut.prototype.calculateBubbleLegendSize=function(){var t=this;if(t.isLegendUnderGraph){var e=_t(t.bubblePieSetting.filterAggregation.slice(),t.width-(20+t.bubblePieSetting.axisY.longestTitle+5+t.ytitleHeight),t.isPivot,36);t.bubblePieSetting.legendHeight=25*(e.rows+1),t.bubblePieSetting.indexFirstLegendInRow=e.firstInRow,t.bubblePieSetting.posX=e.posX}else{var a=$("<span></span>");$("body").append(a);var i=K.default.getLongestWordInArr(t.bubblePieSetting.filterAggregation).substr(0,ut.textMaxLength);t.bubblePieSetting.legendWidth=23+a.text(i).width(),t.bubblePieSetting.legendHeight=22*t.bubblePieSetting.filterAggregation.length,a.remove()}},ut.prototype.optimizeBubbleMultilineWidth=function(t,e,a,i){var n=this,r=0,o=0,s=n.bubleMaxTextWidthX,l=n.bubleMaxTextWidthY,u=n.width-t.left-t.right,c=n.height-t.top-t.bottom,h=n.bubblePieSetting.axisX.order.length,d=n.bubblePieSetting.axisY.order.length,p=function(){l=ut.calcTextMaxWidth(c/d,n.bubblePieSetting.axisY.longestTitleObject,n.bubleMaxTextWidthY),r=l-n.bubleMaxTextWidthY,u-=r},g=function(){var t,i;a.maxTextWidth&&p(),e.maxTextWidth&&(i=(t=u/h)>e.maxTextWidth,s=i?Math.min(t-5,n.bubblePieSetting.axisX.longestTitleObject.width):ut.calcTextMaxWidth(t,n.bubblePieSetting.axisX.longestTitleObject,n.bubleMaxTextWidthX),i?(n.bubleMaxTextWidthX=s,o=0):(o=s-n.bubleMaxTextWidthX,c-=o)),o&&!r&&a.maxTextWidth&&p(),o&&(n.bubleMaxTextWidthX=s,n.maxSizeX=n.bubleMaxTextWidthX),r&&(n.bubleMaxTextWidthY=l,n.bubblePieSetting.axisY.longestTitle=n.bubleMaxTextWidthY+9)},f=0;do{g()}while((r>0||o>0)&&++f<2&&u>0&&c>0);i&&i(),t.left>n.width-t.right&&(t.left=n.width-t.right-100),t.bottom>n.height-t.top&&(t.bottom=n.height-t.top-100)},ut.prototype.formatDimpleAxisX=function(t){t.shapes.selectAll("text").each((function(){if(!$(this).attr("transform"))return!1;var t=o.select(this),e=t.attr("transform").replace("rotate(90","rotate(-90").replace("translate(-5","translate(5");t.attr("transform",e),"start"===t.style("text-anchor")&&t.style("text-anchor","end")})).call(ut.multilineAlign),this.xtitleHeight&&t.titleShape.attr("y",+t.titleShape.attr("y")+5)},ut.prototype.eventHandlerSeries=function(t,e){var a=this,i={},n={},r={};t.shapes.on("click",(function(t,o){var s="push",l=o.aggField[0],u=o.aggField[1],c=o.cy,h=o.cx,d=o.aggField[2],p=this;p.classList.contains("highlighted")?(p.classList.remove("highlighted"),s="remove"):p.classList.add("highlighted"),e.forEach((function(t){if(n[t.tableI]||(n[t.tableI]=[0]),-1===n[t.tableI].indexOf(t.rowI)&&n[t.tableI].push(t.rowI),t.indicator===d){if(a.valueType===K.default.number||a.valueType===K.default.duration){if(t["orig_"+a.bubblePieSetting.axisY.title]!==c)return}else if(t[a.bubblePieSetting.axisY.title]!==u)return;if(a.xValueType===K.default.number||a.xValueType===K.default.duration){if(t["orig_"+a.bubblePieSetting.axisX.title]!==h)return}else if(t[a.bubblePieSetting.axisX.title]!==l)return;"push"===s?(i[t.tableI]||(i[t.tableI]=[0],r[t.tableI]=[]),-1===i[t.tableI].indexOf(t.rowI)&&i[t.tableI].push(t.rowI),r[t.tableI].push(t.rowI)):(r[t.tableI].indexOf(t.rowI)>-1&&r[t.tableI].splice(r[t.tableI].indexOf(t.rowI),1),i[t.tableI].indexOf(t.rowI)>-1&&-1===r[t.tableI].indexOf(t.rowI)&&i[t.tableI].splice(i[t.tableI].indexOf(t.rowI),1),1===i[t.tableI].length&&delete i[t.tableI])}})),a.clearTableHighlight(),a.highlightTable({rowNumber:$.isEmptyObject(i)?n:i})}))},ut.prototype.eventHandleLegendClick=function(t,e,a,i){var n=this;t.legends=[];var r=u().getUniqueValues(a,"indicator");e.shapes.selectAll("rect").on("click",(function(e,s){var l=!1,c=[];r.forEach((function(t){t===s.aggField.slice(-1)[0]?l=!0:c.push(t)})),l?o.select(this).style("opacity",.2):(c.push(s.aggField.slice(-1)[0]),o.select(this).style("opacity",1)),r=c;var h=n.bubblePieSetting.axisX.title,d=n.bubblePieSetting.axisY.title;n.bubblePieSetting.sameValuesCount={},a.forEach((function(t){r.includes(t.indicator)&&(n.valueType!==K.default.number&&n.valueType!==K.default.duration&&n.xValueType!==K.default.number&&n.xValueType!==K.default.duration||(n.bubblePieSetting.sameValuesCount[(t["orig_"+h]||t[h])+"_"+(t["orig_"+d]||t[d])]>0?n.bubblePieSetting.sameValuesCount[(t["orig_"+h]||t[h])+"_"+(t["orig_"+d]||t[d])]+=1:n.bubblePieSetting.sameValuesCount[(t["orig_"+h]||t[h])+"_"+(t["orig_"+d]||t[d])]=1))}));var p=u().filterData(a,"indicator",r);p.forEach((function(t){n.valueType!==K.default.number&&n.valueType!==K.default.duration||(t[d]=parseFloat(t["orig_"+d]/n.bubblePieSetting.sameValuesCount[(t["orig_"+h]||t[h])+"_"+(t["orig_"+d]||t[d])])),n.xValueType!==K.default.number&&n.xValueType!==K.default.duration||(t[h]=parseFloat(t["orig_"+h]/n.bubblePieSetting.sameValuesCount[(t["orig_"+h]||t[h])+"_"+(t["orig_"+d]||t[d])]))})),t.data=p,t.draw(),i&&i()}))},ut.prototype.settingSeriesTooltip=function(t){var e=this;t.getTooltipText=function(t){var a=function(t,a,i){return K.default.formatAnyValueByType(t,a,(function(t){return t>=1e4?e.formatNum.to(t):e.formatNumShort.to(t)}),e.worklog,i,e.locale)},i=null!==e.xValueType?a(t.cx,e.xValueType,e.bubblePieSetting.axisX.dateFormat):t.cx,n=null!==e.valueType?a(t.cy,e.valueType,e.bubblePieSetting.axisY.dateFormat):t.cy,r=null!==e.bubblePieSetting.indicator.valueType?a(t.cz,e.bubblePieSetting.indicator.valueType):t.cz;switch(e.getInnerLabelsParam()){case"Value (Percentage)":r+=" ("+Math.round(100*t.piePct)+"%)";break;case"Percentage (Value)":r=Math.round(100*t.piePct)+"% ("+r+")";break;case"Percentage":r=Math.round(100*t.piePct)+"%"}return[e.bubblePieSetting.axisX.title+": "+i,e.bubblePieSetting.axisY.title+": "+n,t.aggField[2]+": "+r]}},ut.prototype.formatExtremumAxesX=function(t,e,a,i){var n=this;if(null!==n.xValueType||null!==n.valueType){var r=wt($(i.svg._groups[0])),o={left:0,right:0,tickXSize:0},s=0,l=0,u=0;t.shapes.selectAll("g").each((function(){s+=1})),o.left=r.left+a.left,o.right=r.right-a.right,o.tickXSize=r.width/s,e.shapes.each((function(){var t=wt($(this));t.left<o.left&&(u=Math.max(u,o.left-t.left)),t.right>o.right&&(l=Math.max(l,t.right-o.right))})),u>0&&null!==n.xValueType&&(t.overrideMin-=(t.overrideMax-t.overrideMin)/s*Math.ceil(u/o.tickXSize)),l>0&&null!==n.xValueType&&(t.overrideMax=+t.overrideMax+(t.overrideMax-t.overrideMin)/s*Math.ceil(l/o.tickXSize))}},ut.prototype.formatExtremumAxesY=function(t,e,a,i){var n=this;if(null!==n.xValueType||null!==n.valueType){var r=St($(i.svg._groups[0])),o={top:0,bottom:0,tickYSize:0},s=0,l=0,u=0;t.shapes.selectAll("g").each((function(){s+=1})),o.top=r.top+a.top,o.bottom=r.bottom-a.bottom,o.tickYSize=r.height/s,e.shapes.each((function(){var t=St($(this));t.top<o.top&&(l=Math.max(l,o.top-t.top)),t.bottom>o.bottom&&(u=Math.max(u,t.bottom-o.bottom))})),l>0&&null!==n.valueType&&(t.overrideMax=+t.overrideMax+(t.overrideMax-t.overrideMin)/s*Math.ceil(l/o.tickYSize)),u>0&&null!==n.valueType&&(t.overrideMin-=(t.overrideMax-t.overrideMin)/s*Math.ceil(u/o.tickYSize))}},ut.calcTextMaxWidth=function(t,e,a){if(t<=18||a>=e.width)return e.width;a=a||ut.maxTextWidth;var i=14*ut.stringToLines(e.text,a).length+4;return i>t?(a=Math.ceil(a*i/t),ut.calcTextMaxWidth(t,e,a)):a},ut.formatedMultiline=function(t,e){return function(a,i){if(a=e?e(a,i):a,at(a)<=t)return a;var n=this.cloneNode(!0);return this.parentNode.insertBefore(n,this),o.select(n).text(a).call(ut.textToMultiline,t),this.parentNode.removeChild(this),null}},ut.textsToMultiline=function(t,e,a){return t.each((function(){ut.textToMultiline(o.select(this),e,a)})),t},ut.textToMultiline=function(t,e,a){e=e||ut.textMaxWidth,a=a||"middle";var i=t.text();if(at(i)<=e)return t;var n=ut.stringToLines(i,e),r=t.attr("x")||"0em";return t.text(null),n.forEach((function(e,a){t.append("tspan").attr("x",r).attr("dy","1em").text(e)})),t.call(ut.tspanAlign,a),t},ut.stringToLines=function(t,e){for(var a=t.split(/\s+/),i=[],n="",r=0,o=function(){i.push(n),n="",r=0},s=function(t,e,a){var i=t,n=at(e.substr(0,i));if(n>a)for(;n>a&&--i>0;)n-=at(e[i]);else{for(;n<a&&++i<e.length;)n+=at(e[i]);i=Math.max(0,--i)}return i},l=0;l<a.length;l++){var u=n.length>0?" ":"",c=at(a[l]),h=n.length>0?3.85:0;if((r+=h)+h+c<=e)n+=u+a[l],r+=c;else if(c>e){var d=s(Math.floor(a[l].length*(e-r)/c),a[l],e-r);d&&(n+=u+a[l].substring(0,d),r+=d,a[l]=a[l].substring(d)),l--,o()}else o(),n+=a[l],r+=c}return n.length&&o(),i},ut.multilineAlign=function(t,e){return t.each((function(){ut.tspanAlign(o.select(this),e)})),t},ut.tspanAlign=function(t,e){var a=t.selectAll("tspan");if(e=e||("middle"===t.style("text-anchor")?"top":"middle"),a.size()){var i=parseFloat(t.attr("dy"))||0;"middle"===e&&(i-=(a.size()-1)/2),o.select(a.nodes()[0]).attr("dy",i+"em")}return t},ut.getMultilineHeight=function(t){var e=0;return t.each((function(){o.select(this).select("tspan").size()&&(e=Math.max(this.getBBox().height,e))})),e},ut.prototype.setColorKeyMap=function(t,e,a){return e.forEach((function(e,i){t[e]=a[i]})),t},ut.prototype.getColorsFromMap=function(t,e,a){var i=e.map((function(e,a){return t[e]})),n=i.filter((function(t){return t})),r=n.length;Mt(n,a);var o=0;return Mt(i=i.slice(0,e.length).map((function(a,i){return a||(a=n[(r+o++)%n.length],t[e[i]]=a),a})),a),i};var Vt=ut},64932:function(t,e,a){var i,n;function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(o,s){"use strict";"object"==r(e)?t.exports=s(a(89976)):(i=[a(89976)],void 0===(n=function(t){return o.dimple=s(t),o.dimple}.apply(e,i))||(t.exports=n))}(this,(function(t){"use strict";var e={version:"2.2.0",plot:{},aggregateMethod:{},axis:function(a,i,n,r,o,s){this.chart=a,this.position=i,this.categoryFields=null==o?n:[].concat(o),this.measure=r,this.timeField=o,this.floatingBarWidth=5,this.hidden=!1,this.showPercent=!1,this.colors=null,this.overrideMin=null,this.overrideMax=null,this.shapes=null,this.showGridlines=null,this.gridlineShapes=null,this.titleShape=null,this.dateParseFormat=null,this.tickFormat=null,this.timePeriod=null,this.timeInterval=1,this.useLog=!1,this.logBase=10,this.title=void 0,this.clamp=!0,this.ticks=null,this.fontSize="10px",this.fontFamily="sans-serif",this.autoRotateLabel=null==s||s,this._slaves=[],this._scale=null,this._min=0,this._max=0,this._previousOrigin=null,this._origin=null,this._orderRules=[],this._groupOrderRules=[],this._draw=null,this._getAxisData=function(){var t,e,a=[],i=!1;if(this.chart&&this.chart.series){for(t=0;t<this.chart.series.length;t+=1)(e=this.chart.series[t])[this.position]===this&&(e.data&&e.data.length>0?a=a.concat(e.data):i=!0);i&&this.chart.data&&(a=a.concat(this.chart.data))}return a},this._getFontSize=function(){return this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._getFormat=function(){var e,a,i,n,r,o,s;return null!==this.tickFormat&&void 0!==this.tickFormat?e=this._hasTimeField()?t.timeFormat(this.tickFormat):t.format(this.tickFormat):this.showPercent?e=t.format(".0%"):this.useLog&&null!==this.measure?e=function(e){var a=Math.floor(Math.abs(e),0).toString().length,i=Math.min(Math.floor((a-1)/3),4),n="kmBT".substring(i-1,i),r="0"===Math.round(e/Math.pow(1e3,i)*10).toString().slice(-1)?0:1;return 0===e?0:t.format(",."+r+"f")(e/Math.pow(1e3,i))+n}:null!==this.measure?(a=Math.floor(Math.abs(this._max),0).toString(),i=Math.floor(Math.abs(this._min),0).toString(),(n=Math.max(i.length,a.length))>3?(r=Math.min(Math.floor((n-1)/3),4),o="kmBT".substring(r-1,r),s=n-3*r<=1?1:0,e=function(e){return 0===e?0:t.format(",."+s+"f")(e/Math.pow(1e3,r))+o}):(s=Math.max(-(this._tick_step?Math.floor(Math.log(this._tick_step)/Math.LN10):0),0),e=t.format(",."+s+"f"))):e=function(t){return t},e},this._getTimePeriod=function(){var e=this.timePeriod,a=30,i=this._max-this._min;return this._hasTimeField()&&!this.timePeriod&&(e=i/1e3<=a?t.timeSecond:i/6e4<=a?t.timeMinute:i/36e5<=a?t.timeHour:i/864e5<=a?t.timeHay:i/6048e5<=a?t.timeWeek:i/26298e5<=a?t.timeMonth:t.timeYear),e},this._getTooltipText=function(e,a){if(this._hasTimeField())a[this.position+"Field"][0]&&e.push(this.timeField+": "+this._getFormat()(a[this.position+"Field"][0]));else if(this._hasCategories())this.categoryFields.forEach((function(t,i){null!=t&&a[this.position+"Field"][i]&&e.push(t+(a[this.position+"Field"][i]!==t?": "+a[this.position+"Field"][i]:""))}),this);else if(this._hasMeasure())switch(this.position){case"x":e.push(this.measure+": "+this._getFormat()(a.width));break;case"y":e.push(this.measure+": "+this._getFormat()(a.height));break;case"p":e.push(this.measure+": "+this._getFormat()(a.angle)+" ("+t.format(".0%")(a.piePct)+")");break;default:e.push(this.measure+": "+this._getFormat()(a[this.position+"Value"]))}},this._getTopMaster=function(){var t=this;return null!==this.master&&void 0!==this.master&&(t=this.master._getTopMaster()),t},this._hasCategories=function(){return null!==this.categoryFields&&void 0!==this.categoryFields&&this.categoryFields.length>0},this._hasMeasure=function(){return null!==this.measure&&void 0!==this.measure},this._hasTimeField=function(){return null!==this.timeField&&void 0!==this.timeField},this._parseDate=function(e){return null===this.dateParseFormat||void 0===this.dateParseFormat?isNaN(e)?Date.parse(e):new Date(e):t.timeParse(this.dateParseFormat)(e)},this._update=function(a){var i,n,r,o,s=[],l=this.ticks||10,u=function(t,a,i){var n,r,o=t.categoryFields[0],s=t._getAxisData(),l=o,u=!1,c=!0,h=null;for(n=0;n<s.length;n+=1)if(null!=(h=t._parseDate(s[n][o]))&&isNaN(h)){c=!1;break}return c||t.chart.series.forEach((function(e){e[a]===t&&e[i]._hasMeasure()&&(l=e[i].measure,u=!0)}),this),r=t._orderRules.concat({ordering:l,desc:u}),e._getOrderedList(s,o,r)};if(this._min=this.showPercent&&this._min<-1?-1:this._min,this._max=this.showPercent&&this._max>1?1:this._max,this._min=null!==this.overrideMin?this.overrideMin:this._min,this._max=null!==this.overrideMax?this.overrideMax:this._max,"x"!==this.position||null!==this._scale&&!a){if("y"!==this.position||null!==this._scale&&!a)this.position.length>0&&"z"===this.position[0]&&null===this._scale?this.useLog?this._scale=t.scaleLog().range([this.chart._heightPixels()/300,this.chart._heightPixels()/10]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase):this._scale=t.scaleLinear().range([1,this.chart._heightPixels()/10]).domain([this._min,this._max]).clamp(this.clamp):this.position.length>0&&"p"===this.position[0]&&null===this._scale?this.useLog?this._scale=t.scaleLog().range([0,360]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase):this._scale=t.scaleLinear().range([0,360]).domain([this._min,this._max]).clamp(this.clamp):this.position.length>0&&"c"===this.position[0]&&null===this._scale&&(this._scale=t.scaleLinear().range([0,null===this.colors||1===this.colors.length?1:this.colors.length-1]).domain([this._min,this._max]).clamp(this.clamp));else if(this._hasTimeField()?this._scale=t.scaleTime().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([this._min,this._max]).clamp(this.clamp):this.useLog?this._scale=t.scaleLog().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase).nice():null===this.measure||void 0===this.measure?(s=u(this,"y","x"),null!==this._slaves&&void 0!==this._slaves&&this._slaves.forEach((function(t){s=s.concat(u(t,"y","x"))}),this),this._scale=t.scalePoint().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain(s.concat([""]))):this._scale=t.scaleLinear().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([this._min,this._max]).clamp(this.clamp).nice(),!this.hidden)switch(this.chart._axisIndex(this,"y")){case 0:this._draw=t.axisLeft().scale(this._scale),this.ticks&&this._draw.ticks(l);break;case 1:this._draw=t.axisRight().scale(this._scale),this.ticks&&this._draw.ticks(l)}}else if(this._hasTimeField()?this._scale=t.scaleTime().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([this._min,this._max]).clamp(this.clamp):this.useLog?this._scale=t.scaleLog().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase).nice():null===this.measure||void 0===this.measure?(s=u(this,"x","y"),null!==this._slaves&&void 0!==this._slaves&&this._slaves.forEach((function(t){s=s.concat(u(t,"x","y"))}),this),this._scale=t.scalePoint().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain(s.concat([""]))):this._scale=t.scaleLinear().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([this._min,this._max]).clamp(this.clamp).nice(),!this.hidden)switch(this.chart._axisIndex(this,"x")){case 0:this._draw=t.axisBottom().scale(this._scale),this.ticks&&this._draw.ticks(l);break;case 1:this._draw=t.axisTop().scale(this._scale),this.ticks&&this._draw.ticks(l)}return null!==this._slaves&&void 0!==this._slaves&&this._slaves.length>0&&this._slaves.forEach((function(t){t._scale=this._scale}),this),null!=a&&!1!==a||this._hasTimeField()||null===this._scale||null===this._scale.ticks||void 0===this._scale.ticks||!(this._scale.ticks(l).length>0)||"x"!==this.position&&"y"!==this.position||(n=(i=this._scale.ticks(l))[1]-i[0],r=((this._max-this._min)%n).toFixed(0),this._tick_step=n,0!==r&&(this._max=Math.ceil(this._max/n)*n,this._min=Math.floor(this._min/n)*n,this._update(!0))),o=null!=s&&s.length>0?this._scale.copy()(s[0]):this._min>0?this._scale.copy()(this._min):this._max<0?this._scale.copy()(this._max):this._scale.copy()(0),this._origin!==o&&(this._previousOrigin=null===this._origin?o:this._origin,this._origin=o),this},this.addGroupOrderRule=function(t,e){this._groupOrderRules.push({ordering:t,desc:e})},this.addOrderRule=function(t,e){this._orderRules.push({ordering:t,desc:e})}},chart:function(a,i){this.svg=a,this.x="10%",this.y="10%",this.width="80%",this.height="80%",this.data=i,this.noFormats=!1,this.axes=[],this.series=[],this.legends=[],this.storyboard=null,this.titleShape=null,this.shapes=null,this.ease=t.easeCubicInOut,this.staggerDraw=!1,this.transition={},this._group=a.append("g"),this._group.attr("class","dimple-chart"),this._gridlines_group=this._group.insert("g"),this._gridlines_group.attr("class","dimple-gridlines-group"),this._axis_group=this._group.insert("g"),this._axis_group.attr("class","dimple-axis-group"),this._tooltipGroup=null,this._assignedColors={},this._assignedClasses={},this._nextColor=0,this._nextClass=0,this._axisIndex=function(t,e){var a=0,i=0,n=-1;for(a=0;a<this.axes.length;a+=1){if(this.axes[a]===t){n=i;break}null!=e&&e[0]!==this.axes[a].position[0]||(i+=1)}return n},this._getAllData=function(){var t=[];return null!==this.data&&void 0!==this.data&&this.data.length>0&&(t=t.concat(this.data)),null!==this.series&&void 0!==this.series&&this.series.length>0&&this.series.forEach((function(e){null!==e.data&&void 0!==e.data&&e.data.length>0&&(t=t.concat(e.data))})),t},this._getData=function(a,i,n,r,o,s,l,u,c,h){var d,p,g=[],f=function(t,e){var a=[];return null!==t&&(t._hasTimeField()?a.push(t._parseDate(e[t.timeField])):t._hasCategories()&&t.categoryFields.forEach((function(t){a.push(e[t])}),this)),a},m={x:!1,y:!1,z:!1,p:!1,c:!1},x={x:[],y:[]},y={x:[],y:[],z:[],p:[]},v={min:null,max:null},b={x:[],y:[],z:[],p:[]},_=[],w={},S={x:0,y:0,z:0,p:0},k="",T=[],P=[],C=[],F="",A=[],L="",M=[],D="",B=[],I=[],V=a,O=[];for(p in this.storyboard&&this.storyboard.categoryFields.length>0&&(k=this.storyboard.categoryFields[0],T=e._getOrderedList(V,k,this.storyboard._orderRules)),s&&s._hasCategories()&&s._hasMeasure()&&(F=s.categoryFields[0],A=e._getOrderedList(V,F,s._orderRules.concat([{ordering:s.measure,desc:!0}]))),l&&l._hasCategories()&&l._hasMeasure()&&(L=l.categoryFields[0],M=e._getOrderedList(V,L,l._orderRules.concat([{ordering:l.measure,desc:!0}]))),c&&c._hasCategories()&&c._hasMeasure()&&(D=c.categoryFields[0],B=e._getOrderedList(V,D,c._orderRules.concat([{ordering:c.measure,desc:!0}]))),V.length>0&&i&&i.length>0&&(I=[].concat(r),P=[],i.forEach((function(t){void 0!==V[0][t]&&P.push(t)}),this),c&&c._hasMeasure()?I.push({ordering:c.measure,desc:!0}):h&&h._hasMeasure()?I.push({ordering:h.measure,desc:!0}):u&&u._hasMeasure()?I.push({ordering:u.measure,desc:!0}):s&&s._hasMeasure()?I.push({ordering:s.measure,desc:!0}):l&&l._hasMeasure()&&I.push({ordering:l.measure,desc:!0}),C=e._getOrderedList(V,P,I)),V.sort((function(t,e){var a,i,n,r,o,s,l=0;if(""!==k&&(l=T.indexOf(t[k])-T.indexOf(e[k])),""!==F&&0===l&&(l=A.indexOf(t[F])-A.indexOf(e[F])),""!==L&&0===l&&(l=M.indexOf(t[L])-M.indexOf(e[L])),""!==D&&0===l&&(l=B.indexOf(t[D])-M.indexOf(e[D])),P&&P.length>0&&0===l)for(a=[].concat(P),l=0,n=0;n<C.length;n+=1){for(i=[].concat(C[n]),o=!0,s=!0,r=0;r<a.length;r+=1)o=o&&t[a[r]]===i[r],s=s&&e[a[r]]===i[r];if(o||s){l=o&&s?0:o?-1:1;break}}return l})),V.forEach((function(t){var e,a,r,o,d,p=-1,x=f(s,t),y=f(l,t),v=f(u,t),b=f(c,t),_=[];if(i&&0!==i.length)for(r=0;r<i.length;r+=1)void 0===t[i[r]]?_.push(i[r]):_.push(t[i[r]]);else _=["All"];for(e=_.join("/")+"_"+x.join("/")+"_"+y.join("/")+"_"+b.join("/")+"_"+v.join("/"),a=0;a<g.length;a+=1)if(g[a].key===e){p=a;break}-1===p&&(o={key:e,aggField:_,xField:x,xValue:null,xCount:0,yField:y,yValue:null,yCount:0,pField:b,pValue:null,pCount:0,zField:v,zValue:null,zCount:0,cValue:0,cCount:0,x:0,y:0,xOffset:0,yOffset:0,width:0,height:0,cx:0,cy:0,xBound:0,yBound:0,xValueList:[],yValueList:[],zValueList:[],pValueList:[],cValueList:[],fill:{},stroke:{}},g.push(o),p=g.length-1),(d=function(e,a){var i,r,o=!0,s={value:0,count:1},l={value:0,count:1},u="";null!==a&&(i=a.getFrameValue(),a.categoryFields.forEach((function(e,a){a>0&&(u+="/"),u+=t[e],o=u===i}),this)),null!=e&&o&&(r=g[p],e._hasMeasure()&&null!==t[e.measure]&&void 0!==t[e.measure]&&(-1===r[e.position+"ValueList"].indexOf(t[e.measure])&&r[e.position+"ValueList"].push(t[e.measure]),isNaN(parseFloat(t[e.measure]))&&(m[e.position]=!0),s.value=r[e.position+"Value"],s.count=r[e.position+"Count"],l.value=t[e.measure],r[e.position+"Value"]=n(s,l),r[e.position+"Count"]+=1))})(s,this.storyboard),d(l,this.storyboard),d(u,this.storyboard),d(c,this.storyboard),d(h,this.storyboard)}),this),s&&s._hasCategories()&&s.categoryFields.length>1&&void 0!==x.x&&(O=[],l._hasMeasure()&&O.push({ordering:l.measure,desc:!0}),x.x=e._getOrderedList(V,s.categoryFields[1],s._groupOrderRules.concat(O))),l&&l._hasCategories()&&l.categoryFields.length>1&&void 0!==x.y&&(O=[],s._hasMeasure()&&O.push({ordering:s.measure,desc:!0}),x.y=e._getOrderedList(V,l.categoryFields[1],l._groupOrderRules.concat(O)),x.y.reverse()),g.forEach((function(t){null!==s&&(!0===m.x&&(t.xValue=t.xValueList.length),d=s._hasMeasure()&&s._hasCategories()?(y.x[t.xField.join("/")]||0)+(s._hasMeasure()?Math.abs(t.xValue):0):(y.x[t.xField.join("/")]||0)+(l._hasMeasure()?Math.abs(t.yValue):0),y.x[t.xField.join("/")]=d),null!==l&&(!0===m.y&&(t.yValue=t.yValueList.length),d=l._hasMeasure()&&l._hasCategories()?(y.y[t.yField.join("/")]||0)+(l._hasMeasure()?Math.abs(t.yValue):0):(y.y[t.yField.join("/")]||0)+(s._hasMeasure()?Math.abs(t.xValue):0),y.y[t.yField.join("/")]=d),null!==c&&(!0===m.p&&(t.pValue=t.pValueList.length),d=(y.p[t.pField.join("/")]||0)+(c._hasMeasure()?Math.abs(t.pValue):0),y.p[t.pField.join("/")]=d),null!==u&&(!0===m.z&&(t.zValue=t.zValueList.length),d=(y.z[t.zField.join("/")]||0)+(u._hasMeasure()?Math.abs(t.zValue):0),y.z[t.zField.join("/")]=d),null!==h&&((null===v.min||t.cValue<v.min)&&(v.min=t.cValue),(null===v.max||t.cValue>v.max)&&(v.max=t.cValue))}),this),y.x)y.x.hasOwnProperty(p)&&(S.x+=y.x[p]);for(p in y.y)y.y.hasOwnProperty(p)&&(S.y+=y.y[p]);for(p in y.p)y.p.hasOwnProperty(p)&&(S.p+=y.p[p]);for(p in y.z)y.z.hasOwnProperty(p)&&(S.z+=y.z[p]);return g.forEach((function(e){var a,i,n,r,d=function(t,a,i){var n,r,s,l,u;null!=t&&(l=t.position,t._hasCategories()?t._hasMeasure()?(n=e[t.position+"Field"].join("/"),r=t.showPercent?y[t.position][n]/S[t.position]:y[t.position][n],-1===_.indexOf(n)&&(w[n]=r+(_.length>0?w[_[_.length-1]]:0),_.push(n)),s=e[l+"Bound"]=e["c"+l]="x"!==l&&"y"!==l||!o?r:w[n],e[i]=r,e[l]=s-("x"===l&&r>=0||"y"===l&&r<=0?r:0)):(e[l]=e["c"+l]=e[l+"Field"][0],e[i]=1,void 0!==x[l]&&null!==x[l]&&x[l].length>=2&&(e[l+"Offset"]=x[l].indexOf(e[l+"Field"][1]),e[i]=1/x[l].length)):(r=t.showPercent?e[l+"Value"]/y[a][e[a+"Field"].join("/")]:e[l+"Value"],n=e[a+"Field"].join("/")+(e[l+"Value"]>=0),u=b[l][n]=(null===b[l][n]||void 0===b[l][n]||"z"===l||"p"===l?0:b[l][n])+r,s=e[l+"Bound"]=e["c"+l]="x"!==l&&"y"!==l||!o?r:u,e[i]=r,e[l]=s-("x"===l&&r>=0||"y"===l&&r<=0?r:0)))};d(s,"y","width"),d(l,"x","height"),d(u,"z","r"),d(c,"p","angle"),null!==h&&null!==v.min&&null!==v.max&&(v.min===v.max&&(v.min-=.5,v.max+=.5),v.min=h.overrideMin||v.min,v.max=h.overrideMax||v.max,e.cValue=e.cValue>v.max?v.max:e.cValue<v.min?v.min:e.cValue,r=(n=t.scaleLinear().range([0,null===h.colors||1===h.colors.length?1:h.colors.length-1]).domain([v.min,v.max])(e.cValue))-Math.floor(n),e.cValue===v.max&&(r=1),h.colors&&1===h.colors.length?(a=t.rgb(h.colors[0]),i=t.rgb(this.getColor(e.aggField.slice(-1)[0]).fill)):h.colors&&h.colors.length>1?(a=t.rgb(h.colors[Math.floor(n)]),i=t.rgb(h.colors[Math.ceil(n)])):(a=t.rgb("white"),i=t.rgb(this.getColor(e.aggField.slice(-1)[0]).fill)),a.r=Math.floor(a.r+(i.r-a.r)*r),a.g=Math.floor(a.g+(i.g-a.g)*r),a.b=Math.floor(a.b+(i.b-a.b)*r),e.fill=a.toString(),e.stroke=a.darker(.5).toString())}),this),g},this._getDelay=function(t,a,i){return function(n){var r=0;return i&&a.staggerDraw&&(i.x._hasCategories()?r=e._helpers.cx(n,a,i)/a._widthPixels()*t:i.y._hasCategories()&&(r=(1-e._helpers.cy(n,a,i)/a._heightPixels())*t)),r}},this._getSeriesData=function(){null!==this.series&&void 0!==this.series&&this.series.forEach((function(t){var e,a,i,n,r,o=t.data||this.data||[],s=[].concat(t.categoryFields||"All"),l=this._getData(o,s,t.aggregate,t._orderRules,t._isStacked(),t.x,t.y,t.z,t.p,t.c),u=[],c={},h=t.startAngle*(Math.PI/180)||0,d=(t.endAngle||360)*(Math.PI/180);if(h>d&&(h-=2*Math.PI),t.p&&s.length>0){if(t.x&&t.y){for(s.pop(),u=this._getData(o,["__dimple_placeholder__"].concat(s),t.aggregate,t._orderRules,t._isStacked(),t.x,t.y,t.z,t.p,t.c),e=0;e<l.length;e+=1)for((i=["__dimple_placeholder__"].concat(l[e].aggField)).pop(),t.x&&t.x._hasCategories()&&(i=i.concat(l[e].xField)),t.y&&t.y._hasCategories()&&(i=i.concat(l[e].yField)),n=i.join("|"),a=0;a<u.length;a+=1)if(r=[].concat(u[a].aggField),t.x&&t.x._hasCategories()&&(r=r.concat(u[a].xField)),t.y&&t.y._hasCategories()&&(r=r.concat(u[a].yField)),n===r.join("|")){l[e].xField=u[a].xField,l[e].xValue=u[a].xValue,l[e].xCount=u[a].xCount,l[e].yField=u[a].yField,l[e].yValue=u[a].yValue,l[e].yCount=u[a].yCount,l[e].zField=u[a].zField,l[e].zValue=u[a].zValue,l[e].zCount=u[a].zCount,l[e].x=u[a].x,l[e].y=u[a].y,l[e].r=u[a].r,l[e].xOffset=u[a].xOffset,l[e].yOffset=u[a].yOffset,l[e].width=u[a].width,l[e].height=u[a].height,l[e].cx=u[a].cx,l[e].cy=u[a].cy,l[e].xBound=u[a].xBound,l[e].yBound=u[a].yBound,l[e].xValueList=u[a].xValueList,l[e].yValueList=u[a].yValueList,l[e].zValueList=u[a].zValueList,l[e].cValueList=u[a].cValueList,l[e].pieKey=u[a].key,l[e].value=l.pValue,c[u[a].key]||(c[u[a].key]={total:0,angle:h}),c[u[a].key].total+=l[e].pValue;break}}else for(e=0;e<l.length;e+=1)l[e].pieKey="All",l[e].value=l.pValue,c[l[e].pieKey]||(c[l[e].pieKey]={total:0,angle:h}),c[l[e].pieKey].total+=l[e].pValue;for(e=0;e<l.length;e+=1)0===c[l[e].pieKey].total?l[e].piePct=0:l[e].piePct=l[e].pValue/c[l[e].pieKey].total,l[e].startAngle=c[l[e].pieKey].angle,l[e].endAngle=l[e].startAngle+l[e].piePct*(d-h),c[l[e].pieKey].angle=l[e].endAngle}t._positionData=l}),this)},this._handleTransition=function(t,a,i,n){var r=null;return 0===a?r=t:(r=t.transition().duration(a).delay(i._getDelay(a,i,n)),e._ease(r,i.ease)),r},this._heightPixels=function(){return e._parseYPosition(this.height,this.svg.node())},this._registerEventHandlers=function(a){null!==a._eventHandlers&&a._eventHandlers.length>0&&a._eventHandlers.forEach((function(i){var n,r=function(n){var r=new e.eventArgs;null!==a.chart.storyboard&&(r.frameValue=a.chart.storyboard.getFrameValue()),r.seriesValue=n.aggField,r.xValue=n.x,r.yValue=n.y,r.zValue=n.z,r.pValue=n.p,r.colorValue=n.cValue,r.seriesShapes=a.shapes,r.selectedShape=t.select(this),i.handler(r)};if(null!==i.handler&&"function"==typeof i.handler)if(null!==a._markers&&void 0!==a._markers)for(n in a._markers)a._markers.hasOwnProperty(n)&&a._markers[n].on(i.event,r);else a.shapes.on(i.event,r)}),this)},this._widthPixels=function(){return e._parseXPosition(this.width,this.svg.node())},this._xPixels=function(){return e._parseXPosition(this.x,this.svg.node())},this._yPixels=function(){return e._parseYPosition(this.y,this.svg.node())},this.addAxis=function(t,a,i,n){var r,o=null,s=null;if(null!=a&&(a=[].concat(a)),"string"==typeof t||t instanceof String)o=new e.axis(this,t,a,i,n),this.axes.push(o);else{if(s=t,(o=new e.axis(this,s.position,a,i,n))._hasMeasure()!==s._hasMeasure()?r="You have specified a composite axis where some but not all axes have a measure - this is not supported, all axes must be of the same type.":o._hasTimeField()!==s._hasTimeField()?r="You have specified a composite axis where some but not all axes have a time field - this is not supported, all axes must be of the same type.":(null===o.categoryFields||void 0===o.categoryFields?0:o.categoryFields.length)!==(null===s.categoryFields||void 0===s.categoryFields?0:s.categoryFields.length)&&(r="You have specified a composite axis where axes have differing numbers of category fields - this is not supported, all axes must be of the same type."),r)throw r;s._slaves.push(o)}return o},this.addCategoryAxis=function(t,e){return this.addAxis(t,e,null)},this.addColorAxis=function(t,e){var a=this.addAxis("c",null,t);return a.colors=null==e?null:[].concat(e),a},this.addLegend=function(t,a,i,n,r,o){o=null==o?this.series:[].concat(o),r=null==r?"left":r;var s=new e.legend(this,t,a,i,n,r,o);return this.legends.push(s),s},this.addLogAxis=function(t,e,a){var i=this.addAxis(t,null,e,null);return null!=a&&(i.logBase=a),i.useLog=!0,i},this.addMeasureAxis=function(t,e){return this.addAxis(t,null,e)},this.addPctAxis=function(t,e,a){var i=null;return(i=null!=a?this.addAxis(t,a,e):this.addMeasureAxis(t,e)).showPercent=!0,i},this.addSeries=function(t,a,i){null!=i||(i=this.axes),null!=a||(a=e.plot.bubble);var n,r=null,o=null,s=null,l=null,u=null;return i.forEach((function(t){null!==t&&a.supportedAxes.indexOf(t.position)>-1&&(null===r&&"x"===t.position[0]?r=t:null===o&&"y"===t.position[0]?o=t:null===s&&"z"===t.position[0]?s=t:null===l&&"c"===t.position[0]?l=t:null===l&&"p"===t.position[0]&&(u=t))}),this),t&&(t=[].concat(t)),n=new e.series(this,t,r,o,s,l,u,a,e.aggregateMethod.sum,a.stacked),this.series.push(n),n},this.addTimeAxis=function(t,e,a,i){var n=this.addAxis(t,null,null,e);return n.tickFormat=i,n.dateParseFormat=a,n},this.assignClass=function(t,e){return this._assignedClasses[t]=e,this._assignedClasses[t]},this.assignColor=function(t,a,i,n){return this._assignedColors[t]=new e.color(a,i,n),this._assignedColors[t]},this.customClassList={axisLine:"dimple-custom-axis-line",axisLabel:"dimple-custom-axis-label",axisTitle:"dimple-custom-axis-title",tooltipBox:"dimple-custom-tooltip-box",tooltipLabel:"dimple-custom-tooltip-label",tooltipDropLine:"dimple-custom-tooltip-dropline",lineMarker:"dimple-custom-line-marker",lineMarkerCircle:"dimple-custom-line-marker-circle",legendLabel:"dimple-custom-legend-label",legendKey:"dimple-custom-legend-key",areaSeries:"dimple-custom-series-area",barSeries:"dimple-custom-series-bar",bubbleSeries:"dimple-custom-series-bubble",lineSeries:"dimple-custom-series-line",pieSeries:"dimple-custom-series-pie",gridline:"dimple-custom-gridline",colorClasses:["dimple-custom-format-1","dimple-custom-format-2","dimple-custom-format-3","dimple-custom-format-4","dimple-custom-format-5","dimple-custom-format-6","dimple-custom-format-7","dimple-custom-format-8","dimple-custom-format-9","dimple-custom-format-10"]},this.defaultColors=[new e.color("#80B1D3"),new e.color("#FB8072"),new e.color("#FDB462"),new e.color("#B3DE69"),new e.color("#FFED6F"),new e.color("#BC80BD"),new e.color("#8DD3C7"),new e.color("#CCEBC5"),new e.color("#FFFFB3"),new e.color("#BEBADA"),new e.color("#FCCDE5"),new e.color("#D9D9D9")],this.draw=function(e,a){e=e||0;var i,n,r=null,o=null,s=!1,l=!1,u=this._xPixels(),c=this._yPixels(),h=this._widthPixels(),d=this._heightPixels();return null!=a&&!1!==a||this._getSeriesData(),this.axes.forEach((function(t){t._scale=null}),this),this.axes.forEach((function(t){if(t._min=0,t._max=0,n=[],t._hasMeasure()){var e=!1;this.series.forEach((function(a){if(a._deepMatch(t)){var i=a._axisBounds(t.position);t._min>i.min&&(t._min=i.min),t._max<i.max&&(t._max=i.max),e=!0}}),this),e||this._getAllData().forEach((function(e){t._min>e[t.measure]&&(t._min=e[t.measure]),t._max<e[t.measure]&&(t._max=e[t.measure])}),this)}else t._hasTimeField()?(t._min=null,t._max=null,this.series.forEach((function(e){e._deepMatch(t)&&null!==e[t.position].timeField&&void 0!==e[t.position].timeField&&-1===n.indexOf(e[t.position].timeField)&&n.push(e[t.position].timeField)}),this),t._getAxisData().forEach((function(e){n.forEach((function(a){var i=t._parseDate(e[a]);(null===t._min||i<t._min)&&(t._min=i),(null===t._max||i>t._max)&&(t._max=i)}),this)}),this)):t._hasCategories()&&(t._min=0,i=[],this.series.forEach((function(e){e._deepMatch(t)&&null!==e[t.position].categoryFields[0]&&void 0!==e[t.position].categoryFields[0]&&-1===n.indexOf(e[t.position].categoryFields[0])&&n.push(e[t.position].categoryFields[0])}),this),t._getAxisData().forEach((function(t){n.forEach((function(e){-1===i.indexOf(t[e])&&i.push(t[e])}),this)}),this),t._max=i.length);null!==t._slaves&&void 0!==t._slaves&&t._slaves.length>0&&t._slaves.forEach((function(e){e._min=t._min,e._max=t._max}),this),t._update(),null===r&&"x"===t.position?r=t:null===o&&"y"===t.position&&(o=t)}),this),this.axes.forEach((function(a){var i=!1,n=null,p=0,g=null,f=!1,m=0,x={l:null,t:null,r:null,b:null},y=0,v=0,b="",_=this,w=function(t){return null===n||0===e||i?t:_._handleTransition(t,e,_)},S=function(){var e=t.select(this).selectAll("text");return!a.measure&&a._max>0&&("x"===a.position?e.attr("x",h/a._max/2):"y"===a.position&&e.attr("y",d/a._max*-1/2)),a.categoryFields&&a.categoryFields.length>0&&(a!==r||null!==o.categoryFields&&0!==o.categoryFields.length||e.attr("y",c+d-o._scale(0)+9),a!==o||null!==r.categoryFields&&0!==r.categoryFields.length||e.attr("x",-1*(r._scale(0)-u)-9)),this},k=function(e){return function(){var a=t.select(this).attr("class")||"";return-1===a.indexOf(e)&&(a+=" "+e),a.trim()}};null===a.gridlineShapes?(a.showGridlines||null===a.showGridlines&&!a._hasCategories()&&(!s&&"x"===a.position||!l&&"y"===a.position))&&(a.gridlineShapes=this._gridlines_group.append("g").attr("class","dimple-gridline"),"x"===a.position?s=!0:l=!0):"x"===a.position?s=!0:l=!0,null===a.shapes&&(a.shapes=this._axis_group.append("g").attr("class","dimple-axis dimple-axis-"+a.position).each((function(){_.noFormats||t.select(this).style("font-family",a.fontFamily).style("font-size",a._getFontSize())})),i=!0),a===r&&null!==o?(n="translate(0, "+(null===o.categoryFields||0===o.categoryFields.length?o._scale(0):c+d)+")",g="translate(0, "+(a===r?c+d:c)+")",p=-d):a===o&&null!==r?(n="translate("+(null===r.categoryFields||0===r.categoryFields.length?r._scale(0):u)+", 0)",g="translate("+(a===o?u:u+h)+", 0)",p=-h):"x"===a.position?(g=n="translate(0, "+(a===r?c+d:c)+")",p=-d):"y"===a.position&&(g=n="translate("+(a===o?u:u+h)+", 0)",p=-h),null!==n&&null!==a._draw&&(a._hasTimeField()?w(a.shapes).call(a._draw.ticks(a._getTimePeriod(),a.timeInterval).tickFormat(a._getFormat())).attr("transform",n).each(S):a.useLog?w(a.shapes).call(a._draw.ticks(4,a._getFormat())).attr("transform",n).each(S):w(a.shapes).call(a._draw.tickFormat(a._getFormat())).attr("transform",n).each(S),null!==a.gridlineShapes&&w(a.gridlineShapes).call(a._draw.tickSize(p,0,0).tickFormat("")).attr("transform",g)),w(a.shapes.selectAll("text")).attr("class",k(_.customClassList.axisLabel)).call((function(t){_.noFormats||t.style("font-family",a.fontFamily).style("font-size",a._getFontSize())})),w(a.shapes.selectAll("path, line")).attr("class",k(_.customClassList.axisLine)).call((function(t){_.noFormats||t.style("fill","none").style("stroke","black").style("shape-rendering","crispEdges")})),null!==a.gridlineShapes&&(a.gridlineShapes.selectAll("path").remove(),w(a.gridlineShapes.selectAll("line")).attr("class",k(_.customClassList.gridline)).call((function(t){_.noFormats||t.style("fill","none").style("stroke","lightgray").style("opacity",.8)}))),null!==a.measure&&void 0!==a.measure||(a.autoRotateLabel?a===r?(m=0,a.shapes.selectAll("text").each((function(){var t=a.maxTextWidth||this.getComputedTextLength();m=t>m?t:m})),m>a._scale.step()?(f=!0,a.shapes.selectAll("text").style("text-anchor","start").each((function(){var e=this.getBBox();t.select(this).attr("transform","rotate(90,"+e.x+","+(e.y+e.height/2)+") translate(-5, 0)")}))):(f=!1,a.shapes.selectAll("text").style("text-anchor","middle").attr("transform",""))):"x"===a.position&&(m=0,a.shapes.selectAll("text").each((function(){var t=this.getComputedTextLength();m=t>m?t:m})),m>h/a.shapes.selectAll("text").nodes().length?(f=!0,a.shapes.selectAll("text").style("text-anchor","end").each((function(){var e=this.getBBox();t.select(this).attr("transform","rotate(90,"+(e.x+e.width)+","+(e.y+e.height/2)+") translate(5, 0)")}))):(f=!1,a.shapes.selectAll("text").style("text-anchor","middle").attr("transform",""))):(f=!1,a.shapes.selectAll("text").style("text-anchor","middle").attr("transform",""))),null!==a.titleShape&&void 0!==a.titleShape&&a.titleShape.remove(),a.shapes.selectAll("text").each((function(){var t=this.getBBox();(null===x.l||-9-t.width<x.l)&&(x.l=-9-t.width),(null===x.r||t.x+t.width>x.r)&&(x.r=t.x+t.width),f?((null===x.t||t.y+t.height-t.width<x.t)&&(x.t=t.y+t.height-t.width),(null===x.b||t.height+t.width>x.b)&&(x.b=(a.maxTextWidth?20:t.height)+t.width)):((null===x.t||t.y<x.t)&&(x.t=t.y),(null===x.b||9+t.height>x.b)&&(x.b=9+t.height))})),"x"===a.position?(v=a===r?c+d+x.b+5:c+x.t-10,y=u+h/2):"y"===a.position&&(b="rotate(270, "+(y=a===o?u+x.l-10:u+h+x.r+20)+", "+(v=c+d/2)+")"),a.hidden||"x"!==a.position&&"y"!==a.position||null===a.title||(a.titleShape=this._axis_group.append("text").attr("class","dimple-axis dimple-title "+_.customClassList.axisTitle+" dimple-axis-"+a.position),a.titleShape.attr("x",y).attr("y",v).attr("text-anchor","middle").attr("transform",b).text(void 0!==a.title?a.title:null===a.categoryFields||void 0===a.categoryFields||0===a.categoryFields.length?a.measure:a.categoryFields.join("/")).each((function(){_.noFormats||t.select(this).style("font-family",a.fontFamily).style("font-size",a._getFontSize())})),a===r?a.titleShape.each((function(){t.select(this).attr("y",v+this.getBBox().height/1.65)})):a===o&&a.titleShape.each((function(){t.select(this).attr("x",y+this.getBBox().height/1.65)})))}),this),this.series.forEach((function(t){t.plot.draw(this,t,e),this._registerEventHandlers(t)}),this),this.legends.forEach((function(t){t._draw()}),this),this.storyboard&&(this.storyboard._drawText(),this.storyboard.autoplay&&this.storyboard.startAnimation()),this},this.getClass=function(t){return this._assignedClasses[t]||(this._assignedClasses[t]=this.customClassList.colorClasses[this._nextClass],this._nextClass=(this._nextClass+1)%this.customClassList.colorClasses.length),this._assignedClasses[t]},this.getColor=function(t){return null!==this._assignedColors[t]&&void 0!==this._assignedColors[t]||(this._assignedColors[t]=this.defaultColors[this._nextColor],this._nextColor=(this._nextColor+1)%this.defaultColors.length),this._assignedColors[t]},this.setBounds=function(t,a,i,n){return this.x=t,this.y=a,this.width=i,this.height=n,this._xPixels=function(){return e._parseXPosition(this.x,this.svg.node())},this.draw(0,!0),this._yPixels=function(){return e._parseYPosition(this.y,this.svg.node())},this._widthPixels=function(){return e._parseXPosition(this.width,this.svg.node())},this._heightPixels=function(){return e._parseYPosition(this.height,this.svg.node())},this},this.setMargins=function(t,a,i,n){return this.x=t,this.y=a,this.width=0,this.height=0,this._xPixels=function(){return e._parseXPosition(this.x,this.svg.node())},this._yPixels=function(){return e._parseYPosition(this.y,this.svg.node())},this._widthPixels=function(){return e._parentWidth(this.svg.node())-this._xPixels()-e._parseXPosition(i,this.svg.node())},this._heightPixels=function(){return e._parentHeight(this.svg.node())-this._yPixels()-e._parseYPosition(n,this.svg.node())},this},this.setStoryboard=function(t,a){return this.storyboard=new e.storyboard(this,t),null!=a&&(this.storyboard.onTick=a),this.storyboard}},color:function(e,a,i){this.fill=e,this.stroke=null==a?t.rgb(e).darker(.5).toString():a,this.opacity=null==i?.8:i},eventArgs:function(){this.seriesValue=null,this.xValue=null,this.yValue=null,this.zValue=null,this.pValue=null,this.colorValue=null,this.frameValue=null,this.seriesShapes=null,this.selectedShape=null},legend:function(a,i,n,r,o,s,l){this.chart=a,this.series=l,this.x=i,this.y=n,this.width=r,this.height=o,this.horizontalAlign=s,this.shapes=null,this.fontSize="10px",this.fontFamily="sans-serif",this._draw=function(){var a,i=this._getEntries(),n=0,r=0,o=0,s=0,l=this;this.shapes&&this.shapes.remove(),(a=this.chart._group.selectAll(".dimple-dont-select-any").data(i).enter().append("g").attr("class",(function(t){return"dimple-legend "+e._createClass(t.aggField)})).attr("opacity",1)).append("text").attr("class",(function(t){return"dimple-legend dimple-legend-text "+e._createClass(t.aggField)+" "+l.chart.customClassList.legendLabel})).text((function(t){return t.key})).call((function(t){l.chart.noFormats||t.style("font-family",l.fontFamily).style("font-size",l._getFontSize()).style("shape-rendering","crispEdges")})).each((function(){var t=this.getBBox();t.width>n&&(n=t.width),t.height>r&&(r=t.height)})),a.append("rect").attr("class",(function(t){return"dimple-legend dimple-legend-key "+e._createClass(t.aggField)})).attr("height",9).attr("width",15),r=(r<9?9:r)+l._getVerticalPadding(),n+=15+l._getHorizontalPadding(),a.each((function(a){o+n>l._widthPixels()&&(o=0,s+=r),s>l._heightPixels()?t.select(this).remove():(t.select(this).select("text").attr("x","left"===l.horizontalAlign?l._xPixels()+15+5+o:l._xPixels()+(l._widthPixels()-o-n)+15+5).attr("y",(function(){return l._yPixels()+s+this.getBBox().height/1.65})).attr("width",l._widthPixels()).attr("height",l._heightPixels()),t.select(this).select("rect").attr("class",(function(t){return"dimple-legend dimple-legend-key "+e._createClass(t.aggField)+" "+l.chart.customClassList.legendKey+" "+t.css})).attr("x","left"===l.horizontalAlign?l._xPixels()+o:l._xPixels()+(l._widthPixels()-o-n)).attr("y",l._yPixels()+s).attr("height",9).attr("width",15).call((function(t){l.chart.noFormats||t.style("fill",a.fill).style("stroke",a.stroke).style("opacity",a.opacity).style("shape-rendering","crispEdges")})),o+=n)})),this.shapes=a},this._getEntries=function(){var t=[];return this.series&&this.series.forEach((function(e){e._positionData.forEach((function(a){var i,n=-1,r=e.plot.grouped&&!e.x._hasCategories()&&!e.y._hasCategories()&&a.aggField.length<2?"All":a.aggField.slice(-1)[0];for(i=0;i<t.length;i+=1)if(t[i].key===r){n=i;break}-1===n&&e.chart._assignedColors[r]&&(t.push({key:r,fill:e.chart._assignedColors[r].fill,stroke:e.chart._assignedColors[r].stroke,opacity:e.chart._assignedColors[r].opacity,css:e.chart._assignedClasses[r],series:e,aggField:a.aggField}),n=t.length-1)}))}),this),t},this._getFontSize=function(){return this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._getHorizontalPadding=function(){return isNaN(this.horizontalPadding)?20:this.horizontalPadding},this._getVerticalPadding=function(){return isNaN(this.verticalPadding)?2:this.verticalPadding},this._heightPixels=function(){return e._parseYPosition(this.height,this.chart.svg.node())},this._widthPixels=function(){return e._parseXPosition(this.width,this.chart.svg.node())},this._xPixels=function(){return e._parseXPosition(this.x,this.chart.svg.node())},this._yPixels=function(){return e._parseYPosition(this.y,this.chart.svg.node())}},series:function(t,e,a,i,n,r,o,s,l,u){this.chart=t,this.x=a,this.y=i,this.z=n,this.c=r,this.p=o,this.plot=s,this.categoryFields=e,this.aggregate=l,this.stacked=u,this.barGap=.2,this.clusterBarGap=.1,this.lineWeight=2,this.lineMarkers=!1,this.afterDraw=null,this.interpolation="linear",this.tooltipFontSize="10px",this.tooltipFontFamily="sans-serif",this.radius="auto",this._group=t._group.append("g"),this._group.attr("class","dimple-series-group-"+t.series.length),this._eventHandlers=[],this._positionData=[],this._orderRules=[],this._axisBounds=function(t){var e,a,i,n={min:0,max:0},r=null,o=null,s=[],l=0,u=this._positionData;return"x"===t?(r=this.x,o=this.y):"y"===t?(r=this.y,o=this.x):"z"===t?r=this.z:"p"===t?r=this.p:"c"===t&&(r=this.c),r.showPercent?u.forEach((function(t){t[r.position+"Bound"]<n.min&&(n.min=t[r.position+"Bound"]),t[r.position+"Bound"]>n.max&&(n.max=t[r.position+"Bound"])}),this):null===o||null===o.categoryFields||0===o.categoryFields.length?u.forEach((function(t){!this._isStacked()||"x"!==r.position&&"y"!==r.position?(t[r.position+"Value"]<n.min&&(n.min=t[r.position+"Value"]),t[r.position+"Value"]>n.max&&(n.max=t[r.position+"Value"])):t[r.position+"Value"]<0?n.min=n.min+t[r.position+"Value"]:n.max=n.max+t[r.position+"Value"]}),this):(e=r.position+"Value",a=o.position+"Field",i=[],u.forEach((function(t){var n=t[a].join("/"),r=i.indexOf(n);-1===r&&(i.push(n),r=i.length-1),void 0===s[r]&&(s[r]={min:0,max:0},r>=l&&(l=r+1)),this.stacked?t[e]<0?s[r].min=s[r].min+t[e]:s[r].max=s[r].max+t[e]:(t[e]<s[r].min&&(s[r].min=t[e]),t[e]>s[r].max&&(s[r].max=t[e]))}),this),s.forEach((function(t){void 0!==t&&(t.min<n.min&&(n.min=t.min),t.max>n.max&&(n.max=t.max))}),this)),n},this._deepMatch=function(t){var e=!1;return this[t.position]===t?e=!0:void 0!==t._slaves&&null!==t._slaves&&t._slaves.length>0&&t._slaves.forEach((function(t){e=e||this._deepMatch(t)}),this),e},this._dropLineOrigin=function(){var t=0,e=0,a={x:null,y:null},i={x:null,y:null};return this.chart.axes.forEach((function(t){"x"===t.position&&null===i.x?t._hasTimeField()?i.x=this.chart._xPixels():i.x=t._origin:"y"===t.position&&null===i.y&&(t._hasTimeField()?i.y=this.chart._yPixels()+this.chart._heightPixels():i.y=t._origin)}),this),this.chart.axes.forEach((function(n){"x"!==n.position||this.x.hidden?"y"!==n.position||this.y.hidden||(this._deepMatch(n)&&(0===e?a.x=i.x:1===e&&(a.x=this.chart._xPixels()+this.chart._widthPixels())),e+=1):(this._deepMatch(n)&&(0===t?a.y=i.y:1===t&&(a.y=this.chart._yPixels())),t+=1)}),this),a},this._getTooltipFontSize=function(){return this.tooltipFontSize&&"auto"!==this.tooltipFontSize.toString().toLowerCase()?isNaN(this.tooltipFontSize)?this.tooltipFontSize:this.tooltipFontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._isStacked=function(){return this.stacked&&(this.x._hasCategories()||this.y._hasCategories())},this.addEventHandler=function(t,e){this._eventHandlers.push({event:t,handler:e})},this.addOrderRule=function(t,e){this._orderRules.push({ordering:t,desc:e})},this.getTooltipText=function(t){var e=[];return null!==this.categoryFields&&void 0!==this.categoryFields&&this.categoryFields.length>0&&this.categoryFields.forEach((function(a,i){null!=a&&null!==t.aggField[i]&&void 0!==t.aggField[i]&&e.push(a+(t.aggField[i]!==a?": "+t.aggField[i]:""))}),this),this.p?(this.x&&this.x._hasCategories()&&this.x._getTooltipText(e,t),this.y&&this.y._hasCategories()&&this.y._getTooltipText(e,t),this.z&&this.z._hasCategories()&&this.z._getTooltipText(e,t),this.p._getTooltipText(e,t)):(this.x&&this.x._getTooltipText(e,t),this.y&&this.y._getTooltipText(e,t),this.z&&this.z._getTooltipText(e,t)),this.c&&this.c._getTooltipText(e,t),e.filter((function(t,a){return e.indexOf(t)===a}))}},storyboard:function(t,e){null!=e&&(e=[].concat(e)),this.chart=t,this.categoryFields=e,this.autoplay=!0,this.frameDuration=3e3,this.storyLabel=null,this.onTick=null,this.fontSize="10px",this.fontFamily="sans-serif",this._frame=0,this._animationTimer=null,this._categories=[],this._cachedCategoryFields=[],this._orderRules=[],this._drawText=function(){var e=this,a=0;e.storyLabel||(e.chart.axes.forEach((function(t){"x"===t.position&&(a+=1)}),e),e.storyLabel=e.chart._group.append("text").attr("class","dimple-storyboard-label").attr("opacity",1).attr("x",e.chart._xPixels()+.01*e.chart._widthPixels()).attr("y",e.chart._yPixels()+(e.chart._heightPixels()/35>10?e.chart._heightPixels()/35:10)*(a>1?1.25:-1)).call((function(a){t.noFormats||a.style("font-family",e.fontFamily).style("font-size",e._getFontSize())}))),e.storyLabel.text(e.categoryFields.join("\\")+": "+e.getFrameValue())},this._getCategories=function(){return this._categoryFields!==this._cachedCategoryFields&&(this._categories=[],this.chart._getAllData().forEach((function(t){var e="";null!==this.categoryFields&&(this.categoryFields.forEach((function(a,i){i>0&&(e+="/"),e+=t[a]}),this),-1===this._categories.indexOf(e)&&(this._categories.push(e),this._categories.length))}),this),this._cachedCategoryFields=this._categoryFields),this._categories},this._getFontSize=function(){return this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._goToFrameIndex=function(t){this._frame=t%this._getCategories().length,this.chart.draw(this.frameDuration/2)},this.addOrderRule=function(t,e){this._orderRules.push({ordering:t,desc:e})},this.getFrameValue=function(){var t=null;return this._frame>=0&&this._getCategories().length>this._frame&&(t=this._getCategories()[this._frame]),t},this.goToFrame=function(t){if(this._getCategories().length>0){var e=this._getCategories().indexOf(t);this._goToFrameIndex(e)}},this.pauseAnimation=function(){null!==this._animationTimer&&(window.clearInterval(this._animationTimer),this._animationTimer=null)},this.startAnimation=function(){null===this._animationTimer&&(null!==this.onTick&&this.onTick(this.getFrameValue()),this._animationTimer=window.setInterval(function(t){return function(){t._goToFrameIndex(t._frame+1),null!==t.onTick&&t.onTick(t.getFrameValue()),t._drawText(t.frameDuration/2)}}(this),this.frameDuration))},this.stopAnimation=function(){null!==this._animationTimer&&(window.clearInterval(this._animationTimer),this._animationTimer=null,this._frame=0)}}};return e.aggregateMethod.avg=function(t,e){return t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),t.count=null===t.count||void 0===t.count?1:parseFloat(t.count),e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),e.count=null===e.count||void 0===e.count?1:parseFloat(e.count),(t.value*t.count+e.value*e.count)/(t.count+e.count)},e.aggregateMethod.count=function(t,e){return t.count=null===t.count||void 0===t.count?0:parseFloat(t.count),e.count=null===e.count||void 0===e.count?0:parseFloat(e.count),t.count+e.count},e.aggregateMethod.max=function(t,e){return t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),t.value>e.value?t.value:e.value},e.aggregateMethod.min=function(t,e){return null===t.value?parseFloat(e.value):parseFloat(t.value)<parseFloat(e.value)?parseFloat(t.value):parseFloat(e.value)},e.aggregateMethod.sum=function(t,e){return t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),t.value+e.value},e.plot.area={stacked:!0,grouped:!0,supportedAxes:["x","y","c"],draw:function(a,i,n){var r,o,s,l,u,c,h,d,p,g,f,m,x,y,v,b,_,w,S,k,T,P,C,F,A=i._positionData,L=[],M=null,D="dimple-series-"+a.series.indexOf(i),B=i.x._hasCategories()||i.y._hasCategories()?0:1,I=!1,V={},O=[],E=[],N=function(){return function(a,i,n,r){t.select(i).style("opacity",1),e._showPointTooltip(a,i,n,r)}},z=function(a){return function(i,n,r,o){t.select(n).style("opacity",o.lineMarkers||a.data.length<2?e._helpers.opacity(i,r,o):0),e._removeTooltip(i,n,r,o)}},W=function(t,r){e._drawMarkers(t,a,i,n,D,I,N(),z(t),r)},G=function(t,n){var r;return"step"===i.interpolation&&i[t]._hasCategories()?(r=e._helpers[t](n,a,i)+("y"===t?e._helpers.height(n,a,i):0),i[t].categoryFields.length<2&&(r+=("y"===t?1:-1)*e._helpers[t+"Gap"](a,i))):r=e._helpers["c"+t](n,a,i),parseFloat(r)},H=function(a,n){var r=t.line().x((function(t){return i.x._hasCategories()||!n?t.x:i.x[n]})).y((function(t){return i.y._hasCategories()||!n?t.y:i.y[n]}));return e._interpolate(r,a),r},R=function(t,e){return parseFloat(t)-parseFloat(e)},$=function(t,e){return parseFloat(t.x)-parseFloat(e.x)},X=function(t,e,a){var i,n,r=e[e.length-1],o=9999,s=r;for(i=0;i<t.length;i+=1)t[i].x===r.x&&t[i].y===r.y||(n=180-Math.atan2(t[i].x-r.x,t[i].y-r.y)*(180/Math.PI))>a&&n<o&&(s=t[i],o=n);return e.push(s),o};for(r="step"===i.interpolation?"step-after":i.interpolation,f=e._getSeriesOrder(i.data||a.data,i),i.c&&(i.x._hasCategories()&&i.y._hasMeasure()||i.y._hasCategories()&&i.x._hasMeasure())&&(I=!0),i.x._hasCategories()?(C="x",F="y"):i.y._hasCategories()&&(C="y",F="x"),o=0;o<A.length;o+=1){for(u=[],h=-1,l=B;l<A[o].aggField.length;l+=1)u.push(A[o].aggField[l]);for(c=e._createClass(u),l=0;l<L.length;l+=1)if(L[l].keyString===c){h=l;break}-1===h&&(h=L.length,L.push({key:u,keyString:c,color:"white",data:[],points:[],area:{},entry:{},exit:{},group:C&&A[o][C+"Field"]&&A[o][C+"Field"].length>=2?A[o][C+"Field"][0]:"All"})),L[h].data.push(A[o])}for(f&&L.sort((function(t,a){return e._arrayIndexCompare(f,t.key,a.key)})),o=0;o<L.length;o+=1){for(L[o].data.sort(e._getSeriesSortPredicate(a,i,f)),s=0;s<L[o].data.length;s+=1)L[o].points.push({x:G("x",L[o].data[s]),y:G("y",L[o].data[s])}),C&&(V[L[o].group]||(V[L[o].group]={}),V[L[o].group][L[o].points[L[o].points.length-1][C]]=i[F]._origin);m=L[o].points,"step"===i.interpolation&&m.length>1&&C&&(i.x._hasCategories()?(m.push({x:2*m[m.length-1].x-m[m.length-2].x,y:m[m.length-1].y}),V[L[o].group][m[m.length-1][C]]=i[F]._origin):i.y._hasCategories()&&(m=[{x:m[0].x,y:2*m[0].y-m[1].y}].concat(m),V[L[o].group][m[0][C]]=i[F]._origin,L[o].points=m))}for(v in V)if(V.hasOwnProperty(v)){for(b in O[v]=[],V[v])V[v].hasOwnProperty(b)&&O[v].push(parseFloat(b));O[v].sort(R)}for(o=0;o<L.length;o+=1){if(m=L[o].points,_=L[o].group,x=[],E=[],I&&e._addGradient(L[o].key,"fill-area-gradient-"+L[o].keyString,i.x._hasCategories()?i.x:i.y,A,a,n,"fill"),O[_]&&O[_].length>0)for(s=0,l=0;s<O[_].length;s+=1)O[_][s]>=m[0][C]&&O[_][s]<=m[m.length-1][C]&&((y={})[C]=O[_][s],y[F]=V[_][O[_][s]],x.push(y),m[l][C]>O[_][s]?E.push(y):(E.push(m[l]),V[L[o].group][O[_][s]]=m[l][F],l+=1));else if(i._orderRules&&i._orderRules.length>0)E=m.concat(m[0]);else{m=m.sort($),E.push(m[0]),P=0;do{P=X(m,E,P)}while(E.length<=m.length&&(E[0].x!==E[E.length-1].x||E[0].y!==E[E.length-1].y))}x=x.reverse(),w=H(r,"_previousOrigin")(E),S=H("step-after"===r?"step-before":"step-before"===r?"step-after":r,"_previousOrigin")(x),T=-1===(k=H("linear","_previousOrigin")(E)).indexOf("L")?void 0:k.indexOf("L"),L[o].entry=w+(S&&S.length>0?"L"+S.substring(1):"")+(k&&k.length>0?"L"+k.substring(1,T):0),w=H(r)(E),S=H("step-after"===r?"step-before":"step-before"===r?"step-after":r)(x),T=-1===(k=H("linear")(E)).indexOf("L")?void 0:k.indexOf("L"),L[o].update=w+(S&&S.length>0?"L"+S.substring(1):"")+(k&&k.length>0?"L"+k.substring(1,T):0),w=H(r,"_origin")(E),S=H("step-after"===r?"step-before":"step-before"===r?"step-after":r,"_origin")(x),T=-1===(k=H("linear","_origin")(E)).indexOf("L")?void 0:k.indexOf("L"),L[o].exit=w+(S&&S.length>0?"L"+S.substring(1):"")+(k&&k.length>0?"L"+k.substring(1,T):0),L[o].color=a.getColor(L[o].key.length>0?L[o].key[L[o].key.length-1]:"All"),L[o].css=a.getClass(L[o].key.length>0?L[o].key[L[o].key.length-1]:"All")}a._tooltipGroup&&a._tooltipGroup.remove(),d=(M=i.shapes?i.shapes.data(L,(function(t){return t.key})):i._group.selectAll("."+D).data(L,(function(t){return t.key}))).enter().append("path").attr("id",(function(t){return e._createClass([t.key])})).attr("class",(function(t){return D+" dimple-line "+t.keyString+" "+a.customClassList.areaSeries+" "+t.css})).attr("d",(function(t){return t.entry})).call((function(t){a.noFormats||t.attr("opacity",(function(t){return I?1:t.color.opacity})).style("fill",(function(t){return I?"url(#"+e._createClass(["fill-area-gradient-"+t.keyString])+")":t.color.fill})).style("stroke",(function(t){return I?"url(#"+e._createClass(["stroke-area-gradient-"+t.keyString])+")":t.color.stroke})).style("stroke-width",i.lineWeight)})).each((function(t){t.markerData=t.data,W(t,this)})),p=a._handleTransition(M.merge(d),n,a).attr("d",(function(t){return t.update})).each((function(t){t.markerData=t.data,W(t,this)})),g=a._handleTransition(M.exit(),n,a).attr("d",(function(t){return t.exit})).each((function(t){t.markerData=[],W(t,this)})),e._postDrawHandling(i,p,g,n),i.shapes=i._group.selectAll("."+D)}},e.plot.bar={stacked:!0,grouped:!1,supportedAxes:["x","y","c"],draw:function(t,a,i){var n,r,o,s=a._positionData,l=null,u=["dimple-series-"+t.series.indexOf(a),"dimple-bar"],c=!a._isStacked()&&a.x._hasMeasure(),h=!a._isStacked()&&a.y._hasMeasure(),d="none";a.x._hasCategories()&&a.y._hasCategories()?d="both":a.x._hasCategories()?d="x":a.y._hasCategories()&&(d="y"),t._tooltipGroup&&t._tooltipGroup.remove(),n=(l=a.shapes?a.shapes.data(s,(function(t){return t.key})):a._group.selectAll("."+u.join(".")).data(s,(function(t){return t.key}))).enter().append("rect").attr("id",(function(t){return e._createClass([t.key])})).attr("class",(function(a){var i=[];return i=(i=(i=i.concat(a.aggField)).concat(a.xField)).concat(a.yField),u.join(" ")+" "+e._createClass(i)+" "+t.customClassList.barSeries+" "+e._helpers.css(a,t)})).attr("x",(function(i){var n=a.x._previousOrigin;return"x"===d?n=e._helpers.x(i,t,a):"both"===d&&(n=e._helpers.cx(i,t,a)),n})).attr("y",(function(i){var n=a.y._previousOrigin;return"y"===d?n=e._helpers.y(i,t,a):"both"===d&&(n=e._helpers.cy(i,t,a)),n})).attr("width",(function(i){return"x"===d?e._helpers.width(i,t,a):0})).attr("height",(function(i){return"y"===d?e._helpers.height(i,t,a):0})).on("mouseover",(function(i,n){e._showBarTooltip(n,this,t,a)})).on("mouseleave",(function(i,n){e._removeTooltip(n,this,t,a)})).call((function(i){t.noFormats||i.attr("opacity",(function(i){return e._helpers.opacity(i,t,a)})).style("fill",(function(i){return e._helpers.fill(i,t,a)})).style("stroke",(function(i){return e._helpers.stroke(i,t,a)}))})),r=t._handleTransition(l.merge(n),i,t,a).attr("x",(function(i){return c?e._helpers.cx(i,t,a)-a.x.floatingBarWidth/2:e._helpers.x(i,t,a)})).attr("y",(function(i){return h?e._helpers.cy(i,t,a)-a.y.floatingBarWidth/2:e._helpers.y(i,t,a)})).attr("width",(function(i){return c?a.x.floatingBarWidth:e._helpers.width(i,t,a)})).attr("height",(function(i){return h?a.y.floatingBarWidth:e._helpers.height(i,t,a)})).call((function(i){t.noFormats||i.attr("fill",(function(i){return e._helpers.fill(i,t,a)})).attr("stroke",(function(i){return e._helpers.stroke(i,t,a)}))})),o=t._handleTransition(l.exit(),i,t,a).attr("x",(function(i){var n=a.x._origin;return"x"===d?n=e._helpers.x(i,t,a):"both"===d&&(n=e._helpers.cx(i,t,a)),n})).attr("y",(function(i){var n=a.y._origin;return"y"===d?n=e._helpers.y(i,t,a):"both"===d&&(n=e._helpers.cy(i,t,a)),n})).attr("width",(function(i){return"x"===d?e._helpers.width(i,t,a):0})).attr("height",(function(i){return"y"===d?e._helpers.height(i,t,a):0})),e._postDrawHandling(a,r,o,i),a.shapes=a._group.selectAll("."+u.join("."))}},e.plot.bubble={stacked:!1,grouped:!1,supportedAxes:["x","y","z","c"],draw:function(t,a,i){var n,r,o,s=a._positionData,l=null,u=["dimple-series-"+t.series.indexOf(a),"dimple-bubble"];t._tooltipGroup&&t._tooltipGroup.remove(),n=(l=a.shapes?a.shapes.data(s,(function(t){return t.key})):a._group.selectAll("."+u.join(".")).data(s,(function(t){return t.key}))).enter().append("circle").attr("id",(function(t){return e._createClass([t.key])})).attr("class",(function(a){var i=[];return i=(i=(i=(i=i.concat(a.aggField)).concat(a.xField)).concat(a.yField)).concat(a.zField),u.join(" ")+" "+e._createClass(i)+" "+t.customClassList.bubbleSeries+" "+e._helpers.css(a,t)})).attr("cx",(function(i){return a.x._hasCategories()?e._helpers.cx(i,t,a):a.x._previousOrigin})).attr("cy",(function(i){return a.y._hasCategories()?e._helpers.cy(i,t,a):a.y._previousOrigin})).attr("r",0).on("mouseover",(function(i,n){e._showPointTooltip(n,this,t,a)})).on("mouseleave",(function(i,n){e._removeTooltip(n,this,t,a)})).call((function(i){t.noFormats||i.attr("opacity",(function(i){return e._helpers.opacity(i,t,a)})).style("fill",(function(i){return e._helpers.fill(i,t,a)})).style("stroke",(function(i){return e._helpers.stroke(i,t,a)}))})),r=t._handleTransition(l.merge(n),i,t,a).attr("cx",(function(i){return e._helpers.cx(i,t,a)})).attr("cy",(function(i){return e._helpers.cy(i,t,a)})).attr("r",(function(i){return e._helpers.r(i,t,a)})).call((function(i){t.noFormats||i.attr("fill",(function(i){return e._helpers.fill(i,t,a)})).attr("stroke",(function(i){return e._helpers.stroke(i,t,a)}))})),o=t._handleTransition(l.exit(),i,t,a).attr("r",0).attr("cx",(function(i){return a.x._hasCategories()?e._helpers.cx(i,t,a):a.x._origin})).attr("cy",(function(i){return a.y._hasCategories()?e._helpers.cy(i,t,a):a.y._origin})),e._postDrawHandling(a,r,o,i),a.shapes=a._group.selectAll("."+u.join("."))}},e.plot.line={stacked:!1,grouped:!0,supportedAxes:["x","y","c"],draw:function(a,i,n){var r,o,s,l,u,c,h,d,p,g,f,m=i._positionData,x=[],y=null,v="dimple-series-"+a.series.indexOf(i),b=i.x._hasCategories()||i.y._hasCategories()?0:1,_=!1,w=function(){return function(a,i,n,r){t.select(i).style("opacity",1),e._showPointTooltip(a,i,n,r)}},S=function(a){return function(i,n,r,o){t.select(n).style("opacity",o.lineMarkers||a.data.length<2?e._helpers.opacity(i,r,o):0),e._removeTooltip(i,n,r,o)}},k=function(t,r){e._drawMarkers(t,a,i,n,v,_,w(),S(t),r)},T=function(t,n){var r;return"step"===i.interpolation&&i[t]._hasCategories()?(i.barGap=0,i.clusterBarGap=0,r=e._helpers[t](n,a,i)+("y"===t?e._helpers.height(n,a,i):0)):r=e._helpers["c"+t](n,a,i),parseFloat(r.toFixed(1))},P=function(a,n){var r=t.line().x((function(t){return i.x._hasCategories()||!n?t.x:i.x[n]})).y((function(t){return i.y._hasCategories()||!n?t.y:i.y[n]}));return e._interpolate(r,a),r};for(r="step"===i.interpolation?"step-after":i.interpolation,f=e._getSeriesOrder(i.data||a.data,i),i.c&&(i.x._hasCategories()&&i.y._hasMeasure()||i.y._hasCategories()&&i.x._hasMeasure())&&(_=!0),o=0;o<m.length;o+=1){for(u=[],h=-1,l=b;l<m[o].aggField.length;l+=1)u.push(m[o].aggField[l]);for(c=e._createClass(u),l=0;l<x.length;l+=1)if(x[l].keyString===c){h=l;break}-1===h&&(h=x.length,x.push({key:u,keyString:c,color:"white",data:[],markerData:[],points:[],line:{},entry:{},exit:{}})),x[h].data.push(m[o])}for(f&&x.sort((function(t,a){return e._arrayIndexCompare(f,t.key,a.key)})),o=0;o<x.length;o+=1){for(x[o].data.sort(e._getSeriesSortPredicate(a,i,f)),_&&e._addGradient(x[o].key,"fill-line-gradient-"+x[o].keyString,i.x._hasCategories()?i.x:i.y,m,a,n,"fill"),s=0;s<x[o].data.length;s+=1)x[o].points.push({x:T("x",x[o].data[s]),y:T("y",x[o].data[s])});"step"===i.interpolation&&x[o].points.length>1&&(i.x._hasCategories()?x[o].points.push({x:2*x[o].points[x[o].points.length-1].x-x[o].points[x[o].points.length-2].x,y:x[o].points[x[o].points.length-1].y}):i.y._hasCategories()&&(x[o].points=[{x:x[o].points[0].x,y:2*x[o].points[0].y-x[o].points[1].y}].concat(x[o].points))),x&&x[o]&&x[o].points&&1===x[o].points.length&&x[o].points.push({x:x[o].points[0].x,y:x[o].points[0].y}),x[o].entry=P(r,"_previousOrigin")(x[o].points),x[o].update=P(r)(x[o].points),x[o].exit=P(r,"_origin")(x[o].points),x[o].color=a.getColor(x[o].key.length>0?x[o].key[x[o].key.length-1]:"All"),x[o].css=a.getClass(x[o].key.length>0?x[o].key[x[o].key.length-1]:"All")}a._tooltipGroup&&a._tooltipGroup.remove(),d=(y=i.shapes?i.shapes.data(x,(function(t){return t.key})):i._group.selectAll("."+v).data(x,(function(t){return t.key}))).enter().append("path").attr("id",(function(t){return e._createClass([t.key])})).attr("class",(function(t){return v+" dimple-line "+t.keyString+" "+a.customClassList.lineSeries+" "+t.css})).attr("d",(function(t){return t.entry})).call((function(t){a.noFormats||t.attr("opacity",(function(t){return _?1:t.color.opacity})).style("fill","none").style("stroke",(function(t){return _?"url(#"+e._createClass(["fill-line-gradient-"+t.keyString])+")":t.color.stroke})).style("stroke-width",i.lineWeight)})).each((function(t){t.markerData=t.data,k(t,this)})),p=a._handleTransition(y.merge(d),n,a).attr("d",(function(t){return t.update})).each((function(t){t.markerData=t.data,k(t,this)})),g=a._handleTransition(y.exit(),n,a).attr("d",(function(t){return t.exit})).each((function(t){t.markerData=[],k(t,this)})),e._postDrawHandling(i,p,g,n),i.shapes=i._group.selectAll("."+v)}},e.plot.pie={stacked:!1,grouped:!1,supportedAxes:["x","y","c","z","p"],draw:function(a,i,n){var r,o,s,l=i._positionData,u=null,c=["dimple-series-"+a.series.indexOf(i),"dimple-pie"],h=function(t){return i.x&&i.y?e._helpers.r(t,a,i):a._widthPixels()<a._heightPixels()?a._widthPixels()/2:a._heightPixels()/2},d=function(t){var a=h(t);return i.outerRadius&&(a=e._parsePosition(i.outerRadius,a)),Math.max(a,0)},p=function(t){var a=0;return i.innerRadius&&(a=e._parsePosition(i.innerRadius,h(t))),Math.max(a,0)},g=function(e){return t.arc().innerRadius(p(e)).outerRadius(d(e))(e)},f=function(e){e.innerRadius=p(e),e.outerRadius=d(e);var a,i=t.interpolate(this._current,e);return a=t.arc().innerRadius((function(t){return t.innerRadius})).outerRadius((function(t){return t.outerRadius})),this._current=i(0),function(t){return a(i(t))}},m=function(t){return function(n){var r,o;return i.x&&i.y?(r=!t||i.x._hasCategories()?e._helpers.cx(n,a,i):i.x._previousOrigin,o=!t||i.y._hasCategories()?e._helpers.cy(n,a,i):i.y._previousOrigin):(r=a._xPixels()+a._widthPixels()/2,o=a._yPixels()+a._heightPixels()/2),"translate("+r+","+o+")"}};a._tooltipGroup&&a._tooltipGroup.remove(),r=(u=i.shapes?i.shapes.data(l,(function(t){return t.key})):i._group.selectAll("."+c.join(".")).data(l,(function(t){return t.key}))).enter().append("path").attr("id",(function(t){return e._createClass([t.key])})).attr("class",(function(t){var i=[];return i=(i=i.concat(t.aggField)).concat(t.pField),c.join(" ")+" "+e._createClass(i)+" "+a.customClassList.pieSeries+" "+e._helpers.css(t,a)})).attr("d",g).on("mouseover",(function(t,n){e._showBarTooltip(n,this,a,i)})).on("mouseleave",(function(t,n){e._removeTooltip(n,this,a,i)})).call((function(t){a.noFormats||t.attr("opacity",(function(t){return e._helpers.opacity(t,a,i)})).style("fill",(function(t){return e._helpers.fill(t,a,i)})).style("stroke",(function(t){return e._helpers.stroke(t,a,i)}))})).attr("transform",m(!0)).each((function(t){this._current=t,t.innerRadius=p(t),t.outerRadius=d(t)})),o=a._handleTransition(u.merge(r),n,a,i).call((function(t){n&&n>0?t.attrTween("d",f):t.attr("d",g),a.noFormats||t.attr("fill",(function(t){return e._helpers.fill(t,a,i)})).attr("stroke",(function(t){return e._helpers.stroke(t,a,i)}))})).attr("transform",m(!1)),s=a._handleTransition(u.exit(),n,a,i).attr("transform",m(!0)).attr("d",g),e._postDrawHandling(i,o,s,n),i.shapes=i._group.selectAll("."+c.join("."))}},e._addGradient=function(t,a,i,n,r,o,s){var l=[].concat(t),u=r.svg.select("#"+e._createClass([a])),c=[],h=i.position+"Field",d=!0,p=[];n.forEach((function(t){-1===c.indexOf(t[h])&&t.aggField.join("_")===l.join("_")&&c.push(t[h])}),this),c=c.sort((function(t,e){return i._scale(t)-i._scale(e)})),null===u.node()&&(d=!1,u=r.svg.append("defs").append("linearGradient").attr("id",e._createClass([a])).attr("gradientUnits","userSpaceOnUse").attr("x1","x"===i.position?i._scale(c[0])+r._widthPixels()/c.length/2:0).attr("y1","y"===i.position?i._scale(c[0])-r._heightPixels()/c.length/2:0).attr("x2","x"===i.position?i._scale(c[c.length-1])+r._widthPixels()/c.length/2:0).attr("y2","y"===i.position?i._scale(c[c.length-1])-r._heightPixels()/c.length/2:0)),c.forEach((function(t,e){var a={},i=0;for(i=0;i<n.length;i+=1)if(n[i].aggField.join("_")===l.join("_")&&n[i][h].join("_")===t.join("_")){a=n[i];break}p.push({offset:Math.round(e/(c.length-1)*100)+"%",color:a[s]})}),this),d?r._handleTransition(u.selectAll("stop").data(p),o,r).attr("offset",(function(t){return t.offset})).attr("stop-color",(function(t){return t.color})):u.selectAll("stop").data(p).enter().append("stop").attr("offset",(function(t){return t.offset})).attr("stop-color",(function(t){return t.color}))},e._arrayIndexCompare=function(t,e,a){var i,n,r,o,s,l;for(n=0;n<t.length;n+=1){for(o=!0,s=!0,l=[].concat(t[n]),r=0;r<e.length;r+=1)o=o&&e[r]===l[r];for(r=0;r<a.length;r+=1)s=s&&a[r]===l[r];if(o||s){i=o&&s?0:o?-1:1;break}}return i},e._createClass=function(t){var e,a,i=[];if(a=function(t){var e=t.charCodeAt(0),a="-";return e>=65&&e<=90&&(a=t.toLowerCase()),a},t.length>0)for(e=0;e<t.length;e+=1)t[e]&&i.push("dimple-"+t[e].toString().replace(/[^a-z0-9]/g,a));else i=["dimple-all"];return i.join(" ")},e._drawMarkerBacks=function(a,i,n,r,o,s){var l,u,c,h=["dimple-marker-back",o,a.keyString];n.lineMarkers&&(l=null===n._markerBacks||void 0===n._markerBacks||void 0===n._markerBacks[a.keyString]?n._group.selectAll("."+h.join(".")).data(a.markerData):n._markerBacks[a.keyString].data(a.markerData,(function(t){return t.key})),(c=s.nextSibling&&s.nextSibling.id?l.enter().insert("circle","#"+s.nextSibling.id):l.enter().append("circle")).attr("id",(function(t){return e._createClass([t.key+" Marker Back"])})).attr("class",(function(t){var a=[];return n.x._hasCategories()&&(a=a.concat(t.xField)),n.y._hasCategories()&&(a=a.concat(t.yField)),e._createClass(a)+" "+h.join(" ")})).attr("cx",(function(t){return n.x._hasCategories()?e._helpers.cx(t,i,n):n.x._previousOrigin})).attr("cy",(function(t){return n.y._hasCategories()?e._helpers.cy(t,i,n):n.y._previousOrigin})).attr("r",0).attr("fill","white").attr("stroke","none"),i._handleTransition(l.merge(c),r,i).attr("cx",(function(t){return e._helpers.cx(t,i,n)})).attr("cy",(function(t){return e._helpers.cy(t,i,n)})).attr("r",2+n.lineWeight),u=i._handleTransition(l.exit(),r,i).attr("cx",(function(t){return n.x._hasCategories()?e._helpers.cx(t,i,n):n.x._origin})).attr("cy",(function(t){return n.y._hasCategories()?e._helpers.cy(t,i,n):n.y._origin})).attr("r",0),0===r?u.remove():u.each("end",(function(){t.select(this).remove()})),void 0!==n._markerBacks&&null!==n._markerBacks||(n._markerBacks={}),n._markerBacks[a.keyString]=l)},e._drawMarkers=function(a,i,n,r,o,s,l,u,c){var h,d,p,g=["dimple-marker",o,a.keyString];h=null===n._markers||void 0===n._markers||void 0===n._markers[a.keyString]?n._group.selectAll("."+g.join(".")).data(a.markerData):n._markers[a.keyString].data(a.markerData,(function(t){return t.key})),(p=c.nextSibling&&c.nextSibling.id?h.enter().insert("circle","#"+c.nextSibling.id):h.enter().append("circle")).attr("id",(function(t){return e._createClass([t.key+" Marker"])})).attr("class",(function(t){var a=[],r=i.getClass(t.aggField.length>0?t.aggField[t.aggField.length-1]:"All");return n.x._hasCategories()&&(a=a.concat(t.xField)),n.y._hasCategories()&&(a=a.concat(t.yField)),e._createClass(a)+" "+g.join(" ")+" "+i.customClassList.lineMarker+" "+r})).on("mouseover",(function(t,e){l(e,this,i,n)})).on("mouseleave",(function(t,e){u(e,this,i,n)})).attr("cx",(function(t){return n.x._hasCategories()?e._helpers.cx(t,i,n):n.x._previousOrigin})).attr("cy",(function(t){return n.y._hasCategories()?e._helpers.cy(t,i,n):n.y._previousOrigin})).attr("r",0).attr("opacity",n.lineMarkers||a.data.length<2?a.color.opacity:0).call((function(t){i.noFormats||t.attr("fill","white").style("stroke-width",n.lineWeight).attr("stroke",(function(t){return s?e._helpers.fill(t,i,n):a.color.stroke}))})),i._handleTransition(h.merge(p),r,i).attr("cx",(function(t){return e._helpers.cx(t,i,n)})).attr("cy",(function(t){return e._helpers.cy(t,i,n)})).attr("r",2+n.lineWeight).attr("opacity",n.lineMarkers||a.data.length<2?a.color.opacity:0).call((function(t){i.noFormats||t.attr("fill","white").style("stroke-width",n.lineWeight).attr("stroke",(function(t){return s?e._helpers.fill(t,i,n):a.color.stroke}))})),d=i._handleTransition(h.exit(),r,i).attr("cx",(function(t){return n.x._hasCategories()?e._helpers.cx(t,i,n):n.x._origin})).attr("cy",(function(t){return n.y._hasCategories()?e._helpers.cy(t,i,n):n.y._origin})).attr("r",0),0===r?d.remove():d.each("end",(function(){t.select(this).remove()})),void 0!==n._markers&&null!==n._markers||(n._markers={}),n._markers[a.keyString]=h,e._drawMarkerBacks(a,i,n,r,o,c)},e._ease=function(e,a){if(e&&a&&"[object String]"===Object.prototype.toString.call(a)){switch(a){case"linear":a=t.easeLinear;break;case"poly":a=t.easePoly;break;case"quad":a=t.easeQuad;break;case"cubic":a=t.easeCubic;break;case"sin":a=t.easeSin;break;case"exp":a=t.easeExp;break;case"circle":a=t.easeCircle;break;case"elastic":a=t.easeElastic;break;case"back":a=t.easeBack;break;case"bounce":a=t.easeBounce}e.ease(a)}},e._getOrderedList=function(t,a,i){var n,r=[],o=[],s=[].concat(a),l=[].concat(a),u=[];return null!=i&&(u=u.concat(i)),(u=u.concat({ordering:s,desc:!1})).forEach((function(e){var a,i=[],n=[];if("function"==typeof e.ordering){if(t&&t.length>0)for(a in t[0])t[0].hasOwnProperty(a)&&-1===l.indexOf(a)&&l.push(a)}else if(e.ordering instanceof Array){for(a=0;a<e.ordering.length;a+=1)t&&t.length>0&&t[0].hasOwnProperty(e.ordering[a])&&n.push(e.ordering[a]),i.push(e.ordering[a]);n.length>i.length/2?l.concat(n):e.values=i}else l.push(e.ordering)}),this),n=e._rollUp(t,s,l),u.length>=1&&(u.forEach((function(t){var e=null!==t.desc&&void 0!==t.desc&&t.desc,a=t.ordering,i=[],n=function(t){var e,a=0;for(e=0;e<t.length;e+=1){if(isNaN(t[e])){a=void 0;break}a+=parseFloat(t[e])}return a},o=function(t,e){var a=0,i=n(t),r=n(e);return isNaN(i)||isNaN(r)?isNaN(Date.parse(t[0]))||isNaN(Date.parse(e[0]))?t[0]<e[0]?a=-1:t[0]>e[0]&&(a=1):a=Date.parse(t[0])-Date.parse(e[0]):a=parseFloat(i)-parseFloat(r),a};"function"==typeof a?r.push((function(t,i){return(e?-1:1)*a(t,i)})):t.values&&t.values.length>0?(t.values.forEach((function(t){i.push([].concat(t).join("|"))}),this),r.push((function(t,a){var n,r,o,l="",u="";for(o=0;o<s.length;o+=1)o>0&&(l+="|",u+="|"),l+=t[s[o]],u+=a[s[o]];return n=i.indexOf(l),r=i.indexOf(u),n=n<0?e?-1:i.length:n,r=r<0?e?-1:i.length:r,(e?-1:1)*(n-r)}))):[].concat(t.ordering).forEach((function(t){r.push((function(a,i){var n=0;return void 0!==a[t]&&void 0!==i[t]&&(n=o([].concat(a[t]),[].concat(i[t]))),(e?-1:1)*n}))}))})),n.sort((function(t,e){for(var a=0,i=0;a<r.length&&0===i;)i=r[a](t,e),a+=1;return i})),n.forEach((function(t){var e,a=[];if(1===s.length)o.push(t[s[0]]);else{for(e=0;e<s.length;e+=1)a.push(t[s[e]]);o.push(a)}}),this)),o},e._getSeriesOrder=function(t,a){var i=[].concat(a._orderRules),n=a.categoryFields,r=[];return null!=n&&n.length>0&&(null!==a.c&&void 0!==a.c&&a.c._hasMeasure()&&i.push({ordering:a.c.measure,desc:!0}),a.x._hasMeasure()&&i.push({ordering:a.x.measure,desc:!0}),a.y._hasMeasure()&&i.push({ordering:a.y.measure,desc:!0}),r=e._getOrderedList(t,n,i)),r},e._getSeriesSortPredicate=function(t,a,i){return function(n,r){var o=0;return a.x._hasCategories()&&(o=e._helpers.cx(n,t,a)-e._helpers.cx(r,t,a)),0===o&&a.y._hasCategories()&&(o=e._helpers.cy(n,t,a)-e._helpers.cy(r,t,a)),0===o&&i&&(o=e._arrayIndexCompare(i,n.aggField,r.aggField)),o}},e._helpers={cx:function(t,a,i){return null!==i.x.measure&&void 0!==i.x.measure?i.x._scale(t.cx):i.x._hasCategories()&&i.x.categoryFields.length>=2?i.x._scale(t.cx)+e._helpers.xGap(a,i)+(t.xOffset+.5)*((a._widthPixels()/i.x._max-2*e._helpers.xGap(a,i))*t.width):i.x._scale(t.cx)+a._widthPixels()/i.x._max/2},cy:function(t,a,i){return null!==i.y.measure&&void 0!==i.y.measure?i.y._scale(t.cy):null!==i.y.categoryFields&&void 0!==i.y.categoryFields&&i.y.categoryFields.length>=2?i.y._scale(t.cy)-a._heightPixels()/i.y._max+e._helpers.yGap(a,i)+(t.yOffset+.5)*((a._heightPixels()/i.y._max-2*e._helpers.yGap(a,i))*t.height):i.y._scale(t.cy)-a._heightPixels()/i.y._max/2},r:function(t,e,a){var i=0,n=1;return null===a.z||void 0===a.z?i=a.radius&&"auto"!==a.radius?a.radius:5:(a.radius&&"auto"!==a.radius&&a.radius>1&&(n=a.radius/a.z._scale(a.z._max)),i=a.z._hasMeasure()?a.z._scale(t.r)*n:a.z._scale(e._heightPixels()/100)*n),i},xGap:function(t,e){var a=0;return(null===e.x.measure||void 0===e.x.measure)&&e.barGap>0&&(a=t._widthPixels()/e.x._max*(e.barGap>.99?.99:e.barGap)/2),a},xClusterGap:function(t,a,i){var n=0;return null!==i.x.categoryFields&&void 0!==i.x.categoryFields&&i.x.categoryFields.length>=2&&i.clusterBarGap>0&&!i.x._hasMeasure()&&(n=t.width*(a._widthPixels()/i.x._max-2*e._helpers.xGap(a,i))*(i.clusterBarGap>.99?.99:i.clusterBarGap)/2),n},yGap:function(t,e){var a=0;return(null===e.y.measure||void 0===e.y.measure)&&e.barGap>0&&(a=t._heightPixels()/e.y._max*(e.barGap>.99?.99:e.barGap)/2),a},yClusterGap:function(t,a,i){var n=0;return null!==i.y.categoryFields&&void 0!==i.y.categoryFields&&i.y.categoryFields.length>=2&&i.clusterBarGap>0&&!i.y._hasMeasure()&&(n=t.height*(a._heightPixels()/i.y._max-2*e._helpers.yGap(a,i))*(i.clusterBarGap>.99?.99:i.clusterBarGap)/2),n},x:function(t,a,i){return i.x._hasTimeField()?i.x._scale(t.x)-e._helpers.width(t,a,i)/2:null!==i.x.measure&&void 0!==i.x.measure?i.x._scale(t.x):i.x._scale(t.x)+e._helpers.xGap(a,i)+t.xOffset*(e._helpers.width(t,a,i)+2*e._helpers.xClusterGap(t,a,i))+e._helpers.xClusterGap(t,a,i)},y:function(t,a,i){return i.y._hasTimeField()?i.y._scale(t.y)-e._helpers.height(t,a,i)/2:null!==i.y.measure&&void 0!==i.y.measure?i.y._scale(t.y):i.y._scale(t.y)-a._heightPixels()/i.y._max+e._helpers.yGap(a,i)+t.yOffset*(e._helpers.height(t,a,i)+2*e._helpers.yClusterGap(t,a,i))+e._helpers.yClusterGap(t,a,i)},width:function(t,a,i){return null!==i.x.measure&&void 0!==i.x.measure?Math.abs(i.x._scale(t.x<0?t.x-t.width:t.x+t.width)-i.x._scale(t.x)):i.x._hasTimeField()?i.x.floatingBarWidth:t.width*(a._widthPixels()/i.x._max-2*e._helpers.xGap(a,i))-2*e._helpers.xClusterGap(t,a,i)},height:function(t,a,i){return i.y._hasTimeField()?i.y.floatingBarWidth:null!==i.y.measure&&void 0!==i.y.measure?Math.abs(i.y._scale(t.y)-i.y._scale(t.y<=0?t.y+t.height:t.y-t.height)):t.height*(a._heightPixels()/i.y._max-2*e._helpers.yGap(a,i))-2*e._helpers.yClusterGap(t,a,i)},opacity:function(t,e,a){return null!==a.c&&void 0!==a.c?t.opacity:e.getColor(t.aggField.slice(-1)[0]).opacity},fill:function(t,e,a){return null!==a.c&&void 0!==a.c?t.fill:e.getColor(t.aggField.slice(-1)[0]).fill},stroke:function(t,e,a){return null!==a.c&&void 0!==a.c?t.stroke:e.getColor(t.aggField.slice(-1)[0]).stroke},css:function(t,e){return e.getClass(t.aggField.slice(-1)[0])}},e._interpolate=function(e,a){if(e&&a){if("[object String]"===Object.prototype.toString.call(a))switch(a){case"linear":a=t.curveLinear;break;case"linear-closed":a=t.curveLinearClosed;break;case"step":a=t.curveStep;break;case"step-before":a=t.curveStepBefore;break;case"step-after":a=t.curveStepAfter;break;case"basis":a=t.curveBasis;break;case"basis-open":a=t.curveBasisOpen;break;case"basis-closed":a=t.curveBasisClosed;break;case"bundle":a=t.curveBundle;break;case"cardinal":a=t.curveCardinal;break;case"cardinal-open":a=t.curveCardinalOpen;break;case"cardinal-closed":a=t.curveCardinalClosed;break;case"monotone":a=t.curveMonotoneX}e.curve(a)}},e._parentHeight=function(t){var e=t.getBoundingClientRect().height;return(!e||e<0)&&(e=t.clientHeight),e},e._parentWidth=function(t){var e=t.getBoundingClientRect().width;return(!e||e<0)&&(e=t.clientWidth),e},e._parsePosition=function(t,e){var a=0;return t&&t.toString().split(",").forEach((function(i){i&&(isNaN(i)?"%"===i.slice(-1)?a+=e*(parseFloat(i.slice(0,i.length-1))/100):"px"===i.slice(-2)?a+=parseFloat(i.slice(0,i.length-2)):a=t:a+=parseFloat(i))}),this),a<0&&(a=e+a),a},e._parseXPosition=function(t,a){return e._parsePosition(t,e._parentWidth(a))},e._parseYPosition=function(t,a){return e._parsePosition(t,e._parentHeight(a))},e._postDrawHandling=function(t,e,a,i){0===i?(e.each((function(e,a){t.afterDraw&&t.afterDraw(this,e,a)})),a.remove()):(e.on("end",(function(e,a){t.afterDraw&&t.afterDraw(this,e,a)})),a.call((function(){t.shapes&&t.shapes.exit().remove()})))},e._removeTooltip=function(t,e,a,i){a._tooltipGroup&&a._tooltipGroup.remove()},e._rollUp=function(t,e,a){var i=[];return e=null!=e?[].concat(e):[],t.forEach((function(t){var n=-1,r={},o=!0;i.forEach((function(a,i){-1===n&&(o=!0,e.forEach((function(e){o=o&&t[e]===a[e]}),this),o&&(n=i))}),this),-1!==n?r=i[n]:(e.forEach((function(e){r[e]=t[e]}),this),i.push(r),n=i.length-1),a.forEach((function(a){-1===e.indexOf(a)&&(void 0===r[a]&&(r[a]=[]),r[a]=r[a].concat(t[a]))}),this),i[n]=r}),this),i},e._showBarTooltip=function(e,a,i,n){var r,o,s,l,u,c,h=10,d=t.select(a),p=d.node().getBBox().x,g=d.node().getBBox().y,f=d.node().getBBox().width,m=d.node().getBBox().height,x=d.attr("opacity"),y=d.attr("fill"),v=n._dropLineOrigin(),b=t.rgb(t.rgb(y).r+.6*(255-t.rgb(y).r),t.rgb(y).g+.6*(255-t.rgb(y).g),t.rgb(y).b+.6*(255-t.rgb(y).b)),_=t.rgb(t.rgb(y).r+.8*(255-t.rgb(y).r),t.rgb(y).g+.8*(255-t.rgb(y).g),t.rgb(y).b+.8*(255-t.rgb(y).b)),w=n.getTooltipText(e),S=0,k=0,T=0,P=function(t,e){var a=d.node().getCTM(),n=i.svg.node().createSVGPoint();return n.x=t||0,n.y=e||0,n.matrixTransform(a)};null!==i._tooltipGroup&&void 0!==i._tooltipGroup&&i._tooltipGroup.remove(),i._tooltipGroup=i.svg.append("g"),n.p||(c=n._isStacked()?1:f/2,n.x._hasCategories()||null===v.y||i._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+i.customClassList.tooltipDropLine).attr("x1",p<n.x._origin?p+c:p+f-c).attr("y1",g<v.y?g+m:g).attr("x2",p<n.x._origin?p+c:p+f-c).attr("y2",g<v.y?g+m:g).call((function(t){i.noFormats||t.style("fill","none").style("stroke",y).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",x)})).transition().delay(375).duration(375).ease(t.easeLinear).attr("y2",g<v.y?v.y-1:v.y+1),c=n._isStacked()?1:m/2,n.y._hasCategories()||null===v.x||i._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+i.customClassList.tooltipDropLine).attr("x1",p<v.x?p+f:p).attr("y1",g<n.y._origin?g+c:g+m-c).attr("x2",p<v.x?p+f:p).attr("y2",g<n.y._origin?g+c:g+m-c).call((function(t){i.noFormats||t.style("fill","none").style("stroke",y).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",x)})).transition().delay(375).duration(375).ease(t.easeLinear).attr("x2",p<v.x?v.x-1:v.x+1)),o=(r=i._tooltipGroup.append("g")).append("rect").attr("class","dimple-tooltip "+i.customClassList.tooltipBox),r.selectAll(".dimple-dont-select-any").data(w).enter().append("text").attr("class","dimple-tooltip "+i.customClassList.tooltipLabel).text((function(t){return t})).call((function(t){i.noFormats||t.style("font-family",n.tooltipFontFamily).style("font-size",n._getTooltipFontSize())})),r.each((function(){k=this.getBBox().width>k?this.getBBox().width:k,T=this.getBBox().width>T?this.getBBox().height:T})),r.selectAll("text").attr("x",0).attr("y",(function(){return(S+=this.getBBox().height)-this.getBBox().height/2})),o.attr("x",-5).attr("y",-5).attr("height",Math.floor(S+5)-.5).attr("width",k+10).attr("rx",5).attr("ry",5).call((function(t){i.noFormats||t.style("fill",_).style("stroke",b).style("stroke-width",2).style("opacity",.95)})),P(p+f+5+h+k).x<parseFloat(i.svg.node().getBBox().width)?(s=p+f+5+h,l=g+m/2-(S-(T-5))/2):P(p-(15+k)).x>0?(s=p-(15+k),l=g+m/2-(S-(T-5))/2):P(0,g+m+S+h+5).y<parseFloat(i.svg.node().getBBox().height)?(s=(s=(s=p+f/2-(10+k)/2)>0?s:h)+k<parseFloat(i.svg.node().getBBox().width)?s:parseFloat(i.svg.node().getBBox().width)-k-h,l=g+m+10):(s=(s=(s=p+f/2-(10+k)/2)>0?s:h)+k<parseFloat(i.svg.node().getBBox().width)?s:parseFloat(i.svg.node().getBBox().width)-k-h,l=g-S-(T-5)),u=P(s,l),r.attr("transform","translate("+u.x+" , "+u.y+")")},e._showPointTooltip=function(a,i,n,r){var o,s,l,u,c=10,h=t.select(i),d=parseFloat(h.attr("cx")),p=parseFloat(h.attr("cy")),g=parseFloat(h.attr("r")),f=e._helpers.opacity(a,n,r),m=h.attr("stroke"),x=r._dropLineOrigin(),y=t.rgb(t.rgb(m).r+.6*(255-t.rgb(m).r),t.rgb(m).g+.6*(255-t.rgb(m).g),t.rgb(m).b+.6*(255-t.rgb(m).b)),v=t.rgb(t.rgb(m).r+.8*(255-t.rgb(m).r),t.rgb(m).g+.8*(255-t.rgb(m).g),t.rgb(m).b+.8*(255-t.rgb(m).b)),b=0,_=0,w=0,S=r.getTooltipText(a);null!==n._tooltipGroup&&void 0!==n._tooltipGroup&&n._tooltipGroup.remove(),n._tooltipGroup=n.svg.append("g"),n._tooltipGroup.append("circle").attr("class","dimple-line-marker-circle "+n.customClassList.lineMarkerCircle).attr("cx",d).attr("cy",p).attr("r",g).call((function(t){n.noFormats||t.attr("opacity",0).style("fill","none").style("stroke",m).style("stroke-width",1)})).transition().duration(375).ease(t.easeLinear).attr("r",g+r.lineWeight+2).call((function(t){n.noFormats||t.attr("opacity",1).style("stroke-width",2)})),null!==x.y&&n._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+n.customClassList.tooltipDropLine).attr("x1",d).attr("y1",p<x.y?p+g+r.lineWeight+2:p-g-r.lineWeight-2).attr("x2",d).attr("y2",p<x.y?p+g+r.lineWeight+2:p-g-r.lineWeight-2).call((function(t){n.noFormats||t.style("fill","none").style("stroke",m).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",f)})).transition().delay(375).duration(375).ease(t.easeLinear).attr("y2",p<x.y?x.y-1:x.y+1),null!==x.x&&n._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+n.customClassList.tooltipDropLine).attr("x1",d<x.x?d+g+r.lineWeight+2:d-g-r.lineWeight-2).attr("y1",p).attr("x2",d<x.x?d+g+r.lineWeight+2:d-g-r.lineWeight-2).attr("y2",p).call((function(t){n.noFormats||t.style("fill","none").style("stroke",m).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",f)})).transition().delay(375).duration(375).ease(t.easeLinear).attr("x2",d<x.x?x.x-1:x.x+1),s=(o=n._tooltipGroup.append("g")).append("rect").attr("class","dimple-tooltip "+n.customClassList.tooltipBox),o.selectAll(".dont-select-any").data(S).enter().append("text").attr("class","dimple-tooltip "+n.customClassList.tooltipLabel).text((function(t){return t})).call((function(t){n.noFormats||t.style("font-family",r.tooltipFontFamily).style("font-size",r._getTooltipFontSize())})),o.each((function(){_=this.getBBox().width>_?this.getBBox().width:_,w=this.getBBox().width>w?this.getBBox().height:w})),o.selectAll("text").attr("x",0).attr("y",(function(){return(b+=this.getBBox().height)-this.getBBox().height/2})),s.attr("x",-5).attr("y",-5).attr("height",Math.floor(b+5)-.5).attr("width",_+10).attr("rx",5).attr("ry",5).call((function(t){n.noFormats||t.style("fill",v).style("stroke",y).style("stroke-width",2).style("opacity",.95)})),d+g+5+c+_<parseFloat(n.svg.node().getBBox().width)?(l=d+g+5+c,u=p-(b-(w-5))/2):d-g-(15+_)>0?(l=d-g-(15+_),u=p-(b-(w-5))/2):p+g+b+c+5<parseFloat(n.svg.node().getBBox().height)?(l=(l=(l=d-(10+_)/2)>0?l:c)+_<parseFloat(n.svg.node().getBBox().width)?l:parseFloat(n.svg.node().getBBox().width)-_-c,u=p+g+10):(l=(l=(l=d-(10+_)/2)>0?l:c)+_<parseFloat(n.svg.node().getBBox().width)?l:parseFloat(n.svg.node().getBBox().width)-_-c,u=p-b-(w-5)),o.attr("transform","translate("+l+" , "+u+")")},e.filterData=function(t,e,a){var i=t;return null!==e&&null!==a&&(null!=a&&(a=[].concat(a)),i=[],t.forEach((function(t){(null===t[e]||a.indexOf([].concat(t[e]).join("/"))>-1)&&i.push(t)}),this)),i},e.getUniqueValues=function(t,e){var a=[];return null!=e&&(e=[].concat(e),t.forEach((function(t){var i="";e.forEach((function(e,a){a>0&&(i+="/"),i+=t[e]}),this),-1===a.indexOf(i)&&a.push(i)}),this)),a},e.newSvg=function(e,a,i){var n=null;if(null!=e||(e="body"),(n=t.select(e)).empty())throw"The '"+e+"' selector did not match any elements.  Please prefix with '#' to select by id or '.' to select by class";return n.append("svg").attr("width",a).attr("height",i)},e}))},51855:function(t,e,a){"use strict";a.r(e);var i=a(14738),n=a(14978),r=a(21297),o=a.n(r),s={initChartColorsDialog:function(t){var e,a="tf-chart-color-"+t.macroId,r=a+"-"+t.pageId;return i.default.initAJSDialog({container:t.settings,dialogName:a,dialogId:r,options:{offsetX:-20,width:220,gravity:"n",noBind:!0,addActiveClass:!1},getContent:function(){e=t.colors.slice(0,t.getAllChartColorLabels().length);var a=[];return t.getChartColorLabels().forEach((function(e,n){a.push({color:t.colors[n%t.colors.length],field:e,id:r,variant:i.default.FIELD_VARIANTS.COLORS})})),o().inlineDialog({clazz:"tf-chart-colors-dialog",name:"chart-colors",inputs:a,dialogId:r})},applyCallback:function(){n.default.chartColors.forEach((function(t){-1==$.inArray(t,e)&&e.push(t)})),t.triggerSettingsButtonInvoke(),t.enableSaveBtn(),t.colors=e,t.colorKeyMap=t.setColorKeyMap({},t.getAllChartColorLabels(),e),t.colorsCache=t.colors.slice(),t.draw()},cancelCallback:function(){t.triggerSettingsButtonInvoke()},bindsCallback:function(t){t.popup.find(".tfc-color:not(.selected)").on("click",(function(){var a=$(this);e[a.data("index")]=a.data("color"),t.popup.find("button .tfc-color").eq(a.data("index")).css("background",a.data("color")).attr("data-color",a.data("color"))}))},hideCallback:function(){t.controls.removeClass("active")}})},initInterpolationDialog:function(t){var e="tf-interpolation-dialog-"+t.macroId,a=e+"-"+t.pageId;return i.default.initAJSDialog({container:t.settings,dialogName:e,dialogId:a,options:{offsetX:-20,width:250,gravity:"n",noBind:!0,addActiveClass:!1},getContent:function(){var e=t.getChartColorLabels(),n=[];return e.forEach((function(e,a){t.interpolation[e]||(t.interpolation[e]=t.defaultInterpolation),n.push({field:e,value:t.interpolation[e],variant:i.default.FIELD_VARIANTS.INTERPOLATION_SELECT})})),o().inlineDialog({clazz:"tf-interpolation-dialog",name:"interpolation",inputs:n,dialogId:a})},applyCallback:function(e){t.triggerSettingsButtonInvoke(),t.enableSaveBtn();var a={};e.popup.find("form").find("select").each((function(t,e){var i=$(e);a[i.data("name")]=i.val()})),t.interpolation=a,t.draw()},cancelCallback:function(){t.triggerSettingsButtonInvoke()},hideCallback:function(){t.controls.removeClass("active")}})},initLineSettingsDialog:function(t){var e="tf-line-settings-dialog-"+t.macroId,a=e+"-"+t.pageId;return i.default.initAJSDialog({container:t.settings,dialogName:e,dialogId:a,options:{offsetX:-20,width:250,gravity:"n",noBind:!0,addActiveClass:!1},getContent:function(){var e=t.getChartColorLabels(),n=[];return e.forEach((function(e,a){t.lineSettings[e]||(t.lineSettings[e]={type:"solid",width:1.5}),n.push({field:e,value:t.lineSettings[e],variant:i.default.FIELD_VARIANTS.LINE_SETTINGS})})),o().inlineDialog({clazz:"tf-line-settings-dialog",name:"line-settings",inputs:n,dialogId:a})},applyCallback:function(e){t.triggerSettingsButtonInvoke(),t.enableSaveBtn();var a={};e.popup.find("form").find(".field-group").each((function(t,e){var i=$(e),n=i.find("select"),r=n.data("name"),o=n.val(),s=Math.abs(parseFloat(i.find("input").val()||"1.5"));a[r]={type:o,width:s}})),t.lineSettings=a,t.draw()},cancelCallback:function(){t.triggerSettingsButtonInvoke()},hideCallback:function(){t.controls.removeClass("active")}})}};e.default=s}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:9cfa49213778c0043455bbdc8f560626', location = 'build/681.js' */
(self.webpackChunk=self.webpackChunk||[]).push([[681],{42681:function(){(function(){var t,e,s,i,r={}.hasOwnProperty;(i=function(){function t(){this.options_index=0,this.parsed=[]}return t.prototype.add_node=function(t,e){return"OPTGROUP"===t.nodeName.toUpperCase()?this.add_group(t):this.add_option(t,null,null,e)},t.prototype.add_group=function(t){var e,s,i,r,n,o;for(e=this.parsed.length,this.parsed.push({array_index:e,group:!0,label:t.label,title:t.title?t.title:void 0,children:0,disabled:t.disabled,classes:t.className}),o=[],s=0,i=(n=t.childNodes).length;s<i;s++)r=n[s],o.push(this.add_option(r,e,t.disabled));return o},t.prototype.add_option=function(t,e,s,i){if("OPTION"===t.nodeName.toUpperCase())return null!=e&&(this.parsed[e].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:t.value,text:t.text,html:i?t.text:t.innerHTML,title:t.title?t.title:void 0,selected:t.selected,disabled:!0===s?s:t.disabled,group_array_index:e,group_label:null!=e?this.parsed[e].label:null,classes:t.className,style:t.style.cssText}),this.options_index+=1},t}()).select_to_array=function(t,e){var s,r,n,o,h;for(o=new i,r=0,n=(h=t.childNodes).length;r<n;r++)s=h[r],o.add_node(s,e);return o.parsed},e=function(){function t(e,s){this.form_field=e,this.options=null!=s?s:{},this.label_click_handler=function(t,e){return function(){return t.apply(e,arguments)}}(this.label_click_handler,this),t.browser_is_supported()&&(this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers(),this.on_ready())}return t.prototype.set_default_values=function(){return this.click_test_action=function(t){return function(e){return t.test_active_click(e)}}(this),this.activate_action=function(t){return function(e){return t.activate_field(e)}}(this),this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.is_rtl=this.options.rtl||/\bchosen-rtl\b/.test(this.form_field.className),this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text&&this.options.allow_single_deselect,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null==this.options.enable_split_word_search||this.options.enable_split_word_search,this.group_search=null==this.options.group_search||this.options.group_search,this.search_contains=this.options.search_contains||!1,this.single_backstroke_delete=null==this.options.single_backstroke_delete||this.options.single_backstroke_delete,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1,this.display_selected_options=null==this.options.display_selected_options||this.options.display_selected_options,this.display_disabled_options=null==this.options.display_disabled_options||this.options.display_disabled_options,this.include_group_label_in_selected=this.options.include_group_label_in_selected||!1,this.max_shown_results=this.options.max_shown_results||Number.POSITIVE_INFINITY,this.case_sensitive_search=this.options.case_sensitive_search||!1,this.hide_results_on_select=null==this.options.hide_results_on_select||this.options.hide_results_on_select},t.prototype.set_default_text=function(){return this.form_field.getAttribute("data-placeholder")?this.default_text=this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.default_text=this.options.placeholder_text_multiple||this.options.placeholder_text||t.default_multiple_text:this.default_text=this.options.placeholder_text_single||this.options.placeholder_text||t.default_single_text,this.default_text=this.escape_html(this.default_text),this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||t.default_no_result_text},t.prototype.choice_label=function(t){return this.include_group_label_in_selected&&null!=t.group_label?"<b class='group-name'>"+this.escape_html(t.group_label)+"</b>"+t.html:t.html},t.prototype.mouse_enter=function(){return this.mouse_on_container=!0},t.prototype.mouse_leave=function(){return this.mouse_on_container=!1},t.prototype.input_focus=function(t){if(this.is_multiple){if(!this.active_field)return setTimeout(function(t){return function(){return t.container_mousedown()}}(this),50)}else if(!this.active_field)return this.activate_field()},t.prototype.input_blur=function(t){if(!this.mouse_on_container)return this.active_field=!1,setTimeout(function(t){return function(){return t.blur_test()}}(this),100)},t.prototype.label_click_handler=function(t){return this.is_multiple?this.container_mousedown(t):this.activate_field()},t.prototype.results_option_build=function(t){var e,s,i,r,n,o,h;for(e="",h=0,r=0,n=(o=this.results_data).length;r<n&&("",""!==(i=(s=o[r]).group?this.result_add_group(s):this.result_add_option(s))&&(h++,e+=i),(null!=t?t.first:void 0)&&(s.selected&&this.is_multiple?this.choice_build(s):s.selected&&!this.is_multiple&&this.single_set_selected_text(this.choice_label(s))),!(h>=this.max_shown_results));r++);return e},t.prototype.result_add_option=function(t){var e,s;return t.search_match&&this.include_option_in_results(t)?(e=[],t.disabled||t.selected&&this.is_multiple||e.push("active-result"),!t.disabled||t.selected&&this.is_multiple||e.push("disabled-result"),t.selected&&e.push("result-selected"),null!=t.group_array_index&&e.push("group-option"),""!==t.classes&&e.push(t.classes),(s=document.createElement("li")).className=e.join(" "),t.style&&(s.style.cssText=t.style),s.setAttribute("data-option-array-index",t.array_index),s.innerHTML=t.highlighted_html||t.html,t.title&&(s.title=t.title),this.outerHTML(s)):""},t.prototype.result_add_group=function(t){var e,s;return(t.search_match||t.group_match)&&t.active_options>0?((e=[]).push("group-result"),t.classes&&e.push(t.classes),(s=document.createElement("li")).className=e.join(" "),s.innerHTML=t.highlighted_html||this.escape_html(t.label),t.title&&(s.title=t.title),this.outerHTML(s)):""},t.prototype.results_update_field=function(){if(this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.results_build(),this.results_showing)return this.winnow_results()},t.prototype.reset_single_select_options=function(){var t,e,s,i,r;for(r=[],t=0,e=(s=this.results_data).length;t<e;t++)(i=s[t]).selected?r.push(i.selected=!1):r.push(void 0);return r},t.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},t.prototype.results_search=function(t){return this.results_showing?this.winnow_results():this.results_show()},t.prototype.winnow_results=function(t){var e,s,i,r,n,o,h,l,c,_,a,u,d,p,f;for(this.no_results_clear(),_=0,e=(h=this.get_search_text()).replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),c=this.get_search_regex(e),i=0,r=(l=this.results_data).length;i<r;i++)(n=l[i]).search_match=!1,a=null,u=null,n.highlighted_html="",this.include_option_in_results(n)&&(n.group&&(n.group_match=!1,n.active_options=0),null!=n.group_array_index&&this.results_data[n.group_array_index]&&(0===(a=this.results_data[n.group_array_index]).active_options&&a.search_match&&(_+=1),a.active_options+=1),f=n.group?n.label:n.text,n.group&&!this.group_search||(u=this.search_string_match(f,c),n.search_match=null!=u,n.search_match&&!n.group&&(_+=1),n.search_match?(h.length&&(d=u.index,o=f.slice(0,d),s=f.slice(d,d+h.length),p=f.slice(d+h.length),n.highlighted_html=this.escape_html(o)+"<em>"+this.escape_html(s)+"</em>"+this.escape_html(p)),null!=a&&(a.group_match=!0)):null!=n.group_array_index&&this.results_data[n.group_array_index].search_match&&(n.search_match=!0)));return this.result_clear_highlight(),_<1&&h.length?(this.update_results_content(""),this.no_results(h)):(this.update_results_content(this.results_option_build()),(null!=t?t.skip_highlight:void 0)?void 0:this.winnow_results_set_highlight())},t.prototype.get_search_regex=function(t){var e,s;return s=this.search_contains?t:"(^|\\s|\\b)"+t+"[^\\s]*",this.enable_split_word_search||this.search_contains||(s="^"+s),e=this.case_sensitive_search?"":"i",new RegExp(s,e)},t.prototype.search_string_match=function(t,e){var s;return s=e.exec(t),!this.search_contains&&(null!=s?s[1]:void 0)&&(s.index+=1),s},t.prototype.choices_count=function(){var t,e,s;if(null!=this.selected_option_count)return this.selected_option_count;for(this.selected_option_count=0,t=0,e=(s=this.form_field.options).length;t<e;t++)s[t].selected&&(this.selected_option_count+=1);return this.selected_option_count},t.prototype.choices_click=function(t){if(t.preventDefault(),this.activate_field(),!this.results_showing&&!this.is_disabled)return this.results_show()},t.prototype.keydown_checker=function(t){var e,s;switch(s=null!=(e=t.which)?e:t.keyCode,this.search_field_scale(),8!==s&&this.pending_backstroke&&this.clear_backstroke(),s){case 8:this.backstroke_length=this.get_search_field_value().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(t),this.mouse_on_container=!1;break;case 13:this.results_showing&&(t.stopPropagation(),t.preventDefault());break;case 27:this.results_showing&&t.preventDefault();break;case 32:this.disable_search&&t.preventDefault();break;case 38:t.preventDefault(),this.keyup_arrow();break;case 40:t.preventDefault(),this.keydown_arrow()}},t.prototype.keyup_checker=function(t){var e,s;switch(s=null!=(e=t.which)?e:t.keyCode,this.search_field_scale(),s){case 8:this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0?this.keydown_backstroke():this.pending_backstroke||(this.result_clear_highlight(),this.results_search());break;case 13:t.preventDefault(),this.results_showing&&this.result_select(t);break;case 27:this.results_showing&&this.results_hide();break;case 9:case 16:case 17:case 18:case 38:case 40:case 91:break;default:this.results_search()}},t.prototype.clipboard_event_checker=function(t){if(!this.is_disabled)return setTimeout(function(t){return function(){return t.results_search()}}(this),50)},t.prototype.container_width=function(){return null!=this.options.width?this.options.width:this.form_field.offsetWidth+"px"},t.prototype.include_option_in_results=function(t){return!(this.is_multiple&&!this.display_selected_options&&t.selected||!this.display_disabled_options&&t.disabled||t.empty)},t.prototype.search_results_touchstart=function(t){return this.touch_started=!0,this.search_results_mouseover(t)},t.prototype.search_results_touchmove=function(t){return this.touch_started=!1,this.search_results_mouseout(t)},t.prototype.search_results_touchend=function(t){if(this.touch_started)return this.search_results_mouseup(t)},t.prototype.outerHTML=function(t){var e;return t.outerHTML?t.outerHTML:((e=document.createElement("div")).appendChild(t),e.innerHTML)},t.prototype.get_single_html=function(){return'<div class="chosen-single chosen-default">\n  <span>'+this.default_text+'</span>\n  <div><b></b></div>\n</div>\n<div class="chosen-drop">\n  <div class="chosen-search">\n    <input class="chosen-search-input" type="text" autocomplete="off" />\n  </div>\n  <ul class="chosen-results"></ul>\n</div>'},t.prototype.get_multi_html=function(){return'<ul class="chosen-choices">\n  <li class="search-field">\n    <input class="chosen-search-input" type="text" autocomplete="off" placeholder="'+this.default_text+'"/>\n  </li>\n</ul>\n<div class="chosen-drop">\n  <ul class="chosen-results"></ul>\n</div>'},t.prototype.get_no_results_html=function(t){return'<li class="no-results">\n  '+this.results_none_found+" <span>"+this.escape_html(t)+"</span>\n</li>"},t.browser_is_supported=function(){return"Microsoft Internet Explorer"!==window.navigator.appName||document.documentMode>=8},t.default_multiple_text="Select Some Options",t.default_single_text="Select an Option",t.default_no_result_text="No results match",t}(),(t=jQuery).fn.extend({chosenTF:function(i){return e.browser_is_supported()?this.each((function(e){var r,n;n=(r=t(this)).data("chosen"),"destroy"!==i?n instanceof s||r.data("chosen",new s(this,i)):n instanceof s&&n.destroy()})):this}}),s=function(s){function n(){return n.__super__.constructor.apply(this,arguments)}return function(t,e){function s(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype}(n,e),n.prototype.setup=function(){return this.form_field_jq=t(this.form_field),this.current_selectedIndex=this.form_field.selectedIndex},n.prototype.set_up_html=function(){var e,s;return(e=["chosen-container"]).push("chosen-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&e.push(this.form_field.className),this.is_rtl&&e.push("chosen-rtl"),s={class:e.join(" "),title:this.form_field.title},this.form_field.id.length&&(s.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen"),this.container=t("<div />",s),this.container.width(this.container_width()),this.is_multiple?this.container.html(this.get_multi_html()):this.container.html(this.get_single_html()),this.form_field_jq.hide().after(this.container),this.dropdown=this.container.find("div.chosen-drop").first(),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chosen-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chosen-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chosen-search").first(),this.selected_item=this.container.find(".chosen-single").first()),this.results_build(),this.set_tab_index(),this.set_label_behavior()},n.prototype.on_ready=function(){return this.form_field_jq.trigger("chosen:ready",{chosen:this})},n.prototype.register_observers=function(){return this.container.on("touchstart.chosen",function(t){return function(e){t.container_mousedown(e)}}(this)),this.container.on("touchend.chosen",function(t){return function(e){t.container_mouseup(e)}}(this)),this.container.on("mousedown.chosen",function(t){return function(e){t.container_mousedown(e)}}(this)),this.container.on("mouseup.chosen",function(t){return function(e){t.container_mouseup(e)}}(this)),this.container.on("mouseenter.chosen",function(t){return function(e){t.mouse_enter(e)}}(this)),this.container.on("mouseleave.chosen",function(t){return function(e){t.mouse_leave(e)}}(this)),this.search_results.on("mouseup.chosen",function(t){return function(e){t.search_results_mouseup(e)}}(this)),this.search_results.on("mouseover.chosen",function(t){return function(e){t.search_results_mouseover(e)}}(this)),this.search_results.on("mouseout.chosen",function(t){return function(e){t.search_results_mouseout(e)}}(this)),this.search_results.on("mousewheel.chosen DOMMouseScroll.chosen",function(t){return function(e){t.search_results_mousewheel(e)}}(this)),this.search_results.on("touchstart.chosen",function(t){return function(e){t.search_results_touchstart(e)}}(this)),this.search_results.on("touchmove.chosen",function(t){return function(e){t.search_results_touchmove(e)}}(this)),this.search_results.on("touchend.chosen",function(t){return function(e){t.search_results_touchend(e)}}(this)),this.form_field_jq.on("chosen:updated.chosen",function(t){return function(e){t.results_update_field(e)}}(this)),this.form_field_jq.on("chosen:activate.chosen",function(t){return function(e){t.activate_field(e)}}(this)),this.form_field_jq.on("chosen:open.chosen",function(t){return function(e){t.container_mousedown(e)}}(this)),this.form_field_jq.on("chosen:close.chosen",function(t){return function(e){t.close_field(e)}}(this)),this.search_field.on("blur.chosen",function(t){return function(e){t.input_blur(e)}}(this)),this.search_field.on("keyup.chosen",function(t){return function(e){t.keyup_checker(e)}}(this)),this.search_field.on("keydown.chosen",function(t){return function(e){t.keydown_checker(e)}}(this)),this.search_field.on("focus.chosen",function(t){return function(e){t.input_focus(e)}}(this)),this.search_field.on("cut.chosen",function(t){return function(e){t.clipboard_event_checker(e)}}(this)),this.search_field.on("paste.chosen",function(t){return function(e){t.clipboard_event_checker(e)}}(this)),this.is_multiple?this.search_choices.on("click.chosen",function(t){return function(e){t.choices_click(e)}}(this)):this.container.on("click.chosen",(function(t){t.preventDefault()}))},n.prototype.destroy=function(){return t(this.container[0].ownerDocument).off("click.chosen",this.click_test_action),this.form_field_label.length>0&&this.form_field_label.off("click.chosen"),this.search_field[0].tabIndex&&(this.form_field_jq[0].tabIndex=this.search_field[0].tabIndex),this.container.remove(),this.form_field_jq.removeData("chosen"),this.form_field_jq.show()},n.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field.disabled||this.form_field_jq.parents("fieldset").is(":disabled"),this.container.toggleClass("chosen-disabled",this.is_disabled),this.search_field[0].disabled=this.is_disabled,this.is_multiple||this.selected_item.off("focus.chosen",this.activate_field),this.is_disabled?this.close_field():this.is_multiple?void 0:this.selected_item.on("focus.chosen",this.activate_field)},n.prototype.container_mousedown=function(e){var s;if(!this.is_disabled)return!e||"mousedown"!==(s=e.type)&&"touchstart"!==s||this.results_showing||e.preventDefault(),null!=e&&t(e.target).hasClass("ui-resizable-handle")?this.results_hide():null!=e&&t(e.target).hasClass("search-choice-close")?void 0:(this.active_field?this.is_multiple||!e||t(e.target)[0]!==this.selected_item[0]&&!t(e.target).parents("div.chosen-single").length||(e.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),t(this.container[0].ownerDocument).on("click.chosen",this.click_test_action),this.results_show()),this.activate_field())},n.prototype.container_mouseup=function(t){if("ABBR"===t.target.nodeName&&!this.is_disabled)return this.results_reset(t)},n.prototype.search_results_mousewheel=function(t){var e;if(t.originalEvent&&(e=t.originalEvent.deltaY||-t.originalEvent.wheelDelta||t.originalEvent.detail),null!=e)return t.preventDefault(),"DOMMouseScroll"===t.type&&(e*=40),this.search_results.scrollTop(e+this.search_results.scrollTop())},n.prototype.blur_test=function(t){if(!this.active_field&&this.container.hasClass("chosen-container-active"))return this.close_field()},n.prototype.close_field=function(){return t(this.container[0].ownerDocument).off("click.chosen",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClass("chosen-container-active"),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale(),this.search_field.blur()},n.prototype.activate_field=function(){if(!this.is_disabled)return this.container.addClass("chosen-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},n.prototype.test_active_click=function(e){var s;return(s=t(e.target).closest(".chosen-container")).length&&this.container[0]===s[0]?this.active_field=!0:this.close_field()},n.prototype.results_build=function(){return this.parsing=!0,this.selected_option_count=null,this.results_data=i.select_to_array(this.form_field,this.options.isHtml),this.is_multiple?this.search_choices.find("li.search-choice").remove():(this.single_set_selected_text(),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?(this.search_field[0].readOnly=!0,this.container.addClass("chosen-container-single-nosearch")):(this.search_field[0].readOnly=!1,this.container.removeClass("chosen-container-single-nosearch"))),this.update_results_content(this.results_option_build({first:!0})),this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.parsing=!1},n.prototype.result_do_highlight=function(t){var e,s,i,r,n;if(t.length){if(this.result_clear_highlight(),this.result_highlight=t,this.result_highlight.addClass("highlighted"),r=(i=parseInt(this.search_results.css("maxHeight"),10))+(n=this.search_results.scrollTop()),(e=(s=this.result_highlight.position().top+this.search_results.scrollTop())+this.result_highlight.outerHeight())>=r)return this.search_results.scrollTop(e-i>0?e-i:0);if(s<n)return this.search_results.scrollTop(s)}},n.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},n.prototype.results_show=function(){return this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.container.addClass("chosen-with-drop"),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.get_search_field_value()),this.winnow_results(),this.form_field_jq.trigger("chosen:showing_dropdown",{chosen:this}))},n.prototype.update_results_content=function(t){return this.search_results.html(t)},n.prototype.results_hide=function(){return this.results_showing&&(this.result_clear_highlight(),this.container.removeClass("chosen-with-drop"),this.form_field_jq.trigger("chosen:hiding_dropdown",{chosen:this})),this.results_showing=!1},n.prototype.set_tab_index=function(t){var e;if(this.form_field.tabIndex)return e=this.form_field.tabIndex,this.form_field.tabIndex=-1,this.search_field[0].tabIndex=e},n.prototype.set_label_behavior=function(){if(this.form_field_label=this.form_field_jq.parents("label"),!this.form_field_label.length&&this.form_field.id.length&&(this.form_field_label=t("label[for='"+this.form_field.id+"']")),this.form_field_label.length>0)return this.form_field_label.on("click.chosen",this.label_click_handler)},n.prototype.show_search_field_default=function(){return this.search_field.val(""),this.is_multiple&&this.choices_count()<1&&!this.active_field?(this.search_field.attr("placeholder",this.default_text),this.search_field.addClass("default")):(this.search_field.attr("placeholder",""),this.search_field.removeClass("default"))},n.prototype.search_results_mouseup=function(e){var s;if((s=t(e.target).hasClass("active-result")?t(e.target):t(e.target).parents(".active-result").first()).length)return this.result_highlight=s,this.result_select(e),this.search_field.focus()},n.prototype.search_results_mouseover=function(e){var s;if(s=t(e.target).hasClass("active-result")?t(e.target):t(e.target).parents(".active-result").first())return this.result_do_highlight(s)},n.prototype.search_results_mouseout=function(e){if(t(e.target).hasClass("active-result")||t(e.target).parents(".active-result").first())return this.result_clear_highlight()},n.prototype.choice_build=function(e){var s,i;return(s=t("<li />",{class:"search-choice"}).html("<span>"+this.choice_label(e)+"</span>")).css("max-width",this.container.width()>100?this.container.width()-40:""),e.disabled?s.addClass("search-choice-disabled"):((i=t("<span />",{class:"search-choice-close","data-option-array-index":e.array_index})).on("click.chosen",function(t){return function(e){return t.choice_destroy_link_click(e)}}(this)),s.append(i)),this.search_container.before(s)},n.prototype.choice_destroy_link_click=function(e){if(e.preventDefault(),e.stopPropagation(),!this.is_disabled)return this.choice_destroy(t(e.target))},n.prototype.choice_destroy=function(t){if(0===t.length&&(t=this.pending_backstroke.find(".search-choice-close")),this.result_deselect(t[0].getAttribute("data-option-array-index")))return this.active_field?this.search_field.focus():this.show_search_field_default(),this.is_multiple&&this.choices_count()>0&&this.get_search_field_value().length<1&&this.results_hide(),t.parents("li").first().remove(),this.search_field_scale()},n.prototype.results_reset=function(){if(this.reset_single_select_options(),this.form_field.options[0].selected=!0,this.single_set_selected_text(),this.show_search_field_default(),this.results_reset_cleanup(),this.trigger_form_field_change(),this.active_field)return this.results_hide()},n.prototype.results_reset_cleanup=function(){return this.current_selectedIndex=this.form_field.selectedIndex,this.selected_item.find("abbr").remove()},n.prototype.result_select=function(e){var s,i,r,n,o;if(this.result_highlight)return i=this.result_highlight,this.result_clear_highlight(),this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.is_multiple?i.removeClass("active-result"):this.reset_single_select_options(),i.addClass("result-selected"),(r=this.results_data[i[0].getAttribute("data-option-array-index")]).selected=!0,this.form_field.options[r.options_index].selected=!0,this.selected_option_count=null,this.is_multiple?this.choice_build(r):this.single_set_selected_text(this.choice_label(r)),this.is_multiple&&(!this.hide_results_on_select||e.metaKey||e.ctrlKey)?e.metaKey||e.ctrlKey?this.winnow_results({skip_highlight:!0}):(this.search_field.val(""),this.winnow_results()):(this.results_hide(),this.show_search_field_default()),(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex)&&this.trigger_form_field_change({selected:this.form_field.options[r.options_index].value}),this.current_selectedIndex=this.form_field.selectedIndex,e.preventDefault(),this.search_field_scale());this.options.addUserOption&&(o=this.search_field.val(),s=!1,this.results_data.some((function(t){if(t.text===o)return s=!0,!0})),s||(n=t('<option selected="selected"></option>').attr("value",o).text(o),this.form_field_jq.append(n).trigger("change",{selected:o}).trigger("chosen:updated")))},n.prototype.single_set_selected_text=function(t){return null==t&&(t=this.default_text),t===this.default_text?this.selected_item.addClass("chosen-default"):(this.single_deselect_control_build(),this.selected_item.removeClass("chosen-default")),this.selected_item.find("span").html(t)},n.prototype.result_deselect=function(t){var e;return e=this.results_data[t],!this.form_field.options[e.options_index].disabled&&(e.selected=!1,this.form_field.options[e.options_index].selected=!1,this.selected_option_count=null,this.result_clear_highlight(),this.results_showing&&this.winnow_results(),this.trigger_form_field_change({deselected:this.form_field.options[e.options_index].value}),this.search_field_scale(),!0)},n.prototype.single_deselect_control_build=function(){if(this.allow_single_deselect)return this.selected_item.find("abbr").length||this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'),this.selected_item.addClass("chosen-single-with-deselect")},n.prototype.get_search_field_value=function(){return this.search_field.val()},n.prototype.get_search_text=function(){return t.trim(this.get_search_field_value())},n.prototype.escape_html=function(e){return t("<div/>").text(e).html()},n.prototype.winnow_results_set_highlight=function(){var t,e;if(null!=(t=(e=this.is_multiple?[]:this.search_results.find(".result-selected.active-result")).length?e.first():this.search_results.find(".active-result").first()))return this.result_do_highlight(t)},n.prototype.no_results=function(e){var s,i;return s=t(this.get_no_results_html(e)),this.search_results.append(s),this.options.addUserOption&&(i=this,s.addClass("add-user-option").click((function(){i.result_select()}))),this.form_field_jq.trigger("chosen:no_results",{chosen:this})},n.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},n.prototype.keydown_arrow=function(){var t;return this.results_showing&&this.result_highlight?(t=this.result_highlight.nextAll("li.active-result").first())?this.result_do_highlight(t):void 0:this.results_show()},n.prototype.keyup_arrow=function(){var t;return this.results_showing||this.is_multiple?this.result_highlight?(t=this.result_highlight.prevAll("li.active-result")).length?this.result_do_highlight(t.first()):(this.choices_count()>0&&this.results_hide(),this.result_clear_highlight()):void 0:this.results_show()},n.prototype.keydown_backstroke=function(){var t;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(t=this.search_container.siblings("li.search-choice").last()).length&&!t.hasClass("search-choice-disabled")?(this.pending_backstroke=t,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0},n.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},n.prototype.search_field_scale=function(){var e,s,i,r,n,o,h;if(this.is_multiple){if(h=25,this.search_field.attr("placeholder")||this.get_search_field_value()){for(n={position:"absolute",left:"-1000px",top:"-1000px",display:"none",whiteSpace:"pre"},s=0,i=(o=["fontSize","fontStyle","fontWeight","fontFamily","lineHeight","textTransform","letterSpacing"]).length;s<i;s++)n[r=o[s]]=this.search_field.css(r);(e=t("<div />").css(n)).text(this.search_field.attr("placeholder")||this.get_search_field_value()),t("body").append(e),h+=e.width(),e.remove()}return this.container.is(":visible")&&(h=Math.min(this.container.outerWidth()-10,h)),this.search_field.width(h)}},n.prototype.trigger_form_field_change=function(t){return this.form_field_jq.trigger("input",t),this.form_field_jq.trigger("change",t)},n}()}).call(this)}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:bb7e7be2f8012100524eff41703cc3b9', location = 'build/639.js' */
(self.webpackChunk=self.webpackChunk||[]).push([[639],{62750:function(t,n,e){t.exports=e(62749)},27566:function(t,n,e){t.exports=e(78726)},13567:function(t,n,e){t.exports=e(62033)},67563:function(t,n,e){t.exports=e(12451)},54884:function(t,n,e){t.exports=e(71232)},9456:function(t,n,e){t.exports=e(21075)},76222:function(t,n,e){t.exports=e(10938)},61799:function(t,n,e){t.exports=e(77572)},5996:function(t,n,e){t.exports=e(83497)},33591:function(t,n,e){t.exports=e(26202)},97539:function(t,n,e){t.exports=e(69238)},51463:function(t,n,e){t.exports=e(79937)},65575:function(t,n,e){t.exports=e(64263)},97965:function(t,n,e){t.exports=e(5832)},17349:function(t,n,e){t.exports=e(54023)},45285:function(t,n,e){t.exports=e(11294)},69236:function(t,n,e){t.exports=e(66457)},34682:function(t,n,e){t.exports=e(63156)},18737:function(t,n,e){t.exports=e(11214)},12625:function(t,n,e){t.exports=e(91160)},3434:function(t,n,e){t.exports=e(81467)},97828:function(t,n,e){t.exports=e(67581)},26117:function(t,n,e){t.exports=e(69276)},20658:function(t,n,e){t.exports=e(68982)},39831:function(t,n,e){t.exports=e(94541)},20246:function(t,n,e){t.exports=e(22130)},52069:function(t,n,e){t.exports=e(15589)},36800:function(t,n,e){t.exports=e(24222)},71722:function(t,n,e){t.exports=e(40166)},94235:function(t,n,e){t.exports=e(34057)},13345:function(t,n,e){t.exports=e(97253)},82377:function(t,n,e){t.exports=e(37524)},61240:function(t,n,e){t.exports=e(80101)},29286:function(t,n,e){t.exports=e(3543)},61097:function(t,n,e){t.exports=e(99763)},28945:function(t,n,e){t.exports=e(50655)},59526:function(t,n,e){t.exports=e(137)},20678:function(t,n,e){t.exports=e(22685)},64361:function(t,n,e){t.exports=e(88148)},35325:function(t,n,e){t.exports=e(24720)},82714:function(t,n,e){t.exports=e(52507)},99741:function(t,n,e){t.exports=e(5591)},23659:function(t,n,e){t.exports=e(2077)},7886:function(t,n,e){t.exports=e(86500)},69750:function(t,n,e){t.exports=e(83432)},47797:function(t,n,e){t.exports=e(975)},27323:function(t,n,e){t.exports=e(66866)},42315:function(t,n,e){t.exports=e(16598)},96111:function(t,n,e){t.exports=e(98805)},89053:function(t){t.exports=function(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}},30560:function(t,n,e){var r=e(28945);t.exports=function(t){if(r(t))return t}},17605:function(t,n,e){var r=e(28945),i=e(89053);t.exports=function(t){if(r(t))return i(t)}},23895:function(t){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},75411:function(t,n,e){var r=e(47797);function i(t,n,e,i,o,a,u){try{var c=t[a](u),f=c.value}catch(t){return void e(t)}c.done?n(f):r.resolve(f).then(i,o)}t.exports=function(t){return function(){var n=this,e=arguments;return new r((function(r,o){var a=t.apply(n,e);function u(t){i(a,r,o,u,c,"next",t)}function c(t){i(a,r,o,u,c,"throw",t)}u(void 0)}))}}},96537:function(t){t.exports=function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}},29888:function(t,n,e){var r=e(99741);function i(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),r(t,i.key,i)}}t.exports=function(t,n,e){return n&&i(t.prototype,n),e&&i(t,e),t}},61985:function(t,n,e){var r=e(99741);t.exports=function(t,n,e){return n in t?r(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}},56778:function(t,n,e){var r=e(23659),i=e(27323),o=e(94905);function a(n,e,u){return"undefined"!=typeof Reflect&&i?t.exports=a=i:t.exports=a=function(t,n,e){var i=o(t,n);if(i){var a=r(i,n);return a.get?a.get.call(e):a.value}},a(n,e,u||n)}t.exports=a},44097:function(t,n,e){var r=e(7886),i=e(69750);function o(n){return t.exports=o=i?r:function(t){return t.__proto__||r(t)},o(n)}t.exports=o},23262:function(t,n,e){var r=e(82714),i=e(19148);t.exports=function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=r(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&i(t,n)}},24409:function(t,n,e){var r=e(61097),i=e(35325),o=e(42315);t.exports=function(t){if(void 0!==o&&i(Object(t)))return r(t)}},34465:function(t,n,e){var r=e(20678),i=e(35325),o=e(42315);t.exports=function(t,n){if(void 0!==o&&i(Object(t))){var e=[],a=!0,u=!1,c=void 0;try{for(var f,s=r(t);!(a=(f=s.next()).done)&&(e.push(f.value),!n||e.length!==n);a=!0);}catch(t){u=!0,c=t}finally{try{a||null==s.return||s.return()}finally{if(u)throw c}}return e}}},58991:function(t){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},76890:function(t){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},13248:function(t,n,e){var r=e(97749),i=e(23895);t.exports=function(t,n){return!n||"object"!==r(n)&&"function"!=typeof n?i(t):n}},19148:function(t,n,e){var r=e(69750);function i(n,e){return t.exports=i=r||function(t,n){return t.__proto__=n,t},i(n,e)}t.exports=i},82668:function(t,n,e){var r=e(30560),i=e(34465),o=e(76910),a=e(58991);t.exports=function(t,n){return r(t)||i(t,n)||o(t,n)||a()}},94905:function(t,n,e){var r=e(44097);t.exports=function(t,n){for(;!Object.prototype.hasOwnProperty.call(t,n)&&null!==(t=r(t)););return t}},84030:function(t,n,e){var r=e(17605),i=e(24409),o=e(76910),a=e(76890);t.exports=function(t){return r(t)||i(t)||o(t)||a()}},97749:function(t,n,e){var r=e(96111),i=e(42315);function o(n){return t.exports=o="function"==typeof i&&"symbol"==typeof r?function(t){return typeof t}:function(t){return t&&"function"==typeof i&&t.constructor===i&&t!==i.prototype?"symbol":typeof t},o(n)}t.exports=o},76910:function(t,n,e){var r=e(61097),i=e(64361),o=e(89053);t.exports=function(t,n){var e;if(t){if("string"==typeof t)return o(t,n);var a=i(e=Object.prototype.toString.call(t)).call(e,8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?r(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?o(t,n):void 0}}},85162:function(t,n,e){t.exports=e(11602)},50593:function(t,n,e){"use strict";e.r(n),e.d(n,{default:function(){return bt}});var r="$";function i(){}function o(t,n){var e=new i;if(t instanceof i)t.each((function(t,n){e.set(n,t)}));else if(Array.isArray(t)){var r,o=-1,a=t.length;if(null==n)for(;++o<a;)e.set(o,t[o]);else for(;++o<a;)e.set(n(r=t[o],o,t),r)}else if(t)for(var u in t)e.set(u,t[u]);return e}i.prototype=o.prototype={constructor:i,has:function(t){return r+t in this},get:function(t){return this[r+t]},set:function(t,n){return this[r+t]=n,this},remove:function(t){var n=r+t;return n in this&&delete this[n]},clear:function(){for(var t in this)t[0]===r&&delete this[t]},keys:function(){var t=[];for(var n in this)n[0]===r&&t.push(n.slice(1));return t},values:function(){var t=[];for(var n in this)n[0]===r&&t.push(this[n]);return t},entries:function(){var t=[];for(var n in this)n[0]===r&&t.push({key:n.slice(1),value:this[n]});return t},size:function(){var t=0;for(var n in this)n[0]===r&&++t;return t},empty:function(){for(var t in this)if(t[0]===r)return!1;return!0},each:function(t){for(var n in this)n[0]===r&&t(this[n],n.slice(1),this)}};var a=o;function u(){}var c=a.prototype;function f(t,n){var e=new u;if(t instanceof u)t.each((function(t){e.add(t)}));else if(t){var r=-1,i=t.length;if(null==n)for(;++r<i;)e.add(t[r]);else for(;++r<i;)e.add(n(t[r],r,t))}return e}u.prototype=f.prototype={constructor:u,has:c.has,add:function(t){return this[r+(t+="")]=t,this},remove:c.remove,clear:c.clear,values:c.keys,size:c.size,empty:c.empty,each:c.each};function s(){}function l(t){return null==t?s:function(){return this.querySelector(t)}}function h(){return[]}function d(t){return new Array(t.length)}function p(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}p.prototype={constructor:p,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function y(t,n,e,r,i,o){for(var a,u=0,c=n.length,f=o.length;u<f;++u)(a=n[u])?(a.__data__=o[u],r[u]=a):e[u]=new p(t,o[u]);for(;u<c;++u)(a=n[u])&&(i[u]=a)}function v(t,n,e,r,i,o,a){var u,c,f,s={},l=n.length,h=o.length,d=new Array(l);for(u=0;u<l;++u)(c=n[u])&&(d[u]=f="$"+a.call(c,c.__data__,u,n),f in s?i[u]=c:s[f]=c);for(u=0;u<h;++u)(c=s[f="$"+a.call(t,o[u],u,o)])?(r[u]=c,c.__data__=o[u],s[f]=null):e[u]=new p(t,o[u]);for(u=0;u<l;++u)(c=n[u])&&s[d[u]]===c&&(i[u]=c)}function g(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}var m="http://www.w3.org/1999/xhtml",b={svg:"http://www.w3.org/2000/svg",xhtml:m,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function x(t){var n=t+="",e=n.indexOf(":");return e>=0&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),b.hasOwnProperty(n)?{space:b[n],local:t}:t}function _(t){return function(){this.removeAttribute(t)}}function w(t){return function(){this.removeAttributeNS(t.space,t.local)}}function S(t,n){return function(){this.setAttribute(t,n)}}function A(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}function M(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttribute(t):this.setAttribute(t,e)}}function k(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}}function T(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function E(t){return function(){this.style.removeProperty(t)}}function C(t,n,e){return function(){this.style.setProperty(t,n,e)}}function O(t,n,e){return function(){var r=n.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,e)}}function P(t,n){return t.style.getPropertyValue(n)||T(t).getComputedStyle(t,null).getPropertyValue(n)}function N(t){return function(){delete this[t]}}function I(t,n){return function(){this[t]=n}}function R(t,n){return function(){var e=n.apply(this,arguments);null==e?delete this[t]:this[t]=e}}function D(t){return t.trim().split(/^|\s+/)}function j(t){return t.classList||new z(t)}function z(t){this._node=t,this._names=D(t.getAttribute("class")||"")}function V(t,n){for(var e=j(t),r=-1,i=n.length;++r<i;)e.add(n[r])}function L(t,n){for(var e=j(t),r=-1,i=n.length;++r<i;)e.remove(n[r])}function U(t){return function(){V(this,t)}}function F(t){return function(){L(this,t)}}function B(t,n){return function(){(n.apply(this,arguments)?V:L)(this,t)}}function H(){this.textContent=""}function q(t){return function(){this.textContent=t}}function Y(t){return function(){var n=t.apply(this,arguments);this.textContent=null==n?"":n}}function X(){this.innerHTML=""}function $(t){return function(){this.innerHTML=t}}function W(t){return function(){var n=t.apply(this,arguments);this.innerHTML=null==n?"":n}}function G(){this.nextSibling&&this.parentNode.appendChild(this)}function Q(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Z(t){return function(){var n=this.ownerDocument,e=this.namespaceURI;return e===m&&n.documentElement.namespaceURI===m?n.createElement(t):n.createElementNS(e,t)}}function K(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function J(t){var n=x(t);return(n.local?K:Z)(n)}function tt(){return null}function nt(){var t=this.parentNode;t&&t.removeChild(this)}function et(){var t=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function rt(){var t=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}z.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var n=this._names.indexOf(t);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var it={},ot=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(it={mouseenter:"mouseover",mouseleave:"mouseout"}));function at(t,n,e){return t=ut(t,n,e),function(n){var e=n.relatedTarget;e&&(e===this||8&e.compareDocumentPosition(this))||t.call(this,n)}}function ut(t,n,e){return function(r){var i=ot;ot=r;try{t.call(this,this.__data__,n,e)}finally{ot=i}}}function ct(t){return t.trim().split(/^|\s+/).map((function(t){var n="",e=t.indexOf(".");return e>=0&&(n=t.slice(e+1),t=t.slice(0,e)),{type:t,name:n}}))}function ft(t){return function(){var n=this.__on;if(n){for(var e,r=0,i=-1,o=n.length;r<o;++r)e=n[r],t.type&&e.type!==t.type||e.name!==t.name?n[++i]=e:this.removeEventListener(e.type,e.listener,e.capture);++i?n.length=i:delete this.__on}}}function st(t,n,e){var r=it.hasOwnProperty(t.type)?at:ut;return function(i,o,a){var u,c=this.__on,f=r(n,o,a);if(c)for(var s=0,l=c.length;s<l;++s)if((u=c[s]).type===t.type&&u.name===t.name)return this.removeEventListener(u.type,u.listener,u.capture),this.addEventListener(u.type,u.listener=f,u.capture=e),void(u.value=n);this.addEventListener(t.type,f,e),u={type:t.type,name:t.name,value:n,listener:f,capture:e},c?c.push(u):this.__on=[u]}}function lt(t,n,e){var r=T(t),i=r.CustomEvent;"function"==typeof i?i=new i(n,e):(i=r.document.createEvent("Event"),e?(i.initEvent(n,e.bubbles,e.cancelable),i.detail=e.detail):i.initEvent(n,!1,!1)),t.dispatchEvent(i)}function ht(t,n){return function(){return lt(this,t,n)}}function dt(t,n){return function(){return lt(this,t,n.apply(this,arguments))}}var pt=[null];function yt(t,n){this._groups=t,this._parents=n}function vt(){return new yt([[document.documentElement]],pt)}yt.prototype=vt.prototype={constructor:yt,select:function(t){"function"!=typeof t&&(t=l(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,a,u=n[i],c=u.length,f=r[i]=new Array(c),s=0;s<c;++s)(o=u[s])&&(a=t.call(o,o.__data__,s,u))&&("__data__"in o&&(a.__data__=o.__data__),f[s]=a);return new yt(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=function(t){return null==t?h:function(){return this.querySelectorAll(t)}}(t));for(var n=this._groups,e=n.length,r=[],i=[],o=0;o<e;++o)for(var a,u=n[o],c=u.length,f=0;f<c;++f)(a=u[f])&&(r.push(t.call(a,a.__data__,f,u)),i.push(a));return new yt(r,i)},filter:function(t){"function"!=typeof t&&(t=function(t){return function(){return this.matches(t)}}(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,a=n[i],u=a.length,c=r[i]=[],f=0;f<u;++f)(o=a[f])&&t.call(o,o.__data__,f,a)&&c.push(o);return new yt(r,this._parents)},data:function(t,n){if(!t)return p=new Array(this.size()),s=-1,this.each((function(t){p[++s]=t})),p;var e,r=n?v:y,i=this._parents,o=this._groups;"function"!=typeof t&&(e=t,t=function(){return e});for(var a=o.length,u=new Array(a),c=new Array(a),f=new Array(a),s=0;s<a;++s){var l=i[s],h=o[s],d=h.length,p=t.call(l,l&&l.__data__,s,i),g=p.length,m=c[s]=new Array(g),b=u[s]=new Array(g);r(l,h,m,b,f[s]=new Array(d),p,n);for(var x,_,w=0,S=0;w<g;++w)if(x=m[w]){for(w>=S&&(S=w+1);!(_=b[S])&&++S<g;);x._next=_||null}}return(u=new yt(u,i))._enter=c,u._exit=f,u},enter:function(){return new yt(this._enter||this._groups.map(d),this._parents)},exit:function(){return new yt(this._exit||this._groups.map(d),this._parents)},join:function(t,n,e){var r=this.enter(),i=this,o=this.exit();return r="function"==typeof t?t(r):r.append(t+""),null!=n&&(i=n(i)),null==e?o.remove():e(o),r&&i?r.merge(i).order():i},merge:function(t){for(var n=this._groups,e=t._groups,r=n.length,i=e.length,o=Math.min(r,i),a=new Array(r),u=0;u<o;++u)for(var c,f=n[u],s=e[u],l=f.length,h=a[u]=new Array(l),d=0;d<l;++d)(c=f[d]||s[d])&&(h[d]=c);for(;u<r;++u)a[u]=n[u];return new yt(a,this._parents)},order:function(){for(var t=this._groups,n=-1,e=t.length;++n<e;)for(var r,i=t[n],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function n(n,e){return n&&e?t(n.__data__,e.__data__):!n-!e}t||(t=g);for(var e=this._groups,r=e.length,i=new Array(r),o=0;o<r;++o){for(var a,u=e[o],c=u.length,f=i[o]=new Array(c),s=0;s<c;++s)(a=u[s])&&(f[s]=a);f.sort(n)}return new yt(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),n=-1;return this.each((function(){t[++n]=this})),t},node:function(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r=t[n],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var n=this._groups,e=0,r=n.length;e<r;++e)for(var i,o=n[e],a=0,u=o.length;a<u;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,n){var e=x(t);if(arguments.length<2){var r=this.node();return e.local?r.getAttributeNS(e.space,e.local):r.getAttribute(e)}return this.each((null==n?e.local?w:_:"function"==typeof n?e.local?k:M:e.local?A:S)(e,n))},style:function(t,n,e){return arguments.length>1?this.each((null==n?E:"function"==typeof n?O:C)(t,n,null==e?"":e)):P(this.node(),t)},property:function(t,n){return arguments.length>1?this.each((null==n?N:"function"==typeof n?R:I)(t,n)):this.node()[t]},classed:function(t,n){var e=D(t+"");if(arguments.length<2){for(var r=j(this.node()),i=-1,o=e.length;++i<o;)if(!r.contains(e[i]))return!1;return!0}return this.each(("function"==typeof n?B:n?U:F)(e,n))},text:function(t){return arguments.length?this.each(null==t?H:("function"==typeof t?Y:q)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?X:("function"==typeof t?W:$)(t)):this.node().innerHTML},raise:function(){return this.each(G)},lower:function(){return this.each(Q)},append:function(t){var n="function"==typeof t?t:J(t);return this.select((function(){return this.appendChild(n.apply(this,arguments))}))},insert:function(t,n){var e="function"==typeof t?t:J(t),r=null==n?tt:"function"==typeof n?n:l(n);return this.select((function(){return this.insertBefore(e.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(nt)},clone:function(t){return this.select(t?rt:et)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,n,e){var r,i,o=ct(t+""),a=o.length;if(!(arguments.length<2)){for(u=n?st:ft,null==e&&(e=!1),r=0;r<a;++r)this.each(u(o[r],n,e));return this}var u=this.node().__on;if(u)for(var c,f=0,s=u.length;f<s;++f)for(r=0,c=u[f];r<a;++r)if((i=o[r]).type===c.type&&i.name===c.name)return c.value},dispatch:function(t,n){return this.each(("function"==typeof n?dt:ht)(t,n))}};var gt=vt;function mt(t){return"string"==typeof t?new yt([[document.querySelector(t)]],[document.documentElement]):new yt([[t]],pt)}function bt(){var t=function(){return"n"},n=function(){return[0,0]},e=function(){return" "},r=document.body,i=h(),o=null,u=null,c=null;function f(t){var n;n=t.node(),(o=n?"svg"===n.tagName.toLowerCase()?n:n.ownerSVGElement:null)&&(u=o.createSVGPoint(),r.appendChild(i))}f.show=function(){var i=Array.prototype.slice.call(arguments);i[i.length-1]instanceof SVGElement&&(c=i.pop());var o,a=e.apply(this,i),u=n.apply(this,i),h=t.apply(this,i),p=d(),y=l.length,v=document.documentElement.scrollTop||r.scrollTop,g=document.documentElement.scrollLeft||r.scrollLeft;for(p.html(a).style("opacity",1).style("pointer-events","all");y--;)p.classed(l[y],!1);return o=s.get(h).apply(this),p.classed(h,!0).style("top",o.top+u[0]+v+"px").style("left",o.left+u[1]+g+"px"),f},f.hide=function(){return d().style("opacity",0).style("pointer-events","none"),f},f.attr=function(t,n){if(arguments.length<2&&"string"==typeof t)return d().attr(t);var e=Array.prototype.slice.call(arguments);return gt.prototype.attr.apply(d(),e),f},f.style=function(t,n){if(arguments.length<2&&"string"==typeof t)return d().style(t);var e=Array.prototype.slice.call(arguments);return gt.prototype.style.apply(d(),e),f},f.direction=function(n){return arguments.length?(t=null==n?n:y(n),f):t},f.offset=function(t){return arguments.length?(n=null==t?t:y(t),f):n},f.html=function(t){return arguments.length?(e=null==t?t:y(t),f):e},f.rootElement=function(t){return arguments.length?(r=null==t?t:y(t),f):r},f.destroy=function(){return i&&(d().remove(),i=null),f};var s=a({n:function(){var t=p(this);return{top:t.n.y-i.offsetHeight,left:t.n.x-i.offsetWidth/2}},s:function(){var t=p(this);return{top:t.s.y,left:t.s.x-i.offsetWidth/2}},e:function(){var t=p(this);return{top:t.e.y-i.offsetHeight/2,left:t.e.x}},w:function(){var t=p(this);return{top:t.w.y-i.offsetHeight/2,left:t.w.x-i.offsetWidth}},nw:function(){var t=p(this);return{top:t.nw.y-i.offsetHeight,left:t.nw.x-i.offsetWidth}},ne:function(){var t=p(this);return{top:t.ne.y-i.offsetHeight,left:t.ne.x}},sw:function(){var t=p(this);return{top:t.sw.y,left:t.sw.x-i.offsetWidth}},se:function(){var t=p(this);return{top:t.se.y,left:t.se.x}}}),l=s.keys();function h(){var t=mt(document.createElement("div"));return t.style("position","absolute").style("top",0).style("opacity",0).style("pointer-events","none").style("box-sizing","border-box"),t.node()}function d(){return null==i&&(i=h(),r.appendChild(i)),mt(i)}function p(t){for(var n=c||t;null==n.getScreenCTM&&null!=n.parentNode;)n=n.parentNode;var e={},r=n.getScreenCTM(),i=n.getBBox(),o=i.width,a=i.height,f=i.x,s=i.y;return u.x=f,u.y=s,e.nw=u.matrixTransform(r),u.x+=o,e.ne=u.matrixTransform(r),u.y+=a,e.se=u.matrixTransform(r),u.x-=o,e.sw=u.matrixTransform(r),u.y-=a/2,e.w=u.matrixTransform(r),u.x+=o,e.e=u.matrixTransform(r),u.x-=o/2,u.y-=a/2,e.n=u.matrixTransform(r),u.y+=a,e.s=u.matrixTransform(r),e}function y(t){return"function"==typeof t?t:function(){return t}}return f}},89976:function(t,n,e){"use strict";e.r(n),e.d(n,{Adder:function(){return F},Delaunay:function(){return Gc},FormatSpecifier:function(){return il},Voronoi:function(){return Vc},active:function(){return aa},arc:function(){return LA},area:function(){return WA},areaRadial:function(){return rM},ascending:function(){return i},autoType:function(){return Cf},axisBottom:function(){return ie},axisLeft:function(){return oe},axisRight:function(){return re},axisTop:function(){return ee},bin:function(){return yt},bisect:function(){return g},bisectCenter:function(){return v},bisectLeft:function(){return y},bisectRight:function(){return p},bisector:function(){return o},blob:function(){return ss},brush:function(){return La},brushSelection:function(){return ja},brushX:function(){return za},brushY:function(){return Va},buffer:function(){return hs},chord:function(){return Ja},chordDirected:function(){return nu},chordTranspose:function(){return tu},cluster:function(){return yv},color:function(){return ni},contourDensity:function(){return dc},contours:function(){return uc},count:function(){return x},create:function(){return hA},creator:function(){return yr},cross:function(){return E},csv:function(){return gs},csvFormat:function(){return vf},csvFormatBody:function(){return gf},csvFormatRow:function(){return bf},csvFormatRows:function(){return mf},csvFormatValue:function(){return xf},csvParse:function(){return pf},csvParseRows:function(){return yf},cubehelix:function(){return Zu},cumsum:function(){return C},curveBasis:function(){return jM},curveBasisClosed:function(){return VM},curveBasisOpen:function(){return UM},curveBundle:function(){return BM},curveCardinal:function(){return YM},curveCardinalClosed:function(){return $M},curveCardinalOpen:function(){return GM},curveCatmullRom:function(){return KM},curveCatmullRomClosed:function(){return tk},curveCatmullRomOpen:function(){return ek},curveLinear:function(){return qA},curveLinearClosed:function(){return ik},curveMonotoneX:function(){return hk},curveMonotoneY:function(){return dk},curveNatural:function(){return vk},curveStep:function(){return mk},curveStepAfter:function(){return xk},curveStepBefore:function(){return bk},descending:function(){return O},deviation:function(){return R},difference:function(){return Nn},disjoint:function(){return Dn},dispatch:function(){return he},drag:function(){return of},dragDisable:function(){return Dr},dragEnable:function(){return jr},dsv:function(){return vs},dsvFormat:function(){return hf},easeBack:function(){return is},easeBackIn:function(){return es},easeBackInOut:function(){return is},easeBackOut:function(){return rs},easeBounce:function(){return Jf},easeBounceIn:function(){return Kf},easeBounceInOut:function(){return ts},easeBounceOut:function(){return Jf},easeCircle:function(){return Gf},easeCircleIn:function(){return $f},easeCircleInOut:function(){return Gf},easeCircleOut:function(){return Wf},easeCubic:function(){return ea},easeCubicIn:function(){return ta},easeCubicInOut:function(){return ea},easeCubicOut:function(){return na},easeElastic:function(){return us},easeElasticIn:function(){return as},easeElasticInOut:function(){return cs},easeElasticOut:function(){return us},easeExp:function(){return Xf},easeExpIn:function(){return qf},easeExpInOut:function(){return Xf},easeExpOut:function(){return Yf},easeLinear:function(){return Pf},easePoly:function(){return zf},easePolyIn:function(){return Df},easePolyInOut:function(){return zf},easePolyOut:function(){return jf},easeQuad:function(){return Rf},easeQuadIn:function(){return Nf},easeQuadInOut:function(){return Rf},easeQuadOut:function(){return If},easeSin:function(){return Bf},easeSinIn:function(){return Uf},easeSinInOut:function(){return Bf},easeSinOut:function(){return Ff},every:function(){return bn},extent:function(){return z},filter:function(){return Mn},forceCenter:function(){return ks},forceCollide:function(){return Ls},forceLink:function(){return Hs},forceManyBody:function(){return Gs},forceRadial:function(){return Qs},forceSimulation:function(){return Ws},forceX:function(){return Zs},forceY:function(){return Ks},format:function(){return fl},formatDefaultLocale:function(){return pl},formatLocale:function(){return dl},formatPrefix:function(){return sl},formatSpecifier:function(){return rl},fsum:function(){return B},geoAlbers:function(){return Oy},geoAlbersUsa:function(){return Py},geoArea:function(){return mh},geoAzimuthalEqualArea:function(){return Dy},geoAzimuthalEqualAreaRaw:function(){return Ry},geoAzimuthalEquidistant:function(){return zy},geoAzimuthalEquidistantRaw:function(){return jy},geoBounds:function(){return Jh},geoCentroid:function(){return ld},geoCircle:function(){return wd},geoClipAntimeridian:function(){return Id},geoClipCircle:function(){return Rd},geoClipExtent:function(){return Bd},geoClipRectangle:function(){return Fd},geoConicConformal:function(){return Hy},geoConicConformalRaw:function(){return By},geoConicEqualArea:function(){return Cy},geoConicEqualAreaRaw:function(){return Ey},geoConicEquidistant:function(){return $y},geoConicEquidistantRaw:function(){return Xy},geoContains:function(){return op},geoDistance:function(){return Qd},geoEqualEarth:function(){return tv},geoEqualEarthRaw:function(){return Jy},geoEquirectangular:function(){return Yy},geoEquirectangularRaw:function(){return qy},geoGnomonic:function(){return ev},geoGnomonicRaw:function(){return nv},geoGraticule:function(){return cp},geoGraticule10:function(){return fp},geoIdentity:function(){return rv},geoInterpolate:function(){return sp},geoLength:function(){return $d},geoMercator:function(){return Ly},geoMercatorRaw:function(){return Vy},geoNaturalEarth1:function(){return ov},geoNaturalEarth1Raw:function(){return iv},geoOrthographic:function(){return uv},geoOrthographicRaw:function(){return av},geoPath:function(){return hy},geoProjection:function(){return My},geoProjectionMutator:function(){return ky},geoRotation:function(){return bd},geoStereographic:function(){return fv},geoStereographicRaw:function(){return cv},geoStream:function(){return Wl},geoTransform:function(){return dy},geoTransverseMercator:function(){return lv},geoTransverseMercatorRaw:function(){return sv},gray:function(){return Ou},greatest:function(){return rn},greatestIndex:function(){return un},group:function(){return W},groups:function(){return G},hcl:function(){return Lu},hierarchy:function(){return Sv},histogram:function(){return yt},hsl:function(){return hi},html:function(){return As},image:function(){return bs},index:function(){return K},indexes:function(){return J},interpolate:function(){return Li},interpolateArray:function(){return Ci},interpolateBasis:function(){return vi},interpolateBasisClosed:function(){return gi},interpolateBlues:function(){return LS},interpolateBrBG:function(){return Zw},interpolateBuGn:function(){return yS},interpolateBuPu:function(){return gS},interpolateCividis:function(){return QS},interpolateCool:function(){return JS},interpolateCubehelix:function(){return Dg},interpolateCubehelixDefault:function(){return ZS},interpolateCubehelixLong:function(){return jg},interpolateDate:function(){return Pi},interpolateDiscrete:function(){return wg},interpolateGnBu:function(){return bS},interpolateGreens:function(){return FS},interpolateGreys:function(){return HS},interpolateHcl:function(){return Ng},interpolateHclLong:function(){return Ig},interpolateHsl:function(){return Eg},interpolateHslLong:function(){return Cg},interpolateHue:function(){return Sg},interpolateInferno:function(){return sA},interpolateLab:function(){return Og},interpolateMagma:function(){return fA},interpolateNumber:function(){return Ni},interpolateNumberArray:function(){return Ti},interpolateObject:function(){return Ri},interpolateOrRd:function(){return _S},interpolateOranges:function(){return GS},interpolatePRGn:function(){return Jw},interpolatePiYG:function(){return nS},interpolatePlasma:function(){return lA},interpolatePuBu:function(){return MS},interpolatePuBuGn:function(){return SS},interpolatePuOr:function(){return rS},interpolatePuRd:function(){return TS},interpolatePurples:function(){return YS},interpolateRainbow:function(){return nA},interpolateRdBu:function(){return oS},interpolateRdGy:function(){return uS},interpolateRdPu:function(){return CS},interpolateRdYlBu:function(){return fS},interpolateRdYlGn:function(){return lS},interpolateReds:function(){return $S},interpolateRgb:function(){return Si},interpolateRgbBasis:function(){return Mi},interpolateRgbBasisClosed:function(){return ki},interpolateRound:function(){return Ag},interpolateSinebow:function(){return oA},interpolateSpectral:function(){return dS},interpolateString:function(){return zi},interpolateTransformCss:function(){return _o},interpolateTransformSvg:function(){return wo},interpolateTurbo:function(){return aA},interpolateViridis:function(){return cA},interpolateWarm:function(){return KS},interpolateYlGn:function(){return IS},interpolateYlGnBu:function(){return PS},interpolateYlOrBr:function(){return DS},interpolateYlOrRd:function(){return zS},interpolateZoom:function(){return kg},interrupt:function(){return yo},intersection:function(){return Ln},interval:function(){return Bk},isoFormat:function(){return Uk},isoParse:function(){return Fk},json:function(){return _s},lab:function(){return Pu},lch:function(){return Vu},least:function(){return Zt},leastIndex:function(){return tn},line:function(){return $A},lineRadial:function(){return eM},linkHorizontal:function(){return lM},linkRadial:function(){return dM},linkVertical:function(){return hM},local:function(){return pA},map:function(){return kn},matcher:function(){return be},max:function(){return mt},maxIndex:function(){return Ot},mean:function(){return It},median:function(){return Rt},merge:function(){return Lt},min:function(){return _t},minIndex:function(){return Bt},namespace:function(){return je},namespaces:function(){return De},nice:function(){return lt},now:function(){return Ji},pack:function(){return Gv},packEnclose:function(){return Ov},packSiblings:function(){return Hv},pairs:function(){return Yt},partition:function(){return ng},path:function(){return fu},permute:function(){return $t},pie:function(){return ZA},piecewise:function(){return zg},pointRadial:function(){return iM},pointer:function(){return Fi},pointers:function(){return vA},polygonArea:function(){return Lg},polygonCentroid:function(){return Ug},polygonContains:function(){return Yg},polygonHull:function(){return qg},polygonLength:function(){return Xg},precisionFixed:function(){return yl},precisionPrefix:function(){return vl},precisionRound:function(){return gl},quadtree:function(){return Ps},quantile:function(){return At},quantileSorted:function(){return Mt},quantize:function(){return Vg},quickselect:function(){return wt},radialArea:function(){return rM},radialLine:function(){return eM},randomBates:function(){return Jg},randomBernoulli:function(){return em},randomBeta:function(){return om},randomBinomial:function(){return am},randomCauchy:function(){return cm},randomExponential:function(){return tm},randomGamma:function(){return im},randomGeometric:function(){return rm},randomInt:function(){return Gg},randomIrwinHall:function(){return Kg},randomLcg:function(){return pm},randomLogNormal:function(){return Zg},randomLogistic:function(){return fm},randomNormal:function(){return Qg},randomPareto:function(){return nm},randomPoisson:function(){return sm},randomUniform:function(){return Wg},randomWeibull:function(){return um},range:function(){return Wt},reduce:function(){return Tn},reverse:function(){return En},rgb:function(){return oi},ribbon:function(){return xu},ribbonArrow:function(){return _u},rollup:function(){return Q},rollups:function(){return Z},scaleBand:function(){return Sm},scaleDiverging:function(){return Iw},scaleDivergingLog:function(){return Rw},scaleDivergingPow:function(){return jw},scaleDivergingSqrt:function(){return zw},scaleDivergingSymlog:function(){return Dw},scaleIdentity:function(){return Vm},scaleImplicit:function(){return bm},scaleLinear:function(){return zm},scaleLog:function(){return $m},scaleOrdinal:function(){return xm},scalePoint:function(){return Mm},scalePow:function(){return eb},scaleQuantile:function(){return fb},scaleQuantize:function(){return hb},scaleRadial:function(){return ab},scaleSequential:function(){return ww},scaleSequentialLog:function(){return Sw},scaleSequentialPow:function(){return Mw},scaleSequentialQuantile:function(){return Cw},scaleSequentialSqrt:function(){return kw},scaleSequentialSymlog:function(){return Aw},scaleSqrt:function(){return rb},scaleSymlog:function(){return Zm},scaleThreshold:function(){return db},scaleTime:function(){return uw},scaleUtc:function(){return gw},scan:function(){return cn},schemeAccent:function(){return Uw},schemeBlues:function(){return VS},schemeBrBG:function(){return Qw},schemeBuGn:function(){return pS},schemeBuPu:function(){return vS},schemeCategory10:function(){return Lw},schemeDark2:function(){return Fw},schemeGnBu:function(){return mS},schemeGreens:function(){return US},schemeGreys:function(){return BS},schemeOrRd:function(){return xS},schemeOranges:function(){return WS},schemePRGn:function(){return Kw},schemePaired:function(){return Bw},schemePastel1:function(){return Hw},schemePastel2:function(){return qw},schemePiYG:function(){return tS},schemePuBu:function(){return AS},schemePuBuGn:function(){return wS},schemePuOr:function(){return eS},schemePuRd:function(){return kS},schemePurples:function(){return qS},schemeRdBu:function(){return iS},schemeRdGy:function(){return aS},schemeRdPu:function(){return ES},schemeRdYlBu:function(){return cS},schemeRdYlGn:function(){return sS},schemeReds:function(){return XS},schemeSet1:function(){return Yw},schemeSet2:function(){return Xw},schemeSet3:function(){return $w},schemeSpectral:function(){return hS},schemeTableau10:function(){return Ww},schemeYlGn:function(){return NS},schemeYlGnBu:function(){return OS},schemeYlOrBr:function(){return RS},schemeYlOrRd:function(){return jS},select:function(){return Nr},selectAll:function(){return gA},selection:function(){return Pr},selector:function(){return pe},selectorAll:function(){return me},shuffle:function(){return fn},shuffler:function(){return sn},some:function(){return wn},sort:function(){return Cn},stack:function(){return Tk},stackOffsetDiverging:function(){return Ck},stackOffsetExpand:function(){return Ek},stackOffsetNone:function(){return _k},stackOffsetSilhouette:function(){return Ok},stackOffsetWiggle:function(){return Pk},stackOrderAppearance:function(){return Nk},stackOrderAscending:function(){return Rk},stackOrderDescending:function(){return jk},stackOrderInsideOut:function(){return zk},stackOrderNone:function(){return wk},stackOrderReverse:function(){return Vk},stratify:function(){return ag},style:function(){return $e},subset:function(){return Hn},sum:function(){return dn},superset:function(){return Bn},svg:function(){return Ms},symbol:function(){return NM},symbolCircle:function(){return pM},symbolCross:function(){return yM},symbolDiamond:function(){return mM},symbolSquare:function(){return SM},symbolStar:function(){return wM},symbolTriangle:function(){return MM},symbolWye:function(){return OM},symbols:function(){return PM},text:function(){return ps},thresholdFreedmanDiaconis:function(){return kt},thresholdScott:function(){return Tt},thresholdSturges:function(){return ht},tickFormat:function(){return Dm},tickIncrement:function(){return ft},tickStep:function(){return st},ticks:function(){return ct},timeDay:function(){return qb},timeDays:function(){return Yb},timeFormat:function(){return Ox},timeFormatDefaultLocale:function(){return Z_},timeFormatLocale:function(){return Ex},timeFriday:function(){return Rb},timeFridays:function(){return Fb},timeHour:function(){return $b},timeHours:function(){return Wb},timeInterval:function(){return vb},timeMillisecond:function(){return ex},timeMilliseconds:function(){return rx},timeMinute:function(){return Qb},timeMinutes:function(){return Zb},timeMonday:function(){return Ob},timeMondays:function(){return zb},timeMonth:function(){return _b},timeMonths:function(){return wb},timeParse:function(){return Px},timeSaturday:function(){return Db},timeSaturdays:function(){return Bb},timeSecond:function(){return Jb},timeSeconds:function(){return tx},timeSunday:function(){return Cb},timeSundays:function(){return jb},timeThursday:function(){return Ib},timeThursdays:function(){return Ub},timeTuesday:function(){return Pb},timeTuesdays:function(){return Vb},timeWednesday:function(){return Nb},timeWednesdays:function(){return Lb},timeWeek:function(){return Cb},timeWeeks:function(){return jb},timeYear:function(){return mb},timeYears:function(){return bb},timeout:function(){return uo},timer:function(){return eo},timerFlush:function(){return ro},transition:function(){return Zo},transpose:function(){return pn},tree:function(){return dg},treemap:function(){return mg},treemapBinary:function(){return bg},treemapDice:function(){return tg},treemapResquarify:function(){return _g},treemapSlice:function(){return pg},treemapSliceDice:function(){return xg},treemapSquarify:function(){return gg},tsv:function(){return ms},tsvFormat:function(){return Af},tsvFormatBody:function(){return Mf},tsvFormatRow:function(){return Tf},tsvFormatRows:function(){return kf},tsvFormatValue:function(){return Ef},tsvParse:function(){return wf},tsvParseRows:function(){return Sf},union:function(){return Xn},utcDay:function(){return xx},utcDays:function(){return _x},utcFormat:function(){return Nx},utcFriday:function(){return sx},utcFridays:function(){return gx},utcHour:function(){return hw},utcHours:function(){return dw},utcMillisecond:function(){return ex},utcMilliseconds:function(){return rx},utcMinute:function(){return yw},utcMinutes:function(){return vw},utcMonday:function(){return ax},utcMondays:function(){return dx},utcMonth:function(){return fw},utcMonths:function(){return sw},utcParse:function(){return Ix},utcSaturday:function(){return lx},utcSaturdays:function(){return mx},utcSecond:function(){return Jb},utcSeconds:function(){return tx},utcSunday:function(){return ox},utcSundays:function(){return hx},utcThursday:function(){return fx},utcThursdays:function(){return vx},utcTuesday:function(){return ux},utcTuesdays:function(){return px},utcWednesday:function(){return cx},utcWednesdays:function(){return yx},utcWeek:function(){return ox},utcWeeks:function(){return hx},utcYear:function(){return Sx},utcYears:function(){return Ax},variance:function(){return I},version:function(){return r},window:function(){return He},xml:function(){return Ss},zip:function(){return vn},zoom:function(){return eT},zoomIdentity:function(){return Xk},zoomTransform:function(){return $k}});var r="6.2.0";function i(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function o(t){var n=t,e=t;function r(t,n,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){var o=r+i>>>1;e(t[o],n)<0?r=o+1:i=o}return r}return 1===t.length&&(n=function(n,e){return t(n)-e},e=function(t){return function(n,e){return i(t(n),e)}}(t)),{left:r,center:function(t,e,i,o){null==i&&(i=0),null==o&&(o=t.length);var a=r(t,e,i,o-1);return a>i&&n(t[a-1],e)>-n(t[a],e)?a-1:a},right:function(t,n,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){var o=r+i>>>1;e(t[o],n)>0?i=o:r=o+1}return r}}}var a=e(67945),u=e.n(a),c=u().mark(h);function f(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return s(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return s(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function s(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function l(t){return null===t?NaN:+t}function h(t,n){var e,r,i,o,a,s,l;return u().wrap((function(u){for(;;)switch(u.prev=u.next){case 0:if(void 0!==n){u.next=21;break}e=f(t),u.prev=2,e.s();case 4:if((r=e.n()).done){u.next=11;break}if(!(null!=(i=r.value)&&(i=+i)>=i)){u.next=9;break}return u.next=9,i;case 9:u.next=4;break;case 11:u.next=16;break;case 13:u.prev=13,u.t0=u.catch(2),e.e(u.t0);case 16:return u.prev=16,e.f(),u.finish(16);case 19:u.next=40;break;case 21:o=-1,a=f(t),u.prev=23,a.s();case 25:if((s=a.n()).done){u.next=32;break}if(l=s.value,!(null!=(l=n(l,++o,t))&&(l=+l)>=l)){u.next=30;break}return u.next=30,l;case 30:u.next=25;break;case 32:u.next=37;break;case 34:u.prev=34,u.t1=u.catch(23),a.e(u.t1);case 37:return u.prev=37,a.f(),u.finish(37);case 40:case"end":return u.stop()}}),c,null,[[2,13,16,19],[23,34,37,40]])}var d=o(i),p=d.right,y=d.left,v=o(l).center,g=p;function m(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return b(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return b(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function b(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function x(t,n){var e=0;if(void 0===n){var r,i=m(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;null!=o&&(o=+o)>=o&&++e}}catch(t){i.e(t)}finally{i.f()}}else{var a,u=-1,c=m(t);try{for(c.s();!(a=c.n()).done;){var f=a.value;null!=(f=n(f,++u,t))&&(f=+f)>=f&&++e}}catch(t){c.e(t)}finally{c.f()}}return e}function _(t){return function(t){if(Array.isArray(t))return w(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,n){if(!t)return;if("string"==typeof t)return w(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return w(t,n)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function S(t){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function A(t){return 0|t.length}function M(t){return!(t>0)}function k(t){return"object"!==S(t)||"length"in t?t:Array.from(t)}function T(t){return function(n){return t.apply(void 0,_(n))}}function E(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];var r="function"==typeof n[n.length-1]&&T(n.pop()),i=(n=n.map(k)).map(A),o=n.length-1,a=new Array(o+1).fill(0),u=[];if(o<0||i.some(M))return u;for(;;){u.push(a.map((function(t,e){return n[e][t]})));for(var c=o;++a[c]===i[c];){if(0===c)return r?u.map(r):u;a[c--]=0}}}function C(t,n){var e=0,r=0;return Float64Array.from(t,void 0===n?function(t){return e+=+t||0}:function(i){return e+=+n(i,r++,t)||0})}function O(t,n){return n<t?-1:n>t?1:n>=t?0:NaN}function P(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return N(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return N(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function N(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function I(t,n){var e,r=0,i=0,o=0;if(void 0===n){var a,u=P(t);try{for(u.s();!(a=u.n()).done;){var c=a.value;null!=c&&(c=+c)>=c&&(o+=(e=c-i)*(c-(i+=e/++r)))}}catch(t){u.e(t)}finally{u.f()}}else{var f,s=-1,l=P(t);try{for(l.s();!(f=l.n()).done;){var h=f.value;null!=(h=n(h,++s,t))&&(h=+h)>=h&&(o+=(e=h-i)*(h-(i+=e/++r)))}}catch(t){l.e(t)}finally{l.f()}}if(r>1)return o/(r-1)}function R(t,n){var e=I(t,n);return e?Math.sqrt(e):e}function D(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return j(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return j(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function j(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function z(t,n){var e,r;if(void 0===n){var i,o=D(t);try{for(o.s();!(i=o.n()).done;){var a=i.value;null!=a&&(void 0===e?a>=a&&(e=r=a):(e>a&&(e=a),r<a&&(r=a)))}}catch(t){o.e(t)}finally{o.f()}}else{var u,c=-1,f=D(t);try{for(f.s();!(u=f.n()).done;){var s=u.value;null!=(s=n(s,++c,t))&&(void 0===e?s>=s&&(e=r=s):(e>s&&(e=s),r<s&&(r=s)))}}catch(t){f.e(t)}finally{f.f()}}return[e,r]}function V(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return L(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return L(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function L(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function U(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var F=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this._partials=new Float64Array(32),this._n=0}var n,e,r;return n=t,(e=[{key:"add",value:function(t){for(var n=this._partials,e=0,r=0;r<this._n&&r<32;r++){var i=n[r],o=t+i,a=Math.abs(t)<Math.abs(i)?t-(o-i):i-(o-t);a&&(n[e++]=a),t=o}return n[e]=t,this._n=e+1,this}},{key:"valueOf",value:function(){var t,n,e,r=this._partials,i=this._n,o=0;if(i>0){for(o=r[--i];i>0&&(t=o,!(e=(n=r[--i])-((o=t+n)-t))););i>0&&(e<0&&r[i-1]<0||e>0&&r[i-1]>0)&&(n=2*e)==(t=o+n)-o&&(o=t)}return o}}])&&U(n.prototype,e),r&&U(n,r),t}();function B(t,n){var e=new F;if(void 0===n){var r,i=V(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;(o=+o)&&e.add(o)}}catch(t){i.e(t)}finally{i.f()}}else{var a,u=-1,c=V(t);try{for(c.s();!(a=c.n()).done;){var f=a.value;(f=+n(f,++u,t))&&e.add(f)}}catch(t){c.e(t)}finally{c.f()}}return+e}function H(t){return t}function q(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var e=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(e.push(a.value),!n||e.length!==n);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return e}(t,n)||X(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=X(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function X(t,n){if(t){if("string"==typeof t)return $(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?$(t,n):void 0}}function $(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function W(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];return nt(t,H,H,e)}function G(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];return nt(t,Array.from,H,e)}function Q(t,n){for(var e=arguments.length,r=new Array(e>2?e-2:0),i=2;i<e;i++)r[i-2]=arguments[i];return nt(t,H,n,r)}function Z(t,n){for(var e=arguments.length,r=new Array(e>2?e-2:0),i=2;i<e;i++)r[i-2]=arguments[i];return nt(t,Array.from,n,r)}function K(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];return nt(t,H,tt,e)}function J(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];return nt(t,Array.from,tt,e)}function tt(t){if(1!==t.length)throw new Error("duplicate key");return t[0]}function nt(t,n,e,r){return function t(i,o){if(o>=r.length)return e(i);var a,u=new Map,c=r[o++],f=-1,s=Y(i);try{for(s.s();!(a=s.n()).done;){var l=a.value,h=c(l,++f,i),d=u.get(h);d?d.push(l):u.set(h,[l])}}catch(t){s.e(t)}finally{s.f()}var p,y=Y(u);try{for(y.s();!(p=y.n()).done;){var v=q(p.value,2),g=v[0],m=v[1];u.set(g,t(m,o))}}catch(t){y.e(t)}finally{y.f()}return n(u)}(t,0)}var et=Array.prototype,rt=et.slice;et.map;function it(t){return function(){return t}}var ot=Math.sqrt(50),at=Math.sqrt(10),ut=Math.sqrt(2);function ct(t,n,e){var r,i,o,a,u=-1;if(e=+e,(t=+t)===(n=+n)&&e>0)return[t];if((r=n<t)&&(i=t,t=n,n=i),0===(a=ft(t,n,e))||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),n=Math.floor(n/a),o=new Array(i=Math.ceil(n-t+1));++u<i;)o[u]=(t+u)*a;else for(a=-a,t=Math.ceil(t*a),n=Math.floor(n*a),o=new Array(i=Math.ceil(n-t+1));++u<i;)o[u]=(t+u)/a;return r&&o.reverse(),o}function ft(t,n,e){var r=(n-t)/Math.max(0,e),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=ot?10:o>=at?5:o>=ut?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=ot?10:o>=at?5:o>=ut?2:1)}function st(t,n,e){var r=Math.abs(n-t)/Math.max(0,e),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=ot?i*=10:o>=at?i*=5:o>=ut&&(i*=2),n<t?-i:i}function lt(t,n,e){for(var r;;){var i=ft(t,n,e);if(i===r||0===i||!isFinite(i))return[t,n];i>0?(t=Math.floor(t/i)*i,n=Math.ceil(n/i)*i):i<0&&(t=Math.ceil(t*i)/i,n=Math.floor(n*i)/i),r=i}}function ht(t){return Math.ceil(Math.log(x(t))/Math.LN2)+1}function dt(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var e=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(e.push(a.value),!n||e.length!==n);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return e}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return pt(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return pt(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pt(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function yt(){var t=H,n=z,e=ht;function r(r){Array.isArray(r)||(r=Array.from(r));var i,o,a=r.length,u=new Array(a);for(i=0;i<a;++i)u[i]=t(r[i],i,r);var c=n(u),f=c[0],s=c[1],l=e(u,f,s);if(!Array.isArray(l)){if(l=+l,n===z){var h=dt(lt(f,s,l),2);f=h[0],s=h[1]}(l=ct(f,s,l))[l.length-1]===s&&l.pop()}for(var d=l.length;l[0]<=f;)l.shift(),--d;for(;l[d-1]>s;)l.pop(),--d;var p,y=new Array(d+1);for(i=0;i<=d;++i)(p=y[i]=[]).x0=i>0?l[i-1]:f,p.x1=i<d?l[i]:s;for(i=0;i<a;++i)f<=(o=u[i])&&o<=s&&y[g(l,o,0,d)].push(r[i]);return y}return r.value=function(n){return arguments.length?(t="function"==typeof n?n:it(n),r):t},r.domain=function(t){return arguments.length?(n="function"==typeof t?t:it([t[0],t[1]]),r):n},r.thresholds=function(t){return arguments.length?(e="function"==typeof t?t:Array.isArray(t)?it(rt.call(t)):it(t),r):e},r}function vt(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return gt(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return gt(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function gt(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function mt(t,n){var e;if(void 0===n){var r,i=vt(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;null!=o&&(e<o||void 0===e&&o>=o)&&(e=o)}}catch(t){i.e(t)}finally{i.f()}}else{var a,u=-1,c=vt(t);try{for(c.s();!(a=c.n()).done;){var f=a.value;null!=(f=n(f,++u,t))&&(e<f||void 0===e&&f>=f)&&(e=f)}}catch(t){c.e(t)}finally{c.f()}}return e}function bt(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return xt(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return xt(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function xt(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function _t(t,n){var e;if(void 0===n){var r,i=bt(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;null!=o&&(e>o||void 0===e&&o>=o)&&(e=o)}}catch(t){i.e(t)}finally{i.f()}}else{var a,u=-1,c=bt(t);try{for(c.s();!(a=c.n()).done;){var f=a.value;null!=(f=n(f,++u,t))&&(e>f||void 0===e&&f>=f)&&(e=f)}}catch(t){c.e(t)}finally{c.f()}}return e}function wt(t,n){for(var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length-1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:i;r>e;){if(r-e>600){var a=r-e+1,u=n-e+1,c=Math.log(a),f=.5*Math.exp(2*c/3),s=.5*Math.sqrt(c*f*(a-f)/a)*(u-a/2<0?-1:1),l=Math.max(e,Math.floor(n-u*f/a+s)),h=Math.min(r,Math.floor(n+(a-u)*f/a+s));wt(t,n,l,h,o)}var d=t[n],p=e,y=r;for(St(t,e,n),o(t[r],d)>0&&St(t,e,r);p<y;){for(St(t,p,y),++p,--y;o(t[p],d)<0;)++p;for(;o(t[y],d)>0;)--y}0===o(t[e],d)?St(t,e,y):St(t,++y,r),y<=n&&(e=y+1),n<=y&&(r=y-1)}return t}function St(t,n,e){var r=t[n];t[n]=t[e],t[e]=r}function At(t,n,e){if(r=(t=Float64Array.from(h(t,e))).length){if((n=+n)<=0||r<2)return _t(t);if(n>=1)return mt(t);var r,i=(r-1)*n,o=Math.floor(i),a=mt(wt(t,o).subarray(0,o+1));return a+(_t(t.subarray(o+1))-a)*(i-o)}}function Mt(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l;if(r=t.length){if((n=+n)<=0||r<2)return+e(t[0],0,t);if(n>=1)return+e(t[r-1],r-1,t);var r,i=(r-1)*n,o=Math.floor(i),a=+e(t[o],o,t),u=+e(t[o+1],o+1,t);return a+(u-a)*(i-o)}}function kt(t,n,e){return Math.ceil((e-n)/(2*(At(t,.75)-At(t,.25))*Math.pow(x(t),-1/3)))}function Tt(t,n,e){return Math.ceil((e-n)/(3.5*R(t)*Math.pow(x(t),-1/3)))}function Et(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return Ct(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Ct(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Ct(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Ot(t,n){var e,r=-1,i=-1;if(void 0===n){var o,a=Et(t);try{for(a.s();!(o=a.n()).done;){var u=o.value;++i,null!=u&&(e<u||void 0===e&&u>=u)&&(e=u,r=i)}}catch(t){a.e(t)}finally{a.f()}}else{var c,f=Et(t);try{for(f.s();!(c=f.n()).done;){var s=c.value;null!=(s=n(s,++i,t))&&(e<s||void 0===e&&s>=s)&&(e=s,r=i)}}catch(t){f.e(t)}finally{f.f()}}return r}function Pt(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return Nt(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Nt(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Nt(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function It(t,n){var e=0,r=0;if(void 0===n){var i,o=Pt(t);try{for(o.s();!(i=o.n()).done;){var a=i.value;null!=a&&(a=+a)>=a&&(++e,r+=a)}}catch(t){o.e(t)}finally{o.f()}}else{var u,c=-1,f=Pt(t);try{for(f.s();!(u=f.n()).done;){var s=u.value;null!=(s=n(s,++c,t))&&(s=+s)>=s&&(++e,r+=s)}}catch(t){f.e(t)}finally{f.f()}}if(e)return r/e}function Rt(t,n){return At(t,.5,n)}var Dt=u().mark(Vt);function jt(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return zt(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return zt(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function zt(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Vt(t){var n,e,r;return u().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:n=jt(t),i.prev=1,n.s();case 3:if((e=n.n()).done){i.next=8;break}return r=e.value,i.delegateYield(r,"t0",6);case 6:i.next=3;break;case 8:i.next=13;break;case 10:i.prev=10,i.t1=i.catch(1),n.e(i.t1);case 13:return i.prev=13,n.f(),i.finish(13);case 16:case"end":return i.stop()}}),Dt,null,[[1,10,13,16]])}function Lt(t){return Array.from(Vt(t))}function Ut(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return Ft(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Ft(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Ft(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Bt(t,n){var e,r=-1,i=-1;if(void 0===n){var o,a=Ut(t);try{for(a.s();!(o=a.n()).done;){var u=o.value;++i,null!=u&&(e>u||void 0===e&&u>=u)&&(e=u,r=i)}}catch(t){a.e(t)}finally{a.f()}}else{var c,f=Ut(t);try{for(f.s();!(c=f.n()).done;){var s=c.value;null!=(s=n(s,++i,t))&&(e>s||void 0===e&&s>=s)&&(e=s,r=i)}}catch(t){f.e(t)}finally{f.f()}}return r}function Ht(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return qt(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return qt(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function qt(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Yt(t){var n,e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Xt,i=[],o=!1,a=Ht(t);try{for(a.s();!(e=a.n()).done;){var u=e.value;o&&i.push(r(n,u)),n=u,o=!0}}catch(t){a.e(t)}finally{a.f()}return i}function Xt(t,n){return[t,n]}function $t(t,n){return Array.from(n,(function(n){return t[n]}))}function Wt(t,n,e){t=+t,n=+n,e=(i=arguments.length)<2?(n=t,t=0,1):i<3?1:+e;for(var r=-1,i=0|Math.max(0,Math.ceil((n-t)/e)),o=new Array(i);++r<i;)o[r]=t+r*e;return o}function Gt(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return Qt(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Qt(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Qt(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Zt(t){var n,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i,r=!1;if(1===e.length){var o,a,u=Gt(t);try{for(u.s();!(a=u.n()).done;){var c=a.value,f=e(c);(r?i(f,o)<0:0===i(f,f))&&(n=c,o=f,r=!0)}}catch(t){u.e(t)}finally{u.f()}}else{var s,l=Gt(t);try{for(l.s();!(s=l.n()).done;){var h=s.value;(r?e(h,n)<0:0===e(h,h))&&(n=h,r=!0)}}catch(t){l.e(t)}finally{l.f()}}return n}function Kt(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return Jt(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Jt(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Jt(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function tn(t){var n,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i;if(1===e.length)return Bt(t,e);var r,o=-1,a=-1,u=Kt(t);try{for(u.s();!(r=u.n()).done;){var c=r.value;++a,(o<0?0===e(c,c):e(c,n)<0)&&(n=c,o=a)}}catch(t){u.e(t)}finally{u.f()}return o}function nn(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return en(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return en(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function en(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function rn(t){var n,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i,r=!1;if(1===e.length){var o,a,u=nn(t);try{for(u.s();!(a=u.n()).done;){var c=a.value,f=e(c);(r?i(f,o)>0:0===i(f,f))&&(n=c,o=f,r=!0)}}catch(t){u.e(t)}finally{u.f()}}else{var s,l=nn(t);try{for(l.s();!(s=l.n()).done;){var h=s.value;(r?e(h,n)>0:0===e(h,h))&&(n=h,r=!0)}}catch(t){l.e(t)}finally{l.f()}}return n}function on(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return an(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return an(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function an(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function un(t){var n,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i;if(1===e.length)return Ot(t,e);var r,o=-1,a=-1,u=on(t);try{for(u.s();!(r=u.n()).done;){var c=r.value;++a,(o<0?0===e(c,c):e(c,n)>0)&&(n=c,o=a)}}catch(t){u.e(t)}finally{u.f()}return o}function cn(t,n){var e=tn(t,n);return e<0?void 0:e}var fn=sn(Math.random);function sn(t){return function(n){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.length,i=r-(e=+e);i;){var o=t()*i--|0,a=n[i+e];n[i+e]=n[o+e],n[o+e]=a}return n}}function ln(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return hn(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return hn(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function hn(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function dn(t,n){var e=0;if(void 0===n){var r,i=ln(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;(o=+o)&&(e+=o)}}catch(t){i.e(t)}finally{i.f()}}else{var a,u=-1,c=ln(t);try{for(c.s();!(a=c.n()).done;){var f=a.value;(f=+n(f,++u,t))&&(e+=f)}}catch(t){c.e(t)}finally{c.f()}}return e}function pn(t){if(!(i=t.length))return[];for(var n=-1,e=_t(t,yn),r=new Array(e);++n<e;)for(var i,o=-1,a=r[n]=new Array(i);++o<i;)a[o]=t[o][n];return r}function yn(t){return t.length}function vn(){return pn(arguments)}function gn(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return mn(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return mn(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function mn(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function bn(t,n){if("function"!=typeof n)throw new TypeError("test is not a function");var e,r=-1,i=gn(t);try{for(i.s();!(e=i.n()).done;){if(!n(e.value,++r,t))return!1}}catch(t){i.e(t)}finally{i.f()}return!0}function xn(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return _n(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return _n(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function _n(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function wn(t,n){if("function"!=typeof n)throw new TypeError("test is not a function");var e,r=-1,i=xn(t);try{for(i.s();!(e=i.n()).done;){if(n(e.value,++r,t))return!0}}catch(t){i.e(t)}finally{i.f()}return!1}function Sn(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return An(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return An(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function An(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Mn(t,n){if("function"!=typeof n)throw new TypeError("test is not a function");var e,r=[],i=-1,o=Sn(t);try{for(o.s();!(e=o.n()).done;){var a=e.value;n(a,++i,t)&&r.push(a)}}catch(t){o.e(t)}finally{o.f()}return r}function kn(t,n){if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");if("function"!=typeof n)throw new TypeError("mapper is not a function");return Array.from(t,(function(e,r){return n(e,r,t)}))}function Tn(t,n,e){if("function"!=typeof n)throw new TypeError("reducer is not a function");var r,i,o=t[Symbol.iterator](),a=-1;if(arguments.length<3){var u=o.next();if(r=u.done,e=u.value,r)return;++a}for(;r=(c=o.next()).done,i=c.value,!r;){var c;e=n(e,i,++a,t)}return e}function En(t){if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");return Array.from(t).reverse()}function Cn(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i;if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");return Array.from(t).sort(n)}function On(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return Pn(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Pn(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Pn(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Nn(t){t=new Set(t);for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];for(var i=0,o=e;i<o.length;i++){var a,u=o[i],c=On(u);try{for(c.s();!(a=c.n()).done;){var f=a.value;t.delete(f)}}catch(t){c.e(t)}finally{c.f()}}return t}function In(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return Rn(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Rn(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Rn(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Dn(t,n){var e,r=n[Symbol.iterator](),i=new Set,o=In(t);try{for(o.s();!(e=o.n()).done;){var a=e.value;if(i.has(a))return!1;for(var u=void 0,c=void 0;u=(f=r.next()).value,c=f.done,f;){var f;if(c)break;if(Object.is(a,u))return!1;i.add(u)}}}catch(t){o.e(t)}finally{o.f()}return!0}function jn(t){return t instanceof Set?t:new Set(t)}function zn(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return Vn(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Vn(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Vn(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Ln(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];t=new Set(t),e=e.map(jn);var i,o=zn(t);try{t:for(o.s();!(i=o.n()).done;){var a,u=i.value,c=zn(e);try{for(c.s();!(a=c.n()).done;){var f=a.value;if(!f.has(u)){t.delete(u);continue t}}}catch(t){c.e(t)}finally{c.f()}}}catch(t){o.e(t)}finally{o.f()}return t}function Un(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return Fn(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Fn(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Fn(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Bn(t,n){var e,r=t[Symbol.iterator](),i=new Set,o=Un(n);try{for(o.s();!(e=o.n()).done;){var a=e.value;if(!i.has(a))for(var u=void 0,c=void 0;u=(f=r.next()).value,c=f.done,f;){var f;if(c)return!1;if(i.add(u),Object.is(a,u))break}}}catch(t){o.e(t)}finally{o.f()}return!0}function Hn(t,n){return Bn(n,t)}function qn(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return Yn(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Yn(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Yn(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Xn(){for(var t=new Set,n=arguments.length,e=new Array(n),r=0;r<n;r++)e[r]=arguments[r];for(var i=0,o=e;i<o.length;i++){var a,u=o[i],c=qn(u);try{for(c.s();!(a=c.n()).done;){var f=a.value;t.add(f)}}catch(t){c.e(t)}finally{c.f()}}return t}var $n=Array.prototype.slice;function Wn(t){return t}var Gn=1e-6;function Qn(t){return"translate("+(t+.5)+",0)"}function Zn(t){return"translate(0,"+(t+.5)+")"}function Kn(t){return function(n){return+t(n)}}function Jn(t){var n=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(n=Math.round(n)),function(e){return+t(e)+n}}function te(){return!this.__axis}function ne(t,n){var e=[],r=null,i=null,o=6,a=6,u=3,c=1===t||4===t?-1:1,f=4===t||2===t?"x":"y",s=1===t||3===t?Qn:Zn;function l(l){var h=null==r?n.ticks?n.ticks.apply(n,e):n.domain():r,d=null==i?n.tickFormat?n.tickFormat.apply(n,e):Wn:i,p=Math.max(o,0)+u,y=n.range(),v=+y[0]+.5,g=+y[y.length-1]+.5,m=(n.bandwidth?Jn:Kn)(n.copy()),b=l.selection?l.selection():l,x=b.selectAll(".domain").data([null]),_=b.selectAll(".tick").data(h,n).order(),w=_.exit(),S=_.enter().append("g").attr("class","tick"),A=_.select("line"),M=_.select("text");x=x.merge(x.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),_=_.merge(S),A=A.merge(S.append("line").attr("stroke","currentColor").attr(f+"2",c*o)),M=M.merge(S.append("text").attr("fill","currentColor").attr(f,c*p).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),l!==b&&(x=x.transition(l),_=_.transition(l),A=A.transition(l),M=M.transition(l),w=w.transition(l).attr("opacity",Gn).attr("transform",(function(t){return isFinite(t=m(t))?s(t):this.getAttribute("transform")})),S.attr("opacity",Gn).attr("transform",(function(t){var n=this.parentNode.__axis;return s(n&&isFinite(n=n(t))?n:m(t))}))),w.remove(),x.attr("d",4===t||2==t?a?"M"+c*a+","+v+"H0.5V"+g+"H"+c*a:"M0.5,"+v+"V"+g:a?"M"+v+","+c*a+"V0.5H"+g+"V"+c*a:"M"+v+",0.5H"+g),_.attr("opacity",1).attr("transform",(function(t){return s(m(t))})),A.attr(f+"2",c*o),M.attr(f,c*p).text(d),b.filter(te).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),b.each((function(){this.__axis=m}))}return l.scale=function(t){return arguments.length?(n=t,l):n},l.ticks=function(){return e=$n.call(arguments),l},l.tickArguments=function(t){return arguments.length?(e=null==t?[]:$n.call(t),l):e.slice()},l.tickValues=function(t){return arguments.length?(r=null==t?null:$n.call(t),l):r&&r.slice()},l.tickFormat=function(t){return arguments.length?(i=t,l):i},l.tickSize=function(t){return arguments.length?(o=a=+t,l):o},l.tickSizeInner=function(t){return arguments.length?(o=+t,l):o},l.tickSizeOuter=function(t){return arguments.length?(a=+t,l):a},l.tickPadding=function(t){return arguments.length?(u=+t,l):u},l}function ee(t){return ne(1,t)}function re(t){return ne(2,t)}function ie(t){return ne(3,t)}function oe(t){return ne(4,t)}var ae={value:function(){}};function ue(){for(var t,n=0,e=arguments.length,r={};n<e;++n){if(!(t=arguments[n]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new ce(r)}function ce(t){this._=t}function fe(t,n){return t.trim().split(/^|\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))}function se(t,n){for(var e,r=0,i=t.length;r<i;++r)if((e=t[r]).name===n)return e.value}function le(t,n,e){for(var r=0,i=t.length;r<i;++r)if(t[r].name===n){t[r]=ae,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=e&&t.push({name:n,value:e}),t}ce.prototype=ue.prototype={constructor:ce,on:function(t,n){var e,r=this._,i=fe(t+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=n&&"function"!=typeof n)throw new Error("invalid callback: "+n);for(;++o<a;)if(e=(t=i[o]).type)r[e]=le(r[e],t.name,n);else if(null==n)for(e in r)r[e]=le(r[e],t.name,null);return this}for(;++o<a;)if((e=(t=i[o]).type)&&(e=se(r[e],t.name)))return e},copy:function(){var t={},n=this._;for(var e in n)t[e]=n[e].slice();return new ce(t)},call:function(t,n){if((e=arguments.length-2)>0)for(var e,r,i=new Array(e),o=0;o<e;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,e=(r=this._[t]).length;o<e;++o)r[o].value.apply(n,i)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(n,e)}};var he=ue;function de(){}function pe(t){return null==t?de:function(){return this.querySelector(t)}}function ye(t){return(ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ve(t){return"object"===ye(t)&&"length"in t?t:Array.from(t)}function ge(){return[]}function me(t){return null==t?ge:function(){return this.querySelectorAll(t)}}function be(t){return function(){return this.matches(t)}}function xe(t){return function(n){return n.matches(t)}}var _e=Array.prototype.find;function we(){return this.firstElementChild}var Se=Array.prototype.filter;function Ae(){return this.children}function Me(t){return new Array(t.length)}function ke(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}function Te(t){return function(){return t}}function Ee(t,n,e,r,i,o){for(var a,u=0,c=n.length,f=o.length;u<f;++u)(a=n[u])?(a.__data__=o[u],r[u]=a):e[u]=new ke(t,o[u]);for(;u<c;++u)(a=n[u])&&(i[u]=a)}function Ce(t,n,e,r,i,o,a){var u,c,f,s=new Map,l=n.length,h=o.length,d=new Array(l);for(u=0;u<l;++u)(c=n[u])&&(d[u]=f=a.call(c,c.__data__,u,n)+"",s.has(f)?i[u]=c:s.set(f,c));for(u=0;u<h;++u)f=a.call(t,o[u],u,o)+"",(c=s.get(f))?(r[u]=c,c.__data__=o[u],s.delete(f)):e[u]=new ke(t,o[u]);for(u=0;u<l;++u)(c=n[u])&&s.get(d[u])===c&&(i[u]=c)}function Oe(t){return t.__data__}function Pe(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function Ne(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return Ie(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Ie(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Ie(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}ke.prototype={constructor:ke,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var Re="http://www.w3.org/1999/xhtml",De={svg:"http://www.w3.org/2000/svg",xhtml:Re,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function je(t){var n=t+="",e=n.indexOf(":");return e>=0&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),De.hasOwnProperty(n)?{space:De[n],local:t}:t}function ze(t){return function(){this.removeAttribute(t)}}function Ve(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Le(t,n){return function(){this.setAttribute(t,n)}}function Ue(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}function Fe(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttribute(t):this.setAttribute(t,e)}}function Be(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}}function He(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function qe(t){return function(){this.style.removeProperty(t)}}function Ye(t,n,e){return function(){this.style.setProperty(t,n,e)}}function Xe(t,n,e){return function(){var r=n.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,e)}}function $e(t,n){return t.style.getPropertyValue(n)||He(t).getComputedStyle(t,null).getPropertyValue(n)}function We(t){return function(){delete this[t]}}function Ge(t,n){return function(){this[t]=n}}function Qe(t,n){return function(){var e=n.apply(this,arguments);null==e?delete this[t]:this[t]=e}}function Ze(t){return t.trim().split(/^|\s+/)}function Ke(t){return t.classList||new Je(t)}function Je(t){this._node=t,this._names=Ze(t.getAttribute("class")||"")}function tr(t,n){for(var e=Ke(t),r=-1,i=n.length;++r<i;)e.add(n[r])}function nr(t,n){for(var e=Ke(t),r=-1,i=n.length;++r<i;)e.remove(n[r])}function er(t){return function(){tr(this,t)}}function rr(t){return function(){nr(this,t)}}function ir(t,n){return function(){(n.apply(this,arguments)?tr:nr)(this,t)}}function or(){this.textContent=""}function ar(t){return function(){this.textContent=t}}function ur(t){return function(){var n=t.apply(this,arguments);this.textContent=null==n?"":n}}function cr(){this.innerHTML=""}function fr(t){return function(){this.innerHTML=t}}function sr(t){return function(){var n=t.apply(this,arguments);this.innerHTML=null==n?"":n}}function lr(){this.nextSibling&&this.parentNode.appendChild(this)}function hr(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function dr(t){return function(){var n=this.ownerDocument,e=this.namespaceURI;return e===Re&&n.documentElement.namespaceURI===Re?n.createElement(t):n.createElementNS(e,t)}}function pr(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function yr(t){var n=je(t);return(n.local?pr:dr)(n)}function vr(){return null}function gr(){var t=this.parentNode;t&&t.removeChild(this)}function mr(){var t=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function br(){var t=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function xr(t){return t.trim().split(/^|\s+/).map((function(t){var n="",e=t.indexOf(".");return e>=0&&(n=t.slice(e+1),t=t.slice(0,e)),{type:t,name:n}}))}function _r(t){return function(){var n=this.__on;if(n){for(var e,r=0,i=-1,o=n.length;r<o;++r)e=n[r],t.type&&e.type!==t.type||e.name!==t.name?n[++i]=e:this.removeEventListener(e.type,e.listener,e.options);++i?n.length=i:delete this.__on}}}function wr(t,n,e){return function(){var r,i=this.__on,o=function(t){return function(n){t.call(this,n,this.__data__)}}(n);if(i)for(var a=0,u=i.length;a<u;++a)if((r=i[a]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=e),void(r.value=n);this.addEventListener(t.type,o,e),r={type:t.type,name:t.name,value:n,listener:o,options:e},i?i.push(r):this.__on=[r]}}function Sr(t,n,e){var r=He(t),i=r.CustomEvent;"function"==typeof i?i=new i(n,e):(i=r.document.createEvent("Event"),e?(i.initEvent(n,e.bubbles,e.cancelable),i.detail=e.detail):i.initEvent(n,!1,!1)),t.dispatchEvent(i)}function Ar(t,n){return function(){return Sr(this,t,n)}}function Mr(t,n){return function(){return Sr(this,t,n.apply(this,arguments))}}Je.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var n=this._names.indexOf(t);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var kr=u().mark(Tr);function Tr(){var t,n,e,r,i,o,a;return u().wrap((function(u){for(;;)switch(u.prev=u.next){case 0:t=this._groups,n=0,e=t.length;case 1:if(!(n<e)){u.next=13;break}r=t[n],i=0,o=r.length;case 3:if(!(i<o)){u.next=10;break}if(!(a=r[i])){u.next=7;break}return u.next=7,a;case 7:++i,u.next=3;break;case 10:++n,u.next=1;break;case 13:case"end":return u.stop()}}),kr,this)}var Er=[null];function Cr(t,n){this._groups=t,this._parents=n}function Or(){return new Cr([[document.documentElement]],Er)}Cr.prototype=Or.prototype=function(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}({constructor:Cr,select:function(t){"function"!=typeof t&&(t=pe(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,a,u=n[i],c=u.length,f=r[i]=new Array(c),s=0;s<c;++s)(o=u[s])&&(a=t.call(o,o.__data__,s,u))&&("__data__"in o&&(a.__data__=o.__data__),f[s]=a);return new Cr(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){var n=t.apply(this,arguments);return null==n?[]:ve(n)}}(t):me(t);for(var n=this._groups,e=n.length,r=[],i=[],o=0;o<e;++o)for(var a,u=n[o],c=u.length,f=0;f<c;++f)(a=u[f])&&(r.push(t.call(a,a.__data__,f,u)),i.push(a));return new Cr(r,i)},selectChild:function(t){return this.select(null==t?we:function(t){return function(){return _e.call(this.children,t)}}("function"==typeof t?t:xe(t)))},selectChildren:function(t){return this.selectAll(null==t?Ae:function(t){return function(){return Se.call(this.children,t)}}("function"==typeof t?t:xe(t)))},filter:function(t){"function"!=typeof t&&(t=be(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,a=n[i],u=a.length,c=r[i]=[],f=0;f<u;++f)(o=a[f])&&t.call(o,o.__data__,f,a)&&c.push(o);return new Cr(r,this._parents)},data:function(t,n){if(!arguments.length)return Array.from(this,Oe);var e=n?Ce:Ee,r=this._parents,i=this._groups;"function"!=typeof t&&(t=Te(t));for(var o=i.length,a=new Array(o),u=new Array(o),c=new Array(o),f=0;f<o;++f){var s=r[f],l=i[f],h=l.length,d=ve(t.call(s,s&&s.__data__,f,r)),p=d.length,y=u[f]=new Array(p),v=a[f]=new Array(p),g=c[f]=new Array(h);e(s,l,y,v,g,d,n);for(var m,b,x=0,_=0;x<p;++x)if(m=y[x]){for(x>=_&&(_=x+1);!(b=v[_])&&++_<p;);m._next=b||null}}return(a=new Cr(a,r))._enter=u,a._exit=c,a},enter:function(){return new Cr(this._enter||this._groups.map(Me),this._parents)},exit:function(){return new Cr(this._exit||this._groups.map(Me),this._parents)},join:function(t,n,e){var r=this.enter(),i=this,o=this.exit();return r="function"==typeof t?t(r):r.append(t+""),null!=n&&(i=n(i)),null==e?o.remove():e(o),r&&i?r.merge(i).order():i},merge:function(t){if(!(t instanceof Cr))throw new Error("invalid merge");for(var n=this._groups,e=t._groups,r=n.length,i=e.length,o=Math.min(r,i),a=new Array(r),u=0;u<o;++u)for(var c,f=n[u],s=e[u],l=f.length,h=a[u]=new Array(l),d=0;d<l;++d)(c=f[d]||s[d])&&(h[d]=c);for(;u<r;++u)a[u]=n[u];return new Cr(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,n=-1,e=t.length;++n<e;)for(var r,i=t[n],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function n(n,e){return n&&e?t(n.__data__,e.__data__):!n-!e}t||(t=Pe);for(var e=this._groups,r=e.length,i=new Array(r),o=0;o<r;++o){for(var a,u=e[o],c=u.length,f=i[o]=new Array(c),s=0;s<c;++s)(a=u[s])&&(f[s]=a);f.sort(n)}return new Cr(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r=t[n],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){var t,n=0,e=Ne(this);try{for(e.s();!(t=e.n()).done;){t.value;++n}}catch(t){e.e(t)}finally{e.f()}return n},empty:function(){return!this.node()},each:function(t){for(var n=this._groups,e=0,r=n.length;e<r;++e)for(var i,o=n[e],a=0,u=o.length;a<u;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,n){var e=je(t);if(arguments.length<2){var r=this.node();return e.local?r.getAttributeNS(e.space,e.local):r.getAttribute(e)}return this.each((null==n?e.local?Ve:ze:"function"==typeof n?e.local?Be:Fe:e.local?Ue:Le)(e,n))},style:function(t,n,e){return arguments.length>1?this.each((null==n?qe:"function"==typeof n?Xe:Ye)(t,n,null==e?"":e)):$e(this.node(),t)},property:function(t,n){return arguments.length>1?this.each((null==n?We:"function"==typeof n?Qe:Ge)(t,n)):this.node()[t]},classed:function(t,n){var e=Ze(t+"");if(arguments.length<2){for(var r=Ke(this.node()),i=-1,o=e.length;++i<o;)if(!r.contains(e[i]))return!1;return!0}return this.each(("function"==typeof n?ir:n?er:rr)(e,n))},text:function(t){return arguments.length?this.each(null==t?or:("function"==typeof t?ur:ar)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?cr:("function"==typeof t?sr:fr)(t)):this.node().innerHTML},raise:function(){return this.each(lr)},lower:function(){return this.each(hr)},append:function(t){var n="function"==typeof t?t:yr(t);return this.select((function(){return this.appendChild(n.apply(this,arguments))}))},insert:function(t,n){var e="function"==typeof t?t:yr(t),r=null==n?vr:"function"==typeof n?n:pe(n);return this.select((function(){return this.insertBefore(e.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(gr)},clone:function(t){return this.select(t?br:mr)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,n,e){var r,i,o=xr(t+""),a=o.length;if(!(arguments.length<2)){for(u=n?wr:_r,r=0;r<a;++r)this.each(u(o[r],n,e));return this}var u=this.node().__on;if(u)for(var c,f=0,s=u.length;f<s;++f)for(r=0,c=u[f];r<a;++r)if((i=o[r]).type===c.type&&i.name===c.name)return c.value},dispatch:function(t,n){return this.each(("function"==typeof n?Mr:Ar)(t,n))}},Symbol.iterator,Tr);var Pr=Or;function Nr(t){return"string"==typeof t?new Cr([[document.querySelector(t)]],[document.documentElement]):new Cr([[t]],Er)}function Ir(t){t.stopImmediatePropagation()}function Rr(t){t.preventDefault(),t.stopImmediatePropagation()}function Dr(t){var n=t.document.documentElement,e=Nr(t).on("dragstart.drag",Rr,!0);"onselectstart"in n?e.on("selectstart.drag",Rr,!0):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function jr(t,n){var e=t.document.documentElement,r=Nr(t).on("dragstart.drag",null);n&&(r.on("click.drag",Rr,!0),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in e?r.on("selectstart.drag",null):(e.style.MozUserSelect=e.__noselect,delete e.__noselect)}function zr(t,n,e){t.prototype=n.prototype=e,e.constructor=t}function Vr(t,n){var e=Object.create(t.prototype);for(var r in n)e[r]=n[r];return e}function Lr(){}var Ur=.7,Fr=1/Ur,Br="\\s*([+-]?\\d+)\\s*",Hr="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",qr="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Yr=/^#([0-9a-f]{3,8})$/,Xr=new RegExp("^rgb\\("+[Br,Br,Br]+"\\)$"),$r=new RegExp("^rgb\\("+[qr,qr,qr]+"\\)$"),Wr=new RegExp("^rgba\\("+[Br,Br,Br,Hr]+"\\)$"),Gr=new RegExp("^rgba\\("+[qr,qr,qr,Hr]+"\\)$"),Qr=new RegExp("^hsl\\("+[Hr,qr,qr]+"\\)$"),Zr=new RegExp("^hsla\\("+[Hr,qr,qr,Hr]+"\\)$"),Kr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Jr(){return this.rgb().formatHex()}function ti(){return this.rgb().formatRgb()}function ni(t){var n,e;return t=(t+"").trim().toLowerCase(),(n=Yr.exec(t))?(e=n[1].length,n=parseInt(n[1],16),6===e?ei(n):3===e?new ai(n>>8&15|n>>4&240,n>>4&15|240&n,(15&n)<<4|15&n,1):8===e?ri(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):4===e?ri(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|240&n,((15&n)<<4|15&n)/255):null):(n=Xr.exec(t))?new ai(n[1],n[2],n[3],1):(n=$r.exec(t))?new ai(255*n[1]/100,255*n[2]/100,255*n[3]/100,1):(n=Wr.exec(t))?ri(n[1],n[2],n[3],n[4]):(n=Gr.exec(t))?ri(255*n[1]/100,255*n[2]/100,255*n[3]/100,n[4]):(n=Qr.exec(t))?si(n[1],n[2]/100,n[3]/100,1):(n=Zr.exec(t))?si(n[1],n[2]/100,n[3]/100,n[4]):Kr.hasOwnProperty(t)?ei(Kr[t]):"transparent"===t?new ai(NaN,NaN,NaN,0):null}function ei(t){return new ai(t>>16&255,t>>8&255,255&t,1)}function ri(t,n,e,r){return r<=0&&(t=n=e=NaN),new ai(t,n,e,r)}function ii(t){return t instanceof Lr||(t=ni(t)),t?new ai((t=t.rgb()).r,t.g,t.b,t.opacity):new ai}function oi(t,n,e,r){return 1===arguments.length?ii(t):new ai(t,n,e,null==r?1:r)}function ai(t,n,e,r){this.r=+t,this.g=+n,this.b=+e,this.opacity=+r}function ui(){return"#"+fi(this.r)+fi(this.g)+fi(this.b)}function ci(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function fi(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function si(t,n,e,r){return r<=0?t=n=e=NaN:e<=0||e>=1?t=n=NaN:n<=0&&(t=NaN),new di(t,n,e,r)}function li(t){if(t instanceof di)return new di(t.h,t.s,t.l,t.opacity);if(t instanceof Lr||(t=ni(t)),!t)return new di;if(t instanceof di)return t;var n=(t=t.rgb()).r/255,e=t.g/255,r=t.b/255,i=Math.min(n,e,r),o=Math.max(n,e,r),a=NaN,u=o-i,c=(o+i)/2;return u?(a=n===o?(e-r)/u+6*(e<r):e===o?(r-n)/u+2:(n-e)/u+4,u/=c<.5?o+i:2-o-i,a*=60):u=c>0&&c<1?0:a,new di(a,u,c,t.opacity)}function hi(t,n,e,r){return 1===arguments.length?li(t):new di(t,n,e,null==r?1:r)}function di(t,n,e,r){this.h=+t,this.s=+n,this.l=+e,this.opacity=+r}function pi(t,n,e){return 255*(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)}function yi(t,n,e,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*n+(4-6*o+3*a)*e+(1+3*t+3*o-3*a)*r+a*i)/6}function vi(t){var n=t.length-1;return function(e){var r=e<=0?e=0:e>=1?(e=1,n-1):Math.floor(e*n),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,u=r<n-1?t[r+2]:2*o-i;return yi((e-r/n)*n,a,i,o,u)}}function gi(t){var n=t.length;return function(e){var r=Math.floor(((e%=1)<0?++e:e)*n),i=t[(r+n-1)%n],o=t[r%n],a=t[(r+1)%n],u=t[(r+2)%n];return yi((e-r/n)*n,i,o,a,u)}}zr(Lr,ni,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Jr,formatHex:Jr,formatHsl:function(){return li(this).formatHsl()},formatRgb:ti,toString:ti}),zr(ai,oi,Vr(Lr,{brighter:function(t){return t=null==t?Fr:Math.pow(Fr,t),new ai(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?Ur:Math.pow(Ur,t),new ai(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ui,formatHex:ui,formatRgb:ci,toString:ci})),zr(di,hi,Vr(Lr,{brighter:function(t){return t=null==t?Fr:Math.pow(Fr,t),new di(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Ur:Math.pow(Ur,t),new di(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,r=e+(e<.5?e:1-e)*n,i=2*e-r;return new ai(pi(t>=240?t-240:t+120,i,r),pi(t,i,r),pi(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var mi=function(t){return function(){return t}};function bi(t,n){return function(e){return t+e*n}}function xi(t,n){var e=n-t;return e?bi(t,e>180||e<-180?e-360*Math.round(e/360):e):mi(isNaN(t)?n:t)}function _i(t){return 1==(t=+t)?wi:function(n,e){return e-n?function(t,n,e){return t=Math.pow(t,e),n=Math.pow(n,e)-t,e=1/e,function(r){return Math.pow(t+r*n,e)}}(n,e,t):mi(isNaN(n)?e:n)}}function wi(t,n){var e=n-t;return e?bi(t,e):mi(isNaN(t)?n:t)}var Si=function t(n){var e=_i(n);function r(t,n){var r=e((t=oi(t)).r,(n=oi(n)).r),i=e(t.g,n.g),o=e(t.b,n.b),a=wi(t.opacity,n.opacity);return function(n){return t.r=r(n),t.g=i(n),t.b=o(n),t.opacity=a(n),t+""}}return r.gamma=t,r}(1);function Ai(t){return function(n){var e,r,i=n.length,o=new Array(i),a=new Array(i),u=new Array(i);for(e=0;e<i;++e)r=oi(n[e]),o[e]=r.r||0,a[e]=r.g||0,u[e]=r.b||0;return o=t(o),a=t(a),u=t(u),r.opacity=1,function(t){return r.r=o(t),r.g=a(t),r.b=u(t),r+""}}}var Mi=Ai(vi),ki=Ai(gi);function Ti(t,n){n||(n=[]);var e,r=t?Math.min(n.length,t.length):0,i=n.slice();return function(o){for(e=0;e<r;++e)i[e]=t[e]*(1-o)+n[e]*o;return i}}function Ei(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Ci(t,n){return(Ei(n)?Ti:Oi)(t,n)}function Oi(t,n){var e,r=n?n.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),a=new Array(r);for(e=0;e<i;++e)o[e]=Li(t[e],n[e]);for(;e<r;++e)a[e]=n[e];return function(t){for(e=0;e<i;++e)a[e]=o[e](t);return a}}function Pi(t,n){var e=new Date;return t=+t,n=+n,function(r){return e.setTime(t*(1-r)+n*r),e}}function Ni(t,n){return t=+t,n=+n,function(e){return t*(1-e)+n*e}}function Ii(t){return(Ii="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ri(t,n){var e,r={},i={};for(e in null!==t&&"object"===Ii(t)||(t={}),null!==n&&"object"===Ii(n)||(n={}),n)e in t?r[e]=Li(t[e],n[e]):i[e]=n[e];return function(t){for(e in r)i[e]=r[e](t);return i}}var Di=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ji=new RegExp(Di.source,"g");function zi(t,n){var e,r,i,o=Di.lastIndex=ji.lastIndex=0,a=-1,u=[],c=[];for(t+="",n+="";(e=Di.exec(t))&&(r=ji.exec(n));)(i=r.index)>o&&(i=n.slice(o,i),u[a]?u[a]+=i:u[++a]=i),(e=e[0])===(r=r[0])?u[a]?u[a]+=r:u[++a]=r:(u[++a]=null,c.push({i:a,x:Ni(e,r)})),o=ji.lastIndex;return o<n.length&&(i=n.slice(o),u[a]?u[a]+=i:u[++a]=i),u.length<2?c[0]?function(t){return function(n){return t(n)+""}}(c[0].x):function(t){return function(){return t}}(n):(n=c.length,function(t){for(var e,r=0;r<n;++r)u[(e=c[r]).i]=e.x(t);return u.join("")})}function Vi(t){return(Vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Li(t,n){var e,r=Vi(n);return null==n||"boolean"===r?mi(n):("number"===r?Ni:"string"===r?(e=ni(n))?(n=e,Si):zi:n instanceof ni?Si:n instanceof Date?Pi:Ei(n)?Ti:Array.isArray(n)?Oi:"function"!=typeof n.valueOf&&"function"!=typeof n.toString||isNaN(n)?Ri:Ni)(t,n)}function Ui(t){for(var n;n=t.sourceEvent;)t=n;return t}function Fi(t,n){if(t=Ui(t),void 0===n&&(n=t.currentTarget),n){var e=n.ownerSVGElement||n;if(e.createSVGPoint){var r=e.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(n.getScreenCTM().inverse())).x,r.y]}if(n.getBoundingClientRect){var i=n.getBoundingClientRect();return[t.clientX-i.left-n.clientLeft,t.clientY-i.top-n.clientTop]}}return[t.pageX,t.pageY]}function Bi(t){return(Bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var Hi,qi,Yi=0,Xi=0,$i=0,Wi=0,Gi=0,Qi=0,Zi="object"===("undefined"==typeof performance?"undefined":Bi(performance))&&performance.now?performance:Date,Ki="object"===("undefined"==typeof window?"undefined":Bi(window))&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Ji(){return Gi||(Ki(to),Gi=Zi.now()+Qi)}function to(){Gi=0}function no(){this._call=this._time=this._next=null}function eo(t,n,e){var r=new no;return r.restart(t,n,e),r}function ro(){Ji(),++Yi;for(var t,n=Hi;n;)(t=Gi-n._time)>=0&&n._call.call(null,t),n=n._next;--Yi}function io(){Gi=(Wi=Zi.now())+Qi,Yi=Xi=0;try{ro()}finally{Yi=0,function(){var t,n,e=Hi,r=1/0;for(;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Hi=n);qi=t,ao(r)}(),Gi=0}}function oo(){var t=Zi.now(),n=t-Wi;n>1e3&&(Qi-=n,Wi=t)}function ao(t){Yi||(Xi&&(Xi=clearTimeout(Xi)),t-Gi>24?(t<1/0&&(Xi=setTimeout(io,t-Zi.now()-Qi)),$i&&($i=clearInterval($i))):($i||(Wi=Zi.now(),$i=setInterval(oo,1e3)),Yi=1,Ki(io)))}function uo(t,n,e){var r=new no;return n=null==n?0:+n,r.restart((function(e){r.stop(),t(e+n)}),n,e),r}no.prototype=eo.prototype={constructor:no,restart:function(t,n,e){if("function"!=typeof t)throw new TypeError("callback is not a function");e=(null==e?Ji():+e)+(null==n?0:+n),this._next||qi===this||(qi?qi._next=this:Hi=this,qi=this),this._call=t,this._time=e,ao()},stop:function(){this._call&&(this._call=null,this._time=1/0,ao())}};var co=he("start","end","cancel","interrupt"),fo=[];function so(t,n,e,r,i,o){var a=t.__transition;if(a){if(e in a)return}else t.__transition={};!function(t,n,e){var r,i=t.__transition;function o(t){e.state=1,e.timer.restart(a,e.delay,e.time),e.delay<=t&&a(t-e.delay)}function a(o){var f,s,l,h;if(1!==e.state)return c();for(f in i)if((h=i[f]).name===e.name){if(3===h.state)return uo(a);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete i[f]):+f<n&&(h.state=6,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete i[f])}if(uo((function(){3===e.state&&(e.state=4,e.timer.restart(u,e.delay,e.time),u(o))})),e.state=2,e.on.call("start",t,t.__data__,e.index,e.group),2===e.state){for(e.state=3,r=new Array(l=e.tween.length),f=0,s=-1;f<l;++f)(h=e.tween[f].value.call(t,t.__data__,e.index,e.group))&&(r[++s]=h);r.length=s+1}}function u(n){for(var i=n<e.duration?e.ease.call(null,n/e.duration):(e.timer.restart(c),e.state=5,1),o=-1,a=r.length;++o<a;)r[o].call(t,i);5===e.state&&(e.on.call("end",t,t.__data__,e.index,e.group),c())}function c(){for(var r in e.state=6,e.timer.stop(),delete i[n],i)return;delete t.__transition}i[n]=e,e.timer=eo(o,0,e.time)}(t,e,{name:n,index:r,group:i,on:co,tween:fo,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function lo(t,n){var e=po(t,n);if(e.state>0)throw new Error("too late; already scheduled");return e}function ho(t,n){var e=po(t,n);if(e.state>3)throw new Error("too late; already running");return e}function po(t,n){var e=t.__transition;if(!e||!(e=e[n]))throw new Error("transition not found");return e}function yo(t,n){var e,r,i,o=t.__transition,a=!0;if(o){for(i in n=null==n?null:n+"",o)(e=o[i]).name===n?(r=e.state>2&&e.state<5,e.state=6,e.timer.stop(),e.on.call(r?"interrupt":"cancel",t,t.__data__,e.index,e.group),delete o[i]):a=!1;a&&delete t.__transition}}var vo,go=180/Math.PI,mo={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function bo(t,n,e,r,i,o){var a,u,c;return(a=Math.sqrt(t*t+n*n))&&(t/=a,n/=a),(c=t*e+n*r)&&(e-=t*c,r-=n*c),(u=Math.sqrt(e*e+r*r))&&(e/=u,r/=u,c/=u),t*r<n*e&&(t=-t,n=-n,c=-c,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(n,t)*go,skewX:Math.atan(c)*go,scaleX:a,scaleY:u}}function xo(t,n,e,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var u=[],c=[];return o=t(o),a=t(a),function(t,r,i,o,a,u){if(t!==i||r!==o){var c=a.push("translate(",null,n,null,e);u.push({i:c-4,x:Ni(t,i)},{i:c-2,x:Ni(r,o)})}else(i||o)&&a.push("translate("+i+n+o+e)}(o.translateX,o.translateY,a.translateX,a.translateY,u,c),function(t,n,e,o){t!==n?(t-n>180?n+=360:n-t>180&&(t+=360),o.push({i:e.push(i(e)+"rotate(",null,r)-2,x:Ni(t,n)})):n&&e.push(i(e)+"rotate("+n+r)}(o.rotate,a.rotate,u,c),function(t,n,e,o){t!==n?o.push({i:e.push(i(e)+"skewX(",null,r)-2,x:Ni(t,n)}):n&&e.push(i(e)+"skewX("+n+r)}(o.skewX,a.skewX,u,c),function(t,n,e,r,o,a){if(t!==e||n!==r){var u=o.push(i(o)+"scale(",null,",",null,")");a.push({i:u-4,x:Ni(t,e)},{i:u-2,x:Ni(n,r)})}else 1===e&&1===r||o.push(i(o)+"scale("+e+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,u,c),o=a=null,function(t){for(var n,e=-1,r=c.length;++e<r;)u[(n=c[e]).i]=n.x(t);return u.join("")}}}var _o=xo((function(t){var n=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return n.isIdentity?mo:bo(n.a,n.b,n.c,n.d,n.e,n.f)}),"px, ","px)","deg)"),wo=xo((function(t){return null==t?mo:(vo||(vo=document.createElementNS("http://www.w3.org/2000/svg","g")),vo.setAttribute("transform",t),(t=vo.transform.baseVal.consolidate())?bo((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):mo)}),", ",")",")");function So(t,n){var e,r;return function(){var i=ho(this,t),o=i.tween;if(o!==e)for(var a=0,u=(r=e=o).length;a<u;++a)if(r[a].name===n){(r=r.slice()).splice(a,1);break}i.tween=r}}function Ao(t,n,e){var r,i;if("function"!=typeof e)throw new Error;return function(){var o=ho(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var u={name:n,value:e},c=0,f=i.length;c<f;++c)if(i[c].name===n){i[c]=u;break}c===f&&i.push(u)}o.tween=i}}function Mo(t,n,e){var r=t._id;return t.each((function(){var t=ho(this,r);(t.value||(t.value={}))[n]=e.apply(this,arguments)})),function(t){return po(t,r).value[n]}}function ko(t,n){var e;return("number"==typeof n?Ni:n instanceof ni?Si:(e=ni(n))?(n=e,Si):zi)(t,n)}function To(t){return function(){this.removeAttribute(t)}}function Eo(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Co(t,n,e){var r,i,o=e+"";return function(){var a=this.getAttribute(t);return a===o?null:a===r?i:i=n(r=a,e)}}function Oo(t,n,e){var r,i,o=e+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===r?i:i=n(r=a,e)}}function Po(t,n,e){var r,i,o;return function(){var a,u,c=e(this);if(null!=c)return(a=this.getAttribute(t))===(u=c+"")?null:a===r&&u===i?o:(i=u,o=n(r=a,c));this.removeAttribute(t)}}function No(t,n,e){var r,i,o;return function(){var a,u,c=e(this);if(null!=c)return(a=this.getAttributeNS(t.space,t.local))===(u=c+"")?null:a===r&&u===i?o:(i=u,o=n(r=a,c));this.removeAttributeNS(t.space,t.local)}}function Io(t,n){return function(e){this.setAttribute(t,n.call(this,e))}}function Ro(t,n){return function(e){this.setAttributeNS(t.space,t.local,n.call(this,e))}}function Do(t,n){var e,r;function i(){var i=n.apply(this,arguments);return i!==r&&(e=(r=i)&&Ro(t,i)),e}return i._value=n,i}function jo(t,n){var e,r;function i(){var i=n.apply(this,arguments);return i!==r&&(e=(r=i)&&Io(t,i)),e}return i._value=n,i}function zo(t,n){return function(){lo(this,t).delay=+n.apply(this,arguments)}}function Vo(t,n){return n=+n,function(){lo(this,t).delay=n}}function Lo(t,n){return function(){ho(this,t).duration=+n.apply(this,arguments)}}function Uo(t,n){return n=+n,function(){ho(this,t).duration=n}}function Fo(t,n){if("function"!=typeof n)throw new Error;return function(){ho(this,t).ease=n}}function Bo(t,n,e){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||"start"===t}))}(n)?lo:ho;return function(){var a=o(this,t),u=a.on;u!==r&&(i=(r=u).copy()).on(n,e),a.on=i}}var Ho=Pr.prototype.constructor;function qo(t){return function(){this.style.removeProperty(t)}}function Yo(t,n,e){return function(r){this.style.setProperty(t,n.call(this,r),e)}}function Xo(t,n,e){var r,i;function o(){var o=n.apply(this,arguments);return o!==i&&(r=(i=o)&&Yo(t,o,e)),r}return o._value=n,o}function $o(t){return function(n){this.textContent=t.call(this,n)}}function Wo(t){var n,e;function r(){var r=t.apply(this,arguments);return r!==e&&(n=(e=r)&&$o(r)),n}return r._value=t,r}var Go=0;function Qo(t,n,e,r){this._groups=t,this._parents=n,this._name=e,this._id=r}function Zo(t){return Pr().transition(t)}function Ko(){return++Go}var Jo=Pr.prototype;function ta(t){return t*t*t}function na(t){return--t*t*t+1}function ea(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}Qo.prototype=Zo.prototype=function(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}({constructor:Qo,select:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=pe(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var u,c,f=r[a],s=f.length,l=o[a]=new Array(s),h=0;h<s;++h)(u=f[h])&&(c=t.call(u,u.__data__,h,f))&&("__data__"in u&&(c.__data__=u.__data__),l[h]=c,so(l[h],n,e,h,l,po(u,e)));return new Qo(o,this._parents,n,e)},selectAll:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=me(t));for(var r=this._groups,i=r.length,o=[],a=[],u=0;u<i;++u)for(var c,f=r[u],s=f.length,l=0;l<s;++l)if(c=f[l]){for(var h,d=t.call(c,c.__data__,l,f),p=po(c,e),y=0,v=d.length;y<v;++y)(h=d[y])&&so(h,n,e,y,d,p);o.push(d),a.push(c)}return new Qo(o,a,n,e)},filter:function(t){"function"!=typeof t&&(t=be(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,a=n[i],u=a.length,c=r[i]=[],f=0;f<u;++f)(o=a[f])&&t.call(o,o.__data__,f,a)&&c.push(o);return new Qo(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var n=this._groups,e=t._groups,r=n.length,i=e.length,o=Math.min(r,i),a=new Array(r),u=0;u<o;++u)for(var c,f=n[u],s=e[u],l=f.length,h=a[u]=new Array(l),d=0;d<l;++d)(c=f[d]||s[d])&&(h[d]=c);for(;u<r;++u)a[u]=n[u];return new Qo(a,this._parents,this._name,this._id)},selection:function(){return new Ho(this._groups,this._parents)},transition:function(){for(var t=this._name,n=this._id,e=Ko(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,u=r[o],c=u.length,f=0;f<c;++f)if(a=u[f]){var s=po(a,n);so(a,t,e,f,u,{time:s.time+s.delay+s.duration,delay:0,duration:s.duration,ease:s.ease})}return new Qo(r,this._parents,t,e)},call:Jo.call,nodes:Jo.nodes,node:Jo.node,size:Jo.size,empty:Jo.empty,each:Jo.each,on:function(t,n){var e=this._id;return arguments.length<2?po(this.node(),e).on.on(t):this.each(Bo(e,t,n))},attr:function(t,n){var e=je(t),r="transform"===e?wo:ko;return this.attrTween(t,"function"==typeof n?(e.local?No:Po)(e,r,Mo(this,"attr."+t,n)):null==n?(e.local?Eo:To)(e):(e.local?Oo:Co)(e,r,n))},attrTween:function(t,n){var e="attr."+t;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(null==n)return this.tween(e,null);if("function"!=typeof n)throw new Error;var r=je(t);return this.tween(e,(r.local?Do:jo)(r,n))},style:function(t,n,e){var r="transform"==(t+="")?_o:ko;return null==n?this.styleTween(t,function(t,n){var e,r,i;return function(){var o=$e(this,t),a=(this.style.removeProperty(t),$e(this,t));return o===a?null:o===e&&a===r?i:i=n(e=o,r=a)}}(t,r)).on("end.style."+t,qo(t)):"function"==typeof n?this.styleTween(t,function(t,n,e){var r,i,o;return function(){var a=$e(this,t),u=e(this),c=u+"";return null==u&&(this.style.removeProperty(t),c=u=$e(this,t)),a===c?null:a===r&&c===i?o:(i=c,o=n(r=a,u))}}(t,r,Mo(this,"style."+t,n))).each(function(t,n){var e,r,i,o,a="style."+n,u="end."+a;return function(){var c=ho(this,t),f=c.on,s=null==c.value[a]?o||(o=qo(n)):void 0;f===e&&i===s||(r=(e=f).copy()).on(u,i=s),c.on=r}}(this._id,t)):this.styleTween(t,function(t,n,e){var r,i,o=e+"";return function(){var a=$e(this,t);return a===o?null:a===r?i:i=n(r=a,e)}}(t,r,n),e).on("end.style."+t,null)},styleTween:function(t,n,e){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==n)return this.tween(r,null);if("function"!=typeof n)throw new Error;return this.tween(r,Xo(t,n,null==e?"":e))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var n=t(this);this.textContent=null==n?"":n}}(Mo(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;return this.tween(n,Wo(t))},remove:function(){return this.on("end.remove",function(t){return function(){var n=this.parentNode;for(var e in this.__transition)if(+e!==t)return;n&&n.removeChild(this)}}(this._id))},tween:function(t,n){var e=this._id;if(t+="",arguments.length<2){for(var r,i=po(this.node(),e).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==n?So:Ao)(e,t,n))},delay:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?zo:Vo)(n,t)):po(this.node(),n).delay},duration:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?Lo:Uo)(n,t)):po(this.node(),n).duration},ease:function(t){var n=this._id;return arguments.length?this.each(Fo(n,t)):po(this.node(),n).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,n){return function(){var e=n.apply(this,arguments);if("function"!=typeof e)throw new Error;ho(this,t).ease=e}}(this._id,t))},end:function(){var t,n,e=this,r=e._id,i=e.size();return new Promise((function(o,a){var u={value:a},c={value:function(){0==--i&&o()}};e.each((function(){var e=ho(this,r),i=e.on;i!==t&&((n=(t=i).copy())._.cancel.push(u),n._.interrupt.push(u),n._.end.push(c)),e.on=n})),0===i&&o()}))}},Symbol.iterator,Jo[Symbol.iterator]);var ra={time:null,delay:0,duration:250,ease:ea};function ia(t,n){for(var e;!(e=t.__transition)||!(e=e[n]);)if(!(t=t.parentNode))throw new Error("transition ".concat(n," not found"));return e}Pr.prototype.interrupt=function(t){return this.each((function(){yo(this,t)}))},Pr.prototype.transition=function(t){var n,e;t instanceof Qo?(n=t._id,t=t._name):(n=Ko(),(e=ra).time=Ji(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,u=r[o],c=u.length,f=0;f<c;++f)(a=u[f])&&so(a,t,n,f,u,e||ia(a,n));return new Qo(r,this._parents,t,n)};var oa=[null];function aa(t,n){var e,r,i=t.__transition;if(i)for(r in n=null==n?null:n+"",i)if((e=i[r]).state>1&&e.name===n)return new Qo([[t]],oa,n,+r);return null}var ua=function(t){return function(){return t}};function ca(t,n){var e=n.sourceEvent,r=n.target,i=n.selection,o=n.mode,a=n.dispatch;Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},selection:{value:i,enumerable:!0,configurable:!0},mode:{value:o,enumerable:!0,configurable:!0},_:{value:a}})}function fa(t){t.stopImmediatePropagation()}function sa(t){t.preventDefault(),t.stopImmediatePropagation()}function la(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return ha(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return ha(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function ha(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var da={name:"drag"},pa={name:"space"},ya={name:"handle"},va={name:"center"},ga=Math.abs,ma=Math.max,ba=Math.min;function xa(t){return[+t[0],+t[1]]}function _a(t){return[xa(t[0]),xa(t[1])]}var wa={name:"x",handles:["w","e"].map(Oa),input:function(t,n){return null==t?null:[[+t[0],n[0][1]],[+t[1],n[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},Sa={name:"y",handles:["n","s"].map(Oa),input:function(t,n){return null==t?null:[[n[0][0],+t[0]],[n[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},Aa={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(Oa),input:function(t){return null==t?null:_a(t)},output:function(t){return t}},Ma={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},ka={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},Ta={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},Ea={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},Ca={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function Oa(t){return{type:t}}function Pa(t){return!t.ctrlKey&&!t.button}function Na(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function Ia(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ra(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function Da(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function ja(t){var n=t.__brush;return n?n.dim.output(n.selection):null}function za(){return Ua(wa)}function Va(){return Ua(Sa)}function La(){return Ua(Aa)}function Ua(t){var n,e=Na,r=Pa,i=Ia,o=!0,a=he("start","brush","end"),u=6;function c(n){var e=n.property("__brush",y).selectAll(".overlay").data([Oa("overlay")]);e.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",Ma.overlay).merge(e).each((function(){var t=Ra(this).extent;Nr(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])})),n.selectAll(".selection").data([Oa("selection")]).enter().append("rect").attr("class","selection").attr("cursor",Ma.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var r=n.selectAll(".handle").data(t.handles,(function(t){return t.type}));r.exit().remove(),r.enter().append("rect").attr("class",(function(t){return"handle handle--"+t.type})).attr("cursor",(function(t){return Ma[t.type]})),n.each(f).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",h).filter(i).on("touchstart.brush",h).on("touchmove.brush",d).on("touchend.brush touchcancel.brush",p).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(){var t=Nr(this),n=Ra(this).selection;n?(t.selectAll(".selection").style("display",null).attr("x",n[0][0]).attr("y",n[0][1]).attr("width",n[1][0]-n[0][0]).attr("height",n[1][1]-n[0][1]),t.selectAll(".handle").style("display",null).attr("x",(function(t){return"e"===t.type[t.type.length-1]?n[1][0]-u/2:n[0][0]-u/2})).attr("y",(function(t){return"s"===t.type[0]?n[1][1]-u/2:n[0][1]-u/2})).attr("width",(function(t){return"n"===t.type||"s"===t.type?n[1][0]-n[0][0]+u:u})).attr("height",(function(t){return"e"===t.type||"w"===t.type?n[1][1]-n[0][1]+u:u}))):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function s(t,n,e){var r=t.__brush.emitter;return!r||e&&r.clean?new l(t,n,e):r}function l(t,n,e){this.that=t,this.args=n,this.state=t.__brush,this.active=0,this.clean=e}function h(e){if((!n||e.touches)&&r.apply(this,arguments)){var i,a,u,c,l,h,d,p,y,v,g,m=this,b=e.target.__data__.type,x="selection"===(o&&e.metaKey?b="overlay":b)?da:o&&e.altKey?va:ya,_=t===Sa?null:Ea[b],w=t===wa?null:Ca[b],S=Ra(m),A=S.extent,M=S.selection,k=A[0][0],T=A[0][1],E=A[1][0],C=A[1][1],O=0,P=0,N=_&&w&&o&&e.shiftKey,I=Array.from(e.touches||[e],(function(t){var n=t.identifier;return(t=Fi(t,m)).point0=t.slice(),t.identifier=n,t}));if("overlay"===b){M&&(y=!0);var R=[I[0],I[1]||I[0]];S.selection=M=[[i=t===Sa?k:ba(R[0][0],R[1][0]),u=t===wa?T:ba(R[0][1],R[1][1])],[l=t===Sa?E:ma(R[0][0],R[1][0]),d=t===wa?C:ma(R[0][1],R[1][1])]],I.length>1&&U()}else i=M[0][0],u=M[0][1],l=M[1][0],d=M[1][1];a=i,c=u,h=l,p=d;var D=Nr(m).attr("pointer-events","none"),j=D.selectAll(".overlay").attr("cursor",Ma[b]);yo(m);var z=s(m,arguments,!0).beforestart();if(e.touches)z.moved=L,z.ended=F;else{var V=Nr(e.view).on("mousemove.brush",L,!0).on("mouseup.brush",F,!0);o&&V.on("keydown.brush",B,!0).on("keyup.brush",H,!0),Dr(e.view)}f.call(m),z.start(e,x.name)}function L(t){var n,e=la(t.changedTouches||[t]);try{for(e.s();!(n=e.n()).done;){var r,i=n.value,o=la(I);try{for(o.s();!(r=o.n()).done;){var a=r.value;a.identifier===i.identifier&&(a.cur=Fi(i,m))}}catch(t){o.e(t)}finally{o.f()}}}catch(t){e.e(t)}finally{e.f()}if(N&&!v&&!g&&1===I.length){var u=I[0];ga(u.cur[0]-u[0])>ga(u.cur[1]-u[1])?g=!0:v=!0}var c,f=la(I);try{for(f.s();!(c=f.n()).done;){var s=c.value;s.cur&&(s[0]=s.cur[0],s[1]=s.cur[1])}}catch(t){f.e(t)}finally{f.f()}y=!0,sa(t),U(t)}function U(t){var n,e=I[0],r=e.point0;switch(O=e[0]-r[0],P=e[1]-r[1],x){case pa:case da:_&&(O=ma(k-i,ba(E-l,O)),a=i+O,h=l+O),w&&(P=ma(T-u,ba(C-d,P)),c=u+P,p=d+P);break;case ya:I[1]?(_&&(a=ma(k,ba(E,I[0][0])),h=ma(k,ba(E,I[1][0])),_=1),w&&(c=ma(T,ba(C,I[0][1])),p=ma(T,ba(C,I[1][1])),w=1)):(_<0?(O=ma(k-i,ba(E-i,O)),a=i+O,h=l):_>0&&(O=ma(k-l,ba(E-l,O)),a=i,h=l+O),w<0?(P=ma(T-u,ba(C-u,P)),c=u+P,p=d):w>0&&(P=ma(T-d,ba(C-d,P)),c=u,p=d+P));break;case va:_&&(a=ma(k,ba(E,i-O*_)),h=ma(k,ba(E,l+O*_))),w&&(c=ma(T,ba(C,u-P*w)),p=ma(T,ba(C,d+P*w)))}h<a&&(_*=-1,n=i,i=l,l=n,n=a,a=h,h=n,b in ka&&j.attr("cursor",Ma[b=ka[b]])),p<c&&(w*=-1,n=u,u=d,d=n,n=c,c=p,p=n,b in Ta&&j.attr("cursor",Ma[b=Ta[b]])),S.selection&&(M=S.selection),v&&(a=M[0][0],h=M[1][0]),g&&(c=M[0][1],p=M[1][1]),M[0][0]===a&&M[0][1]===c&&M[1][0]===h&&M[1][1]===p||(S.selection=[[a,c],[h,p]],f.call(m),z.brush(t,x.name))}function F(t){if(fa(t),t.touches){if(t.touches.length)return;n&&clearTimeout(n),n=setTimeout((function(){n=null}),500)}else jr(t.view,y),V.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);D.attr("pointer-events","all"),j.attr("cursor",Ma.overlay),S.selection&&(M=S.selection),Da(M)&&(S.selection=null,f.call(m)),z.end(t,x.name)}function B(t){switch(t.keyCode){case 16:N=_&&w;break;case 18:x===ya&&(_&&(l=h-O*_,i=a+O*_),w&&(d=p-P*w,u=c+P*w),x=va,U());break;case 32:x!==ya&&x!==va||(_<0?l=h-O:_>0&&(i=a-O),w<0?d=p-P:w>0&&(u=c-P),x=pa,j.attr("cursor",Ma.selection),U());break;default:return}sa(t)}function H(t){switch(t.keyCode){case 16:N&&(v=g=N=!1,U());break;case 18:x===va&&(_<0?l=h:_>0&&(i=a),w<0?d=p:w>0&&(u=c),x=ya,U());break;case 32:x===pa&&(t.altKey?(_&&(l=h-O*_,i=a+O*_),w&&(d=p-P*w,u=c+P*w),x=va):(_<0?l=h:_>0&&(i=a),w<0?d=p:w>0&&(u=c),x=ya),j.attr("cursor",Ma[b]),U());break;default:return}sa(t)}}function d(t){s(this,arguments).moved(t)}function p(t){s(this,arguments).ended(t)}function y(){var n=this.__brush||{selection:null};return n.extent=_a(e.apply(this,arguments)),n.dim=t,n}return c.move=function(n,e){n.tween?n.on("start.brush",(function(t){s(this,arguments).beforestart().start(t)})).on("interrupt.brush end.brush",(function(t){s(this,arguments).end(t)})).tween("brush",(function(){var n=this,r=n.__brush,i=s(n,arguments),o=r.selection,a=t.input("function"==typeof e?e.apply(this,arguments):e,r.extent),u=Li(o,a);function c(t){r.selection=1===t&&null===a?null:u(t),f.call(n),i.brush()}return null!==o&&null!==a?c:c(1)})):n.each((function(){var n=this,r=arguments,i=n.__brush,o=t.input("function"==typeof e?e.apply(n,r):e,i.extent),a=s(n,r).beforestart();yo(n),i.selection=null===o?null:o,f.call(n),a.start().brush().end()}))},c.clear=function(t){c.move(t,null)},l.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(t,n){return this.starting?(this.starting=!1,this.emit("start",t,n)):this.emit("brush",t),this},brush:function(t,n){return this.emit("brush",t,n),this},end:function(t,n){return 0==--this.active&&(delete this.state.emitter,this.emit("end",t,n)),this},emit:function(n,e,r){var i=Nr(this.that).datum();a.call(n,this.that,new ca(n,{sourceEvent:e,target:c,selection:t.output(this.state.selection),mode:r,dispatch:a}),i)}},c.extent=function(t){return arguments.length?(e="function"==typeof t?t:ua(_a(t)),c):e},c.filter=function(t){return arguments.length?(r="function"==typeof t?t:ua(!!t),c):r},c.touchable=function(t){return arguments.length?(i="function"==typeof t?t:ua(!!t),c):i},c.handleSize=function(t){return arguments.length?(u=+t,c):u},c.keyModifiers=function(t){return arguments.length?(o=!!t,c):o},c.on=function(){var t=a.on.apply(a,arguments);return t===a?c:t},c}var Fa=Math.abs,Ba=Math.cos,Ha=Math.sin,qa=Math.PI,Ya=qa/2,Xa=2*qa,$a=Math.max,Wa=1e-12;function Ga(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return Qa(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Qa(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Qa(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Za(t,n){return Array.from({length:n-t},(function(n,e){return t+e}))}function Ka(t){return function(n,e){return t(n.source.value+n.target.value,e.source.value+e.target.value)}}function Ja(){return eu(!1,!1)}function tu(){return eu(!1,!0)}function nu(){return eu(!0,!1)}function eu(t,n){var e=0,r=null,i=null,o=null;function a(a){var u,c=a.length,f=new Array(c),s=Za(0,c),l=new Array(c*c),h=new Array(c),d=0;a=Float64Array.from({length:c*c},n?function(t,n){return a[n%c][n/c|0]}:function(t,n){return a[n/c|0][n%c]});for(var p=0;p<c;++p){for(var y=0,v=0;v<c;++v)y+=a[p*c+v]+t*a[v*c+p];d+=f[p]=y}d=$a(0,Xa-e*c)/d,u=d?e:Xa/c;var g=0;r&&s.sort((function(t,n){return r(f[t],f[n])}));var m,b=Ga(s);try{var x=function(){var n=m.value,e=g;if(t){var r=Za(1+~c,c).filter((function(t){return t<0?a[~t*c+n]:a[n*c+t]}));i&&r.sort((function(t,e){return i(t<0?-a[~t*c+n]:a[n*c+t],e<0?-a[~e*c+n]:a[n*c+e])}));var o,s=Ga(r);try{for(s.s();!(o=s.n()).done;){var p=o.value;if(p<0)(l[~p*c+n]||(l[~p*c+n]={source:null,target:null})).target={index:n,startAngle:g,endAngle:g+=a[~p*c+n]*d,value:a[~p*c+n]};else(l[n*c+p]||(l[n*c+p]={source:null,target:null})).source={index:n,startAngle:g,endAngle:g+=a[n*c+p]*d,value:a[n*c+p]}}}catch(t){s.e(t)}finally{s.f()}h[n]={index:n,startAngle:e,endAngle:g,value:f[n]}}else{var y=Za(0,c).filter((function(t){return a[n*c+t]||a[t*c+n]}));i&&y.sort((function(t,e){return i(a[n*c+t],a[n*c+e])}));var v,b=Ga(y);try{for(b.s();!(v=b.n()).done;){var x=v.value,_=void 0;if(n<x?(_=l[n*c+x]||(l[n*c+x]={source:null,target:null})).source={index:n,startAngle:g,endAngle:g+=a[n*c+x]*d,value:a[n*c+x]}:((_=l[x*c+n]||(l[x*c+n]={source:null,target:null})).target={index:n,startAngle:g,endAngle:g+=a[n*c+x]*d,value:a[n*c+x]},n===x&&(_.source=_.target)),_.source&&_.target&&_.source.value<_.target.value){var w=_.source;_.source=_.target,_.target=w}}}catch(t){b.e(t)}finally{b.f()}h[n]={index:n,startAngle:e,endAngle:g,value:f[n]}}g+=u};for(b.s();!(m=b.n()).done;)x()}catch(t){b.e(t)}finally{b.f()}return(l=Object.values(l)).groups=h,o?l.sort(o):l}return a.padAngle=function(t){return arguments.length?(e=$a(0,t),a):e},a.sortGroups=function(t){return arguments.length?(r=t,a):r},a.sortSubgroups=function(t){return arguments.length?(i=t,a):i},a.sortChords=function(t){return arguments.length?(null==t?o=null:(o=Ka(t))._=t,a):o&&o._},a}var ru=Math.PI,iu=2*ru,ou=1e-6,au=iu-ou;function uu(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function cu(){return new uu}uu.prototype=cu.prototype={constructor:uu,moveTo:function(t,n){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,n){this._+="L"+(this._x1=+t)+","+(this._y1=+n)},quadraticCurveTo:function(t,n,e,r){this._+="Q"+ +t+","+ +n+","+(this._x1=+e)+","+(this._y1=+r)},bezierCurveTo:function(t,n,e,r,i,o){this._+="C"+ +t+","+ +n+","+ +e+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,n,e,r,i){t=+t,n=+n,e=+e,r=+r,i=+i;var o=this._x1,a=this._y1,u=e-t,c=r-n,f=o-t,s=a-n,l=f*f+s*s;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=n);else if(l>ou)if(Math.abs(s*u-c*f)>ou&&i){var h=e-o,d=r-a,p=u*u+c*c,y=h*h+d*d,v=Math.sqrt(p),g=Math.sqrt(l),m=i*Math.tan((ru-Math.acos((p+l-y)/(2*v*g)))/2),b=m/g,x=m/v;Math.abs(b-1)>ou&&(this._+="L"+(t+b*f)+","+(n+b*s)),this._+="A"+i+","+i+",0,0,"+ +(s*h>f*d)+","+(this._x1=t+x*u)+","+(this._y1=n+x*c)}else this._+="L"+(this._x1=t)+","+(this._y1=n);else;},arc:function(t,n,e,r,i,o){t=+t,n=+n,o=!!o;var a=(e=+e)*Math.cos(r),u=e*Math.sin(r),c=t+a,f=n+u,s=1^o,l=o?r-i:i-r;if(e<0)throw new Error("negative radius: "+e);null===this._x1?this._+="M"+c+","+f:(Math.abs(this._x1-c)>ou||Math.abs(this._y1-f)>ou)&&(this._+="L"+c+","+f),e&&(l<0&&(l=l%iu+iu),l>au?this._+="A"+e+","+e+",0,1,"+s+","+(t-a)+","+(n-u)+"A"+e+","+e+",0,1,"+s+","+(this._x1=c)+","+(this._y1=f):l>ou&&(this._+="A"+e+","+e+",0,"+ +(l>=ru)+","+s+","+(this._x1=t+e*Math.cos(i))+","+(this._y1=n+e*Math.sin(i))))},rect:function(t,n,e,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)+"h"+ +e+"v"+ +r+"h"+-e+"Z"},toString:function(){return this._}};var fu=cu,su=Array.prototype.slice;function lu(t){return function(){return t}}function hu(t){return t.source}function du(t){return t.target}function pu(t){return t.radius}function yu(t){return t.startAngle}function vu(t){return t.endAngle}function gu(){return 0}function mu(){return 10}function bu(t){var n=hu,e=du,r=pu,i=pu,o=yu,a=vu,u=gu,c=null;function f(){var f,s=n.apply(this,arguments),l=e.apply(this,arguments),h=u.apply(this,arguments)/2,d=su.call(arguments),p=+r.apply(this,(d[0]=s,d)),y=o.apply(this,d)-Ya,v=a.apply(this,d)-Ya,g=+i.apply(this,(d[0]=l,d)),m=o.apply(this,d)-Ya,b=a.apply(this,d)-Ya;if(c||(c=f=fu()),h>Wa&&(Fa(v-y)>2*h+Wa?v>y?(y+=h,v-=h):(y-=h,v+=h):y=v=(y+v)/2,Fa(b-m)>2*h+Wa?b>m?(m+=h,b-=h):(m-=h,b+=h):m=b=(m+b)/2),c.moveTo(p*Ba(y),p*Ha(y)),c.arc(0,0,p,y,v),y!==m||v!==b)if(t){var x=+t.apply(this,arguments),_=g-x,w=(m+b)/2;c.quadraticCurveTo(0,0,_*Ba(m),_*Ha(m)),c.lineTo(g*Ba(w),g*Ha(w)),c.lineTo(_*Ba(b),_*Ha(b))}else c.quadraticCurveTo(0,0,g*Ba(m),g*Ha(m)),c.arc(0,0,g,m,b);if(c.quadraticCurveTo(0,0,p*Ba(y),p*Ha(y)),c.closePath(),f)return c=null,f+""||null}return t&&(f.headRadius=function(n){return arguments.length?(t="function"==typeof n?n:lu(+n),f):t}),f.radius=function(t){return arguments.length?(r=i="function"==typeof t?t:lu(+t),f):r},f.sourceRadius=function(t){return arguments.length?(r="function"==typeof t?t:lu(+t),f):r},f.targetRadius=function(t){return arguments.length?(i="function"==typeof t?t:lu(+t),f):i},f.startAngle=function(t){return arguments.length?(o="function"==typeof t?t:lu(+t),f):o},f.endAngle=function(t){return arguments.length?(a="function"==typeof t?t:lu(+t),f):a},f.padAngle=function(t){return arguments.length?(u="function"==typeof t?t:lu(+t),f):u},f.source=function(t){return arguments.length?(n=t,f):n},f.target=function(t){return arguments.length?(e=t,f):e},f.context=function(t){return arguments.length?(c=null==t?null:t,f):c},f}function xu(){return bu()}function _u(){return bu(mu)}var wu=Math.PI/180,Su=180/Math.PI,Au=.96422,Mu=.82521,ku=4/29,Tu=6/29,Eu=3*Tu*Tu;function Cu(t){if(t instanceof Nu)return new Nu(t.l,t.a,t.b,t.opacity);if(t instanceof Uu)return Fu(t);t instanceof ai||(t=ii(t));var n,e,r=ju(t.r),i=ju(t.g),o=ju(t.b),a=Iu((.2225045*r+.7168786*i+.0606169*o)/1);return r===i&&i===o?n=e=a:(n=Iu((.4360747*r+.3850649*i+.1430804*o)/Au),e=Iu((.0139322*r+.0971045*i+.7141733*o)/Mu)),new Nu(116*a-16,500*(n-a),200*(a-e),t.opacity)}function Ou(t,n){return new Nu(t,0,0,null==n?1:n)}function Pu(t,n,e,r){return 1===arguments.length?Cu(t):new Nu(t,n,e,null==r?1:r)}function Nu(t,n,e,r){this.l=+t,this.a=+n,this.b=+e,this.opacity=+r}function Iu(t){return t>.008856451679035631?Math.pow(t,1/3):t/Eu+ku}function Ru(t){return t>Tu?t*t*t:Eu*(t-ku)}function Du(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function ju(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function zu(t){if(t instanceof Uu)return new Uu(t.h,t.c,t.l,t.opacity);if(t instanceof Nu||(t=Cu(t)),0===t.a&&0===t.b)return new Uu(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var n=Math.atan2(t.b,t.a)*Su;return new Uu(n<0?n+360:n,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function Vu(t,n,e,r){return 1===arguments.length?zu(t):new Uu(e,n,t,null==r?1:r)}function Lu(t,n,e,r){return 1===arguments.length?zu(t):new Uu(t,n,e,null==r?1:r)}function Uu(t,n,e,r){this.h=+t,this.c=+n,this.l=+e,this.opacity=+r}function Fu(t){if(isNaN(t.h))return new Nu(t.l,0,0,t.opacity);var n=t.h*wu;return new Nu(t.l,Math.cos(n)*t.c,Math.sin(n)*t.c,t.opacity)}zr(Nu,Pu,Vr(Lr,{brighter:function(t){return new Nu(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new Nu(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,n=isNaN(this.a)?t:t+this.a/500,e=isNaN(this.b)?t:t-this.b/200;return new ai(Du(3.1338561*(n=Au*Ru(n))-1.6168667*(t=1*Ru(t))-.4906146*(e=Mu*Ru(e))),Du(-.9787684*n+1.9161415*t+.033454*e),Du(.0719453*n-.2289914*t+1.4052427*e),this.opacity)}})),zr(Uu,Lu,Vr(Lr,{brighter:function(t){return new Uu(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new Uu(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return Fu(this).rgb()}}));var Bu=-.14861,Hu=1.78277,qu=-.29227,Yu=-.90649,Xu=1.97294,$u=Xu*Yu,Wu=Xu*Hu,Gu=Hu*qu-Yu*Bu;function Qu(t){if(t instanceof Ku)return new Ku(t.h,t.s,t.l,t.opacity);t instanceof ai||(t=ii(t));var n=t.r/255,e=t.g/255,r=t.b/255,i=(Gu*r+$u*n-Wu*e)/(Gu+$u-Wu),o=r-i,a=(Xu*(e-i)-qu*o)/Yu,u=Math.sqrt(a*a+o*o)/(Xu*i*(1-i)),c=u?Math.atan2(a,o)*Su-120:NaN;return new Ku(c<0?c+360:c,u,i,t.opacity)}function Zu(t,n,e,r){return 1===arguments.length?Qu(t):new Ku(t,n,e,null==r?1:r)}function Ku(t,n,e,r){this.h=+t,this.s=+n,this.l=+e,this.opacity=+r}zr(Ku,Zu,Vr(Lr,{brighter:function(t){return t=null==t?Fr:Math.pow(Fr,t),new Ku(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Ur:Math.pow(Ur,t),new Ku(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*wu,n=+this.l,e=isNaN(this.s)?0:this.s*n*(1-n),r=Math.cos(t),i=Math.sin(t);return new ai(255*(n+e*(Bu*r+Hu*i)),255*(n+e*(qu*r+Yu*i)),255*(n+e*(Xu*r)),this.opacity)}}));var Ju=Array.prototype.slice;function tc(t,n){return t-n}var nc=function(t){return function(){return t}};function ec(t,n){for(var e,r=-1,i=n.length;++r<i;)if(e=rc(t,n[r]))return e;return 0}function rc(t,n){for(var e=n[0],r=n[1],i=-1,o=0,a=t.length,u=a-1;o<a;u=o++){var c=t[o],f=c[0],s=c[1],l=t[u],h=l[0],d=l[1];if(ic(c,l,n))return 0;s>r!=d>r&&e<(h-f)*(r-s)/(d-s)+f&&(i=-i)}return i}function ic(t,n,e){var r,i,o,a;return function(t,n,e){return(n[0]-t[0])*(e[1]-t[1])==(e[0]-t[0])*(n[1]-t[1])}(t,n,e)&&(i=t[r=+(t[0]===n[0])],o=e[r],a=n[r],i<=o&&o<=a||a<=o&&o<=i)}function oc(){}var ac=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function uc(){var t=1,n=1,e=ht,r=u;function i(t){var n=e(t);if(Array.isArray(n))n=n.slice().sort(tc);else{var r=z(t),i=r[0],a=r[1];n=st(i,a,n),n=Wt(Math.floor(i/n)*n,Math.floor(a/n)*n,n)}return n.map((function(n){return o(t,n)}))}function o(e,i){var o=[],u=[];return function(e,r,i){var o,u,c,f,s,l,h=new Array,d=new Array;o=u=-1,f=e[0]>=r,ac[f<<1].forEach(p);for(;++o<t-1;)c=f,f=e[o+1]>=r,ac[c|f<<1].forEach(p);ac[f<<0].forEach(p);for(;++u<n-1;){for(o=-1,f=e[u*t+t]>=r,s=e[u*t]>=r,ac[f<<1|s<<2].forEach(p);++o<t-1;)c=f,f=e[u*t+t+o+1]>=r,l=s,s=e[u*t+o+1]>=r,ac[c|f<<1|s<<2|l<<3].forEach(p);ac[f|s<<3].forEach(p)}o=-1,s=e[u*t]>=r,ac[s<<2].forEach(p);for(;++o<t-1;)l=s,s=e[u*t+o+1]>=r,ac[s<<2|l<<3].forEach(p);function p(t){var n,e,r=[t[0][0]+o,t[0][1]+u],c=[t[1][0]+o,t[1][1]+u],f=a(r),s=a(c);(n=d[f])?(e=h[s])?(delete d[n.end],delete h[e.start],n===e?(n.ring.push(c),i(n.ring)):h[n.start]=d[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete d[n.end],n.ring.push(c),d[n.end=s]=n):(n=h[s])?(e=d[f])?(delete h[n.start],delete d[e.end],n===e?(n.ring.push(c),i(n.ring)):h[e.start]=d[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete h[n.start],n.ring.unshift(r),h[n.start=f]=n):h[f]=d[s]={start:f,end:s,ring:[r,c]}}ac[s<<3].forEach(p)}(e,i,(function(t){r(t,e,i),function(t){for(var n=0,e=t.length,r=t[e-1][1]*t[0][0]-t[e-1][0]*t[0][1];++n<e;)r+=t[n-1][1]*t[n][0]-t[n-1][0]*t[n][1];return r}(t)>0?o.push([t]):u.push(t)})),u.forEach((function(t){for(var n,e=0,r=o.length;e<r;++e)if(-1!==ec((n=o[e])[0],t))return void n.push(t)})),{type:"MultiPolygon",value:i,coordinates:o}}function a(n){return 2*n[0]+n[1]*(t+1)*4}function u(e,r,i){e.forEach((function(e){var o,a=e[0],u=e[1],c=0|a,f=0|u,s=r[f*t+c];a>0&&a<t&&c===a&&(o=r[f*t+c-1],e[0]=a+(i-o)/(s-o)-.5),u>0&&u<n&&f===u&&(o=r[(f-1)*t+c],e[1]=u+(i-o)/(s-o)-.5)}))}return i.contour=o,i.size=function(e){if(!arguments.length)return[t,n];var r=Math.floor(e[0]),o=Math.floor(e[1]);if(!(r>=0&&o>=0))throw new Error("invalid size");return t=r,n=o,i},i.thresholds=function(t){return arguments.length?(e="function"==typeof t?t:Array.isArray(t)?nc(Ju.call(t)):nc(t),i):e},i.smooth=function(t){return arguments.length?(r=t?u:oc,i):r===u},i}function cc(t,n,e){for(var r=t.width,i=t.height,o=1+(e<<1),a=0;a<i;++a)for(var u=0,c=0;u<r+e;++u)u<r&&(c+=t.data[u+a*r]),u>=e&&(u>=o&&(c-=t.data[u-o+a*r]),n.data[u-e+a*r]=c/Math.min(u+1,r-1+o-u,o))}function fc(t,n,e){for(var r=t.width,i=t.height,o=1+(e<<1),a=0;a<r;++a)for(var u=0,c=0;u<i+e;++u)u<i&&(c+=t.data[a+u*r]),u>=e&&(u>=o&&(c-=t.data[a+(u-o)*r]),n.data[a+(u-e)*r]=c/Math.min(u+1,i-1+o-u,o))}function sc(t){return t[0]}function lc(t){return t[1]}function hc(){return 1}function dc(){var t=sc,n=lc,e=hc,r=960,i=500,o=20,a=2,u=3*o,c=r+2*u>>a,f=i+2*u>>a,s=nc(20);function l(r){var i=new Float32Array(c*f),l=new Float32Array(c*f);r.forEach((function(r,o,s){var l=+t(r,o,s)+u>>a,h=+n(r,o,s)+u>>a,d=+e(r,o,s);l>=0&&l<c&&h>=0&&h<f&&(i[l+h*c]+=d)})),cc({width:c,height:f,data:i},{width:c,height:f,data:l},o>>a),fc({width:c,height:f,data:l},{width:c,height:f,data:i},o>>a),cc({width:c,height:f,data:i},{width:c,height:f,data:l},o>>a),fc({width:c,height:f,data:l},{width:c,height:f,data:i},o>>a),cc({width:c,height:f,data:i},{width:c,height:f,data:l},o>>a),fc({width:c,height:f,data:l},{width:c,height:f,data:i},o>>a);var d=s(i);if(!Array.isArray(d)){var p=mt(i);d=st(0,p,d),(d=Wt(0,Math.floor(p/d)*d,d)).shift()}return uc().thresholds(d).size([c,f])(i).map(h)}function h(t){return t.value*=Math.pow(2,-2*a),t.coordinates.forEach(d),t}function d(t){t.forEach(p)}function p(t){t.forEach(y)}function y(t){t[0]=t[0]*Math.pow(2,a)-u,t[1]=t[1]*Math.pow(2,a)-u}function v(){return c=r+2*(u=3*o)>>a,f=i+2*u>>a,l}return l.x=function(n){return arguments.length?(t="function"==typeof n?n:nc(+n),l):t},l.y=function(t){return arguments.length?(n="function"==typeof t?t:nc(+t),l):n},l.weight=function(t){return arguments.length?(e="function"==typeof t?t:nc(+t),l):e},l.size=function(t){if(!arguments.length)return[r,i];var n=+t[0],e=+t[1];if(!(n>=0&&e>=0))throw new Error("invalid size");return r=n,i=e,v()},l.cellSize=function(t){if(!arguments.length)return 1<<a;if(!((t=+t)>=1))throw new Error("invalid cell size");return a=Math.floor(Math.log(t)/Math.LN2),v()},l.thresholds=function(t){return arguments.length?(s="function"==typeof t?t:Array.isArray(t)?nc(Ju.call(t)):nc(t),l):s},l.bandwidth=function(t){if(!arguments.length)return Math.sqrt(o*(o+1));if(!((t=+t)>=0))throw new Error("invalid bandwidth");return o=Math.round((Math.sqrt(4*t*t+1)-1)/2),v()},l}function pc(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function yc(t,n,e){return n&&pc(t.prototype,n),e&&pc(t,e),t}var vc=Math.pow(2,-52),gc=new Uint32Array(512),mc=function(){function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t);var e=n.length>>1;if(e>0&&"number"!=typeof n[0])throw new Error("Expected coords to contain numbers.");this.coords=n;var r=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*r),this._halfedges=new Int32Array(3*r),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}return yc(t,null,[{key:"from",value:function(n){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Mc,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:kc,i=n.length,o=new Float64Array(2*i),a=0;a<i;a++){var u=n[a];o[2*a]=e(u),o[2*a+1]=r(u)}return new t(o)}}]),yc(t,[{key:"update",value:function(){for(var t=this.coords,n=this._hullPrev,e=this._hullNext,r=this._hullTri,i=this._hullHash,o=t.length>>1,a=1/0,u=1/0,c=-1/0,f=-1/0,s=0;s<o;s++){var l=t[2*s],h=t[2*s+1];l<a&&(a=l),h<u&&(u=h),l>c&&(c=l),h>f&&(f=h),this._ids[s]=s}for(var d,p,y,v=(a+c)/2,g=(u+f)/2,m=1/0,b=0;b<o;b++){var x=bc(v,g,t[2*b],t[2*b+1]);x<m&&(d=b,m=x)}var _=t[2*d],w=t[2*d+1];m=1/0;for(var S=0;S<o;S++)if(S!==d){var A=bc(_,w,t[2*S],t[2*S+1]);A<m&&A>0&&(p=S,m=A)}for(var M=t[2*p],k=t[2*p+1],T=1/0,E=0;E<o;E++)if(E!==d&&E!==p){var C=wc(_,w,M,k,t[2*E],t[2*E+1]);C<T&&(y=E,T=C)}var O=t[2*y],P=t[2*y+1];if(T===1/0){for(var N=0;N<o;N++)this._dists[N]=t[2*N]-t[0]||t[2*N+1]-t[1];Sc(this._ids,this._dists,0,o-1);for(var I=new Uint32Array(o),R=0,D=0,j=-1/0;D<o;D++){var z=this._ids[D];this._dists[z]>j&&(I[R++]=z,j=this._dists[z])}return this.hull=I.subarray(0,R),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(_c(_,w,M,k,O,P)){var V=p,L=M,U=k;p=y,M=O,k=P,y=V,O=L,P=U}var F=function(t,n,e,r,i,o){var a=e-t,u=r-n,c=i-t,f=o-n,s=a*a+u*u,l=c*c+f*f,h=.5/(a*f-u*c);return{x:t+(f*s-u*l)*h,y:n+(a*l-c*s)*h}}(_,w,M,k,O,P);this._cx=F.x,this._cy=F.y;for(var B=0;B<o;B++)this._dists[B]=bc(t[2*B],t[2*B+1],F.x,F.y);Sc(this._ids,this._dists,0,o-1),this._hullStart=d;var H=3;e[d]=n[y]=p,e[p]=n[d]=y,e[y]=n[p]=d,r[d]=0,r[p]=1,r[y]=2,i.fill(-1),i[this._hashKey(_,w)]=d,i[this._hashKey(M,k)]=p,i[this._hashKey(O,P)]=y,this.trianglesLen=0,this._addTriangle(d,p,y,-1,-1,-1);for(var q,Y,X=0;X<this._ids.length;X++){var $=this._ids[X],W=t[2*$],G=t[2*$+1];if(!(X>0&&Math.abs(W-q)<=vc&&Math.abs(G-Y)<=vc)&&(q=W,Y=G,$!==d&&$!==p&&$!==y)){for(var Q=0,Z=0,K=this._hashKey(W,G);Z<this._hashSize&&(-1===(Q=i[(K+Z)%this._hashSize])||Q===e[Q]);Z++);for(var J=Q=n[Q],tt=void 0;tt=e[J],!_c(W,G,t[2*J],t[2*J+1],t[2*tt],t[2*tt+1]);)if((J=tt)===Q){J=-1;break}if(-1!==J){var nt=this._addTriangle(J,$,e[J],-1,-1,r[J]);r[$]=this._legalize(nt+2),r[J]=nt,H++;for(var et=e[J];tt=e[et],_c(W,G,t[2*et],t[2*et+1],t[2*tt],t[2*tt+1]);)nt=this._addTriangle(et,$,tt,r[$],-1,r[et]),r[$]=this._legalize(nt+2),e[et]=et,H--,et=tt;if(J===Q)for(;_c(W,G,t[2*(tt=n[J])],t[2*tt+1],t[2*J],t[2*J+1]);)nt=this._addTriangle(tt,$,J,-1,r[J],r[tt]),this._legalize(nt+2),r[tt]=nt,e[J]=J,H--,J=tt;this._hullStart=n[$]=J,e[J]=n[et]=$,e[$]=et,i[this._hashKey(W,G)]=$,i[this._hashKey(t[2*J],t[2*J+1])]=J}}}this.hull=new Uint32Array(H);for(var rt=0,it=this._hullStart;rt<H;rt++)this.hull[rt]=it,it=e[it];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}},{key:"_hashKey",value:function(t,n){return Math.floor((e=t-this._cx,r=n-this._cy,i=e/(Math.abs(e)+Math.abs(r)),(r>0?3-i:1+i)/4*this._hashSize))%this._hashSize;var e,r,i}},{key:"_legalize",value:function(t){for(var n,e,r,i,o,a,u,c,f,s,l,h,d,p,y,v,g=this._triangles,m=this._halfedges,b=this.coords,x=0,_=0;;){var w=m[t],S=t-t%3;if(_=S+(t+2)%3,-1!==w){var A=w-w%3,M=S+(t+1)%3,k=A+(w+2)%3,T=g[_],E=g[t],C=g[M],O=g[k];if(n=b[2*T],e=b[2*T+1],r=b[2*E],i=b[2*E+1],o=b[2*C],a=b[2*C+1],u=b[2*O],c=b[2*O+1],f=void 0,s=void 0,l=void 0,h=void 0,d=void 0,p=void 0,void 0,y=void 0,v=void 0,(f=n-u)*((h=i-c)*(v=(d=o-u)*d+(p=a-c)*p)-(y=(l=r-u)*l+h*h)*p)-(s=e-c)*(l*v-y*d)+(f*f+s*s)*(l*p-h*d)<0){g[t]=O,g[w]=T;var P=m[k];if(-1===P){var N=this._hullStart;do{if(this._hullTri[N]===k){this._hullTri[N]=t;break}N=this._hullPrev[N]}while(N!==this._hullStart)}this._link(t,P),this._link(w,m[_]),this._link(_,k);var I=A+(w+1)%3;x<gc.length&&(gc[x++]=I)}else{if(0===x)break;t=gc[--x]}}else{if(0===x)break;t=gc[--x]}}return _}},{key:"_link",value:function(t,n){this._halfedges[t]=n,-1!==n&&(this._halfedges[n]=t)}},{key:"_addTriangle",value:function(t,n,e,r,i,o){var a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=e,this._link(a,r),this._link(a+1,i),this._link(a+2,o),this.trianglesLen+=3,a}}]),t}();function bc(t,n,e,r){var i=t-e,o=n-r;return i*i+o*o}function xc(t,n,e,r,i,o){var a=(r-n)*(i-t),u=(e-t)*(o-n);return Math.abs(a-u)>=33306690738754716e-32*Math.abs(a+u)?a-u:0}function _c(t,n,e,r,i,o){return(xc(i,o,t,n,e,r)||xc(t,n,e,r,i,o)||xc(e,r,i,o,t,n))<0}function wc(t,n,e,r,i,o){var a=e-t,u=r-n,c=i-t,f=o-n,s=a*a+u*u,l=c*c+f*f,h=.5/(a*f-u*c),d=(f*s-u*l)*h,p=(a*l-c*s)*h;return d*d+p*p}function Sc(t,n,e,r){if(r-e<=20)for(var i=e+1;i<=r;i++){for(var o=t[i],a=n[o],u=i-1;u>=e&&n[t[u]]>a;)t[u+1]=t[u--];t[u+1]=o}else{var c=e+1,f=r;Ac(t,e+r>>1,c),n[t[e]]>n[t[r]]&&Ac(t,e,r),n[t[c]]>n[t[r]]&&Ac(t,c,r),n[t[e]]>n[t[c]]&&Ac(t,e,c);for(var s=t[c],l=n[s];;){do{c++}while(n[t[c]]<l);do{f--}while(n[t[f]]>l);if(f<c)break;Ac(t,c,f)}t[e+1]=t[f],t[f]=s,r-c+1>=f-e?(Sc(t,n,c,r),Sc(t,n,e,f-1)):(Sc(t,n,e,f-1),Sc(t,n,c,r))}}function Ac(t,n,e){var r=t[n];t[n]=t[e],t[e]=r}function Mc(t){return t[0]}function kc(t){return t[1]}function Tc(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ec=1e-6,Cc=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this._x0=this._y0=this._x1=this._y1=null,this._=""}var n,e,r;return n=t,(e=[{key:"moveTo",value:function(t,n){this._+="M".concat(this._x0=this._x1=+t,",").concat(this._y0=this._y1=+n)}},{key:"closePath",value:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}},{key:"lineTo",value:function(t,n){this._+="L".concat(this._x1=+t,",").concat(this._y1=+n)}},{key:"arc",value:function(t,n,e){var r=(t=+t)+(e=+e),i=n=+n;if(e<0)throw new Error("negative radius");null===this._x1?this._+="M".concat(r,",").concat(i):(Math.abs(this._x1-r)>Ec||Math.abs(this._y1-i)>Ec)&&(this._+="L"+r+","+i),e&&(this._+="A".concat(e,",").concat(e,",0,1,1,").concat(t-e,",").concat(n,"A").concat(e,",").concat(e,",0,1,1,").concat(this._x1=r,",").concat(this._y1=i))}},{key:"rect",value:function(t,n,e,r){this._+="M".concat(this._x0=this._x1=+t,",").concat(this._y0=this._y1=+n,"h").concat(+e,"v").concat(+r,"h").concat(-e,"Z")}},{key:"value",value:function(){return this._||null}}])&&Tc(n.prototype,e),r&&Tc(n,r),t}();function Oc(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Pc=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this._=[]}var n,e,r;return n=t,(e=[{key:"moveTo",value:function(t,n){this._.push([t,n])}},{key:"closePath",value:function(){this._.push(this._[0].slice())}},{key:"lineTo",value:function(t,n){this._.push([t,n])}},{key:"value",value:function(){return this._.length?this._:null}}])&&Oc(n.prototype,e),r&&Oc(n,r),t}();function Nc(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=Rc(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Ic(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var e=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(e.push(a.value),!n||e.length!==n);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return e}(t,n)||Rc(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rc(t,n){if(t){if("string"==typeof t)return Dc(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Dc(t,n):void 0}}function Dc(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function jc(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function zc(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Vc=function(){function t(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,960,500],r=Ic(e,4),i=r[0],o=r[1],a=r[2],u=r[3];if(jc(this,t),!((a=+a)>=(i=+i)&&(u=+u)>=(o=+o)))throw new Error("invalid bounds");this.delaunay=n,this._circumcenters=new Float64Array(2*n.points.length),this.vectors=new Float64Array(2*n.points.length),this.xmax=a,this.xmin=i,this.ymax=u,this.ymin=o,this._init()}var n,e,r;return n=t,(e=[{key:"update",value:function(){return this.delaunay.update(),this._init(),this}},{key:"_init",value:function(){for(var t,n,e=this.delaunay,r=e.points,i=e.hull,o=e.triangles,a=this.vectors,u=this.circumcenters=this._circumcenters.subarray(0,o.length/3*2),c=0,f=0,s=o.length;c<s;c+=3,f+=2){var l=2*o[c],h=2*o[c+1],d=2*o[c+2],p=r[l],y=r[l+1],v=r[h],g=r[h+1],m=r[d],b=r[d+1],x=v-p,_=g-y,w=m-p,S=b-y,A=x*x+_*_,M=w*w+S*S,k=2*(x*S-_*w);if(k)if(Math.abs(k)<1e-8)t=(p+m)/2,n=(y+b)/2;else{var T=1/k;t=p+(S*A-_*M)*T,n=y+(x*M-w*A)*T}else t=(p+m)/2-1e8*S,n=(y+b)/2+1e8*w;u[f]=t,u[f+1]=n}var E,C,O,P=i[i.length-1],N=4*P,I=r[2*P],R=r[2*P+1];a.fill(0);for(var D=0;D<i.length;++D)E=N,C=I,O=R,N=4*(P=i[D]),I=r[2*P],R=r[2*P+1],a[E+2]=a[N]=O-R,a[E+3]=a[N+1]=I-C}},{key:"render",value:function(t){var n=null==t?t=new Cc:void 0,e=this.delaunay,r=e.halfedges,i=e.inedges,o=e.hull,a=this.circumcenters,u=this.vectors;if(o.length<=1)return null;for(var c=0,f=r.length;c<f;++c){var s=r[c];if(!(s<c)){var l=2*Math.floor(c/3),h=2*Math.floor(s/3),d=a[l],p=a[l+1],y=a[h],v=a[h+1];this._renderSegment(d,p,y,v,t)}}for(var g,m=o[o.length-1],b=0;b<o.length;++b){g=m,m=o[b];var x=2*Math.floor(i[m]/3),_=a[x],w=a[x+1],S=4*g,A=this._project(_,w,u[S+2],u[S+3]);A&&this._renderSegment(_,w,A[0],A[1],t)}return n&&n.value()}},{key:"renderBounds",value:function(t){var n=null==t?t=new Cc:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}},{key:"renderCell",value:function(t,n){var e=null==n?n=new Cc:void 0,r=this._clip(t);if(null!==r&&r.length){n.moveTo(r[0],r[1]);for(var i=r.length;r[0]===r[i-2]&&r[1]===r[i-1]&&i>1;)i-=2;for(var o=2;o<i;o+=2)r[o]===r[o-2]&&r[o+1]===r[o-1]||n.lineTo(r[o],r[o+1]);return n.closePath(),e&&e.value()}}},{key:"cellPolygons",value:u().mark((function t(){var n,e,r,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=this.delaunay.points,e=0,r=n.length/2;case 2:if(!(e<r)){t.next=11;break}if(!(i=this.cellPolygon(e))){t.next=8;break}return i.index=e,t.next=8,i;case 8:++e,t.next=2;break;case 11:case"end":return t.stop()}}),t,this)}))},{key:"cellPolygon",value:function(t){var n=new Pc;return this.renderCell(t,n),n.value()}},{key:"_renderSegment",value:function(t,n,e,r,i){var o,a=this._regioncode(t,n),u=this._regioncode(e,r);0===a&&0===u?(i.moveTo(t,n),i.lineTo(e,r)):(o=this._clipSegment(t,n,e,r,a,u))&&(i.moveTo(o[0],o[1]),i.lineTo(o[2],o[3]))}},{key:"contains",value:function(t,n,e){return(n=+n)==n&&(e=+e)==e&&this.delaunay._step(t,n,e)===t}},{key:"neighbors",value:u().mark((function t(n){var e,r,i,o,a,c,f,s,l;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=this._clip(n))){t.next=33;break}r=Nc(this.delaunay.neighbors(n)),t.prev=3,r.s();case 5:if((i=r.n()).done){t.next=25;break}if(o=i.value,!(a=this._clip(o))){t.next=23;break}c=0,f=e.length;case 10:if(!(c<f)){t.next=23;break}s=0,l=a.length;case 12:if(!(s<l)){t.next=20;break}if(e[c]!=a[s]||e[c+1]!=a[s+1]||e[(c+2)%f]!=a[(s+l-2)%l]||e[(c+3)%f]!=a[(s+l-1)%l]){t.next=17;break}return t.next=16,o;case 16:return t.abrupt("break",23);case 17:s+=2,t.next=12;break;case 20:c+=2,t.next=10;break;case 23:t.next=5;break;case 25:t.next=30;break;case 27:t.prev=27,t.t0=t.catch(3),r.e(t.t0);case 30:return t.prev=30,r.f(),t.finish(30);case 33:case"end":return t.stop()}}),t,this,[[3,27,30,33]])}))},{key:"_cell",value:function(t){var n=this.circumcenters,e=this.delaunay,r=e.inedges,i=e.halfedges,o=e.triangles,a=r[t];if(-1===a)return null;var u=[],c=a;do{var f=Math.floor(c/3);if(u.push(n[2*f],n[2*f+1]),o[c=c%3==2?c-2:c+1]!==t)break;c=i[c]}while(c!==a&&-1!==c);return u}},{key:"_clip",value:function(t){if(0===t&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];var n=this._cell(t);if(null===n)return null;var e=this.vectors,r=4*t;return e[r]||e[r+1]?this._clipInfinite(t,n,e[r],e[r+1],e[r+2],e[r+3]):this._clipFinite(t,n)}},{key:"_clipFinite",value:function(t,n){for(var e,r,i,o,a,u=n.length,c=null,f=n[u-2],s=n[u-1],l=this._regioncode(f,s),h=0;h<u;h+=2)if(e=f,r=s,f=n[h],s=n[h+1],i=l,l=this._regioncode(f,s),0===i&&0===l)o=a,a=0,c?c.push(f,s):c=[f,s];else{var d=void 0,p=void 0,y=void 0,v=void 0,g=void 0;if(0===i){if(null===(d=this._clipSegment(e,r,f,s,i,l)))continue;var m=Ic(d,4);p=m[0],y=m[1],v=m[2],g=m[3]}else{if(null===(d=this._clipSegment(f,s,e,r,l,i)))continue;var b=Ic(d,4);v=b[0],g=b[1],p=b[2],y=b[3],o=a,a=this._edgecode(p,y),o&&a&&this._edge(t,o,a,c,c.length),c?c.push(p,y):c=[p,y]}o=a,a=this._edgecode(v,g),o&&a&&this._edge(t,o,a,c,c.length),c?c.push(v,g):c=[v,g]}if(c)o=a,a=this._edgecode(c[0],c[1]),o&&a&&this._edge(t,o,a,c,c.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return c}},{key:"_clipSegment",value:function(t,n,e,r,i,o){for(;;){if(0===i&&0===o)return[t,n,e,r];if(i&o)return null;var a=void 0,u=void 0,c=i||o;8&c?(a=t+(e-t)*(this.ymax-n)/(r-n),u=this.ymax):4&c?(a=t+(e-t)*(this.ymin-n)/(r-n),u=this.ymin):2&c?(u=n+(r-n)*(this.xmax-t)/(e-t),a=this.xmax):(u=n+(r-n)*(this.xmin-t)/(e-t),a=this.xmin),i?(t=a,n=u,i=this._regioncode(t,n)):(e=a,r=u,o=this._regioncode(e,r))}}},{key:"_clipInfinite",value:function(t,n,e,r,i,o){var a,u=Array.from(n);if((a=this._project(u[0],u[1],e,r))&&u.unshift(a[0],a[1]),(a=this._project(u[u.length-2],u[u.length-1],i,o))&&u.push(a[0],a[1]),u=this._clipFinite(t,u))for(var c,f=0,s=u.length,l=this._edgecode(u[s-2],u[s-1]);f<s;f+=2)c=l,l=this._edgecode(u[f],u[f+1]),c&&l&&(f=this._edge(t,c,l,u,f),s=u.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(u=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return u}},{key:"_edge",value:function(t,n,e,r,i){for(;n!==e;){var o=void 0,a=void 0;switch(n){case 5:n=4;continue;case 4:n=6,o=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,o=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,o=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,o=this.xmin,a=this.ymin}r[i]===o&&r[i+1]===a||!this.contains(t,o,a)||(r.splice(i,0,o,a),i+=2)}if(r.length>4)for(var u=0;u<r.length;u+=2){var c=(u+2)%r.length,f=(u+4)%r.length;(r[u]===r[c]&&r[c]===r[f]||r[u+1]===r[c+1]&&r[c+1]===r[f+1])&&(r.splice(c,2),u-=2)}return i}},{key:"_project",value:function(t,n,e,r){var i,o,a,u=1/0;if(r<0){if(n<=this.ymin)return null;(i=(this.ymin-n)/r)<u&&(a=this.ymin,o=t+(u=i)*e)}else if(r>0){if(n>=this.ymax)return null;(i=(this.ymax-n)/r)<u&&(a=this.ymax,o=t+(u=i)*e)}if(e>0){if(t>=this.xmax)return null;(i=(this.xmax-t)/e)<u&&(o=this.xmax,a=n+(u=i)*r)}else if(e<0){if(t<=this.xmin)return null;(i=(this.xmin-t)/e)<u&&(o=this.xmin,a=n+(u=i)*r)}return[o,a]}},{key:"_edgecode",value:function(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}},{key:"_regioncode",value:function(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}])&&zc(n.prototype,e),r&&zc(n,r),t}(),Lc=u().mark(Zc);function Uc(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return Fc(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Fc(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Fc(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Bc(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Hc(t,n,e){return n&&Bc(t.prototype,n),e&&Bc(t,e),t}var qc=2*Math.PI,Yc=Math.pow;function Xc(t){return t[0]}function $c(t){return t[1]}function Wc(t,n,e){return[t+Math.sin(t+n)*e,n+Math.cos(t-n)*e]}var Gc=function(){function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this._delaunator=new mc(n),this.inedges=new Int32Array(n.length/2),this._hullIndex=new Int32Array(n.length/2),this.points=this._delaunator.coords,this._init()}return Hc(t,null,[{key:"from",value:function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Xc,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:$c,i=arguments.length>3?arguments[3]:void 0;return new t("length"in n?Qc(n,e,r,i):Float64Array.from(Zc(n,e,r,i)))}}]),Hc(t,[{key:"update",value:function(){return this._delaunator.update(),this._init(),this}},{key:"_init",value:function(){var t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&function(t){for(var n=t.triangles,e=t.coords,r=0;r<n.length;r+=3){var i=2*n[r],o=2*n[r+1],a=2*n[r+2];if((e[a]-e[i])*(e[o+1]-e[i+1])-(e[o]-e[i])*(e[a+1]-e[i+1])>1e-10)return!1}return!0}(t)){this.collinear=Int32Array.from({length:n.length/2},(function(t,n){return n})).sort((function(t,e){return n[2*t]-n[2*e]||n[2*t+1]-n[2*e+1]}));for(var e=this.collinear[0],r=this.collinear[this.collinear.length-1],i=[n[2*e],n[2*e+1],n[2*r],n[2*r+1]],o=1e-8*Math.hypot(i[3]-i[1],i[2]-i[0]),a=0,u=n.length/2;a<u;++a){var c=Wc(n[2*a],n[2*a+1],o);n[2*a]=c[0],n[2*a+1]=c[1]}this._delaunator=new mc(n)}else delete this.collinear;for(var f=this.halfedges=this._delaunator.halfedges,s=this.hull=this._delaunator.hull,l=this.triangles=this._delaunator.triangles,h=this.inedges.fill(-1),d=this._hullIndex.fill(-1),p=0,y=f.length;p<y;++p){var v=l[p%3==2?p-2:p+1];-1!==f[p]&&-1!==h[v]||(h[v]=p)}for(var g=0,m=s.length;g<m;++g)d[s[g]]=g;s.length<=2&&s.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=s[0],this.triangles[1]=s[1],this.triangles[2]=s[1],h[s[0]]=1,2===s.length&&(h[s[1]]=0))}},{key:"voronoi",value:function(t){return new Vc(this,t)}},{key:"neighbors",value:u().mark((function t(n){var e,r,i,o,a,c,f,s,l,h,d;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.inedges,r=this.hull,i=this._hullIndex,o=this.halfedges,a=this.triangles,!(c=this.collinear)){t.next=10;break}if(!((f=c.indexOf(n))>0)){t.next=6;break}return t.next=6,c[f-1];case 6:if(!(f<c.length-1)){t.next=9;break}return t.next=9,c[f+1];case 9:return t.abrupt("return");case 10:if(-1!==(s=e[n])){t.next=13;break}return t.abrupt("return");case 13:l=s,h=-1;case 14:return t.next=16,h=a[l];case 16:if(a[l=l%3==2?l-2:l+1]===n){t.next=19;break}return t.abrupt("return");case 19:if(-1!==(l=o[l])){t.next=26;break}if((d=r[(i[n]+1)%r.length])===h){t.next=25;break}return t.next=25,d;case 25:return t.abrupt("return");case 26:if(l!==s){t.next=14;break}case 27:case"end":return t.stop()}}),t,this)}))},{key:"find",value:function(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((t=+t)!=t||(n=+n)!=n)return-1;for(var r,i=e;(r=this._step(e,t,n))>=0&&r!==e&&r!==i;)e=r;return r}},{key:"_step",value:function(t,n,e){var r=this.inedges,i=this.hull,o=this._hullIndex,a=this.halfedges,u=this.triangles,c=this.points;if(-1===r[t]||!c.length)return(t+1)%(c.length>>1);var f=t,s=Yc(n-c[2*t],2)+Yc(e-c[2*t+1],2),l=r[t],h=l;do{var d=u[h],p=Yc(n-c[2*d],2)+Yc(e-c[2*d+1],2);if(p<s&&(s=p,f=d),u[h=h%3==2?h-2:h+1]!==t)break;if(-1===(h=a[h])){if((h=i[(o[t]+1)%i.length])!==d&&Yc(n-c[2*h],2)+Yc(e-c[2*h+1],2)<s)return h;break}}while(h!==l);return f}},{key:"render",value:function(t){for(var n=null==t?t=new Cc:void 0,e=this.points,r=this.halfedges,i=this.triangles,o=0,a=r.length;o<a;++o){var u=r[o];if(!(u<o)){var c=2*i[o],f=2*i[u];t.moveTo(e[c],e[c+1]),t.lineTo(e[f],e[f+1])}}return this.renderHull(t),n&&n.value()}},{key:"renderPoints",value:function(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,e=null==t?t=new Cc:void 0,r=this.points,i=0,o=r.length;i<o;i+=2){var a=r[i],u=r[i+1];t.moveTo(a+n,u),t.arc(a,u,n,0,qc)}return e&&e.value()}},{key:"renderHull",value:function(t){var n=null==t?t=new Cc:void 0,e=this.hull,r=this.points,i=2*e[0],o=e.length;t.moveTo(r[i],r[i+1]);for(var a=1;a<o;++a){var u=2*e[a];t.lineTo(r[u],r[u+1])}return t.closePath(),n&&n.value()}},{key:"hullPolygon",value:function(){var t=new Pc;return this.renderHull(t),t.value()}},{key:"renderTriangle",value:function(t,n){var e=null==n?n=new Cc:void 0,r=this.points,i=this.triangles,o=2*i[t*=3],a=2*i[t+1],u=2*i[t+2];return n.moveTo(r[o],r[o+1]),n.lineTo(r[a],r[a+1]),n.lineTo(r[u],r[u+1]),n.closePath(),e&&e.value()}},{key:"trianglePolygons",value:u().mark((function t(){var n,e,r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=this.triangles,e=0,r=n.length/3;case 2:if(!(e<r)){t.next=8;break}return t.next=5,this.trianglePolygon(e);case 5:++e,t.next=2;break;case 8:case"end":return t.stop()}}),t,this)}))},{key:"trianglePolygon",value:function(t){var n=new Pc;return this.renderTriangle(t,n),n.value()}}]),t}();function Qc(t,n,e,r){for(var i=t.length,o=new Float64Array(2*i),a=0;a<i;++a){var u=t[a];o[2*a]=n.call(r,u,a,t),o[2*a+1]=e.call(r,u,a,t)}return o}function Zc(t,n,e,r){var i,o,a,c;return u().wrap((function(u){for(;;)switch(u.prev=u.next){case 0:i=0,o=Uc(t),u.prev=2,o.s();case 4:if((a=o.n()).done){u.next=13;break}return c=a.value,u.next=8,n.call(r,c,i,t);case 8:return u.next=10,e.call(r,c,i,t);case 10:++i;case 11:u.next=4;break;case 13:u.next=18;break;case 15:u.prev=15,u.t0=u.catch(2),o.e(u.t0);case 18:return u.prev=18,o.f(),u.finish(18);case 21:case"end":return u.stop()}}),Lc,null,[[2,15,18,21]])}var Kc=function(t){return function(){return t}};function Jc(t,n){var e=n.sourceEvent,r=n.subject,i=n.target,o=n.identifier,a=n.active,u=n.x,c=n.y,f=n.dx,s=n.dy,l=n.dispatch;Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:u,enumerable:!0,configurable:!0},y:{value:c,enumerable:!0,configurable:!0},dx:{value:f,enumerable:!0,configurable:!0},dy:{value:s,enumerable:!0,configurable:!0},_:{value:l}})}function tf(t){return!t.ctrlKey&&!t.button}function nf(){return this.parentNode}function ef(t,n){return null==n?{x:t.x,y:t.y}:n}function rf(){return navigator.maxTouchPoints||"ontouchstart"in this}function of(){var t,n,e,r,i=tf,o=nf,a=ef,u=rf,c={},f=he("start","drag","end"),s=0,l=0;function h(t){t.on("mousedown.drag",d).filter(u).on("touchstart.drag",v).on("touchmove.drag",g).on("touchend.drag touchcancel.drag",m).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(a,u){if(!r&&i.call(this,a,u)){var c=b(this,o.call(this,a,u),a,u,"mouse");c&&(Nr(a.view).on("mousemove.drag",p,!0).on("mouseup.drag",y,!0),Dr(a.view),Ir(a),e=!1,t=a.clientX,n=a.clientY,c("start",a))}}function p(r){if(Rr(r),!e){var i=r.clientX-t,o=r.clientY-n;e=i*i+o*o>l}c.mouse("drag",r)}function y(t){Nr(t.view).on("mousemove.drag mouseup.drag",null),jr(t.view,e),Rr(t),c.mouse("end",t)}function v(t,n){if(i.call(this,t,n)){var e,r,a=t.changedTouches,u=o.call(this,t,n),c=a.length;for(e=0;e<c;++e)(r=b(this,u,t,n,a[e].identifier,a[e]))&&(Ir(t),r("start",t,a[e]))}}function g(t){var n,e,r=t.changedTouches,i=r.length;for(n=0;n<i;++n)(e=c[r[n].identifier])&&(Rr(t),e("drag",t,r[n]))}function m(t){var n,e,i=t.changedTouches,o=i.length;for(r&&clearTimeout(r),r=setTimeout((function(){r=null}),500),n=0;n<o;++n)(e=c[i[n].identifier])&&(Ir(t),e("end",t,i[n]))}function b(t,n,e,r,i,o){var u,l,d,p=f.copy(),y=Fi(o||e,n);if(null!=(d=a.call(t,new Jc("beforestart",{sourceEvent:e,target:h,identifier:i,active:s,x:y[0],y:y[1],dx:0,dy:0,dispatch:p}),r)))return u=d.x-y[0]||0,l=d.y-y[1]||0,function e(o,a,f){var v,g=y;switch(o){case"start":c[i]=e,v=s++;break;case"end":delete c[i],--s;case"drag":y=Fi(f||a,n),v=s}p.call(o,t,new Jc(o,{sourceEvent:a,subject:d,target:h,identifier:i,active:v,x:y[0]+u,y:y[1]+l,dx:y[0]-g[0],dy:y[1]-g[1],dispatch:p}),r)}}return h.filter=function(t){return arguments.length?(i="function"==typeof t?t:Kc(!!t),h):i},h.container=function(t){return arguments.length?(o="function"==typeof t?t:Kc(t),h):o},h.subject=function(t){return arguments.length?(a="function"==typeof t?t:Kc(t),h):a},h.touchable=function(t){return arguments.length?(u="function"==typeof t?t:Kc(!!t),h):u},h.on=function(){var t=f.on.apply(f,arguments);return t===f?h:t},h.clickDistance=function(t){return arguments.length?(l=(t=+t)*t,h):Math.sqrt(l)},h}Jc.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var af={},uf={};function cf(t){return new Function("d","return {"+t.map((function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'})).join(",")+"}")}function ff(t){var n=Object.create(null),e=[];return t.forEach((function(t){for(var r in t)r in n||e.push(n[r]=r)})),e}function sf(t,n){var e=t+"",r=e.length;return r<n?new Array(n-r+1).join(0)+e:e}function lf(t){var n=t.getUTCHours(),e=t.getUTCMinutes(),r=t.getUTCSeconds(),i=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":function(t){return t<0?"-"+sf(-t,6):t>9999?"+"+sf(t,6):sf(t,4)}(t.getUTCFullYear())+"-"+sf(t.getUTCMonth()+1,2)+"-"+sf(t.getUTCDate(),2)+(i?"T"+sf(n,2)+":"+sf(e,2)+":"+sf(r,2)+"."+sf(i,3)+"Z":r?"T"+sf(n,2)+":"+sf(e,2)+":"+sf(r,2)+"Z":e||n?"T"+sf(n,2)+":"+sf(e,2)+"Z":"")}function hf(t){var n=new RegExp('["'+t+"\n\r]"),e=t.charCodeAt(0);function r(t,n){var r,i=[],o=t.length,a=0,u=0,c=o<=0,f=!1;function s(){if(c)return uf;if(f)return f=!1,af;var n,r,i=a;if(34===t.charCodeAt(i)){for(;a++<o&&34!==t.charCodeAt(a)||34===t.charCodeAt(++a););return(n=a)>=o?c=!0:10===(r=t.charCodeAt(a++))?f=!0:13===r&&(f=!0,10===t.charCodeAt(a)&&++a),t.slice(i+1,n-1).replace(/""/g,'"')}for(;a<o;){if(10===(r=t.charCodeAt(n=a++)))f=!0;else if(13===r)f=!0,10===t.charCodeAt(a)&&++a;else if(r!==e)continue;return t.slice(i,n)}return c=!0,t.slice(i,o)}for(10===t.charCodeAt(o-1)&&--o,13===t.charCodeAt(o-1)&&--o;(r=s())!==uf;){for(var l=[];r!==af&&r!==uf;)l.push(r),r=s();n&&null==(l=n(l,u++))||i.push(l)}return i}function i(n,e){return n.map((function(n){return e.map((function(t){return a(n[t])})).join(t)}))}function o(n){return n.map(a).join(t)}function a(t){return null==t?"":t instanceof Date?lf(t):n.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,n){var e,i,o=r(t,(function(t,r){if(e)return e(t,r-1);i=t,e=n?function(t,n){var e=cf(t);return function(r,i){return n(e(r),i,t)}}(t,n):cf(t)}));return o.columns=i||[],o},parseRows:r,format:function(n,e){return null==e&&(e=ff(n)),[e.map(a).join(t)].concat(i(n,e)).join("\n")},formatBody:function(t,n){return null==n&&(n=ff(t)),i(t,n).join("\n")},formatRows:function(t){return t.map(o).join("\n")},formatRow:o,formatValue:a}}var df=hf(","),pf=df.parse,yf=df.parseRows,vf=df.format,gf=df.formatBody,mf=df.formatRows,bf=df.formatRow,xf=df.formatValue,_f=hf("\t"),wf=_f.parse,Sf=_f.parseRows,Af=_f.format,Mf=_f.formatBody,kf=_f.formatRows,Tf=_f.formatRow,Ef=_f.formatValue;function Cf(t){for(var n in t){var e,r,i=t[n].trim();if(i)if("true"===i)i=!0;else if("false"===i)i=!1;else if("NaN"===i)i=NaN;else if(isNaN(e=+i)){if(!(r=i.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/)))continue;Of&&r[4]&&!r[7]&&(i=i.replace(/-/g,"/").replace(/T/," ")),i=new Date(i)}else i=e;else i=null;t[n]=i}return t}var Of=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours(),Pf=function(t){return+t};function Nf(t){return t*t}function If(t){return t*(2-t)}function Rf(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}var Df=function t(n){function e(t){return Math.pow(t,n)}return n=+n,e.exponent=t,e}(3),jf=function t(n){function e(t){return 1-Math.pow(1-t,n)}return n=+n,e.exponent=t,e}(3),zf=function t(n){function e(t){return((t*=2)<=1?Math.pow(t,n):2-Math.pow(2-t,n))/2}return n=+n,e.exponent=t,e}(3),Vf=Math.PI,Lf=Vf/2;function Uf(t){return 1==+t?1:1-Math.cos(t*Lf)}function Ff(t){return Math.sin(t*Lf)}function Bf(t){return(1-Math.cos(Vf*t))/2}function Hf(t){return 1.0009775171065494*(Math.pow(2,-10*t)-.0009765625)}function qf(t){return Hf(1-+t)}function Yf(t){return 1-Hf(t)}function Xf(t){return((t*=2)<=1?Hf(1-t):2-Hf(t-1))/2}function $f(t){return 1-Math.sqrt(1-t*t)}function Wf(t){return Math.sqrt(1- --t*t)}function Gf(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}var Qf=4/11,Zf=7.5625;function Kf(t){return 1-Jf(1-t)}function Jf(t){return(t=+t)<Qf?Zf*t*t:t<.7272727272727273?Zf*(t-=.5454545454545454)*t+.75:t<.9090909090909091?Zf*(t-=.8181818181818182)*t+.9375:Zf*(t-=.9545454545454546)*t+.984375}function ts(t){return((t*=2)<=1?1-Jf(1-t):Jf(t-1)+1)/2}var ns=1.70158,es=function t(n){function e(t){return(t=+t)*t*(n*(t-1)+t)}return n=+n,e.overshoot=t,e}(ns),rs=function t(n){function e(t){return--t*t*((t+1)*n+t)+1}return n=+n,e.overshoot=t,e}(ns),is=function t(n){function e(t){return((t*=2)<1?t*t*((n+1)*t-n):(t-=2)*t*((n+1)*t+n)+2)/2}return n=+n,e.overshoot=t,e}(ns),os=2*Math.PI,as=function t(n,e){var r=Math.asin(1/(n=Math.max(1,n)))*(e/=os);function i(t){return n*Hf(- --t)*Math.sin((r-t)/e)}return i.amplitude=function(n){return t(n,e*os)},i.period=function(e){return t(n,e)},i}(1,.3),us=function t(n,e){var r=Math.asin(1/(n=Math.max(1,n)))*(e/=os);function i(t){return 1-n*Hf(t=+t)*Math.sin((t+r)/e)}return i.amplitude=function(n){return t(n,e*os)},i.period=function(e){return t(n,e)},i}(1,.3),cs=function t(n,e){var r=Math.asin(1/(n=Math.max(1,n)))*(e/=os);function i(t){return((t=2*t-1)<0?n*Hf(-t)*Math.sin((r-t)/e):2-n*Hf(t)*Math.sin((r+t)/e))/2}return i.amplitude=function(n){return t(n,e*os)},i.period=function(e){return t(n,e)},i}(1,.3);function fs(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.blob()}function ss(t,n){return fetch(t,n).then(fs)}function ls(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.arrayBuffer()}function hs(t,n){return fetch(t,n).then(ls)}function ds(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function ps(t,n){return fetch(t,n).then(ds)}function ys(t){return function(n,e,r){return 2===arguments.length&&"function"==typeof e&&(r=e,e=void 0),ps(n,e).then((function(n){return t(n,r)}))}}function vs(t,n,e,r){3===arguments.length&&"function"==typeof e&&(r=e,e=void 0);var i=hf(t);return ps(n,e).then((function(t){return i.parse(t,r)}))}var gs=ys(pf),ms=ys(wf);function bs(t,n){return new Promise((function(e,r){var i=new Image;for(var o in n)i[o]=n[o];i.onerror=r,i.onload=function(){e(i)},i.src=t}))}function xs(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(204!==t.status&&205!==t.status)return t.json()}function _s(t,n){return fetch(t,n).then(xs)}function ws(t){return function(n,e){return ps(n,e).then((function(n){return(new DOMParser).parseFromString(n,t)}))}}var Ss=ws("application/xml"),As=ws("text/html"),Ms=ws("image/svg+xml");function ks(t,n){var e,r=1;function i(){var i,o,a=e.length,u=0,c=0;for(i=0;i<a;++i)u+=(o=e[i]).x,c+=o.y;for(u=(u/a-t)*r,c=(c/a-n)*r,i=0;i<a;++i)(o=e[i]).x-=u,o.y-=c}return null==t&&(t=0),null==n&&(n=0),i.initialize=function(t){e=t},i.x=function(n){return arguments.length?(t=+n,i):t},i.y=function(t){return arguments.length?(n=+t,i):n},i.strength=function(t){return arguments.length?(r=+t,i):r},i}function Ts(t,n,e,r){if(isNaN(n)||isNaN(e))return t;var i,o,a,u,c,f,s,l,h,d=t._root,p={data:r},y=t._x0,v=t._y0,g=t._x1,m=t._y1;if(!d)return t._root=p,t;for(;d.length;)if((f=n>=(o=(y+g)/2))?y=o:g=o,(s=e>=(a=(v+m)/2))?v=a:m=a,i=d,!(d=d[l=s<<1|f]))return i[l]=p,t;if(u=+t._x.call(null,d.data),c=+t._y.call(null,d.data),n===u&&e===c)return p.next=d,i?i[l]=p:t._root=p,t;do{i=i?i[l]=new Array(4):t._root=new Array(4),(f=n>=(o=(y+g)/2))?y=o:g=o,(s=e>=(a=(v+m)/2))?v=a:m=a}while((l=s<<1|f)==(h=(c>=a)<<1|u>=o));return i[h]=d,i[l]=p,t}function Es(t,n,e,r,i){this.node=t,this.x0=n,this.y0=e,this.x1=r,this.y1=i}function Cs(t){return t[0]}function Os(t){return t[1]}function Ps(t,n,e){var r=new Ns(null==n?Cs:n,null==e?Os:e,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function Ns(t,n,e,r,i,o){this._x=t,this._y=n,this._x0=e,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function Is(t){for(var n={data:t.data},e=n;t=t.next;)e=e.next={data:t.data};return n}var Rs=Ps.prototype=Ns.prototype;function Ds(t){return function(){return t}}function js(t){return 1e-6*(t()-.5)}function zs(t){return t.x+t.vx}function Vs(t){return t.y+t.vy}function Ls(t){var n,e,r,i=1,o=1;function a(){for(var t,a,c,f,s,l,h,d=n.length,p=0;p<o;++p)for(a=Ps(n,zs,Vs).visitAfter(u),t=0;t<d;++t)c=n[t],l=e[c.index],h=l*l,f=c.x+c.vx,s=c.y+c.vy,a.visit(y);function y(t,n,e,o,a){var u=t.data,d=t.r,p=l+d;if(!u)return n>f+p||o<f-p||e>s+p||a<s-p;if(u.index>c.index){var y=f-u.x-u.vx,v=s-u.y-u.vy,g=y*y+v*v;g<p*p&&(0===y&&(g+=(y=js(r))*y),0===v&&(g+=(v=js(r))*v),g=(p-(g=Math.sqrt(g)))/g*i,c.vx+=(y*=g)*(p=(d*=d)/(h+d)),c.vy+=(v*=g)*p,u.vx-=y*(p=1-p),u.vy-=v*p)}}}function u(t){if(t.data)return t.r=e[t.data.index];for(var n=t.r=0;n<4;++n)t[n]&&t[n].r>t.r&&(t.r=t[n].r)}function c(){if(n){var r,i,o=n.length;for(e=new Array(o),r=0;r<o;++r)i=n[r],e[i.index]=+t(i,r,n)}}return"function"!=typeof t&&(t=Ds(null==t?1:+t)),a.initialize=function(t,e){n=t,r=e,c()},a.iterations=function(t){return arguments.length?(o=+t,a):o},a.strength=function(t){return arguments.length?(i=+t,a):i},a.radius=function(n){return arguments.length?(t="function"==typeof n?n:Ds(+n),c(),a):t},a}function Us(t){return(Us="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fs(t){return t.index}function Bs(t,n){var e=t.get(n);if(!e)throw new Error("node not found: "+n);return e}function Hs(t){var n,e,r,i,o,a,u=Fs,c=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},f=Ds(30),s=1;function l(r){for(var i=0,u=t.length;i<s;++i)for(var c,f,l,h,d,p,y,v=0;v<u;++v)f=(c=t[v]).source,h=(l=c.target).x+l.vx-f.x-f.vx||js(a),d=l.y+l.vy-f.y-f.vy||js(a),h*=p=((p=Math.sqrt(h*h+d*d))-e[v])/p*r*n[v],d*=p,l.vx-=h*(y=o[v]),l.vy-=d*y,f.vx+=h*(y=1-y),f.vy+=d*y}function h(){if(r){var a,c,f=r.length,s=t.length,l=new Map(r.map((function(t,n){return[u(t,n,r),t]})));for(a=0,i=new Array(f);a<s;++a)(c=t[a]).index=a,"object"!==Us(c.source)&&(c.source=Bs(l,c.source)),"object"!==Us(c.target)&&(c.target=Bs(l,c.target)),i[c.source.index]=(i[c.source.index]||0)+1,i[c.target.index]=(i[c.target.index]||0)+1;for(a=0,o=new Array(s);a<s;++a)c=t[a],o[a]=i[c.source.index]/(i[c.source.index]+i[c.target.index]);n=new Array(s),d(),e=new Array(s),p()}}function d(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+c(t[e],e,t)}function p(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+f(t[n],n,t)}return null==t&&(t=[]),l.initialize=function(t,n){r=t,a=n,h()},l.links=function(n){return arguments.length?(t=n,h(),l):t},l.id=function(t){return arguments.length?(u=t,l):u},l.iterations=function(t){return arguments.length?(s=+t,l):s},l.strength=function(t){return arguments.length?(c="function"==typeof t?t:Ds(+t),d(),l):c},l.distance=function(t){return arguments.length?(f="function"==typeof t?t:Ds(+t),p(),l):f},l}Rs.copy=function(){var t,n,e=new Ns(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return e;if(!r.length)return e._root=Is(r),e;for(t=[{source:r,target:e._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(n=r.source[i])&&(n.length?t.push({source:n,target:r.target[i]=new Array(4)}):r.target[i]=Is(n));return e},Rs.add=function(t){var n=+this._x.call(null,t),e=+this._y.call(null,t);return Ts(this.cover(n,e),n,e,t)},Rs.addAll=function(t){var n,e,r,i,o=t.length,a=new Array(o),u=new Array(o),c=1/0,f=1/0,s=-1/0,l=-1/0;for(e=0;e<o;++e)isNaN(r=+this._x.call(null,n=t[e]))||isNaN(i=+this._y.call(null,n))||(a[e]=r,u[e]=i,r<c&&(c=r),r>s&&(s=r),i<f&&(f=i),i>l&&(l=i));if(c>s||f>l)return this;for(this.cover(c,f).cover(s,l),e=0;e<o;++e)Ts(this,a[e],u[e],t[e]);return this},Rs.cover=function(t,n){if(isNaN(t=+t)||isNaN(n=+n))return this;var e=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(e))i=(e=Math.floor(t))+1,o=(r=Math.floor(n))+1;else{for(var a,u,c=i-e||1,f=this._root;e>t||t>=i||r>n||n>=o;)switch(u=(n<r)<<1|t<e,(a=new Array(4))[u]=f,f=a,c*=2,u){case 0:i=e+c,o=r+c;break;case 1:e=i-c,o=r+c;break;case 2:i=e+c,r=o-c;break;case 3:e=i-c,r=o-c}this._root&&this._root.length&&(this._root=f)}return this._x0=e,this._y0=r,this._x1=i,this._y1=o,this},Rs.data=function(){var t=[];return this.visit((function(n){if(!n.length)do{t.push(n.data)}while(n=n.next)})),t},Rs.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Rs.find=function(t,n,e){var r,i,o,a,u,c,f,s=this._x0,l=this._y0,h=this._x1,d=this._y1,p=[],y=this._root;for(y&&p.push(new Es(y,s,l,h,d)),null==e?e=1/0:(s=t-e,l=n-e,h=t+e,d=n+e,e*=e);c=p.pop();)if(!(!(y=c.node)||(i=c.x0)>h||(o=c.y0)>d||(a=c.x1)<s||(u=c.y1)<l))if(y.length){var v=(i+a)/2,g=(o+u)/2;p.push(new Es(y[3],v,g,a,u),new Es(y[2],i,g,v,u),new Es(y[1],v,o,a,g),new Es(y[0],i,o,v,g)),(f=(n>=g)<<1|t>=v)&&(c=p[p.length-1],p[p.length-1]=p[p.length-1-f],p[p.length-1-f]=c)}else{var m=t-+this._x.call(null,y.data),b=n-+this._y.call(null,y.data),x=m*m+b*b;if(x<e){var _=Math.sqrt(e=x);s=t-_,l=n-_,h=t+_,d=n+_,r=y.data}}return r},Rs.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var n,e,r,i,o,a,u,c,f,s,l,h,d=this._root,p=this._x0,y=this._y0,v=this._x1,g=this._y1;if(!d)return this;if(d.length)for(;;){if((f=o>=(u=(p+v)/2))?p=u:v=u,(s=a>=(c=(y+g)/2))?y=c:g=c,n=d,!(d=d[l=s<<1|f]))return this;if(!d.length)break;(n[l+1&3]||n[l+2&3]||n[l+3&3])&&(e=n,h=l)}for(;d.data!==t;)if(r=d,!(d=d.next))return this;return(i=d.next)&&delete d.next,r?(i?r.next=i:delete r.next,this):n?(i?n[l]=i:delete n[l],(d=n[0]||n[1]||n[2]||n[3])&&d===(n[3]||n[2]||n[1]||n[0])&&!d.length&&(e?e[h]=d:this._root=d),this):(this._root=i,this)},Rs.removeAll=function(t){for(var n=0,e=t.length;n<e;++n)this.remove(t[n]);return this},Rs.root=function(){return this._root},Rs.size=function(){var t=0;return this.visit((function(n){if(!n.length)do{++t}while(n=n.next)})),t},Rs.visit=function(t){var n,e,r,i,o,a,u=[],c=this._root;for(c&&u.push(new Es(c,this._x0,this._y0,this._x1,this._y1));n=u.pop();)if(!t(c=n.node,r=n.x0,i=n.y0,o=n.x1,a=n.y1)&&c.length){var f=(r+o)/2,s=(i+a)/2;(e=c[3])&&u.push(new Es(e,f,s,o,a)),(e=c[2])&&u.push(new Es(e,r,s,f,a)),(e=c[1])&&u.push(new Es(e,f,i,o,s)),(e=c[0])&&u.push(new Es(e,r,i,f,s))}return this},Rs.visitAfter=function(t){var n,e=[],r=[];for(this._root&&e.push(new Es(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var i=n.node;if(i.length){var o,a=n.x0,u=n.y0,c=n.x1,f=n.y1,s=(a+c)/2,l=(u+f)/2;(o=i[0])&&e.push(new Es(o,a,u,s,l)),(o=i[1])&&e.push(new Es(o,s,u,c,l)),(o=i[2])&&e.push(new Es(o,a,l,s,f)),(o=i[3])&&e.push(new Es(o,s,l,c,f))}r.push(n)}for(;n=r.pop();)t(n.node,n.x0,n.y0,n.x1,n.y1);return this},Rs.x=function(t){return arguments.length?(this._x=t,this):this._x},Rs.y=function(t){return arguments.length?(this._y=t,this):this._y};var qs=4294967296;function Ys(t){return t.x}function Xs(t){return t.y}var $s=Math.PI*(3-Math.sqrt(5));function Ws(t){var n,e=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,u=new Map,c=eo(l),f=he("tick","end"),s=function(){var t=1;return function(){return(t=(1664525*t+1013904223)%qs)/qs}}();function l(){h(),f.call("tick",n),e<r&&(c.stop(),f.call("end",n))}function h(r){var c,f,s=t.length;void 0===r&&(r=1);for(var l=0;l<r;++l)for(e+=(o-e)*i,u.forEach((function(t){t(e)})),c=0;c<s;++c)null==(f=t[c]).fx?f.x+=f.vx*=a:(f.x=f.fx,f.vx=0),null==f.fy?f.y+=f.vy*=a:(f.y=f.fy,f.vy=0);return n}function d(){for(var n,e=0,r=t.length;e<r;++e){if((n=t[e]).index=e,null!=n.fx&&(n.x=n.fx),null!=n.fy&&(n.y=n.fy),isNaN(n.x)||isNaN(n.y)){var i=10*Math.sqrt(.5+e),o=e*$s;n.x=i*Math.cos(o),n.y=i*Math.sin(o)}(isNaN(n.vx)||isNaN(n.vy))&&(n.vx=n.vy=0)}}function p(n){return n.initialize&&n.initialize(t,s),n}return null==t&&(t=[]),d(),n={tick:h,restart:function(){return c.restart(l),n},stop:function(){return c.stop(),n},nodes:function(e){return arguments.length?(t=e,d(),u.forEach(p),n):t},alpha:function(t){return arguments.length?(e=+t,n):e},alphaMin:function(t){return arguments.length?(r=+t,n):r},alphaDecay:function(t){return arguments.length?(i=+t,n):+i},alphaTarget:function(t){return arguments.length?(o=+t,n):o},velocityDecay:function(t){return arguments.length?(a=1-t,n):1-a},randomSource:function(t){return arguments.length?(s=t,u.forEach(p),n):s},force:function(t,e){return arguments.length>1?(null==e?u.delete(t):u.set(t,p(e)),n):u.get(t)},find:function(n,e,r){var i,o,a,u,c,f=0,s=t.length;for(null==r?r=1/0:r*=r,f=0;f<s;++f)(a=(i=n-(u=t[f]).x)*i+(o=e-u.y)*o)<r&&(c=u,r=a);return c},on:function(t,e){return arguments.length>1?(f.on(t,e),n):f.on(t)}}}function Gs(){var t,n,e,r,i,o=Ds(-30),a=1,u=1/0,c=.81;function f(e){var i,o=t.length,a=Ps(t,Ys,Xs).visitAfter(l);for(r=e,i=0;i<o;++i)n=t[i],a.visit(h)}function s(){if(t){var n,e,r=t.length;for(i=new Array(r),n=0;n<r;++n)e=t[n],i[e.index]=+o(e,n,t)}}function l(t){var n,e,r,o,a,u=0,c=0;if(t.length){for(r=o=a=0;a<4;++a)(n=t[a])&&(e=Math.abs(n.value))&&(u+=n.value,c+=e,r+=e*n.x,o+=e*n.y);t.x=r/c,t.y=o/c}else{(n=t).x=n.data.x,n.y=n.data.y;do{u+=i[n.data.index]}while(n=n.next)}t.value=u}function h(t,o,f,s){if(!t.value)return!0;var l=t.x-n.x,h=t.y-n.y,d=s-o,p=l*l+h*h;if(d*d/c<p)return p<u&&(0===l&&(p+=(l=js(e))*l),0===h&&(p+=(h=js(e))*h),p<a&&(p=Math.sqrt(a*p)),n.vx+=l*t.value*r/p,n.vy+=h*t.value*r/p),!0;if(!(t.length||p>=u)){(t.data!==n||t.next)&&(0===l&&(p+=(l=js(e))*l),0===h&&(p+=(h=js(e))*h),p<a&&(p=Math.sqrt(a*p)));do{t.data!==n&&(d=i[t.data.index]*r/p,n.vx+=l*d,n.vy+=h*d)}while(t=t.next)}}return f.initialize=function(n,r){t=n,e=r,s()},f.strength=function(t){return arguments.length?(o="function"==typeof t?t:Ds(+t),s(),f):o},f.distanceMin=function(t){return arguments.length?(a=t*t,f):Math.sqrt(a)},f.distanceMax=function(t){return arguments.length?(u=t*t,f):Math.sqrt(u)},f.theta=function(t){return arguments.length?(c=t*t,f):Math.sqrt(c)},f}function Qs(t,n,e){var r,i,o,a=Ds(.1);function u(t){for(var a=0,u=r.length;a<u;++a){var c=r[a],f=c.x-n||1e-6,s=c.y-e||1e-6,l=Math.sqrt(f*f+s*s),h=(o[a]-l)*i[a]*t/l;c.vx+=f*h,c.vy+=s*h}}function c(){if(r){var n,e=r.length;for(i=new Array(e),o=new Array(e),n=0;n<e;++n)o[n]=+t(r[n],n,r),i[n]=isNaN(o[n])?0:+a(r[n],n,r)}}return"function"!=typeof t&&(t=Ds(+t)),null==n&&(n=0),null==e&&(e=0),u.initialize=function(t){r=t,c()},u.strength=function(t){return arguments.length?(a="function"==typeof t?t:Ds(+t),c(),u):a},u.radius=function(n){return arguments.length?(t="function"==typeof n?n:Ds(+n),c(),u):t},u.x=function(t){return arguments.length?(n=+t,u):n},u.y=function(t){return arguments.length?(e=+t,u):e},u}function Zs(t){var n,e,r,i=Ds(.1);function o(t){for(var i,o=0,a=n.length;o<a;++o)(i=n[o]).vx+=(r[o]-i.x)*e[o]*t}function a(){if(n){var o,a=n.length;for(e=new Array(a),r=new Array(a),o=0;o<a;++o)e[o]=isNaN(r[o]=+t(n[o],o,n))?0:+i(n[o],o,n)}}return"function"!=typeof t&&(t=Ds(null==t?0:+t)),o.initialize=function(t){n=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:Ds(+t),a(),o):i},o.x=function(n){return arguments.length?(t="function"==typeof n?n:Ds(+n),a(),o):t},o}function Ks(t){var n,e,r,i=Ds(.1);function o(t){for(var i,o=0,a=n.length;o<a;++o)(i=n[o]).vy+=(r[o]-i.y)*e[o]*t}function a(){if(n){var o,a=n.length;for(e=new Array(a),r=new Array(a),o=0;o<a;++o)e[o]=isNaN(r[o]=+t(n[o],o,n))?0:+i(n[o],o,n)}}return"function"!=typeof t&&(t=Ds(null==t?0:+t)),o.initialize=function(t){n=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:Ds(+t),a(),o):i},o.y=function(n){return arguments.length?(t="function"==typeof n?n:Ds(+n),a(),o):t},o}function Js(t,n){if((e=(t=n?t.toExponential(n-1):t.toExponential()).indexOf("e"))<0)return null;var e,r=t.slice(0,e);return[r.length>1?r[0]+r.slice(2):r,+t.slice(e+1)]}function tl(t){return(t=Js(Math.abs(t)))?t[1]:NaN}var nl,el=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function rl(t){if(!(n=el.exec(t)))throw new Error("invalid format: "+t);var n;return new il({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}function il(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function ol(t,n){var e=Js(t,n);if(!e)return t+"";var r=e[0],i=e[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}rl.prototype=il.prototype,il.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var al={"%":function(t,n){return(100*t).toFixed(n)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:function(t,n){return t.toExponential(n)},f:function(t,n){return t.toFixed(n)},g:function(t,n){return t.toPrecision(n)},o:function(t){return Math.round(t).toString(8)},p:function(t,n){return ol(100*t,n)},r:ol,s:function(t,n){var e=Js(t,n);if(!e)return t+"";var r=e[0],i=e[1],o=i-(nl=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Js(t,Math.max(0,n+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function ul(t){return t}var cl,fl,sl,ll=Array.prototype.map,hl=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function dl(t){var n,e,r=void 0===t.grouping||void 0===t.thousands?ul:(n=ll.call(t.grouping,Number),e=t.thousands+"",function(t,r){for(var i=t.length,o=[],a=0,u=n[0],c=0;i>0&&u>0&&(c+u+1>r&&(u=Math.max(1,r-c)),o.push(t.substring(i-=u,i+u)),!((c+=u+1)>r));)u=n[a=(a+1)%n.length];return o.reverse().join(e)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",u=void 0===t.numerals?ul:function(t){return function(n){return n.replace(/[0-9]/g,(function(n){return t[+n]}))}}(ll.call(t.numerals,String)),c=void 0===t.percent?"%":t.percent+"",f=void 0===t.minus?"−":t.minus+"",s=void 0===t.nan?"NaN":t.nan+"";function l(t){var n=(t=rl(t)).fill,e=t.align,l=t.sign,h=t.symbol,d=t.zero,p=t.width,y=t.comma,v=t.precision,g=t.trim,m=t.type;"n"===m?(y=!0,m="g"):al[m]||(void 0===v&&(v=12),g=!0,m="g"),(d||"0"===n&&"="===e)&&(d=!0,n="0",e="=");var b="$"===h?i:"#"===h&&/[boxX]/.test(m)?"0"+m.toLowerCase():"",x="$"===h?o:/[%p]/.test(m)?c:"",_=al[m],w=/[defgprs%]/.test(m);function S(t){var i,o,c,h=b,S=x;if("c"===m)S=_(t)+S,t="";else{var A=(t=+t)<0||1/t<0;if(t=isNaN(t)?s:_(Math.abs(t),v),g&&(t=function(t){t:for(var n,e=t.length,r=1,i=-1;r<e;++r)switch(t[r]){case".":i=n=r;break;case"0":0===i&&(i=r),n=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(n+1):t}(t)),A&&0==+t&&"+"!==l&&(A=!1),h=(A?"("===l?l:f:"-"===l||"("===l?"":l)+h,S=("s"===m?hl[8+nl/3]:"")+S+(A&&"("===l?")":""),w)for(i=-1,o=t.length;++i<o;)if(48>(c=t.charCodeAt(i))||c>57){S=(46===c?a+t.slice(i+1):t.slice(i))+S,t=t.slice(0,i);break}}y&&!d&&(t=r(t,1/0));var M=h.length+t.length+S.length,k=M<p?new Array(p-M+1).join(n):"";switch(y&&d&&(t=r(k+t,k.length?p-S.length:1/0),k=""),e){case"<":t=h+t+S+k;break;case"=":t=h+k+t+S;break;case"^":t=k.slice(0,M=k.length>>1)+h+t+S+k.slice(M);break;default:t=k+h+t+S}return u(t)}return v=void 0===v?6:/[gprs]/.test(m)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),S.toString=function(){return t+""},S}return{format:l,formatPrefix:function(t,n){var e=l(((t=rl(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(tl(n)/3))),i=Math.pow(10,-r),o=hl[8+r/3];return function(t){return e(i*t)+o}}}}function pl(t){return cl=dl(t),fl=cl.format,sl=cl.formatPrefix,cl}function yl(t){return Math.max(0,-tl(Math.abs(t)))}function vl(t,n){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(tl(n)/3)))-tl(Math.abs(t)))}function gl(t,n){return t=Math.abs(t),n=Math.abs(n)-t,Math.max(0,tl(n)-tl(t))+1}pl({thousands:",",grouping:[3],currency:["$",""]});var ml=1e-6,bl=1e-12,xl=Math.PI,_l=xl/2,wl=xl/4,Sl=2*xl,Al=180/xl,Ml=xl/180,kl=Math.abs,Tl=Math.atan,El=Math.atan2,Cl=Math.cos,Ol=Math.ceil,Pl=Math.exp,Nl=(Math.floor,Math.hypot),Il=Math.log,Rl=Math.pow,Dl=Math.sin,jl=Math.sign||function(t){return t>0?1:t<0?-1:0},zl=Math.sqrt,Vl=Math.tan;function Ll(t){return t>1?0:t<-1?xl:Math.acos(t)}function Ul(t){return t>1?_l:t<-1?-_l:Math.asin(t)}function Fl(t){return(t=Dl(t/2))*t}function Bl(){}function Hl(t,n){t&&Yl.hasOwnProperty(t.type)&&Yl[t.type](t,n)}var ql={Feature:function(t,n){Hl(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,r=-1,i=e.length;++r<i;)Hl(e[r].geometry,n)}},Yl={Sphere:function(t,n){n.sphere()},Point:function(t,n){t=t.coordinates,n.point(t[0],t[1],t[2])},MultiPoint:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)t=e[r],n.point(t[0],t[1],t[2])},LineString:function(t,n){Xl(t.coordinates,n,0)},MultiLineString:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)Xl(e[r],n,0)},Polygon:function(t,n){$l(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)$l(e[r],n)},GeometryCollection:function(t,n){for(var e=t.geometries,r=-1,i=e.length;++r<i;)Hl(e[r],n)}};function Xl(t,n,e){var r,i=-1,o=t.length-e;for(n.lineStart();++i<o;)r=t[i],n.point(r[0],r[1],r[2]);n.lineEnd()}function $l(t,n){var e=-1,r=t.length;for(n.polygonStart();++e<r;)Xl(t[e],n,1);n.polygonEnd()}function Wl(t,n){t&&ql.hasOwnProperty(t.type)?ql[t.type](t,n):Hl(t,n)}var Gl,Ql,Zl,Kl,Jl,th,nh,eh,rh,ih,oh,ah,uh,ch,fh,sh,lh=new F,hh=new F,dh={point:Bl,lineStart:Bl,lineEnd:Bl,polygonStart:function(){lh=new F,dh.lineStart=ph,dh.lineEnd=yh},polygonEnd:function(){var t=+lh;hh.add(t<0?Sl+t:t),this.lineStart=this.lineEnd=this.point=Bl},sphere:function(){hh.add(Sl)}};function ph(){dh.point=vh}function yh(){gh(Gl,Ql)}function vh(t,n){dh.point=gh,Gl=t,Ql=n,Zl=t*=Ml,Kl=Cl(n=(n*=Ml)/2+wl),Jl=Dl(n)}function gh(t,n){var e=(t*=Ml)-Zl,r=e>=0?1:-1,i=r*e,o=Cl(n=(n*=Ml)/2+wl),a=Dl(n),u=Jl*a,c=Kl*o+u*Cl(i),f=u*r*Dl(i);lh.add(El(f,c)),Zl=t,Kl=o,Jl=a}function mh(t){return hh=new F,Wl(t,dh),2*hh}function bh(t){return[El(t[1],t[0]),Ul(t[2])]}function xh(t){var n=t[0],e=t[1],r=Cl(e);return[r*Cl(n),r*Dl(n),Dl(e)]}function _h(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function wh(t,n){return[t[1]*n[2]-t[2]*n[1],t[2]*n[0]-t[0]*n[2],t[0]*n[1]-t[1]*n[0]]}function Sh(t,n){t[0]+=n[0],t[1]+=n[1],t[2]+=n[2]}function Ah(t,n){return[t[0]*n,t[1]*n,t[2]*n]}function Mh(t){var n=zl(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=n,t[1]/=n,t[2]/=n}var kh,Th,Eh,Ch,Oh,Ph,Nh,Ih,Rh,Dh,jh,zh,Vh,Lh,Uh,Fh,Bh={point:Hh,lineStart:Yh,lineEnd:Xh,polygonStart:function(){Bh.point=$h,Bh.lineStart=Wh,Bh.lineEnd=Gh,ch=new F,dh.polygonStart()},polygonEnd:function(){dh.polygonEnd(),Bh.point=Hh,Bh.lineStart=Yh,Bh.lineEnd=Xh,lh<0?(th=-(eh=180),nh=-(rh=90)):ch>ml?rh=90:ch<-1e-6&&(nh=-90),sh[0]=th,sh[1]=eh},sphere:function(){th=-(eh=180),nh=-(rh=90)}};function Hh(t,n){fh.push(sh=[th=t,eh=t]),n<nh&&(nh=n),n>rh&&(rh=n)}function qh(t,n){var e=xh([t*Ml,n*Ml]);if(uh){var r=wh(uh,e),i=wh([r[1],-r[0],0],r);Mh(i),i=bh(i);var o,a=t-ih,u=a>0?1:-1,c=i[0]*Al*u,f=kl(a)>180;f^(u*ih<c&&c<u*t)?(o=i[1]*Al)>rh&&(rh=o):f^(u*ih<(c=(c+360)%360-180)&&c<u*t)?(o=-i[1]*Al)<nh&&(nh=o):(n<nh&&(nh=n),n>rh&&(rh=n)),f?t<ih?Qh(th,t)>Qh(th,eh)&&(eh=t):Qh(t,eh)>Qh(th,eh)&&(th=t):eh>=th?(t<th&&(th=t),t>eh&&(eh=t)):t>ih?Qh(th,t)>Qh(th,eh)&&(eh=t):Qh(t,eh)>Qh(th,eh)&&(th=t)}else fh.push(sh=[th=t,eh=t]);n<nh&&(nh=n),n>rh&&(rh=n),uh=e,ih=t}function Yh(){Bh.point=qh}function Xh(){sh[0]=th,sh[1]=eh,Bh.point=Hh,uh=null}function $h(t,n){if(uh){var e=t-ih;ch.add(kl(e)>180?e+(e>0?360:-360):e)}else oh=t,ah=n;dh.point(t,n),qh(t,n)}function Wh(){dh.lineStart()}function Gh(){$h(oh,ah),dh.lineEnd(),kl(ch)>ml&&(th=-(eh=180)),sh[0]=th,sh[1]=eh,uh=null}function Qh(t,n){return(n-=t)<0?n+360:n}function Zh(t,n){return t[0]-n[0]}function Kh(t,n){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}function Jh(t){var n,e,r,i,o,a,u;if(rh=eh=-(th=nh=1/0),fh=[],Wl(t,Bh),e=fh.length){for(fh.sort(Zh),n=1,o=[r=fh[0]];n<e;++n)Kh(r,(i=fh[n])[0])||Kh(r,i[1])?(Qh(r[0],i[1])>Qh(r[0],r[1])&&(r[1]=i[1]),Qh(i[0],r[1])>Qh(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(a=-1/0,n=0,r=o[e=o.length-1];n<=e;r=i,++n)i=o[n],(u=Qh(r[1],i[0]))>a&&(a=u,th=i[0],eh=r[1])}return fh=sh=null,th===1/0||nh===1/0?[[NaN,NaN],[NaN,NaN]]:[[th,nh],[eh,rh]]}var td={sphere:Bl,point:nd,lineStart:rd,lineEnd:ad,polygonStart:function(){td.lineStart=ud,td.lineEnd=cd},polygonEnd:function(){td.lineStart=rd,td.lineEnd=ad}};function nd(t,n){t*=Ml;var e=Cl(n*=Ml);ed(e*Cl(t),e*Dl(t),Dl(n))}function ed(t,n,e){++kh,Eh+=(t-Eh)/kh,Ch+=(n-Ch)/kh,Oh+=(e-Oh)/kh}function rd(){td.point=id}function id(t,n){t*=Ml;var e=Cl(n*=Ml);Lh=e*Cl(t),Uh=e*Dl(t),Fh=Dl(n),td.point=od,ed(Lh,Uh,Fh)}function od(t,n){t*=Ml;var e=Cl(n*=Ml),r=e*Cl(t),i=e*Dl(t),o=Dl(n),a=El(zl((a=Uh*o-Fh*i)*a+(a=Fh*r-Lh*o)*a+(a=Lh*i-Uh*r)*a),Lh*r+Uh*i+Fh*o);Th+=a,Ph+=a*(Lh+(Lh=r)),Nh+=a*(Uh+(Uh=i)),Ih+=a*(Fh+(Fh=o)),ed(Lh,Uh,Fh)}function ad(){td.point=nd}function ud(){td.point=fd}function cd(){sd(zh,Vh),td.point=nd}function fd(t,n){zh=t,Vh=n,t*=Ml,n*=Ml,td.point=sd;var e=Cl(n);Lh=e*Cl(t),Uh=e*Dl(t),Fh=Dl(n),ed(Lh,Uh,Fh)}function sd(t,n){t*=Ml;var e=Cl(n*=Ml),r=e*Cl(t),i=e*Dl(t),o=Dl(n),a=Uh*o-Fh*i,u=Fh*r-Lh*o,c=Lh*i-Uh*r,f=Nl(a,u,c),s=Ul(f),l=f&&-s/f;Rh.add(l*a),Dh.add(l*u),jh.add(l*c),Th+=s,Ph+=s*(Lh+(Lh=r)),Nh+=s*(Uh+(Uh=i)),Ih+=s*(Fh+(Fh=o)),ed(Lh,Uh,Fh)}function ld(t){kh=Th=Eh=Ch=Oh=Ph=Nh=Ih=0,Rh=new F,Dh=new F,jh=new F,Wl(t,td);var n=+Rh,e=+Dh,r=+jh,i=Nl(n,e,r);return i<bl&&(n=Ph,e=Nh,r=Ih,Th<ml&&(n=Eh,e=Ch,r=Oh),(i=Nl(n,e,r))<bl)?[NaN,NaN]:[El(e,n)*Al,Ul(r/i)*Al]}function hd(t){return function(){return t}}function dd(t,n){function e(e,r){return e=t(e,r),n(e[0],e[1])}return t.invert&&n.invert&&(e.invert=function(e,r){return(e=n.invert(e,r))&&t.invert(e[0],e[1])}),e}function pd(t,n){return[kl(t)>xl?t+Math.round(-t/Sl)*Sl:t,n]}function yd(t,n,e){return(t%=Sl)?n||e?dd(gd(t),md(n,e)):gd(t):n||e?md(n,e):pd}function vd(t){return function(n,e){return[(n+=t)>xl?n-Sl:n<-xl?n+Sl:n,e]}}function gd(t){var n=vd(t);return n.invert=vd(-t),n}function md(t,n){var e=Cl(t),r=Dl(t),i=Cl(n),o=Dl(n);function a(t,n){var a=Cl(n),u=Cl(t)*a,c=Dl(t)*a,f=Dl(n),s=f*e+u*r;return[El(c*i-s*o,u*e-f*r),Ul(s*i+c*o)]}return a.invert=function(t,n){var a=Cl(n),u=Cl(t)*a,c=Dl(t)*a,f=Dl(n),s=f*i-c*o;return[El(c*i+f*o,u*e+s*r),Ul(s*e-u*r)]},a}function bd(t){function n(n){return(n=t(n[0]*Ml,n[1]*Ml))[0]*=Al,n[1]*=Al,n}return t=yd(t[0]*Ml,t[1]*Ml,t.length>2?t[2]*Ml:0),n.invert=function(n){return(n=t.invert(n[0]*Ml,n[1]*Ml))[0]*=Al,n[1]*=Al,n},n}function xd(t,n,e,r,i,o){if(e){var a=Cl(n),u=Dl(n),c=r*e;null==i?(i=n+r*Sl,o=n-c/2):(i=_d(a,i),o=_d(a,o),(r>0?i<o:i>o)&&(i+=r*Sl));for(var f,s=i;r>0?s>o:s<o;s-=c)f=bh([a,-u*Cl(s),-u*Dl(s)]),t.point(f[0],f[1])}}function _d(t,n){(n=xh(n))[0]-=t,Mh(n);var e=Ll(-n[1]);return((-n[2]<0?-e:e)+Sl-ml)%Sl}function wd(){var t,n,e=hd([0,0]),r=hd(90),i=hd(6),o={point:function(e,r){t.push(e=n(e,r)),e[0]*=Al,e[1]*=Al}};function a(){var a=e.apply(this,arguments),u=r.apply(this,arguments)*Ml,c=i.apply(this,arguments)*Ml;return t=[],n=yd(-a[0]*Ml,-a[1]*Ml,0).invert,xd(o,u,c,1),a={type:"Polygon",coordinates:[t]},t=n=null,a}return a.center=function(t){return arguments.length?(e="function"==typeof t?t:hd([+t[0],+t[1]]),a):e},a.radius=function(t){return arguments.length?(r="function"==typeof t?t:hd(+t),a):r},a.precision=function(t){return arguments.length?(i="function"==typeof t?t:hd(+t),a):i},a}function Sd(){var t,n=[];return{point:function(n,e,r){t.push([n,e,r])},lineStart:function(){n.push(t=[])},lineEnd:Bl,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var e=n;return n=[],t=null,e}}}function Ad(t,n){return kl(t[0]-n[0])<ml&&kl(t[1]-n[1])<ml}function Md(t,n,e,r){this.x=t,this.z=n,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}function kd(t,n,e,r,i){var o,a,u=[],c=[];if(t.forEach((function(t){if(!((n=t.length-1)<=0)){var n,e,r=t[0],a=t[n];if(Ad(r,a)){if(!r[2]&&!a[2]){for(i.lineStart(),o=0;o<n;++o)i.point((r=t[o])[0],r[1]);return void i.lineEnd()}a[0]+=2e-6}u.push(e=new Md(r,t,null,!0)),c.push(e.o=new Md(r,null,e,!1)),u.push(e=new Md(a,t,null,!1)),c.push(e.o=new Md(a,null,e,!0))}})),u.length){for(c.sort(n),Td(u),Td(c),o=0,a=c.length;o<a;++o)c[o].e=e=!e;for(var f,s,l=u[0];;){for(var h=l,d=!0;h.v;)if((h=h.n)===l)return;f=h.z,i.lineStart();do{if(h.v=h.o.v=!0,h.e){if(d)for(o=0,a=f.length;o<a;++o)i.point((s=f[o])[0],s[1]);else r(h.x,h.n.x,1,i);h=h.n}else{if(d)for(f=h.p.z,o=f.length-1;o>=0;--o)i.point((s=f[o])[0],s[1]);else r(h.x,h.p.x,-1,i);h=h.p}f=(h=h.o).z,d=!d}while(!h.v);i.lineEnd()}}}function Td(t){if(n=t.length){for(var n,e,r=0,i=t[0];++r<n;)i.n=e=t[r],e.p=i,i=e;i.n=e=t[0],e.p=i}}function Ed(t){return kl(t[0])<=xl?t[0]:jl(t[0])*((kl(t[0])+xl)%Sl-xl)}function Cd(t,n){var e=Ed(n),r=n[1],i=Dl(r),o=[Dl(e),-Cl(e),0],a=0,u=0,c=new F;1===i?r=_l+ml:-1===i&&(r=-_l-ml);for(var f=0,s=t.length;f<s;++f)if(h=(l=t[f]).length)for(var l,h,d=l[h-1],p=Ed(d),y=d[1]/2+wl,v=Dl(y),g=Cl(y),m=0;m<h;++m,p=x,v=w,g=S,d=b){var b=l[m],x=Ed(b),_=b[1]/2+wl,w=Dl(_),S=Cl(_),A=x-p,M=A>=0?1:-1,k=M*A,T=k>xl,E=v*w;if(c.add(El(E*M*Dl(k),g*S+E*Cl(k))),a+=T?A+M*Sl:A,T^p>=e^x>=e){var C=wh(xh(d),xh(b));Mh(C);var O=wh(o,C);Mh(O);var P=(T^A>=0?-1:1)*Ul(O[2]);(r>P||r===P&&(C[0]||C[1]))&&(u+=T^A>=0?1:-1)}}return(a<-1e-6||a<ml&&c<-1e-12)^1&u}function Od(t,n,e,r){return function(i){var o,a,u,c=n(i),f=Sd(),s=n(f),l=!1,h={point:d,lineStart:y,lineEnd:v,polygonStart:function(){h.point=g,h.lineStart=m,h.lineEnd=b,a=[],o=[]},polygonEnd:function(){h.point=d,h.lineStart=y,h.lineEnd=v,a=Lt(a);var t=Cd(o,r);a.length?(l||(i.polygonStart(),l=!0),kd(a,Nd,t,e,i)):t&&(l||(i.polygonStart(),l=!0),i.lineStart(),e(null,null,1,i),i.lineEnd()),l&&(i.polygonEnd(),l=!1),a=o=null},sphere:function(){i.polygonStart(),i.lineStart(),e(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(n,e){t(n,e)&&i.point(n,e)}function p(t,n){c.point(t,n)}function y(){h.point=p,c.lineStart()}function v(){h.point=d,c.lineEnd()}function g(t,n){u.push([t,n]),s.point(t,n)}function m(){s.lineStart(),u=[]}function b(){g(u[0][0],u[0][1]),s.lineEnd();var t,n,e,r,c=s.clean(),h=f.result(),d=h.length;if(u.pop(),o.push(u),u=null,d)if(1&c){if((n=(e=h[0]).length-1)>0){for(l||(i.polygonStart(),l=!0),i.lineStart(),t=0;t<n;++t)i.point((r=e[t])[0],r[1]);i.lineEnd()}}else d>1&&2&c&&h.push(h.pop().concat(h.shift())),a.push(h.filter(Pd))}return h}}function Pd(t){return t.length>1}function Nd(t,n){return((t=t.x)[0]<0?t[1]-_l-ml:_l-t[1])-((n=n.x)[0]<0?n[1]-_l-ml:_l-n[1])}pd.invert=pd;var Id=Od((function(){return!0}),(function(t){var n,e=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),n=1},point:function(o,a){var u=o>0?xl:-xl,c=kl(o-e);kl(c-xl)<ml?(t.point(e,r=(r+a)/2>0?_l:-_l),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(u,r),t.point(o,r),n=0):i!==u&&c>=xl&&(kl(e-i)<ml&&(e-=i*ml),kl(o-u)<ml&&(o-=u*ml),r=function(t,n,e,r){var i,o,a=Dl(t-e);return kl(a)>ml?Tl((Dl(n)*(o=Cl(r))*Dl(e)-Dl(r)*(i=Cl(n))*Dl(t))/(i*o*a)):(n+r)/2}(e,r,o,a),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(u,r),n=0),t.point(e=o,r=a),i=u},lineEnd:function(){t.lineEnd(),e=r=NaN},clean:function(){return 2-n}}}),(function(t,n,e,r){var i;if(null==t)i=e*_l,r.point(-xl,i),r.point(0,i),r.point(xl,i),r.point(xl,0),r.point(xl,-i),r.point(0,-i),r.point(-xl,-i),r.point(-xl,0),r.point(-xl,i);else if(kl(t[0]-n[0])>ml){var o=t[0]<n[0]?xl:-xl;i=e*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(n[0],n[1])}),[-xl,-_l]);function Rd(t){var n=Cl(t),e=6*Ml,r=n>0,i=kl(n)>ml;function o(t,e){return Cl(t)*Cl(e)>n}function a(t,e,r){var i=[1,0,0],o=wh(xh(t),xh(e)),a=_h(o,o),u=o[0],c=a-u*u;if(!c)return!r&&t;var f=n*a/c,s=-n*u/c,l=wh(i,o),h=Ah(i,f);Sh(h,Ah(o,s));var d=l,p=_h(h,d),y=_h(d,d),v=p*p-y*(_h(h,h)-1);if(!(v<0)){var g=zl(v),m=Ah(d,(-p-g)/y);if(Sh(m,h),m=bh(m),!r)return m;var b,x=t[0],_=e[0],w=t[1],S=e[1];_<x&&(b=x,x=_,_=b);var A=_-x,M=kl(A-xl)<ml;if(!M&&S<w&&(b=w,w=S,S=b),M||A<ml?M?w+S>0^m[1]<(kl(m[0]-x)<ml?w:S):w<=m[1]&&m[1]<=S:A>xl^(x<=m[0]&&m[0]<=_)){var k=Ah(d,(-p+g)/y);return Sh(k,h),[m,bh(k)]}}}function u(n,e){var i=r?t:xl-t,o=0;return n<-i?o|=1:n>i&&(o|=2),e<-i?o|=4:e>i&&(o|=8),o}return Od(o,(function(t){var n,e,c,f,s;return{lineStart:function(){f=c=!1,s=1},point:function(l,h){var d,p=[l,h],y=o(l,h),v=r?y?0:u(l,h):y?u(l+(l<0?xl:-xl),h):0;if(!n&&(f=c=y)&&t.lineStart(),y!==c&&(!(d=a(n,p))||Ad(n,d)||Ad(p,d))&&(p[2]=1),y!==c)s=0,y?(t.lineStart(),d=a(p,n),t.point(d[0],d[1])):(d=a(n,p),t.point(d[0],d[1],2),t.lineEnd()),n=d;else if(i&&n&&r^y){var g;v&e||!(g=a(p,n,!0))||(s=0,r?(t.lineStart(),t.point(g[0][0],g[0][1]),t.point(g[1][0],g[1][1]),t.lineEnd()):(t.point(g[1][0],g[1][1]),t.lineEnd(),t.lineStart(),t.point(g[0][0],g[0][1],3)))}!y||n&&Ad(n,p)||t.point(p[0],p[1]),n=p,c=y,e=v},lineEnd:function(){c&&t.lineEnd(),n=null},clean:function(){return s|(f&&c)<<1}}}),(function(n,r,i,o){xd(o,t,e,i,n,r)}),r?[0,-t]:[-xl,t-xl])}var Dd,jd,zd,Vd,Ld=1e9,Ud=-Ld;function Fd(t,n,e,r){function i(i,o){return t<=i&&i<=e&&n<=o&&o<=r}function o(i,o,u,f){var s=0,l=0;if(null==i||(s=a(i,u))!==(l=a(o,u))||c(i,o)<0^u>0)do{f.point(0===s||3===s?t:e,s>1?r:n)}while((s=(s+u+4)%4)!==l);else f.point(o[0],o[1])}function a(r,i){return kl(r[0]-t)<ml?i>0?0:3:kl(r[0]-e)<ml?i>0?2:1:kl(r[1]-n)<ml?i>0?1:0:i>0?3:2}function u(t,n){return c(t.x,n.x)}function c(t,n){var e=a(t,1),r=a(n,1);return e!==r?e-r:0===e?n[1]-t[1]:1===e?t[0]-n[0]:2===e?t[1]-n[1]:n[0]-t[0]}return function(a){var c,f,s,l,h,d,p,y,v,g,m,b=a,x=Sd(),_={point:w,lineStart:function(){_.point=S,f&&f.push(s=[]);g=!0,v=!1,p=y=NaN},lineEnd:function(){c&&(S(l,h),d&&v&&x.rejoin(),c.push(x.result()));_.point=w,v&&b.lineEnd()},polygonStart:function(){b=x,c=[],f=[],m=!0},polygonEnd:function(){var n=function(){for(var n=0,e=0,i=f.length;e<i;++e)for(var o,a,u=f[e],c=1,s=u.length,l=u[0],h=l[0],d=l[1];c<s;++c)o=h,a=d,h=(l=u[c])[0],d=l[1],a<=r?d>r&&(h-o)*(r-a)>(d-a)*(t-o)&&++n:d<=r&&(h-o)*(r-a)<(d-a)*(t-o)&&--n;return n}(),e=m&&n,i=(c=Lt(c)).length;(e||i)&&(a.polygonStart(),e&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),i&&kd(c,u,n,o,a),a.polygonEnd());b=a,c=f=s=null}};function w(t,n){i(t,n)&&b.point(t,n)}function S(o,a){var u=i(o,a);if(f&&s.push([o,a]),g)l=o,h=a,d=u,g=!1,u&&(b.lineStart(),b.point(o,a));else if(u&&v)b.point(o,a);else{var c=[p=Math.max(Ud,Math.min(Ld,p)),y=Math.max(Ud,Math.min(Ld,y))],x=[o=Math.max(Ud,Math.min(Ld,o)),a=Math.max(Ud,Math.min(Ld,a))];!function(t,n,e,r,i,o){var a,u=t[0],c=t[1],f=0,s=1,l=n[0]-u,h=n[1]-c;if(a=e-u,l||!(a>0)){if(a/=l,l<0){if(a<f)return;a<s&&(s=a)}else if(l>0){if(a>s)return;a>f&&(f=a)}if(a=i-u,l||!(a<0)){if(a/=l,l<0){if(a>s)return;a>f&&(f=a)}else if(l>0){if(a<f)return;a<s&&(s=a)}if(a=r-c,h||!(a>0)){if(a/=h,h<0){if(a<f)return;a<s&&(s=a)}else if(h>0){if(a>s)return;a>f&&(f=a)}if(a=o-c,h||!(a<0)){if(a/=h,h<0){if(a>s)return;a>f&&(f=a)}else if(h>0){if(a<f)return;a<s&&(s=a)}return f>0&&(t[0]=u+f*l,t[1]=c+f*h),s<1&&(n[0]=u+s*l,n[1]=c+s*h),!0}}}}}(c,x,t,n,e,r)?u&&(b.lineStart(),b.point(o,a),m=!1):(v||(b.lineStart(),b.point(c[0],c[1])),b.point(x[0],x[1]),u||b.lineEnd(),m=!1)}p=o,y=a,v=u}return _}}function Bd(){var t,n,e,r=0,i=0,o=960,a=500;return e={stream:function(e){return t&&n===e?t:t=Fd(r,i,o,a)(n=e)},extent:function(u){return arguments.length?(r=+u[0][0],i=+u[0][1],o=+u[1][0],a=+u[1][1],t=n=null,e):[[r,i],[o,a]]}}}var Hd={sphere:Bl,point:Bl,lineStart:function(){Hd.point=Yd,Hd.lineEnd=qd},lineEnd:Bl,polygonStart:Bl,polygonEnd:Bl};function qd(){Hd.point=Hd.lineEnd=Bl}function Yd(t,n){jd=t*=Ml,zd=Dl(n*=Ml),Vd=Cl(n),Hd.point=Xd}function Xd(t,n){t*=Ml;var e=Dl(n*=Ml),r=Cl(n),i=kl(t-jd),o=Cl(i),a=r*Dl(i),u=Vd*e-zd*r*o,c=zd*e+Vd*r*o;Dd.add(El(zl(a*a+u*u),c)),jd=t,zd=e,Vd=r}function $d(t){return Dd=new F,Wl(t,Hd),+Dd}var Wd=[null,null],Gd={type:"LineString",coordinates:Wd};function Qd(t,n){return Wd[0]=t,Wd[1]=n,$d(Gd)}var Zd={Feature:function(t,n){return Jd(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,r=-1,i=e.length;++r<i;)if(Jd(e[r].geometry,n))return!0;return!1}},Kd={Sphere:function(){return!0},Point:function(t,n){return tp(t.coordinates,n)},MultiPoint:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)if(tp(e[r],n))return!0;return!1},LineString:function(t,n){return np(t.coordinates,n)},MultiLineString:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)if(np(e[r],n))return!0;return!1},Polygon:function(t,n){return ep(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)if(ep(e[r],n))return!0;return!1},GeometryCollection:function(t,n){for(var e=t.geometries,r=-1,i=e.length;++r<i;)if(Jd(e[r],n))return!0;return!1}};function Jd(t,n){return!(!t||!Kd.hasOwnProperty(t.type))&&Kd[t.type](t,n)}function tp(t,n){return 0===Qd(t,n)}function np(t,n){for(var e,r,i,o=0,a=t.length;o<a;o++){if(0===(r=Qd(t[o],n)))return!0;if(o>0&&(i=Qd(t[o],t[o-1]))>0&&e<=i&&r<=i&&(e+r-i)*(1-Math.pow((e-r)/i,2))<bl*i)return!0;e=r}return!1}function ep(t,n){return!!Cd(t.map(rp),ip(n))}function rp(t){return(t=t.map(ip)).pop(),t}function ip(t){return[t[0]*Ml,t[1]*Ml]}function op(t,n){return(t&&Zd.hasOwnProperty(t.type)?Zd[t.type]:Jd)(t,n)}function ap(t,n,e){var r=Wt(t,n-ml,e).concat(n);return function(t){return r.map((function(n){return[t,n]}))}}function up(t,n,e){var r=Wt(t,n-ml,e).concat(n);return function(t){return r.map((function(n){return[n,t]}))}}function cp(){var t,n,e,r,i,o,a,u,c,f,s,l,h=10,d=h,p=90,y=360,v=2.5;function g(){return{type:"MultiLineString",coordinates:m()}}function m(){return Wt(Ol(r/p)*p,e,p).map(s).concat(Wt(Ol(u/y)*y,a,y).map(l)).concat(Wt(Ol(n/h)*h,t,h).filter((function(t){return kl(t%p)>ml})).map(c)).concat(Wt(Ol(o/d)*d,i,d).filter((function(t){return kl(t%y)>ml})).map(f))}return g.lines=function(){return m().map((function(t){return{type:"LineString",coordinates:t}}))},g.outline=function(){return{type:"Polygon",coordinates:[s(r).concat(l(a).slice(1),s(e).reverse().slice(1),l(u).reverse().slice(1))]}},g.extent=function(t){return arguments.length?g.extentMajor(t).extentMinor(t):g.extentMinor()},g.extentMajor=function(t){return arguments.length?(r=+t[0][0],e=+t[1][0],u=+t[0][1],a=+t[1][1],r>e&&(t=r,r=e,e=t),u>a&&(t=u,u=a,a=t),g.precision(v)):[[r,u],[e,a]]},g.extentMinor=function(e){return arguments.length?(n=+e[0][0],t=+e[1][0],o=+e[0][1],i=+e[1][1],n>t&&(e=n,n=t,t=e),o>i&&(e=o,o=i,i=e),g.precision(v)):[[n,o],[t,i]]},g.step=function(t){return arguments.length?g.stepMajor(t).stepMinor(t):g.stepMinor()},g.stepMajor=function(t){return arguments.length?(p=+t[0],y=+t[1],g):[p,y]},g.stepMinor=function(t){return arguments.length?(h=+t[0],d=+t[1],g):[h,d]},g.precision=function(h){return arguments.length?(v=+h,c=ap(o,i,90),f=up(n,t,v),s=ap(u,a,90),l=up(r,e,v),g):v},g.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}function fp(){return cp()()}function sp(t,n){var e=t[0]*Ml,r=t[1]*Ml,i=n[0]*Ml,o=n[1]*Ml,a=Cl(r),u=Dl(r),c=Cl(o),f=Dl(o),s=a*Cl(e),l=a*Dl(e),h=c*Cl(i),d=c*Dl(i),p=2*Ul(zl(Fl(o-r)+a*c*Fl(i-e))),y=Dl(p),v=p?function(t){var n=Dl(t*=p)/y,e=Dl(p-t)/y,r=e*s+n*h,i=e*l+n*d,o=e*u+n*f;return[El(i,r)*Al,El(o,zl(r*r+i*i))*Al]}:function(){return[e*Al,r*Al]};return v.distance=p,v}var lp,hp,dp,pp,yp=function(t){return t},vp=new F,gp=new F,mp={point:Bl,lineStart:Bl,lineEnd:Bl,polygonStart:function(){mp.lineStart=bp,mp.lineEnd=wp},polygonEnd:function(){mp.lineStart=mp.lineEnd=mp.point=Bl,vp.add(kl(gp)),gp=new F},result:function(){var t=vp/2;return vp=new F,t}};function bp(){mp.point=xp}function xp(t,n){mp.point=_p,lp=dp=t,hp=pp=n}function _p(t,n){gp.add(pp*t-dp*n),dp=t,pp=n}function wp(){_p(lp,hp)}var Sp=mp,Ap=1/0,Mp=Ap,kp=-Ap,Tp=kp;var Ep,Cp,Op,Pp,Np={point:function(t,n){t<Ap&&(Ap=t);t>kp&&(kp=t);n<Mp&&(Mp=n);n>Tp&&(Tp=n)},lineStart:Bl,lineEnd:Bl,polygonStart:Bl,polygonEnd:Bl,result:function(){var t=[[Ap,Mp],[kp,Tp]];return kp=Tp=-(Mp=Ap=1/0),t}},Ip=0,Rp=0,Dp=0,jp=0,zp=0,Vp=0,Lp=0,Up=0,Fp=0,Bp={point:Hp,lineStart:qp,lineEnd:$p,polygonStart:function(){Bp.lineStart=Wp,Bp.lineEnd=Gp},polygonEnd:function(){Bp.point=Hp,Bp.lineStart=qp,Bp.lineEnd=$p},result:function(){var t=Fp?[Lp/Fp,Up/Fp]:Vp?[jp/Vp,zp/Vp]:Dp?[Ip/Dp,Rp/Dp]:[NaN,NaN];return Ip=Rp=Dp=jp=zp=Vp=Lp=Up=Fp=0,t}};function Hp(t,n){Ip+=t,Rp+=n,++Dp}function qp(){Bp.point=Yp}function Yp(t,n){Bp.point=Xp,Hp(Op=t,Pp=n)}function Xp(t,n){var e=t-Op,r=n-Pp,i=zl(e*e+r*r);jp+=i*(Op+t)/2,zp+=i*(Pp+n)/2,Vp+=i,Hp(Op=t,Pp=n)}function $p(){Bp.point=Hp}function Wp(){Bp.point=Qp}function Gp(){Zp(Ep,Cp)}function Qp(t,n){Bp.point=Zp,Hp(Ep=Op=t,Cp=Pp=n)}function Zp(t,n){var e=t-Op,r=n-Pp,i=zl(e*e+r*r);jp+=i*(Op+t)/2,zp+=i*(Pp+n)/2,Vp+=i,Lp+=(i=Pp*t-Op*n)*(Op+t),Up+=i*(Pp+n),Fp+=3*i,Hp(Op=t,Pp=n)}var Kp=Bp;function Jp(t){this._context=t}Jp.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,n){switch(this._point){case 0:this._context.moveTo(t,n),this._point=1;break;case 1:this._context.lineTo(t,n);break;default:this._context.moveTo(t+this._radius,n),this._context.arc(t,n,this._radius,0,Sl)}},result:Bl};var ty,ny,ey,ry,iy,oy=new F,ay={point:Bl,lineStart:function(){ay.point=uy},lineEnd:function(){ty&&cy(ny,ey),ay.point=Bl},polygonStart:function(){ty=!0},polygonEnd:function(){ty=null},result:function(){var t=+oy;return oy=new F,t}};function uy(t,n){ay.point=cy,ny=ry=t,ey=iy=n}function cy(t,n){ry-=t,iy-=n,oy.add(zl(ry*ry+iy*iy)),ry=t,iy=n}var fy=ay;function sy(){this._string=[]}function ly(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function hy(t,n){var e,r,i=4.5;function o(t){return t&&("function"==typeof i&&r.pointRadius(+i.apply(this,arguments)),Wl(t,e(r))),r.result()}return o.area=function(t){return Wl(t,e(Sp)),Sp.result()},o.measure=function(t){return Wl(t,e(fy)),fy.result()},o.bounds=function(t){return Wl(t,e(Np)),Np.result()},o.centroid=function(t){return Wl(t,e(Kp)),Kp.result()},o.projection=function(n){return arguments.length?(e=null==n?(t=null,yp):(t=n).stream,o):t},o.context=function(t){return arguments.length?(r=null==t?(n=null,new sy):new Jp(n=t),"function"!=typeof i&&r.pointRadius(i),o):n},o.pointRadius=function(t){return arguments.length?(i="function"==typeof t?t:(r.pointRadius(+t),+t),o):i},o.projection(t).context(n)}function dy(t){return{stream:py(t)}}function py(t){return function(n){var e=new yy;for(var r in t)e[r]=t[r];return e.stream=n,e}}function yy(){}function vy(t,n,e){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),Wl(e,t.stream(Np)),n(Np.result()),null!=r&&t.clipExtent(r),t}function gy(t,n,e){return vy(t,(function(e){var r=n[1][0]-n[0][0],i=n[1][1]-n[0][1],o=Math.min(r/(e[1][0]-e[0][0]),i/(e[1][1]-e[0][1])),a=+n[0][0]+(r-o*(e[1][0]+e[0][0]))/2,u=+n[0][1]+(i-o*(e[1][1]+e[0][1]))/2;t.scale(150*o).translate([a,u])}),e)}function my(t,n,e){return gy(t,[[0,0],n],e)}function by(t,n,e){return vy(t,(function(e){var r=+n,i=r/(e[1][0]-e[0][0]),o=(r-i*(e[1][0]+e[0][0]))/2,a=-i*e[0][1];t.scale(150*i).translate([o,a])}),e)}function xy(t,n,e){return vy(t,(function(e){var r=+n,i=r/(e[1][1]-e[0][1]),o=-i*e[0][0],a=(r-i*(e[1][1]+e[0][1]))/2;t.scale(150*i).translate([o,a])}),e)}sy.prototype={_radius:4.5,_circle:ly(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,n){switch(this._point){case 0:this._string.push("M",t,",",n),this._point=1;break;case 1:this._string.push("L",t,",",n);break;default:null==this._circle&&(this._circle=ly(this._radius)),this._string.push("M",t,",",n,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}},yy.prototype={constructor:yy,point:function(t,n){this.stream.point(t,n)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var _y=Cl(30*Ml);function wy(t,n){return+n?function(t,n){function e(r,i,o,a,u,c,f,s,l,h,d,p,y,v){var g=f-r,m=s-i,b=g*g+m*m;if(b>4*n&&y--){var x=a+h,_=u+d,w=c+p,S=zl(x*x+_*_+w*w),A=Ul(w/=S),M=kl(kl(w)-1)<ml||kl(o-l)<ml?(o+l)/2:El(_,x),k=t(M,A),T=k[0],E=k[1],C=T-r,O=E-i,P=m*C-g*O;(P*P/b>n||kl((g*C+m*O)/b-.5)>.3||a*h+u*d+c*p<_y)&&(e(r,i,o,a,u,c,T,E,M,x/=S,_/=S,w,y,v),v.point(T,E),e(T,E,M,x,_,w,f,s,l,h,d,p,y,v))}}return function(n){var r,i,o,a,u,c,f,s,l,h,d,p,y={point:v,lineStart:g,lineEnd:b,polygonStart:function(){n.polygonStart(),y.lineStart=x},polygonEnd:function(){n.polygonEnd(),y.lineStart=g}};function v(e,r){e=t(e,r),n.point(e[0],e[1])}function g(){s=NaN,y.point=m,n.lineStart()}function m(r,i){var o=xh([r,i]),a=t(r,i);e(s,l,f,h,d,p,s=a[0],l=a[1],f=r,h=o[0],d=o[1],p=o[2],16,n),n.point(s,l)}function b(){y.point=v,n.lineEnd()}function x(){g(),y.point=_,y.lineEnd=w}function _(t,n){m(r=t,n),i=s,o=l,a=h,u=d,c=p,y.point=m}function w(){e(s,l,f,h,d,p,i,o,r,a,u,c,16,n),y.lineEnd=b,b()}return y}}(t,n):function(t){return py({point:function(n,e){n=t(n,e),this.stream.point(n[0],n[1])}})}(t)}var Sy=py({point:function(t,n){this.stream.point(t*Ml,n*Ml)}});function Ay(t,n,e,r,i,o){if(!o)return function(t,n,e,r,i){function o(o,a){return[n+t*(o*=r),e-t*(a*=i)]}return o.invert=function(o,a){return[(o-n)/t*r,(e-a)/t*i]},o}(t,n,e,r,i);var a=Cl(o),u=Dl(o),c=a*t,f=u*t,s=a/t,l=u/t,h=(u*e-a*n)/t,d=(u*n+a*e)/t;function p(t,o){return[c*(t*=r)-f*(o*=i)+n,e-f*t-c*o]}return p.invert=function(t,n){return[r*(s*t-l*n+h),i*(d-l*t-s*n)]},p}function My(t){return ky((function(){return t}))()}function ky(t){var n,e,r,i,o,a,u,c,f,s,l=150,h=480,d=250,p=0,y=0,v=0,g=0,m=0,b=0,x=1,_=1,w=null,S=Id,A=null,M=yp,k=.5;function T(t){return c(t[0]*Ml,t[1]*Ml)}function E(t){return(t=c.invert(t[0],t[1]))&&[t[0]*Al,t[1]*Al]}function C(){var t=Ay(l,0,0,x,_,b).apply(null,n(p,y)),r=Ay(l,h-t[0],d-t[1],x,_,b);return e=yd(v,g,m),u=dd(n,r),c=dd(e,u),a=wy(u,k),O()}function O(){return f=s=null,T}return T.stream=function(t){return f&&s===t?f:f=Sy(function(t){return py({point:function(n,e){var r=t(n,e);return this.stream.point(r[0],r[1])}})}(e)(S(a(M(s=t)))))},T.preclip=function(t){return arguments.length?(S=t,w=void 0,O()):S},T.postclip=function(t){return arguments.length?(M=t,A=r=i=o=null,O()):M},T.clipAngle=function(t){return arguments.length?(S=+t?Rd(w=t*Ml):(w=null,Id),O()):w*Al},T.clipExtent=function(t){return arguments.length?(M=null==t?(A=r=i=o=null,yp):Fd(A=+t[0][0],r=+t[0][1],i=+t[1][0],o=+t[1][1]),O()):null==A?null:[[A,r],[i,o]]},T.scale=function(t){return arguments.length?(l=+t,C()):l},T.translate=function(t){return arguments.length?(h=+t[0],d=+t[1],C()):[h,d]},T.center=function(t){return arguments.length?(p=t[0]%360*Ml,y=t[1]%360*Ml,C()):[p*Al,y*Al]},T.rotate=function(t){return arguments.length?(v=t[0]%360*Ml,g=t[1]%360*Ml,m=t.length>2?t[2]%360*Ml:0,C()):[v*Al,g*Al,m*Al]},T.angle=function(t){return arguments.length?(b=t%360*Ml,C()):b*Al},T.reflectX=function(t){return arguments.length?(x=t?-1:1,C()):x<0},T.reflectY=function(t){return arguments.length?(_=t?-1:1,C()):_<0},T.precision=function(t){return arguments.length?(a=wy(u,k=t*t),O()):zl(k)},T.fitExtent=function(t,n){return gy(T,t,n)},T.fitSize=function(t,n){return my(T,t,n)},T.fitWidth=function(t,n){return by(T,t,n)},T.fitHeight=function(t,n){return xy(T,t,n)},function(){return n=t.apply(this,arguments),T.invert=n.invert&&E,C()}}function Ty(t){var n=0,e=xl/3,r=ky(t),i=r(n,e);return i.parallels=function(t){return arguments.length?r(n=t[0]*Ml,e=t[1]*Ml):[n*Al,e*Al]},i}function Ey(t,n){var e=Dl(t),r=(e+Dl(n))/2;if(kl(r)<ml)return function(t){var n=Cl(t);function e(t,e){return[t*n,Dl(e)/n]}return e.invert=function(t,e){return[t/n,Ul(e*n)]},e}(t);var i=1+e*(2*r-e),o=zl(i)/r;function a(t,n){var e=zl(i-2*r*Dl(n))/r;return[e*Dl(t*=r),o-e*Cl(t)]}return a.invert=function(t,n){var e=o-n,a=El(t,kl(e))*jl(e);return e*r<0&&(a-=xl*jl(t)*jl(e)),[a/r,Ul((i-(t*t+e*e)*r*r)/(2*r))]},a}function Cy(){return Ty(Ey).scale(155.424).center([0,33.6442])}function Oy(){return Cy().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Py(){var t,n,e,r,i,o,a=Oy(),u=Cy().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c=Cy().rotate([157,0]).center([-3,19.9]).parallels([8,18]),f={point:function(t,n){o=[t,n]}};function s(t){var n=t[0],a=t[1];return o=null,e.point(n,a),o||(r.point(n,a),o)||(i.point(n,a),o)}function l(){return t=n=null,s}return s.invert=function(t){var n=a.scale(),e=a.translate(),r=(t[0]-e[0])/n,i=(t[1]-e[1])/n;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?u:i>=.166&&i<.234&&r>=-.214&&r<-.115?c:a).invert(t)},s.stream=function(e){return t&&n===e?t:(r=[a.stream(n=e),u.stream(e),c.stream(e)],i=r.length,t={point:function(t,n){for(var e=-1;++e<i;)r[e].point(t,n)},sphere:function(){for(var t=-1;++t<i;)r[t].sphere()},lineStart:function(){for(var t=-1;++t<i;)r[t].lineStart()},lineEnd:function(){for(var t=-1;++t<i;)r[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<i;)r[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<i;)r[t].polygonEnd()}});var r,i},s.precision=function(t){return arguments.length?(a.precision(t),u.precision(t),c.precision(t),l()):a.precision()},s.scale=function(t){return arguments.length?(a.scale(t),u.scale(.35*t),c.scale(t),s.translate(a.translate())):a.scale()},s.translate=function(t){if(!arguments.length)return a.translate();var n=a.scale(),o=+t[0],s=+t[1];return e=a.translate(t).clipExtent([[o-.455*n,s-.238*n],[o+.455*n,s+.238*n]]).stream(f),r=u.translate([o-.307*n,s+.201*n]).clipExtent([[o-.425*n+ml,s+.12*n+ml],[o-.214*n-ml,s+.234*n-ml]]).stream(f),i=c.translate([o-.205*n,s+.212*n]).clipExtent([[o-.214*n+ml,s+.166*n+ml],[o-.115*n-ml,s+.234*n-ml]]).stream(f),l()},s.fitExtent=function(t,n){return gy(s,t,n)},s.fitSize=function(t,n){return my(s,t,n)},s.fitWidth=function(t,n){return by(s,t,n)},s.fitHeight=function(t,n){return xy(s,t,n)},s.scale(1070)}function Ny(t){return function(n,e){var r=Cl(n),i=Cl(e),o=t(r*i);return o===1/0?[2,0]:[o*i*Dl(n),o*Dl(e)]}}function Iy(t){return function(n,e){var r=zl(n*n+e*e),i=t(r),o=Dl(i),a=Cl(i);return[El(n*o,r*a),Ul(r&&e*o/r)]}}var Ry=Ny((function(t){return zl(2/(1+t))}));function Dy(){return My(Ry).scale(124.75).clipAngle(179.999)}Ry.invert=Iy((function(t){return 2*Ul(t/2)}));var jy=Ny((function(t){return(t=Ll(t))&&t/Dl(t)}));function zy(){return My(jy).scale(79.4188).clipAngle(179.999)}function Vy(t,n){return[t,Il(Vl((_l+n)/2))]}function Ly(){return Uy(Vy).scale(961/Sl)}function Uy(t){var n,e,r,i=My(t),o=i.center,a=i.scale,u=i.translate,c=i.clipExtent,f=null;function s(){var o=xl*a(),u=i(bd(i.rotate()).invert([0,0]));return c(null==f?[[u[0]-o,u[1]-o],[u[0]+o,u[1]+o]]:t===Vy?[[Math.max(u[0]-o,f),n],[Math.min(u[0]+o,e),r]]:[[f,Math.max(u[1]-o,n)],[e,Math.min(u[1]+o,r)]])}return i.scale=function(t){return arguments.length?(a(t),s()):a()},i.translate=function(t){return arguments.length?(u(t),s()):u()},i.center=function(t){return arguments.length?(o(t),s()):o()},i.clipExtent=function(t){return arguments.length?(null==t?f=n=e=r=null:(f=+t[0][0],n=+t[0][1],e=+t[1][0],r=+t[1][1]),s()):null==f?null:[[f,n],[e,r]]},s()}function Fy(t){return Vl((_l+t)/2)}function By(t,n){var e=Cl(t),r=t===n?Dl(t):Il(e/Cl(n))/Il(Fy(n)/Fy(t)),i=e*Rl(Fy(t),r)/r;if(!r)return Vy;function o(t,n){i>0?n<-_l+ml&&(n=-_l+ml):n>_l-ml&&(n=_l-ml);var e=i/Rl(Fy(n),r);return[e*Dl(r*t),i-e*Cl(r*t)]}return o.invert=function(t,n){var e=i-n,o=jl(r)*zl(t*t+e*e),a=El(t,kl(e))*jl(e);return e*r<0&&(a-=xl*jl(t)*jl(e)),[a/r,2*Tl(Rl(i/o,1/r))-_l]},o}function Hy(){return Ty(By).scale(109.5).parallels([30,30])}function qy(t,n){return[t,n]}function Yy(){return My(qy).scale(152.63)}function Xy(t,n){var e=Cl(t),r=t===n?Dl(t):(e-Cl(n))/(n-t),i=e/r+t;if(kl(r)<ml)return qy;function o(t,n){var e=i-n,o=r*t;return[e*Dl(o),i-e*Cl(o)]}return o.invert=function(t,n){var e=i-n,o=El(t,kl(e))*jl(e);return e*r<0&&(o-=xl*jl(t)*jl(e)),[o/r,i-jl(r)*zl(t*t+e*e)]},o}function $y(){return Ty(Xy).scale(131.154).center([0,13.9389])}jy.invert=Iy((function(t){return t})),Vy.invert=function(t,n){return[t,2*Tl(Pl(n))-_l]},qy.invert=qy;var Wy=1.340264,Gy=-.081106,Qy=893e-6,Zy=.003796,Ky=zl(3)/2;function Jy(t,n){var e=Ul(Ky*Dl(n)),r=e*e,i=r*r*r;return[t*Cl(e)/(Ky*(Wy+3*Gy*r+i*(7*Qy+9*Zy*r))),e*(Wy+Gy*r+i*(Qy+Zy*r))]}function tv(){return My(Jy).scale(177.158)}function nv(t,n){var e=Cl(n),r=Cl(t)*e;return[e*Dl(t)/r,Dl(n)/r]}function ev(){return My(nv).scale(144.049).clipAngle(60)}function rv(){var t,n,e,r,i,o,a,u=1,c=0,f=0,s=1,l=1,h=0,d=null,p=1,y=1,v=py({point:function(t,n){var e=b([t,n]);this.stream.point(e[0],e[1])}}),g=yp;function m(){return p=u*s,y=u*l,o=a=null,b}function b(e){var r=e[0]*p,i=e[1]*y;if(h){var o=i*t-r*n;r=r*t+i*n,i=o}return[r+c,i+f]}return b.invert=function(e){var r=e[0]-c,i=e[1]-f;if(h){var o=i*t+r*n;r=r*t-i*n,i=o}return[r/p,i/y]},b.stream=function(t){return o&&a===t?o:o=v(g(a=t))},b.postclip=function(t){return arguments.length?(g=t,d=e=r=i=null,m()):g},b.clipExtent=function(t){return arguments.length?(g=null==t?(d=e=r=i=null,yp):Fd(d=+t[0][0],e=+t[0][1],r=+t[1][0],i=+t[1][1]),m()):null==d?null:[[d,e],[r,i]]},b.scale=function(t){return arguments.length?(u=+t,m()):u},b.translate=function(t){return arguments.length?(c=+t[0],f=+t[1],m()):[c,f]},b.angle=function(e){return arguments.length?(n=Dl(h=e%360*Ml),t=Cl(h),m()):h*Al},b.reflectX=function(t){return arguments.length?(s=t?-1:1,m()):s<0},b.reflectY=function(t){return arguments.length?(l=t?-1:1,m()):l<0},b.fitExtent=function(t,n){return gy(b,t,n)},b.fitSize=function(t,n){return my(b,t,n)},b.fitWidth=function(t,n){return by(b,t,n)},b.fitHeight=function(t,n){return xy(b,t,n)},b}function iv(t,n){var e=n*n,r=e*e;return[t*(.8707-.131979*e+r*(r*(.003971*e-.001529*r)-.013791)),n*(1.007226+e*(.015085+r*(.028874*e-.044475-.005916*r)))]}function ov(){return My(iv).scale(175.295)}function av(t,n){return[Cl(n)*Dl(t),Dl(n)]}function uv(){return My(av).scale(249.5).clipAngle(90.000001)}function cv(t,n){var e=Cl(n),r=1+Cl(t)*e;return[e*Dl(t)/r,Dl(n)/r]}function fv(){return My(cv).scale(250).clipAngle(142)}function sv(t,n){return[Il(Vl((_l+n)/2)),-t]}function lv(){var t=Uy(sv),n=t.center,e=t.rotate;return t.center=function(t){return arguments.length?n([-t[1],t[0]]):[(t=n())[1],-t[0]]},t.rotate=function(t){return arguments.length?e([t[0],t[1],t.length>2?t[2]+90:90]):[(t=e())[0],t[1],t[2]-90]},e([0,0,90]).scale(159.155)}function hv(t,n){return t.parent===n.parent?1:2}function dv(t,n){return t+n.x}function pv(t,n){return Math.max(t,n.y)}function yv(){var t=hv,n=1,e=1,r=!1;function i(i){var o,a=0;i.eachAfter((function(n){var e=n.children;e?(n.x=function(t){return t.reduce(dv,0)/t.length}(e),n.y=function(t){return 1+t.reduce(pv,0)}(e)):(n.x=o?a+=t(n,o):0,n.y=0,o=n)}));var u=function(t){for(var n;n=t.children;)t=n[0];return t}(i),c=function(t){for(var n;n=t.children;)t=n[n.length-1];return t}(i),f=u.x-t(u,c)/2,s=c.x+t(c,u)/2;return i.eachAfter(r?function(t){t.x=(t.x-i.x)*n,t.y=(i.y-t.y)*e}:function(t){t.x=(t.x-f)/(s-f)*n,t.y=(1-(i.y?t.y/i.y:1))*e})}return i.separation=function(n){return arguments.length?(t=n,i):t},i.size=function(t){return arguments.length?(r=!1,n=+t[0],e=+t[1],i):r?null:[n,e]},i.nodeSize=function(t){return arguments.length?(r=!0,n=+t[0],e=+t[1],i):r?[n,e]:null},i}function vv(t){var n=0,e=t.children,r=e&&e.length;if(r)for(;--r>=0;)n+=e[r].value;else n=1;t.value=n}function gv(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return mv(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return mv(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function mv(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function bv(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return xv(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return xv(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function xv(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}Jy.invert=function(t,n){for(var e,r=n,i=r*r,o=i*i*i,a=0;a<12&&(o=(i=(r-=e=(r*(Wy+Gy*i+o*(Qy+Zy*i))-n)/(Wy+3*Gy*i+o*(7*Qy+9*Zy*i)))*r)*i*i,!(kl(e)<bl));++a);return[Ky*t*(Wy+3*Gy*i+o*(7*Qy+9*Zy*i))/Cl(r),Ul(Dl(r)/Ky)]},nv.invert=Iy(Tl),iv.invert=function(t,n){var e,r=n,i=25;do{var o=r*r,a=o*o;r-=e=(r*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))-n)/(1.007226+o*(.045255+a*(.259866*o-.311325-.005916*11*a)))}while(kl(e)>ml&&--i>0);return[t/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]},av.invert=Iy(Ul),cv.invert=Iy((function(t){return 2*Tl(t)})),sv.invert=function(t,n){return[-n,2*Tl(Pl(t))-_l]};var _v=u().mark(wv);function wv(){var t,n,e,r,i,o;return u().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e=[t=this];case 1:n=e.reverse(),e=[];case 2:if(!(t=n.pop())){a.next=8;break}return a.next=5,t;case 5:if(r=t.children)for(i=0,o=r.length;i<o;++i)e.push(r[i]);a.next=2;break;case 8:if(e.length){a.next=1;break}case 9:case"end":return a.stop()}}),_v,this)}function Sv(t,n){t instanceof Map?(t=[void 0,t],void 0===n&&(n=Mv)):void 0===n&&(n=Av);for(var e,r,i,o,a,u=new Ev(t),c=[u];e=c.pop();)if((i=n(e.data))&&(a=(i=Array.from(i)).length))for(e.children=i,o=a-1;o>=0;--o)c.push(r=i[o]=new Ev(i[o])),r.parent=e,r.depth=e.depth+1;return u.eachBefore(Tv)}function Av(t){return t.children}function Mv(t){return Array.isArray(t)?t[1]:null}function kv(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function Tv(t){var n=0;do{t.height=n}while((t=t.parent)&&t.height<++n)}function Ev(t){this.data=t,this.depth=this.height=0,this.parent=null}function Cv(t){return(Cv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ov(t){for(var n,e,r=0,i=(t=function(t){for(var n,e,r=t.length;r;)e=Math.random()*r--|0,n=t[r],t[r]=t[e],t[e]=n;return t}(Array.from(t))).length,o=[];r<i;)n=t[r],e&&Iv(e,n)?++r:(e=Dv(o=Pv(o,n)),r=0);return e}function Pv(t,n){var e,r;if(Rv(n,t))return[n];for(e=0;e<t.length;++e)if(Nv(n,t[e])&&Rv(jv(t[e],n),t))return[t[e],n];for(e=0;e<t.length-1;++e)for(r=e+1;r<t.length;++r)if(Nv(jv(t[e],t[r]),n)&&Nv(jv(t[e],n),t[r])&&Nv(jv(t[r],n),t[e])&&Rv(zv(t[e],t[r],n),t))return[t[e],t[r],n];throw new Error}function Nv(t,n){var e=t.r-n.r,r=n.x-t.x,i=n.y-t.y;return e<0||e*e<r*r+i*i}function Iv(t,n){var e=t.r-n.r+1e-9*Math.max(t.r,n.r,1),r=n.x-t.x,i=n.y-t.y;return e>0&&e*e>r*r+i*i}function Rv(t,n){for(var e=0;e<n.length;++e)if(!Iv(t,n[e]))return!1;return!0}function Dv(t){switch(t.length){case 1:return function(t){return{x:t.x,y:t.y,r:t.r}}(t[0]);case 2:return jv(t[0],t[1]);case 3:return zv(t[0],t[1],t[2])}}function jv(t,n){var e=t.x,r=t.y,i=t.r,o=n.x,a=n.y,u=n.r,c=o-e,f=a-r,s=u-i,l=Math.sqrt(c*c+f*f);return{x:(e+o+c/l*s)/2,y:(r+a+f/l*s)/2,r:(l+i+u)/2}}function zv(t,n,e){var r=t.x,i=t.y,o=t.r,a=n.x,u=n.y,c=n.r,f=e.x,s=e.y,l=e.r,h=r-a,d=r-f,p=i-u,y=i-s,v=c-o,g=l-o,m=r*r+i*i-o*o,b=m-a*a-u*u+c*c,x=m-f*f-s*s+l*l,_=d*p-h*y,w=(p*x-y*b)/(2*_)-r,S=(y*v-p*g)/_,A=(d*b-h*x)/(2*_)-i,M=(h*g-d*v)/_,k=S*S+M*M-1,T=2*(o+w*S+A*M),E=w*w+A*A-o*o,C=-(k?(T+Math.sqrt(T*T-4*k*E))/(2*k):E/T);return{x:r+w+S*C,y:i+A+M*C,r:C}}function Vv(t,n,e){var r,i,o,a,u=t.x-n.x,c=t.y-n.y,f=u*u+c*c;f?(i=n.r+e.r,i*=i,a=t.r+e.r,i>(a*=a)?(r=(f+a-i)/(2*f),o=Math.sqrt(Math.max(0,a/f-r*r)),e.x=t.x-r*u-o*c,e.y=t.y-r*c+o*u):(r=(f+i-a)/(2*f),o=Math.sqrt(Math.max(0,i/f-r*r)),e.x=n.x+r*u-o*c,e.y=n.y+r*c+o*u)):(e.x=n.x+e.r,e.y=n.y)}function Lv(t,n){var e=t.r+n.r-1e-6,r=n.x-t.x,i=n.y-t.y;return e>0&&e*e>r*r+i*i}function Uv(t){var n=t._,e=t.next._,r=n.r+e.r,i=(n.x*e.r+e.x*n.r)/r,o=(n.y*e.r+e.y*n.r)/r;return i*i+o*o}function Fv(t){this._=t,this.next=null,this.previous=null}function Bv(t){if(!(i=(t=function(t){return"object"===Cv(t)&&"length"in t?t:Array.from(t)}(t)).length))return 0;var n,e,r,i,o,a,u,c,f,s,l;if((n=t[0]).x=0,n.y=0,!(i>1))return n.r;if(e=t[1],n.x=-e.r,e.x=n.r,e.y=0,!(i>2))return n.r+e.r;Vv(e,n,r=t[2]),n=new Fv(n),e=new Fv(e),r=new Fv(r),n.next=r.previous=e,e.next=n.previous=r,r.next=e.previous=n;t:for(u=3;u<i;++u){Vv(n._,e._,r=t[u]),r=new Fv(r),c=e.next,f=n.previous,s=e._.r,l=n._.r;do{if(s<=l){if(Lv(c._,r._)){e=c,n.next=e,e.previous=n,--u;continue t}s+=c._.r,c=c.next}else{if(Lv(f._,r._)){(n=f).next=e,e.previous=n,--u;continue t}l+=f._.r,f=f.previous}}while(c!==f.next);for(r.previous=n,r.next=e,n.next=e.previous=e=r,o=Uv(n);(r=r.next)!==e;)(a=Uv(r))<o&&(n=r,o=a);e=n.next}for(n=[e._],r=e;(r=r.next)!==e;)n.push(r._);for(r=Ov(n),u=0;u<i;++u)(n=t[u]).x-=r.x,n.y-=r.y;return r.r}function Hv(t){return Bv(t),t}function qv(t){return null==t?null:Yv(t)}function Yv(t){if("function"!=typeof t)throw new Error;return t}function Xv(){return 0}function $v(t){return function(){return t}}function Wv(t){return Math.sqrt(t.value)}function Gv(){var t=null,n=1,e=1,r=Xv;function i(i){return i.x=n/2,i.y=e/2,t?i.eachBefore(Qv(t)).eachAfter(Zv(r,.5)).eachBefore(Kv(1)):i.eachBefore(Qv(Wv)).eachAfter(Zv(Xv,1)).eachAfter(Zv(r,i.r/Math.min(n,e))).eachBefore(Kv(Math.min(n,e)/(2*i.r))),i}return i.radius=function(n){return arguments.length?(t=qv(n),i):t},i.size=function(t){return arguments.length?(n=+t[0],e=+t[1],i):[n,e]},i.padding=function(t){return arguments.length?(r="function"==typeof t?t:$v(+t),i):r},i}function Qv(t){return function(n){n.children||(n.r=Math.max(0,+t(n)||0))}}function Zv(t,n){return function(e){if(r=e.children){var r,i,o,a=r.length,u=t(e)*n||0;if(u)for(i=0;i<a;++i)r[i].r+=u;if(o=Bv(r),u)for(i=0;i<a;++i)r[i].r-=u;e.r=o+u}}}function Kv(t){return function(n){var e=n.parent;n.r*=t,e&&(n.x=e.x+t*n.x,n.y=e.y+t*n.y)}}function Jv(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function tg(t,n,e,r,i){for(var o,a=t.children,u=-1,c=a.length,f=t.value&&(r-n)/t.value;++u<c;)(o=a[u]).y0=e,o.y1=i,o.x0=n,o.x1=n+=o.value*f}function ng(){var t=1,n=1,e=0,r=!1;function i(i){var o=i.height+1;return i.x0=i.y0=e,i.x1=t,i.y1=n/o,i.eachBefore(function(t,n){return function(r){r.children&&tg(r,r.x0,t*(r.depth+1)/n,r.x1,t*(r.depth+2)/n);var i=r.x0,o=r.y0,a=r.x1-e,u=r.y1-e;a<i&&(i=a=(i+a)/2),u<o&&(o=u=(o+u)/2),r.x0=i,r.y0=o,r.x1=a,r.y1=u}}(n,o)),r&&i.eachBefore(Jv),i}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(e){return arguments.length?(t=+e[0],n=+e[1],i):[t,n]},i.padding=function(t){return arguments.length?(e=+t,i):e},i}Ev.prototype=Sv.prototype=function(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}({constructor:Ev,count:function(){return this.eachAfter(vv)},each:function(t,n){var e,r=-1,i=gv(this);try{for(i.s();!(e=i.n()).done;){var o=e.value;t.call(n,o,++r,this)}}catch(t){i.e(t)}finally{i.f()}return this},eachAfter:function(t,n){for(var e,r,i,o=this,a=[o],u=[],c=-1;o=a.pop();)if(u.push(o),e=o.children)for(r=0,i=e.length;r<i;++r)a.push(e[r]);for(;o=u.pop();)t.call(n,o,++c,this);return this},eachBefore:function(t,n){for(var e,r,i=this,o=[i],a=-1;i=o.pop();)if(t.call(n,i,++a,this),e=i.children)for(r=e.length-1;r>=0;--r)o.push(e[r]);return this},find:function(t,n){var e,r=-1,i=bv(this);try{for(i.s();!(e=i.n()).done;){var o=e.value;if(t.call(n,o,++r,this))return o}}catch(t){i.e(t)}finally{i.f()}},sum:function(t){return this.eachAfter((function(n){for(var e=+t(n.data)||0,r=n.children,i=r&&r.length;--i>=0;)e+=r[i].value;n.value=e}))},sort:function(t){return this.eachBefore((function(n){n.children&&n.children.sort(t)}))},path:function(t){for(var n=this,e=function(t,n){if(t===n)return t;var e=t.ancestors(),r=n.ancestors(),i=null;t=e.pop(),n=r.pop();for(;t===n;)i=t,t=e.pop(),n=r.pop();return i}(n,t),r=[n];n!==e;)n=n.parent,r.push(n);for(var i=r.length;t!==e;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,n=[t];t=t.parent;)n.push(t);return n},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore((function(n){n.children||t.push(n)})),t},links:function(){var t=this,n=[];return t.each((function(e){e!==t&&n.push({source:e.parent,target:e})})),n},copy:function(){return Sv(this).eachBefore(kv)}},Symbol.iterator,wv);var eg={depth:-1},rg={};function ig(t){return t.id}function og(t){return t.parentId}function ag(){var t=ig,n=og;function e(e){var r,i,o,a,u,c,f,s=Array.from(e),l=s.length,h=new Map;for(i=0;i<l;++i)r=s[i],u=s[i]=new Ev(r),null!=(c=t(r,i,e))&&(c+="")&&(f=u.id=c,h.set(f,h.has(f)?rg:u)),null!=(c=n(r,i,e))&&(c+="")&&(u.parent=c);for(i=0;i<l;++i)if(c=(u=s[i]).parent){if(!(a=h.get(c)))throw new Error("missing: "+c);if(a===rg)throw new Error("ambiguous: "+c);a.children?a.children.push(u):a.children=[u],u.parent=a}else{if(o)throw new Error("multiple roots");o=u}if(!o)throw new Error("no root");if(o.parent=eg,o.eachBefore((function(t){t.depth=t.parent.depth+1,--l})).eachBefore(Tv),o.parent=null,l>0)throw new Error("cycle");return o}return e.id=function(n){return arguments.length?(t=Yv(n),e):t},e.parentId=function(t){return arguments.length?(n=Yv(t),e):n},e}function ug(t,n){return t.parent===n.parent?1:2}function cg(t){var n=t.children;return n?n[0]:t.t}function fg(t){var n=t.children;return n?n[n.length-1]:t.t}function sg(t,n,e){var r=e/(n.i-t.i);n.c-=r,n.s+=e,t.c+=r,n.z+=e,n.m+=e}function lg(t,n,e){return t.a.parent===n.parent?t.a:e}function hg(t,n){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=n}function dg(){var t=ug,n=1,e=1,r=null;function i(i){var c=function(t){for(var n,e,r,i,o,a=new hg(t,0),u=[a];n=u.pop();)if(r=n._.children)for(n.children=new Array(o=r.length),i=o-1;i>=0;--i)u.push(e=n.children[i]=new hg(r[i],i)),e.parent=n;return(a.parent=new hg(null,0)).children=[a],a}(i);if(c.eachAfter(o),c.parent.m=-c.z,c.eachBefore(a),r)i.eachBefore(u);else{var f=i,s=i,l=i;i.eachBefore((function(t){t.x<f.x&&(f=t),t.x>s.x&&(s=t),t.depth>l.depth&&(l=t)}));var h=f===s?1:t(f,s)/2,d=h-f.x,p=n/(s.x+h+d),y=e/(l.depth||1);i.eachBefore((function(t){t.x=(t.x+d)*p,t.y=t.depth*y}))}return i}function o(n){var e=n.children,r=n.parent.children,i=n.i?r[n.i-1]:null;if(e){!function(t){for(var n,e=0,r=0,i=t.children,o=i.length;--o>=0;)(n=i[o]).z+=e,n.m+=e,e+=n.s+(r+=n.c)}(n);var o=(e[0].z+e[e.length-1].z)/2;i?(n.z=i.z+t(n._,i._),n.m=n.z-o):n.z=o}else i&&(n.z=i.z+t(n._,i._));n.parent.A=function(n,e,r){if(e){for(var i,o=n,a=n,u=e,c=o.parent.children[0],f=o.m,s=a.m,l=u.m,h=c.m;u=fg(u),o=cg(o),u&&o;)c=cg(c),(a=fg(a)).a=n,(i=u.z+l-o.z-f+t(u._,o._))>0&&(sg(lg(u,n,r),n,i),f+=i,s+=i),l+=u.m,f+=o.m,h+=c.m,s+=a.m;u&&!fg(a)&&(a.t=u,a.m+=l-s),o&&!cg(c)&&(c.t=o,c.m+=f-h,r=n)}return r}(n,i,n.parent.A||r[0])}function a(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function u(t){t.x*=n,t.y=t.depth*e}return i.separation=function(n){return arguments.length?(t=n,i):t},i.size=function(t){return arguments.length?(r=!1,n=+t[0],e=+t[1],i):r?null:[n,e]},i.nodeSize=function(t){return arguments.length?(r=!0,n=+t[0],e=+t[1],i):r?[n,e]:null},i}function pg(t,n,e,r,i){for(var o,a=t.children,u=-1,c=a.length,f=t.value&&(i-e)/t.value;++u<c;)(o=a[u]).x0=n,o.x1=r,o.y0=e,o.y1=e+=o.value*f}hg.prototype=Object.create(Ev.prototype);var yg=(1+Math.sqrt(5))/2;function vg(t,n,e,r,i,o){for(var a,u,c,f,s,l,h,d,p,y,v,g=[],m=n.children,b=0,x=0,_=m.length,w=n.value;b<_;){c=i-e,f=o-r;do{s=m[x++].value}while(!s&&x<_);for(l=h=s,v=s*s*(y=Math.max(f/c,c/f)/(w*t)),p=Math.max(h/v,v/l);x<_;++x){if(s+=u=m[x].value,u<l&&(l=u),u>h&&(h=u),v=s*s*y,(d=Math.max(h/v,v/l))>p){s-=u;break}p=d}g.push(a={value:s,dice:c<f,children:m.slice(b,x)}),a.dice?tg(a,e,r,i,w?r+=f*s/w:o):pg(a,e,r,w?e+=c*s/w:i,o),w-=s,b=x}return g}var gg=function t(n){function e(t,e,r,i,o){vg(n,t,e,r,i,o)}return e.ratio=function(n){return t((n=+n)>1?n:1)},e}(yg);function mg(){var t=gg,n=!1,e=1,r=1,i=[0],o=Xv,a=Xv,u=Xv,c=Xv,f=Xv;function s(t){return t.x0=t.y0=0,t.x1=e,t.y1=r,t.eachBefore(l),i=[0],n&&t.eachBefore(Jv),t}function l(n){var e=i[n.depth],r=n.x0+e,s=n.y0+e,l=n.x1-e,h=n.y1-e;l<r&&(r=l=(r+l)/2),h<s&&(s=h=(s+h)/2),n.x0=r,n.y0=s,n.x1=l,n.y1=h,n.children&&(e=i[n.depth+1]=o(n)/2,r+=f(n)-e,s+=a(n)-e,(l-=u(n)-e)<r&&(r=l=(r+l)/2),(h-=c(n)-e)<s&&(s=h=(s+h)/2),t(n,r,s,l,h))}return s.round=function(t){return arguments.length?(n=!!t,s):n},s.size=function(t){return arguments.length?(e=+t[0],r=+t[1],s):[e,r]},s.tile=function(n){return arguments.length?(t=Yv(n),s):t},s.padding=function(t){return arguments.length?s.paddingInner(t).paddingOuter(t):s.paddingInner()},s.paddingInner=function(t){return arguments.length?(o="function"==typeof t?t:$v(+t),s):o},s.paddingOuter=function(t){return arguments.length?s.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):s.paddingTop()},s.paddingTop=function(t){return arguments.length?(a="function"==typeof t?t:$v(+t),s):a},s.paddingRight=function(t){return arguments.length?(u="function"==typeof t?t:$v(+t),s):u},s.paddingBottom=function(t){return arguments.length?(c="function"==typeof t?t:$v(+t),s):c},s.paddingLeft=function(t){return arguments.length?(f="function"==typeof t?t:$v(+t),s):f},s}function bg(t,n,e,r,i){var o,a,u=t.children,c=u.length,f=new Array(c+1);for(f[0]=a=o=0;o<c;++o)f[o+1]=a+=u[o].value;!function t(n,e,r,i,o,a,c){if(n>=e-1){var s=u[n];return s.x0=i,s.y0=o,s.x1=a,void(s.y1=c)}var l=f[n],h=r/2+l,d=n+1,p=e-1;for(;d<p;){var y=d+p>>>1;f[y]<h?d=y+1:p=y}h-f[d-1]<f[d]-h&&n+1<d&&--d;var v=f[d]-l,g=r-v;if(a-i>c-o){var m=r?(i*g+a*v)/r:a;t(n,d,v,i,o,m,c),t(d,e,g,m,o,a,c)}else{var b=r?(o*g+c*v)/r:c;t(n,d,v,i,o,a,b),t(d,e,g,i,b,a,c)}}(0,c,t.value,n,e,r,i)}function xg(t,n,e,r,i){(1&t.depth?pg:tg)(t,n,e,r,i)}var _g=function t(n){function e(t,e,r,i,o){if((a=t._squarify)&&a.ratio===n)for(var a,u,c,f,s,l=-1,h=a.length,d=t.value;++l<h;){for(c=(u=a[l]).children,f=u.value=0,s=c.length;f<s;++f)u.value+=c[f].value;u.dice?tg(u,e,r,i,d?r+=(o-r)*u.value/d:o):pg(u,e,r,d?e+=(i-e)*u.value/d:i,o),d-=u.value}else t._squarify=a=vg(n,t,e,r,i,o),a.ratio=n}return e.ratio=function(n){return t((n=+n)>1?n:1)},e}(yg);function wg(t){var n=t.length;return function(e){return t[Math.max(0,Math.min(n-1,Math.floor(e*n)))]}}function Sg(t,n){var e=xi(+t,+n);return function(t){var n=e(t);return n-360*Math.floor(n/360)}}function Ag(t,n){return t=+t,n=+n,function(e){return Math.round(t*(1-e)+n*e)}}function Mg(t){return((t=Math.exp(t))+1/t)/2}var kg=function t(n,e,r){function i(t,i){var o,a,u=t[0],c=t[1],f=t[2],s=i[0],l=i[1],h=i[2],d=s-u,p=l-c,y=d*d+p*p;if(y<1e-12)a=Math.log(h/f)/n,o=function(t){return[u+t*d,c+t*p,f*Math.exp(n*t*a)]};else{var v=Math.sqrt(y),g=(h*h-f*f+r*y)/(2*f*e*v),m=(h*h-f*f-r*y)/(2*h*e*v),b=Math.log(Math.sqrt(g*g+1)-g),x=Math.log(Math.sqrt(m*m+1)-m);a=(x-b)/n,o=function(t){var r=t*a,i=Mg(b),o=f/(e*v)*(i*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(n*r+b)-function(t){return((t=Math.exp(t))-1/t)/2}(b));return[u+o*d,c+o*p,f*i/Mg(n*r+b)]}}return o.duration=1e3*a*n/Math.SQRT2,o}return i.rho=function(n){var e=Math.max(.001,+n),r=e*e;return t(e,r,r*r)},i}(Math.SQRT2,2,4);function Tg(t){return function(n,e){var r=t((n=hi(n)).h,(e=hi(e)).h),i=wi(n.s,e.s),o=wi(n.l,e.l),a=wi(n.opacity,e.opacity);return function(t){return n.h=r(t),n.s=i(t),n.l=o(t),n.opacity=a(t),n+""}}}var Eg=Tg(xi),Cg=Tg(wi);function Og(t,n){var e=wi((t=Pu(t)).l,(n=Pu(n)).l),r=wi(t.a,n.a),i=wi(t.b,n.b),o=wi(t.opacity,n.opacity);return function(n){return t.l=e(n),t.a=r(n),t.b=i(n),t.opacity=o(n),t+""}}function Pg(t){return function(n,e){var r=t((n=Lu(n)).h,(e=Lu(e)).h),i=wi(n.c,e.c),o=wi(n.l,e.l),a=wi(n.opacity,e.opacity);return function(t){return n.h=r(t),n.c=i(t),n.l=o(t),n.opacity=a(t),n+""}}}var Ng=Pg(xi),Ig=Pg(wi);function Rg(t){return function n(e){function r(n,r){var i=t((n=Zu(n)).h,(r=Zu(r)).h),o=wi(n.s,r.s),a=wi(n.l,r.l),u=wi(n.opacity,r.opacity);return function(t){return n.h=i(t),n.s=o(t),n.l=a(Math.pow(t,e)),n.opacity=u(t),n+""}}return e=+e,r.gamma=n,r}(1)}var Dg=Rg(xi),jg=Rg(wi);function zg(t,n){void 0===n&&(n=t,t=Li);for(var e=0,r=n.length-1,i=n[0],o=new Array(r<0?0:r);e<r;)o[e]=t(i,i=n[++e]);return function(t){var n=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return o[n](t-n)}}function Vg(t,n){for(var e=new Array(n),r=0;r<n;++r)e[r]=t(r/(n-1));return e}function Lg(t){for(var n,e=-1,r=t.length,i=t[r-1],o=0;++e<r;)n=i,i=t[e],o+=n[1]*i[0]-n[0]*i[1];return o/2}function Ug(t){for(var n,e,r=-1,i=t.length,o=0,a=0,u=t[i-1],c=0;++r<i;)n=u,u=t[r],c+=e=n[0]*u[1]-u[0]*n[1],o+=(n[0]+u[0])*e,a+=(n[1]+u[1])*e;return[o/(c*=3),a/c]}function Fg(t,n,e){return(n[0]-t[0])*(e[1]-t[1])-(n[1]-t[1])*(e[0]-t[0])}function Bg(t,n){return t[0]-n[0]||t[1]-n[1]}function Hg(t){var n,e=t.length,r=[0,1],i=2;for(n=2;n<e;++n){for(;i>1&&Fg(t[r[i-2]],t[r[i-1]],t[n])<=0;)--i;r[i++]=n}return r.slice(0,i)}function qg(t){if((e=t.length)<3)return null;var n,e,r=new Array(e),i=new Array(e);for(n=0;n<e;++n)r[n]=[+t[n][0],+t[n][1],n];for(r.sort(Bg),n=0;n<e;++n)i[n]=[r[n][0],-r[n][1]];var o=Hg(r),a=Hg(i),u=a[0]===o[0],c=a[a.length-1]===o[o.length-1],f=[];for(n=o.length-1;n>=0;--n)f.push(t[r[o[n]][2]]);for(n=+u;n<a.length-c;++n)f.push(t[r[a[n]][2]]);return f}function Yg(t,n){for(var e,r,i=t.length,o=t[i-1],a=n[0],u=n[1],c=o[0],f=o[1],s=!1,l=0;l<i;++l)e=(o=t[l])[0],(r=o[1])>u!=f>u&&a<(c-e)*(u-r)/(f-r)+e&&(s=!s),c=e,f=r;return s}function Xg(t){for(var n,e,r=-1,i=t.length,o=t[i-1],a=o[0],u=o[1],c=0;++r<i;)n=a,e=u,n-=a=(o=t[r])[0],e-=u=o[1],c+=Math.hypot(n,e);return c}var $g=Math.random,Wg=function t(n){function e(t,e){return t=null==t?0:+t,e=null==e?1:+e,1===arguments.length?(e=t,t=0):e-=t,function(){return n()*e+t}}return e.source=t,e}($g),Gg=function t(n){function e(t,e){return arguments.length<2&&(e=t,t=0),t=Math.floor(t),e=Math.floor(e)-t,function(){return Math.floor(n()*e+t)}}return e.source=t,e}($g),Qg=function t(n){function e(t,e){var r,i;return t=null==t?0:+t,e=null==e?1:+e,function(){var o;if(null!=r)o=r,r=null;else do{r=2*n()-1,o=2*n()-1,i=r*r+o*o}while(!i||i>1);return t+e*o*Math.sqrt(-2*Math.log(i)/i)}}return e.source=t,e}($g),Zg=function t(n){var e=Qg.source(n);function r(){var t=e.apply(this,arguments);return function(){return Math.exp(t())}}return r.source=t,r}($g),Kg=function t(n){function e(t){return(t=+t)<=0?function(){return 0}:function(){for(var e=0,r=t;r>1;--r)e+=n();return e+r*n()}}return e.source=t,e}($g),Jg=function t(n){var e=Kg.source(n);function r(t){if(0==(t=+t))return n;var r=e(t);return function(){return r()/t}}return r.source=t,r}($g),tm=function t(n){function e(t){return function(){return-Math.log1p(-n())/t}}return e.source=t,e}($g),nm=function t(n){function e(t){if((t=+t)<0)throw new RangeError("invalid alpha");return t=1/-t,function(){return Math.pow(1-n(),t)}}return e.source=t,e}($g),em=function t(n){function e(t){if((t=+t)<0||t>1)throw new RangeError("invalid p");return function(){return Math.floor(n()+t)}}return e.source=t,e}($g),rm=function t(n){function e(t){if((t=+t)<0||t>1)throw new RangeError("invalid p");return 0===t?function(){return 1/0}:1===t?function(){return 1}:(t=Math.log1p(-t),function(){return 1+Math.floor(Math.log1p(-n())/t)})}return e.source=t,e}($g),im=function t(n){var e=Qg.source(n)();function r(t,r){if((t=+t)<0)throw new RangeError("invalid k");if(0===t)return function(){return 0};if(r=null==r?1:+r,1===t)return function(){return-Math.log1p(-n())*r};var i=(t<1?t+1:t)-1/3,o=1/(3*Math.sqrt(i)),a=t<1?function(){return Math.pow(n(),1/t)}:function(){return 1};return function(){do{do{var t=e(),u=1+o*t}while(u<=0);u*=u*u;var c=1-n()}while(c>=1-.0331*t*t*t*t&&Math.log(c)>=.5*t*t+i*(1-u+Math.log(u)));return i*u*a()*r}}return r.source=t,r}($g),om=function t(n){var e=im.source(n);function r(t,n){var r=e(t),i=e(n);return function(){var t=r();return 0===t?0:t/(t+i())}}return r.source=t,r}($g),am=function t(n){var e=rm.source(n),r=om.source(n);function i(t,n){return t=+t,(n=+n)>=1?function(){return t}:n<=0?function(){return 0}:function(){for(var i=0,o=t,a=n;o*a>16&&o*(1-a)>16;){var u=Math.floor((o+1)*a),c=r(u,o-u+1)();c<=a?(i+=u,o-=u,a=(a-c)/(1-c)):(o=u-1,a/=c)}for(var f=a<.5,s=e(f?a:1-a),l=s(),h=0;l<=o;++h)l+=s();return i+(f?h:o-h)}}return i.source=t,i}($g),um=function t(n){function e(t,e,r){var i;return 0==(t=+t)?i=function(t){return-Math.log(t)}:(t=1/t,i=function(n){return Math.pow(n,t)}),e=null==e?0:+e,r=null==r?1:+r,function(){return e+r*i(-Math.log1p(-n()))}}return e.source=t,e}($g),cm=function t(n){function e(t,e){return t=null==t?0:+t,e=null==e?1:+e,function(){return t+e*Math.tan(Math.PI*n())}}return e.source=t,e}($g),fm=function t(n){function e(t,e){return t=null==t?0:+t,e=null==e?1:+e,function(){var r=n();return t+e*Math.log(r/(1-r))}}return e.source=t,e}($g),sm=function t(n){var e=im.source(n),r=am.source(n);function i(t){return function(){for(var i=0,o=t;o>16;){var a=Math.floor(.875*o),u=e(a)();if(u>o)return i+r(a-1,o/u)();i+=a,o-=u}for(var c=-Math.log1p(-n()),f=0;c<=o;++f)c-=Math.log1p(-n());return i+f}}return i.source=t,i}($g),lm=1664525,hm=1013904223,dm=1/4294967296;function pm(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.random(),n=0|(0<=t&&t<1?t/dm:Math.abs(t));return function(){return dm*((n=lm*n+hm|0)>>>0)}}function ym(t,n){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(n).domain(t)}return this}function vm(t,n){switch(arguments.length){case 0:break;case 1:"function"==typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"==typeof n?this.interpolator(n):this.range(n)}return this}function gm(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return mm(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return mm(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function mm(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var bm=Symbol("implicit");function xm(){var t=new Map,n=[],e=[],r=bm;function i(i){var o=i+"",a=t.get(o);if(!a){if(r!==bm)return r;t.set(o,a=n.push(i))}return e[(a-1)%e.length]}return i.domain=function(e){if(!arguments.length)return n.slice();n=[],t=new Map;var r,o=gm(e);try{for(o.s();!(r=o.n()).done;){var a=r.value,u=a+"";t.has(u)||t.set(u,n.push(a))}}catch(t){o.e(t)}finally{o.f()}return i},i.range=function(t){return arguments.length?(e=Array.from(t),i):e.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return xm(n,e).unknown(r)},ym.apply(i,arguments),i}function _m(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var e=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(e.push(a.value),!n||e.length!==n);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return e}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return wm(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return wm(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wm(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Sm(){var t,n,e=xm().unknown(void 0),r=e.domain,i=e.range,o=0,a=1,u=!1,c=0,f=0,s=.5;function l(){var e=r().length,l=a<o,h=l?a:o,d=l?o:a;t=(d-h)/Math.max(1,e-c+2*f),u&&(t=Math.floor(t)),h+=(d-h-t*(e-c))*s,n=t*(1-c),u&&(h=Math.round(h),n=Math.round(n));var p=Wt(e).map((function(n){return h+t*n}));return i(l?p.reverse():p)}return delete e.unknown,e.domain=function(t){return arguments.length?(r(t),l()):r()},e.range=function(t){var n;return arguments.length?(n=_m(t,2),o=n[0],a=n[1],o=+o,a=+a,l()):[o,a]},e.rangeRound=function(t){var n;return n=_m(t,2),o=n[0],a=n[1],o=+o,a=+a,u=!0,l()},e.bandwidth=function(){return n},e.step=function(){return t},e.round=function(t){return arguments.length?(u=!!t,l()):u},e.padding=function(t){return arguments.length?(c=Math.min(1,f=+t),l()):c},e.paddingInner=function(t){return arguments.length?(c=Math.min(1,t),l()):c},e.paddingOuter=function(t){return arguments.length?(f=+t,l()):f},e.align=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),l()):s},e.copy=function(){return Sm(r(),[o,a]).round(u).paddingInner(c).paddingOuter(f).align(s)},ym.apply(l(),arguments)}function Am(t){var n=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return Am(n())},t}function Mm(){return Am(Sm.apply(null,arguments).paddingInner(1))}function km(t){return+t}var Tm=[0,1];function Em(t){return t}function Cm(t,n){return(n-=t=+t)?function(e){return(e-t)/n}:function(t){return function(){return t}}(isNaN(n)?NaN:.5)}function Om(t,n,e){var r=t[0],i=t[1],o=n[0],a=n[1];return i<r?(r=Cm(i,r),o=e(a,o)):(r=Cm(r,i),o=e(o,a)),function(t){return o(r(t))}}function Pm(t,n,e){var r=Math.min(t.length,n.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++a<r;)i[a]=Cm(t[a],t[a+1]),o[a]=e(n[a],n[a+1]);return function(n){var e=g(t,n,1,r)-1;return o[e](i[e](n))}}function Nm(t,n){return n.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Im(){var t,n,e,r,i,o,a=Tm,u=Tm,c=Li,f=Em;function s(){var t=Math.min(a.length,u.length);return f!==Em&&(f=function(t,n){var e;return t>n&&(e=t,t=n,n=e),function(e){return Math.max(t,Math.min(n,e))}}(a[0],a[t-1])),r=t>2?Pm:Om,i=o=null,l}function l(n){return isNaN(n=+n)?e:(i||(i=r(a.map(t),u,c)))(t(f(n)))}return l.invert=function(e){return f(n((o||(o=r(u,a.map(t),Ni)))(e)))},l.domain=function(t){return arguments.length?(a=Array.from(t,km),s()):a.slice()},l.range=function(t){return arguments.length?(u=Array.from(t),s()):u.slice()},l.rangeRound=function(t){return u=Array.from(t),c=Ag,s()},l.clamp=function(t){return arguments.length?(f=!!t||Em,s()):f!==Em},l.interpolate=function(t){return arguments.length?(c=t,s()):c},l.unknown=function(t){return arguments.length?(e=t,l):e},function(e,r){return t=e,n=r,s()}}function Rm(){return Im()(Em,Em)}function Dm(t,n,e,r){var i,o=st(t,n,e);switch((r=rl(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(t),Math.abs(n));return null!=r.precision||isNaN(i=vl(o,a))||(r.precision=i),sl(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=gl(o,Math.max(Math.abs(t),Math.abs(n))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=yl(o))||(r.precision=i-2*("%"===r.type))}return fl(r)}function jm(t){var n=t.domain;return t.ticks=function(t){var e=n();return ct(e[0],e[e.length-1],null==t?10:t)},t.tickFormat=function(t,e){var r=n();return Dm(r[0],r[r.length-1],null==t?10:t,e)},t.nice=function(e){null==e&&(e=10);var r,i,o=n(),a=0,u=o.length-1,c=o[a],f=o[u],s=10;for(f<c&&(i=c,c=f,f=i,i=a,a=u,u=i);s-- >0;){if((i=ft(c,f,e))===r)return o[a]=c,o[u]=f,n(o);if(i>0)c=Math.floor(c/i)*i,f=Math.ceil(f/i)*i;else{if(!(i<0))break;c=Math.ceil(c*i)/i,f=Math.floor(f*i)/i}r=i}return t},t}function zm(){var t=Rm();return t.copy=function(){return Nm(t,zm())},ym.apply(t,arguments),jm(t)}function Vm(t){var n;function e(t){return isNaN(t=+t)?n:t}return e.invert=e,e.domain=e.range=function(n){return arguments.length?(t=Array.from(n,km),e):t.slice()},e.unknown=function(t){return arguments.length?(n=t,e):n},e.copy=function(){return Vm(t).unknown(n)},t=arguments.length?Array.from(t,km):[0,1],jm(e)}function Lm(t,n){var e,r=0,i=(t=t.slice()).length-1,o=t[r],a=t[i];return a<o&&(e=r,r=i,i=e,e=o,o=a,a=e),t[r]=n.floor(o),t[i]=n.ceil(a),t}function Um(t){return Math.log(t)}function Fm(t){return Math.exp(t)}function Bm(t){return-Math.log(-t)}function Hm(t){return-Math.exp(-t)}function qm(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Ym(t){return function(n){return-t(-n)}}function Xm(t){var n,e,r=t(Um,Fm),i=r.domain,o=10;function a(){return n=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(n){return Math.log(n)/t})}(o),e=function(t){return 10===t?qm:t===Math.E?Math.exp:function(n){return Math.pow(t,n)}}(o),i()[0]<0?(n=Ym(n),e=Ym(e),t(Bm,Hm)):t(Um,Fm),r}return r.base=function(t){return arguments.length?(o=+t,a()):o},r.domain=function(t){return arguments.length?(i(t),a()):i()},r.ticks=function(t){var r,a=i(),u=a[0],c=a[a.length-1];(r=c<u)&&(h=u,u=c,c=h);var f,s,l,h=n(u),d=n(c),p=null==t?10:+t,y=[];if(!(o%1)&&d-h<p){if(h=Math.floor(h),d=Math.ceil(d),u>0){for(;h<=d;++h)for(s=1,f=e(h);s<o;++s)if(!((l=f*s)<u)){if(l>c)break;y.push(l)}}else for(;h<=d;++h)for(s=o-1,f=e(h);s>=1;--s)if(!((l=f*s)<u)){if(l>c)break;y.push(l)}2*y.length<p&&(y=ct(u,c,p))}else y=ct(h,d,Math.min(d-h,p)).map(e);return r?y.reverse():y},r.tickFormat=function(t,i){if(null==i&&(i=10===o?".0e":","),"function"!=typeof i&&(i=fl(i)),t===1/0)return i;null==t&&(t=10);var a=Math.max(1,o*t/r.ticks().length);return function(t){var r=t/e(Math.round(n(t)));return r*o<o-.5&&(r*=o),r<=a?i(t):""}},r.nice=function(){return i(Lm(i(),{floor:function(t){return e(Math.floor(n(t)))},ceil:function(t){return e(Math.ceil(n(t)))}}))},r}function $m(){var t=Xm(Im()).domain([1,10]);return t.copy=function(){return Nm(t,$m()).base(t.base())},ym.apply(t,arguments),t}function Wm(t){return function(n){return Math.sign(n)*Math.log1p(Math.abs(n/t))}}function Gm(t){return function(n){return Math.sign(n)*Math.expm1(Math.abs(n))*t}}function Qm(t){var n=1,e=t(Wm(n),Gm(n));return e.constant=function(e){return arguments.length?t(Wm(n=+e),Gm(n)):n},jm(e)}function Zm(){var t=Qm(Im());return t.copy=function(){return Nm(t,Zm()).constant(t.constant())},ym.apply(t,arguments)}function Km(t){return function(n){return n<0?-Math.pow(-n,t):Math.pow(n,t)}}function Jm(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function tb(t){return t<0?-t*t:t*t}function nb(t){var n=t(Em,Em),e=1;function r(){return 1===e?t(Em,Em):.5===e?t(Jm,tb):t(Km(e),Km(1/e))}return n.exponent=function(t){return arguments.length?(e=+t,r()):e},jm(n)}function eb(){var t=nb(Im());return t.copy=function(){return Nm(t,eb()).exponent(t.exponent())},ym.apply(t,arguments),t}function rb(){return eb.apply(null,arguments).exponent(.5)}function ib(t){return Math.sign(t)*t*t}function ob(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function ab(){var t,n=Rm(),e=[0,1],r=!1;function i(e){var i=ob(n(e));return isNaN(i)?t:r?Math.round(i):i}return i.invert=function(t){return n.invert(ib(t))},i.domain=function(t){return arguments.length?(n.domain(t),i):n.domain()},i.range=function(t){return arguments.length?(n.range((e=Array.from(t,km)).map(ib)),i):e.slice()},i.rangeRound=function(t){return i.range(t).round(!0)},i.round=function(t){return arguments.length?(r=!!t,i):r},i.clamp=function(t){return arguments.length?(n.clamp(t),i):n.clamp()},i.unknown=function(n){return arguments.length?(t=n,i):t},i.copy=function(){return ab(n.domain(),e).round(r).clamp(n.clamp()).unknown(t)},ym.apply(i,arguments),jm(i)}function ub(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return cb(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return cb(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function cb(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function fb(){var t,n=[],e=[],r=[];function o(){var t=0,i=Math.max(1,e.length);for(r=new Array(i-1);++t<i;)r[t-1]=Mt(n,t/i);return a}function a(n){return isNaN(n=+n)?t:e[g(r,n)]}return a.invertExtent=function(t){var i=e.indexOf(t);return i<0?[NaN,NaN]:[i>0?r[i-1]:n[0],i<r.length?r[i]:n[n.length-1]]},a.domain=function(t){if(!arguments.length)return n.slice();n=[];var e,r=ub(t);try{for(r.s();!(e=r.n()).done;){var a=e.value;null==a||isNaN(a=+a)||n.push(a)}}catch(t){r.e(t)}finally{r.f()}return n.sort(i),o()},a.range=function(t){return arguments.length?(e=Array.from(t),o()):e.slice()},a.unknown=function(n){return arguments.length?(t=n,a):t},a.quantiles=function(){return r.slice()},a.copy=function(){return fb().domain(n).range(e).unknown(t)},ym.apply(a,arguments)}function sb(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var e=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(e.push(a.value),!n||e.length!==n);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return e}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return lb(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return lb(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lb(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function hb(){var t,n=0,e=1,r=1,i=[.5],o=[0,1];function a(n){return n<=n?o[g(i,n,0,r)]:t}function u(){var t=-1;for(i=new Array(r);++t<r;)i[t]=((t+1)*e-(t-r)*n)/(r+1);return a}return a.domain=function(t){var r;return arguments.length?(r=sb(t,2),n=r[0],e=r[1],n=+n,e=+e,u()):[n,e]},a.range=function(t){return arguments.length?(r=(o=Array.from(t)).length-1,u()):o.slice()},a.invertExtent=function(t){var a=o.indexOf(t);return a<0?[NaN,NaN]:a<1?[n,i[0]]:a>=r?[i[r-1],e]:[i[a-1],i[a]]},a.unknown=function(n){return arguments.length?(t=n,a):a},a.thresholds=function(){return i.slice()},a.copy=function(){return hb().domain([n,e]).range(o).unknown(t)},ym.apply(jm(a),arguments)}function db(){var t,n=[.5],e=[0,1],r=1;function i(i){return i<=i?e[g(n,i,0,r)]:t}return i.domain=function(t){return arguments.length?(n=Array.from(t),r=Math.min(n.length,e.length-1),i):n.slice()},i.range=function(t){return arguments.length?(e=Array.from(t),r=Math.min(n.length,e.length-1),i):e.slice()},i.invertExtent=function(t){var r=e.indexOf(t);return[n[r-1],n[r]]},i.unknown=function(n){return arguments.length?(t=n,i):t},i.copy=function(){return db().domain(n).range(e).unknown(t)},ym.apply(i,arguments)}var pb=new Date,yb=new Date;function vb(t,n,e,r){function i(n){return t(n=0===arguments.length?new Date:new Date(+n)),n}return i.floor=function(n){return t(n=new Date(+n)),n},i.ceil=function(e){return t(e=new Date(e-1)),n(e,1),t(e),e},i.round=function(t){var n=i(t),e=i.ceil(t);return t-n<e-t?n:e},i.offset=function(t,e){return n(t=new Date(+t),null==e?1:Math.floor(e)),t},i.range=function(e,r,o){var a,u=[];if(e=i.ceil(e),o=null==o?1:Math.floor(o),!(e<r&&o>0))return u;do{u.push(a=new Date(+e)),n(e,o),t(e)}while(a<e&&e<r);return u},i.filter=function(e){return vb((function(n){if(n>=n)for(;t(n),!e(n);)n.setTime(n-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;n(t,-1),!e(t););else for(;--r>=0;)for(;n(t,1),!e(t););}))},e&&(i.count=function(n,r){return pb.setTime(+n),yb.setTime(+r),t(pb),t(yb),Math.floor(e(pb,yb))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(n){return r(n)%t==0}:function(n){return i.count(0,n)%t==0}):i:null}),i}var gb=vb((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n)}),(function(t,n){return n.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));gb.every=function(t){return isFinite(t=Math.floor(t))&&t>0?vb((function(n){n.setFullYear(Math.floor(n.getFullYear()/t)*t),n.setMonth(0,1),n.setHours(0,0,0,0)}),(function(n,e){n.setFullYear(n.getFullYear()+e*t)})):null};var mb=gb,bb=gb.range,xb=vb((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,n){t.setMonth(t.getMonth()+n)}),(function(t,n){return n.getMonth()-t.getMonth()+12*(n.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()})),_b=xb,wb=xb.range,Sb=1e3,Ab=6e4,Mb=36e5,kb=864e5,Tb=6048e5;function Eb(t){return vb((function(n){n.setDate(n.getDate()-(n.getDay()+7-t)%7),n.setHours(0,0,0,0)}),(function(t,n){t.setDate(t.getDate()+7*n)}),(function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Ab)/Tb}))}var Cb=Eb(0),Ob=Eb(1),Pb=Eb(2),Nb=Eb(3),Ib=Eb(4),Rb=Eb(5),Db=Eb(6),jb=Cb.range,zb=Ob.range,Vb=Pb.range,Lb=Nb.range,Ub=Ib.range,Fb=Rb.range,Bb=Db.range,Hb=vb((function(t){return t.setHours(0,0,0,0)}),(function(t,n){return t.setDate(t.getDate()+n)}),(function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Ab)/kb}),(function(t){return t.getDate()-1})),qb=Hb,Yb=Hb.range,Xb=vb((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*Sb-t.getMinutes()*Ab)}),(function(t,n){t.setTime(+t+n*Mb)}),(function(t,n){return(n-t)/Mb}),(function(t){return t.getHours()})),$b=Xb,Wb=Xb.range,Gb=vb((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*Sb)}),(function(t,n){t.setTime(+t+n*Ab)}),(function(t,n){return(n-t)/Ab}),(function(t){return t.getMinutes()})),Qb=Gb,Zb=Gb.range,Kb=vb((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,n){t.setTime(+t+n*Sb)}),(function(t,n){return(n-t)/Sb}),(function(t){return t.getUTCSeconds()})),Jb=Kb,tx=Kb.range,nx=vb((function(){}),(function(t,n){t.setTime(+t+n)}),(function(t,n){return n-t}));nx.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?vb((function(n){n.setTime(Math.floor(n/t)*t)}),(function(n,e){n.setTime(+n+e*t)}),(function(n,e){return(e-n)/t})):nx:null};var ex=nx,rx=nx.range;function ix(t){return vb((function(n){n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-t)%7),n.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCDate(t.getUTCDate()+7*n)}),(function(t,n){return(n-t)/Tb}))}var ox=ix(0),ax=ix(1),ux=ix(2),cx=ix(3),fx=ix(4),sx=ix(5),lx=ix(6),hx=ox.range,dx=ax.range,px=ux.range,yx=cx.range,vx=fx.range,gx=sx.range,mx=lx.range,bx=vb((function(t){t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCDate(t.getUTCDate()+n)}),(function(t,n){return(n-t)/kb}),(function(t){return t.getUTCDate()-1})),xx=bx,_x=bx.range,wx=vb((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n)}),(function(t,n){return n.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));wx.every=function(t){return isFinite(t=Math.floor(t))&&t>0?vb((function(n){n.setUTCFullYear(Math.floor(n.getUTCFullYear()/t)*t),n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)}),(function(n,e){n.setUTCFullYear(n.getUTCFullYear()+e*t)})):null};var Sx=wx,Ax=wx.range;function Mx(t){if(0<=t.y&&t.y<100){var n=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return n.setFullYear(t.y),n}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function kx(t){if(0<=t.y&&t.y<100){var n=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return n.setUTCFullYear(t.y),n}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Tx(t,n,e){return{y:t,m:n,d:e,H:0,M:0,S:0,L:0}}function Ex(t){var n=t.dateTime,e=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,u=t.months,c=t.shortMonths,f=Ux(i),s=Fx(i),l=Ux(o),h=Fx(o),d=Ux(a),p=Fx(a),y=Ux(u),v=Fx(u),g=Ux(c),m=Fx(c),b={a:function(t){return a[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return c[t.getMonth()]},B:function(t){return u[t.getMonth()]},c:null,d:c_,e:c_,f:d_,g:A_,G:k_,H:f_,I:s_,j:l_,L:h_,m:p_,M:y_,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:G_,s:Q_,S:v_,u:g_,U:m_,V:x_,w:__,W:w_,x:null,X:null,y:S_,Y:M_,Z:T_,"%":W_},x={a:function(t){return a[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return c[t.getUTCMonth()]},B:function(t){return u[t.getUTCMonth()]},c:null,d:E_,e:E_,f:I_,g:q_,G:X_,H:C_,I:O_,j:P_,L:N_,m:R_,M:D_,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:G_,s:Q_,S:j_,u:z_,U:V_,V:U_,w:F_,W:B_,x:null,X:null,y:H_,Y:Y_,Z:$_,"%":W_},_={a:function(t,n,e){var r=d.exec(n.slice(e));return r?(t.w=p.get(r[0].toLowerCase()),e+r[0].length):-1},A:function(t,n,e){var r=l.exec(n.slice(e));return r?(t.w=h.get(r[0].toLowerCase()),e+r[0].length):-1},b:function(t,n,e){var r=g.exec(n.slice(e));return r?(t.m=m.get(r[0].toLowerCase()),e+r[0].length):-1},B:function(t,n,e){var r=y.exec(n.slice(e));return r?(t.m=v.get(r[0].toLowerCase()),e+r[0].length):-1},c:function(t,e,r){return A(t,n,e,r)},d:Kx,e:Kx,f:i_,g:Wx,G:$x,H:t_,I:t_,j:Jx,L:r_,m:Zx,M:n_,p:function(t,n,e){var r=f.exec(n.slice(e));return r?(t.p=s.get(r[0].toLowerCase()),e+r[0].length):-1},q:Qx,Q:a_,s:u_,S:e_,u:Hx,U:qx,V:Yx,w:Bx,W:Xx,x:function(t,n,r){return A(t,e,n,r)},X:function(t,n,e){return A(t,r,n,e)},y:Wx,Y:$x,Z:Gx,"%":o_};function w(t,n){return function(e){var r,i,o,a=[],u=-1,c=0,f=t.length;for(e instanceof Date||(e=new Date(+e));++u<f;)37===t.charCodeAt(u)&&(a.push(t.slice(c,u)),null!=(i=Rx[r=t.charAt(++u)])?r=t.charAt(++u):i="e"===r?" ":"0",(o=n[r])&&(r=o(e,i)),a.push(r),c=u+1);return a.push(t.slice(c,u)),a.join("")}}function S(t,n){return function(e){var r,i,o=Tx(1900,void 0,1);if(A(o,t,e+="",0)!=e.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(n&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=kx(Tx(o.y,0,1))).getUTCDay(),r=i>4||0===i?ax.ceil(r):ax(r),r=xx.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=Mx(Tx(o.y,0,1))).getDay(),r=i>4||0===i?Ob.ceil(r):Ob(r),r=qb.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?kx(Tx(o.y,0,1)).getUTCDay():Mx(Tx(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,kx(o)):Mx(o)}}function A(t,n,e,r){for(var i,o,a=0,u=n.length,c=e.length;a<u;){if(r>=c)return-1;if(37===(i=n.charCodeAt(a++))){if(i=n.charAt(a++),!(o=_[i in Rx?n.charAt(a++):i])||(r=o(t,e,r))<0)return-1}else if(i!=e.charCodeAt(r++))return-1}return r}return b.x=w(e,b),b.X=w(r,b),b.c=w(n,b),x.x=w(e,x),x.X=w(r,x),x.c=w(n,x),{format:function(t){var n=w(t+="",b);return n.toString=function(){return t},n},parse:function(t){var n=S(t+="",!1);return n.toString=function(){return t},n},utcFormat:function(t){var n=w(t+="",x);return n.toString=function(){return t},n},utcParse:function(t){var n=S(t+="",!0);return n.toString=function(){return t},n}}}var Cx,Ox,Px,Nx,Ix,Rx={"-":"",_:" ",0:"0"},Dx=/^\s*\d+/,jx=/^%/,zx=/[\\^$*+?|[\]().{}]/g;function Vx(t,n,e){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<e?new Array(e-o+1).join(n)+i:i)}function Lx(t){return t.replace(zx,"\\$&")}function Ux(t){return new RegExp("^(?:"+t.map(Lx).join("|")+")","i")}function Fx(t){return new Map(t.map((function(t,n){return[t.toLowerCase(),n]})))}function Bx(t,n,e){var r=Dx.exec(n.slice(e,e+1));return r?(t.w=+r[0],e+r[0].length):-1}function Hx(t,n,e){var r=Dx.exec(n.slice(e,e+1));return r?(t.u=+r[0],e+r[0].length):-1}function qx(t,n,e){var r=Dx.exec(n.slice(e,e+2));return r?(t.U=+r[0],e+r[0].length):-1}function Yx(t,n,e){var r=Dx.exec(n.slice(e,e+2));return r?(t.V=+r[0],e+r[0].length):-1}function Xx(t,n,e){var r=Dx.exec(n.slice(e,e+2));return r?(t.W=+r[0],e+r[0].length):-1}function $x(t,n,e){var r=Dx.exec(n.slice(e,e+4));return r?(t.y=+r[0],e+r[0].length):-1}function Wx(t,n,e){var r=Dx.exec(n.slice(e,e+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),e+r[0].length):-1}function Gx(t,n,e){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(n.slice(e,e+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),e+r[0].length):-1}function Qx(t,n,e){var r=Dx.exec(n.slice(e,e+1));return r?(t.q=3*r[0]-3,e+r[0].length):-1}function Zx(t,n,e){var r=Dx.exec(n.slice(e,e+2));return r?(t.m=r[0]-1,e+r[0].length):-1}function Kx(t,n,e){var r=Dx.exec(n.slice(e,e+2));return r?(t.d=+r[0],e+r[0].length):-1}function Jx(t,n,e){var r=Dx.exec(n.slice(e,e+3));return r?(t.m=0,t.d=+r[0],e+r[0].length):-1}function t_(t,n,e){var r=Dx.exec(n.slice(e,e+2));return r?(t.H=+r[0],e+r[0].length):-1}function n_(t,n,e){var r=Dx.exec(n.slice(e,e+2));return r?(t.M=+r[0],e+r[0].length):-1}function e_(t,n,e){var r=Dx.exec(n.slice(e,e+2));return r?(t.S=+r[0],e+r[0].length):-1}function r_(t,n,e){var r=Dx.exec(n.slice(e,e+3));return r?(t.L=+r[0],e+r[0].length):-1}function i_(t,n,e){var r=Dx.exec(n.slice(e,e+6));return r?(t.L=Math.floor(r[0]/1e3),e+r[0].length):-1}function o_(t,n,e){var r=jx.exec(n.slice(e,e+1));return r?e+r[0].length:-1}function a_(t,n,e){var r=Dx.exec(n.slice(e));return r?(t.Q=+r[0],e+r[0].length):-1}function u_(t,n,e){var r=Dx.exec(n.slice(e));return r?(t.s=+r[0],e+r[0].length):-1}function c_(t,n){return Vx(t.getDate(),n,2)}function f_(t,n){return Vx(t.getHours(),n,2)}function s_(t,n){return Vx(t.getHours()%12||12,n,2)}function l_(t,n){return Vx(1+qb.count(mb(t),t),n,3)}function h_(t,n){return Vx(t.getMilliseconds(),n,3)}function d_(t,n){return h_(t,n)+"000"}function p_(t,n){return Vx(t.getMonth()+1,n,2)}function y_(t,n){return Vx(t.getMinutes(),n,2)}function v_(t,n){return Vx(t.getSeconds(),n,2)}function g_(t){var n=t.getDay();return 0===n?7:n}function m_(t,n){return Vx(Cb.count(mb(t)-1,t),n,2)}function b_(t){var n=t.getDay();return n>=4||0===n?Ib(t):Ib.ceil(t)}function x_(t,n){return t=b_(t),Vx(Ib.count(mb(t),t)+(4===mb(t).getDay()),n,2)}function __(t){return t.getDay()}function w_(t,n){return Vx(Ob.count(mb(t)-1,t),n,2)}function S_(t,n){return Vx(t.getFullYear()%100,n,2)}function A_(t,n){return Vx((t=b_(t)).getFullYear()%100,n,2)}function M_(t,n){return Vx(t.getFullYear()%1e4,n,4)}function k_(t,n){var e=t.getDay();return Vx((t=e>=4||0===e?Ib(t):Ib.ceil(t)).getFullYear()%1e4,n,4)}function T_(t){var n=t.getTimezoneOffset();return(n>0?"-":(n*=-1,"+"))+Vx(n/60|0,"0",2)+Vx(n%60,"0",2)}function E_(t,n){return Vx(t.getUTCDate(),n,2)}function C_(t,n){return Vx(t.getUTCHours(),n,2)}function O_(t,n){return Vx(t.getUTCHours()%12||12,n,2)}function P_(t,n){return Vx(1+xx.count(Sx(t),t),n,3)}function N_(t,n){return Vx(t.getUTCMilliseconds(),n,3)}function I_(t,n){return N_(t,n)+"000"}function R_(t,n){return Vx(t.getUTCMonth()+1,n,2)}function D_(t,n){return Vx(t.getUTCMinutes(),n,2)}function j_(t,n){return Vx(t.getUTCSeconds(),n,2)}function z_(t){var n=t.getUTCDay();return 0===n?7:n}function V_(t,n){return Vx(ox.count(Sx(t)-1,t),n,2)}function L_(t){var n=t.getUTCDay();return n>=4||0===n?fx(t):fx.ceil(t)}function U_(t,n){return t=L_(t),Vx(fx.count(Sx(t),t)+(4===Sx(t).getUTCDay()),n,2)}function F_(t){return t.getUTCDay()}function B_(t,n){return Vx(ax.count(Sx(t)-1,t),n,2)}function H_(t,n){return Vx(t.getUTCFullYear()%100,n,2)}function q_(t,n){return Vx((t=L_(t)).getUTCFullYear()%100,n,2)}function Y_(t,n){return Vx(t.getUTCFullYear()%1e4,n,4)}function X_(t,n){var e=t.getUTCDay();return Vx((t=e>=4||0===e?fx(t):fx.ceil(t)).getUTCFullYear()%1e4,n,4)}function $_(){return"+0000"}function W_(){return"%"}function G_(t){return+t}function Q_(t){return Math.floor(+t/1e3)}function Z_(t){return Cx=Ex(t),Ox=Cx.format,Px=Cx.parse,Nx=Cx.utcFormat,Ix=Cx.utcParse,Cx}Z_({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var K_=1e3,J_=6e4,tw=36e5,nw=864e5,ew=2592e6,rw=31536e6;function iw(t){return new Date(t)}function ow(t){return t instanceof Date?+t:+new Date(+t)}function aw(t,n,e,r,i,a,u,c,f){var s=Rm(),l=s.invert,h=s.domain,d=f(".%L"),p=f(":%S"),y=f("%I:%M"),v=f("%I %p"),g=f("%a %d"),m=f("%b %d"),b=f("%B"),x=f("%Y"),_=[[u,1,K_],[u,5,5e3],[u,15,15e3],[u,30,3e4],[a,1,J_],[a,5,3e5],[a,15,9e5],[a,30,18e5],[i,1,tw],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,nw],[r,2,1728e5],[e,1,6048e5],[n,1,ew],[n,3,7776e6],[t,1,rw]];function w(o){return(u(o)<o?d:a(o)<o?p:i(o)<o?y:r(o)<o?v:n(o)<o?e(o)<o?g:m:t(o)<o?b:x)(o)}function S(n,e,r){if(null==n&&(n=10),"number"==typeof n){var i,a=Math.abs(r-e)/n,u=o((function(t){return t[2]})).right(_,a);return u===_.length?(i=st(e/rw,r/rw,n),n=t):u?(i=(u=_[a/_[u-1][2]<_[u][2]/a?u-1:u])[1],n=u[0]):(i=Math.max(st(e,r,n),1),n=c),n.every(i)}return n}return s.invert=function(t){return new Date(l(t))},s.domain=function(t){return arguments.length?h(Array.from(t,ow)):h().map(iw)},s.ticks=function(t){var n,e=h(),r=e[0],i=e[e.length-1],o=i<r;return o&&(n=r,r=i,i=n),n=(n=S(t,r,i))?n.range(r,i+1):[],o?n.reverse():n},s.tickFormat=function(t,n){return null==n?w:f(n)},s.nice=function(t){var n=h();return(t=S(t,n[0],n[n.length-1]))?h(Lm(n,t)):s},s.copy=function(){return Nm(s,aw(t,n,e,r,i,a,u,c,f))},s}function uw(){return ym.apply(aw(mb,_b,Cb,qb,$b,Qb,Jb,ex,Ox).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}var cw=vb((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCMonth(t.getUTCMonth()+n)}),(function(t,n){return n.getUTCMonth()-t.getUTCMonth()+12*(n.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()})),fw=cw,sw=cw.range,lw=vb((function(t){t.setUTCMinutes(0,0,0)}),(function(t,n){t.setTime(+t+n*Mb)}),(function(t,n){return(n-t)/Mb}),(function(t){return t.getUTCHours()})),hw=lw,dw=lw.range,pw=vb((function(t){t.setUTCSeconds(0,0)}),(function(t,n){t.setTime(+t+n*Ab)}),(function(t,n){return(n-t)/Ab}),(function(t){return t.getUTCMinutes()})),yw=pw,vw=pw.range;function gw(){return ym.apply(aw(Sx,fw,ox,xx,hw,yw,Jb,ex,Nx).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function mw(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var e=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(e.push(a.value),!n||e.length!==n);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return e}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return bw(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return bw(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bw(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function xw(){var t,n,e,r,i,o=0,a=1,u=Em,c=!1;function f(n){return isNaN(n=+n)?i:u(0===e?.5:(n=(r(n)-t)*e,c?Math.max(0,Math.min(1,n)):n))}function s(t){return function(n){var e,r,i;return arguments.length?(r=(e=mw(n,2))[0],i=e[1],u=t(r,i),f):[u(0),u(1)]}}return f.domain=function(i){var u;return arguments.length?(u=mw(i,2),o=u[0],a=u[1],t=r(o=+o),n=r(a=+a),e=t===n?0:1/(n-t),f):[o,a]},f.clamp=function(t){return arguments.length?(c=!!t,f):c},f.interpolator=function(t){return arguments.length?(u=t,f):u},f.range=s(Li),f.rangeRound=s(Ag),f.unknown=function(t){return arguments.length?(i=t,f):i},function(i){return r=i,t=i(o),n=i(a),e=t===n?0:1/(n-t),f}}function _w(t,n){return n.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function ww(){var t=jm(xw()(Em));return t.copy=function(){return _w(t,ww())},vm.apply(t,arguments)}function Sw(){var t=Xm(xw()).domain([1,10]);return t.copy=function(){return _w(t,Sw()).base(t.base())},vm.apply(t,arguments)}function Aw(){var t=Qm(xw());return t.copy=function(){return _w(t,Aw()).constant(t.constant())},vm.apply(t,arguments)}function Mw(){var t=nb(xw());return t.copy=function(){return _w(t,Mw()).exponent(t.exponent())},vm.apply(t,arguments)}function kw(){return Mw.apply(null,arguments).exponent(.5)}function Tw(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return Ew(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Ew(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Ew(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Cw(){var t=[],n=Em;function e(e){if(!isNaN(e=+e))return n((g(t,e,1)-1)/(t.length-1))}return e.domain=function(n){if(!arguments.length)return t.slice();t=[];var r,o=Tw(n);try{for(o.s();!(r=o.n()).done;){var a=r.value;null==a||isNaN(a=+a)||t.push(a)}}catch(t){o.e(t)}finally{o.f()}return t.sort(i),e},e.interpolator=function(t){return arguments.length?(n=t,e):n},e.range=function(){return t.map((function(e,r){return n(r/(t.length-1))}))},e.quantiles=function(n){return Array.from({length:n+1},(function(e,r){return At(t,r/n)}))},e.copy=function(){return Cw(n).domain(t)},vm.apply(e,arguments)}function Ow(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var e=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(e.push(a.value),!n||e.length!==n);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return e}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return Pw(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Pw(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pw(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Nw(){var t,n,e,r,i,o,a,u=0,c=.5,f=1,s=1,l=Em,h=!1;function d(t){return isNaN(t=+t)?a:(t=.5+((t=+o(t))-n)*(s*t<s*n?r:i),l(h?Math.max(0,Math.min(1,t)):t))}function p(t){return function(n){var e,r,i,o;return arguments.length?(r=(e=Ow(n,3))[0],i=e[1],o=e[2],l=zg(t,[r,i,o]),d):[l(0),l(.5),l(1)]}}return d.domain=function(a){var l;return arguments.length?(l=Ow(a,3),u=l[0],c=l[1],f=l[2],t=o(u=+u),n=o(c=+c),e=o(f=+f),r=t===n?0:.5/(n-t),i=n===e?0:.5/(e-n),s=n<t?-1:1,d):[u,c,f]},d.clamp=function(t){return arguments.length?(h=!!t,d):h},d.interpolator=function(t){return arguments.length?(l=t,d):l},d.range=p(Li),d.rangeRound=p(Ag),d.unknown=function(t){return arguments.length?(a=t,d):a},function(a){return o=a,t=a(u),n=a(c),e=a(f),r=t===n?0:.5/(n-t),i=n===e?0:.5/(e-n),s=n<t?-1:1,d}}function Iw(){var t=jm(Nw()(Em));return t.copy=function(){return _w(t,Iw())},vm.apply(t,arguments)}function Rw(){var t=Xm(Nw()).domain([.1,1,10]);return t.copy=function(){return _w(t,Rw()).base(t.base())},vm.apply(t,arguments)}function Dw(){var t=Qm(Nw());return t.copy=function(){return _w(t,Dw()).constant(t.constant())},vm.apply(t,arguments)}function jw(){var t=nb(Nw());return t.copy=function(){return _w(t,jw()).exponent(t.exponent())},vm.apply(t,arguments)}function zw(){return jw.apply(null,arguments).exponent(.5)}function Vw(t){for(var n=t.length/6|0,e=new Array(n),r=0;r<n;)e[r]="#"+t.slice(6*r,6*++r);return e}var Lw=Vw("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Uw=Vw("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),Fw=Vw("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Bw=Vw("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),Hw=Vw("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),qw=Vw("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),Yw=Vw("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),Xw=Vw("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),$w=Vw("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),Ww=Vw("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),Gw=function(t){return Mi(t[t.length-1])},Qw=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(Vw),Zw=Gw(Qw),Kw=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(Vw),Jw=Gw(Kw),tS=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(Vw),nS=Gw(tS),eS=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(Vw),rS=Gw(eS),iS=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Vw),oS=Gw(iS),aS=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(Vw),uS=Gw(aS),cS=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(Vw),fS=Gw(cS),sS=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Vw),lS=Gw(sS),hS=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Vw),dS=Gw(hS),pS=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Vw),yS=Gw(pS),vS=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(Vw),gS=Gw(vS),mS=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(Vw),bS=Gw(mS),xS=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(Vw),_S=Gw(xS),wS=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(Vw),SS=Gw(wS),AS=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(Vw),MS=Gw(AS),kS=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(Vw),TS=Gw(kS),ES=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(Vw),CS=Gw(ES),OS=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Vw),PS=Gw(OS),NS=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(Vw),IS=Gw(NS),RS=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(Vw),DS=Gw(RS),jS=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Vw),zS=Gw(jS),VS=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Vw),LS=Gw(VS),US=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(Vw),FS=Gw(US),BS=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Vw),HS=Gw(BS),qS=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Vw),YS=Gw(qS),XS=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Vw),$S=Gw(XS),WS=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Vw),GS=Gw(WS);function QS(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-t*(35.34-t*(2381.73-t*(6402.7-t*(7024.72-2710.57*t)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+t*(170.73+t*(52.82-t*(131.46-t*(176.58-67.37*t)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+t*(442.36-t*(2482.43-t*(6167.24-t*(6614.94-2475.67*t)))))))+")"}var ZS=jg(Zu(300,.5,0),Zu(-240,.5,1)),KS=jg(Zu(-100,.75,.35),Zu(80,1.5,.8)),JS=jg(Zu(260,.75,.35),Zu(80,1.5,.8)),tA=Zu();function nA(t){(t<0||t>1)&&(t-=Math.floor(t));var n=Math.abs(t-.5);return tA.h=360*t-100,tA.s=1.5-1.5*n,tA.l=.8-.9*n,tA+""}var eA=oi(),rA=Math.PI/3,iA=2*Math.PI/3;function oA(t){var n;return t=(.5-t)*Math.PI,eA.r=255*(n=Math.sin(t))*n,eA.g=255*(n=Math.sin(t+rA))*n,eA.b=255*(n=Math.sin(t+iA))*n,eA+""}function aA(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-14825.05*t)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+707.56*t)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-6838.66*t)))))))+")"}function uA(t){var n=t.length;return function(e){return t[Math.max(0,Math.min(n-1,Math.floor(e*n)))]}}var cA=uA(Vw("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),fA=uA(Vw("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),sA=uA(Vw("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),lA=uA(Vw("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function hA(t){return Nr(yr(t).call(document.documentElement))}var dA=0;function pA(){return new yA}function yA(){this._="@"+(++dA).toString(36)}function vA(t,n){return t.target&&(t=Ui(t),void 0===n&&(n=t.currentTarget),t=t.touches||[t]),Array.from(t,(function(t){return Fi(t,n)}))}function gA(t){return"string"==typeof t?new Cr([document.querySelectorAll(t)],[document.documentElement]):new Cr([null==t?[]:ve(t)],Er)}function mA(t){return function(){return t}}yA.prototype=pA.prototype={constructor:yA,get:function(t){for(var n=this._;!(n in t);)if(!(t=t.parentNode))return;return t[n]},set:function(t,n){return t[this._]=n},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var bA=Math.abs,xA=Math.atan2,_A=Math.cos,wA=Math.max,SA=Math.min,AA=Math.sin,MA=Math.sqrt,kA=1e-12,TA=Math.PI,EA=TA/2,CA=2*TA;function OA(t){return t>1?0:t<-1?TA:Math.acos(t)}function PA(t){return t>=1?EA:t<=-1?-EA:Math.asin(t)}function NA(t){return t.innerRadius}function IA(t){return t.outerRadius}function RA(t){return t.startAngle}function DA(t){return t.endAngle}function jA(t){return t&&t.padAngle}function zA(t,n,e,r,i,o,a,u){var c=e-t,f=r-n,s=a-i,l=u-o,h=l*c-s*f;if(!(h*h<kA))return[t+(h=(s*(n-o)-l*(t-i))/h)*c,n+h*f]}function VA(t,n,e,r,i,o,a){var u=t-e,c=n-r,f=(a?o:-o)/MA(u*u+c*c),s=f*c,l=-f*u,h=t+s,d=n+l,p=e+s,y=r+l,v=(h+p)/2,g=(d+y)/2,m=p-h,b=y-d,x=m*m+b*b,_=i-o,w=h*y-p*d,S=(b<0?-1:1)*MA(wA(0,_*_*x-w*w)),A=(w*b-m*S)/x,M=(-w*m-b*S)/x,k=(w*b+m*S)/x,T=(-w*m+b*S)/x,E=A-v,C=M-g,O=k-v,P=T-g;return E*E+C*C>O*O+P*P&&(A=k,M=T),{cx:A,cy:M,x01:-s,y01:-l,x11:A*(i/_-1),y11:M*(i/_-1)}}function LA(){var t=NA,n=IA,e=mA(0),r=null,i=RA,o=DA,a=jA,u=null;function c(){var c,f,s=+t.apply(this,arguments),l=+n.apply(this,arguments),h=i.apply(this,arguments)-EA,d=o.apply(this,arguments)-EA,p=bA(d-h),y=d>h;if(u||(u=c=fu()),l<s&&(f=l,l=s,s=f),l>kA)if(p>CA-kA)u.moveTo(l*_A(h),l*AA(h)),u.arc(0,0,l,h,d,!y),s>kA&&(u.moveTo(s*_A(d),s*AA(d)),u.arc(0,0,s,d,h,y));else{var v,g,m=h,b=d,x=h,_=d,w=p,S=p,A=a.apply(this,arguments)/2,M=A>kA&&(r?+r.apply(this,arguments):MA(s*s+l*l)),k=SA(bA(l-s)/2,+e.apply(this,arguments)),T=k,E=k;if(M>kA){var C=PA(M/s*AA(A)),O=PA(M/l*AA(A));(w-=2*C)>kA?(x+=C*=y?1:-1,_-=C):(w=0,x=_=(h+d)/2),(S-=2*O)>kA?(m+=O*=y?1:-1,b-=O):(S=0,m=b=(h+d)/2)}var P=l*_A(m),N=l*AA(m),I=s*_A(_),R=s*AA(_);if(k>kA){var D,j=l*_A(b),z=l*AA(b),V=s*_A(x),L=s*AA(x);if(p<TA&&(D=zA(P,N,V,L,j,z,I,R))){var U=P-D[0],F=N-D[1],B=j-D[0],H=z-D[1],q=1/AA(OA((U*B+F*H)/(MA(U*U+F*F)*MA(B*B+H*H)))/2),Y=MA(D[0]*D[0]+D[1]*D[1]);T=SA(k,(s-Y)/(q-1)),E=SA(k,(l-Y)/(q+1))}}S>kA?E>kA?(v=VA(V,L,P,N,l,E,y),g=VA(j,z,I,R,l,E,y),u.moveTo(v.cx+v.x01,v.cy+v.y01),E<k?u.arc(v.cx,v.cy,E,xA(v.y01,v.x01),xA(g.y01,g.x01),!y):(u.arc(v.cx,v.cy,E,xA(v.y01,v.x01),xA(v.y11,v.x11),!y),u.arc(0,0,l,xA(v.cy+v.y11,v.cx+v.x11),xA(g.cy+g.y11,g.cx+g.x11),!y),u.arc(g.cx,g.cy,E,xA(g.y11,g.x11),xA(g.y01,g.x01),!y))):(u.moveTo(P,N),u.arc(0,0,l,m,b,!y)):u.moveTo(P,N),s>kA&&w>kA?T>kA?(v=VA(I,R,j,z,s,-T,y),g=VA(P,N,V,L,s,-T,y),u.lineTo(v.cx+v.x01,v.cy+v.y01),T<k?u.arc(v.cx,v.cy,T,xA(v.y01,v.x01),xA(g.y01,g.x01),!y):(u.arc(v.cx,v.cy,T,xA(v.y01,v.x01),xA(v.y11,v.x11),!y),u.arc(0,0,s,xA(v.cy+v.y11,v.cx+v.x11),xA(g.cy+g.y11,g.cx+g.x11),y),u.arc(g.cx,g.cy,T,xA(g.y11,g.x11),xA(g.y01,g.x01),!y))):u.arc(0,0,s,_,x,y):u.lineTo(I,R)}else u.moveTo(0,0);if(u.closePath(),c)return u=null,c+""||null}return c.centroid=function(){var e=(+t.apply(this,arguments)+ +n.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-TA/2;return[_A(r)*e,AA(r)*e]},c.innerRadius=function(n){return arguments.length?(t="function"==typeof n?n:mA(+n),c):t},c.outerRadius=function(t){return arguments.length?(n="function"==typeof t?t:mA(+t),c):n},c.cornerRadius=function(t){return arguments.length?(e="function"==typeof t?t:mA(+t),c):e},c.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:mA(+t),c):r},c.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:mA(+t),c):i},c.endAngle=function(t){return arguments.length?(o="function"==typeof t?t:mA(+t),c):o},c.padAngle=function(t){return arguments.length?(a="function"==typeof t?t:mA(+t),c):a},c.context=function(t){return arguments.length?(u=null==t?null:t,c):u},c}function UA(t){return(UA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var FA=Array.prototype.slice;function BA(t){return"object"===UA(t)&&"length"in t?t:Array.from(t)}function HA(t){this._context=t}function qA(t){return new HA(t)}function YA(t){return t[0]}function XA(t){return t[1]}function $A(t,n){var e=mA(!0),r=null,i=qA,o=null;function a(a){var u,c,f,s=(a=BA(a)).length,l=!1;for(null==r&&(o=i(f=fu())),u=0;u<=s;++u)!(u<s&&e(c=a[u],u,a))===l&&((l=!l)?o.lineStart():o.lineEnd()),l&&o.point(+t(c,u,a),+n(c,u,a));if(f)return o=null,f+""||null}return t="function"==typeof t?t:void 0===t?YA:mA(t),n="function"==typeof n?n:void 0===n?XA:mA(n),a.x=function(n){return arguments.length?(t="function"==typeof n?n:mA(+n),a):t},a.y=function(t){return arguments.length?(n="function"==typeof t?t:mA(+t),a):n},a.defined=function(t){return arguments.length?(e="function"==typeof t?t:mA(!!t),a):e},a.curve=function(t){return arguments.length?(i=t,null!=r&&(o=i(r)),a):i},a.context=function(t){return arguments.length?(null==t?r=o=null:o=i(r=t),a):r},a}function WA(t,n,e){var r=null,i=mA(!0),o=null,a=qA,u=null;function c(c){var f,s,l,h,d,p=(c=BA(c)).length,y=!1,v=new Array(p),g=new Array(p);for(null==o&&(u=a(d=fu())),f=0;f<=p;++f){if(!(f<p&&i(h=c[f],f,c))===y)if(y=!y)s=f,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),l=f-1;l>=s;--l)u.point(v[l],g[l]);u.lineEnd(),u.areaEnd()}y&&(v[f]=+t(h,f,c),g[f]=+n(h,f,c),u.point(r?+r(h,f,c):v[f],e?+e(h,f,c):g[f]))}if(d)return u=null,d+""||null}function f(){return $A().defined(i).curve(a).context(o)}return t="function"==typeof t?t:void 0===t?YA:mA(+t),n="function"==typeof n?n:mA(void 0===n?0:+n),e="function"==typeof e?e:void 0===e?XA:mA(+e),c.x=function(n){return arguments.length?(t="function"==typeof n?n:mA(+n),r=null,c):t},c.x0=function(n){return arguments.length?(t="function"==typeof n?n:mA(+n),c):t},c.x1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:mA(+t),c):r},c.y=function(t){return arguments.length?(n="function"==typeof t?t:mA(+t),e=null,c):n},c.y0=function(t){return arguments.length?(n="function"==typeof t?t:mA(+t),c):n},c.y1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:mA(+t),c):e},c.lineX0=c.lineY0=function(){return f().x(t).y(n)},c.lineY1=function(){return f().x(t).y(e)},c.lineX1=function(){return f().x(r).y(n)},c.defined=function(t){return arguments.length?(i="function"==typeof t?t:mA(!!t),c):i},c.curve=function(t){return arguments.length?(a=t,null!=o&&(u=a(o)),c):a},c.context=function(t){return arguments.length?(null==t?o=u=null:u=a(o=t),c):o},c}function GA(t,n){return n<t?-1:n>t?1:n>=t?0:NaN}function QA(t){return t}function ZA(){var t=QA,n=GA,e=null,r=mA(0),i=mA(CA),o=mA(0);function a(a){var u,c,f,s,l,h=(a=BA(a)).length,d=0,p=new Array(h),y=new Array(h),v=+r.apply(this,arguments),g=Math.min(CA,Math.max(-CA,i.apply(this,arguments)-v)),m=Math.min(Math.abs(g)/h,o.apply(this,arguments)),b=m*(g<0?-1:1);for(u=0;u<h;++u)(l=y[p[u]=u]=+t(a[u],u,a))>0&&(d+=l);for(null!=n?p.sort((function(t,e){return n(y[t],y[e])})):null!=e&&p.sort((function(t,n){return e(a[t],a[n])})),u=0,f=d?(g-h*b)/d:0;u<h;++u,v=s)c=p[u],s=v+((l=y[c])>0?l*f:0)+b,y[c]={data:a[c],index:u,value:l,startAngle:v,endAngle:s,padAngle:m};return y}return a.value=function(n){return arguments.length?(t="function"==typeof n?n:mA(+n),a):t},a.sortValues=function(t){return arguments.length?(n=t,e=null,a):n},a.sort=function(t){return arguments.length?(e=t,n=null,a):e},a.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:mA(+t),a):r},a.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:mA(+t),a):i},a.padAngle=function(t){return arguments.length?(o="function"==typeof t?t:mA(+t),a):o},a}HA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:this._context.lineTo(t,n)}}};var KA=tM(qA);function JA(t){this._curve=t}function tM(t){function n(n){return new JA(t(n))}return n._curve=t,n}function nM(t){var n=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?n(tM(t)):n()._curve},t}function eM(){return nM($A().curve(KA))}function rM(){var t=WA().curve(KA),n=t.curve,e=t.lineX0,r=t.lineX1,i=t.lineY0,o=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return nM(e())},delete t.lineX0,t.lineEndAngle=function(){return nM(r())},delete t.lineX1,t.lineInnerRadius=function(){return nM(i())},delete t.lineY0,t.lineOuterRadius=function(){return nM(o())},delete t.lineY1,t.curve=function(t){return arguments.length?n(tM(t)):n()._curve},t}function iM(t,n){return[(n=+n)*Math.cos(t-=Math.PI/2),n*Math.sin(t)]}function oM(t){return t.source}function aM(t){return t.target}function uM(t){var n=oM,e=aM,r=YA,i=XA,o=null;function a(){var a,u=FA.call(arguments),c=n.apply(this,u),f=e.apply(this,u);if(o||(o=a=fu()),t(o,+r.apply(this,(u[0]=c,u)),+i.apply(this,u),+r.apply(this,(u[0]=f,u)),+i.apply(this,u)),a)return o=null,a+""||null}return a.source=function(t){return arguments.length?(n=t,a):n},a.target=function(t){return arguments.length?(e=t,a):e},a.x=function(t){return arguments.length?(r="function"==typeof t?t:mA(+t),a):r},a.y=function(t){return arguments.length?(i="function"==typeof t?t:mA(+t),a):i},a.context=function(t){return arguments.length?(o=null==t?null:t,a):o},a}function cM(t,n,e,r,i){t.moveTo(n,e),t.bezierCurveTo(n=(n+r)/2,e,n,i,r,i)}function fM(t,n,e,r,i){t.moveTo(n,e),t.bezierCurveTo(n,e=(e+i)/2,r,e,r,i)}function sM(t,n,e,r,i){var o=iM(n,e),a=iM(n,e=(e+i)/2),u=iM(r,e),c=iM(r,i);t.moveTo(o[0],o[1]),t.bezierCurveTo(a[0],a[1],u[0],u[1],c[0],c[1])}function lM(){return uM(cM)}function hM(){return uM(fM)}function dM(){var t=uM(sM);return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t}JA.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,n){this._curve.point(n*Math.sin(t),n*-Math.cos(t))}};var pM={draw:function(t,n){var e=Math.sqrt(n/TA);t.moveTo(e,0),t.arc(0,0,e,0,CA)}},yM={draw:function(t,n){var e=Math.sqrt(n/5)/2;t.moveTo(-3*e,-e),t.lineTo(-e,-e),t.lineTo(-e,-3*e),t.lineTo(e,-3*e),t.lineTo(e,-e),t.lineTo(3*e,-e),t.lineTo(3*e,e),t.lineTo(e,e),t.lineTo(e,3*e),t.lineTo(-e,3*e),t.lineTo(-e,e),t.lineTo(-3*e,e),t.closePath()}},vM=Math.sqrt(1/3),gM=2*vM,mM={draw:function(t,n){var e=Math.sqrt(n/gM),r=e*vM;t.moveTo(0,-e),t.lineTo(r,0),t.lineTo(0,e),t.lineTo(-r,0),t.closePath()}},bM=Math.sin(TA/10)/Math.sin(7*TA/10),xM=Math.sin(CA/10)*bM,_M=-Math.cos(CA/10)*bM,wM={draw:function(t,n){var e=Math.sqrt(.8908130915292852*n),r=xM*e,i=_M*e;t.moveTo(0,-e),t.lineTo(r,i);for(var o=1;o<5;++o){var a=CA*o/5,u=Math.cos(a),c=Math.sin(a);t.lineTo(c*e,-u*e),t.lineTo(u*r-c*i,c*r+u*i)}t.closePath()}},SM={draw:function(t,n){var e=Math.sqrt(n),r=-e/2;t.rect(r,r,e,e)}},AM=Math.sqrt(3),MM={draw:function(t,n){var e=-Math.sqrt(n/(3*AM));t.moveTo(0,2*e),t.lineTo(-AM*e,-e),t.lineTo(AM*e,-e),t.closePath()}},kM=-.5,TM=Math.sqrt(3)/2,EM=1/Math.sqrt(12),CM=3*(EM/2+1),OM={draw:function(t,n){var e=Math.sqrt(n/CM),r=e/2,i=e*EM,o=r,a=e*EM+e,u=-o,c=a;t.moveTo(r,i),t.lineTo(o,a),t.lineTo(u,c),t.lineTo(kM*r-TM*i,TM*r+kM*i),t.lineTo(kM*o-TM*a,TM*o+kM*a),t.lineTo(kM*u-TM*c,TM*u+kM*c),t.lineTo(kM*r+TM*i,kM*i-TM*r),t.lineTo(kM*o+TM*a,kM*a-TM*o),t.lineTo(kM*u+TM*c,kM*c-TM*u),t.closePath()}},PM=[pM,yM,mM,SM,wM,MM,OM];function NM(t,n){var e=null;function r(){var r;if(e||(e=r=fu()),t.apply(this,arguments).draw(e,+n.apply(this,arguments)),r)return e=null,r+""||null}return t="function"==typeof t?t:mA(t||pM),n="function"==typeof n?n:mA(void 0===n?64:+n),r.type=function(n){return arguments.length?(t="function"==typeof n?n:mA(n),r):t},r.size=function(t){return arguments.length?(n="function"==typeof t?t:mA(+t),r):n},r.context=function(t){return arguments.length?(e=null==t?null:t,r):e},r}function IM(){}function RM(t,n,e){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+n)/6,(t._y0+4*t._y1+e)/6)}function DM(t){this._context=t}function jM(t){return new DM(t)}function zM(t){this._context=t}function VM(t){return new zM(t)}function LM(t){this._context=t}function UM(t){return new LM(t)}function FM(t,n){this._basis=new DM(t),this._beta=n}DM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:RM(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:RM(this,t,n)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}},zM.prototype={areaStart:IM,areaEnd:IM,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._x2=t,this._y2=n;break;case 1:this._point=2,this._x3=t,this._y3=n;break;case 2:this._point=3,this._x4=t,this._y4=n,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+n)/6);break;default:RM(this,t,n)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}},LM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var e=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+n)/6;this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 3:this._point=4;default:RM(this,t,n)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}},FM.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,n=this._y,e=t.length-1;if(e>0)for(var r,i=t[0],o=n[0],a=t[e]-i,u=n[e]-o,c=-1;++c<=e;)r=c/e,this._basis.point(this._beta*t[c]+(1-this._beta)*(i+r*a),this._beta*n[c]+(1-this._beta)*(o+r*u));this._x=this._y=null,this._basis.lineEnd()},point:function(t,n){this._x.push(+t),this._y.push(+n)}};var BM=function t(n){function e(t){return 1===n?new DM(t):new FM(t,n)}return e.beta=function(n){return t(+n)},e}(.85);function HM(t,n,e){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-n),t._y2+t._k*(t._y1-e),t._x2,t._y2)}function qM(t,n){this._context=t,this._k=(1-n)/6}qM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:HM(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2,this._x1=t,this._y1=n;break;case 2:this._point=3;default:HM(this,t,n)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var YM=function t(n){function e(t){return new qM(t,n)}return e.tension=function(n){return t(+n)},e}(0);function XM(t,n){this._context=t,this._k=(1-n)/6}XM.prototype={areaStart:IM,areaEnd:IM,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._x3=t,this._y3=n;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=n);break;case 2:this._point=3,this._x5=t,this._y5=n;break;default:HM(this,t,n)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var $M=function t(n){function e(t){return new XM(t,n)}return e.tension=function(n){return t(+n)},e}(0);function WM(t,n){this._context=t,this._k=(1-n)/6}WM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:HM(this,t,n)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var GM=function t(n){function e(t){return new WM(t,n)}return e.tension=function(n){return t(+n)},e}(0);function QM(t,n,e){var r=t._x1,i=t._y1,o=t._x2,a=t._y2;if(t._l01_a>kA){var u=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*u-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,i=(i*u-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>kA){var f=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,s=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*f+t._x1*t._l23_2a-n*t._l12_2a)/s,a=(a*f+t._y1*t._l23_2a-e*t._l12_2a)/s}t._context.bezierCurveTo(r,i,o,a,t._x2,t._y2)}function ZM(t,n){this._context=t,this._alpha=n}ZM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){if(t=+t,n=+n,this._point){var e=this._x2-t,r=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(e*e+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3;default:QM(this,t,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var KM=function t(n){function e(t){return n?new ZM(t,n):new qM(t,0)}return e.alpha=function(n){return t(+n)},e}(.5);function JM(t,n){this._context=t,this._alpha=n}JM.prototype={areaStart:IM,areaEnd:IM,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,n){if(t=+t,n=+n,this._point){var e=this._x2-t,r=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(e*e+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=n;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=n);break;case 2:this._point=3,this._x5=t,this._y5=n;break;default:QM(this,t,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var tk=function t(n){function e(t){return n?new JM(t,n):new XM(t,0)}return e.alpha=function(n){return t(+n)},e}(.5);function nk(t,n){this._context=t,this._alpha=n}nk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){if(t=+t,n=+n,this._point){var e=this._x2-t,r=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(e*e+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:QM(this,t,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var ek=function t(n){function e(t){return n?new nk(t,n):new WM(t,0)}return e.alpha=function(n){return t(+n)},e}(.5);function rk(t){this._context=t}function ik(t){return new rk(t)}function ok(t){return t<0?-1:1}function ak(t,n,e){var r=t._x1-t._x0,i=n-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),a=(e-t._y1)/(i||r<0&&-0),u=(o*i+a*r)/(r+i);return(ok(o)+ok(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(u))||0}function uk(t,n){var e=t._x1-t._x0;return e?(3*(t._y1-t._y0)/e-n)/2:n}function ck(t,n,e){var r=t._x0,i=t._y0,o=t._x1,a=t._y1,u=(o-r)/3;t._context.bezierCurveTo(r+u,i+u*n,o-u,a-u*e,o,a)}function fk(t){this._context=t}function sk(t){this._context=new lk(t)}function lk(t){this._context=t}function hk(t){return new fk(t)}function dk(t){return new sk(t)}function pk(t){this._context=t}function yk(t){var n,e,r=t.length-1,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=t[0]+2*t[1],n=1;n<r-1;++n)i[n]=1,o[n]=4,a[n]=4*t[n]+2*t[n+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*t[r-1]+t[r],n=1;n<r;++n)e=i[n]/o[n-1],o[n]-=e,a[n]-=e*a[n-1];for(i[r-1]=a[r-1]/o[r-1],n=r-2;n>=0;--n)i[n]=(a[n]-i[n+1])/o[n];for(o[r-1]=(t[r]+i[r-1])/2,n=0;n<r-1;++n)o[n]=2*t[n+1]-i[n+1];return[i,o]}function vk(t){return new pk(t)}function gk(t,n){this._context=t,this._t=n}function mk(t){return new gk(t,.5)}function bk(t){return new gk(t,0)}function xk(t){return new gk(t,1)}function _k(t,n){if((i=t.length)>1)for(var e,r,i,o=1,a=t[n[0]],u=a.length;o<i;++o)for(r=a,a=t[n[o]],e=0;e<u;++e)a[e][1]+=a[e][0]=isNaN(r[e][1])?r[e][0]:r[e][1]}function wk(t){for(var n=t.length,e=new Array(n);--n>=0;)e[n]=n;return e}function Sk(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return Ak(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Ak(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Ak(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Mk(t,n){return t[n]}function kk(t){var n=[];return n.key=t,n}function Tk(){var t=mA([]),n=wk,e=_k,r=Mk;function i(i){var o,a,u,c=Array.from(t.apply(this,arguments),kk),f=c.length,s=-1,l=Sk(i);try{for(l.s();!(u=l.n()).done;){var h=u.value;for(o=0,++s;o<f;++o)(c[o][s]=[0,+r(h,c[o].key,s,i)]).data=h}}catch(t){l.e(t)}finally{l.f()}for(o=0,a=BA(n(c));o<f;++o)c[a[o]].index=o;return e(c,a),c}return i.keys=function(n){return arguments.length?(t="function"==typeof n?n:mA(Array.from(n)),i):t},i.value=function(t){return arguments.length?(r="function"==typeof t?t:mA(+t),i):r},i.order=function(t){return arguments.length?(n=null==t?wk:"function"==typeof t?t:mA(Array.from(t)),i):n},i.offset=function(t){return arguments.length?(e=null==t?_k:t,i):e},i}function Ek(t,n){if((r=t.length)>0){for(var e,r,i,o=0,a=t[0].length;o<a;++o){for(i=e=0;e<r;++e)i+=t[e][o][1]||0;if(i)for(e=0;e<r;++e)t[e][o][1]/=i}_k(t,n)}}function Ck(t,n){if((u=t.length)>0)for(var e,r,i,o,a,u,c=0,f=t[n[0]].length;c<f;++c)for(o=a=0,e=0;e<u;++e)(i=(r=t[n[e]][c])[1]-r[0])>0?(r[0]=o,r[1]=o+=i):i<0?(r[1]=a,r[0]=a+=i):(r[0]=0,r[1]=i)}function Ok(t,n){if((e=t.length)>0){for(var e,r=0,i=t[n[0]],o=i.length;r<o;++r){for(var a=0,u=0;a<e;++a)u+=t[a][r][1]||0;i[r][1]+=i[r][0]=-u/2}_k(t,n)}}function Pk(t,n){if((i=t.length)>0&&(r=(e=t[n[0]]).length)>0){for(var e,r,i,o=0,a=1;a<r;++a){for(var u=0,c=0,f=0;u<i;++u){for(var s=t[n[u]],l=s[a][1]||0,h=(l-(s[a-1][1]||0))/2,d=0;d<u;++d){var p=t[n[d]];h+=(p[a][1]||0)-(p[a-1][1]||0)}c+=l,f+=h*l}e[a-1][1]+=e[a-1][0]=o,c&&(o-=f/c)}e[a-1][1]+=e[a-1][0]=o,_k(t,n)}}function Nk(t){var n=t.map(Ik);return wk(t).sort((function(t,e){return n[t]-n[e]}))}function Ik(t){for(var n,e=-1,r=0,i=t.length,o=-1/0;++e<i;)(n=+t[e][1])>o&&(o=n,r=e);return r}function Rk(t){var n=t.map(Dk);return wk(t).sort((function(t,e){return n[t]-n[e]}))}function Dk(t){for(var n,e=0,r=-1,i=t.length;++r<i;)(n=+t[r][1])&&(e+=n);return e}function jk(t){return Rk(t).reverse()}function zk(t){var n,e,r=t.length,i=t.map(Dk),o=Nk(t),a=0,u=0,c=[],f=[];for(n=0;n<r;++n)e=o[n],a<u?(a+=i[e],c.push(e)):(u+=i[e],f.push(e));return f.reverse().concat(c)}function Vk(t){return wk(t).reverse()}rk.prototype={areaStart:IM,areaEnd:IM,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,n){t=+t,n=+n,this._point?this._context.lineTo(t,n):(this._point=1,this._context.moveTo(t,n))}},fk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:ck(this,this._t0,uk(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){var e=NaN;if(n=+n,(t=+t)!==this._x1||n!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,ck(this,uk(this,e=ak(this,t,n)),e);break;default:ck(this,this._t0,e=ak(this,t,n))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n,this._t0=e}}},(sk.prototype=Object.create(fk.prototype)).point=function(t,n){fk.prototype.point.call(this,n,t)},lk.prototype={moveTo:function(t,n){this._context.moveTo(n,t)},closePath:function(){this._context.closePath()},lineTo:function(t,n){this._context.lineTo(n,t)},bezierCurveTo:function(t,n,e,r,i,o){this._context.bezierCurveTo(n,t,r,e,o,i)}},pk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,n=this._y,e=t.length;if(e)if(this._line?this._context.lineTo(t[0],n[0]):this._context.moveTo(t[0],n[0]),2===e)this._context.lineTo(t[1],n[1]);else for(var r=yk(t),i=yk(n),o=0,a=1;a<e;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],t[a],n[a]);(this._line||0!==this._line&&1===e)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,n){this._x.push(+t),this._y.push(+n)}},gk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,n),this._context.lineTo(t,n);else{var e=this._x*(1-this._t)+t*this._t;this._context.lineTo(e,this._y),this._context.lineTo(e,n)}}this._x=t,this._y=n}};var Lk="%Y-%m-%dT%H:%M:%S.%LZ";var Uk=Date.prototype.toISOString?function(t){return t.toISOString()}:Nx(Lk);var Fk=+new Date("2000-01-01T00:00:00.000Z")?function(t){var n=new Date(t);return isNaN(n)?null:n}:Ix(Lk);function Bk(t,n,e){var r=new no,i=n;return null==n?(r.restart(t,n,e),r):(r._restart=r.restart,r.restart=function(t,n,e){n=+n,e=null==e?Ji():+e,r._restart((function o(a){a+=i,r._restart(o,i+=n,e),t(a)}),n,e)},r.restart(t,n,e),r)}var Hk=function(t){return function(){return t}};function qk(t,n){var e=n.sourceEvent,r=n.target,i=n.transform,o=n.dispatch;Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:o}})}function Yk(t,n,e){this.k=t,this.x=n,this.y=e}Yk.prototype={constructor:Yk,scale:function(t){return 1===t?this:new Yk(this.k*t,this.x,this.y)},translate:function(t,n){return 0===t&0===n?this:new Yk(this.k,this.x+this.k*t,this.y+this.k*n)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Xk=new Yk(1,0,0);function $k(t){for(;!t.__zoom;)if(!(t=t.parentNode))return Xk;return t.__zoom}function Wk(t){t.stopImmediatePropagation()}function Gk(t){t.preventDefault(),t.stopImmediatePropagation()}function Qk(t){return!(t.ctrlKey&&"wheel"!==t.type||t.button)}function Zk(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function Kk(){return this.__zoom||Xk}function Jk(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function tT(){return navigator.maxTouchPoints||"ontouchstart"in this}function nT(t,n,e){var r=t.invertX(n[0][0])-e[0][0],i=t.invertX(n[1][0])-e[1][0],o=t.invertY(n[0][1])-e[0][1],a=t.invertY(n[1][1])-e[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}function eT(){var t,n,e,r=Qk,i=Zk,o=nT,a=Jk,u=tT,c=[0,1/0],f=[[-1/0,-1/0],[1/0,1/0]],s=250,l=kg,h=he("start","zoom","end"),d=500,p=0,y=10;function v(t){t.property("__zoom",Kk).on("wheel.zoom",S).on("mousedown.zoom",A).on("dblclick.zoom",M).filter(u).on("touchstart.zoom",k).on("touchmove.zoom",T).on("touchend.zoom touchcancel.zoom",E).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(t,n){return(n=Math.max(c[0],Math.min(c[1],n)))===t.k?t:new Yk(n,t.x,t.y)}function m(t,n,e){var r=n[0]-e[0]*t.k,i=n[1]-e[1]*t.k;return r===t.x&&i===t.y?t:new Yk(t.k,r,i)}function b(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function x(t,n,e,r){t.on("start.zoom",(function(){_(this,arguments).event(r).start()})).on("interrupt.zoom end.zoom",(function(){_(this,arguments).event(r).end()})).tween("zoom",(function(){var t=this,o=arguments,a=_(t,o).event(r),u=i.apply(t,o),c=null==e?b(u):"function"==typeof e?e.apply(t,o):e,f=Math.max(u[1][0]-u[0][0],u[1][1]-u[0][1]),s=t.__zoom,h="function"==typeof n?n.apply(t,o):n,d=l(s.invert(c).concat(f/s.k),h.invert(c).concat(f/h.k));return function(t){if(1===t)t=h;else{var n=d(t),e=f/n[2];t=new Yk(e,c[0]-n[0]*e,c[1]-n[1]*e)}a.zoom(null,t)}}))}function _(t,n,e){return!e&&t.__zooming||new w(t,n)}function w(t,n){this.that=t,this.args=n,this.active=0,this.sourceEvent=null,this.extent=i.apply(t,n),this.taps=0}function S(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),i=1;i<n;i++)e[i-1]=arguments[i];if(r.apply(this,arguments)){var u=_(this,e).event(t),s=this.__zoom,l=Math.max(c[0],Math.min(c[1],s.k*Math.pow(2,a.apply(this,arguments)))),h=Fi(t);if(u.wheel)u.mouse[0][0]===h[0]&&u.mouse[0][1]===h[1]||(u.mouse[1]=s.invert(u.mouse[0]=h)),clearTimeout(u.wheel);else{if(s.k===l)return;u.mouse=[h,s.invert(h)],yo(this),u.start()}Gk(t),u.wheel=setTimeout(d,150),u.zoom("mouse",o(m(g(s,l),u.mouse[0],u.mouse[1]),u.extent,f))}function d(){u.wheel=null,u.end()}}function A(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];if(!e&&r.apply(this,arguments)){var u=_(this,i,!0).event(t),c=Nr(t.view).on("mousemove.zoom",y,!0).on("mouseup.zoom",v,!0),s=Fi(t,l),l=t.currentTarget,h=t.clientX,d=t.clientY;Dr(t.view),Wk(t),u.mouse=[s,this.__zoom.invert(s)],yo(this),u.start()}function y(t){if(Gk(t),!u.moved){var n=t.clientX-h,e=t.clientY-d;u.moved=n*n+e*e>p}u.event(t).zoom("mouse",o(m(u.that.__zoom,u.mouse[0]=Fi(t,l),u.mouse[1]),u.extent,f))}function v(t){c.on("mousemove.zoom mouseup.zoom",null),jr(t.view,u.moved),Gk(t),u.event(t).end()}}function M(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),a=1;a<n;a++)e[a-1]=arguments[a];if(r.apply(this,arguments)){var u=this.__zoom,c=Fi(t.changedTouches?t.changedTouches[0]:t,this),l=u.invert(c),h=u.k*(t.shiftKey?.5:2),d=o(m(g(u,h),c,l),i.apply(this,e),f);Gk(t),s>0?Nr(this).transition().duration(s).call(x,d,c,t):Nr(this).call(v.transform,d,c,t)}}function k(e){for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];if(r.apply(this,arguments)){var u,c,f,s,l=e.touches,h=l.length,p=_(this,o,e.changedTouches.length===h).event(e);for(Wk(e),c=0;c<h;++c)s=[s=Fi(f=l[c],this),this.__zoom.invert(s),f.identifier],p.touch0?p.touch1||p.touch0[2]===s[2]||(p.touch1=s,p.taps=0):(p.touch0=s,u=!0,p.taps=1+!!t);t&&(t=clearTimeout(t)),u&&(p.taps<2&&(n=s[0],t=setTimeout((function(){t=null}),d)),yo(this),p.start())}}function T(t){if(this.__zooming){for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];var i,a,u,c,s=_(this,e).event(t),l=t.changedTouches,h=l.length;for(Gk(t),i=0;i<h;++i)u=Fi(a=l[i],this),s.touch0&&s.touch0[2]===a.identifier?s.touch0[0]=u:s.touch1&&s.touch1[2]===a.identifier&&(s.touch1[0]=u);if(a=s.that.__zoom,s.touch1){var d=s.touch0[0],p=s.touch0[1],y=s.touch1[0],v=s.touch1[1],b=(b=y[0]-d[0])*b+(b=y[1]-d[1])*b,x=(x=v[0]-p[0])*x+(x=v[1]-p[1])*x;a=g(a,Math.sqrt(b/x)),u=[(d[0]+y[0])/2,(d[1]+y[1])/2],c=[(p[0]+v[0])/2,(p[1]+v[1])/2]}else{if(!s.touch0)return;u=s.touch0[0],c=s.touch0[1]}s.zoom("touch",o(m(a,u,c),s.extent,f))}}function E(t){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];if(this.__zooming){var a,u,c=_(this,i).event(t),f=t.changedTouches,s=f.length;for(Wk(t),e&&clearTimeout(e),e=setTimeout((function(){e=null}),d),a=0;a<s;++a)u=f[a],c.touch0&&c.touch0[2]===u.identifier?delete c.touch0:c.touch1&&c.touch1[2]===u.identifier&&delete c.touch1;if(c.touch1&&!c.touch0&&(c.touch0=c.touch1,delete c.touch1),c.touch0)c.touch0[1]=this.__zoom.invert(c.touch0[0]);else if(c.end(),2===c.taps&&(u=Fi(u,this),Math.hypot(n[0]-u[0],n[1]-u[1])<y)){var l=Nr(this).on("dblclick.zoom");l&&l.apply(this,arguments)}}}return v.transform=function(t,n,e,r){var i=t.selection?t.selection():t;i.property("__zoom",Kk),t!==i?x(t,n,e,r):i.interrupt().each((function(){_(this,arguments).event(r).start().zoom(null,"function"==typeof n?n.apply(this,arguments):n).end()}))},v.scaleBy=function(t,n,e,r){v.scaleTo(t,(function(){var t=this.__zoom.k,e="function"==typeof n?n.apply(this,arguments):n;return t*e}),e,r)},v.scaleTo=function(t,n,e,r){v.transform(t,(function(){var t=i.apply(this,arguments),r=this.__zoom,a=null==e?b(t):"function"==typeof e?e.apply(this,arguments):e,u=r.invert(a),c="function"==typeof n?n.apply(this,arguments):n;return o(m(g(r,c),a,u),t,f)}),e,r)},v.translateBy=function(t,n,e,r){v.transform(t,(function(){return o(this.__zoom.translate("function"==typeof n?n.apply(this,arguments):n,"function"==typeof e?e.apply(this,arguments):e),i.apply(this,arguments),f)}),null,r)},v.translateTo=function(t,n,e,r,a){v.transform(t,(function(){var t=i.apply(this,arguments),a=this.__zoom,u=null==r?b(t):"function"==typeof r?r.apply(this,arguments):r;return o(Xk.translate(u[0],u[1]).scale(a.k).translate("function"==typeof n?-n.apply(this,arguments):-n,"function"==typeof e?-e.apply(this,arguments):-e),t,f)}),r,a)},w.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,n){return this.mouse&&"mouse"!==t&&(this.mouse[1]=n.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=n.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=n.invert(this.touch1[0])),this.that.__zoom=n,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var n=Nr(this.that).datum();h.call(t,this.that,new qk(t,{sourceEvent:this.sourceEvent,target:v,type:t,transform:this.that.__zoom,dispatch:h}),n)}},v.wheelDelta=function(t){return arguments.length?(a="function"==typeof t?t:Hk(+t),v):a},v.filter=function(t){return arguments.length?(r="function"==typeof t?t:Hk(!!t),v):r},v.touchable=function(t){return arguments.length?(u="function"==typeof t?t:Hk(!!t),v):u},v.extent=function(t){return arguments.length?(i="function"==typeof t?t:Hk([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),v):i},v.scaleExtent=function(t){return arguments.length?(c[0]=+t[0],c[1]=+t[1],v):[c[0],c[1]]},v.translateExtent=function(t){return arguments.length?(f[0][0]=+t[0][0],f[1][0]=+t[1][0],f[0][1]=+t[0][1],f[1][1]=+t[1][1],v):[[f[0][0],f[0][1]],[f[1][0],f[1][1]]]},v.constrain=function(t){return arguments.length?(o=t,v):o},v.duration=function(t){return arguments.length?(s=+t,v):s},v.interpolate=function(t){return arguments.length?(l=t,v):l},v.on=function(){var t=h.on.apply(h,arguments);return t===h?v:t},v.clickDistance=function(t){return arguments.length?(p=(t=+t)*t,v):Math.sqrt(p)},v.tapDistance=function(t){return arguments.length?(y=+t,v):y},v}$k.prototype=Yk.prototype},13335:function(t,n,e){"use strict";e.r(n),e.d(n,{AElement:function(){return Nr},AnimateColorElement:function(){return vr},AnimateElement:function(){return pr},AnimateTransformElement:function(){return mr},BoundingBox:function(){return Ae},CB1:function(){return Hn},CB2:function(){return qn},CB3:function(){return Yn},CB4:function(){return Xn},Canvg:function(){return Mi},CircleElement:function(){return Be},ClipPathElement:function(){return ii},DefsElement:function(){return er},DescElement:function(){return mi},Document:function(){return wi},Element:function(){return ge},EllipseElement:function(){return qe},FeColorMatrixElement:function(){return Jr},FeCompositeElement:function(){return hi},FeDropShadowElement:function(){return ci},FeGaussianBlurElement:function(){return pi},FeMorphologyElement:function(){return si},FilterElement:function(){return ai},Font:function(){return Se},FontElement:function(){return wr},FontFaceElement:function(){return Ar},GElement:function(){return ir},GlyphElement:function(){return Er},GradientElement:function(){return ar},ImageElement:function(){return Ur},LineElement:function(){return Xe},LinearGradientElement:function(){return cr},MarkerElement:function(){return tr},MaskElement:function(){return ni},Matrix:function(){return fe},MissingGlyphElement:function(){return kr},Mouse:function(){return Jn},PSEUDO_ZERO:function(){return Ln},Parser:function(){return oe},PathElement:function(){return je},PathParser:function(){return Re},PatternElement:function(){return Ke},Point:function(){return Kn},PolygonElement:function(){return Qe},PolylineElement:function(){return We},Property:function(){return Qn},QB1:function(){return $n},QB2:function(){return Wn},QB3:function(){return Gn},RadialGradientElement:function(){return sr},RectElement:function(){return Ue},RenderedElement:function(){return ke},Rotate:function(){return ue},SVGElement:function(){return Ve},SVGFontLoader:function(){return Hr},Scale:function(){return ce},Screen:function(){return ee},Skew:function(){return le},SkewX:function(){return de},SkewY:function(){return ye},StopElement:function(){return hr},StyleElement:function(){return Yr},SymbolElement:function(){return Br},TRefElement:function(){return Or},TSpanElement:function(){return Oe},TextElement:function(){return Ee},TextPathElement:function(){return Vr},TitleElement:function(){return vi},Transform:function(){return ve},Translate:function(){return ae},UnknownElement:function(){return be},UseElement:function(){return $r},ViewPort:function(){return Zn},compressSpaces:function(){return wn},default:function(){return Ti},getSelectorSpecificity:function(){return Vn},normalizeAttributeName:function(){return Tn},normalizeColor:function(){return Cn},parseExternalUrl:function(){return En},presets:function(){return ki},toNumbers:function(){return Mn},trimLeft:function(){return Sn},trimRight:function(){return An},vectorMagnitude:function(){return Un},vectorsAngle:function(){return Bn},vectorsRatio:function(){return Fn}});var r=e(69236),i=e.n(r),o=e(52069),a=e.n(o),u=e(51463),c=e.n(u),f=e(82668),s=e.n(f),l=e(97828),h=e.n(l),d=e(3434),p=e.n(d),y=e(20658),v=e.n(y),g=e(5996),m=e.n(g),b=e(26117),x=e.n(b),_=e(61799),w=e.n(_),S=e(39831),A=e.n(S),M=e(20246),k=e.n(M),T=e(85162),E=e.n(T),C=e(75411),O=e.n(C),P=e(61985),N=e.n(P),I=e(96537),R=e.n(I),D=e(29888),j=e.n(D),z=e(54884),V=e.n(z),L=e(65575),U=e.n(L),F=e(13567),B=e.n(F),H=e(9456),q=e.n(H),Y=e(71722),X=e.n(Y),$=e(67563),W=e.n($),G=e(48729),Q=e.n(G),Z=e(34682),K=e.n(Z),J=e(31091),tt=e.n(J),nt=e(13345),et=e.n(nt),rt=e(23262),it=e.n(rt),ot=e(13248),at=e.n(ot),ut=e(44097),ct=e.n(ut),ft=e(84030),st=e.n(ft),lt=e(45285),ht=e.n(lt),dt=e(33591),pt=e.n(dt),yt=e(62750),vt=e.n(yt),gt=e(97965),mt=e.n(gt),bt=e(97539),xt=e.n(bt),_t=e(56778),wt=e.n(_t),St=e(76222),At=e.n(St),Mt=function(t,n){return(Mt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)};function kt(t,n){function e(){this.constructor=t}Mt(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}function Tt(t,n){var e=t[0],r=t[1];return[e*Math.cos(n)-r*Math.sin(n),e*Math.sin(n)+r*Math.cos(n)]}function Et(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var e=0;e<t.length;e++)if("number"!=typeof t[e])throw new Error("assertNumbers arguments["+e+"] is not a number. "+typeof t[e]+" == typeof "+t[e]);return!0}var Ct=Math.PI;function Ot(t,n,e){t.lArcFlag=0===t.lArcFlag?0:1,t.sweepFlag=0===t.sweepFlag?0:1;var r=t.rX,i=t.rY,o=t.x,a=t.y;r=Math.abs(t.rX),i=Math.abs(t.rY);var u=Tt([(n-o)/2,(e-a)/2],-t.xRot/180*Ct),c=u[0],f=u[1],s=Math.pow(c,2)/Math.pow(r,2)+Math.pow(f,2)/Math.pow(i,2);1<s&&(r*=Math.sqrt(s),i*=Math.sqrt(s)),t.rX=r,t.rY=i;var l=Math.pow(r,2)*Math.pow(f,2)+Math.pow(i,2)*Math.pow(c,2),h=(t.lArcFlag!==t.sweepFlag?1:-1)*Math.sqrt(Math.max(0,(Math.pow(r,2)*Math.pow(i,2)-l)/l)),d=r*f/i*h,p=-i*c/r*h,y=Tt([d,p],t.xRot/180*Ct);t.cX=y[0]+(n+o)/2,t.cY=y[1]+(e+a)/2,t.phi1=Math.atan2((f-p)/i,(c-d)/r),t.phi2=Math.atan2((-f-p)/i,(-c-d)/r),0===t.sweepFlag&&t.phi2>t.phi1&&(t.phi2-=2*Ct),1===t.sweepFlag&&t.phi2<t.phi1&&(t.phi2+=2*Ct),t.phi1*=180/Ct,t.phi2*=180/Ct}function Pt(t,n,e){Et(t,n,e);var r=t*t+n*n-e*e;if(0>r)return[];if(0===r)return[[t*e/(t*t+n*n),n*e/(t*t+n*n)]];var i=Math.sqrt(r);return[[(t*e+n*i)/(t*t+n*n),(n*e-t*i)/(t*t+n*n)],[(t*e-n*i)/(t*t+n*n),(n*e+t*i)/(t*t+n*n)]]}var Nt,It=Math.PI/180;function Rt(t,n,e){return(1-e)*t+e*n}function Dt(t,n,e,r){return t+Math.cos(r/180*Ct)*n+Math.sin(r/180*Ct)*e}function jt(t,n,e,r){var i=n-t,o=e-n,a=3*i+3*(r-e)-6*o,u=6*(o-i),c=3*i;return Math.abs(a)<1e-6?[-c/u]:function(t,n,e){void 0===e&&(e=1e-6);var r=t*t/4-n;if(r<-e)return[];if(r<=e)return[-t/2];var i=Math.sqrt(r);return[-t/2-i,-t/2+i]}(u/a,c/a,1e-6)}function zt(t,n,e,r,i){var o=1-i;return t*(o*o*o)+n*(3*o*o*i)+e*(3*o*i*i)+r*(i*i*i)}!function(t){function n(){return i((function(t,n,e){return t.relative&&(void 0!==t.x1&&(t.x1+=n),void 0!==t.y1&&(t.y1+=e),void 0!==t.x2&&(t.x2+=n),void 0!==t.y2&&(t.y2+=e),void 0!==t.x&&(t.x+=n),void 0!==t.y&&(t.y+=e),t.relative=!1),t}))}function e(){var t=NaN,n=NaN,e=NaN,r=NaN;return i((function(i,o,a){return i.type&Ht.SMOOTH_CURVE_TO&&(i.type=Ht.CURVE_TO,t=isNaN(t)?o:t,n=isNaN(n)?a:n,i.x1=i.relative?o-t:2*o-t,i.y1=i.relative?a-n:2*a-n),i.type&Ht.CURVE_TO?(t=i.relative?o+i.x2:i.x2,n=i.relative?a+i.y2:i.y2):(t=NaN,n=NaN),i.type&Ht.SMOOTH_QUAD_TO&&(i.type=Ht.QUAD_TO,e=isNaN(e)?o:e,r=isNaN(r)?a:r,i.x1=i.relative?o-e:2*o-e,i.y1=i.relative?a-r:2*a-r),i.type&Ht.QUAD_TO?(e=i.relative?o+i.x1:i.x1,r=i.relative?a+i.y1:i.y1):(e=NaN,r=NaN),i}))}function r(){var t=NaN,n=NaN;return i((function(e,r,i){if(e.type&Ht.SMOOTH_QUAD_TO&&(e.type=Ht.QUAD_TO,t=isNaN(t)?r:t,n=isNaN(n)?i:n,e.x1=e.relative?r-t:2*r-t,e.y1=e.relative?i-n:2*i-n),e.type&Ht.QUAD_TO){t=e.relative?r+e.x1:e.x1,n=e.relative?i+e.y1:e.y1;var o=e.x1,a=e.y1;e.type=Ht.CURVE_TO,e.x1=((e.relative?0:r)+2*o)/3,e.y1=((e.relative?0:i)+2*a)/3,e.x2=(e.x+2*o)/3,e.y2=(e.y+2*a)/3}else t=NaN,n=NaN;return e}))}function i(t){var n=0,e=0,r=NaN,i=NaN;return function(o){if(isNaN(r)&&!(o.type&Ht.MOVE_TO))throw new Error("path must start with moveto");var a=t(o,n,e,r,i);return o.type&Ht.CLOSE_PATH&&(n=r,e=i),void 0!==o.x&&(n=o.relative?n+o.x:o.x),void 0!==o.y&&(e=o.relative?e+o.y:o.y),o.type&Ht.MOVE_TO&&(r=n,i=e),a}}function o(t,n,e,r,o,a){return Et(t,n,e,r,o,a),i((function(i,u,c,f){var s=i.x1,l=i.x2,h=i.relative&&!isNaN(f),d=void 0!==i.x?i.x:h?0:u,p=void 0!==i.y?i.y:h?0:c;function y(t){return t*t}i.type&Ht.HORIZ_LINE_TO&&0!==n&&(i.type=Ht.LINE_TO,i.y=i.relative?0:c),i.type&Ht.VERT_LINE_TO&&0!==e&&(i.type=Ht.LINE_TO,i.x=i.relative?0:u),void 0!==i.x&&(i.x=i.x*t+p*e+(h?0:o)),void 0!==i.y&&(i.y=d*n+i.y*r+(h?0:a)),void 0!==i.x1&&(i.x1=i.x1*t+i.y1*e+(h?0:o)),void 0!==i.y1&&(i.y1=s*n+i.y1*r+(h?0:a)),void 0!==i.x2&&(i.x2=i.x2*t+i.y2*e+(h?0:o)),void 0!==i.y2&&(i.y2=l*n+i.y2*r+(h?0:a));var v=t*r-n*e;if(void 0!==i.xRot&&(1!==t||0!==n||0!==e||1!==r))if(0===v)delete i.rX,delete i.rY,delete i.xRot,delete i.lArcFlag,delete i.sweepFlag,i.type=Ht.LINE_TO;else{var g=i.xRot*Math.PI/180,m=Math.sin(g),b=Math.cos(g),x=1/y(i.rX),_=1/y(i.rY),w=y(b)*x+y(m)*_,S=2*m*b*(x-_),A=y(m)*x+y(b)*_,M=w*r*r-S*n*r+A*n*n,k=S*(t*r+n*e)-2*(w*e*r+A*t*n),T=w*e*e-S*t*e+A*t*t,E=(Math.atan2(k,M-T)+Math.PI)%Math.PI/2,C=Math.sin(E),O=Math.cos(E);i.rX=Math.abs(v)/Math.sqrt(M*y(O)+k*C*O+T*y(C)),i.rY=Math.abs(v)/Math.sqrt(M*y(C)-k*C*O+T*y(O)),i.xRot=180*E/Math.PI}return void 0!==i.sweepFlag&&0>v&&(i.sweepFlag=+!i.sweepFlag),i}))}t.ROUND=function(t){function n(n){return Math.round(n*t)/t}return void 0===t&&(t=1e13),Et(t),function(t){return void 0!==t.x1&&(t.x1=n(t.x1)),void 0!==t.y1&&(t.y1=n(t.y1)),void 0!==t.x2&&(t.x2=n(t.x2)),void 0!==t.y2&&(t.y2=n(t.y2)),void 0!==t.x&&(t.x=n(t.x)),void 0!==t.y&&(t.y=n(t.y)),void 0!==t.rX&&(t.rX=n(t.rX)),void 0!==t.rY&&(t.rY=n(t.rY)),t}},t.TO_ABS=n,t.TO_REL=function(){return i((function(t,n,e){return t.relative||(void 0!==t.x1&&(t.x1-=n),void 0!==t.y1&&(t.y1-=e),void 0!==t.x2&&(t.x2-=n),void 0!==t.y2&&(t.y2-=e),void 0!==t.x&&(t.x-=n),void 0!==t.y&&(t.y-=e),t.relative=!0),t}))},t.NORMALIZE_HVZ=function(t,n,e){return void 0===t&&(t=!0),void 0===n&&(n=!0),void 0===e&&(e=!0),i((function(r,i,o,a,u){if(isNaN(a)&&!(r.type&Ht.MOVE_TO))throw new Error("path must start with moveto");return n&&r.type&Ht.HORIZ_LINE_TO&&(r.type=Ht.LINE_TO,r.y=r.relative?0:o),e&&r.type&Ht.VERT_LINE_TO&&(r.type=Ht.LINE_TO,r.x=r.relative?0:i),t&&r.type&Ht.CLOSE_PATH&&(r.type=Ht.LINE_TO,r.x=r.relative?a-i:a,r.y=r.relative?u-o:u),r.type&Ht.ARC&&(0===r.rX||0===r.rY)&&(r.type=Ht.LINE_TO,delete r.rX,delete r.rY,delete r.xRot,delete r.lArcFlag,delete r.sweepFlag),r}))},t.NORMALIZE_ST=e,t.QT_TO_C=r,t.INFO=i,t.SANITIZE=function(t){void 0===t&&(t=0),Et(t);var n=NaN,e=NaN,r=NaN,o=NaN;return i((function(i,a,u,c,f){var s=Math.abs,l=!1,h=0,d=0;if(i.type&Ht.SMOOTH_CURVE_TO&&(h=isNaN(n)?0:a-n,d=isNaN(e)?0:u-e),i.type&(Ht.CURVE_TO|Ht.SMOOTH_CURVE_TO)?(n=i.relative?a+i.x2:i.x2,e=i.relative?u+i.y2:i.y2):(n=NaN,e=NaN),i.type&Ht.SMOOTH_QUAD_TO?(r=isNaN(r)?a:2*a-r,o=isNaN(o)?u:2*u-o):i.type&Ht.QUAD_TO?(r=i.relative?a+i.x1:i.x1,o=i.relative?u+i.y1:i.y2):(r=NaN,o=NaN),i.type&Ht.LINE_COMMANDS||i.type&Ht.ARC&&(0===i.rX||0===i.rY||!i.lArcFlag)||i.type&Ht.CURVE_TO||i.type&Ht.SMOOTH_CURVE_TO||i.type&Ht.QUAD_TO||i.type&Ht.SMOOTH_QUAD_TO){var p=void 0===i.x?0:i.relative?i.x:i.x-a,y=void 0===i.y?0:i.relative?i.y:i.y-u;h=isNaN(r)?void 0===i.x1?h:i.relative?i.x:i.x1-a:r-a,d=isNaN(o)?void 0===i.y1?d:i.relative?i.y:i.y1-u:o-u;var v=void 0===i.x2?0:i.relative?i.x:i.x2-a,g=void 0===i.y2?0:i.relative?i.y:i.y2-u;s(p)<=t&&s(y)<=t&&s(h)<=t&&s(d)<=t&&s(v)<=t&&s(g)<=t&&(l=!0)}return i.type&Ht.CLOSE_PATH&&s(a-c)<=t&&s(u-f)<=t&&(l=!0),l?[]:i}))},t.MATRIX=o,t.ROTATE=function(t,n,e){void 0===n&&(n=0),void 0===e&&(e=0),Et(t,n,e);var r=Math.sin(t),i=Math.cos(t);return o(i,r,-r,i,n-n*i+e*r,e-n*r-e*i)},t.TRANSLATE=function(t,n){return void 0===n&&(n=0),Et(t,n),o(1,0,0,1,t,n)},t.SCALE=function(t,n){return void 0===n&&(n=t),Et(t,n),o(t,0,0,n,0,0)},t.SKEW_X=function(t){return Et(t),o(1,0,Math.atan(t),1,0,0)},t.SKEW_Y=function(t){return Et(t),o(1,Math.atan(t),0,1,0,0)},t.X_AXIS_SYMMETRY=function(t){return void 0===t&&(t=0),Et(t),o(-1,0,0,1,t,0)},t.Y_AXIS_SYMMETRY=function(t){return void 0===t&&(t=0),Et(t),o(1,0,0,-1,0,t)},t.A_TO_C=function(){return i((function(t,n,e){return Ht.ARC===t.type?function(t,n,e){var r,i,o,a;t.cX||Ot(t,n,e);for(var u=Math.min(t.phi1,t.phi2),c=Math.max(t.phi1,t.phi2)-u,f=Math.ceil(c/90),s=new Array(f),l=n,h=e,d=0;d<f;d++){var p=Rt(t.phi1,t.phi2,d/f),y=Rt(t.phi1,t.phi2,(d+1)/f),v=y-p,g=4/3*Math.tan(v*It/4),m=[Math.cos(p*It)-g*Math.sin(p*It),Math.sin(p*It)+g*Math.cos(p*It)],b=m[0],x=m[1],_=[Math.cos(y*It),Math.sin(y*It)],w=_[0],S=_[1],A=[w+g*Math.sin(y*It),S-g*Math.cos(y*It)],M=A[0],k=A[1];s[d]={relative:t.relative,type:Ht.CURVE_TO};var T=function(n,e){var r=Tt([n*t.rX,e*t.rY],t.xRot),i=r[0],o=r[1];return[t.cX+i,t.cY+o]};r=T(b,x),s[d].x1=r[0],s[d].y1=r[1],i=T(M,k),s[d].x2=i[0],s[d].y2=i[1],o=T(w,S),s[d].x=o[0],s[d].y=o[1],t.relative&&(s[d].x1-=l,s[d].y1-=h,s[d].x2-=l,s[d].y2-=h,s[d].x-=l,s[d].y-=h),l=(a=[s[d].x,s[d].y])[0],h=a[1]}return s}(t,t.relative?0:n,t.relative?0:e):t}))},t.ANNOTATE_ARCS=function(){return i((function(t,n,e){return t.relative&&(n=0,e=0),Ht.ARC===t.type&&Ot(t,n,e),t}))},t.CLONE=function(){return function(t){var n={};for(var e in t)n[e]=t[e];return n}},t.CALCULATE_BOUNDS=function(){var t=n(),o=r(),a=e(),u=i((function(n,e,r){var i=a(o(t(function(t){var n={};for(var e in t)n[e]=t[e];return n}(n))));function c(t){t>u.maxX&&(u.maxX=t),t<u.minX&&(u.minX=t)}function f(t){t>u.maxY&&(u.maxY=t),t<u.minY&&(u.minY=t)}if(i.type&Ht.DRAWING_COMMANDS&&(c(e),f(r)),i.type&Ht.HORIZ_LINE_TO&&c(i.x),i.type&Ht.VERT_LINE_TO&&f(i.y),i.type&Ht.LINE_TO&&(c(i.x),f(i.y)),i.type&Ht.CURVE_TO){c(i.x),f(i.y);for(var s=0,l=jt(e,i.x1,i.x2,i.x);s<l.length;s++)0<(T=l[s])&&1>T&&c(zt(e,i.x1,i.x2,i.x,T));for(var h=0,d=jt(r,i.y1,i.y2,i.y);h<d.length;h++)0<(T=d[h])&&1>T&&f(zt(r,i.y1,i.y2,i.y,T))}if(i.type&Ht.ARC){c(i.x),f(i.y),Ot(i,e,r);for(var p=i.xRot/180*Math.PI,y=Math.cos(p)*i.rX,v=Math.sin(p)*i.rX,g=-Math.sin(p)*i.rY,m=Math.cos(p)*i.rY,b=i.phi1<i.phi2?[i.phi1,i.phi2]:-180>i.phi2?[i.phi2+360,i.phi1+360]:[i.phi2,i.phi1],x=b[0],_=b[1],w=function(t){var n=t[0],e=t[1],r=180*Math.atan2(e,n)/Math.PI;return r<x?r+360:r},S=0,A=Pt(g,-y,0).map(w);S<A.length;S++)(T=A[S])>x&&T<_&&c(Dt(i.cX,y,g,T));for(var M=0,k=Pt(m,-v,0).map(w);M<k.length;M++){var T;(T=k[M])>x&&T<_&&f(Dt(i.cY,v,m,T))}}return n}));return u.minX=1/0,u.maxX=-1/0,u.minY=1/0,u.maxY=-1/0,u}}(Nt||(Nt={}));var Vt,Lt=function(){function t(){}return t.prototype.round=function(t){return this.transform(Nt.ROUND(t))},t.prototype.toAbs=function(){return this.transform(Nt.TO_ABS())},t.prototype.toRel=function(){return this.transform(Nt.TO_REL())},t.prototype.normalizeHVZ=function(t,n,e){return this.transform(Nt.NORMALIZE_HVZ(t,n,e))},t.prototype.normalizeST=function(){return this.transform(Nt.NORMALIZE_ST())},t.prototype.qtToC=function(){return this.transform(Nt.QT_TO_C())},t.prototype.aToC=function(){return this.transform(Nt.A_TO_C())},t.prototype.sanitize=function(t){return this.transform(Nt.SANITIZE(t))},t.prototype.translate=function(t,n){return this.transform(Nt.TRANSLATE(t,n))},t.prototype.scale=function(t,n){return this.transform(Nt.SCALE(t,n))},t.prototype.rotate=function(t,n,e){return this.transform(Nt.ROTATE(t,n,e))},t.prototype.matrix=function(t,n,e,r,i,o){return this.transform(Nt.MATRIX(t,n,e,r,i,o))},t.prototype.skewX=function(t){return this.transform(Nt.SKEW_X(t))},t.prototype.skewY=function(t){return this.transform(Nt.SKEW_Y(t))},t.prototype.xSymmetry=function(t){return this.transform(Nt.X_AXIS_SYMMETRY(t))},t.prototype.ySymmetry=function(t){return this.transform(Nt.Y_AXIS_SYMMETRY(t))},t.prototype.annotateArcs=function(){return this.transform(Nt.ANNOTATE_ARCS())},t}(),Ut=function(t){return" "===t||"\t"===t||"\r"===t||"\n"===t},Ft=function(t){return"0".charCodeAt(0)<=t.charCodeAt(0)&&t.charCodeAt(0)<="9".charCodeAt(0)},Bt=function(t){function n(){var n=t.call(this)||this;return n.curNumber="",n.curCommandType=-1,n.curCommandRelative=!1,n.canParseCommandOrComma=!0,n.curNumberHasExp=!1,n.curNumberHasExpDigits=!1,n.curNumberHasDecimal=!1,n.curArgs=[],n}return kt(n,t),n.prototype.finish=function(t){if(void 0===t&&(t=[]),this.parse(" ",t),0!==this.curArgs.length||!this.canParseCommandOrComma)throw new SyntaxError("Unterminated command at the path end.");return t},n.prototype.parse=function(t,n){var e=this;void 0===n&&(n=[]);for(var r=function(t){n.push(t),e.curArgs.length=0,e.canParseCommandOrComma=!0},i=0;i<t.length;i++){var o=t[i],a=!(this.curCommandType!==Ht.ARC||3!==this.curArgs.length&&4!==this.curArgs.length||1!==this.curNumber.length||"0"!==this.curNumber&&"1"!==this.curNumber),u=Ft(o)&&("0"===this.curNumber&&"0"===o||a);if(!Ft(o)||u)if("e"!==o&&"E"!==o)if("-"!==o&&"+"!==o||!this.curNumberHasExp||this.curNumberHasExpDigits)if("."!==o||this.curNumberHasExp||this.curNumberHasDecimal||a){if(this.curNumber&&-1!==this.curCommandType){var c=Number(this.curNumber);if(isNaN(c))throw new SyntaxError("Invalid number ending at "+i);if(this.curCommandType===Ht.ARC)if(0===this.curArgs.length||1===this.curArgs.length){if(0>c)throw new SyntaxError('Expected positive number, got "'+c+'" at index "'+i+'"')}else if((3===this.curArgs.length||4===this.curArgs.length)&&"0"!==this.curNumber&&"1"!==this.curNumber)throw new SyntaxError('Expected a flag, got "'+this.curNumber+'" at index "'+i+'"');this.curArgs.push(c),this.curArgs.length===qt[this.curCommandType]&&(Ht.HORIZ_LINE_TO===this.curCommandType?r({type:Ht.HORIZ_LINE_TO,relative:this.curCommandRelative,x:c}):Ht.VERT_LINE_TO===this.curCommandType?r({type:Ht.VERT_LINE_TO,relative:this.curCommandRelative,y:c}):this.curCommandType===Ht.MOVE_TO||this.curCommandType===Ht.LINE_TO||this.curCommandType===Ht.SMOOTH_QUAD_TO?(r({type:this.curCommandType,relative:this.curCommandRelative,x:this.curArgs[0],y:this.curArgs[1]}),Ht.MOVE_TO===this.curCommandType&&(this.curCommandType=Ht.LINE_TO)):this.curCommandType===Ht.CURVE_TO?r({type:Ht.CURVE_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x2:this.curArgs[2],y2:this.curArgs[3],x:this.curArgs[4],y:this.curArgs[5]}):this.curCommandType===Ht.SMOOTH_CURVE_TO?r({type:Ht.SMOOTH_CURVE_TO,relative:this.curCommandRelative,x2:this.curArgs[0],y2:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===Ht.QUAD_TO?r({type:Ht.QUAD_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===Ht.ARC&&r({type:Ht.ARC,relative:this.curCommandRelative,rX:this.curArgs[0],rY:this.curArgs[1],xRot:this.curArgs[2],lArcFlag:this.curArgs[3],sweepFlag:this.curArgs[4],x:this.curArgs[5],y:this.curArgs[6]})),this.curNumber="",this.curNumberHasExpDigits=!1,this.curNumberHasExp=!1,this.curNumberHasDecimal=!1,this.canParseCommandOrComma=!0}if(!Ut(o))if(","===o&&this.canParseCommandOrComma)this.canParseCommandOrComma=!1;else if("+"!==o&&"-"!==o&&"."!==o)if(u)this.curNumber=o,this.curNumberHasDecimal=!1;else{if(0!==this.curArgs.length)throw new SyntaxError("Unterminated command at index "+i+".");if(!this.canParseCommandOrComma)throw new SyntaxError('Unexpected character "'+o+'" at index '+i+". Command cannot follow comma");if(this.canParseCommandOrComma=!1,"z"!==o&&"Z"!==o)if("h"===o||"H"===o)this.curCommandType=Ht.HORIZ_LINE_TO,this.curCommandRelative="h"===o;else if("v"===o||"V"===o)this.curCommandType=Ht.VERT_LINE_TO,this.curCommandRelative="v"===o;else if("m"===o||"M"===o)this.curCommandType=Ht.MOVE_TO,this.curCommandRelative="m"===o;else if("l"===o||"L"===o)this.curCommandType=Ht.LINE_TO,this.curCommandRelative="l"===o;else if("c"===o||"C"===o)this.curCommandType=Ht.CURVE_TO,this.curCommandRelative="c"===o;else if("s"===o||"S"===o)this.curCommandType=Ht.SMOOTH_CURVE_TO,this.curCommandRelative="s"===o;else if("q"===o||"Q"===o)this.curCommandType=Ht.QUAD_TO,this.curCommandRelative="q"===o;else if("t"===o||"T"===o)this.curCommandType=Ht.SMOOTH_QUAD_TO,this.curCommandRelative="t"===o;else{if("a"!==o&&"A"!==o)throw new SyntaxError('Unexpected character "'+o+'" at index '+i+".");this.curCommandType=Ht.ARC,this.curCommandRelative="a"===o}else n.push({type:Ht.CLOSE_PATH}),this.canParseCommandOrComma=!0,this.curCommandType=-1}else this.curNumber=o,this.curNumberHasDecimal="."===o}else this.curNumber+=o,this.curNumberHasDecimal=!0;else this.curNumber+=o;else this.curNumber+=o,this.curNumberHasExp=!0;else this.curNumber+=o,this.curNumberHasExpDigits=this.curNumberHasExp}return n},n.prototype.transform=function(t){return Object.create(this,{parse:{value:function(n,e){void 0===e&&(e=[]);for(var r=0,i=Object.getPrototypeOf(this).parse.call(this,n);r<i.length;r++){var o=i[r],a=t(o);Array.isArray(a)?e.push.apply(e,a):e.push(a)}return e}}})},n}(Lt),Ht=function(t){function n(e){var r=t.call(this)||this;return r.commands="string"==typeof e?n.parse(e):e,r}return kt(n,t),n.prototype.encode=function(){return n.encode(this.commands)},n.prototype.getBounds=function(){var t=Nt.CALCULATE_BOUNDS();return this.transform(t),t},n.prototype.transform=function(t){for(var n=[],e=0,r=this.commands;e<r.length;e++){var i=t(r[e]);Array.isArray(i)?n.push.apply(n,i):n.push(i)}return this.commands=n,this},n.encode=function(t){return function(t){var n="";Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var r=t[e];if(r.type===Ht.CLOSE_PATH)n+="z";else if(r.type===Ht.HORIZ_LINE_TO)n+=(r.relative?"h":"H")+r.x;else if(r.type===Ht.VERT_LINE_TO)n+=(r.relative?"v":"V")+r.y;else if(r.type===Ht.MOVE_TO)n+=(r.relative?"m":"M")+r.x+" "+r.y;else if(r.type===Ht.LINE_TO)n+=(r.relative?"l":"L")+r.x+" "+r.y;else if(r.type===Ht.CURVE_TO)n+=(r.relative?"c":"C")+r.x1+" "+r.y1+" "+r.x2+" "+r.y2+" "+r.x+" "+r.y;else if(r.type===Ht.SMOOTH_CURVE_TO)n+=(r.relative?"s":"S")+r.x2+" "+r.y2+" "+r.x+" "+r.y;else if(r.type===Ht.QUAD_TO)n+=(r.relative?"q":"Q")+r.x1+" "+r.y1+" "+r.x+" "+r.y;else if(r.type===Ht.SMOOTH_QUAD_TO)n+=(r.relative?"t":"T")+r.x+" "+r.y;else{if(r.type!==Ht.ARC)throw new Error('Unexpected command type "'+r.type+'" at index '+e+".");n+=(r.relative?"a":"A")+r.rX+" "+r.rY+" "+r.xRot+" "+ +r.lArcFlag+" "+ +r.sweepFlag+" "+r.x+" "+r.y}}return n}(t)},n.parse=function(t){var n=new Bt,e=[];return n.parse(t,e),n.finish(e),e},n.CLOSE_PATH=1,n.MOVE_TO=2,n.HORIZ_LINE_TO=4,n.VERT_LINE_TO=8,n.LINE_TO=16,n.CURVE_TO=32,n.SMOOTH_CURVE_TO=64,n.QUAD_TO=128,n.SMOOTH_QUAD_TO=256,n.ARC=512,n.LINE_COMMANDS=n.LINE_TO|n.HORIZ_LINE_TO|n.VERT_LINE_TO,n.DRAWING_COMMANDS=n.HORIZ_LINE_TO|n.VERT_LINE_TO|n.LINE_TO|n.CURVE_TO|n.SMOOTH_CURVE_TO|n.QUAD_TO|n.SMOOTH_QUAD_TO|n.ARC,n}(Lt),qt=((Vt={})[Ht.MOVE_TO]=2,Vt[Ht.LINE_TO]=2,Vt[Ht.HORIZ_LINE_TO]=1,Vt[Ht.VERT_LINE_TO]=1,Vt[Ht.CLOSE_PATH]=0,Vt[Ht.QUAD_TO]=4,Vt[Ht.SMOOTH_QUAD_TO]=2,Vt[Ht.CURVE_TO]=6,Vt[Ht.SMOOTH_CURVE_TO]=4,Vt[Ht.ARC]=7,Vt),Yt=e(82377),Xt=e.n(Yt),$t=e(23895),Wt=e.n($t),Gt=e(18737),Qt=e.n(Gt),Zt=e(36800),Kt=e.n(Zt),Jt=e(20678),tn=e.n(Jt),nn=e(27566),en=e.n(nn),rn=e(59526),on=e.n(rn),an=e(29286),un=e.n(an),cn=e(17349),fn=e.n(cn),sn=e(12625),ln=e.n(sn),hn=e(94235),dn=e.n(hn),pn=e(61240),yn=e.n(pn);function vn(t){return(vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var gn=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],mn=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function bn(t,n,e,r,i){if("string"==typeof t&&(t=document.getElementById(t)),!t||"object"!==vn(t)||!("getContext"in t))throw new TypeError("Expecting canvas with `getContext` method in processCanvasRGB(A) calls!");var o=t.getContext("2d");try{return o.getImageData(n,e,r,i)}catch(t){throw new Error("unable to access image data: "+t)}}function xn(t,n,e,r,i,o){if(!(isNaN(o)||o<1)){o|=0;var a=bn(t,n,e,r,i);a=function(t,n,e,r,i,o){for(var a,u=t.data,c=2*o+1,f=r-1,s=i-1,l=o+1,h=l*(l+1)/2,d=new _n,p=d,y=1;y<c;y++)p=p.next=new _n,y===l&&(a=p);p.next=d;for(var v=null,g=null,m=0,b=0,x=gn[o],_=mn[o],w=0;w<i;w++){p=d;for(var S=u[b],A=u[b+1],M=u[b+2],k=u[b+3],T=0;T<l;T++)p.r=S,p.g=A,p.b=M,p.a=k,p=p.next;for(var E=0,C=0,O=0,P=0,N=l*S,I=l*A,R=l*M,D=l*k,j=h*S,z=h*A,V=h*M,L=h*k,U=1;U<l;U++){var F=b+((f<U?f:U)<<2),B=u[F],H=u[F+1],q=u[F+2],Y=u[F+3],X=l-U;j+=(p.r=B)*X,z+=(p.g=H)*X,V+=(p.b=q)*X,L+=(p.a=Y)*X,E+=B,C+=H,O+=q,P+=Y,p=p.next}v=d,g=a;for(var $=0;$<r;$++){var W=L*x>>_;if(u[b+3]=W,0!==W){var G=255/W;u[b]=(j*x>>_)*G,u[b+1]=(z*x>>_)*G,u[b+2]=(V*x>>_)*G}else u[b]=u[b+1]=u[b+2]=0;j-=N,z-=I,V-=R,L-=D,N-=v.r,I-=v.g,R-=v.b,D-=v.a;var Q=$+o+1;Q=m+(Q<f?Q:f)<<2,j+=E+=v.r=u[Q],z+=C+=v.g=u[Q+1],V+=O+=v.b=u[Q+2],L+=P+=v.a=u[Q+3],v=v.next;var Z=g,K=Z.r,J=Z.g,tt=Z.b,nt=Z.a;N+=K,I+=J,R+=tt,D+=nt,E-=K,C-=J,O-=tt,P-=nt,g=g.next,b+=4}m+=r}for(var et=0;et<r;et++){var rt=u[b=et<<2],it=u[b+1],ot=u[b+2],at=u[b+3],ut=l*rt,ct=l*it,ft=l*ot,st=l*at,lt=h*rt,ht=h*it,dt=h*ot,pt=h*at;p=d;for(var yt=0;yt<l;yt++)p.r=rt,p.g=it,p.b=ot,p.a=at,p=p.next;for(var vt=r,gt=0,mt=0,bt=0,xt=0,_t=1;_t<=o;_t++){b=vt+et<<2;var wt=l-_t;lt+=(p.r=rt=u[b])*wt,ht+=(p.g=it=u[b+1])*wt,dt+=(p.b=ot=u[b+2])*wt,pt+=(p.a=at=u[b+3])*wt,xt+=rt,gt+=it,mt+=ot,bt+=at,p=p.next,_t<s&&(vt+=r)}b=et,v=d,g=a;for(var St=0;St<i;St++){var At=b<<2;u[At+3]=at=pt*x>>_,at>0?(at=255/at,u[At]=(lt*x>>_)*at,u[At+1]=(ht*x>>_)*at,u[At+2]=(dt*x>>_)*at):u[At]=u[At+1]=u[At+2]=0,lt-=ut,ht-=ct,dt-=ft,pt-=st,ut-=v.r,ct-=v.g,ft-=v.b,st-=v.a,At=et+((At=St+l)<s?At:s)*r<<2,lt+=xt+=v.r=u[At],ht+=gt+=v.g=u[At+1],dt+=mt+=v.b=u[At+2],pt+=bt+=v.a=u[At+3],v=v.next,ut+=rt=g.r,ct+=it=g.g,ft+=ot=g.b,st+=at=g.a,xt-=rt,gt-=it,mt-=ot,bt-=at,g=g.next,b+=r}}return t}(a,0,0,r,i,o),t.getContext("2d").putImageData(a,n,e)}}var _n=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null};function wn(t){return t.replace(/(?!\u3000)\s+/gm," ")}function Sn(t){return t.replace(/^[\n \t]+/,"")}function An(t){return t.replace(/[\n \t]+$/,"")}function Mn(t){var n=(t||"").match(/-?(\d+(?:\.\d*(?:[eE][+-]?\d+)?)?|\.\d+)(?=\D|$)/gm)||[];return c()(n).call(n,a())}var kn=/^[A-Z-]+$/;function Tn(t){return kn.test(t)?t.toLowerCase():t}function En(t){var n=t.match(/url\(('([^']+)'|"([^"]+)"|([^'"\)]+))\)/)||[];return n[2]||n[3]||n[4]}function Cn(t){if(!i()(t).call(t,"rgb"))return t;var n=3;return t.replace(/\d+(\.\d+)?/g,(function(t,e){return n--&&e?String(Math.round(a()(t))):t}))}var On=/(\[[^\]]+\])/g,Pn=/(#[^\s\+>~\.\[:]+)/g,Nn=/(\.[^\s\+>~\.\[:]+)/g,In=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,Rn=/(:[\w-]+\([^\)]*\))/gi,Dn=/(:[^\s\+>~\.\[:]+)/g,jn=/([^\s\+>~\.\[:]+)/g;function zn(t,n){var e=t.match(n);return e?[t.replace(n," "),e.length]:[t,0]}function Vn(t){var n=[0,0,0],e=t.replace(/:not\(([^\)]*)\)/g,"     $1 ").replace(/{[\s\S]*/gm," "),r=0,i=zn(e,On),o=s()(i,2);e=o[0],r=o[1],n[1]+=r;var a=zn(e,Pn),u=s()(a,2);e=u[0],r=u[1],n[0]+=r;var c=zn(e,Nn),f=s()(c,2);e=f[0],r=f[1],n[1]+=r;var l=zn(e,In),h=s()(l,2);e=h[0],r=h[1],n[2]+=r;var d=zn(e,Rn),p=s()(d,2);e=p[0],r=p[1],n[1]+=r;var y=zn(e,Dn),v=s()(y,2);e=v[0],r=v[1],n[1]+=r;var g=zn(e=e.replace(/[\*\s\+>~]/g," ").replace(/[#\.]/g," "),jn),m=s()(g,2);return e=m[0],r=m[1],n[2]+=r,n.join("")}var Ln=1e-8;function Un(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))}function Fn(t,n){return(t[0]*n[0]+t[1]*n[1])/(Un(t)*Un(n))}function Bn(t,n){return(t[0]*n[1]<t[1]*n[0]?-1:1)*Math.acos(Fn(t,n))}function Hn(t){return t*t*t}function qn(t){return 3*t*t*(1-t)}function Yn(t){return 3*t*(1-t)*(1-t)}function Xn(t){return(1-t)*(1-t)*(1-t)}function $n(t){return t*t}function Wn(t){return 2*t*(1-t)}function Gn(t){return(1-t)*(1-t)}var Qn=function(){function t(n,e,r){R()(this,t),this.document=n,this.name=e,this.value=r,this.isNormalizedColor=!1}return j()(t,[{key:"split",value:function(){var n,e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:" ",i=this.document,o=this.name;return c()(n=K()(e=wn(this.getString())).call(e).split(r)).call(n,(function(n){return new t(i,o,n)}))}},{key:"hasValue",value:function(t){var n=this.value;return null!==n&&""!==n&&(t||0!==n)&&void 0!==n}},{key:"isString",value:function(t){var n=this.value,e="string"==typeof n;return e&&t?t.test(n):e}},{key:"isUrlDefinition",value:function(){return this.isString(/^url\(/)}},{key:"isPixels",value:function(){if(!this.hasValue())return!1;var t=this.getString();switch(!0){case/px$/.test(t):case/^[0-9]+$/.test(t):return!0;default:return!1}}},{key:"setValue",value:function(t){return this.value=t,this}},{key:"getValue",value:function(t){return void 0===t||this.hasValue()?this.value:t}},{key:"getNumber",value:function(t){if(!this.hasValue())return void 0===t?0:a()(t);var n=this.value,e=a()(n);return this.isString(/%$/)&&(e/=100),e}},{key:"getString",value:function(t){return void 0===t||this.hasValue()?void 0===this.value?"":String(this.value):String(t)}},{key:"getColor",value:function(t){var n=this.getString(t);return this.isNormalizedColor||(this.isNormalizedColor=!0,n=Cn(n),this.value=n),n}},{key:"getDpi",value:function(){return 96}},{key:"getRem",value:function(){return this.document.rootEmSize}},{key:"getEm",value:function(){return this.document.emSize}},{key:"getUnits",value:function(){return this.getString().replace(/[0-9\.\-]/g,"")}},{key:"getPixels",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.hasValue())return 0;var e="boolean"==typeof t?[void 0,t]:[t],r=s()(e,2),i=r[0],o=r[1],a=this.document.screen.viewPort;switch(!0){case this.isString(/vmin$/):return this.getNumber()/100*Math.min(a.computeSize("x"),a.computeSize("y"));case this.isString(/vmax$/):return this.getNumber()/100*Math.max(a.computeSize("x"),a.computeSize("y"));case this.isString(/vw$/):return this.getNumber()/100*a.computeSize("x");case this.isString(/vh$/):return this.getNumber()/100*a.computeSize("y");case this.isString(/rem$/):return this.getNumber()*this.getRem();case this.isString(/em$/):return this.getNumber()*this.getEm();case this.isString(/ex$/):return this.getNumber()*this.getEm()/2;case this.isString(/px$/):return this.getNumber();case this.isString(/pt$/):return this.getNumber()*this.getDpi()*(1/72);case this.isString(/pc$/):return 15*this.getNumber();case this.isString(/cm$/):return this.getNumber()*this.getDpi()/2.54;case this.isString(/mm$/):return this.getNumber()*this.getDpi()/25.4;case this.isString(/in$/):return this.getNumber()*this.getDpi();case this.isString(/%$/)&&o:return this.getNumber()*this.getEm();case this.isString(/%$/):return this.getNumber()*a.computeSize(i);default:var u=this.getNumber();return n&&u<1?u*a.computeSize(i):u}}},{key:"getMilliseconds",value:function(){return this.hasValue()?this.isString(/ms$/)?this.getNumber():1e3*this.getNumber():0}},{key:"getRadians",value:function(){if(!this.hasValue())return 0;switch(!0){case this.isString(/deg$/):return this.getNumber()*(Math.PI/180);case this.isString(/grad$/):return this.getNumber()*(Math.PI/200);case this.isString(/rad$/):return this.getNumber();default:return this.getNumber()*(Math.PI/180)}}},{key:"getDefinition",value:function(){var t=this.getString(),n=t.match(/#([^\)'"]+)/);return n&&(n=n[1]),n||(n=t),this.document.definitions[n]}},{key:"getFillStyleDefinition",value:function(t,n){var e=this.getDefinition();if(!e)return null;if("function"==typeof e.createGradient)return e.createGradient(this.document.ctx,t,n);if("function"==typeof e.createPattern){if(e.getHrefAttribute().hasValue()){var r=e.getAttribute("patternTransform");e=e.getHrefAttribute().getDefinition(),r.hasValue()&&e.getAttribute("patternTransform",!0).setValue(r.value)}return e.createPattern(this.document.ctx,t,n)}return null}},{key:"getTextBaseline",value:function(){return this.hasValue()?t.textBaselineMapping[this.getString()]:null}},{key:"addOpacity",value:function(n){for(var e=this.getColor(),r=e.length,i=0,o=0;o<r&&(","===e[o]&&i++,3!==i);o++);if(n.hasValue()&&this.isString()&&3!==i){var a=new(tt())(e);a.ok&&(a.alpha=n.getNumber(),e=a.toRGBA())}return new t(this.document,this.name,e)}}],[{key:"empty",value:function(n){return new t(n,"EMPTY","")}}]),t}();Qn.textBaselineMapping={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};var Zn=function(){function t(){R()(this,t),this.viewPorts=[]}return j()(t,[{key:"clear",value:function(){this.viewPorts=[]}},{key:"setCurrent",value:function(t,n){this.viewPorts.push({width:t,height:n})}},{key:"removeCurrent",value:function(){this.viewPorts.pop()}},{key:"getCurrent",value:function(){var t=this.viewPorts;return t[t.length-1]}},{key:"computeSize",value:function(t){return"number"==typeof t?t:"x"===t?this.width:"y"===t?this.height:Math.sqrt(Math.pow(this.width,2)+Math.pow(this.height,2))/Math.sqrt(2)}},{key:"width",get:function(){return this.getCurrent().width}},{key:"height",get:function(){return this.getCurrent().height}}]),t}(),Kn=function(){function t(n,e){R()(this,t),this.x=n,this.y=e}return j()(t,[{key:"angleTo",value:function(t){return Math.atan2(t.y-this.y,t.x-this.x)}},{key:"applyTransform",value:function(t){var n=this.x,e=this.y,r=n*t[0]+e*t[2]+t[4],i=n*t[1]+e*t[3]+t[5];this.x=r,this.y=i}}],[{key:"parse",value:function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=Mn(n),i=s()(r,2),o=i[0],a=void 0===o?e:o,u=i[1],c=void 0===u?e:u;return new t(a,c)}},{key:"parseScale",value:function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=Mn(n),i=s()(r,2),o=i[0],a=void 0===o?e:o,u=i[1],c=void 0===u?a:u;return new t(a,c)}},{key:"parsePath",value:function(n){for(var e=Mn(n),r=e.length,i=[],o=0;o<r;o+=2)i.push(new t(e[o],e[o+1]));return i}}]),t}(),Jn=function(){function t(n){var e,r;R()(this,t),this.screen=n,this.working=!1,this.events=[],this.eventElements=[],this.onClick=W()(e=this.onClick).call(e,this),this.onMouseMove=W()(r=this.onMouseMove).call(r,this)}return j()(t,[{key:"isWorking",value:function(){return this.working}},{key:"start",value:function(){if(!this.working){var t=this.screen,n=this.onClick,e=this.onMouseMove,r=t.ctx.canvas;r.onclick=n,r.onmousemove=e,this.working=!0}}},{key:"stop",value:function(){if(this.working){var t=this.screen.ctx.canvas;this.working=!1,t.onclick=null,t.onmousemove=null}}},{key:"hasEvents",value:function(){return this.working&&this.events.length>0}},{key:"runEvents",value:function(){if(this.working){var t=this.screen,n=this.events,e=this.eventElements,r=t.ctx.canvas.style;r&&(r.cursor=""),m()(n).call(n,(function(t,n){for(var r=t.run,i=e[n];i;)r(i),i=i.parent})),this.events=[],this.eventElements=[]}}},{key:"checkPath",value:function(t,n){if(this.working&&n){var e=this.events,r=this.eventElements;m()(e).call(e,(function(e,i){var o=e.x,a=e.y;!r[i]&&n.isPointInPath&&n.isPointInPath(o,a)&&(r[i]=t)}))}}},{key:"checkBoundingBox",value:function(t,n){if(this.working&&n){var e=this.events,r=this.eventElements;m()(e).call(e,(function(e,i){var o=e.x,a=e.y;!r[i]&&n.isPointInBox(o,a)&&(r[i]=t)}))}}},{key:"mapXY",value:function(t,n){for(var e=this.screen,r=e.window,i=e.ctx,o=new Kn(t,n),a=i.canvas;a;)o.x-=a.offsetLeft,o.y-=a.offsetTop,a=a.offsetParent;return r.scrollX&&(o.x+=r.scrollX),r.scrollY&&(o.y+=r.scrollY),o}},{key:"onClick",value:function(t){var n=this.mapXY((t||event).clientX,(t||event).clientY),e=n.x,r=n.y;this.events.push({type:"onclick",x:e,y:r,run:function(t){t.onClick&&t.onClick()}})}},{key:"onMouseMove",value:function(t){var n=this.mapXY((t||event).clientX,(t||event).clientY),e=n.x,r=n.y;this.events.push({type:"onmousemove",x:e,y:r,run:function(t){t.onMouseMove&&t.onMouseMove()}})}}]),t}(),te="undefined"!=typeof window?window:null,ne="undefined"!=typeof fetch?W()(fetch).call(fetch,void 0):null,ee=function(){function t(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.fetch,i=void 0===r?ne:r,o=e.window,a=void 0===o?te:o;R()(this,t),this.ctx=n,this.FRAMERATE=30,this.MAX_VIRTUAL_PIXELS=3e4,this.CLIENT_WIDTH=800,this.CLIENT_HEIGHT=600,this.viewPort=new Zn,this.mouse=new Jn(this),this.animations=[],this.waits=[],this.frameDuration=0,this.isReadyLock=!1,this.isFirstRender=!0,this.intervalId=null,this.window=a,this.fetch=i}return j()(t,[{key:"wait",value:function(t){this.waits.push(t)}},{key:"ready",value:function(){return this.readyPromise?this.readyPromise:X().resolve()}},{key:"isReady",value:function(){var t;if(this.isReadyLock)return!0;var n=q()(t=this.waits).call(t,(function(t){return t()}));return n&&(this.waits=[],this.resolveReady&&this.resolveReady()),this.isReadyLock=n,n}},{key:"setDefaults",value:function(t){t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4}},{key:"setViewBox",value:function(t){var n=t.document,e=t.ctx,r=t.aspectRatio,i=t.width,o=t.desiredWidth,a=t.height,u=t.desiredHeight,c=t.minX,f=void 0===c?0:c,l=t.minY,h=void 0===l?0:l,d=t.refX,p=t.refY,y=t.clip,v=void 0!==y&&y,g=t.clipX,m=void 0===g?0:g,b=t.clipY,x=void 0===b?0:b,_=wn(r).replace(/^defer\s/,"").split(" "),w=s()(_,2),S=w[0]||"xMidYMid",A=w[1]||"meet",M=i/o,k=a/u,T=Math.min(M,k),E=Math.max(M,k),C=o,O=u;"meet"===A&&(C*=T,O*=T),"slice"===A&&(C*=E,O*=E);var P=new Qn(n,"refX",d),N=new Qn(n,"refY",p),I=P.hasValue()&&N.hasValue();if(I&&e.translate(-T*P.getPixels("x"),-T*N.getPixels("y")),v){var R=T*m,D=T*x;e.beginPath(),e.moveTo(R,D),e.lineTo(i,D),e.lineTo(i,a),e.lineTo(R,a),e.closePath(),e.clip()}if(!I){var j="meet"===A&&T===k,z="slice"===A&&E===k,V="meet"===A&&T===M,L="slice"===A&&E===M;/^xMid/.test(S)&&(j||z)&&e.translate(i/2-C/2,0),/YMid$/.test(S)&&(V||L)&&e.translate(0,a/2-O/2),/^xMax/.test(S)&&(j||z)&&e.translate(i-C,0),/YMax$/.test(S)&&(V||L)&&e.translate(0,a-O)}switch(!0){case"none"===S:e.scale(M,k);break;case"meet"===A:e.scale(T,T);break;case"slice"===A:e.scale(E,E)}e.translate(-f,-h)}},{key:"start",value:function(t){var n=this,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.enableRedraw,i=void 0!==r&&r,o=e.ignoreMouse,a=void 0!==o&&o,u=e.ignoreAnimation,c=void 0!==u&&u,f=e.ignoreDimensions,s=void 0!==f&&f,l=e.ignoreClear,h=void 0!==l&&l,d=e.forceRedraw,p=e.scaleWidth,y=e.scaleHeight,v=e.offsetX,g=e.offsetY,m=this.FRAMERATE,b=this.mouse,x=1e3/m;if(this.frameDuration=x,this.readyPromise=new(X())((function(t){n.resolveReady=t})),this.isReady()&&this.render(t,s,h,p,y,v,g),i){var _=B()(),w=_,S=0,A=function e(){_=B()(),(S=_-w)>=x&&(w=_-S%x,n.shouldUpdate(c,d)&&(n.render(t,s,h,p,y,v,g),b.runEvents())),n.intervalId=Q()(e)};a||b.start(),this.intervalId=Q()(A)}}},{key:"stop",value:function(){this.intervalId&&(Q().cancel(this.intervalId),this.intervalId=null),this.mouse.stop()}},{key:"shouldUpdate",value:function(t,n){if(!t){var e,r=this.frameDuration,i=U()(e=this.animations).call(e,(function(t,n){return n.update(r)||t}),!1);if(i)return!0}return!("function"!=typeof n||!n())||(!(this.isReadyLock||!this.isReady())||!!this.mouse.hasEvents())}},{key:"render",value:function(t,n,e,r,i,o,a){var u=this.CLIENT_WIDTH,c=this.CLIENT_HEIGHT,f=this.viewPort,s=this.ctx,l=this.isFirstRender,h=s.canvas;f.clear(),h.width&&h.height?f.setCurrent(h.width,h.height):f.setCurrent(u,c);var d=t.getStyle("width"),p=t.getStyle("height");!n&&(l||"number"!=typeof r&&"number"!=typeof i)&&(d.hasValue()&&(h.width=d.getPixels("x"),h.style&&(h.style.width="".concat(h.width,"px"))),p.hasValue()&&(h.height=p.getPixels("y"),h.style&&(h.style.height="".concat(h.height,"px"))));var y=h.clientWidth||h.width,v=h.clientHeight||h.height;if(n&&d.hasValue()&&p.hasValue()&&(y=d.getPixels("x"),v=p.getPixels("y")),f.setCurrent(y,v),"number"==typeof o&&t.getAttribute("x",!0).setValue(o),"number"==typeof a&&t.getAttribute("y",!0).setValue(a),"number"==typeof r||"number"==typeof i){var g,m,b=Mn(t.getAttribute("viewBox").getString()),x=0,_=0;if("number"==typeof r){var w=t.getStyle("width");w.hasValue()?x=w.getPixels("x")/r:isNaN(b[2])||(x=b[2]/r)}if("number"==typeof i){var S=t.getStyle("height");S.hasValue()?_=S.getPixels("y")/i:isNaN(b[3])||(_=b[3]/i)}x||(x=_),_||(_=x),t.getAttribute("width",!0).setValue(r),t.getAttribute("height",!0).setValue(i);var A=t.getStyle("transform",!0,!0);A.setValue(V()(g=V()(m="".concat(A.getString()," scale(")).call(m,1/x,", ")).call(g,1/_,")"))}e||s.clearRect(0,0,y,v),t.render(s),l&&(this.isFirstRender=!1)}}]),t}();ee.defaultWindow=te,ee.defaultFetch=ne;var re=ee.defaultFetch,ie="undefined"!=typeof DOMParser?DOMParser:null,oe=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=n.fetch,r=void 0===e?re:e,i=n.DOMParser,o=void 0===i?ie:i;R()(this,t),this.fetch=r,this.DOMParser=o}var n,e;return j()(t,[{key:"parse",value:(e=O()(E().mark((function t(n){return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!/^</.test(n)){t.next=2;break}return t.abrupt("return",this.parseFromString(n));case 2:return t.abrupt("return",this.load(n));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"parseFromString",value:function(t){var n=new this.DOMParser;try{return this.checkDocument(n.parseFromString(t,"image/svg+xml"))}catch(e){return this.checkDocument(n.parseFromString(t,"text/xml"))}}},{key:"checkDocument",value:function(t){var n=t.getElementsByTagName("parsererror")[0];if(n)throw new Error(n.textContent);return t}},{key:"load",value:(n=O()(E().mark((function t(n){var e,r;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fetch(n);case 2:return e=t.sent,t.next=5,e.text();case 5:return r=t.sent,t.abrupt("return",this.parseFromString(r));case 7:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})}]),t}(),ae=function(){function t(n,e){R()(this,t),this.type="translate",this.point=null,this.point=Kn.parse(e)}return j()(t,[{key:"apply",value:function(t){var n=this.point,e=n.x,r=n.y;t.translate(e||0,r||0)}},{key:"unapply",value:function(t){var n=this.point,e=n.x,r=n.y;t.translate(-1*e||0,-1*r||0)}},{key:"applyToPoint",value:function(t){var n=this.point,e=n.x,r=n.y;t.applyTransform([1,0,0,1,e||0,r||0])}}]),t}(),ue=function(){function t(n,e,r){R()(this,t),this.type="rotate",this.angle=null,this.originX=null,this.originY=null,this.cx=0,this.cy=0;var i=Mn(e);this.angle=new Qn(n,"angle",i[0]),this.originX=r[0],this.originY=r[1],this.cx=i[1]||0,this.cy=i[2]||0}return j()(t,[{key:"apply",value:function(t){var n=this.cx,e=this.cy,r=this.originX,i=this.originY,o=this.angle,a=n+r.getPixels("x"),u=e+i.getPixels("y");t.translate(a,u),t.rotate(o.getRadians()),t.translate(-a,-u)}},{key:"unapply",value:function(t){var n=this.cx,e=this.cy,r=this.angle;t.translate(n,e),t.rotate(-1*r.getRadians()),t.translate(-n,-e)}},{key:"applyToPoint",value:function(t){var n=this.cx,e=this.cy,r=this.angle.getRadians();t.applyTransform([1,0,0,1,n||0,e||0]),t.applyTransform([Math.cos(r),Math.sin(r),-Math.sin(r),Math.cos(r),0,0]),t.applyTransform([1,0,0,1,-n||0,-e||0])}}]),t}(),ce=function(){function t(n,e){R()(this,t),this.type="scale",this.scale=null;var r=Kn.parseScale(e);0!==r.x&&0!==r.y||(r.x=Ln,r.y=Ln),this.scale=r}return j()(t,[{key:"apply",value:function(t){var n=this.scale,e=n.x,r=n.y;t.scale(e,r||e)}},{key:"unapply",value:function(t){var n=this.scale,e=n.x,r=n.y;t.scale(1/e,1/r||e)}},{key:"applyToPoint",value:function(t){var n=this.scale,e=n.x,r=n.y;t.applyTransform([e||0,0,0,r||0,0,0])}}]),t}(),fe=function(){function t(n,e){R()(this,t),this.type="matrix",this.matrix=[],this.matrix=Mn(e)}return j()(t,[{key:"apply",value:function(t){var n=this.matrix;t.transform(n[0],n[1],n[2],n[3],n[4],n[5])}},{key:"unapply",value:function(t){var n=this.matrix,e=n[0],r=n[2],i=n[4],o=n[1],a=n[3],u=n[5],c=1/(e*(1*a-0*u)-r*(1*o-0*u)+i*(0*o-0*a));t.transform(c*(1*a-0*u),c*(0*u-1*o),c*(0*i-1*r),c*(1*e-0*i),c*(r*u-i*a),c*(i*o-e*u))}},{key:"applyToPoint",value:function(t){t.applyTransform(this.matrix)}}]),t}();function se(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var le=function(t){it()(e,t);var n=se(e);function e(t,r){var i;return R()(this,e),(i=n.call(this,t,r)).type="skew",i.angle=null,i.angle=new Qn(t,"angle",r),i}return e}(fe);function he(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var de=function(t){it()(e,t);var n=he(e);function e(t,r){var i;return R()(this,e),(i=n.call(this,t,r)).type="skewX",i.matrix=[1,0,Math.tan(i.angle.getRadians()),1,0,0],i}return e}(le);function pe(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var ye=function(t){it()(e,t);var n=pe(e);function e(t,r){var i;return R()(this,e),(i=n.call(this,t,r)).type="skewY",i.matrix=[1,Math.tan(i.angle.getRadians()),0,1,0,0],i}return e}(le);var ve=function(){function t(n,e,r){var i=this;R()(this,t),this.document=n,this.transforms=[];var o=function(t){var n;return K()(n=wn(t)).call(n).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/)}(e);m()(o).call(o,(function(n){if("none"!==n){var e=function(t){var n=t.split("("),e=s()(n,2),r=e[0],i=e[1];return[K()(r).call(r),K()(i).call(i).replace(")","")]}(n),o=s()(e,2),a=o[0],u=o[1],c=t.transformTypes[a];void 0!==c&&i.transforms.push(new c(i.document,u,r))}}))}return j()(t,[{key:"apply",value:function(t){for(var n=this.transforms,e=n.length,r=0;r<e;r++)n[r].apply(t)}},{key:"unapply",value:function(t){for(var n=this.transforms,e=n.length-1;e>=0;e--)n[e].unapply(t)}},{key:"applyToPoint",value:function(t){for(var n=this.transforms,e=n.length,r=0;r<e;r++)n[r].applyToPoint(t)}}],[{key:"fromElement",value:function(n,e){var r=e.getStyle("transform",!1,!0),i=e.getStyle("transform-origin",!1,!0).split(),o=s()(i,2),a=o[0],u=o[1],c=[a,void 0===u?a:u];return r.hasValue()?new t(n,r.getString(),c):null}}]),t}();ve.transformTypes={translate:ae,rotate:ue,scale:ce,matrix:fe,skewX:de,skewY:ye};var ge=function(){function t(n,e){var r,i,o=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(R()(this,t),this.document=n,this.node=e,this.captureTextNodes=a,this.attributes={},this.styles={},this.stylesSpecificity={},this.animationFrozen=!1,this.animationFrozenValue="",this.parent=null,this.children=[],e&&1===e.nodeType){if(m()(r=vt()(e.attributes)).call(r,(function(t){var e=Tn(t.nodeName);o.attributes[e]=new Qn(n,e,t.value)})),this.addStylesFromStyleDefinition(),this.getAttribute("style").hasValue()){var u,f=c()(u=this.getAttribute("style").getString().split(";")).call(u,(function(t){return K()(t).call(t)}));m()(f).call(f,(function(t){var e;if(t){var r=c()(e=t.split(":")).call(e,(function(t){return K()(t).call(t)})),i=s()(r,2),a=i[0],u=i[1];o.styles[a]=new Qn(n,a,u)}}))}var l=n.definitions,h=this.getAttribute("id");h.hasValue()&&(l[h.getValue()]||(l[h.getValue()]=this)),m()(i=vt()(e.childNodes)).call(i,(function(t){if(1===t.nodeType)o.addChild(t);else if(a&&(3===t.nodeType||4===t.nodeType)){var e=n.createTextNode(t);e.getText().length>0&&o.addChild(e)}}))}}return j()(t,[{key:"getAttribute",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],e=this.attributes[t];if(!e&&n){var r=new Qn(this.document,t,"");return this.attributes[t]=r,r}return e||Qn.empty(this.document)}},{key:"getHrefAttribute",value:function(){for(var t in this.attributes)if("href"===t||/:href$/.test(t))return this.attributes[t];return Qn.empty(this.document)}},{key:"getStyle",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.styles[t];if(r)return r;var i=this.getAttribute(t);if(i&&i.hasValue())return this.styles[t]=i,i;if(!e){var o=this.parent;if(o){var a=o.getStyle(t);if(a&&a.hasValue())return a}}if(n){var u=new Qn(this.document,t,"");return this.styles[t]=u,u}return r||Qn.empty(this.document)}},{key:"render",value:function(t){if("none"!==this.getStyle("display").getString()&&"hidden"!==this.getStyle("visibility").getString()){if(t.save(),this.getStyle("mask").hasValue()){var n=this.getStyle("mask").getDefinition();n&&(this.applyEffects(t),n.apply(t,this))}else if("none"!==this.getStyle("filter").getValue("none")){var e=this.getStyle("filter").getDefinition();e&&(this.applyEffects(t),e.apply(t,this))}else this.setContext(t),this.renderChildren(t),this.clearContext(t);t.restore()}}},{key:"setContext",value:function(t){}},{key:"applyEffects",value:function(t){var n=ve.fromElement(this.document,this);n&&n.apply(t);var e=this.getStyle("clip-path",!1,!0);if(e.hasValue()){var r=e.getDefinition();r&&r.apply(t)}}},{key:"clearContext",value:function(t){}},{key:"renderChildren",value:function(t){var n;m()(n=this.children).call(n,(function(n){n.render(t)}))}},{key:"addChild",value:function(n){var e,r=n instanceof t?n:this.document.createElement(n);r.parent=this,pt()(e=t.ignoreChildTypes).call(e,r.type)||this.children.push(r)}},{key:"matchesSelector",value:function(t){var n,e=this.node;if("function"==typeof e.matches)return e.matches(t);var r=e.getAttribute("class");return!(!r||""===r)&&ht()(n=r.split(" ")).call(n,(function(n){if(".".concat(n)===t)return!0}))}},{key:"addStylesFromStyleDefinition",value:function(){var t=this.document,n=t.styles,e=t.stylesSpecificity;for(var r in n)if("@"!==r[0]&&this.matchesSelector(r)){var i=n[r],o=e[r];if(i)for(var a in i){var u=this.stylesSpecificity[a];void 0===u&&(u="000"),o>=u&&(this.styles[a]=i[a],this.stylesSpecificity[a]=o)}}}},{key:"removeStyles",value:function(t,n){return U()(n).call(n,(function(n,e){var r,i=t.getStyle(e);if(!i.hasValue())return n;var o=i.getString();return i.setValue(""),V()(r=[]).call(r,st()(n),[[e,o]])}),[])}},{key:"restoreStyles",value:function(t,n){m()(n).call(n,(function(n){var e=s()(n,2),r=e[0],i=e[1];t.getStyle(r,!0).setValue(i)}))}}]),t}();function me(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}ge.ignoreChildTypes=["title"];var be=function(t){it()(e,t);var n=me(e);function e(t,r,i){return R()(this,e),n.call(this,t,r,i)}return e}(ge);function xe(t){var n=K()(t).call(t);return/^('|")/.test(n)?n:'"'.concat(n,'"')}function _e(t){if(!t)return"";var n=K()(t).call(t).toLowerCase();switch(n){case"normal":case"italic":case"oblique":case"inherit":case"initial":case"unset":return n;default:return/^oblique\s+(-|)\d+deg$/.test(n)?n:""}}function we(t){if(!t)return"";var n=K()(t).call(t).toLowerCase();switch(n){case"normal":case"bold":case"lighter":case"bolder":case"inherit":case"initial":case"unset":return n;default:return/^[\d.]+$/.test(n)?n:""}}var Se=function(){function t(n,e,r,i,o,a){R()(this,t);var u=a?"string"==typeof a?t.parse(a):a:{};this.fontFamily=o||u.fontFamily,this.fontSize=i||u.fontSize,this.fontStyle=n||u.fontStyle,this.fontWeight=r||u.fontWeight,this.fontVariant=e||u.fontVariant}return j()(t,[{key:"toString",value:function(){var t,n,e;return K()(t=[_e(this.fontStyle),this.fontVariant,we(this.fontWeight),this.fontSize,(n=this.fontFamily,"undefined"==typeof process?n:c()(e=K()(n).call(n).split(",")).call(e,xe).join(","))].join(" ")).call(t)}}],[{key:"parse",value:function(){var n,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1?arguments[1]:void 0,i="",o="",a="",u="",c="",f=K()(n=wn(e)).call(n).split(" "),l={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1};return m()(f).call(f,(function(n){var e,r,f;switch(!0){case!l.fontStyle&&pt()(e=t.styles).call(e,n):"inherit"!==n&&(i=n),l.fontStyle=!0;break;case!l.fontVariant&&pt()(r=t.variants).call(r,n):"inherit"!==n&&(o=n),l.fontStyle=!0,l.fontVariant=!0;break;case!l.fontWeight&&pt()(f=t.weights).call(f,n):"inherit"!==n&&(a=n),l.fontStyle=!0,l.fontVariant=!0,l.fontWeight=!0;break;case!l.fontSize:if("inherit"!==n){var h=n.split("/"),d=s()(h,1);u=d[0]}l.fontStyle=!0,l.fontVariant=!0,l.fontWeight=!0,l.fontSize=!0;break;default:"inherit"!==n&&(c+=n)}})),new t(i,o,a,u,c,r)}}]),t}();Se.styles="normal|italic|oblique|inherit",Se.variants="normal|small-caps|inherit",Se.weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit";var Ae=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.NaN,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.NaN,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.NaN,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Number.NaN;R()(this,t),this.x1=n,this.y1=e,this.x2=r,this.y2=i,this.addPoint(n,e),this.addPoint(r,i)}return j()(t,[{key:"addPoint",value:function(t,n){void 0!==t&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),void 0!==n&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=n,this.y2=n),n<this.y1&&(this.y1=n),n>this.y2&&(this.y2=n))}},{key:"addX",value:function(t){this.addPoint(t,null)}},{key:"addY",value:function(t){this.addPoint(null,t)}},{key:"addBoundingBox",value:function(t){if(t){var n=t.x1,e=t.y1,r=t.x2,i=t.y2;this.addPoint(n,e),this.addPoint(r,i)}}},{key:"sumCubic",value:function(t,n,e,r,i){return Math.pow(1-t,3)*n+3*Math.pow(1-t,2)*t*e+3*(1-t)*Math.pow(t,2)*r+Math.pow(t,3)*i}},{key:"bezierCurveAdd",value:function(t,n,e,r,i){var o=6*n-12*e+6*r,a=-3*n+9*e-9*r+3*i,u=3*e-3*n;if(0!==a){var c=Math.pow(o,2)-4*u*a;if(!(c<0)){var f=(-o+Math.sqrt(c))/(2*a);0<f&&f<1&&(t?this.addX(this.sumCubic(f,n,e,r,i)):this.addY(this.sumCubic(f,n,e,r,i)));var s=(-o-Math.sqrt(c))/(2*a);0<s&&s<1&&(t?this.addX(this.sumCubic(s,n,e,r,i)):this.addY(this.sumCubic(s,n,e,r,i)))}}else{if(0===o)return;var l=-u/o;0<l&&l<1&&(t?this.addX(this.sumCubic(l,n,e,r,i)):this.addY(this.sumCubic(l,n,e,r,i)))}}},{key:"addBezierCurve",value:function(t,n,e,r,i,o,a,u){this.addPoint(t,n),this.addPoint(a,u),this.bezierCurveAdd(!0,t,e,i,a),this.bezierCurveAdd(!1,n,r,o,u)}},{key:"addQuadraticCurve",value:function(t,n,e,r,i,o){var a=t+2/3*(e-t),u=n+2/3*(r-n),c=a+1/3*(i-t),f=u+1/3*(o-n);this.addBezierCurve(t,n,a,c,u,f,i,o)}},{key:"isPointInBox",value:function(t,n){var e=this.x1,r=this.y1,i=this.x2,o=this.y2;return e<=t&&t<=i&&r<=n&&n<=o}},{key:"x",get:function(){return this.x1}},{key:"y",get:function(){return this.y1}},{key:"width",get:function(){return this.x2-this.x1}},{key:"height",get:function(){return this.y2-this.y1}}]),t}();function Me(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var ke=function(t){it()(e,t);var n=Me(e);function e(){var t;return R()(this,e),(t=n.apply(this,arguments)).modifiedEmSizeStack=!1,t}return j()(e,[{key:"calculateOpacity",value:function(){for(var t=1,n=this;n;){var e=n.getStyle("opacity",!1,!0);e.hasValue(!0)&&(t*=e.getNumber()),n=n.parent}return t}},{key:"setContext",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!n){var e=this.getStyle("fill"),r=this.getStyle("fill-opacity"),i=this.getStyle("stroke"),o=this.getStyle("stroke-opacity");if(e.isUrlDefinition()){var a=e.getFillStyleDefinition(this,r);a&&(t.fillStyle=a)}else if(e.hasValue()){"currentColor"===e.getString()&&e.setValue(this.getStyle("color").getColor());var u=e.getColor();"inherit"!==u&&(t.fillStyle="none"===u?"rgba(0,0,0,0)":u)}if(r.hasValue()){var c=new Qn(this.document,"fill",t.fillStyle).addOpacity(r).getColor();t.fillStyle=c}if(i.isUrlDefinition()){var f=i.getFillStyleDefinition(this,o);f&&(t.strokeStyle=f)}else if(i.hasValue()){"currentColor"===i.getString()&&i.setValue(this.getStyle("color").getColor());var s=i.getString();"inherit"!==s&&(t.strokeStyle="none"===s?"rgba(0,0,0,0)":s)}if(o.hasValue()){var l=new Qn(this.document,"stroke",t.strokeStyle).addOpacity(o).getString();t.strokeStyle=l}var h=this.getStyle("stroke-width");if(h.hasValue()){var d=h.getPixels();t.lineWidth=d||Ln}var p=this.getStyle("stroke-linecap"),y=this.getStyle("stroke-linejoin"),v=this.getStyle("stroke-miterlimit"),g=this.getStyle("paint-order"),m=this.getStyle("stroke-dasharray"),b=this.getStyle("stroke-dashoffset");if(p.hasValue()&&(t.lineCap=p.getString()),y.hasValue()&&(t.lineJoin=y.getString()),v.hasValue()&&(t.miterLimit=v.getNumber()),g.hasValue()&&(t.paintOrder=g.getValue()),m.hasValue()&&"none"!==m.getString()){var x=Mn(m.getString());void 0!==t.setLineDash?t.setLineDash(x):void 0!==t.webkitLineDash?t.webkitLineDash=x:void 0===t.mozDash||1===x.length&&0===x[0]||(t.mozDash=x);var _=b.getPixels();void 0!==t.lineDashOffset?t.lineDashOffset=_:void 0!==t.webkitLineDashOffset?t.webkitLineDashOffset=_:void 0!==t.mozDashOffset&&(t.mozDashOffset=_)}}if(this.modifiedEmSizeStack=!1,void 0!==t.font){var w=this.getStyle("font"),S=this.getStyle("font-style"),A=this.getStyle("font-variant"),M=this.getStyle("font-weight"),k=this.getStyle("font-size"),T=this.getStyle("font-family"),E=new Se(S.getString(),A.getString(),M.getString(),k.hasValue()?"".concat(k.getPixels(!0),"px"):"",T.getString(),Se.parse(w.getString(),t.font));S.setValue(E.fontStyle),A.setValue(E.fontVariant),M.setValue(E.fontWeight),k.setValue(E.fontSize),T.setValue(E.fontFamily),t.font=E.toString(),k.isPixels()&&(this.document.emSize=k.getPixels(),this.modifiedEmSizeStack=!0)}n||(this.applyEffects(t),t.globalAlpha=this.calculateOpacity())}},{key:"clearContext",value:function(t){wt()(ct()(e.prototype),"clearContext",this).call(this,t),this.modifiedEmSizeStack&&this.document.popEmSize()}}]),e}(ge);function Te(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var Ee=function(t){it()(e,t);var n=Te(e);function e(t,r,i){var o;return R()(this,e),(o=n.call(this,t,r,(this instanceof e?this.constructor:void 0)===e||i)).type="text",o.x=0,o.y=0,o.measureCache=-1,o}return j()(e,[{key:"setContext",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];wt()(ct()(e.prototype),"setContext",this).call(this,t,n);var r=this.getStyle("dominant-baseline").getTextBaseline()||this.getStyle("alignment-baseline").getTextBaseline();r&&(t.textBaseline=r)}},{key:"initializeCoordinates",value:function(t){this.x=this.getAttribute("x").getPixels("x"),this.y=this.getAttribute("y").getPixels("y");var n=this.getAttribute("dx"),e=this.getAttribute("dy");n.hasValue()&&(this.x+=n.getPixels("x")),e.hasValue()&&(this.y+=e.getPixels("y")),this.x+=this.getAnchorDelta(t,this,0)}},{key:"getBoundingBox",value:function(t){var n,e=this;if("text"!==this.type)return this.getTElementBoundingBox(t);this.initializeCoordinates(t);var r=null;return m()(n=this.children).call(n,(function(n,i){var o=e.getChildBoundingBox(t,e,e,i);r?r.addBoundingBox(o):r=o})),r}},{key:"getFontSize",value:function(){var t=this.document,n=this.parent,e=Se.parse(t.ctx.font).fontSize;return n.getStyle("font-size").getNumber(e)}},{key:"getTElementBoundingBox",value:function(t){var n=this.getFontSize();return new Ae(this.x,this.y-n,this.x+this.measureText(t),this.y)}},{key:"getGlyph",value:function(t,n,e){var r=n[e],i=null;if(t.isArabic){var o=n.length,a=n[e-1],u=n[e+1],c="isolated";(0===e||" "===a)&&e<o-2&&" "!==u&&(c="terminal"),e>0&&" "!==a&&e<o-2&&" "!==u&&(c="medial"),e>0&&" "!==a&&(e===o-1||" "===u)&&(c="initial"),void 0!==t.glyphs[r]&&((i=t.glyphs[r][c])||"glyph"!==t.glyphs[r].type||(i=t.glyphs[r]))}else i=t.glyphs[r];return i||(i=t.missingGlyph),i}},{key:"getText",value:function(){return""}},{key:"getTextFromNode",value:function(t){var n=t||this.node,e=vt()(n.parentNode.childNodes),r=xt()(e).call(e,n),i=e.length-1,o=wn(n.value||n.text||n.textContent||"");return 0===r&&(o=Sn(o)),r===i&&(o=An(o)),o}},{key:"renderChildren",value:function(t){var n,e=this;if("text"===this.type){this.initializeCoordinates(t),m()(n=this.children).call(n,(function(n,r){e.renderChild(t,e,e,r)}));var r=this.document.screen.mouse;r.isWorking()&&r.checkBoundingBox(this,this.getBoundingBox(t))}else this.renderTElementChildren(t)}},{key:"renderTElementChildren",value:function(t){var n=this.document,e=this.parent,r=this.getText(),i=e.getStyle("font-family").getDefinition();if(i)for(var o,a=i.fontFace.unitsPerEm,u=Se.parse(n.ctx.font),c=e.getStyle("font-size").getNumber(u.fontSize),f=e.getStyle("font-style").getString(u.fontStyle),s=c/a,l=i.isRTL?mt()(o=r.split("")).call(o).join(""):r,h=Mn(e.getAttribute("dx").getString()),d=l.length,p=0;p<d;p++){var y=this.getGlyph(i,l,p);t.translate(this.x,this.y),t.scale(s,-s);var v=t.lineWidth;t.lineWidth=t.lineWidth*a/c,"italic"===f&&t.transform(1,0,.4,1,0,0),y.render(t),"italic"===f&&t.transform(1,0,-.4,1,0,0),t.lineWidth=v,t.scale(1/s,-1/s),t.translate(-this.x,-this.y),this.x+=c*(y.horizAdvX||i.horizAdvX)/a,void 0===h[p]||isNaN(h[p])||(this.x+=h[p])}else{var g=this.x,m=this.y;"stroke"===t.paintOrder?(t.strokeStyle&&t.strokeText(r,g,m),t.fillStyle&&t.fillText(r,g,m)):(t.fillStyle&&t.fillText(r,g,m),t.strokeStyle&&t.strokeText(r,g,m))}}},{key:"getAnchorDelta",value:function(t,n,e){var r=this.getStyle("text-anchor").getString("start");if("start"!==r){for(var i=n.children,o=i.length,a=null,u=0,c=e;c<o&&(a=i[c],!(c>e&&a.getAttribute("x").hasValue()||a.getAttribute("text-anchor").hasValue()));c++)u+=a.measureTextRecursive(t);return-1*("end"===r?u:u/2)}return 0}},{key:"adjustChildCoordinates",value:function(t,n,e,r){var i=e.children[r];if("function"!=typeof i.measureText)return i;t.save(),i.setContext(t,!0);var o=i.getAttribute("x"),a=i.getAttribute("y"),u=i.getAttribute("dx"),c=i.getAttribute("dy"),f=i.getAttribute("text-anchor").getString("start");if(0===r&&"textNode"!==i.type&&(o.hasValue()||o.setValue(n.getAttribute("x").getValue("0")),a.hasValue()||a.setValue(n.getAttribute("y").getValue("0")),u.hasValue()||u.setValue(n.getAttribute("dx").getValue("0")),c.hasValue()||c.setValue(n.getAttribute("dy").getValue("0"))),o.hasValue()){if(i.x=o.getPixels("x")+n.getAnchorDelta(t,e,r),"start"!==f){var s=i.measureTextRecursive(t);i.x+=-1*("end"===f?s:s/2)}u.hasValue()&&(i.x+=u.getPixels("x"))}else{if("start"!==f){var l=i.measureTextRecursive(t);n.x+=-1*("end"===f?l:l/2)}u.hasValue()&&(n.x+=u.getPixels("x")),i.x=n.x}return n.x=i.x+i.measureText(t),a.hasValue()?(i.y=a.getPixels("y"),c.hasValue()&&(i.y+=c.getPixels("y"))):(c.hasValue()&&(n.y+=c.getPixels("y")),i.y=n.y),n.y=i.y,i.clearContext(t),t.restore(),i}},{key:"getChildBoundingBox",value:function(t,n,e,r){var i,o=this.adjustChildCoordinates(t,n,e,r);if("function"!=typeof o.getBoundingBox)return null;var a=o.getBoundingBox(t);return a?(m()(i=o.children).call(i,(function(e,r){var i=n.getChildBoundingBox(t,n,o,r);a.addBoundingBox(i)})),a):null}},{key:"renderChild",value:function(t,n,e,r){var i,o=this.adjustChildCoordinates(t,n,e,r);o.render(t),m()(i=o.children).call(i,(function(e,r){n.renderChild(t,n,o,r)}))}},{key:"measureTextRecursive",value:function(t){var n;return U()(n=this.children).call(n,(function(n,e){return n+e.measureTextRecursive(t)}),this.measureText(t))}},{key:"measureText",value:function(t){var n=this.measureCache;if(~n)return n;var e=this.getText(),r=this.measureTargetText(t,e);return this.measureCache=r,r}},{key:"measureTargetText",value:function(t,n){if(!n.length)return 0;var e=this.parent,r=e.getStyle("font-family").getDefinition();if(r){for(var i,o=this.getFontSize(),a=r.isRTL?mt()(i=n.split("")).call(i).join(""):n,u=Mn(e.getAttribute("dx").getString()),c=a.length,f=0,s=0;s<c;s++){f+=(this.getGlyph(r,a,s).horizAdvX||r.horizAdvX)*o/r.fontFace.unitsPerEm,void 0===u[s]||isNaN(u[s])||(f+=u[s])}return f}if(!t.measureText)return 10*n.length;t.save(),this.setContext(t,!0);var l=t.measureText(n).width;return this.clearContext(t),t.restore(),l}}]),e}(ke);function Ce(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var Oe=function(t){it()(e,t);var n=Ce(e);function e(t,r,i){var o;return R()(this,e),(o=n.call(this,t,r,(this instanceof e?this.constructor:void 0)===e||i)).type="tspan",o.text=o.children.length>0?"":o.getTextFromNode(),o}return j()(e,[{key:"getText",value:function(){return this.text}}]),e}(Ee);function Pe(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var Ne=function(t){it()(e,t);var n=Pe(e);function e(){var t;return R()(this,e),(t=n.apply(this,arguments)).type="textNode",t}return e}(Oe);function Ie(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var Re=function(t){it()(e,t);var n=Ie(e);function e(t){var r;return R()(this,e),(r=n.call(this,t.replace(/[+-.]\s+/g,"-").replace(/[^MmZzLlHhVvCcSsQqTtAae\d\s.,+-].*/g,""))).control=null,r.start=null,r.current=null,r.command=null,r.commands=r.commands,r.i=-1,r.previousCommand=null,r.points=[],r.angles=[],r}return j()(e,[{key:"reset",value:function(){this.i=-1,this.command=null,this.previousCommand=null,this.start=new Kn(0,0),this.control=new Kn(0,0),this.current=new Kn(0,0),this.points=[],this.angles=[]}},{key:"isEnd",value:function(){return this.i>=this.commands.length-1}},{key:"next",value:function(){var t=this.commands[++this.i];return this.previousCommand=this.command,this.command=t,t}},{key:"getPoint",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"x",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"y",e=new Kn(this.command[t],this.command[n]);return this.makeAbsolute(e)}},{key:"getAsControlPoint",value:function(t,n){var e=this.getPoint(t,n);return this.control=e,e}},{key:"getAsCurrentPoint",value:function(t,n){var e=this.getPoint(t,n);return this.current=e,e}},{key:"getReflectedControlPoint",value:function(){var t=this.previousCommand.type;if(t!==Ht.CURVE_TO&&t!==Ht.SMOOTH_CURVE_TO&&t!==Ht.QUAD_TO&&t!==Ht.SMOOTH_QUAD_TO)return this.current;var n=this.current,e=n.x,r=n.y,i=this.control,o=i.x,a=i.y;return new Kn(2*e-o,2*r-a)}},{key:"makeAbsolute",value:function(t){if(this.command.relative){var n=this.current,e=n.x,r=n.y;t.x+=e,t.y+=r}return t}},{key:"addMarker",value:function(t,n,e){var r=this.points,i=this.angles;e&&i.length>0&&!i[i.length-1]&&(i[i.length-1]=r[r.length-1].angleTo(e)),this.addMarkerAngle(t,n?n.angleTo(t):null)}},{key:"addMarkerAngle",value:function(t,n){this.points.push(t),this.angles.push(n)}},{key:"getMarkerPoints",value:function(){return this.points}},{key:"getMarkerAngles",value:function(){for(var t=this.angles,n=t.length,e=0;e<n;e++)if(!t[e])for(var r=e+1;r<n;r++)if(t[r]){t[e]=t[r];break}return t}}]),e}(Ht);function De(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var je=function(t){it()(e,t);var n=De(e);function e(t,r,i){var o;return R()(this,e),(o=n.call(this,t,r,i)).type="path",o.pathParser=null,o.pathParser=new Re(o.getAttribute("d").getString()),o}return j()(e,[{key:"path",value:function(t){var n=this.pathParser,e=new Ae;for(n.reset(),t&&t.beginPath();!n.isEnd();)switch(n.next().type){case Re.MOVE_TO:this.pathM(t,e);break;case Re.LINE_TO:this.pathL(t,e);break;case Re.HORIZ_LINE_TO:this.pathH(t,e);break;case Re.VERT_LINE_TO:this.pathV(t,e);break;case Re.CURVE_TO:this.pathC(t,e);break;case Re.SMOOTH_CURVE_TO:this.pathS(t,e);break;case Re.QUAD_TO:this.pathQ(t,e);break;case Re.SMOOTH_QUAD_TO:this.pathT(t,e);break;case Re.ARC:this.pathA(t,e);break;case Re.CLOSE_PATH:this.pathZ(t,e)}return e}},{key:"getBoundingBox",value:function(t){return this.path()}},{key:"getMarkers",value:function(){var t=this.pathParser,n=t.getMarkerPoints(),e=t.getMarkerAngles();return c()(n).call(n,(function(t,n){return[t,e[n]]}))}},{key:"renderChildren",value:function(t){this.path(t),this.document.screen.mouse.checkPath(this,t);var n=this.getStyle("fill-rule");""!==t.fillStyle&&("inherit"!==n.getString("inherit")?At()(t).call(t,n.getString()):At()(t).call(t)),""!==t.strokeStyle&&t.stroke();var e=this.getMarkers();if(e){var r=e.length-1,i=this.getStyle("marker-start"),o=this.getStyle("marker-mid"),a=this.getStyle("marker-end");if(i.isUrlDefinition()){var u=i.getDefinition(),c=s()(e[0],2),f=c[0],l=c[1];u.render(t,f,l)}if(o.isUrlDefinition())for(var h=o.getDefinition(),d=1;d<r;d++){var p=s()(e[d],2),y=p[0],v=p[1];h.render(t,y,v)}if(a.isUrlDefinition()){var g=a.getDefinition(),m=s()(e[r],2),b=m[0],x=m[1];g.render(t,b,x)}}}},{key:"pathM",value:function(t,n){var r=this.pathParser,i=e.pathM(r).point,o=i.x,a=i.y;r.addMarker(i),n.addPoint(o,a),t&&t.moveTo(o,a)}},{key:"pathL",value:function(t,n){var r=this.pathParser,i=e.pathL(r),o=i.current,a=i.point,u=a.x,c=a.y;r.addMarker(a,o),n.addPoint(u,c),t&&t.lineTo(u,c)}},{key:"pathH",value:function(t,n){var r=this.pathParser,i=e.pathH(r),o=i.current,a=i.point,u=a.x,c=a.y;r.addMarker(a,o),n.addPoint(u,c),t&&t.lineTo(u,c)}},{key:"pathV",value:function(t,n){var r=this.pathParser,i=e.pathV(r),o=i.current,a=i.point,u=a.x,c=a.y;r.addMarker(a,o),n.addPoint(u,c),t&&t.lineTo(u,c)}},{key:"pathC",value:function(t,n){var r=this.pathParser,i=e.pathC(r),o=i.current,a=i.point,u=i.controlPoint,c=i.currentPoint;r.addMarker(c,u,a),n.addBezierCurve(o.x,o.y,a.x,a.y,u.x,u.y,c.x,c.y),t&&t.bezierCurveTo(a.x,a.y,u.x,u.y,c.x,c.y)}},{key:"pathS",value:function(t,n){var r=this.pathParser,i=e.pathS(r),o=i.current,a=i.point,u=i.controlPoint,c=i.currentPoint;r.addMarker(c,u,a),n.addBezierCurve(o.x,o.y,a.x,a.y,u.x,u.y,c.x,c.y),t&&t.bezierCurveTo(a.x,a.y,u.x,u.y,c.x,c.y)}},{key:"pathQ",value:function(t,n){var r=this.pathParser,i=e.pathQ(r),o=i.current,a=i.controlPoint,u=i.currentPoint;r.addMarker(u,a,a),n.addQuadraticCurve(o.x,o.y,a.x,a.y,u.x,u.y),t&&t.quadraticCurveTo(a.x,a.y,u.x,u.y)}},{key:"pathT",value:function(t,n){var r=this.pathParser,i=e.pathT(r),o=i.current,a=i.controlPoint,u=i.currentPoint;r.addMarker(u,a,a),n.addQuadraticCurve(o.x,o.y,a.x,a.y,u.x,u.y),t&&t.quadraticCurveTo(a.x,a.y,u.x,u.y)}},{key:"pathA",value:function(t,n){var r=this.pathParser,i=e.pathA(r),o=i.currentPoint,a=i.rX,u=i.rY,c=i.sweepFlag,f=i.xAxisRotation,s=i.centp,l=i.a1,h=i.ad,d=1-c?1:-1,p=l+d*(h/2),y=new Kn(s.x+a*Math.cos(p),s.y+u*Math.sin(p));if(r.addMarkerAngle(y,p-d*Math.PI/2),r.addMarkerAngle(o,p-d*Math.PI),n.addPoint(o.x,o.y),t&&!isNaN(l)&&!isNaN(h)){var v=a>u?a:u,g=a>u?1:a/u,m=a>u?u/a:1;t.translate(s.x,s.y),t.rotate(f),t.scale(g,m),t.arc(0,0,v,l,l+h,Boolean(1-c)),t.scale(1/g,1/m),t.rotate(-f),t.translate(-s.x,-s.y)}}},{key:"pathZ",value:function(t,n){e.pathZ(this.pathParser),t&&n.x1!==n.x2&&n.y1!==n.y2&&t.closePath()}}],[{key:"pathM",value:function(t){var n=t.getAsCurrentPoint();return t.start=t.current,{point:n}}},{key:"pathL",value:function(t){return{current:t.current,point:t.getAsCurrentPoint()}}},{key:"pathH",value:function(t){var n=t.current,e=t.command,r=new Kn((e.relative?n.x:0)+e.x,n.y);return t.current=r,{current:n,point:r}}},{key:"pathV",value:function(t){var n=t.current,e=t.command,r=new Kn(n.x,(e.relative?n.y:0)+e.y);return t.current=r,{current:n,point:r}}},{key:"pathC",value:function(t){return{current:t.current,point:t.getPoint("x1","y1"),controlPoint:t.getAsControlPoint("x2","y2"),currentPoint:t.getAsCurrentPoint()}}},{key:"pathS",value:function(t){return{current:t.current,point:t.getReflectedControlPoint(),controlPoint:t.getAsControlPoint("x2","y2"),currentPoint:t.getAsCurrentPoint()}}},{key:"pathQ",value:function(t){return{current:t.current,controlPoint:t.getAsControlPoint("x1","y1"),currentPoint:t.getAsCurrentPoint()}}},{key:"pathT",value:function(t){var n=t.current,e=t.getReflectedControlPoint();return t.control=e,{current:n,controlPoint:e,currentPoint:t.getAsCurrentPoint()}}},{key:"pathA",value:function(t){var n=t.current,e=t.command,r=e.rX,i=e.rY,o=e.xRot,a=e.lArcFlag,u=e.sweepFlag,c=o*(Math.PI/180),f=t.getAsCurrentPoint(),s=new Kn(Math.cos(c)*(n.x-f.x)/2+Math.sin(c)*(n.y-f.y)/2,-Math.sin(c)*(n.x-f.x)/2+Math.cos(c)*(n.y-f.y)/2),l=Math.pow(s.x,2)/Math.pow(r,2)+Math.pow(s.y,2)/Math.pow(i,2);l>1&&(r*=Math.sqrt(l),i*=Math.sqrt(l));var h=(a===u?-1:1)*Math.sqrt((Math.pow(r,2)*Math.pow(i,2)-Math.pow(r,2)*Math.pow(s.y,2)-Math.pow(i,2)*Math.pow(s.x,2))/(Math.pow(r,2)*Math.pow(s.y,2)+Math.pow(i,2)*Math.pow(s.x,2)));isNaN(h)&&(h=0);var d=new Kn(h*r*s.y/i,h*-i*s.x/r),p=new Kn((n.x+f.x)/2+Math.cos(c)*d.x-Math.sin(c)*d.y,(n.y+f.y)/2+Math.sin(c)*d.x+Math.cos(c)*d.y),y=Bn([1,0],[(s.x-d.x)/r,(s.y-d.y)/i]),v=[(s.x-d.x)/r,(s.y-d.y)/i],g=[(-s.x-d.x)/r,(-s.y-d.y)/i],m=Bn(v,g);return Fn(v,g)<=-1&&(m=Math.PI),Fn(v,g)>=1&&(m=0),{currentPoint:f,rX:r,rY:i,sweepFlag:u,xAxisRotation:c,centp:p,a1:y,ad:m}}},{key:"pathZ",value:function(t){t.current=t.start}}]),e}(ke);function ze(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var Ve=function(t){it()(e,t);var n=ze(e);function e(){var t;return R()(this,e),(t=n.apply(this,arguments)).type="svg",t.root=!1,t}return j()(e,[{key:"setContext",value:function(t){var n=this.document,r=n.screen,i=n.window,o=t.canvas;if(r.setDefaults(t),o.style&&void 0!==t.font&&i&&void 0!==i.getComputedStyle){t.font=i.getComputedStyle(o).getPropertyValue("font");var a=new Qn(n,"fontSize",Se.parse(t.font).fontSize);a.hasValue()&&(n.rootEmSize=a.getPixels("y"),n.emSize=n.rootEmSize)}this.getAttribute("x").hasValue()||this.getAttribute("x",!0).setValue(0),this.getAttribute("y").hasValue()||this.getAttribute("y",!0).setValue(0);var u=r.viewPort,c=u.width,f=u.height;this.getStyle("width").hasValue()||this.getStyle("width",!0).setValue("100%"),this.getStyle("height").hasValue()||this.getStyle("height",!0).setValue("100%"),this.getStyle("color").hasValue()||this.getStyle("color",!0).setValue("black");var s=this.getAttribute("refX"),l=this.getAttribute("refY"),h=this.getAttribute("viewBox"),d=h.hasValue()?Mn(h.getString()):null,p=!this.root&&"visible"!==this.getStyle("overflow").getValue("hidden"),y=0,v=0,g=0,m=0;d&&(y=d[0],v=d[1]),this.root||(c=this.getStyle("width").getPixels("x"),f=this.getStyle("height").getPixels("y"),"marker"===this.type&&(g=y,m=v,y=0,v=0)),r.viewPort.setCurrent(c,f),this.node&&this.getStyle("transform",!1,!0).hasValue()&&!this.getStyle("transform-origin",!1,!0).hasValue()&&this.getStyle("transform-origin",!0,!0).setValue("50% 50%"),wt()(ct()(e.prototype),"setContext",this).call(this,t),t.translate(this.getAttribute("x").getPixels("x"),this.getAttribute("y").getPixels("y")),d&&(c=d[2],f=d[3]),n.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:r.viewPort.width,desiredWidth:c,height:r.viewPort.height,desiredHeight:f,minX:y,minY:v,refX:s.getValue(),refY:l.getValue(),clip:p,clipX:g,clipY:m}),d&&(r.viewPort.removeCurrent(),r.viewPort.setCurrent(c,f))}},{key:"clearContext",value:function(t){wt()(ct()(e.prototype),"clearContext",this).call(this,t),this.document.screen.viewPort.removeCurrent()}},{key:"resize",value:function(t){var n,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.getAttribute("width",!0),o=this.getAttribute("height",!0),a=this.getAttribute("viewBox"),u=this.getAttribute("style"),c=i.getNumber(0),f=o.getNumber(0);if(r)if("string"==typeof r)this.getAttribute("preserveAspectRatio",!0).setValue(r);else{var s=this.getAttribute("preserveAspectRatio");s.hasValue()&&s.setValue(s.getString().replace(/^\s*(\S.*\S)\s*$/,"$1"))}(i.setValue(t),o.setValue(e),a.hasValue())||a.setValue(V()(n="0 0 ".concat(c||t," ")).call(n,f||e));if(u.hasValue()){var l=this.getStyle("width"),h=this.getStyle("height");l.hasValue()&&l.setValue("".concat(t,"px")),h.hasValue()&&h.setValue("".concat(e,"px"))}}}]),e}(ke);function Le(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var Ue=function(t){it()(e,t);var n=Le(e);function e(){var t;return R()(this,e),(t=n.apply(this,arguments)).type="rect",t}return j()(e,[{key:"path",value:function(t){var n=this.getAttribute("x").getPixels("x"),e=this.getAttribute("y").getPixels("y"),r=this.getStyle("width",!1,!0).getPixels("x"),i=this.getStyle("height",!1,!0).getPixels("y"),o=this.getAttribute("rx"),a=this.getAttribute("ry"),u=o.getPixels("x"),c=a.getPixels("y");if(o.hasValue()&&!a.hasValue()&&(c=u),a.hasValue()&&!o.hasValue()&&(u=c),u=Math.min(u,r/2),c=Math.min(c,i/2),t){var f=(Math.sqrt(2)-1)/3*4;t.beginPath(),i>0&&r>0&&(t.moveTo(n+u,e),t.lineTo(n+r-u,e),t.bezierCurveTo(n+r-u+f*u,e,n+r,e+c-f*c,n+r,e+c),t.lineTo(n+r,e+i-c),t.bezierCurveTo(n+r,e+i-c+f*c,n+r-u+f*u,e+i,n+r-u,e+i),t.lineTo(n+u,e+i),t.bezierCurveTo(n+u-f*u,e+i,n,e+i-c+f*c,n,e+i-c),t.lineTo(n,e+c),t.bezierCurveTo(n,e+c-f*c,n+u-f*u,e,n+u,e),t.closePath())}return new Ae(n,e,n+r,e+i)}},{key:"getMarkers",value:function(){return null}}]),e}(je);function Fe(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var Be=function(t){it()(e,t);var n=Fe(e);function e(){var t;return R()(this,e),(t=n.apply(this,arguments)).type="circle",t}return j()(e,[{key:"path",value:function(t){var n=this.getAttribute("cx").getPixels("x"),e=this.getAttribute("cy").getPixels("y"),r=this.getAttribute("r").getPixels();return t&&r>0&&(t.beginPath(),t.arc(n,e,r,0,2*Math.PI,!1),t.closePath()),new Ae(n-r,e-r,n+r,e+r)}},{key:"getMarkers",value:function(){return null}}]),e}(je);function He(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var qe=function(t){it()(e,t);var n=He(e);function e(){var t;return R()(this,e),(t=n.apply(this,arguments)).type="ellipse",t}return j()(e,[{key:"path",value:function(t){var n=(Math.sqrt(2)-1)/3*4,e=this.getAttribute("rx").getPixels("x"),r=this.getAttribute("ry").getPixels("y"),i=this.getAttribute("cx").getPixels("x"),o=this.getAttribute("cy").getPixels("y");return t&&e>0&&r>0&&(t.beginPath(),t.moveTo(i+e,o),t.bezierCurveTo(i+e,o+n*r,i+n*e,o+r,i,o+r),t.bezierCurveTo(i-n*e,o+r,i-e,o+n*r,i-e,o),t.bezierCurveTo(i-e,o-n*r,i-n*e,o-r,i,o-r),t.bezierCurveTo(i+n*e,o-r,i+e,o-n*r,i+e,o),t.closePath()),new Ae(i-e,o-r,i+e,o+r)}},{key:"getMarkers",value:function(){return null}}]),e}(je);function Ye(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var Xe=function(t){it()(e,t);var n=Ye(e);function e(){var t;return R()(this,e),(t=n.apply(this,arguments)).type="line",t}return j()(e,[{key:"getPoints",value:function(){return[new Kn(this.getAttribute("x1").getPixels("x"),this.getAttribute("y1").getPixels("y")),new Kn(this.getAttribute("x2").getPixels("x"),this.getAttribute("y2").getPixels("y"))]}},{key:"path",value:function(t){var n=this.getPoints(),e=s()(n,2),r=e[0],i=r.x,o=r.y,a=e[1],u=a.x,c=a.y;return t&&(t.beginPath(),t.moveTo(i,o),t.lineTo(u,c)),new Ae(i,o,u,c)}},{key:"getMarkers",value:function(){var t=this.getPoints(),n=s()(t,2),e=n[0],r=n[1],i=e.angleTo(r);return[[e,i],[r,i]]}}]),e}(je);function $e(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var We=function(t){it()(e,t);var n=$e(e);function e(t,r,i){var o;return R()(this,e),(o=n.call(this,t,r,i)).type="polyline",o.points=[],o.points=Kn.parsePath(o.getAttribute("points").getString()),o}return j()(e,[{key:"path",value:function(t){var n=this.points,e=s()(n,1)[0],r=e.x,i=e.y,o=new Ae(r,i);return t&&(t.beginPath(),t.moveTo(r,i)),m()(n).call(n,(function(n){var e=n.x,r=n.y;o.addPoint(e,r),t&&t.lineTo(e,r)})),o}},{key:"getMarkers",value:function(){var t=this.points,n=t.length-1,e=[];return m()(t).call(t,(function(r,i){i!==n&&e.push([r,r.angleTo(t[i+1])])})),e.length>0&&e.push([t[t.length-1],e[e.length-1][1]]),e}}]),e}(je);function Ge(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var Qe=function(t){it()(e,t);var n=Ge(e);function e(){var t;return R()(this,e),(t=n.apply(this,arguments)).type="polygon",t}return j()(e,[{key:"path",value:function(t){var n=wt()(ct()(e.prototype),"path",this).call(this,t),r=s()(this.points,1)[0],i=r.x,o=r.y;return t&&(t.lineTo(i,o),t.closePath()),n}}]),e}(We);function Ze(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var Ke=function(t){it()(e,t);var n=Ze(e);function e(){var t;return R()(this,e),(t=n.apply(this,arguments)).type="pattern",t}return j()(e,[{key:"createPattern",value:function(t,n,e){var r=this.getStyle("width").getPixels("x",!0),i=this.getStyle("height").getPixels("y",!0),o=new Ve(this.document,null);o.attributes.viewBox=new Qn(this.document,"viewBox",this.getAttribute("viewBox").getValue()),o.attributes.width=new Qn(this.document,"width","".concat(r,"px")),o.attributes.height=new Qn(this.document,"height","".concat(i,"px")),o.attributes.transform=new Qn(this.document,"transform",this.getAttribute("patternTransform").getValue()),o.children=this.children;var a=this.document.createCanvas(r,i),u=a.getContext("2d"),c=this.getAttribute("x"),f=this.getAttribute("y");c.hasValue()&&f.hasValue()&&u.translate(c.getPixels("x",!0),f.getPixels("y",!0)),e.hasValue()?this.styles["fill-opacity"]=e:Xt()(this.styles,"fill-opacity");for(var s=-1;s<=1;s++)for(var l=-1;l<=1;l++)u.save(),o.attributes.x=new Qn(this.document,"x",s*a.width),o.attributes.y=new Qn(this.document,"y",l*a.height),o.render(u),u.restore();return t.createPattern(a,"repeat")}}]),e}(ge);function Je(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var tr=function(t){it()(e,t);var n=Je(e);function e(){var t;return R()(this,e),(t=n.apply(this,arguments)).type="marker",t}return j()(e,[{key:"render",value:function(t,n,e){if(n){var r=n.x,i=n.y,o=this.getAttribute("orient").getValue("auto"),a=this.getAttribute("markerUnits").getValue("strokeWidth");t.translate(r,i),"auto"===o&&t.rotate(e),"strokeWidth"===a&&t.scale(t.lineWidth,t.lineWidth),t.save();var u=new Ve(this.document,null);u.type=this.type,u.attributes.viewBox=new Qn(this.document,"viewBox",this.getAttribute("viewBox").getValue()),u.attributes.refX=new Qn(this.document,"refX",this.getAttribute("refX").getValue()),u.attributes.refY=new Qn(this.document,"refY",this.getAttribute("refY").getValue()),u.attributes.width=new Qn(this.document,"width",this.getAttribute("markerWidth").getValue()),u.attributes.height=new Qn(this.document,"height",this.getAttribute("markerHeight").getValue()),u.attributes.overflow=new Qn(this.document,"overflow",this.getAttribute("overflow").getValue()),u.attributes.fill=new Qn(this.document,"fill",this.getAttribute("fill").getColor("black")),u.attributes.stroke=new Qn(this.document,"stroke",this.getAttribute("stroke").getValue("none")),u.children=this.children,u.render(t),t.restore(),"strokeWidth"===a&&t.scale(1/t.lineWidth,1/t.lineWidth),"auto"===o&&t.rotate(-e),t.translate(-r,-i)}}}]),e}(ge);function nr(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var er=function(t){it()(e,t);var n=nr(e);function e(){var t;return R()(this,e),(t=n.apply(this,arguments)).type="defs",t}return j()(e,[{key:"render",value:function(){}}]),e}(ge);function rr(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var ir=function(t){it()(e,t);var n=rr(e);function e(){var t;return R()(this,e),(t=n.apply(this,arguments)).type="g",t}return j()(e,[{key:"getBoundingBox",value:function(t){var n,e=new Ae;return m()(n=this.children).call(n,(function(n){e.addBoundingBox(n.getBoundingBox(t))})),e}}]),e}(ke);function or(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var ar=function(t){it()(e,t);var n=or(e);function e(t,r,i){var o;R()(this,e),(o=n.call(this,t,r,i)).attributesToInherit=["gradientUnits"],o.stops=[];var a=Wt()(o),u=a.stops,c=a.children;return m()(c).call(c,(function(t){"stop"===t.type&&u.push(t)})),o}return j()(e,[{key:"getGradientUnits",value:function(){return this.getAttribute("gradientUnits").getString("objectBoundingBox")}},{key:"createGradient",value:function(t,n,e){var r=this,i=this;this.getHrefAttribute().hasValue()&&(i=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(i));var o=i.stops,a=this.getGradient(t,n);if(!a)return this.addParentOpacity(e,o[o.length-1].color);if(m()(o).call(o,(function(t){a.addColorStop(t.offset,r.addParentOpacity(e,t.color))})),this.getAttribute("gradientTransform").hasValue()){var u=this.document,c=u.screen,f=c.MAX_VIRTUAL_PIXELS,l=c.viewPort,h=s()(l.viewPorts,1)[0],d=new Ue(u,null);d.attributes.x=new Qn(u,"x",-f/3),d.attributes.y=new Qn(u,"y",-f/3),d.attributes.width=new Qn(u,"width",f),d.attributes.height=new Qn(u,"height",f);var p=new ir(u,null);p.attributes.transform=new Qn(u,"transform",this.getAttribute("gradientTransform").getValue()),p.children=[d];var y=new Ve(u,null);y.attributes.x=new Qn(u,"x",0),y.attributes.y=new Qn(u,"y",0),y.attributes.width=new Qn(u,"width",h.width),y.attributes.height=new Qn(u,"height",h.height),y.children=[p];var v=u.createCanvas(h.width,h.height),g=v.getContext("2d");return g.fillStyle=a,y.render(g),g.createPattern(v,"no-repeat")}return a}},{key:"inheritStopContainer",value:function(t){var n,e=this;m()(n=this.attributesToInherit).call(n,(function(n){!e.getAttribute(n).hasValue()&&t.getAttribute(n).hasValue()&&e.getAttribute(n,!0).setValue(t.getAttribute(n).getValue())}))}},{key:"addParentOpacity",value:function(t,n){return t.hasValue()?new Qn(this.document,"color",n).addOpacity(t).getColor():n}}]),e}(ge);function ur(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var cr=function(t){it()(e,t);var n=ur(e);function e(t,r,i){var o;return R()(this,e),(o=n.call(this,t,r,i)).type="linearGradient",o.attributesToInherit.push("x1","y1","x2","y2"),o}return j()(e,[{key:"getGradient",value:function(t,n){var e="objectBoundingBox"===this.getGradientUnits(),r=e?n.getBoundingBox(t):null;if(e&&!r)return null;this.getAttribute("x1").hasValue()||this.getAttribute("y1").hasValue()||this.getAttribute("x2").hasValue()||this.getAttribute("y2").hasValue()||(this.getAttribute("x1",!0).setValue(0),this.getAttribute("y1",!0).setValue(0),this.getAttribute("x2",!0).setValue(1),this.getAttribute("y2",!0).setValue(0));var i=e?r.x+r.width*this.getAttribute("x1").getNumber():this.getAttribute("x1").getPixels("x"),o=e?r.y+r.height*this.getAttribute("y1").getNumber():this.getAttribute("y1").getPixels("y"),a=e?r.x+r.width*this.getAttribute("x2").getNumber():this.getAttribute("x2").getPixels("x"),u=e?r.y+r.height*this.getAttribute("y2").getNumber():this.getAttribute("y2").getPixels("y");return i===a&&o===u?null:t.createLinearGradient(i,o,a,u)}}]),e}(ar);function fr(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var sr=function(t){it()(e,t);var n=fr(e);function e(t,r,i){var o;return R()(this,e),(o=n.call(this,t,r,i)).type="radialGradient",o.attributesToInherit.push("cx","cy","r","fx","fy","fr"),o}return j()(e,[{key:"getGradient",value:function(t,n){var e="objectBoundingBox"===this.getGradientUnits(),r=n.getBoundingBox(t);if(e&&!r)return null;this.getAttribute("cx").hasValue()||this.getAttribute("cx",!0).setValue("50%"),this.getAttribute("cy").hasValue()||this.getAttribute("cy",!0).setValue("50%"),this.getAttribute("r").hasValue()||this.getAttribute("r",!0).setValue("50%");var i=e?r.x+r.width*this.getAttribute("cx").getNumber():this.getAttribute("cx").getPixels("x"),o=e?r.y+r.height*this.getAttribute("cy").getNumber():this.getAttribute("cy").getPixels("y"),a=i,u=o;this.getAttribute("fx").hasValue()&&(a=e?r.x+r.width*this.getAttribute("fx").getNumber():this.getAttribute("fx").getPixels("x")),this.getAttribute("fy").hasValue()&&(u=e?r.y+r.height*this.getAttribute("fy").getNumber():this.getAttribute("fy").getPixels("y"));var c=e?(r.width+r.height)/2*this.getAttribute("r").getNumber():this.getAttribute("r").getPixels(),f=this.getAttribute("fr").getPixels();return t.createRadialGradient(a,u,f,i,o,c)}}]),e}(ar);function lr(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var hr=function(t){it()(e,t);var n=lr(e);function e(t,r,i){var o;R()(this,e),(o=n.call(this,t,r,i)).type="stop";var a=Math.max(0,Math.min(1,o.getAttribute("offset").getNumber())),u=o.getStyle("stop-opacity"),c=o.getStyle("stop-color",!0);return""===c.getString()&&c.setValue("#000"),u.hasValue()&&(c=c.addOpacity(u)),o.offset=a,o.color=c.getColor(),o}return e}(ge);function dr(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var pr=function(t){it()(e,t);var n=dr(e);function e(t,r,i){var o;return R()(this,e),(o=n.call(this,t,r,i)).type="animate",o.duration=0,o.initialValue=null,o.initialUnits="",o.removed=!1,o.frozen=!1,t.screen.animations.push(Wt()(o)),o.begin=o.getAttribute("begin").getMilliseconds(),o.maxDuration=o.begin+o.getAttribute("dur").getMilliseconds(),o.from=o.getAttribute("from"),o.to=o.getAttribute("to"),o.values=o.getAttribute("values"),Qt()(o).hasValue()&&Qt()(o).setValue(Qt()(o).getString().split(";")),o}return j()(e,[{key:"getProperty",value:function(){var t=this.getAttribute("attributeType").getString(),n=this.getAttribute("attributeName").getString();return"CSS"===t?this.parent.getStyle(n,!0):this.parent.getAttribute(n,!0)}},{key:"calcValue",value:function(){var t,n=this.initialUnits,e=this.getProgress(),r=e.progress,i=e.from,o=e.to,a=i.getNumber()+(o.getNumber()-i.getNumber())*r;return"%"===n&&(a*=100),V()(t="".concat(a)).call(t,n)}},{key:"update",value:function(t){var n=this.parent,e=this.getProperty();if(this.initialValue||(this.initialValue=e.getString(),this.initialUnits=e.getUnits()),this.duration>this.maxDuration){var r=this.getAttribute("fill").getString("remove");if("indefinite"===this.getAttribute("repeatCount").getString()||"indefinite"===this.getAttribute("repeatDur").getString())this.duration=0;else if("freeze"!==r||this.frozen){if("remove"===r&&!this.removed)return this.removed=!0,e.setValue(n.animationFrozen?n.animationFrozenValue:this.initialValue),!0}else this.frozen=!0,n.animationFrozen=!0,n.animationFrozenValue=e.getString();return!1}this.duration+=t;var i=!1;if(this.begin<this.duration){var o=this.calcValue(),a=this.getAttribute("type");if(a.hasValue()){var u,c=a.getString();o=V()(u="".concat(c,"(")).call(u,o,")")}e.setValue(o),i=!0}return i}},{key:"getProgress",value:function(){var t=this.document,n=Qt()(this),e={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(n.hasValue()){var r=e.progress*(n.getValue().length-1),i=Math.floor(r),o=Math.ceil(r);e.from=new Qn(t,"from",a()(n.getValue()[i])),e.to=new Qn(t,"to",a()(n.getValue()[o])),e.progress=(r-i)/(o-i)}else e.from=this.from,e.to=this.to;return e}}]),e}(ge);function yr(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var vr=function(t){it()(e,t);var n=yr(e);function e(){var t;return R()(this,e),(t=n.apply(this,arguments)).type="animateColor",t}return j()(e,[{key:"calcValue",value:function(){var t=this.getProgress(),n=t.progress,e=t.from,r=t.to,i=new(tt())(e.getColor()),o=new(tt())(r.getColor());if(i.ok&&o.ok){var a,u,c=i.r+(o.r-i.r)*n,f=i.g+(o.g-i.g)*n,s=i.b+(o.b-i.b)*n;return V()(a=V()(u="rgb(".concat(Kt()(c,10),", ")).call(u,Kt()(f,10),", ")).call(a,Kt()(s,10),")")}return this.getAttribute("from").getColor()}}]),e}(pr);function gr(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var mr=function(t){it()(e,t);var n=gr(e);function e(){var t;return R()(this,e),(t=n.apply(this,arguments)).type="animateTransform",t}return j()(e,[{key:"calcValue",value:function(){var t=this.getProgress(),n=t.progress,e=t.from,r=t.to,i=Mn(e.getString()),o=Mn(r.getString());return c()(i).call(i,(function(t,e){return t+(o[e]-t)*n})).join(" ")}}]),e}(pr);function br(t,n){var e;if(void 0===un()||null==on()(t)){if(en()(t)||(e=function(t,n){var e;if(!t)return;if("string"==typeof t)return xr(t,n);var r=fn()(e=Object.prototype.toString.call(t)).call(e,8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return vt()(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xr(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=tn()(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function xr(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function _r(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var wr=function(t){it()(e,t);var n=_r(e);function e(t,r,i){var o;R()(this,e),(o=n.call(this,t,r,i)).type="font",o.glyphs={},o.horizAdvX=o.getAttribute("horiz-adv-x").getNumber();var a,u=t.definitions,c=br(Wt()(o).children);try{for(c.s();!(a=c.n()).done;){var f=a.value;switch(f.type){case"font-face":o.fontFace=f;var s=f.getStyle("font-family");s.hasValue()&&(u[s.getString()]=Wt()(o));break;case"missing-glyph":o.missingGlyph=f;break;case"glyph":var l=f;l.arabicForm?(o.isRTL=!0,o.isArabic=!0,void 0===o.glyphs[l.unicode]&&(o.glyphs[l.unicode]={}),o.glyphs[l.unicode][l.arabicForm]=l):o.glyphs[l.unicode]=l}}}catch(t){c.e(t)}finally{c.f()}return o}return j()(e,[{key:"render",value:function(){}}]),e}(ge);function Sr(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var Ar=function(t){it()(e,t);var n=Sr(e);function e(t,r,i){var o;return R()(this,e),(o=n.call(this,t,r,i)).type="font-face",o.ascent=o.getAttribute("ascent").getNumber(),o.descent=o.getAttribute("descent").getNumber(),o.unitsPerEm=o.getAttribute("units-per-em").getNumber(),o}return e}(ge);function Mr(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var kr=function(t){it()(e,t);var n=Mr(e);function e(){var t;return R()(this,e),(t=n.apply(this,arguments)).type="missing-glyph",t.horizAdvX=0,t}return e}(je);function Tr(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var Er=function(t){it()(e,t);var n=Tr(e);function e(t,r,i){var o;return R()(this,e),(o=n.call(this,t,r,i)).type="glyph",o.horizAdvX=o.getAttribute("horiz-adv-x").getNumber(),o.unicode=o.getAttribute("unicode").getString(),o.arabicForm=o.getAttribute("arabic-form").getString(),o}return e}(je);function Cr(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var Or=function(t){it()(e,t);var n=Cr(e);function e(){var t;return R()(this,e),(t=n.apply(this,arguments)).type="tref",t}return j()(e,[{key:"getText",value:function(){var t=this.getHrefAttribute().getDefinition();if(t){var n=t.children[0];if(n)return n.getText()}return""}}]),e}(Ee);function Pr(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var Nr=function(t){it()(e,t);var n=Pr(e);function e(t,r,i){var o,a;R()(this,e),(a=n.call(this,t,r,i)).type="a";var u=r.childNodes,c=u[0],f=u.length>0&&q()(o=vt()(u)).call(o,(function(t){return 3===t.nodeType}));return a.hasText=f,a.text=f?a.getTextFromNode(c):"",a}return j()(e,[{key:"getText",value:function(){return this.text}},{key:"renderChildren",value:function(t){if(this.hasText){wt()(ct()(e.prototype),"renderChildren",this).call(this,t);var n=this.document,r=this.x,i=this.y,o=n.screen.mouse,a=new Qn(n,"fontSize",Se.parse(n.ctx.font).fontSize);o.isWorking()&&o.checkBoundingBox(this,new Ae(r,i-a.getPixels("y"),r+this.measureText(t),i))}else if(this.children.length>0){var u=new ir(this.document,null);u.children=this.children,u.parent=this,u.render(t)}}},{key:"onClick",value:function(){var t=this.document.window;t&&t.open(this.getHrefAttribute().getString())}},{key:"onMouseMove",value:function(){this.document.ctx.canvas.style.cursor="pointer"}}]),e}(Ee);function Ir(t,n){var e;if(void 0===un()||null==on()(t)){if(en()(t)||(e=function(t,n){var e;if(!t)return;if("string"==typeof t)return Rr(t,n);var r=fn()(e=Object.prototype.toString.call(t)).call(e,8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return vt()(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Rr(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=tn()(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Rr(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Dr(t,n){var e=k()(t);if(A()){var r=A()(t);n&&(r=w()(r).call(r,(function(n){return x()(t,n).enumerable}))),e.push.apply(e,r)}return e}function jr(t){for(var n=1;n<arguments.length;n++){var e,r=null!=arguments[n]?arguments[n]:{};if(n%2)m()(e=Dr(Object(r),!0)).call(e,(function(n){N()(t,n,r[n])}));else if(v())p()(t,v()(r));else{var i;m()(i=Dr(Object(r))).call(i,(function(n){h()(t,n,x()(r,n))}))}}return t}function zr(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var Vr=function(t){it()(e,t);var n=zr(e);function e(t,r,i){var o;R()(this,e),(o=n.call(this,t,r,i)).type="textPath",o.textWidth=0,o.textHeight=0,o.pathLength=-1,o.glyphInfo=null,o.letterSpacingCache=[],o.measuresCache=new(ln())([["",0]]);var a=o.getHrefAttribute().getDefinition();return o.text=o.getTextFromNode(),o.dataArray=o.parsePathData(a),o}return j()(e,[{key:"getText",value:function(){return this.text}},{key:"path",value:function(t){var n=this.dataArray;t&&t.beginPath(),m()(n).call(n,(function(n){var e=n.type,r=n.points;switch(e){case Re.LINE_TO:t&&t.lineTo(r[0],r[1]);break;case Re.MOVE_TO:t&&t.moveTo(r[0],r[1]);break;case Re.CURVE_TO:t&&t.bezierCurveTo(r[0],r[1],r[2],r[3],r[4],r[5]);break;case Re.QUAD_TO:t&&t.quadraticCurveTo(r[0],r[1],r[2],r[3]);break;case Re.ARC:var i=s()(r,8),o=i[0],a=i[1],u=i[2],c=i[3],f=i[4],l=i[5],h=i[6],d=i[7],p=u>c?u:c,y=u>c?1:u/c,v=u>c?c/u:1;t&&(t.translate(o,a),t.rotate(h),t.scale(y,v),t.arc(0,0,p,f,f+l,Boolean(1-d)),t.scale(1/y,1/v),t.rotate(-h),t.translate(-o,-a));break;case Re.CLOSE_PATH:t&&t.closePath()}}))}},{key:"renderChildren",value:function(t){this.setTextData(t),t.save();var n=this.parent.getStyle("text-decoration").getString(),e=this.getFontSize(),r=this.glyphInfo,i=t.fillStyle;"underline"===n&&t.beginPath(),m()(r).call(r,(function(r,i){var o=r.p0,a=r.p1,u=r.rotation,c=r.text;t.save(),t.translate(o.x,o.y),t.rotate(u),t.fillStyle&&t.fillText(c,0,0),t.strokeStyle&&t.strokeText(c,0,0),t.restore(),"underline"===n&&(0===i&&t.moveTo(o.x,o.y+e/8),t.lineTo(a.x,a.y+e/5))})),"underline"===n&&(t.lineWidth=e/20,t.strokeStyle=i,t.stroke(),t.closePath()),t.restore()}},{key:"getLetterSpacingAt",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.letterSpacingCache[t]||0}},{key:"findSegmentToFitChar",value:function(t,n,e,r,i,o,a,u,c){var f=o,s=this.measureText(t,u);" "===u&&"justify"===n&&e<r&&(s+=(r-e)/i),c>-1&&(f+=this.getLetterSpacingAt(c));var l=this.textHeight/20,h=this.getEquidistantPointOnPath(f,l,0),d=this.getEquidistantPointOnPath(f+s,l,0),p={p0:h,p1:d},y=h&&d?Math.atan2(d.y-h.y,d.x-h.x):0;if(a){var v=Math.cos(Math.PI/2+y)*a,g=Math.cos(-y)*a;p.p0=jr(jr({},h),{},{x:h.x+v,y:h.y+g}),p.p1=jr(jr({},d),{},{x:d.x+v,y:d.y+g})}return{offset:f+=s,segment:p,rotation:y}}},{key:"measureText",value:function(t,n){var e=this.measuresCache,r=n||this.getText();if(e.has(r))return e.get(r);var i=this.measureTargetText(t,r);return e.set(r,i),i}},{key:"setTextData",value:function(t){var n,e=this;if(!this.glyphInfo){var r=this.getText(),i=r.split(""),o=r.split(" ").length-1,a=c()(n=this.parent.getAttribute("dx").split()).call(n,(function(t){return t.getPixels("x")})),u=this.parent.getAttribute("dy").getPixels("y"),f=this.parent.getStyle("text-anchor").getString("start"),s=this.getStyle("letter-spacing"),l=this.parent.getStyle("letter-spacing"),h=0;s.hasValue()&&"inherit"!==s.getValue()?s.hasValue()&&"initial"!==s.getValue()&&"unset"!==s.getValue()&&(h=s.getPixels()):h=l.getPixels();var d=[],p=r.length;this.letterSpacingCache=d;for(var y=0;y<p;y++)d.push(void 0!==a[y]?a[y]:h);var v=U()(d).call(d,(function(t,n,e){return 0===e?0:t+n||0}),0),g=this.measureText(t),b=Math.max(g+v,0);this.textWidth=g,this.textHeight=this.getFontSize(),this.glyphInfo=[];var x=this.getPathLength(),_=this.getStyle("startOffset").getNumber(0)*x,w=0;"middle"!==f&&"center"!==f||(w=-b/2),"end"!==f&&"right"!==f||(w=-b),w+=_,m()(i).call(i,(function(n,r){var a=e.findSegmentToFitChar(t,f,b,x,o,w,u,n,r),c=a.offset,s=a.segment,l=a.rotation;w=c,s.p0&&s.p1&&e.glyphInfo.push({text:i[r],p0:s.p0,p1:s.p1,rotation:l})}))}}},{key:"parsePathData",value:function(t){if(this.pathLength=-1,!t)return[];var n=[],e=t.pathParser;for(e.reset();!e.isEnd();){var r=e.current,i=r?r.x:0,o=r?r.y:0,a=e.next(),u=a.type,c=[];switch(a.type){case Re.MOVE_TO:this.pathM(e,c);break;case Re.LINE_TO:u=this.pathL(e,c);break;case Re.HORIZ_LINE_TO:u=this.pathH(e,c);break;case Re.VERT_LINE_TO:u=this.pathV(e,c);break;case Re.CURVE_TO:this.pathC(e,c);break;case Re.SMOOTH_CURVE_TO:u=this.pathS(e,c);break;case Re.QUAD_TO:this.pathQ(e,c);break;case Re.SMOOTH_QUAD_TO:u=this.pathT(e,c);break;case Re.ARC:c=this.pathA(e);break;case Re.CLOSE_PATH:je.pathZ(e)}a.type!==Re.CLOSE_PATH?n.push({type:u,points:c,start:{x:i,y:o},pathLength:this.calcLength(i,o,u,c)}):n.push({type:Re.CLOSE_PATH,points:[],pathLength:0})}return n}},{key:"pathM",value:function(t,n){var e=je.pathM(t).point,r=e.x,i=e.y;n.push(r,i)}},{key:"pathL",value:function(t,n){var e=je.pathL(t).point,r=e.x,i=e.y;return n.push(r,i),Re.LINE_TO}},{key:"pathH",value:function(t,n){var e=je.pathH(t).point,r=e.x,i=e.y;return n.push(r,i),Re.LINE_TO}},{key:"pathV",value:function(t,n){var e=je.pathV(t).point,r=e.x,i=e.y;return n.push(r,i),Re.LINE_TO}},{key:"pathC",value:function(t,n){var e=je.pathC(t),r=e.point,i=e.controlPoint,o=e.currentPoint;n.push(r.x,r.y,i.x,i.y,o.x,o.y)}},{key:"pathS",value:function(t,n){var e=je.pathS(t),r=e.point,i=e.controlPoint,o=e.currentPoint;return n.push(r.x,r.y,i.x,i.y,o.x,o.y),Re.CURVE_TO}},{key:"pathQ",value:function(t,n){var e=je.pathQ(t),r=e.controlPoint,i=e.currentPoint;n.push(r.x,r.y,i.x,i.y)}},{key:"pathT",value:function(t,n){var e=je.pathT(t),r=e.controlPoint,i=e.currentPoint;return n.push(r.x,r.y,i.x,i.y),Re.QUAD_TO}},{key:"pathA",value:function(t){var n=je.pathA(t),e=n.rX,r=n.rY,i=n.sweepFlag,o=n.xAxisRotation,a=n.centp,u=n.a1,c=n.ad;return 0===i&&c>0&&(c-=2*Math.PI),1===i&&c<0&&(c+=2*Math.PI),[a.x,a.y,e,r,u,c,o,i]}},{key:"calcLength",value:function(t,n,e,r){var i=0,o=null,a=null,u=0;switch(e){case Re.LINE_TO:return this.getLineLength(t,n,r[0],r[1]);case Re.CURVE_TO:for(i=0,o=this.getPointOnCubicBezier(0,t,n,r[0],r[1],r[2],r[3],r[4],r[5]),u=.01;u<=1;u+=.01)a=this.getPointOnCubicBezier(u,t,n,r[0],r[1],r[2],r[3],r[4],r[5]),i+=this.getLineLength(o.x,o.y,a.x,a.y),o=a;return i;case Re.QUAD_TO:for(i=0,o=this.getPointOnQuadraticBezier(0,t,n,r[0],r[1],r[2],r[3]),u=.01;u<=1;u+=.01)a=this.getPointOnQuadraticBezier(u,t,n,r[0],r[1],r[2],r[3]),i+=this.getLineLength(o.x,o.y,a.x,a.y),o=a;return i;case Re.ARC:i=0;var c=r[4],f=r[5],s=r[4]+f,l=Math.PI/180;if(Math.abs(c-s)<l&&(l=Math.abs(c-s)),o=this.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],c,0),f<0)for(u=c-l;u>s;u-=l)a=this.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],u,0),i+=this.getLineLength(o.x,o.y,a.x,a.y),o=a;else for(u=c+l;u<s;u+=l)a=this.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],u,0),i+=this.getLineLength(o.x,o.y,a.x,a.y),o=a;return a=this.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],s,0),i+=this.getLineLength(o.x,o.y,a.x,a.y)}return 0}},{key:"getPointOnLine",value:function(t,n,e,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:n,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:e,u=(i-e)/(r-n+Ln),c=Math.sqrt(t*t/(1+u*u));r<n&&(c*=-1);var f=u*c,s=null;if(r===n)s={x:o,y:a+f};else if((a-e)/(o-n+Ln)===u)s={x:o+c,y:a+f};else{var l=0,h=0,d=this.getLineLength(n,e,r,i);if(d<Ln)return null;var p=(o-n)*(r-n)+(a-e)*(i-e);l=n+(p/=d*d)*(r-n),h=e+p*(i-e);var y=this.getLineLength(o,a,l,h),v=Math.sqrt(t*t-y*y);c=Math.sqrt(v*v/(1+u*u)),r<n&&(c*=-1),s={x:l+c,y:h+(f=u*c)}}return s}},{key:"getPointOnPath",value:function(t){var n=this.getPathLength(),e=0,r=null;if(t<-5e-5||t-5e-5>n)return null;var i,o=Ir(this.dataArray);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(!a||!(a.pathLength<5e-5||e+a.pathLength+5e-5<t)){var u=t-e,c=0;switch(a.type){case Re.LINE_TO:r=this.getPointOnLine(u,a.start.x,a.start.y,a.points[0],a.points[1],a.start.x,a.start.y);break;case Re.ARC:var f=a.points[4],s=a.points[5],l=a.points[4]+s;if(c=f+u/a.pathLength*s,s<0&&c<l||s>=0&&c>l)break;r=this.getPointOnEllipticalArc(a.points[0],a.points[1],a.points[2],a.points[3],c,a.points[6]);break;case Re.CURVE_TO:(c=u/a.pathLength)>1&&(c=1),r=this.getPointOnCubicBezier(c,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3],a.points[4],a.points[5]);break;case Re.QUAD_TO:(c=u/a.pathLength)>1&&(c=1),r=this.getPointOnQuadraticBezier(c,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3])}if(r)return r;break}e+=a.pathLength}}catch(t){o.e(t)}finally{o.f()}return null}},{key:"getLineLength",value:function(t,n,e,r){return Math.sqrt((e-t)*(e-t)+(r-n)*(r-n))}},{key:"getPathLength",value:function(){var t;-1===this.pathLength&&(this.pathLength=U()(t=this.dataArray).call(t,(function(t,n){return n.pathLength>0?t+n.pathLength:t}),0));return this.pathLength}},{key:"getPointOnCubicBezier",value:function(t,n,e,r,i,o,a,u,c){return{x:u*Hn(t)+o*qn(t)+r*Yn(t)+n*Xn(t),y:c*Hn(t)+a*qn(t)+i*Yn(t)+e*Xn(t)}}},{key:"getPointOnQuadraticBezier",value:function(t,n,e,r,i,o,a){return{x:o*$n(t)+r*Wn(t)+n*Gn(t),y:a*$n(t)+i*Wn(t)+e*Gn(t)}}},{key:"getPointOnEllipticalArc",value:function(t,n,e,r,i,o){var a=Math.cos(o),u=Math.sin(o),c=e*Math.cos(i),f=r*Math.sin(i);return{x:t+(c*a-f*u),y:n+(c*u+f*a)}}},{key:"buildEquidistantCache",value:function(t,n){var e=this.getPathLength(),r=n||.25,i=t||e/100;if(!this.equidistantCache||this.equidistantCache.step!==i||this.equidistantCache.precision!==r){this.equidistantCache={step:i,precision:r,points:[]};for(var o=0,a=0;a<=e;a+=r){var u=this.getPointOnPath(a),c=this.getPointOnPath(a+r);u&&c&&((o+=this.getLineLength(u.x,u.y,c.x,c.y))>=i&&(this.equidistantCache.points.push({x:u.x,y:u.y,distance:a}),o-=i))}}}},{key:"getEquidistantPointOnPath",value:function(t,n,e){if(this.buildEquidistantCache(n,e),t<0||t-this.getPathLength()>5e-5)return null;var r=Math.round(t/this.getPathLength()*(this.equidistantCache.points.length-1));return this.equidistantCache.points[r]||null}}]),e}(Ee);function Lr(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var Ur=function(t){it()(i,t);var n,e,r=Lr(i);function i(t,n,e){var o;R()(this,i),(o=r.call(this,t,n,e)).type="image",o.loaded=!1;var a=o.getHrefAttribute().getString();if(!a)return at()(o);var u=/\.svg$/.test(a);return t.images.push(Wt()(o)),u?o.loadSvg(a):o.loadImage(a),o.isSvg=u,o}return j()(i,[{key:"loadImage",value:(e=O()(E().mark((function t(n){var e;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.document.createImage(n);case 3:e=t.sent,this.image=e,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0);case 10:this.loaded=!0;case 11:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t){return e.apply(this,arguments)})},{key:"loadSvg",value:(n=O()(E().mark((function t(n){var e,r;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.document.fetch(n);case 3:return e=t.sent,t.next=6,e.text();case 6:r=t.sent,this.image=r,t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0);case 13:this.loaded=!0;case 14:case"end":return t.stop()}}),t,this,[[0,10]])}))),function(t){return n.apply(this,arguments)})},{key:"renderChildren",value:function(t){var n=this.document,e=this.image,r=this.loaded,i=this.getAttribute("x").getPixels("x"),o=this.getAttribute("y").getPixels("y"),a=this.getStyle("width").getPixels("x"),u=this.getStyle("height").getPixels("y");if(r&&e&&a&&u){if(t.save(),this.isSvg)n.canvg.forkString(t,this.image,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:i,offsetY:o,scaleWidth:a,scaleHeight:u}).render();else{var c=this.image;t.translate(i,o),n.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:a,desiredWidth:c.width,height:u,desiredHeight:c.height}),this.loaded&&(void 0===c.complete||c.complete)&&t.drawImage(c,0,0)}t.restore()}}},{key:"getBoundingBox",value:function(){var t=this.getAttribute("x").getPixels("x"),n=this.getAttribute("y").getPixels("y"),e=this.getStyle("width").getPixels("x"),r=this.getStyle("height").getPixels("y");return new Ae(t,n,t+e,n+r)}}]),i}(ke);function Fr(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var Br=function(t){it()(e,t);var n=Fr(e);function e(){var t;return R()(this,e),(t=n.apply(this,arguments)).type="symbol",t}return j()(e,[{key:"render",value:function(t){}}]),e}(ke),Hr=function(){function t(n){R()(this,t),this.document=n,this.loaded=!1,n.fonts.push(this)}var n;return j()(t,[{key:"load",value:(n=O()(E().mark((function t(n,e){var r,i,o,a;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=this.document,t.next=4,i.canvg.parser.load(e);case 4:o=t.sent,a=o.getElementsByTagName("font"),m()(r=vt()(a)).call(r,(function(t){var e=i.createElement(t);i.definitions[n]=e})),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0);case 12:this.loaded=!0;case 13:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(t,e){return n.apply(this,arguments)})}]),t}();function qr(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var Yr=function(t){it()(e,t);var n=qr(e);function e(t,r,i){var o,a;R()(this,e),(a=n.call(this,t,r,i)).type="style";var u=wn(c()(o=vt()(r.childNodes)).call(o,(function(t){return t.data})).join("").replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"").replace(/@import.*;/g,"")).split("}");return m()(u).call(u,(function(n){var e=K()(n).call(n);if(e){var r=e.split("{"),i=r[0].split(","),o=r[1].split(";");m()(i).call(i,(function(n){var e=K()(n).call(n);if(e){var r=t.styles[e]||{};if(m()(o).call(o,(function(n){var e,i,o=xt()(n).call(n,":"),a=K()(e=n.substr(0,o)).call(e),u=K()(i=n.substr(o+1,n.length-o)).call(i);a&&u&&(r[a]=new Qn(t,a,u))})),t.styles[e]=r,t.stylesSpecificity[e]=Vn(e),"@font-face"===e){var i=r["font-family"].getString().replace(/"|'/g,""),a=r.src.getString().split(",");m()(a).call(a,(function(n){if(xt()(n).call(n,'format("svg")')>0){var e=En(n);e&&new Hr(t).load(i,e)}}))}}}))}})),a}return e}(ge);function Xr(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}Yr.parseExternalUrl=En;var $r=function(t){it()(e,t);var n=Xr(e);function e(){var t;return R()(this,e),(t=n.apply(this,arguments)).type="use",t}return j()(e,[{key:"setContext",value:function(t){wt()(ct()(e.prototype),"setContext",this).call(this,t);var n=this.getAttribute("x"),r=this.getAttribute("y");n.hasValue()&&t.translate(n.getPixels("x"),0),r.hasValue()&&t.translate(0,r.getPixels("y"))}},{key:"path",value:function(t){var n=this.element;n&&n.path(t)}},{key:"renderChildren",value:function(t){var n=this.document,e=this.element;if(e){var r=e;if("symbol"===e.type&&((r=new Ve(n,null)).attributes.viewBox=new Qn(n,"viewBox",e.getAttribute("viewBox").getString()),r.attributes.preserveAspectRatio=new Qn(n,"preserveAspectRatio",e.getAttribute("preserveAspectRatio").getString()),r.attributes.overflow=new Qn(n,"overflow",e.getAttribute("overflow").getString()),r.children=e.children,e.styles.opacity=new Qn(n,"opacity",this.calculateOpacity())),"svg"===r.type){var i=this.getStyle("width",!1,!0),o=this.getStyle("height",!1,!0);i.hasValue()&&(r.attributes.width=new Qn(n,"width",i.getString())),o.hasValue()&&(r.attributes.height=new Qn(n,"height",o.getString()))}var a=r.parent;r.parent=this,r.render(t),r.parent=a}}},{key:"getBoundingBox",value:function(t){var n=this.element;return n?n.getBoundingBox(t):null}},{key:"elementTransform",value:function(){var t=this.document,n=this.element;return ve.fromElement(t,n)}},{key:"element",get:function(){return this._element||(this._element=this.getHrefAttribute().getDefinition()),this._element}}]),e}(ke);function Wr(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}function Gr(t,n,e,r,i,o){return t[e*r*4+4*n+o]}function Qr(t,n,e,r,i,o,a){t[e*r*4+4*n+o]=a}function Zr(t,n,e){return t[n]*e}function Kr(t,n,e,r){return n+Math.cos(t)*e+Math.sin(t)*r}var Jr=function(t){it()(e,t);var n=Wr(e);function e(t,r,i){var o;R()(this,e),(o=n.call(this,t,r,i)).type="feColorMatrix";var a=Mn(o.getAttribute("values").getString());switch(o.getAttribute("type").getString("matrix")){case"saturate":var u=a[0];a=[.213+.787*u,.715-.715*u,.072-.072*u,0,0,.213-.213*u,.715+.285*u,.072-.072*u,0,0,.213-.213*u,.715-.715*u,.072+.928*u,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var c=a[0]*Math.PI/180;a=[Kr(c,.213,.787,-.213),Kr(c,.715,-.715,-.715),Kr(c,.072,-.072,.928),0,0,Kr(c,.213,-.213,.143),Kr(c,.715,.285,.14),Kr(c,.072,-.072,-.283),0,0,Kr(c,.213,-.213,-.787),Kr(c,.715,-.715,.715),Kr(c,.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}return o.matrix=a,o.includeOpacity=o.getAttribute("includeOpacity").hasValue(),o}return j()(e,[{key:"apply",value:function(t,n,e,r,i){for(var o=this.includeOpacity,a=this.matrix,u=t.getImageData(0,0,r,i),c=0;c<i;c++)for(var f=0;f<r;f++){var s=Gr(u.data,f,c,r,0,0),l=Gr(u.data,f,c,r,0,1),h=Gr(u.data,f,c,r,0,2),d=Gr(u.data,f,c,r,0,3),p=Zr(a,0,s)+Zr(a,1,l)+Zr(a,2,h)+Zr(a,3,d)+Zr(a,4,1),y=Zr(a,5,s)+Zr(a,6,l)+Zr(a,7,h)+Zr(a,8,d)+Zr(a,9,1),v=Zr(a,10,s)+Zr(a,11,l)+Zr(a,12,h)+Zr(a,13,d)+Zr(a,14,1),g=Zr(a,15,s)+Zr(a,16,l)+Zr(a,17,h)+Zr(a,18,d)+Zr(a,19,1);o&&(p=y=v=0,g*=d/255),Qr(u.data,f,c,r,0,0,p),Qr(u.data,f,c,r,0,1,y),Qr(u.data,f,c,r,0,2,v),Qr(u.data,f,c,r,0,3,g)}t.clearRect(0,0,r,i),t.putImageData(u,0,0)}}]),e}(ge);function ti(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var ni=function(t){it()(e,t);var n=ti(e);function e(){var t;return R()(this,e),(t=n.apply(this,arguments)).type="mask",t}return j()(e,[{key:"apply",value:function(t,n){var r=this.document,i=this.getAttribute("x").getPixels("x"),o=this.getAttribute("y").getPixels("y"),a=this.getStyle("width").getPixels("x"),u=this.getStyle("height").getPixels("y");if(!a&&!u){var c,f=new Ae;m()(c=this.children).call(c,(function(n){f.addBoundingBox(n.getBoundingBox(t))})),i=Math.floor(f.x1),o=Math.floor(f.y1),a=Math.floor(f.width),u=Math.floor(f.height)}var s=this.removeStyles(n,e.ignoreStyles),l=r.createCanvas(i+a,o+u),h=l.getContext("2d");r.screen.setDefaults(h),this.renderChildren(h),new Jr(r,{nodeType:1,childNodes:[],attributes:[{nodeName:"type",value:"luminanceToAlpha"},{nodeName:"includeOpacity",value:"true"}]}).apply(h,0,0,i+a,o+u);var d=r.createCanvas(i+a,o+u),p=d.getContext("2d");r.screen.setDefaults(p),n.render(p),p.globalCompositeOperation="destination-in",p.fillStyle=h.createPattern(l,"no-repeat"),p.fillRect(0,0,i+a,o+u),t.fillStyle=p.createPattern(d,"no-repeat"),t.fillRect(0,0,i+a,o+u),this.restoreStyles(n,s)}},{key:"render",value:function(t){}}]),e}(ge);function ei(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}ni.ignoreStyles=["mask","transform","clip-path"];var ri=function(){},ii=function(t){it()(e,t);var n=ei(e);function e(){var t;return R()(this,e),(t=n.apply(this,arguments)).type="clipPath",t}return j()(e,[{key:"apply",value:function(t){var n,e=this.document,r=yn()(t),i=t.beginPath,o=t.closePath;r&&(r.beginPath=ri,r.closePath=ri),dn()(i,t,[]),m()(n=this.children).call(n,(function(n){if(void 0!==n.path){var i=void 0!==n.elementTransform?n.elementTransform():null;i||(i=ve.fromElement(e,n)),i&&i.apply(t),n.path(t),r&&(r.closePath=o),i&&i.unapply(t)}})),dn()(o,t,[]),t.clip(),r&&(r.beginPath=i,r.closePath=o)}},{key:"render",value:function(t){}}]),e}(ge);function oi(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var ai=function(t){it()(e,t);var n=oi(e);function e(){var t;return R()(this,e),(t=n.apply(this,arguments)).type="filter",t}return j()(e,[{key:"apply",value:function(t,n){var r=this.document,i=this.children,o=n.getBoundingBox(t);if(o){var a=0,u=0;m()(i).call(i,(function(t){var n=t.extraFilterDistance||0;a=Math.max(a,n),u=Math.max(u,n)}));var c=Math.floor(o.width),f=Math.floor(o.height),s=c+2*a,l=f+2*u;if(!(s<1||l<1)){var h=Math.floor(o.x),d=Math.floor(o.y),p=this.removeStyles(n,e.ignoreStyles),y=r.createCanvas(s,l),v=y.getContext("2d");r.screen.setDefaults(v),v.translate(-h+a,-d+u),n.render(v),m()(i).call(i,(function(t){"function"==typeof t.apply&&t.apply(v,0,0,s,l)})),t.drawImage(y,0,0,s,l,h-a,d-u,s,l),this.restoreStyles(n,p)}}}},{key:"render",value:function(t){}}]),e}(ge);function ui(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}ai.ignoreStyles=["filter","transform","clip-path"];var ci=function(t){it()(e,t);var n=ui(e);function e(t,r,i){var o;return R()(this,e),(o=n.call(this,t,r,i)).type="feDropShadow",o.addStylesFromStyleDefinition(),o}return j()(e,[{key:"apply",value:function(t,n,e,r,i){}}]),e}(ge);function fi(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var si=function(t){it()(e,t);var n=fi(e);function e(){var t;return R()(this,e),(t=n.apply(this,arguments)).type="feMorphology",t}return j()(e,[{key:"apply",value:function(t,n,e,r,i){}}]),e}(ge);function li(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var hi=function(t){it()(e,t);var n=li(e);function e(){var t;return R()(this,e),(t=n.apply(this,arguments)).type="feComposite",t}return j()(e,[{key:"apply",value:function(t,n,e,r,i){}}]),e}(ge);function di(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var pi=function(t){it()(e,t);var n=di(e);function e(t,r,i){var o;return R()(this,e),(o=n.call(this,t,r,i)).type="feGaussianBlur",o.blurRadius=Math.floor(o.getAttribute("stdDeviation").getNumber()),o.extraFilterDistance=o.blurRadius,o}return j()(e,[{key:"apply",value:function(t,n,e,r,i){var o=this.document,a=this.blurRadius,u=o.window?o.window.document.body:null,c=t.canvas;c.id=o.getUniqueId(),u&&(c.style.display="none",u.appendChild(c)),xn(c,n,e,r,i,a),u&&u.removeChild(c)}}]),e}(ge);function yi(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var vi=function(t){it()(e,t);var n=yi(e);function e(){var t;return R()(this,e),(t=n.apply(this,arguments)).type="title",t}return e}(ge);function gi(t){var n=function(){if("undefined"==typeof Reflect||!et())return!1;if(et().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(et()(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,r=ct()(t);if(n){var i=ct()(this).constructor;e=et()(r,arguments,i)}else e=r.apply(this,arguments);return at()(this,e)}}var mi=function(t){it()(e,t);var n=gi(e);function e(){var t;return R()(this,e),(t=n.apply(this,arguments)).type="desc",t}return e}(ge),bi={svg:Ve,rect:Ue,circle:Be,ellipse:qe,line:Xe,polyline:We,polygon:Qe,path:je,pattern:Ke,marker:tr,defs:er,linearGradient:cr,radialGradient:sr,stop:hr,animate:pr,animateColor:vr,animateTransform:mr,font:wr,"font-face":Ar,"missing-glyph":kr,glyph:Er,text:Ee,tspan:Oe,tref:Or,a:Nr,textPath:Vr,image:Ur,g:ir,symbol:Br,style:Yr,use:$r,mask:ni,clipPath:ii,filter:ai,feDropShadow:ci,feMorphology:si,feComposite:hi,feColorMatrix:Jr,feGaussianBlur:pi,title:vi,desc:mi};function xi(t,n){var e=k()(t);if(A()){var r=A()(t);n&&(r=w()(r).call(r,(function(n){return x()(t,n).enumerable}))),e.push.apply(e,r)}return e}function _i(){return(_i=O()(E().mark((function t(n){var e,r,i=arguments;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=i.length>1&&void 0!==i[1]&&i[1],r=document.createElement("img"),e&&(r.crossOrigin="Anonymous"),t.abrupt("return",new(X())((function(t,e){r.onload=function(){t(r)},r.onerror=function(){e()},r.src=n})));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var wi=function(){function t(n){var e,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.rootEmSize,a=void 0===o?12:o,u=i.emSize,c=void 0===u?12:u,f=i.createCanvas,s=void 0===f?t.createCanvas:f,l=i.createImage,h=void 0===l?t.createImage:l,d=i.anonymousCrossOrigin;R()(this,t),this.canvg=n,this.definitions={},this.styles={},this.stylesSpecificity={},this.images=[],this.fonts=[],this.emSizeStack=[],this.uniqueId=0,this.screen=n.screen,this.rootEmSize=a,this.emSize=c,this.createCanvas=s,this.createImage=this.bindCreateImage(h,d),this.screen.wait(W()(e=this.isImagesLoaded).call(e,this)),this.screen.wait(W()(r=this.isFontsLoaded).call(r,this))}return j()(t,[{key:"bindCreateImage",value:function(t,n){return"boolean"==typeof n?function(e,r){return t(e,"boolean"==typeof r?r:n)}:t}},{key:"popEmSize",value:function(){this.emSizeStack.pop()}},{key:"getUniqueId",value:function(){return"canvg".concat(++this.uniqueId)}},{key:"isImagesLoaded",value:function(){var t;return q()(t=this.images).call(t,(function(t){return t.loaded}))}},{key:"isFontsLoaded",value:function(){var t;return q()(t=this.fonts).call(t,(function(t){return t.loaded}))}},{key:"createDocumentElement",value:function(t){var n=this.createElement(t.documentElement);return n.root=!0,n.addStylesFromStyleDefinition(),this.documentElement=n,n}},{key:"createElement",value:function(n){var e=n.nodeName.replace(/^[^:]+:/,""),r=t.elementTypes[e];return void 0!==r?new r(this,n):new be(this,n)}},{key:"createTextNode",value:function(t){return new Ne(this,t)}},{key:"setViewBox",value:function(t){this.screen.setViewBox(function(t){for(var n=1;n<arguments.length;n++){var e,r=null!=arguments[n]?arguments[n]:{};if(n%2)m()(e=xi(Object(r),!0)).call(e,(function(n){N()(t,n,r[n])}));else if(v())p()(t,v()(r));else{var i;m()(i=xi(Object(r))).call(i,(function(n){h()(t,n,x()(r,n))}))}}return t}({document:this},t))}},{key:"window",get:function(){return this.screen.window}},{key:"fetch",get:function(){return this.screen.fetch}},{key:"ctx",get:function(){return this.screen.ctx}},{key:"emSize",get:function(){var t=this.emSizeStack;return t[t.length-1]},set:function(t){this.emSizeStack.push(t)}}]),t}();function Si(t,n){var e=k()(t);if(A()){var r=A()(t);n&&(r=w()(r).call(r,(function(n){return x()(t,n).enumerable}))),e.push.apply(e,r)}return e}function Ai(t){for(var n=1;n<arguments.length;n++){var e,r=null!=arguments[n]?arguments[n]:{};if(n%2)m()(e=Si(Object(r),!0)).call(e,(function(n){N()(t,n,r[n])}));else if(v())p()(t,v()(r));else{var i;m()(i=Si(Object(r))).call(i,(function(n){h()(t,n,x()(r,n))}))}}return t}wi.createCanvas=function(t,n){var e=document.createElement("canvas");return e.width=t,e.height=n,e},wi.createImage=function(t){return _i.apply(this,arguments)},wi.elementTypes=bi;var Mi=function(){function t(n,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};R()(this,t),this.parser=new oe(r),this.screen=new ee(n,r),this.options=r;var i=new wi(this,r),o=i.createDocumentElement(e);this.document=i,this.documentElement=o}var n,e;return j()(t,[{key:"fork",value:function(n,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.from(n,e,Ai(Ai({},this.options),r))}},{key:"forkString",value:function(n,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.fromString(n,e,Ai(Ai({},this.options),r))}},{key:"ready",value:function(){return this.screen.ready()}},{key:"isReady",value:function(){return this.screen.isReady()}},{key:"render",value:(e=O()(E().mark((function t(){var n,e=arguments;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:{},this.start(Ai({enableRedraw:!0,ignoreAnimation:!0,ignoreMouse:!0},n)),t.next=4,this.ready();case 4:this.stop();case 5:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.documentElement,e=this.screen,r=this.options;e.start(n,Ai(Ai({enableRedraw:!0},r),t))}},{key:"stop",value:function(){this.screen.stop()}},{key:"resize",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.documentElement.resize(t,n,e)}}],[{key:"from",value:(n=O()(E().mark((function n(e,r){var i,o,a,u=arguments;return E().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=u.length>2&&void 0!==u[2]?u[2]:{},o=new oe(i),n.next=4,o.parse(r);case 4:return a=n.sent,n.abrupt("return",new t(e,a,i));case 6:case"end":return n.stop()}}),n)}))),function(t,e){return n.apply(this,arguments)})},{key:"fromString",value:function(n,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=new oe(r),o=i.parseFromString(e);return new t(n,o,r)}}]),t}();var ki=Object.freeze({__proto__:null,offscreen:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.DOMParser,e={window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:n,createCanvas:function(t,n){return new OffscreenCanvas(t,n)},createImage:function(t){return O()(E().mark((function n(){var e,r,i;return E().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch(t);case 2:return e=n.sent,n.next=5,e.blob();case 5:return r=n.sent,n.next=8,createImageBitmap(r);case 8:return i=n.sent,n.abrupt("return",i);case 10:case"end":return n.stop()}}),n)})))()}};return"undefined"==typeof DOMParser&&void 0!==n||Xt()(e,"DOMParser"),e},node:function(t){var n=t.DOMParser,e=t.canvas;return{window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:n,fetch:t.fetch,createCanvas:e.createCanvas,createImage:e.loadImage}}}),Ti=Mi},15083:function(t,n,e){e(43414),e(19262);var r=e(25588);t.exports=r.Array.from},38579:function(t,n,e){e(7887);var r=e(25588);t.exports=r.Array.isArray},93002:function(t,n,e){e(11033);var r=e(6799);t.exports=r("Array").concat},11140:function(t,n,e){e(2464);var r=e(6799);t.exports=r("Array").every},27406:function(t,n,e){e(91343);var r=e(6799);t.exports=r("Array").fill},33535:function(t,n,e){e(85973);var r=e(6799);t.exports=r("Array").filter},21614:function(t,n,e){e(90036);var r=e(6799);t.exports=r("Array").forEach},95393:function(t,n,e){e(17955);var r=e(6799);t.exports=r("Array").includes},49087:function(t,n,e){e(16184);var r=e(6799);t.exports=r("Array").indexOf},43735:function(t,n,e){e(88864);var r=e(6799);t.exports=r("Array").map},14250:function(t,n,e){e(59242);var r=e(6799);t.exports=r("Array").reduce},5616:function(t,n,e){e(83963);var r=e(6799);t.exports=r("Array").reverse},38545:function(t,n,e){e(515);var r=e(6799);t.exports=r("Array").slice},59420:function(t,n,e){e(88220);var r=e(6799);t.exports=r("Array").some},21530:function(t,n,e){e(64116);var r=e(6799);t.exports=r("Array").values},62863:function(t,n,e){e(43454);var r=e(25588);t.exports=r.Date.now},24743:function(t,n,e){e(53816);var r=e(6799);t.exports=r("Function").bind},3766:function(t,n,e){var r=e(24743),i=Function.prototype;t.exports=function(t){var n=t.bind;return t===i||t instanceof Function&&n===i.bind?r:n}},60475:function(t,n,e){var r=e(93002),i=Array.prototype;t.exports=function(t){var n=t.concat;return t===i||t instanceof Array&&n===i.concat?r:n}},97190:function(t,n,e){var r=e(11140),i=Array.prototype;t.exports=function(t){var n=t.every;return t===i||t instanceof Array&&n===i.every?r:n}},89408:function(t,n,e){var r=e(27406),i=Array.prototype;t.exports=function(t){var n=t.fill;return t===i||t instanceof Array&&n===i.fill?r:n}},79038:function(t,n,e){var r=e(33535),i=Array.prototype;t.exports=function(t){var n=t.filter;return t===i||t instanceof Array&&n===i.filter?r:n}},46699:function(t,n,e){var r=e(95393),i=e(64003),o=Array.prototype,a=String.prototype;t.exports=function(t){var n=t.includes;return t===o||t instanceof Array&&n===o.includes?r:"string"==typeof t||t===a||t instanceof String&&n===a.includes?i:n}},94270:function(t,n,e){var r=e(49087),i=Array.prototype;t.exports=function(t){var n=t.indexOf;return t===i||t instanceof Array&&n===i.indexOf?r:n}},60625:function(t,n,e){var r=e(43735),i=Array.prototype;t.exports=function(t){var n=t.map;return t===i||t instanceof Array&&n===i.map?r:n}},98770:function(t,n,e){var r=e(14250),i=Array.prototype;t.exports=function(t){var n=t.reduce;return t===i||t instanceof Array&&n===i.reduce?r:n}},60207:function(t,n,e){var r=e(5616),i=Array.prototype;t.exports=function(t){var n=t.reverse;return t===i||t instanceof Array&&n===i.reverse?r:n}},99582:function(t,n,e){var r=e(38545),i=Array.prototype;t.exports=function(t){var n=t.slice;return t===i||t instanceof Array&&n===i.slice?r:n}},25975:function(t,n,e){var r=e(59420),i=Array.prototype;t.exports=function(t){var n=t.some;return t===i||t instanceof Array&&n===i.some?r:n}},96802:function(t,n,e){var r=e(71345),i=String.prototype;t.exports=function(t){var n=t.startsWith;return"string"==typeof t||t===i||t instanceof String&&n===i.startsWith?r:n}},2555:function(t,n,e){var r=e(95628),i=String.prototype;t.exports=function(t){var n=t.trim;return"string"==typeof t||t===i||t instanceof String&&n===i.trim?r:n}},22705:function(t,n,e){e(63802),e(18159),e(43414),e(88997);var r=e(25588);t.exports=r.Map},91215:function(t,n,e){e(66454);var r=e(25588).Object;t.exports=function(t,n){return r.create(t,n)}},57310:function(t,n,e){e(40986);var r=e(25588).Object,i=t.exports=function(t,n){return r.defineProperties(t,n)};r.defineProperties.sham&&(i.sham=!0)},63791:function(t,n,e){e(25845);var r=e(25588).Object,i=t.exports=function(t,n,e){return r.defineProperty(t,n,e)};r.defineProperty.sham&&(i.sham=!0)},50564:function(t,n,e){e(30556);var r=e(25588).Object,i=t.exports=function(t,n){return r.getOwnPropertyDescriptor(t,n)};r.getOwnPropertyDescriptor.sham&&(i.sham=!0)},49574:function(t,n,e){e(51812);var r=e(25588);t.exports=r.Object.getOwnPropertyDescriptors},97853:function(t,n,e){e(72216);var r=e(25588);t.exports=r.Object.getOwnPropertySymbols},14070:function(t,n,e){e(1581);var r=e(25588);t.exports=r.Object.getPrototypeOf},19300:function(t,n,e){e(57286);var r=e(25588);t.exports=r.Object.keys},90959:function(t,n,e){e(89356);var r=e(25588);t.exports=r.Object.setPrototypeOf},60761:function(t,n,e){e(47113);var r=e(25588);t.exports=r.parseFloat},80164:function(t,n,e){e(37436);var r=e(25588);t.exports=r.parseInt},12534:function(t,n,e){e(18159),e(43414),e(88997),e(33024),e(94958),e(47982);var r=e(25588);t.exports=r.Promise},73699:function(t,n,e){e(98377);var r=e(25588);t.exports=r.Reflect.apply},8483:function(t,n,e){e(86990);var r=e(25588);t.exports=r.Reflect.construct},48530:function(t,n,e){e(57810);var r=e(25588);t.exports=r.Reflect.deleteProperty},62839:function(t,n,e){e(38516);var r=e(25588);t.exports=r.Reflect.getPrototypeOf},86707:function(t,n,e){e(56058);var r=e(25588);t.exports=r.Reflect.get},64003:function(t,n,e){e(2880);var r=e(6799);t.exports=r("String").includes},71345:function(t,n,e){e(8216);var r=e(6799);t.exports=r("String").startsWith},95628:function(t,n,e){e(94255);var r=e(6799);t.exports=r("String").trim},11050:function(t,n,e){e(11033),e(18159),e(72216),e(27200),e(76733),e(65101),e(22392),e(53310),e(13253),e(99467),e(67963),e(5966),e(81981),e(66621),e(85710),e(25516),e(5634),e(40481),e(87451);var r=e(25588);t.exports=r.Symbol},37226:function(t,n,e){e(53310),e(43414),e(88997);var r=e(78928);t.exports=r.f("iterator")},99763:function(t,n,e){var r=e(15083);t.exports=r},50655:function(t,n,e){var r=e(38579);t.exports=r},137:function(t,n,e){e(88997),e(43414);var r=e(96546);t.exports=r},22685:function(t,n,e){e(88997),e(43414);var r=e(23549);t.exports=r},88148:function(t,n,e){var r=e(99582);t.exports=r},24720:function(t,n,e){e(88997),e(43414);var r=e(588);t.exports=r},52507:function(t,n,e){var r=e(91215);t.exports=r},5591:function(t,n,e){var r=e(63791);t.exports=r},2077:function(t,n,e){var r=e(50564);t.exports=r},86500:function(t,n,e){var r=e(14070);t.exports=r},83432:function(t,n,e){var r=e(90959);t.exports=r},975:function(t,n,e){var r=e(12534);e(49744),e(84335),e(57488),e(17002),t.exports=r},66866:function(t,n,e){var r=e(86707);t.exports=r},16598:function(t,n,e){var r=e(11050);e(36841),e(18971),e(4405),e(25867),e(55281),t.exports=r},98805:function(t,n,e){var r=e(37226);t.exports=r},63282:function(t){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},87159:function(t,n,e){var r=e(74846);t.exports=function(t){if(!r(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t}},7532:function(t){t.exports=function(){}},91288:function(t){t.exports=function(t,n,e){if(!(t instanceof n))throw TypeError("Incorrect "+(e?e+" ":"")+"invocation");return t}},51081:function(t,n,e){var r=e(74846);t.exports=function(t){if(!r(t))throw TypeError(String(t)+" is not an object");return t}},13435:function(t,n,e){"use strict";var r=e(81065),i=e(45601),o=e(1784);t.exports=function(t){for(var n=r(this),e=o(n.length),a=arguments.length,u=i(a>1?arguments[1]:void 0,e),c=a>2?arguments[2]:void 0,f=void 0===c?e:i(c,e);f>u;)n[u++]=t;return n}},62048:function(t,n,e){"use strict";var r=e(97826).forEach,i=e(33744),o=e(22925),a=i("forEach"),u=o("forEach");t.exports=a&&u?[].forEach:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}},49331:function(t,n,e){"use strict";var r=e(97863),i=e(81065),o=e(34553),a=e(19276),u=e(1784),c=e(20685),f=e(96546);t.exports=function(t){var n,e,s,l,h,d,p=i(t),y="function"==typeof this?this:Array,v=arguments.length,g=v>1?arguments[1]:void 0,m=void 0!==g,b=f(p),x=0;if(m&&(g=r(g,v>2?arguments[2]:void 0,2)),null==b||y==Array&&a(b))for(e=new y(n=u(p.length));n>x;x++)d=m?g(p[x],x):p[x],c(e,x,d);else for(h=(l=b.call(p)).next,e=new y;!(s=h.call(l)).done;x++)d=m?o(l,g,[s.value,x],!0):s.value,c(e,x,d);return e.length=x,e}},82878:function(t,n,e){var r=e(99743),i=e(1784),o=e(45601),a=function(t){return function(n,e,a){var u,c=r(n),f=i(c.length),s=o(a,f);if(t&&e!=e){for(;f>s;)if((u=c[s++])!=u)return!0}else for(;f>s;s++)if((t||s in c)&&c[s]===e)return t||s||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},97826:function(t,n,e){var r=e(97863),i=e(26269),o=e(81065),a=e(1784),u=e(72671),c=[].push,f=function(t){var n=1==t,e=2==t,f=3==t,s=4==t,l=6==t,h=5==t||l;return function(d,p,y,v){for(var g,m,b=o(d),x=i(b),_=r(p,y,3),w=a(x.length),S=0,A=v||u,M=n?A(d,w):e?A(d,0):void 0;w>S;S++)if((h||S in x)&&(m=_(g=x[S],S,b),t))if(n)M[S]=m;else if(m)switch(t){case 3:return!0;case 5:return g;case 6:return S;case 2:c.call(M,g)}else if(s)return!1;return l?-1:f||s?s:M}};t.exports={forEach:f(0),map:f(1),filter:f(2),some:f(3),every:f(4),find:f(5),findIndex:f(6)}},79462:function(t,n,e){var r=e(91138),i=e(62534),o=e(44796),a=i("species");t.exports=function(t){return o>=51||!r((function(){var n=[];return(n.constructor={})[a]=function(){return{foo:1}},1!==n[t](Boolean).foo}))}},33744:function(t,n,e){"use strict";var r=e(91138);t.exports=function(t,n){var e=[][t];return!!e&&r((function(){e.call(null,n||function(){throw 1},1)}))}},22925:function(t,n,e){var r=e(9312),i=e(91138),o=e(63786),a=Object.defineProperty,u={},c=function(t){throw t};t.exports=function(t,n){if(o(u,t))return u[t];n||(n={});var e=[][t],f=!!o(n,"ACCESSORS")&&n.ACCESSORS,s=o(n,0)?n[0]:c,l=o(n,1)?n[1]:void 0;return u[t]=!!e&&!i((function(){if(f&&!r)return!0;var t={length:-1};f?a(t,1,{enumerable:!0,get:c}):t[1]=1,e.call(t,s,l)}))}},97201:function(t,n,e){var r=e(63282),i=e(81065),o=e(26269),a=e(1784),u=function(t){return function(n,e,u,c){r(e);var f=i(n),s=o(f),l=a(f.length),h=t?l-1:0,d=t?-1:1;if(u<2)for(;;){if(h in s){c=s[h],h+=d;break}if(h+=d,t?h<0:l<=h)throw TypeError("Reduce of empty array with no initial value")}for(;t?h>=0:l>h;h+=d)h in s&&(c=e(c,s[h],h,f));return c}};t.exports={left:u(!1),right:u(!0)}},72671:function(t,n,e){var r=e(74846),i=e(10251),o=e(62534)("species");t.exports=function(t,n){var e;return i(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!i(e.prototype)?r(e)&&null===(e=e[o])&&(e=void 0):e=void 0),new(void 0===e?Array:e)(0===n?0:n)}},34553:function(t,n,e){var r=e(51081);t.exports=function(t,n,e,i){try{return i?n(r(e)[0],e[1]):n(e)}catch(n){var o=t.return;throw void 0!==o&&r(o.call(t)),n}}},33989:function(t,n,e){var r=e(62534)("iterator"),i=!1;try{var o=0,a={next:function(){return{done:!!o++}},return:function(){i=!0}};a[r]=function(){return this},Array.from(a,(function(){throw 2}))}catch(t){}t.exports=function(t,n){if(!n&&!i)return!1;var e=!1;try{var o={};o[r]=function(){return{next:function(){return{done:e=!0}}}},t(o)}catch(t){}return e}},77629:function(t){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},60516:function(t,n,e){var r=e(48286),i=e(77629),o=e(62534)("toStringTag"),a="Arguments"==i(function(){return arguments}());t.exports=r?i:function(t){var n,e,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(e=function(t,n){try{return t[n]}catch(t){}}(n=Object(t),o))?e:a?i(n):"Object"==(r=i(n))&&"function"==typeof n.callee?"Arguments":r}},87794:function(t,n,e){"use strict";var r=e(76232).f,i=e(84207),o=e(61958),a=e(97863),u=e(91288),c=e(71760),f=e(39779),s=e(70597),l=e(9312),h=e(44900).fastKey,d=e(47207),p=d.set,y=d.getterFor;t.exports={getConstructor:function(t,n,e,f){var s=t((function(t,r){u(t,s,n),p(t,{type:n,index:i(null),first:void 0,last:void 0,size:0}),l||(t.size=0),null!=r&&c(r,t[f],t,e)})),d=y(n),v=function(t,n,e){var r,i,o=d(t),a=g(t,n);return a?a.value=e:(o.last=a={index:i=h(n,!0),key:n,value:e,previous:r=o.last,next:void 0,removed:!1},o.first||(o.first=a),r&&(r.next=a),l?o.size++:t.size++,"F"!==i&&(o.index[i]=a)),t},g=function(t,n){var e,r=d(t),i=h(n);if("F"!==i)return r.index[i];for(e=r.first;e;e=e.next)if(e.key==n)return e};return o(s.prototype,{clear:function(){for(var t=d(this),n=t.index,e=t.first;e;)e.removed=!0,e.previous&&(e.previous=e.previous.next=void 0),delete n[e.index],e=e.next;t.first=t.last=void 0,l?t.size=0:this.size=0},delete:function(t){var n=this,e=d(n),r=g(n,t);if(r){var i=r.next,o=r.previous;delete e.index[r.index],r.removed=!0,o&&(o.next=i),i&&(i.previous=o),e.first==r&&(e.first=i),e.last==r&&(e.last=o),l?e.size--:n.size--}return!!r},forEach:function(t){for(var n,e=d(this),r=a(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.next:e.first;)for(r(n.value,n.key,this);n&&n.removed;)n=n.previous},has:function(t){return!!g(this,t)}}),o(s.prototype,e?{get:function(t){var n=g(this,t);return n&&n.value},set:function(t,n){return v(this,0===t?0:t,n)}}:{add:function(t){return v(this,t=0===t?0:t,t)}}),l&&r(s.prototype,"size",{get:function(){return d(this).size}}),s},setStrong:function(t,n,e){var r=n+" Iterator",i=y(n),o=y(r);f(t,n,(function(t,n){p(this,{type:r,target:t,state:i(t),kind:n,last:void 0})}),(function(){for(var t=o(this),n=t.kind,e=t.last;e&&e.removed;)e=e.previous;return t.target&&(t.last=e=e?e.next:t.state.first)?"keys"==n?{value:e.key,done:!1}:"values"==n?{value:e.value,done:!1}:{value:[e.key,e.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})}),e?"entries":"values",!e,!0),s(n)}}},43029:function(t,n,e){"use strict";var r=e(91342),i=e(34023),o=e(44900),a=e(91138),u=e(78177),c=e(71760),f=e(91288),s=e(74846),l=e(25196),h=e(76232).f,d=e(97826).forEach,p=e(9312),y=e(47207),v=y.set,g=y.getterFor;t.exports=function(t,n,e){var y,m=-1!==t.indexOf("Map"),b=-1!==t.indexOf("Weak"),x=m?"set":"add",_=i[t],w=_&&_.prototype,S={};if(p&&"function"==typeof _&&(b||w.forEach&&!a((function(){(new _).entries().next()})))){y=n((function(n,e){v(f(n,y,t),{type:t,collection:new _}),null!=e&&c(e,n[x],n,m)}));var A=g(t);d(["add","clear","delete","forEach","get","has","set","keys","values","entries"],(function(t){var n="add"==t||"set"==t;!(t in w)||b&&"clear"==t||u(y.prototype,t,(function(e,r){var i=A(this).collection;if(!n&&b&&!s(e))return"get"==t&&void 0;var o=i[t](0===e?0:e,r);return n?this:o}))})),b||h(y.prototype,"size",{configurable:!0,get:function(){return A(this).collection.size}})}else y=e.getConstructor(n,t,m,x),o.REQUIRED=!0;return l(y,t,!1,!0),S[t]=y,r({global:!0,forced:!0},S),b||e.setStrong(y,t,m),y}},26681:function(t,n,e){var r=e(62534)("match");t.exports=function(t){var n=/./;try{"/./"[t](n)}catch(e){try{return n[r]=!1,"/./"[t](n)}catch(t){}}return!1}},72833:function(t,n,e){var r=e(91138);t.exports=!r((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},9290:function(t,n,e){"use strict";var r=e(61595).IteratorPrototype,i=e(84207),o=e(6095),a=e(25196),u=e(57435),c=function(){return this};t.exports=function(t,n,e){var f=n+" Iterator";return t.prototype=i(r,{next:o(1,e)}),a(t,f,!1,!0),u[f]=c,t}},78177:function(t,n,e){var r=e(9312),i=e(76232),o=e(6095);t.exports=r?function(t,n,e){return i.f(t,n,o(1,e))}:function(t,n,e){return t[n]=e,t}},6095:function(t){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},20685:function(t,n,e){"use strict";var r=e(76745),i=e(76232),o=e(6095);t.exports=function(t,n,e){var a=r(n);a in t?i.f(t,a,o(0,e)):t[a]=e}},39779:function(t,n,e){"use strict";var r=e(91342),i=e(9290),o=e(76075),a=e(66200),u=e(25196),c=e(78177),f=e(8542),s=e(62534),l=e(42016),h=e(57435),d=e(61595),p=d.IteratorPrototype,y=d.BUGGY_SAFARI_ITERATORS,v=s("iterator"),g="keys",m="values",b="entries",x=function(){return this};t.exports=function(t,n,e,s,d,_,w){i(e,n,s);var S,A,M,k=function(t){if(t===d&&P)return P;if(!y&&t in C)return C[t];switch(t){case g:case m:case b:return function(){return new e(this,t)}}return function(){return new e(this)}},T=n+" Iterator",E=!1,C=t.prototype,O=C[v]||C["@@iterator"]||d&&C[d],P=!y&&O||k(d),N="Array"==n&&C.entries||O;if(N&&(S=o(N.call(new t)),p!==Object.prototype&&S.next&&(l||o(S)===p||(a?a(S,p):"function"!=typeof S[v]&&c(S,v,x)),u(S,T,!0,!0),l&&(h[T]=x))),d==m&&O&&O.name!==m&&(E=!0,P=function(){return O.call(this)}),l&&!w||C[v]===P||c(C,v,P),h[n]=P,d)if(A={values:k(m),keys:_?P:k(g),entries:k(b)},w)for(M in A)(y||E||!(M in C))&&f(C,M,A[M]);else r({target:n,proto:!0,forced:y||E},A);return A}},31241:function(t,n,e){var r=e(25588),i=e(63786),o=e(78928),a=e(76232).f;t.exports=function(t){var n=r.Symbol||(r.Symbol={});i(n,t)||a(n,t,{value:o.f(t)})}},9312:function(t,n,e){var r=e(91138);t.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},40643:function(t,n,e){var r=e(34023),i=e(74846),o=r.document,a=i(o)&&i(o.createElement);t.exports=function(t){return a?o.createElement(t):{}}},33702:function(t){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},76037:function(t,n,e){var r=e(27895);t.exports=/(iphone|ipod|ipad).*applewebkit/i.test(r)},27895:function(t,n,e){var r=e(8796);t.exports=r("navigator","userAgent")||""},44796:function(t,n,e){var r,i,o=e(34023),a=e(27895),u=o.process,c=u&&u.versions,f=c&&c.v8;f?i=(r=f.split("."))[0]+r[1]:a&&(!(r=a.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/))&&(i=r[1]),t.exports=i&&+i},6799:function(t,n,e){var r=e(25588);t.exports=function(t){return r[t+"Prototype"]}},91604:function(t){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},91342:function(t,n,e){"use strict";var r=e(34023),i=e(94983).f,o=e(53987),a=e(25588),u=e(97863),c=e(78177),f=e(63786),s=function(t){var n=function(n,e,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,e)}return new t(n,e,r)}return t.apply(this,arguments)};return n.prototype=t.prototype,n};t.exports=function(t,n){var e,l,h,d,p,y,v,g,m=t.target,b=t.global,x=t.stat,_=t.proto,w=b?r:x?r[m]:(r[m]||{}).prototype,S=b?a:a[m]||(a[m]={}),A=S.prototype;for(h in n)e=!o(b?h:m+(x?".":"#")+h,t.forced)&&w&&f(w,h),p=S[h],e&&(y=t.noTargetGet?(g=i(w,h))&&g.value:w[h]),d=e&&y?y:n[h],e&&typeof p==typeof d||(v=t.bind&&e?u(d,r):t.wrap&&e?s(d):_&&"function"==typeof d?u(Function.call,d):d,(t.sham||d&&d.sham||p&&p.sham)&&c(v,"sham",!0),S[h]=v,_&&(f(a,l=m+"Prototype")||c(a,l,{}),a[l][h]=d,t.real&&A&&!A[h]&&c(A,h,d)))}},91138:function(t){t.exports=function(t){try{return!!t()}catch(t){return!0}}},39710:function(t,n,e){var r=e(91138);t.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},97863:function(t,n,e){var r=e(63282);t.exports=function(t,n,e){if(r(t),void 0===n)return t;switch(e){case 0:return function(){return t.call(n)};case 1:return function(e){return t.call(n,e)};case 2:return function(e,r){return t.call(n,e,r)};case 3:return function(e,r,i){return t.call(n,e,r,i)}}return function(){return t.apply(n,arguments)}}},97658:function(t,n,e){"use strict";var r=e(63282),i=e(74846),o=[].slice,a={},u=function(t,n,e){if(!(n in a)){for(var r=[],i=0;i<n;i++)r[i]="a["+i+"]";a[n]=Function("C,a","return new C("+r.join(",")+")")}return a[n](t,e)};t.exports=Function.bind||function(t){var n=r(this),e=o.call(arguments,1),a=function(){var r=e.concat(o.call(arguments));return this instanceof a?u(n,r.length,r):n.apply(t,r)};return i(n.prototype)&&(a.prototype=n.prototype),a}},8796:function(t,n,e){var r=e(25588),i=e(34023),o=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,n){return arguments.length<2?o(r[t])||o(i[t]):r[t]&&r[t][n]||i[t]&&i[t][n]}},96546:function(t,n,e){var r=e(60516),i=e(57435),o=e(62534)("iterator");t.exports=function(t){if(null!=t)return t[o]||t["@@iterator"]||i[r(t)]}},23549:function(t,n,e){var r=e(51081),i=e(96546);t.exports=function(t){var n=i(t);if("function"!=typeof n)throw TypeError(String(t)+" is not iterable");return r(n.call(t))}},34023:function(t,n,e){var r=function(t){return t&&t.Math==Math&&t};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof e.g&&e.g)||Function("return this")()},63786:function(t){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},19470:function(t){t.exports={}},48693:function(t,n,e){var r=e(34023);t.exports=function(t,n){var e=r.console;e&&e.error&&(1===arguments.length?e.error(t):e.error(t,n))}},22423:function(t,n,e){var r=e(8796);t.exports=r("document","documentElement")},98340:function(t,n,e){var r=e(9312),i=e(91138),o=e(40643);t.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},26269:function(t,n,e){var r=e(91138),i=e(77629),o="".split;t.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==i(t)?o.call(t,""):Object(t)}:Object},28423:function(t,n,e){var r=e(87874),i=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(t){return i.call(t)}),t.exports=r.inspectSource},44900:function(t,n,e){var r=e(19470),i=e(74846),o=e(63786),a=e(76232).f,u=e(16502),c=e(39710),f=u("meta"),s=0,l=Object.isExtensible||function(){return!0},h=function(t){a(t,f,{value:{objectID:"O"+ ++s,weakData:{}}})},d=t.exports={REQUIRED:!1,fastKey:function(t,n){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,f)){if(!l(t))return"F";if(!n)return"E";h(t)}return t[f].objectID},getWeakData:function(t,n){if(!o(t,f)){if(!l(t))return!0;if(!n)return!1;h(t)}return t[f].weakData},onFreeze:function(t){return c&&d.REQUIRED&&l(t)&&!o(t,f)&&h(t),t}};r[f]=!0},47207:function(t,n,e){var r,i,o,a=e(89675),u=e(34023),c=e(74846),f=e(78177),s=e(63786),l=e(17132),h=e(19470),d=u.WeakMap;if(a){var p=new d,y=p.get,v=p.has,g=p.set;r=function(t,n){return g.call(p,t,n),n},i=function(t){return y.call(p,t)||{}},o=function(t){return v.call(p,t)}}else{var m=l("state");h[m]=!0,r=function(t,n){return f(t,m,n),n},i=function(t){return s(t,m)?t[m]:{}},o=function(t){return s(t,m)}}t.exports={set:r,get:i,has:o,enforce:function(t){return o(t)?i(t):r(t,{})},getterFor:function(t){return function(n){var e;if(!c(n)||(e=i(n)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return e}}}},19276:function(t,n,e){var r=e(62534),i=e(57435),o=r("iterator"),a=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||a[o]===t)}},10251:function(t,n,e){var r=e(77629);t.exports=Array.isArray||function(t){return"Array"==r(t)}},53987:function(t,n,e){var r=e(91138),i=/#|\.prototype\./,o=function(t,n){var e=u[a(t)];return e==f||e!=c&&("function"==typeof n?r(n):!!n)},a=o.normalize=function(t){return String(t).replace(i,".").toLowerCase()},u=o.data={},c=o.NATIVE="N",f=o.POLYFILL="P";t.exports=o},588:function(t,n,e){var r=e(60516),i=e(62534),o=e(57435),a=i("iterator");t.exports=function(t){var n=Object(t);return void 0!==n[a]||"@@iterator"in n||o.hasOwnProperty(r(n))}},74846:function(t){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},42016:function(t){t.exports=!0},19433:function(t,n,e){var r=e(74846),i=e(77629),o=e(62534)("match");t.exports=function(t){var n;return r(t)&&(void 0!==(n=t[o])?!!n:"RegExp"==i(t))}},71760:function(t,n,e){var r=e(51081),i=e(19276),o=e(1784),a=e(97863),u=e(96546),c=e(34553),f=function(t,n){this.stopped=t,this.result=n};(t.exports=function(t,n,e,s,l){var h,d,p,y,v,g,m,b=a(n,e,s?2:1);if(l)h=t;else{if("function"!=typeof(d=u(t)))throw TypeError("Target is not iterable");if(i(d)){for(p=0,y=o(t.length);y>p;p++)if((v=s?b(r(m=t[p])[0],m[1]):b(t[p]))&&v instanceof f)return v;return new f(!1)}h=d.call(t)}for(g=h.next;!(m=g.call(h)).done;)if("object"==typeof(v=c(h,b,m.value,s))&&v&&v instanceof f)return v;return new f(!1)}).stop=function(t){return new f(!0,t)}},61595:function(t,n,e){"use strict";var r,i,o,a=e(76075),u=e(78177),c=e(63786),f=e(62534),s=e(42016),l=f("iterator"),h=!1;[].keys&&("next"in(o=[].keys())?(i=a(a(o)))!==Object.prototype&&(r=i):h=!0),null==r&&(r={}),s||c(r,l)||u(r,l,(function(){return this})),t.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:h}},57435:function(t){t.exports={}},19131:function(t,n,e){var r,i,o,a,u,c,f,s,l=e(34023),h=e(94983).f,d=e(77629),p=e(52779).set,y=e(76037),v=l.MutationObserver||l.WebKitMutationObserver,g=l.process,m=l.Promise,b="process"==d(g),x=h(l,"queueMicrotask"),_=x&&x.value;_||(r=function(){var t,n;for(b&&(t=g.domain)&&t.exit();i;){n=i.fn,i=i.next;try{n()}catch(t){throw i?a():o=void 0,t}}o=void 0,t&&t.enter()},b?a=function(){g.nextTick(r)}:v&&!y?(u=!0,c=document.createTextNode(""),new v(r).observe(c,{characterData:!0}),a=function(){c.data=u=!u}):m&&m.resolve?(f=m.resolve(void 0),s=f.then,a=function(){s.call(f,r)}):a=function(){p.call(l,r)}),t.exports=_||function(t){var n={fn:t,next:void 0};o&&(o.next=n),i||(i=n,a()),o=n}},82537:function(t,n,e){var r=e(34023);t.exports=r.Promise},69334:function(t,n,e){var r=e(91138);t.exports=!!Object.getOwnPropertySymbols&&!r((function(){return!String(Symbol())}))},89675:function(t,n,e){var r=e(34023),i=e(28423),o=r.WeakMap;t.exports="function"==typeof o&&/native code/.test(i(o))},4561:function(t,n,e){"use strict";var r=e(63282),i=function(t){var n,e;this.promise=new t((function(t,r){if(void 0!==n||void 0!==e)throw TypeError("Bad Promise constructor");n=t,e=r})),this.resolve=r(n),this.reject=r(e)};t.exports.f=function(t){return new i(t)}},29372:function(t,n,e){var r=e(19433);t.exports=function(t){if(r(t))throw TypeError("The method doesn't accept regular expressions");return t}},72157:function(t,n,e){var r=e(34023),i=e(9294).trim,o=e(83377),a=r.parseFloat,u=1/a(o+"-0")!=-1/0;t.exports=u?function(t){var n=i(String(t)),e=a(n);return 0===e&&"-"==n.charAt(0)?-0:e}:a},46221:function(t,n,e){var r=e(34023),i=e(9294).trim,o=e(83377),a=r.parseInt,u=/^[+-]?0[Xx]/,c=8!==a(o+"08")||22!==a(o+"0x16");t.exports=c?function(t,n){var e=i(String(t));return a(e,n>>>0||(u.test(e)?16:10))}:a},84207:function(t,n,e){var r,i=e(51081),o=e(58315),a=e(91604),u=e(19470),c=e(22423),f=e(40643),s=e(17132),l=s("IE_PROTO"),h=function(){},d=function(t){return"<script>"+t+"</"+"script>"},p=function(){try{r=document.domain&&new ActiveXObject("htmlfile")}catch(t){}var t,n;p=r?function(t){t.write(d("")),t.close();var n=t.parentWindow.Object;return t=null,n}(r):((n=f("iframe")).style.display="none",c.appendChild(n),n.src=String("javascript:"),(t=n.contentWindow.document).open(),t.write(d("document.F=Object")),t.close(),t.F);for(var e=a.length;e--;)delete p.prototype[a[e]];return p()};u[l]=!0,t.exports=Object.create||function(t,n){var e;return null!==t?(h.prototype=i(t),e=new h,h.prototype=null,e[l]=t):e=p(),void 0===n?e:o(e,n)}},58315:function(t,n,e){var r=e(9312),i=e(76232),o=e(51081),a=e(25211);t.exports=r?Object.defineProperties:function(t,n){o(t);for(var e,r=a(n),u=r.length,c=0;u>c;)i.f(t,e=r[c++],n[e]);return t}},76232:function(t,n,e){var r=e(9312),i=e(98340),o=e(51081),a=e(76745),u=Object.defineProperty;n.f=r?u:function(t,n,e){if(o(t),n=a(n,!0),o(e),i)try{return u(t,n,e)}catch(t){}if("get"in e||"set"in e)throw TypeError("Accessors not supported");return"value"in e&&(t[n]=e.value),t}},94983:function(t,n,e){var r=e(9312),i=e(9143),o=e(6095),a=e(99743),u=e(76745),c=e(63786),f=e(98340),s=Object.getOwnPropertyDescriptor;n.f=r?s:function(t,n){if(t=a(t),n=u(n,!0),f)try{return s(t,n)}catch(t){}if(c(t,n))return o(!i.f.call(t,n),t[n])}},5216:function(t,n,e){var r=e(99743),i=e(67850).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"[object Window]"==o.call(t)?function(t){try{return i(t)}catch(t){return a.slice()}}(t):i(r(t))}},67850:function(t,n,e){var r=e(79072),i=e(91604).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},50282:function(t,n){n.f=Object.getOwnPropertySymbols},76075:function(t,n,e){var r=e(63786),i=e(81065),o=e(17132),a=e(72833),u=o("IE_PROTO"),c=Object.prototype;t.exports=a?Object.getPrototypeOf:function(t){return t=i(t),r(t,u)?t[u]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?c:null}},79072:function(t,n,e){var r=e(63786),i=e(99743),o=e(82878).indexOf,a=e(19470);t.exports=function(t,n){var e,u=i(t),c=0,f=[];for(e in u)!r(a,e)&&r(u,e)&&f.push(e);for(;n.length>c;)r(u,e=n[c++])&&(~o(f,e)||f.push(e));return f}},25211:function(t,n,e){var r=e(79072),i=e(91604);t.exports=Object.keys||function(t){return r(t,i)}},9143:function(t,n){"use strict";var e={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!e.call({1:2},1);n.f=i?function(t){var n=r(this,t);return!!n&&n.enumerable}:e},66200:function(t,n,e){var r=e(51081),i=e(87159);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,n=!1,e={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(e,[]),n=e instanceof Array}catch(t){}return function(e,o){return r(e),i(o),n?t.call(e,o):e.__proto__=o,e}}():void 0)},52750:function(t,n,e){"use strict";var r=e(48286),i=e(60516);t.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},35359:function(t,n,e){var r=e(8796),i=e(67850),o=e(50282),a=e(51081);t.exports=r("Reflect","ownKeys")||function(t){var n=i.f(a(t)),e=o.f;return e?n.concat(e(t)):n}},25588:function(t){t.exports={}},95908:function(t){t.exports=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}}},87455:function(t,n,e){var r=e(51081),i=e(74846),o=e(4561);t.exports=function(t,n){if(r(t),i(n)&&n.constructor===t)return n;var e=o.f(t);return(0,e.resolve)(n),e.promise}},61958:function(t,n,e){var r=e(8542);t.exports=function(t,n,e){for(var i in n)e&&e.unsafe&&t[i]?t[i]=n[i]:r(t,i,n[i],e);return t}},8542:function(t,n,e){var r=e(78177);t.exports=function(t,n,e,i){i&&i.enumerable?t[n]=e:r(t,n,e)}},51631:function(t){t.exports=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t}},45475:function(t,n,e){var r=e(34023),i=e(78177);t.exports=function(t,n){try{i(r,t,n)}catch(e){r[t]=n}return n}},70597:function(t,n,e){"use strict";var r=e(8796),i=e(76232),o=e(62534),a=e(9312),u=o("species");t.exports=function(t){var n=r(t),e=i.f;a&&n&&!n[u]&&e(n,u,{configurable:!0,get:function(){return this}})}},25196:function(t,n,e){var r=e(48286),i=e(76232).f,o=e(78177),a=e(63786),u=e(52750),c=e(62534)("toStringTag");t.exports=function(t,n,e,f){if(t){var s=e?t:t.prototype;a(s,c)||i(s,c,{configurable:!0,value:n}),f&&!r&&o(s,"toString",u)}}},17132:function(t,n,e){var r=e(21501),i=e(16502),o=r("keys");t.exports=function(t){return o[t]||(o[t]=i(t))}},87874:function(t,n,e){var r=e(34023),i=e(45475),o="__core-js_shared__",a=r[o]||i(o,{});t.exports=a},21501:function(t,n,e){var r=e(42016),i=e(87874);(t.exports=function(t,n){return i[t]||(i[t]=void 0!==n?n:{})})("versions",[]).push({version:"3.6.4",mode:r?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},39523:function(t,n,e){var r=e(51081),i=e(63282),o=e(62534)("species");t.exports=function(t,n){var e,a=r(t).constructor;return void 0===a||null==(e=r(a)[o])?n:i(e)}},4884:function(t,n,e){var r=e(11295),i=e(51631),o=function(t){return function(n,e){var o,a,u=String(i(n)),c=r(e),f=u.length;return c<0||c>=f?t?"":void 0:(o=u.charCodeAt(c))<55296||o>56319||c+1===f||(a=u.charCodeAt(c+1))<56320||a>57343?t?u.charAt(c):o:t?u.slice(c,c+2):a-56320+(o-55296<<10)+65536}};t.exports={codeAt:o(!1),charAt:o(!0)}},64147:function(t,n,e){var r=e(91138),i=e(83377);t.exports=function(t){return r((function(){return!!i[t]()||"​᠎"!="​᠎"[t]()||i[t].name!==t}))}},9294:function(t,n,e){var r=e(51631),i="["+e(83377)+"]",o=RegExp("^"+i+i+"*"),a=RegExp(i+i+"*$"),u=function(t){return function(n){var e=String(r(n));return 1&t&&(e=e.replace(o,"")),2&t&&(e=e.replace(a,"")),e}};t.exports={start:u(1),end:u(2),trim:u(3)}},52779:function(t,n,e){var r,i,o,a=e(34023),u=e(91138),c=e(77629),f=e(97863),s=e(22423),l=e(40643),h=e(76037),d=a.location,p=a.setImmediate,y=a.clearImmediate,v=a.process,g=a.MessageChannel,m=a.Dispatch,b=0,x={},_="onreadystatechange",w=function(t){if(x.hasOwnProperty(t)){var n=x[t];delete x[t],n()}},S=function(t){return function(){w(t)}},A=function(t){w(t.data)},M=function(t){a.postMessage(t+"",d.protocol+"//"+d.host)};p&&y||(p=function(t){for(var n=[],e=1;arguments.length>e;)n.push(arguments[e++]);return x[++b]=function(){("function"==typeof t?t:Function(t)).apply(void 0,n)},r(b),b},y=function(t){delete x[t]},"process"==c(v)?r=function(t){v.nextTick(S(t))}:m&&m.now?r=function(t){m.now(S(t))}:g&&!h?(o=(i=new g).port2,i.port1.onmessage=A,r=f(o.postMessage,o,1)):!a.addEventListener||"function"!=typeof postMessage||a.importScripts||u(M)||"file:"===d.protocol?r=_ in l("script")?function(t){s.appendChild(l("script")).onreadystatechange=function(){s.removeChild(this),w(t)}}:function(t){setTimeout(S(t),0)}:(r=M,a.addEventListener("message",A,!1))),t.exports={set:p,clear:y}},45601:function(t,n,e){var r=e(11295),i=Math.max,o=Math.min;t.exports=function(t,n){var e=r(t);return e<0?i(e+n,0):o(e,n)}},99743:function(t,n,e){var r=e(26269),i=e(51631);t.exports=function(t){return r(i(t))}},11295:function(t){var n=Math.ceil,e=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?e:n)(t)}},1784:function(t,n,e){var r=e(11295),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},81065:function(t,n,e){var r=e(51631);t.exports=function(t){return Object(r(t))}},76745:function(t,n,e){var r=e(74846);t.exports=function(t,n){if(!r(t))return t;var e,i;if(n&&"function"==typeof(e=t.toString)&&!r(i=e.call(t)))return i;if("function"==typeof(e=t.valueOf)&&!r(i=e.call(t)))return i;if(!n&&"function"==typeof(e=t.toString)&&!r(i=e.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},48286:function(t,n,e){var r={};r[e(62534)("toStringTag")]="z",t.exports="[object z]"===String(r)},16502:function(t){var n=0,e=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++n+e).toString(36)}},9708:function(t,n,e){var r=e(69334);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},78928:function(t,n,e){var r=e(62534);n.f=r},62534:function(t,n,e){var r=e(34023),i=e(21501),o=e(63786),a=e(16502),u=e(69334),c=e(9708),f=i("wks"),s=r.Symbol,l=c?s:s&&s.withoutSetter||a;t.exports=function(t){return o(f,t)||(u&&o(s,t)?f[t]=s[t]:f[t]=l("Symbol."+t)),f[t]}},83377:function(t){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},11033:function(t,n,e){"use strict";var r=e(91342),i=e(91138),o=e(10251),a=e(74846),u=e(81065),c=e(1784),f=e(20685),s=e(72671),l=e(79462),h=e(62534),d=e(44796),p=h("isConcatSpreadable"),y=9007199254740991,v="Maximum allowed index exceeded",g=d>=51||!i((function(){var t=[];return t[p]=!1,t.concat()[0]!==t})),m=l("concat"),b=function(t){if(!a(t))return!1;var n=t[p];return void 0!==n?!!n:o(t)};r({target:"Array",proto:!0,forced:!g||!m},{concat:function(t){var n,e,r,i,o,a=u(this),l=s(a,0),h=0;for(n=-1,r=arguments.length;n<r;n++)if(b(o=-1===n?a:arguments[n])){if(h+(i=c(o.length))>y)throw TypeError(v);for(e=0;e<i;e++,h++)e in o&&f(l,h,o[e])}else{if(h>=y)throw TypeError(v);f(l,h++,o)}return l.length=h,l}})},2464:function(t,n,e){"use strict";var r=e(91342),i=e(97826).every,o=e(33744),a=e(22925),u=o("every"),c=a("every");r({target:"Array",proto:!0,forced:!u||!c},{every:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},91343:function(t,n,e){var r=e(91342),i=e(13435),o=e(7532);r({target:"Array",proto:!0},{fill:i}),o("fill")},85973:function(t,n,e){"use strict";var r=e(91342),i=e(97826).filter,o=e(79462),a=e(22925),u=o("filter"),c=a("filter");r({target:"Array",proto:!0,forced:!u||!c},{filter:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},90036:function(t,n,e){"use strict";var r=e(91342),i=e(62048);r({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},19262:function(t,n,e){var r=e(91342),i=e(49331);r({target:"Array",stat:!0,forced:!e(33989)((function(t){Array.from(t)}))},{from:i})},17955:function(t,n,e){"use strict";var r=e(91342),i=e(82878).includes,o=e(7532);r({target:"Array",proto:!0,forced:!e(22925)("indexOf",{ACCESSORS:!0,1:0})},{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),o("includes")},16184:function(t,n,e){"use strict";var r=e(91342),i=e(82878).indexOf,o=e(33744),a=e(22925),u=[].indexOf,c=!!u&&1/[1].indexOf(1,-0)<0,f=o("indexOf"),s=a("indexOf",{ACCESSORS:!0,1:0});r({target:"Array",proto:!0,forced:c||!f||!s},{indexOf:function(t){return c?u.apply(this,arguments)||0:i(this,t,arguments.length>1?arguments[1]:void 0)}})},7887:function(t,n,e){e(91342)({target:"Array",stat:!0},{isArray:e(10251)})},64116:function(t,n,e){"use strict";var r=e(99743),i=e(7532),o=e(57435),a=e(47207),u=e(39779),c="Array Iterator",f=a.set,s=a.getterFor(c);t.exports=u(Array,"Array",(function(t,n){f(this,{type:c,target:r(t),index:0,kind:n})}),(function(){var t=s(this),n=t.target,e=t.kind,r=t.index++;return!n||r>=n.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==e?{value:r,done:!1}:"values"==e?{value:n[r],done:!1}:{value:[r,n[r]],done:!1}}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},88864:function(t,n,e){"use strict";var r=e(91342),i=e(97826).map,o=e(79462),a=e(22925),u=o("map"),c=a("map");r({target:"Array",proto:!0,forced:!u||!c},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},59242:function(t,n,e){"use strict";var r=e(91342),i=e(97201).left,o=e(33744),a=e(22925),u=o("reduce"),c=a("reduce",{1:0});r({target:"Array",proto:!0,forced:!u||!c},{reduce:function(t){return i(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}})},83963:function(t,n,e){"use strict";var r=e(91342),i=e(10251),o=[].reverse,a=[1,2];r({target:"Array",proto:!0,forced:String(a)===String(a.reverse())},{reverse:function(){return i(this)&&(this.length=this.length),o.call(this)}})},515:function(t,n,e){"use strict";var r=e(91342),i=e(74846),o=e(10251),a=e(45601),u=e(1784),c=e(99743),f=e(20685),s=e(62534),l=e(79462),h=e(22925),d=l("slice"),p=h("slice",{ACCESSORS:!0,0:0,1:2}),y=s("species"),v=[].slice,g=Math.max;r({target:"Array",proto:!0,forced:!d||!p},{slice:function(t,n){var e,r,s,l=c(this),h=u(l.length),d=a(t,h),p=a(void 0===n?h:n,h);if(o(l)&&("function"!=typeof(e=l.constructor)||e!==Array&&!o(e.prototype)?i(e)&&null===(e=e[y])&&(e=void 0):e=void 0,e===Array||void 0===e))return v.call(l,d,p);for(r=new(void 0===e?Array:e)(g(p-d,0)),s=0;d<p;d++,s++)d in l&&f(r,s,l[d]);return r.length=s,r}})},88220:function(t,n,e){"use strict";var r=e(91342),i=e(97826).some,o=e(33744),a=e(22925),u=o("some"),c=a("some");r({target:"Array",proto:!0,forced:!u||!c},{some:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},43454:function(t,n,e){e(91342)({target:"Date",stat:!0},{now:function(){return(new Date).getTime()}})},53816:function(t,n,e){e(91342)({target:"Function",proto:!0},{bind:e(97658)})},87451:function(t,n,e){var r=e(34023);e(25196)(r.JSON,"JSON",!0)},63802:function(t,n,e){"use strict";var r=e(43029),i=e(87794);t.exports=r("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),i)},40481:function(t,n,e){e(25196)(Math,"Math",!0)},66454:function(t,n,e){e(91342)({target:"Object",stat:!0,sham:!e(9312)},{create:e(84207)})},40986:function(t,n,e){var r=e(91342),i=e(9312);r({target:"Object",stat:!0,forced:!i,sham:!i},{defineProperties:e(58315)})},25845:function(t,n,e){var r=e(91342),i=e(9312);r({target:"Object",stat:!0,forced:!i,sham:!i},{defineProperty:e(76232).f})},30556:function(t,n,e){var r=e(91342),i=e(91138),o=e(99743),a=e(94983).f,u=e(9312),c=i((function(){a(1)}));r({target:"Object",stat:!0,forced:!u||c,sham:!u},{getOwnPropertyDescriptor:function(t,n){return a(o(t),n)}})},51812:function(t,n,e){var r=e(91342),i=e(9312),o=e(35359),a=e(99743),u=e(94983),c=e(20685);r({target:"Object",stat:!0,sham:!i},{getOwnPropertyDescriptors:function(t){for(var n,e,r=a(t),i=u.f,f=o(r),s={},l=0;f.length>l;)void 0!==(e=i(r,n=f[l++]))&&c(s,n,e);return s}})},1581:function(t,n,e){var r=e(91342),i=e(91138),o=e(81065),a=e(76075),u=e(72833);r({target:"Object",stat:!0,forced:i((function(){a(1)})),sham:!u},{getPrototypeOf:function(t){return a(o(t))}})},57286:function(t,n,e){var r=e(91342),i=e(81065),o=e(25211);r({target:"Object",stat:!0,forced:e(91138)((function(){o(1)}))},{keys:function(t){return o(i(t))}})},89356:function(t,n,e){e(91342)({target:"Object",stat:!0},{setPrototypeOf:e(66200)})},18159:function(){},47113:function(t,n,e){var r=e(91342),i=e(72157);r({global:!0,forced:parseFloat!=i},{parseFloat:i})},37436:function(t,n,e){var r=e(91342),i=e(46221);r({global:!0,forced:parseInt!=i},{parseInt:i})},94958:function(t,n,e){"use strict";var r=e(91342),i=e(63282),o=e(4561),a=e(95908),u=e(71760);r({target:"Promise",stat:!0},{allSettled:function(t){var n=this,e=o.f(n),r=e.resolve,c=e.reject,f=a((function(){var e=i(n.resolve),o=[],a=0,c=1;u(t,(function(t){var i=a++,u=!1;o.push(void 0),c++,e.call(n,t).then((function(t){u||(u=!0,o[i]={status:"fulfilled",value:t},--c||r(o))}),(function(t){u||(u=!0,o[i]={status:"rejected",reason:t},--c||r(o))}))})),--c||r(o)}));return f.error&&c(f.value),e.promise}})},47982:function(t,n,e){"use strict";var r=e(91342),i=e(42016),o=e(82537),a=e(91138),u=e(8796),c=e(39523),f=e(87455),s=e(8542);r({target:"Promise",proto:!0,real:!0,forced:!!o&&a((function(){o.prototype.finally.call({then:function(){}},(function(){}))}))},{finally:function(t){var n=c(this,u("Promise")),e="function"==typeof t;return this.then(e?function(e){return f(n,t()).then((function(){return e}))}:t,e?function(e){return f(n,t()).then((function(){throw e}))}:t)}}),i||"function"!=typeof o||o.prototype.finally||s(o.prototype,"finally",u("Promise").prototype.finally)},33024:function(t,n,e){"use strict";var r,i,o,a,u=e(91342),c=e(42016),f=e(34023),s=e(8796),l=e(82537),h=e(8542),d=e(61958),p=e(25196),y=e(70597),v=e(74846),g=e(63282),m=e(91288),b=e(77629),x=e(28423),_=e(71760),w=e(33989),S=e(39523),A=e(52779).set,M=e(19131),k=e(87455),T=e(48693),E=e(4561),C=e(95908),O=e(47207),P=e(53987),N=e(62534),I=e(44796),R=N("species"),D="Promise",j=O.get,z=O.set,V=O.getterFor(D),L=l,U=f.TypeError,F=f.document,B=f.process,H=s("fetch"),q=E.f,Y=q,X="process"==b(B),$=!!(F&&F.createEvent&&f.dispatchEvent),W="unhandledrejection",G=P(D,(function(){if(!(x(L)!==String(L))){if(66===I)return!0;if(!X&&"function"!=typeof PromiseRejectionEvent)return!0}if(c&&!L.prototype.finally)return!0;if(I>=51&&/native code/.test(L))return!1;var t=L.resolve(1),n=function(t){t((function(){}),(function(){}))};return(t.constructor={})[R]=n,!(t.then((function(){}))instanceof n)})),Q=G||!w((function(t){L.all(t).catch((function(){}))})),Z=function(t){var n;return!(!v(t)||"function"!=typeof(n=t.then))&&n},K=function(t,n,e){if(!n.notified){n.notified=!0;var r=n.reactions;M((function(){for(var i=n.value,o=1==n.state,a=0;r.length>a;){var u,c,f,s=r[a++],l=o?s.ok:s.fail,h=s.resolve,d=s.reject,p=s.domain;try{l?(o||(2===n.rejection&&et(t,n),n.rejection=1),!0===l?u=i:(p&&p.enter(),u=l(i),p&&(p.exit(),f=!0)),u===s.promise?d(U("Promise-chain cycle")):(c=Z(u))?c.call(u,h,d):h(u)):d(i)}catch(t){p&&!f&&p.exit(),d(t)}}n.reactions=[],n.notified=!1,e&&!n.rejection&&tt(t,n)}))}},J=function(t,n,e){var r,i;$?((r=F.createEvent("Event")).promise=n,r.reason=e,r.initEvent(t,!1,!0),f.dispatchEvent(r)):r={promise:n,reason:e},(i=f["on"+t])?i(r):t===W&&T("Unhandled promise rejection",e)},tt=function(t,n){A.call(f,(function(){var e,r=n.value;if(nt(n)&&(e=C((function(){X?B.emit("unhandledRejection",r,t):J(W,t,r)})),n.rejection=X||nt(n)?2:1,e.error))throw e.value}))},nt=function(t){return 1!==t.rejection&&!t.parent},et=function(t,n){A.call(f,(function(){X?B.emit("rejectionHandled",t):J("rejectionhandled",t,n.value)}))},rt=function(t,n,e,r){return function(i){t(n,e,i,r)}},it=function(t,n,e,r){n.done||(n.done=!0,r&&(n=r),n.value=e,n.state=2,K(t,n,!0))},ot=function(t,n,e,r){if(!n.done){n.done=!0,r&&(n=r);try{if(t===e)throw U("Promise can't be resolved itself");var i=Z(e);i?M((function(){var r={done:!1};try{i.call(e,rt(ot,t,r,n),rt(it,t,r,n))}catch(e){it(t,r,e,n)}})):(n.value=e,n.state=1,K(t,n,!1))}catch(e){it(t,{done:!1},e,n)}}};G&&(L=function(t){m(this,L,D),g(t),r.call(this);var n=j(this);try{t(rt(ot,this,n),rt(it,this,n))}catch(t){it(this,n,t)}},(r=function(t){z(this,{type:D,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=d(L.prototype,{then:function(t,n){var e=V(this),r=q(S(this,L));return r.ok="function"!=typeof t||t,r.fail="function"==typeof n&&n,r.domain=X?B.domain:void 0,e.parent=!0,e.reactions.push(r),0!=e.state&&K(this,e,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),i=function(){var t=new r,n=j(t);this.promise=t,this.resolve=rt(ot,t,n),this.reject=rt(it,t,n)},E.f=q=function(t){return t===L||t===o?new i(t):Y(t)},c||"function"!=typeof l||(a=l.prototype.then,h(l.prototype,"then",(function(t,n){var e=this;return new L((function(t,n){a.call(e,t,n)})).then(t,n)}),{unsafe:!0}),"function"==typeof H&&u({global:!0,enumerable:!0,forced:!0},{fetch:function(t){return k(L,H.apply(f,arguments))}}))),u({global:!0,wrap:!0,forced:G},{Promise:L}),p(L,D,!1,!0),y(D),o=s(D),u({target:D,stat:!0,forced:G},{reject:function(t){var n=q(this);return n.reject.call(void 0,t),n.promise}}),u({target:D,stat:!0,forced:c||G},{resolve:function(t){return k(c&&this===o?L:this,t)}}),u({target:D,stat:!0,forced:Q},{all:function(t){var n=this,e=q(n),r=e.resolve,i=e.reject,o=C((function(){var e=g(n.resolve),o=[],a=0,u=1;_(t,(function(t){var c=a++,f=!1;o.push(void 0),u++,e.call(n,t).then((function(t){f||(f=!0,o[c]=t,--u||r(o))}),i)})),--u||r(o)}));return o.error&&i(o.value),e.promise},race:function(t){var n=this,e=q(n),r=e.reject,i=C((function(){var i=g(n.resolve);_(t,(function(t){i.call(n,t).then(e.resolve,r)}))}));return i.error&&r(i.value),e.promise}})},98377:function(t,n,e){var r=e(91342),i=e(8796),o=e(63282),a=e(51081),u=e(91138),c=i("Reflect","apply"),f=Function.apply;r({target:"Reflect",stat:!0,forced:!u((function(){c((function(){}))}))},{apply:function(t,n,e){return o(t),a(e),c?c(t,n,e):f.call(t,n,e)}})},86990:function(t,n,e){var r=e(91342),i=e(8796),o=e(63282),a=e(51081),u=e(74846),c=e(84207),f=e(97658),s=e(91138),l=i("Reflect","construct"),h=s((function(){function t(){}return!(l((function(){}),[],t)instanceof t)})),d=!s((function(){l((function(){}))})),p=h||d;r({target:"Reflect",stat:!0,forced:p,sham:p},{construct:function(t,n){o(t),a(n);var e=arguments.length<3?t:o(arguments[2]);if(d&&!h)return l(t,n,e);if(t==e){switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3])}var r=[null];return r.push.apply(r,n),new(f.apply(t,r))}var i=e.prototype,s=c(u(i)?i:Object.prototype),p=Function.apply.call(t,s,n);return u(p)?p:s}})},57810:function(t,n,e){var r=e(91342),i=e(51081),o=e(94983).f;r({target:"Reflect",stat:!0},{deleteProperty:function(t,n){var e=o(i(t),n);return!(e&&!e.configurable)&&delete t[n]}})},38516:function(t,n,e){var r=e(91342),i=e(51081),o=e(76075);r({target:"Reflect",stat:!0,sham:!e(72833)},{getPrototypeOf:function(t){return o(i(t))}})},56058:function(t,n,e){var r=e(91342),i=e(74846),o=e(51081),a=e(63786),u=e(94983),c=e(76075);r({target:"Reflect",stat:!0},{get:function t(n,e){var r,f,s=arguments.length<3?n:arguments[2];return o(n)===s?n[e]:(r=u.f(n,e))?a(r,"value")?r.value:void 0===r.get?void 0:r.get.call(s):i(f=c(n))?t(f,e,s):void 0}})},2880:function(t,n,e){"use strict";var r=e(91342),i=e(29372),o=e(51631);r({target:"String",proto:!0,forced:!e(26681)("includes")},{includes:function(t){return!!~String(o(this)).indexOf(i(t),arguments.length>1?arguments[1]:void 0)}})},43414:function(t,n,e){"use strict";var r=e(4884).charAt,i=e(47207),o=e(39779),a="String Iterator",u=i.set,c=i.getterFor(a);o(String,"String",(function(t){u(this,{type:a,string:String(t),index:0})}),(function(){var t,n=c(this),e=n.string,i=n.index;return i>=e.length?{value:void 0,done:!0}:(t=r(e,i),n.index+=t.length,{value:t,done:!1})}))},8216:function(t,n,e){"use strict";var r,i=e(91342),o=e(94983).f,a=e(1784),u=e(29372),c=e(51631),f=e(26681),s=e(42016),l="".startsWith,h=Math.min,d=f("startsWith");i({target:"String",proto:!0,forced:!!(s||d||(r=o(String.prototype,"startsWith"),!r||r.writable))&&!d},{startsWith:function(t){var n=String(c(this));u(t);var e=a(h(arguments.length>1?arguments[1]:void 0,n.length)),r=String(t);return l?l.call(n,r,e):n.slice(e,e+r.length)===r}})},94255:function(t,n,e){"use strict";var r=e(91342),i=e(9294).trim;r({target:"String",proto:!0,forced:e(64147)("trim")},{trim:function(){return i(this)}})},27200:function(t,n,e){e(31241)("asyncIterator")},76733:function(){},65101:function(t,n,e){e(31241)("hasInstance")},22392:function(t,n,e){e(31241)("isConcatSpreadable")},53310:function(t,n,e){e(31241)("iterator")},72216:function(t,n,e){"use strict";var r=e(91342),i=e(34023),o=e(8796),a=e(42016),u=e(9312),c=e(69334),f=e(9708),s=e(91138),l=e(63786),h=e(10251),d=e(74846),p=e(51081),y=e(81065),v=e(99743),g=e(76745),m=e(6095),b=e(84207),x=e(25211),_=e(67850),w=e(5216),S=e(50282),A=e(94983),M=e(76232),k=e(9143),T=e(78177),E=e(8542),C=e(21501),O=e(17132),P=e(19470),N=e(16502),I=e(62534),R=e(78928),D=e(31241),j=e(25196),z=e(47207),V=e(97826).forEach,L=O("hidden"),U="Symbol",F=I("toPrimitive"),B=z.set,H=z.getterFor(U),q=Object.prototype,Y=i.Symbol,X=o("JSON","stringify"),$=A.f,W=M.f,G=w.f,Q=k.f,Z=C("symbols"),K=C("op-symbols"),J=C("string-to-symbol-registry"),tt=C("symbol-to-string-registry"),nt=C("wks"),et=i.QObject,rt=!et||!et.prototype||!et.prototype.findChild,it=u&&s((function(){return 7!=b(W({},"a",{get:function(){return W(this,"a",{value:7}).a}})).a}))?function(t,n,e){var r=$(q,n);r&&delete q[n],W(t,n,e),r&&t!==q&&W(q,n,r)}:W,ot=function(t,n){var e=Z[t]=b(Y.prototype);return B(e,{type:U,tag:t,description:n}),u||(e.description=n),e},at=f?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof Y},ut=function(t,n,e){t===q&&ut(K,n,e),p(t);var r=g(n,!0);return p(e),l(Z,r)?(e.enumerable?(l(t,L)&&t[L][r]&&(t[L][r]=!1),e=b(e,{enumerable:m(0,!1)})):(l(t,L)||W(t,L,m(1,{})),t[L][r]=!0),it(t,r,e)):W(t,r,e)},ct=function(t,n){p(t);var e=v(n),r=x(e).concat(ht(e));return V(r,(function(n){u&&!ft.call(e,n)||ut(t,n,e[n])})),t},ft=function(t){var n=g(t,!0),e=Q.call(this,n);return!(this===q&&l(Z,n)&&!l(K,n))&&(!(e||!l(this,n)||!l(Z,n)||l(this,L)&&this[L][n])||e)},st=function(t,n){var e=v(t),r=g(n,!0);if(e!==q||!l(Z,r)||l(K,r)){var i=$(e,r);return!i||!l(Z,r)||l(e,L)&&e[L][r]||(i.enumerable=!0),i}},lt=function(t){var n=G(v(t)),e=[];return V(n,(function(t){l(Z,t)||l(P,t)||e.push(t)})),e},ht=function(t){var n=t===q,e=G(n?K:v(t)),r=[];return V(e,(function(t){!l(Z,t)||n&&!l(q,t)||r.push(Z[t])})),r};(c||(E((Y=function(){if(this instanceof Y)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,n=N(t),e=function(t){this===q&&e.call(K,t),l(this,L)&&l(this[L],n)&&(this[L][n]=!1),it(this,n,m(1,t))};return u&&rt&&it(q,n,{configurable:!0,set:e}),ot(n,t)}).prototype,"toString",(function(){return H(this).tag})),E(Y,"withoutSetter",(function(t){return ot(N(t),t)})),k.f=ft,M.f=ut,A.f=st,_.f=w.f=lt,S.f=ht,R.f=function(t){return ot(I(t),t)},u&&(W(Y.prototype,"description",{configurable:!0,get:function(){return H(this).description}}),a||E(q,"propertyIsEnumerable",ft,{unsafe:!0}))),r({global:!0,wrap:!0,forced:!c,sham:!c},{Symbol:Y}),V(x(nt),(function(t){D(t)})),r({target:U,stat:!0,forced:!c},{for:function(t){var n=String(t);if(l(J,n))return J[n];var e=Y(n);return J[n]=e,tt[e]=n,e},keyFor:function(t){if(!at(t))throw TypeError(t+" is not a symbol");if(l(tt,t))return tt[t]},useSetter:function(){rt=!0},useSimple:function(){rt=!1}}),r({target:"Object",stat:!0,forced:!c,sham:!u},{create:function(t,n){return void 0===n?b(t):ct(b(t),n)},defineProperty:ut,defineProperties:ct,getOwnPropertyDescriptor:st}),r({target:"Object",stat:!0,forced:!c},{getOwnPropertyNames:lt,getOwnPropertySymbols:ht}),r({target:"Object",stat:!0,forced:s((function(){S.f(1)}))},{getOwnPropertySymbols:function(t){return S.f(y(t))}}),X)&&r({target:"JSON",stat:!0,forced:!c||s((function(){var t=Y();return"[null]"!=X([t])||"{}"!=X({a:t})||"{}"!=X(Object(t))}))},{stringify:function(t,n,e){for(var r,i=[t],o=1;arguments.length>o;)i.push(arguments[o++]);if(r=n,(d(n)||void 0!==t)&&!at(t))return h(n)||(n=function(t,n){if("function"==typeof r&&(n=r.call(this,t,n)),!at(n))return n}),i[1]=n,X.apply(null,i)}});Y.prototype[F]||T(Y.prototype,F,Y.prototype.valueOf),j(Y,U),P[L]=!0},99467:function(t,n,e){e(31241)("matchAll")},13253:function(t,n,e){e(31241)("match")},67963:function(t,n,e){e(31241)("replace")},5966:function(t,n,e){e(31241)("search")},81981:function(t,n,e){e(31241)("species")},66621:function(t,n,e){e(31241)("split")},85710:function(t,n,e){e(31241)("toPrimitive")},25516:function(t,n,e){e(31241)("toStringTag")},5634:function(t,n,e){e(31241)("unscopables")},49744:function(t,n,e){"use strict";var r=e(91342),i=e(9312),o=e(76075),a=e(66200),u=e(84207),c=e(76232),f=e(6095),s=e(71760),l=e(78177),h=e(47207),d=h.set,p=h.getterFor("AggregateError"),y=function(t,n){var e=this;if(!(e instanceof y))return new y(t,n);a&&(e=a(new Error(n),o(e)));var r=[];return s(t,r.push,r),i?d(e,{errors:r,type:"AggregateError"}):e.errors=r,void 0!==n&&l(e,"message",String(n)),e};y.prototype=u(Error.prototype,{constructor:f(5,y),message:f(5,""),name:f(5,"AggregateError")}),i&&c.f(y.prototype,"errors",{get:function(){return p(this).errors},configurable:!0}),r({global:!0},{AggregateError:y})},84335:function(t,n,e){e(94958)},17002:function(t,n,e){"use strict";var r=e(91342),i=e(63282),o=e(8796),a=e(4561),u=e(95908),c=e(71760),f="No one promise resolved";r({target:"Promise",stat:!0},{any:function(t){var n=this,e=a.f(n),r=e.resolve,s=e.reject,l=u((function(){var e=i(n.resolve),a=[],u=0,l=1,h=!1;c(t,(function(t){var i=u++,c=!1;a.push(void 0),l++,e.call(n,t).then((function(t){c||h||(h=!0,r(t))}),(function(t){c||h||(c=!0,a[i]=t,--l||s(new(o("AggregateError"))(a,f)))}))})),--l||s(new(o("AggregateError"))(a,f))}));return l.error&&s(l.value),e.promise}})},57488:function(t,n,e){"use strict";var r=e(91342),i=e(4561),o=e(95908);r({target:"Promise",stat:!0},{try:function(t){var n=i.f(this),e=o(t);return(e.error?n.reject:n.resolve)(e.value),n.promise}})},36841:function(t,n,e){e(31241)("asyncDispose")},18971:function(t,n,e){e(31241)("dispose")},4405:function(t,n,e){e(31241)("observable")},25867:function(t,n,e){e(31241)("patternMatch")},55281:function(t,n,e){e(31241)("replaceAll")},88997:function(t,n,e){e(64116);var r=e(33702),i=e(34023),o=e(60516),a=e(78177),u=e(57435),c=e(62534)("toStringTag");for(var f in r){var s=i[f],l=s&&s.prototype;l&&o(l)!==c&&a(l,c,f),u[f]=u.Array}},62749:function(t,n,e){var r=e(15083);t.exports=r},78726:function(t,n,e){var r=e(38579);t.exports=r},31358:function(t,n,e){var r=e(21614);t.exports=r},48420:function(t,n,e){var r=e(21530);t.exports=r},62033:function(t,n,e){var r=e(62863);t.exports=r},12451:function(t,n,e){var r=e(3766);t.exports=r},71232:function(t,n,e){var r=e(60475);t.exports=r},21075:function(t,n,e){var r=e(97190);t.exports=r},10938:function(t,n,e){var r=e(89408);t.exports=r},77572:function(t,n,e){var r=e(79038);t.exports=r},83497:function(t,n,e){e(88997);var r=e(31358),i=e(60516),o=Array.prototype,a={DOMTokenList:!0,NodeList:!0};t.exports=function(t){var n=t.forEach;return t===o||t instanceof Array&&n===o.forEach||a.hasOwnProperty(i(t))?r:n}},26202:function(t,n,e){var r=e(46699);t.exports=r},69238:function(t,n,e){var r=e(94270);t.exports=r},79937:function(t,n,e){var r=e(60625);t.exports=r},64263:function(t,n,e){var r=e(98770);t.exports=r},5832:function(t,n,e){var r=e(60207);t.exports=r},54023:function(t,n,e){var r=e(99582);t.exports=r},11294:function(t,n,e){var r=e(25975);t.exports=r},66457:function(t,n,e){var r=e(96802);t.exports=r},63156:function(t,n,e){var r=e(2555);t.exports=r},11214:function(t,n,e){e(88997);var r=e(48420),i=e(60516),o=Array.prototype,a={DOMTokenList:!0,NodeList:!0};t.exports=function(t){var n=t.values;return t===o||t instanceof Array&&n===o.values||a.hasOwnProperty(i(t))?r:n}},91160:function(t,n,e){var r=e(22705);t.exports=r},81467:function(t,n,e){var r=e(57310);t.exports=r},67581:function(t,n,e){var r=e(63791);t.exports=r},69276:function(t,n,e){var r=e(50564);t.exports=r},68982:function(t,n,e){var r=e(49574);t.exports=r},94541:function(t,n,e){var r=e(97853);t.exports=r},22130:function(t,n,e){var r=e(19300);t.exports=r},15589:function(t,n,e){var r=e(60761);t.exports=r},24222:function(t,n,e){var r=e(80164);t.exports=r},40166:function(t,n,e){var r=e(12534);t.exports=r},34057:function(t,n,e){var r=e(73699);t.exports=r},97253:function(t,n,e){var r=e(8483);t.exports=r},37524:function(t,n,e){var r=e(48530);t.exports=r},80101:function(t,n,e){var r=e(62839);t.exports=r},3543:function(t,n,e){var r=e(11050);t.exports=r},69264:function(t,n,e){t.exports={ResizeSensor:e(6118),ElementQueries:e(98415)}},98415:function(t,n,e){"use strict";var r,i,o;"undefined"!=typeof window&&window,i=[e(6118)],void 0===(o="function"==typeof(r=function(t){var n=function(){var n,e={},r=[];function i(t){t||(t=document.documentElement);var n=window.getComputedStyle(t,null).fontSize;return parseFloat(n)||16}function o(t){if(!t.getBoundingClientRect)return{width:t.offsetWidth,height:t.offsetHeight};var n=t.getBoundingClientRect();return{width:Math.round(n.width),height:Math.round(n.height)}}function a(t,n){var e=n.split(/\d/),r=e[e.length-1];switch(n=parseFloat(n),r){case"px":return n;case"em":return n*i(t);case"rem":return n*i();case"vw":return n*document.documentElement.clientWidth/100;case"vh":return n*document.documentElement.clientHeight/100;case"vmin":case"vmax":var o=document.documentElement.clientWidth/100,a=document.documentElement.clientHeight/100;return n*(0,Math["vmin"===r?"min":"max"])(o,a);default:return n}}function u(t,n){var r,i,u,c,f,s,l,h;this.element=t;var d=["min-width","min-height","max-width","max-height"];this.call=function(){for(r in u=o(this.element),s={},e[n])e[n].hasOwnProperty(r)&&(i=e[n][r],c=a(this.element,i.value),f="width"===i.property?u.width:u.height,h=i.mode+"-"+i.property,l="","min"===i.mode&&f>=c&&(l+=i.value),"max"===i.mode&&f<=c&&(l+=i.value),s[h]||(s[h]=""),l&&-1===(" "+s[h]+" ").indexOf(" "+l+" ")&&(s[h]+=" "+l));for(var t in d)d.hasOwnProperty(t)&&(s[d[t]]?this.element.setAttribute(d[t],s[d[t]].substr(1)):this.element.removeAttribute(d[t]))}}function c(n,e){n.elementQueriesSetupInformation||(n.elementQueriesSetupInformation=new u(n,e)),n.elementQueriesSensor||(n.elementQueriesSensor=new t(n,(function(){n.elementQueriesSetupInformation.call()})))}function f(t,i,o,a){if(void 0===e[t]){e[t]=[];var u=r.length;n.innerHTML+="\n"+t+" {animation: 0.1s element-queries;}",n.innerHTML+="\n"+t+" > .resize-sensor {min-width: "+u+"px;}",r.push(t)}e[t].push({mode:i,property:o,value:a})}function s(t){var n;if(document.querySelectorAll&&(n=t?t.querySelectorAll.bind(t):document.querySelectorAll.bind(document)),n||"undefined"==typeof $$||(n=$$),n||"undefined"==typeof jQuery||(n=jQuery),!n)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return n}function l(t){var n=s(t);for(var r in e)if(e.hasOwnProperty(r))for(var i=n(r,t),o=0,a=i.length;o<a;o++)c(i[o],r)}function h(n){var e=[],r=[],i=[],o=0,a=-1,u=[];for(var c in n.children)if(n.children.hasOwnProperty(c)&&n.children[c].tagName&&"img"===n.children[c].tagName.toLowerCase()){e.push(n.children[c]);var f=n.children[c].getAttribute("min-width")||n.children[c].getAttribute("data-min-width"),s=n.children[c].getAttribute("data-src")||n.children[c].getAttribute("url");i.push(s);var l={minWidth:f};r.push(l),f?n.children[c].style.display="none":(o=e.length-1,n.children[c].style.display="block")}function h(){var t,c=!1;for(t in e)e.hasOwnProperty(t)&&r[t].minWidth&&n.offsetWidth>r[t].minWidth&&(c=t);if(c||(c=o),a!==c)if(u[c])e[a].style.display="none",e[c].style.display="block",a=c;else{var f=new Image;f.onload=function(){e[c].src=i[c],e[a].style.display="none",e[c].style.display="block",u[c]=!0,a=c},f.src=i[c]}else e[c].src=i[c]}a=o,n.resizeSensorInstance=new t(n,h),h()}function d(){for(var t=s()("[data-responsive-image],[responsive-image]"),n=0,e=t.length;n<e;n++)h(t[n])}var p=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,y=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim;function v(t){var n,e,r,i;for(t=t.replace(/'/g,'"');null!==(n=p.exec(t));)for(e=n[1]+n[3],r=n[2];null!==(i=y.exec(r));)f(e,i[1],i[2],i[3])}function g(t){var n="";if(t)if("string"==typeof t)-1===(t=t.toLowerCase()).indexOf("min-width")&&-1===t.indexOf("max-width")||v(t);else for(var e=0,r=t.length;e<r;e++)1===t[e].type?-1!==(n=t[e].selectorText||t[e].cssText).indexOf("min-height")||-1!==n.indexOf("max-height")?v(n):-1===n.indexOf("min-width")&&-1===n.indexOf("max-width")||v(n):4===t[e].type?g(t[e].cssRules||t[e].rules):3===t[e].type&&t[e].styleSheet.hasOwnProperty("cssRules")&&g(t[e].styleSheet.cssRules)}var m=!1;this.init=function(){var e="animationstart";void 0!==document.documentElement.style.webkitAnimationName?e="webkitAnimationStart":void 0!==document.documentElement.style.MozAnimationName?e="mozanimationstart":void 0!==document.documentElement.style.OAnimationName&&(e="oanimationstart"),document.body.addEventListener(e,(function(n){var e=n.target,i=e&&window.getComputedStyle(e,null),o=i&&i.getPropertyValue("animation-name");if(o&&-1!==o.indexOf("element-queries")){e.elementQueriesSensor=new t(e,(function(){e.elementQueriesSetupInformation&&e.elementQueriesSetupInformation.call()}));var a=window.getComputedStyle(e.resizeSensor,null).getPropertyValue("min-width");a=parseInt(a.replace("px","")),c(n.target,r[a])}})),m||((n=document.createElement("style")).type="text/css",n.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",n.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(n),m=!0);for(var i=0,o=document.styleSheets.length;i<o;i++)try{document.styleSheets[i].href&&document.styleSheets[i].href.indexOf("file://"),g(document.styleSheets[i].cssRules||document.styleSheets[i].rules||document.styleSheets[i].cssText)}catch(t){}d()},this.findElementQueriesElements=function(t){l(t)},this.update=function(){this.init()}};n.update=function(){n.instance.update()},n.detach=function(t){t.elementQueriesSetupInformation?(t.elementQueriesSensor.detach(),delete t.elementQueriesSetupInformation,delete t.elementQueriesSensor):t.resizeSensorInstance&&(t.resizeSensorInstance.detach(),delete t.resizeSensorInstance)},n.init=function(){n.instance||(n.instance=new n),n.instance.init()};var e=function(t){if(document.addEventListener)document.addEventListener("DOMContentLoaded",t,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var n=setInterval((function(){/loaded|complete/i.test(document.readyState)&&(t(),clearInterval(n))}),10);else window.onload=t};return n.findElementQueriesElements=function(t){n.instance.findElementQueriesElements(t)},n.listen=function(){e(n.init)},n})?r.apply(n,i):r)||(t.exports=o)},6118:function(t,n,e){"use strict";var r,i;"undefined"!=typeof window&&window,void 0===(i="function"==typeof(r=function(){if("undefined"==typeof window)return null;var t="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),n=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||function(n){return t.setTimeout(n,20)},e=t.cancelAnimationFrame||t.mozCancelAnimationFrame||t.webkitCancelAnimationFrame||function(n){t.clearTimeout(n)};function r(t,n){var e=Object.prototype.toString.call(t),r="[object Array]"===e||"[object NodeList]"===e||"[object HTMLCollection]"===e||"[object Object]"===e||"undefined"!=typeof jQuery&&t instanceof jQuery||"undefined"!=typeof Elements&&t instanceof Elements,i=0,o=t.length;if(r)for(;i<o;i++)n(t[i]);else n(t)}function i(t){if(!t.getBoundingClientRect)return{width:t.offsetWidth,height:t.offsetHeight};var n=t.getBoundingClientRect();return{width:Math.round(n.width),height:Math.round(n.height)}}function o(t,n){Object.keys(n).forEach((function(e){t.style[e]=n[e]}))}var a=function(t,u){var c=0;function f(){var t,n,e=[];this.add=function(t){e.push(t)},this.call=function(r){for(t=0,n=e.length;t<n;t++)e[t].call(this,r)},this.remove=function(r){var i=[];for(t=0,n=e.length;t<n;t++)e[t]!==r&&i.push(e[t]);e=i},this.length=function(){return e.length}}function s(t,e){if(t)if(t.resizedAttached)t.resizedAttached.add(e);else{t.resizedAttached=new f,t.resizedAttached.add(e),t.resizeSensor=document.createElement("div"),t.resizeSensor.dir="ltr",t.resizeSensor.className="resize-sensor";var r={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},a={position:"absolute",left:"0px",top:"0px",transition:"0s"};o(t.resizeSensor,r);var u=document.createElement("div");u.className="resize-sensor-expand",o(u,r);var s=document.createElement("div");o(s,a),u.appendChild(s);var l=document.createElement("div");l.className="resize-sensor-shrink",o(l,r);var h=document.createElement("div");o(h,a),o(h,{width:"200%",height:"200%"}),l.appendChild(h),t.resizeSensor.appendChild(u),t.resizeSensor.appendChild(l),t.appendChild(t.resizeSensor);var d=window.getComputedStyle(t),p=d?d.getPropertyValue("position"):null;"absolute"!==p&&"relative"!==p&&"fixed"!==p&&"sticky"!==p&&(t.style.position="relative");var y=!1,v=0,g=i(t),m=0,b=0,x=!0;c=0;var _=function(){var n=t.offsetWidth,e=t.offsetHeight;s.style.width=n+10+"px",s.style.height=e+10+"px",u.scrollLeft=n+10,u.scrollTop=e+10,l.scrollLeft=n+10,l.scrollTop=e+10},w=function(){if(x){if(0===t.offsetWidth&&0===t.offsetHeight)return void(c||(c=n((function(){c=0,w()}))));x=!1}_()};t.resizeSensor.resetSensor=w;var S=function(){v=0,y&&(m=g.width,b=g.height,t.resizedAttached&&t.resizedAttached.call(g))},A=function(){g=i(t),(y=g.width!==m||g.height!==b)&&!v&&(v=n(S)),w()},M=function(t,n,e){t.attachEvent?t.attachEvent("on"+n,e):t.addEventListener(n,e)};M(u,"scroll",A),M(l,"scroll",A),c=n((function(){c=0,w()}))}}r(t,(function(t){s(t,u)})),this.detach=function(n){c||(e(c),c=0),a.detach(t,n)},this.reset=function(){t.resizeSensor.resetSensor()}};if(a.reset=function(t){r(t,(function(t){t.resizeSensor.resetSensor()}))},a.detach=function(t,n){r(t,(function(t){t&&(t.resizedAttached&&"function"==typeof n&&(t.resizedAttached.remove(n),t.resizedAttached.length())||t.resizeSensor&&(t.contains(t.resizeSensor)&&t.removeChild(t.resizeSensor),delete t.resizeSensor,delete t.resizedAttached))}))},"undefined"!=typeof MutationObserver){var u=new MutationObserver((function(t){for(var n in t)if(t.hasOwnProperty(n))for(var e=t[n].addedNodes,r=0;r<e.length;r++)e[r].resizeSensor&&a.reset(e[r])}));document.addEventListener("DOMContentLoaded",(function(t){u.observe(document.body,{childList:!0,subtree:!0})}))}return a})?r.call(n,e,n,t):r)||(t.exports=i)},62930:function(t){(function(){var n,e,r,i,o,a;"undefined"!=typeof performance&&null!==performance&&performance.now?t.exports=function(){return performance.now()}:"undefined"!=typeof process&&null!==process&&process.hrtime?(t.exports=function(){return(n()-o)/1e6},e=process.hrtime,i=(n=function(){var t;return 1e9*(t=e())[0]+t[1]})(),a=1e9*process.uptime(),o=i-a):Date.now?(t.exports=function(){return Date.now()-r},r=Date.now()):(t.exports=function(){return(new Date).getTime()-r},r=(new Date).getTime())}).call(this)},48729:function(t,n,e){for(var r=e(62930),i="undefined"==typeof window?e.g:window,o=["moz","webkit"],a="AnimationFrame",u=i["request"+a],c=i["cancel"+a]||i["cancelRequest"+a],f=0;!u&&f<o.length;f++)u=i[o[f]+"Request"+a],c=i[o[f]+"Cancel"+a]||i[o[f]+"CancelRequest"+a];if(!u||!c){var s=0,l=0,h=[];u=function(t){if(0===h.length){var n=r(),e=Math.max(0,16.666666666666668-(n-s));s=e+n,setTimeout((function(){var t=h.slice(0);h.length=0;for(var n=0;n<t.length;n++)if(!t[n].cancelled)try{t[n].callback(s)}catch(t){setTimeout((function(){throw t}),0)}}),Math.round(e))}return h.push({handle:++l,callback:t,cancelled:!1}),l},c=function(t){for(var n=0;n<h.length;n++)h[n].handle===t&&(h[n].cancelled=!0)}}t.exports=function(t){return u.call(i,t)},t.exports.cancel=function(){c.apply(i,arguments)},t.exports.polyfill=function(t){t||(t=i),t.requestAnimationFrame=u,t.cancelAnimationFrame=c}},31091:function(t){t.exports=function(t){this.ok=!1,this.alpha=1,"#"==t.charAt(0)&&(t=t.substr(1,6)),t=(t=t.replace(/ /g,"")).toLowerCase();var n={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};t=n[t]||t;for(var e=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),parseFloat(t[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,example:["#00ff00","336699"],process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,example:["#fb0","f0f"],process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],r=0;r<e.length;r++){var i=e[r].re,o=e[r].process,a=i.exec(t);if(a){var u=o(a);this.r=u[0],this.g=u[1],this.b=u[2],u.length>3&&(this.alpha=u[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.alpha=this.alpha<0?0:this.alpha>1||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var t=this.r.toString(16),n=this.g.toString(16),e=this.b.toString(16);return 1==t.length&&(t="0"+t),1==n.length&&(n="0"+n),1==e.length&&(e="0"+e),"#"+t+n+e},this.getHelpXML=function(){for(var t=new Array,r=0;r<e.length;r++)for(var i=e[r].example,o=0;o<i.length;o++)t[t.length]=i[o];for(var a in n)t[t.length]=a;var u=document.createElement("ul");u.setAttribute("id","rgbcolor-examples");for(r=0;r<t.length;r++)try{var c=document.createElement("li"),f=new RGBColor(t[r]),s=document.createElement("div");s.style.cssText="margin: 3px; border: 1px solid black; background:"+f.toHex()+"; color:"+f.toHex(),s.appendChild(document.createTextNode("test"));var l=document.createTextNode(" "+t[r]+" -> "+f.toRGB()+" -> "+f.toHex());c.appendChild(s),c.appendChild(l),u.appendChild(c)}catch(t){}return u}}}}]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:macro-browser-resources', location = 'build/macro-browser.js' */
!function(){"use strict";var e={75208:function(e,t,a){a.r(t);a(42681);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){e.find("option").each((function(){var e=$(this),a=e.attr("value");e.text(t[a].title)}))}function o(e,t,a,r){if(!t.__multiSelect){var o=Object.keys(t),s=a[r],c=t[s]?s:o[0];a[r]=c,e.change((function(){var a=e.val();i(a,r,t,"hidden"),i(a,r,t,"shown"),function(e,t,a){a.__default&&n(a.__default.labels);"object"!==l(e)&&n(a[e].labels)}(a,0,t)})).val(c).trigger("change")}}function i(e,t,a,l){var r="tfac-"+l+"-"+t;$("."+r).removeClass(r);var o=a[e];if(o){var i=o[l+"Params"];if(i){var n=i.map((function(e){return"#macro-param-div-"+e}));$(n.join(",")).addClass(r)}}}function n(e){e&&$.each(e,(function(e,t){$("#macro-param-div-"+e).find("label").text(t)}))}var s={initSelects:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};$.each(e,(function(a){var l=$("#macro-param-"+a),i=e[a];r(l,i),o(l,i,t,a)}))}},c=a(14738),m=a(21297),p=a.n(m),u=a(23746),d=a(14978);function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var a=0;a<t.length;a++){var l=t[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}var b=function(){function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){e()};f(this,e),this.url=t,this.requestAuth=a}var t,a,l;return t=e,(a=[{key:"transformElements",value:function(e){this.initSelects(e),this.initEncodingInput(),this.initAuthDialog(e),this.initHeaderDialog(e),this.bindURL()}},{key:"initSelects",value:function(e){var t={source:{url:{title:"URL",hiddenParams:["attachment"]},attachment:{title:"Attachment",hiddenParams:["url","auth-type","set-auth","set-header"]}},"auth-type":{basic:{title:"Login and password",hiddenParams:["set-header"]},header:{title:"Custom",hiddenParams:["set-auth"]}},format:{plain:{title:"Plain text"},wiki:{title:"Wiki markup"},markdown:{title:"Markdown"}}};s.initSelects(t,e)}},{key:"initEncodingInput",value:function(){d.default.inputAutocomplete($("#macro-param-encoding"),null,[{value:"UTF-8"},{value:"UTF-16"},{value:"UTF-16LE"},{value:"UTF-16BE"},{value:"UTF-32"},{value:"ISO-8859-1"},{value:"US-ASCII"}])}},{key:"initAuthDialog",value:function(e){var t=this,a="tf-auth-dialog",l=$("#macro-param-div-set-auth"),r=$("#macro-param-auth");e&&e.auth&&"header"!==e["auth-type"]&&l.find("label").text("Change login and password"),(0,u.initMacroBrowserAJSDialog)(l,{dialogName:a,dialogId:a,options:{persistent:!0,width:270,gravity:"w"},getContent:function(){var e=[{field:"Login",value:"",variant:c.default.FIELD_VARIANTS.TEXT},{field:"Password",value:"",variant:c.default.FIELD_VARIANTS.PASSWORD}];return p().inlineDialog({clazz:a,name:"auth",inputs:e,dialogId:a})},applyCallback:function(e){var l=e.popup.find("form").find("input"),o=l.eq(0).val().trim(),i=l.eq(1).val().trim(),n=$("#button-".concat(a," .name"));t.encodeAuth(o,i,(function(e){e?n.text("Change login and password"):n.text("Set login and password"),r.val(e)}))}})}},{key:"initHeaderDialog",value:function(e){var t=this,a="tf-header-dialog",l=$("#macro-param-div-set-header"),r=$("#macro-param-auth");e&&e.auth&&"header"===e["auth-type"]&&l.find("label").text("Change request header"),(0,u.initMacroBrowserAJSDialog)(l,{dialogName:a,dialogId:a,options:{persistent:!0,width:270,gravity:"w"},getContent:function(){var e=[{field:"Request header",value:"",variant:c.default.FIELD_VARIANTS.TEXT}];return p().inlineDialog({clazz:a,name:"header",inputs:e,dialogId:a})},applyCallback:function(e){var l=e.popup.find("form").find("input").val().trim(),o=$("#button-".concat(a," .name"));t.encodeHeader(l,(function(e){e?o.text("Change request header"):o.text("Set request header"),r.val(e)}))}})}},{key:"bindURL",value:function(){var e=this;$("#macro-param-url").change((function(){e.requestData&&e.makeRequest(e.requestData.url,e.requestData.data,e.requestData.callback)}))}},{key:"encodeAuth",value:function(e,t,a){e&&t?this.makeRequest(this.url+"/auth",{login:e,password:t},a):(this.requestData=null,a(""))}},{key:"encodeHeader",value:function(e,t){e?this.makeRequest(this.url+"/header",{header:e},t):(this.requestData=null,t(""))}},{key:"makeRequest",value:function(e,t,a){this.requestData={url:e,data:t,callback:a};var l=$("#macro-param-url").val().trim();this.requestAuth((function(r){t.url=l,t.jwt=r,$.ajax({contentType:"application/x-www-form-urlencoded; charset=utf-8",type:"POST",cache:!1,async:!1,url:e,dataType:"text",data:t,success:a})}))}}])&&g(t.prototype,a),l&&g(t,l),e}(),h=a(36845),v={"csv-table":"CSV","json-from-table":"JSON"},S=function(){};S.isSaveClick=!1,S.isSetParams=!1,S.storedParams={},S.prototype.beforeParamsSet=function(e){$("#macro-browser-dialog .macro-desc .macro-doco-link").before("Post \u003ca href=\u0022https://stiltsoft.customercase.com/forums/table-filter-for-confluence/ideas/create?from=macro\u0022\u003eIdea\u003c/a\u003e or \u003ca href=\u0022https://jsd.stiltsoft.com/servicedesk/customer/portal/2?from=macro\u0022\u003eIssue\u003c/a\u003e.   ");var t,a=new b(Confluence.getContextPath()+"/rest/table-filter/1.0/csv/encode");return function(e,t){"header"===e["auth-type"]?e.header&&(e.auth=t.encodeHeader(e.header)):e.login&&e.password&&(e.auth=t.encodeAuth(e.login,e.password));e.header="",e.login="",e.password=""}(e,a),a.transformElements(e),(t=$("#macro-param-attachment")).addClass("autocomplete-attachment").attr("data-template","{wikiLink}").attr("data-none-message","Nothing found"),Confluence.Binder.autocompleteAttachment(t.parent()),t.bind("selected.autocomplete-content",(function(e,a){var l=a.content.wikiLink.substring(1,a.content.wikiLink.length-1);if(AJS.params.spaceKey===a.content.space.key){var r=a.content.datePath?"/".concat(a.content.datePath,"/").concat(a.content.parentTitle):a.content.parentTitle;AJS.params.pageTitle!==r&&-1!==r.indexOf(":")||(l=l.replace("".concat(AJS.params.spaceKey,":"),""),AJS.params.pageTitle===r&&(l=l.replace("".concat(AJS.params.pageTitle,"^"),"")))}t.val(l)})),S.isSaveClick=!1,S.isSetParams=!0,e},S.prototype.postPreview=function(){S.isSaveClick=!1,S.isSetParams=!1},S.prototype.manipulateMarkup=function(e){return S.isSaveClick=!0,S.isSetParams=!1,e},S.prototype.beforeParamsRetrieved=function(e,t){return S.isSaveClick&&h.default.gaEditorDataSource(e,S.storedParams,v[t.macroName]),S.isSetParams&&(S.storedParams=e),e};var y=S,x=function(){};x.isSaveClick=!1,x.isSetParams=!1,x.storedParams={},x.prototype.beforeParamsSet=function(e){return function(e){var t=$("#macro-param-labels");e&&e.labels&&t.val(e.labels);t.auiSelect2(Confluence.UI.Components.LabelPicker.build({separator:",",queryOpts:{spaceKey:AJS.Meta.get("space-key")}}))}(e),function(e){var t={type:{this:{title:"Current page",hiddenParams:["page","labels","labels-operator","space"]},page:{title:"Specific page",hiddenParams:["copytable","labels","labels-operator","space"]},"page-children":{title:"Page and child pages",hiddenParams:["copytable","labels","labels-operator","space"]},"page-descendants":{title:"Page and all descendants",hiddenParams:["copytable","labels","labels-operator","space"]},labels:{title:"Pages with labels",hiddenParams:["copytable","page"]}},"labels-operator":{OR:{title:"at least one label"},AND:{title:"all the labels above"}}};s.initSelects(t,e)}(e),x.isSaveClick=!1,x.isSetParams=!0,e},x.prototype.postPreview=function(){x.isSaveClick=!1,x.isSetParams=!1},x.prototype.manipulateMarkup=function(e){return x.isSaveClick=!0,x.isSetParams=!1,e},x.prototype.beforeParamsRetrieved=function(e){return x.isSaveClick&&h.default.gaEditorExcerptInclude(e,x.storedParams),x.isSetParams&&(x.storedParams=e),e};var T=new x,C=a(58711),w={convertStorageToView:function(e){var t=e.body;return t.indexOf(' data-macro-name="')>=0&&t.indexOf(' data-macro-parameters="')>=0&&$.ajax({type:"POST",async:!1,url:Confluence.getContextPath()+"/rest/api/contentbody/convert/storage",contentType:"application/json",dataType:"json",data:JSON.stringify({value:t,representation:"editor"}),success:function(e){t=e.value}}),(t.indexOf("<ac:structured-macro")>=0||t.indexOf("<time")>=0)&&$.ajax({type:"POST",async:!1,url:Confluence.getContextPath()+"/rest/tinymce/1/macro/preview",contentType:"application/json; charset=utf-8",dataType:"html",data:JSON.stringify({contentId:d.default.getContentId(),macro:{name:e.name||"table-filter",body:t,params:{id:0}}}),success:function(e){t=e}}),t},showTabsParam:function(e){d.default.hasTabs($(e))||-1!==e.indexOf("macro 'spreadsheets'")||$("#macro-param-div-tabs").addClass("tf-very-hidden-param")}},P=function(e){var t=new C.default;if(!e.body){var a=tinymce.activeEditor.selection.getContent();$("<div></div>").html(a).children().length?e.body=a:e.body=""}e.bodyHtml=e.body,e.bodyView=w.convertStorageToView(e),e.params=e.params?e.params:{},e.params.id=(new Date).getTime()+"_"+d.default.hashCode(e.bodyView),e.params.hasTable=e.body.indexOf("table")>0,e.params.isFirstTimeEnter=e.params.hasTable?void 0===e.params.isFirstTimeEnter:void 0,t.showDialog(e,A,I,J,k),AJS.MacroBrowser.dialog&&(AJS.MacroBrowser.dialog.activeMetadata=null)};function A(e,t){e.params.isFirstTimeEnter=t,h.default.gaEditorTransformer(e.params,e.storedParams),tinymce.confluence.macrobrowser.macroBrowserComplete(e)}function I(){tinymce.confluence.macrobrowser.macroBrowserCancel()}function J(e,t){var a={contentId:d.default.getContentId(),macroName:e.name,params:e.params,body:e.bodyHtml,successCallback:function(e){t(e)},errorCallback:function(e){AJS.logError(e)}};AJS.MacroBrowser.Rest.fetchMacroPreviewData(a)}function k(){return AJS.params.staticResourceUrlPrefix+"/blank.html"}var O=AJS.MacroBrowser.previewOnload;AJS.MacroBrowser.previewOnload=function(e){if(AJS.MacroBrowser.dialog&&AJS.MacroBrowser.dialog.activeMetadata)return O(e)};var M=a(24291),F=a(22017),D=a(17324),_=a.n(D),B=a(16951),R=a.n(B),L=a(14731),N=function(){var e=this;e.tables=[],e.iconTables=[],e.tableColumns=[],e.sortColumns=[],e.columnSelect=null,e.userfilterSelect=null,e.numberfilterSelect=null,e.datefilterSelect=null,e.iconfilterSelect=null,e.sortSelect=null,e.columnParams=[],e.userfilterParams=[],e.numberfilterParams=[],e.datefilterParams=[],e.iconfilterParams=[],e.sortParams=[],e.dateFormatInput=null,e.dateFormatContainer=null,e.separatorContainer=null,e.tfBody="",e.defaults={},e.widths={},e.inverse={},e.gotBody=!1,e.order={},e.labels={},e.totalRow=[],e.locale=AJS.Meta.get("user-locale").replace("-","_")};function E(e,t){return!!e.val()&&-1!==e.val().indexOf(t)}N.prototype.getMacroDetails=function(e){var t=this;t.columnParams=[],t.userfilterParams=[],t.numberfilterParams=[],t.datefilterParams=[],t.iconfilterParams=[],t.sortParams=[],t.chosenUpdated=!1,t.gotBody=!0,t.tfBody=e,t.body=$('<div><div class="tablefilter-table-wrapper">'+e+"</div></div>"),t.tables=d.default.getTables(t.body),t.iconTables=d.default.getTables(t.body,d.default.visualType),t.tableColumns=d.default.getColumns(t.tables),t.sortColumns=[],$.each(t.tableColumns,(function(e,a){$.trim(a).length&&(t.sortColumns.push(a+" ⇧"),t.sortColumns.push(a+" ⇩"))}))},N.prototype.transformElements=function(e){var t=this;L.default.adaptOldParamsTF(e);var a={thousandSeparator:{"":{title:""},"\\u0020":{title:"Space ( )"},".":{title:"Point (.)"},",":{title:"Comma (,)"}},separator:{"Point (.)":{title:"Point (.)"},"Comma (,)":{title:"Comma (,)"}},isOR:{AND:{title:"AND"},OR:{title:"OR"}},numbering:{"":{title:""},"Dynamic Ascending":{title:"Dynamic Ascending"},"Static Ascending":{title:"Static Ascending"},"Dynamic Descending":{title:"Dynamic Descending"},"Static Descending":{title:"Static Descending"}},totalcol:{"":{title:"",hiddenParams:["totalColName","thousandSeparator"]},Sum:{title:"Sum",shownParams:["thousandSeparator"]},Average:{title:"Average",shownParams:["thousandSeparator"]},Multiplication:{title:"Multiplication",shownParams:["thousandSeparator"]},Min:{title:"Min",shownParams:["thousandSeparator"]},Max:{title:"Max",shownParams:["thousandSeparator"]}},hidePane:{"Filtration panel":{title:"Filtration panel"},"Table header":{title:"Table header",hiddenParams:["hidelabels","labels","disabled"]},true:{title:"Hidden",hiddenParams:["hidelabels","disableSave","hideControls"]}}};$("#macro-browser-dialog .macro-desc .macro-doco-link").before("Post \u003ca href=\u0022https://stiltsoft.customercase.com/forums/table-filter-for-confluence/ideas/create?from=macro\u0022\u003eIdea\u003c/a\u003e or \u003ca href=\u0022https://jsd.stiltsoft.com/servicedesk/customer/portal/2?from=macro\u0022\u003eIssue\u003c/a\u003e.   "),$("#macro-param-div-id").hide(),t.setTypeNumbers($("#macro-param-limitHeight"));var l=$("#macro-param-limitHeight");t.setTypeNumbers($("#macro-param-fixedCols")),t.setTypeNumbers($("#macro-param-rowsPerPage")),t.setTypeNumbers($("#macro-param-showNRowsifNotFiltered")),t.setTypeNumbers($("#macro-param-ignoreFirstNrows"));var r=[],o=[],i=[],n=[],c=[],m=[];null!=e.column&&(r=e.column.split(",")),null!=e.userfilter&&(o=e.userfilter.split(",")),e.sort&&(e.sort=e.sort.replace(/ \(\u200DDesc\)/g," ⇩").replace(/ \(\u200DAsc\)/g," ⇧"),m=e.sort.split(",")),null!=e.iconfilter&&(c=e.iconfilter.split(",")),null!=e.totalrow?t.totalRow=e.totalrow.split(","):t.totalRow=[],e.limitHeight="true"==e.limitHeight?1:e.limitHeight,function(e){e.globalFilter&&$("#macro-param-globalFilter").prop("checked",!0);e.hideColumns&&$("#macro-param-hideColumns").prop("checked",!0);e.hidePane&&$("#macro-param-hidePane").val(e.hidePane);e.hidelabels&&$("#macro-param-hidelabels").prop("checked",!0);e.hideControls&&$("#macro-param-hideControls").prop("checked",!0);e.disableSave&&$("#macro-param-disableSave").prop("checked",!0);e.separator&&$("#macro-param-separator").val(e.separator);e.showNRowsifNotFiltered&&$("#macro-param-showNRowsifNotFiltered").val(e.showNRowsifNotFiltered);e.rowsPerPage&&$("#macro-param-rowsPerPage").val(e.rowsPerPage);e.ignoreFirstNrows&&$("#macro-param-ignoreFirstNrows").val(e.ignoreFirstNrows);e.numbering&&$("#macro-param-numbering").val(e.numbering);e.limitHeight&&$("#macro-param-limitHeight").val(e.limitHeight);e.fixedCols&&$("#macro-param-fixedCols").val(e.fixedCols);e.ddSeparator&&$("#macro-param-ddSeparator").val(e.ddSeparator);e.isOR&&$("#macro-param-isOR").val(e.isOR);e.totalcol&&$("#macro-param-totalcol").val(e.totalcol);e.totalColName&&$("#macro-param-totalColName").val(e.totalColName);e.totalrow&&$("#macro-param-totalrow").val(e.totalrow);e.totalRowName&&$("#macro-param-totalRowName").val(e.totalRowName);"true"==e.disabled&&$("#macro-param-disabled").prop("checked",!0);e.tabs&&$("#macro-param-tabs").prop("checked",!0);e.updateSelectOptions&&$("#macro-param-updateSelectOptions").prop("checked",!0)}(e),t.separatorContainer=$("#macro-param-div-separator"),t.dateFormatInput=$("#macro-param-datepattern"),t.totalRowInput=$("#macro-param-totalrow"),null!=e.datefilter&&(n=e.datefilter.split(",")),null!=e.numberfilter&&(i=e.numberfilter.split(",")),!e.worklog&&F.default.getStoredValue("tf-updateSelectOptions")&&(e.updateSelectOptions=!0);var p=$("#macro-param-updateSelectOptions").change((function(){p.is(":checked")?F.default.storeValue("tf-updateSelectOptions",!0):F.default.removeValue("tf-updateSelectOptions")}));M.default.initDateFormatInput(e),u.default.initMacroBrowserWorklogDialog(e.worklog);var f=$("#macro-param-column"),g=$("#macro-param-userfilter"),b=$("#macro-param-datefilter"),h=$("#macro-param-numberfilter"),v=$("#macro-param-iconfilter"),S=$("#macro-param-sort"),y=$.merge([],r);$.merge(y,o),$.merge(y,n),$.merge(y,i),$.merge(y,c),$.each(y,(function(e,a){var l=$.trim(a.replace(/\‚/g,",")).replace("‌","");-1==$.inArray(l,t.tableColumns)&&(t.tableColumns.push(l),t.sortColumns.push(l+" ⇧"),t.sortColumns.push(l+" ⇩"))})),$.each(m,(function(e,a){var l=$.trim(a.replace(/\‚/g,","));-1==$.inArray(l,t.sortColumns)&&t.sortColumns.push(l)})),t.tableColumns.sort((function(e,t){return e.localeCompare(t)})),t.sortColumns.sort((function(e,t){return e.localeCompare(t)})),t.columnSelect=t.createSelect(f,t.tableColumns,r,t.columnParams),t.userfilterSelect=t.createSelect(g,t.tableColumns,o,t.userfilterParams),t.datefilterSelect=t.createSelect(b,t.tableColumns,n,t.datefilterParams),t.numberfilterSelect=t.createSelect(h,t.tableColumns,i,t.numberfilterParams),t.iconfilterSelect=t.createSelect(v,t.tableColumns,c,t.iconfilterParams),t.sortSelect=t.createSelect(S,t.sortColumns,m,t.sortParams,!0),t.chosenUpdated||(t.columnSelect.trigger("chosen:updated"),t.userfilterSelect.trigger("chosen:updated"),t.datefilterSelect.trigger("chosen:updated"),t.numberfilterSelect.trigger("chosen:updated"),t.iconfilterSelect.trigger("chosen:updated"),t.sortSelect.trigger("chosen:updated"),d.default.sortSelectedOptions(t.columnSelect,t.columnParams),d.default.sortSelectedOptions(t.userfilterSelect,t.userfilterParams),d.default.sortSelectedOptions(t.datefilterSelect,t.datefilterParams),d.default.sortSelectedOptions(t.numberfilterSelect,t.numberfilterParams),d.default.sortSelectedOptions(t.iconfilterSelect,t.iconfilterParams),d.default.sortSelectedOptions(t.sortSelect,t.sortParams),t.chosenUpdated=!0),$(".search-field input").one("focus",(function(){$(".search-choice").css("max-width",$(".chosen-container").width()-40)})),u.default.initMacroBrowserDefaultValueDialog(t,$("#macro-param-div-default")),u.default.initMacroBrowserCellWidthDialog(t,$("#macro-param-div-cell-width")),u.default.initMacroBrowserInverseFilterDialog(t,$("#macro-param-div-inverse")),u.default.initMacroBrowserFilterLabelsDialog(t,$("#macro-param-div-labels")),u.default.initMacroBrowserTotalRowDialog(t,$("#macro-param-div-totalrow"));var x=e.default?e.default.split(","):[],T=e["cell-width"]?e["cell-width"].split(","):[],C=e.inverse?e.inverse.split(","):[],w=e.order?e.order.split(","):[],P=e.labels?e.labels.split("‚"):[],A=0,I=0,J=0,k=0,O=0;d.default.i18nFilterValues(x),t.order.select_=[],$.each(r,(function(e,a){var l=a.replace("‌","");t.defaults["select_"+l]=x.length>A?x[A++]:"",t.inverse["select_"+l]=C.length>k&&"true"==C[k++],t.widths["select_"+l]=T.length>I?T[I++]:"",t.labels["select_"+l]=P.length>J?P[J++]:"",t.order.select_.push(w.length>O?parseInt(w[O++]):O++)})),t.order.freetext_=[],$.each(o,(function(e,a){var l=a.replace("‌","");t.defaults["freetext_"+l]=x.length>A?x[A++]:"",t.inverse["freetext_"+l]=C.length>k&&"true"==C[k++],t.widths["freetext_"+l]=T.length>I?T[I++]:"",t.labels["freetext_"+l]=P.length>J?P[J++]:"",t.order.freetext_.push(w.length>O?parseInt(w[O++]):O++)})),t.order.number_=[],$.each(i,(function(e,a){var l=a.replace("‌","");t.defaults["number_"+l]=x.length>A?x[A++]:"",t.inverse["number_"+l]=C.length>k&&"true"==C[k++],t.labels["number_"+l]=P.length>J?P[J++]:"",t.order.number_.push(w.length>O?parseInt(w[O++]):O++)})),t.order.date_=[],$.each(n,(function(e,a){var l=a.replace("‌","");t.defaults["date_"+l]=x.length>A?x[A++]:"",t.inverse["date_"+l]=C.length>k&&"true"==C[k++],t.labels["date_"+l]=P.length>J?P[J++]:"",t.order.date_.push(w.length>O?parseInt(w[O++]):O++)})),t.order.global=[],e.globalFilter&&(t.defaults.global=x.length>A?x[A++]:"",t.inverse.global=C.length>k&&"true"==C[k++],t.widths.global=T.length>I?T[I++]:"",t.labels.global=P.length>J?P[J++]:"",t.order.global.push(w.length>O?parseInt(w[O++]):O+++c.length)),t.order.hideColumns=[],e.hideColumns&&(t.defaults.hideColumns=x.length>A?x[A++]:"",t.inverse.hideColumns=C.length>k&&"true"==C[k++],t.widths.hideColumns=T.length>I?T[I++]:"",t.labels.hideColumns=P.length>J?P[J++]:"",t.order.hideColumns.push(w.length>O?parseInt(w[O++]):O+++c.length)),t.order.icon=[],$.each(c,(function(e,a){var l=a.replace("‌","");t.defaults["icon"+l]=x.length>A?x[A++]:"",t.inverse["icon"+l]=C.length>k&&"true"==C[k++],t.widths["icon"+l]=T.length>I?T[I++]:"",t.labels["icon"+l]=P.length>J?P[J++]:"",t.order.icon.push(w.length>O?parseInt(w[O++]):O++-t.order.hideColumns.length-t.order.global.length)})),t.columnSelect.one("chosen:showing_dropdown",(function(){t.columnSelect.click()}));var D=$("#macro-param-sparkline"),B=$("#macro-param-sparkName");B.val("Sparkline");var R=B.parent();R.addClass("tf-always-hidden"),e.sparkline&&"false"!==e.sparkline&&(D.prop("checked",!0),R.removeClass("tf-always-hidden"),B.val(e.sparkName)),D.change((function(){$(this).prop("checked")?($(".macro-input-fields").animate({scrollTop:$(".macro-input-fields form.aui").height()},750),R.removeClass("tf-always-hidden")):R.addClass("tf-always-hidden")}));var N=$("#macro-param-heightValue"),E=N.parent();E.addClass("tf-always-hidden"),e.limitHeight&&(l.val(e.limitHeight),E.removeClass("tf-always-hidden"),N.val(e.heightValue)),l.bind("keyup keydown change",(function(){l.val()>0?($(".macro-input-fields").animate({scrollTop:$(".macro-input-fields form.aui").height()},750),E.removeClass("tf-always-hidden")):E.addClass("tf-always-hidden")})),t.totaRowNameInput=$("#macro-param-div-totalRowName"),t.thousandSeparatorSelect=$("#macro-param-div-thousandSeparator"),t.totalRowInput.change((function(){t.totalRowInput.val().replace(/,/g,"")?(t.totaRowNameInput.removeClass("tf-always-hidden"),t.thousandSeparatorSelect.removeClass("tfac-hidden-totalrow"),t.thousandSeparatorSelect.addClass("tfac-shown-totalrow")):(t.totaRowNameInput.addClass("tf-always-hidden"),t.thousandSeparatorSelect.addClass("tfac-hidden-totalrow"),t.thousandSeparatorSelect.removeClass("tfac-shown-totalrow"))})),e.totalrow&&e.totalrow.replace(/,/g,"")?t.thousandSeparatorSelect.addClass("tfac-shown-totalrow"):(t.totaRowNameInput.addClass("tf-always-hidden"),t.thousandSeparatorSelect.addClass("tfac-hidden-totalrow")),s.initSelects(a,e),function(e){$("#macro-param-div-column").before(_().tableFilterTabs());var t=[$("#macro-param-div-column"),$("#macro-param-div-userfilter"),$("#macro-param-div-numberfilter"),$("#macro-param-div-datefilter"),$("#macro-param-div-iconfilter"),$("#macro-param-div-globalFilter"),$("#macro-param-div-hideColumns")],a=[$("#macro-param-div-separator"),$("#macro-param-div-datepattern"),$("#macro-param-div-default"),$("#macro-param-div-cell-width"),$("#macro-param-div-inverse"),$("#macro-param-div-disableSave"),$("#macro-param-div-hidelabels"),$("#macro-param-div-hidePane"),$("#macro-param-div-hideControls"),$("#macro-param-div-isOR"),$("#macro-param-div-ddSeparator"),$("#macro-param-div-ignoreFirstNrows"),$("#macro-param-div-labels"),$("#macro-param-div-disabled"),$("#macro-param-div-worklog"),$("#macro-param-div-updateSelectOptions"),$("#macro-param-div-tabs")],l=[$("#macro-param-div-showNRowsifNotFiltered"),$("#macro-param-div-rowsPerPage"),$("#macro-param-div-numbering"),$("#macro-param-div-sort"),$("#macro-param-div-fixedCols"),$("#macro-param-div-limitHeight"),$("#macro-param-div-sparkline"),$("#macro-param-div-sparkName"),$("#macro-param-div-totalrow"),$("#macro-param-div-totalcol"),$("#macro-param-div-totalColName"),$("#macro-param-div-totalRowName"),$("#macro-param-div-thousandSeparator"),$("#macro-param-div-heightValue")];$(".tf-macrobrowser-tabs a").attr("disabled","disabled");var r=$("#tab-filters"),o=$("#tab-filter-options"),i=$("#tab-table-options"),n=[r,o,i];function s(e){a(e[0],"in");for(var t=1;t<e.length;t++)a(e[t],"out");function a(e,t){for(var a=0;a<e.length;a++)"in"==t?e[a].show():e[a].hide()}}function c(e){e.hasClass("active-tab")||(n.forEach((function(e){e.removeClass("active-tab")})),e.addClass("active-tab"))}r.click((function(){c(r),s([t,a,l])})),o.click((function(){c(o),s([a,t,l])})),i.click((function(){c(i),s([l,t,a])})),r.trigger("click")}(t.isCloud)},N.prototype.createSelect=function(e,t,a,l,r){e.hide(),$.each(a,(function(e,t){l.push($.trim(t))})),$.each(a,(function(e,t){a[e]=$.trim(t.replace(/\‚/g,",")).replace("‌","")}));var o=$("<select multiple/>");$.each(t,(function(t,l){var r=-1==$.inArray(l,a)?"":'selected="selected" ',i="";if(e.is("#macro-param-sort")){var n=l;n=-1!=n.indexOf("⇧")?n.replace("⇧","⇩"):n.replace("⇩","⇧"),-1!=$.inArray(n,a)&&(i='style="display: none"')}o.append($("<option "+r+i+"></option>").text(l))})),e.after(o),o.chosenTF({no_results_text:r?"No matches found":"No matches found. Press \u0027Enter\u0027 to add",placeholder_text_multiple:"Click and start typing...",width:"100%",display_selected_options:!1,addUserOption:!r}).change((function(t,a){if(null!=a.selected){if(o.find("option").filter((function(){return this.textContent===a.selected})).prop("selected",!0),""==(n=a.selected)&&(n="‌"),l.push(n.replace(/\,/g,"‚")),e.is("#macro-param-sort")){s=-1!=(s=a.selected).indexOf("⇧")?s.replace("⇧","⇩"):s.replace("⇩","⇧"),o.find("option").filter((function(){return this.textContent==s})).hide(),o.trigger("chosen:updated");for(var r=o.parent().find("ul.chosen-choices"),i=l.length-1;i>=0;i--)r.prepend(r.find("li").filter((function(){return this.textContent==l[i].replace(/\‚/g,",")})))}}else if(null!=a.deselected){var n;if($(this).find("option").filter((function(){return this.textContent==a.deselected})).prop("selected",!1),""==(n=a.deselected)&&(n="‌"),l.splice($.inArray(n.replace(/\,/g,"‚"),l),1),e.is("#macro-param-sort")){var s;s=-1!=(s=a.deselected).indexOf("⇧")?s.replace("⇧","⇩"):s.replace("⇩","⇧"),o.find("option").filter((function(){return this.textContent==s})).show(),o.trigger("chosen:updated");for(r=o.parent().find("ul.chosen-choices"),i=l.length-1;i>=0;i--)r.prepend(r.find("li").filter((function(e){return this.textContent==l[i].replace(/\‚/g,",")})))}}e.val(l.join(","))}));var i=d.default.sortSelectedOptions(o,l);return i.sortable({tolerance:"pointer",cursor:"move",helper:"clone",items:".search-choice",stop:function(){l=[],i.find(".search-choice").each((function(){var e=this.textContent;""==e&&(e="‌"),l.push(e.replace(/\,/g,"‚"))})),e.val(l.join(","))}}),o},N.prototype.getSelectFilterOptions=function(e,t){var a=this,l=[],r=[],o=!0,i=$("#macro-param-ddSeparator").val().replace(/\,/g,"‚").replace(/\\u0020/g," ");return $.each(a.tables,(function(n,s){$.each(s[0],(function(c,m){if(e.toLocaleLowerCase()===d.default.clearString(m).toLocaleLowerCase()){var p=t?a.iconTables[n]:s;if($.each(p,(function(e,a){if(0!==e)if(t&&a[c]){var n=$(a[c]);n.filter("img").each((function(){var e=d.default.clearIconSrc(this.src);-1===$.inArray(e,r)&&(r.push(e),l.push(R().sanitize(this.outerHTML)))})),n.filter("ul").length&&o&&(o=!1,-1===$.inArray('<ul class="inline-task-list"><li></li></ul>',r)&&(l.push('<ul class="inline-task-list"><li></li></ul>'),r.push('<ul class="inline-task-list"><li></li></ul>')),-1===$.inArray('<ul class="inline-task-list"><li class="checked"></li></ul>',r)&&(l.push('<ul class="inline-task-list"><li class="checked"></li></ul>'),r.push('<ul class="inline-task-list"><li class="checked"></li></ul>')))}else if(null!=a[c]){var s=a[c].replace(/\,/g,"‚");(s=i?s.split(i):[s]).forEach((function(e){e=e.trim(),-1===$.inArray(e,l)&&l.push(e)}))}})),!t&&-1===$.inArray("@currentUser",l)){var u=c+1;a.body.find("table").eq(n).find("tr td:nth-child("+u+"), tr th:nth-child("+u+")").find(".confluence-userlink, ri\\:user").length&&l.push("@currentUser")}}}))})),{allSelects:l,options:r}},N.prototype.updateColumns=function(e){var t=this;function a(e){t.body=e;var a=!1,l=!1;d.default.normalizeTable(d.default.getTableNodes(e)),t.tables=d.default.getTables(e),t.iconTables=d.default.getTables(e,d.default.visualType),$.each(d.default.getRawColumns(t.tables),(function(e,r){if(-1===$.inArray(r,t.tableColumns)&&(a=!0,t.tableColumns.push(r),t.columnSelect.append($("<option></option>").val(r).text(r)),t.userfilterSelect.append($("<option></option>").val(r).text(r)),t.datefilterSelect.append($("<option></option>").val(r).text(r)),t.numberfilterSelect.append($("<option></option>").val(r).text(r)),t.iconfilterSelect.append($("<option></option>").val(r).text(r))),$.trim(r).length){if(-1==$.inArray(r+" ⇧",t.sortColumns)){l=!0,t.sortColumns.push(r+" ⇧");var o="";E(t.sortSelect,r+" ⇩")&&(o=' style="display:none"'),t.sortSelect.append($("<option"+o+"></option>").val(r+" ⇧").text(r+" ⇧"))}if(-1==$.inArray(r+" ⇩",t.sortColumns)){l=!0,t.sortColumns.push(r+" ⇩");o="";E(t.sortSelect,r+" ⇧")&&(o=' style="display:none"'),t.sortSelect.append($("<option"+o+"></option>").val(r+" ⇩").text(r+" ⇩"))}}})),a&&(d.default.sortSelectOptions(t.columnSelect),d.default.sortSelectOptions(t.userfilterSelect),d.default.sortSelectOptions(t.datefilterSelect),d.default.sortSelectOptions(t.numberfilterSelect),d.default.sortSelectOptions(t.iconfilterSelect),t.columnSelect.trigger("chosen:updated"),t.userfilterSelect.trigger("chosen:updated"),t.datefilterSelect.trigger("chosen:updated"),t.numberfilterSelect.trigger("chosen:updated"),t.iconfilterSelect.trigger("chosen:updated"),d.default.sortSelectedOptions(t.columnSelect,t.columnParams),d.default.sortSelectedOptions(t.userfilterSelect,t.userfilterParams),d.default.sortSelectedOptions(t.datefilterSelect,t.datefilterParams),d.default.sortSelectedOptions(t.numberfilterSelect,t.numberfilterParams),d.default.sortSelectedOptions(t.iconfilterSelect,t.iconfilterParams)),l&&(d.default.sortSelectOptions(t.sortSelect),t.sortSelect.trigger("chosen:updated"),d.default.sortSelectedOptions(t.sortSelect,t.sortParams))}t.body=e,M.default.bindPreview(e,a),d.default.addIframe(t.body,"tablefilter-table-wrapper",a),a(e)},N.prototype.getComputationalParams=function(e){var t=this,a=null!=e.column?e.column.split(","):[],l=null!=e.userfilter?e.userfilter.split(","):[],r=null!=e.numberfilter?e.numberfilter.split(","):[],o=null!=e.datefilter?e.datefilter.split(","):[],i=null!=e.iconfilter?e.iconfilter.split(","):[],n=[],s=[],c=[],m=[],p=[],u={},f=0;return f=g(t,a,"select_"),f=g(t,l,"freetext_"),f=g(t,r,"number_"),f=g(t,o,"date_"),e.globalFilter&&(f=g(t,[""],"global")),e.hideColumns&&(f=g(t,[""],"hideColumns")),g(t,i,"icon",(e.globalFilter?1:0)+(e.hideColumns?1:0)),p.slice().sort((function(e,t){return e-t})).forEach((function(e,t){p[$.inArray(e,p)]=t})),d.default.unI18nFilterValues(n),e.default=n.join(","),e["cell-width"]=s.join(","),e.inverse=c.join(","),e.labels=m.join("‚"),e.order=p.join(","),e;function g(e,t,a,l){return $.each(t,(function(t,r){var o=$.trim(r.replace(/\‚/g,",")).replace("‌","");n.push(e.defaults[a+o]),"number_"!=a&&"date_"!=a&&s.push(e.widths[a+o]),c.push(e.inverse[a+o]),m.push(e.labels[a+o]);var i=e.order[a][t];if(null==i){if(0==p.length)i=0;else{f=0;var d=p.length-1;"icon"==a&&0==t&&(d-=l),i=d>=0?p[d]+1:0}var g=i-f,b=g;$.each(u,(function(e,t){b>e&&(g-=t)})),u[g]?u[g]++:u[g]=1,p.forEach((function(e,t){e>=i-f&&t<p.length-f&&(p[t]+=1)})),f++}else{f=0;for(var h=i;h>=0;h--)u[h]&&(i+=u[h])}p.push(i)})),f}},N.prototype.getSelectedFilters=function(){var e=[];if($("div.macro-param-div:not(#macro-param-div-sort) .chosen-choices .search-choice").each((function(){var t=$(this),a=t.parents("#macro-param-div-column").length>0,l=t.parents("#macro-param-div-datefilter").length>0,r=t.parents("#macro-param-div-numberfilter").length>0,o=t.parents("#macro-param-div-userfilter").length>0,i=t.parents("#macro-param-div-iconfilter").length>0,n=i?"icon":l?"date_":r?"number_":o?"freetext_":"select_";e.push({field:t.text(),isSelect:a,isDate:l,isNumber:r,isText:o,isIcon:i,type:n})})),$("#macro-param-globalFilter").prop("checked")){var t="Filter whole table";e.push({field:t,type:"global"})}if($("#macro-param-hideColumns").prop("checked")){var a="Columns to hide";e.push({field:a,type:"hideColumns"})}return e},N.prototype.setTypeNumbers=function(e){e.replaceWith(e.clone().attr("type","number").attr("min","0"))};var j,V=N,K=a(62782),H=function(){this.tableFilterMacro=new V,this.tableFilterMacro.storedParams={},this.tableFilterMacro.isSaveClick=!1,this.tableFilterMacro.isSetParams=!1,this.tableFilterMacro.hasTable=!1};H.prototype.getMacroDetailsFromSelectedMacro=function(e,t){var a=j.tableFilterMacro;j.bodyView=w.convertStorageToView(t),a.getMacroDetails(j.bodyView),w.showTabsParam(j.bodyView),a.hasTable=j.bodyView.indexOf("table")>0},H.prototype.postPreview=function(e){var t=j.tableFilterMacro;t.updateColumns($(e).contents().find(".tablefilter-table-wrapper")),t.isSaveClick=!1,t.isSetParams=!1,K.default.bindFilterActions(),K.default.bindOptionsEvents()},H.prototype.beforeParamsSet=function(e){var t=j.tableFilterMacro;return t.gotBody||j.getMacroDetailsFromSelectedMacro(null,{body:tinymce.activeEditor.selection.getContent()}),t.gotBody=!1,("true"==e.numbering||"Dynamic"==e.numbering)&&(e.numbering="Dynamic Ascending"),e.id=(new Date).getTime()+"_"+d.default.hashCode(t.tfBody),t.transformElements(e),""==e.column&&(e.column="‌"),""==e.userfilter&&(e.userfilter="‌"),""==e.iconfilter&&(e.iconfilter="‌"),""==e.datefilter&&(e.datefilter="‌"),""==e.numberfilter&&(e.numberfilter="‌"),w.showTabsParam(j.bodyView),t.isSaveClick=!1,t.isSetParams=!0,e.isFirstTimeEnter=t.hasTable?void 0===e.isFirstTimeEnter:void 0,e},H.prototype.manipulateMarkup=function(e){return j.tableFilterMacro.isSaveClick=!0,j.tableFilterMacro.isSetParams=!1,e},H.prototype.beforeParamsRetrieved=function(e){var t=j.tableFilterMacro;return t.chosenUpdated||(t.columnSelect.trigger("chosen:updated"),t.userfilterSelect.trigger("chosen:updated"),t.datefilterSelect.trigger("chosen:updated"),t.numberfilterSelect.trigger("chosen:updated"),t.iconfilterSelect.trigger("chosen:updated"),t.sortSelect.trigger("chosen:updated"),d.default.sortSelectedOptions(t.columnSelect,t.columnParams),d.default.sortSelectedOptions(t.userfilterSelect,t.userfilterParams),d.default.sortSelectedOptions(t.datefilterSelect,t.datefilterParams),d.default.sortSelectedOptions(t.numberfilterSelect,t.numberfilterParams),d.default.sortSelectedOptions(t.iconfilterSelect,t.iconfilterParams),d.default.sortSelectedOptions(t.sortSelect,t.sortParams),t.chosenUpdated=!0),e.limitHeight=$("#macro-param-limitHeight").val(),e=t.getComputationalParams(e),t.isSaveClick&&(K.default.triggerFilterMacroBrowserEvents(e,t.storedParams),h.default.gaEditorTF(e,t.storedParams)),t.isSetParams&&(t.storedParams=e||{}),e};var q=j=new H,U=a(4298),z=function(){this.tables=[],this.tableColumns=[],this.columnSelect=null,this.aggregateSelect=null,this.typeSelect=null,this.tfBody="",this.columnParams=[],this.aggregateParams=[],this.isPivot=!1,this.gotBody=!1,this.transpose=!1,this.colors=[],this.pieKeys=[],this.savedInterpolation={},this.savedLineSettings={},this.isCloud=!1};function G(e,t,a,l,r,o){e.hide();var i=$("<select multiple/>");return $.each(a,(function(e,a){a=$.trim(a).replace("‌",""),-1==$.inArray(a,t)&&t.push(a)})),t.sort((function(e,t){return e.localeCompare(t)})),$.each(t,(function(e,t){i.append($("<option></option>").text(t))})),$.each(l,(function(e,a){a=$.trim(a).replace("‌",""),-1==$.inArray(a,t)&&(t.push(a),i.append($("<option></option>").text(a)))})),e.after(i),function(e,t,a,l,r){$("#macro-param-type");e.chosenTF({no_results_text:"No matches found. Press \u0027Enter\u0027 to add",placeholder_text_multiple:"Click and start typing...",width:"100%",display_selected_options:!1,addUserOption:!0}).change((function(l,o){if(null!=o.selected)e.find("option").filter((function(){return this.textContent==o.selected})).prop("selected",!0),""==(i=o.selected)&&(i="‌"),a.push(i);else if(null!=o.deselected){var i;e.find("option").filter((function(){return this.textContent==o.deselected})).prop("selected",!1),""==(i=o.deselected)&&(i="‌"),a.splice($.inArray(i,a),1)}t.val(a.join("‚")),r&&r.updatePieKeys()}));var o=d.default.sortSelectedOptions(e,a);o.sortable({tolerance:"pointer",cursor:"move",helper:"clone",items:".search-choice",stop:function(){var e=a.slice();a.length=0,o.find(".search-choice").each((function(){var e=this.textContent;""==e&&(e="‌"),a.push(e)}));var r=l.slice();e.forEach((function(e,t){var o=$.inArray(e,a);o>=0&&r.length>o&&(l[o]=r[t])})),t.val(a.join("‚"))}});var i=[];a.forEach((function(e){i.push(e.replace("‌",""))})),e.val(i),e.trigger("chosen:updated"),t.val(a.join("‚"))}(i,e,a,r,o),i}function W(e){e.hasClass("chart-browser-hidden")||e.addClass("chart-browser-hidden")}function X(e){e.hasClass("chart-browser-hidden")&&e.removeClass("chart-browser-hidden")}z.prototype.getMacroDetails=function(e,t,a,l){var r=this;r.isCloud=l,r.transpose="Horizontal"==t.dataorientation,r.gotBody=!0,r.isPivot=a||!1,r.tfBody=e,r.initTableChart(t),r.setTables(r.tfBody),r.tables=r.TableChart.tables,r.tableColumns=d.default.getColumns(r.tables)},z.prototype.transformElements=function(e){var t=this,a={type:{Pie:{title:"Pie",hiddenParams:["line-settings","xlog","datepattern","scalestep","log","xminvalue","xmaxvalue","grid","xscalestep","trendline","legend","interpolation","minvalue","maxvalue","xtitle","ytitle","barColoringType"]},Donut:{title:"Donut",hiddenParams:["line-settings","xlog","datepattern","scalestep","log","xminvalue","xmaxvalue","grid","xscalestep","trendline","legend","interpolation","minvalue","maxvalue","xtitle","ytitle","barColoringType"]},Column:{title:"Column",hiddenParams:["line-settings","xlog","datepattern","xminvalue","xmaxvalue","grid","xscalestep","interpolation","barColoringType","outerLabels"]},"Stacked Column":{title:"Stacked Column",hiddenParams:["line-settings","xlog","datepattern","xminvalue","xmaxvalue","grid","xscalestep","interpolation","barColoringType","outerLabels"]},Bar:{title:"Bar",hiddenParams:["line-settings","xlog","datepattern","xminvalue","xmaxvalue","grid","xscalestep","interpolation","barColoringType","outerLabels"]},"Stacked Bar":{title:"Stacked Bar",hiddenParams:["line-settings","xlog","datepattern","xminvalue","xmaxvalue","grid","xscalestep","interpolation","barColoringType","outerLabels"]},"Bubble Pie":{title:"Bubble Pie",hiddenParams:["line-settings","is3d","trendline","interpolation","xlog","log","barColoringType","outerLabels"],labels:{column:"X-axis and Y-axis columns",xtitle:"X-axis label",ytitle:"Y-axis label"}},Line:{title:"Line",hiddenParams:["datepattern","innerlabels","is3d","barColoringType","outerLabels"],labels:{aggregation:"Y-axis value column",column:"X-axis value column",xtitle:"X-axis label",log:"Logarithmic scale Y",xlog:"Logarithmic scale X",scalestep:"Scale Y step",minvalue:"Minimal Y value",maxvalue:"Maximal Y value",ytitle:"Y-axis label"}},Area:{title:"Area",hiddenParams:["line-settings","datepattern","innerlabels","is3d","barColoringType","outerLabels"],labels:{aggregation:"Y-axis value column",column:"X-axis value column",xtitle:"X-axis label",log:"Logarithmic scale Y",xlog:"Logarithmic scale X",scalestep:"Scale Y step",minvalue:"Minimal Y value",maxvalue:"Maximal Y value",ytitle:"Y-axis label"}},"Stacked Area":{title:"Stacked Area",hiddenParams:["line-settings","datepattern","innerlabels","is3d","barColoringType","outerLabels"],labels:{aggregation:"Y-axis value column",column:"X-axis value column",xtitle:"X-axis label",log:"Logarithmic scale Y",xlog:"Logarithmic scale X",scalestep:"Scale Y step",minvalue:"Minimal Y value",maxvalue:"Maximal Y value",ytitle:"Y-axis label"}},"Time Line":{title:"Time Line",hiddenParams:["xlog","innerlabels","is3d","barColoringType","outerLabels"],labels:{column:"Dates column",xtitle:"Date axis label",scalestep:"Scale Y step",minvalue:"Minimal Y value",maxvalue:"Maximal Y value",ytitle:"Y-axis label"}},"Time Area":{title:"Time Area",hiddenParams:["line-settings","xlog","innerlabels","is3d","barColoringType","outerLabels"],labels:{column:"Dates column",xtitle:"Date axis label",scalestep:"Scale Y step",minvalue:"Minimal Y value",maxvalue:"Maximal Y value",ytitle:"Y-axis label"}},"Stacked Time Area":{title:"Stacked Time Area",hiddenParams:["line-settings","xlog","innerlabels","is3d","barColoringType","outerLabels"],labels:{column:"Dates column",xtitle:"Date axis label",scalestep:"Scale Y step",minvalue:"Minimal Y value",maxvalue:"Maximal Y value",ytitle:"Y-axis label"}},Gantt:{title:"Gantt",hiddenParams:["line-settings","xlog","log","innerlabels","is3d","trendline","legend","scalestep","interpolation","minvalue","maxvalue","outerLabels"],labels:{ytitle:"Date axis label",xscalestep:"Scale step",xminvalue:"Minimal value",xmaxvalue:"Maximal value"}},Radar:{title:"Radar",hiddenParams:["line-settings","xlog","log","innerlabels","is3d","trendline","xscalestep","interpolation","minvalue","barColoringType","datepattern","xminvalue","xmaxvalue","xtitle","ytitle","outerLabels"]},__default:{labels:{aggregation:"Values column",column:"Labels column",xtitle:"Row axis label",log:"Logarithmic scale",xscalestep:"Scale X step",xminvalue:"Minimal X value",xmaxvalue:"Maximal X value",scalestep:"Scale step",minvalue:"Minimal value",maxvalue:"Maximal value",ytitle:"Value axis label"}}},barColoringType:{mono:{title:"Single color"},multi:{title:"Multicolor"}},align:{Center:{title:"Center"},Left:{title:"Left"},Right:{title:"Right"}},outerLabels:{Label:{title:"Label"},None:{title:"None"}},legend:{right:{title:"Right"},under:{title:"Bottom"},none:{title:"None"}},innerlabels:{Value:{title:"Number"},None:{title:"None"},Percentage:{title:"Percentage"},"Value (Percentage)":{title:"Number (Percentage)"},"Percentage (Value)":{title:"Percentage (Number)"}},dataorientation:{Vertical:{title:"Vertical"},Horizontal:{title:"Horizontal"}},separator:{"Point (.)":{title:"Point (.)"},"Comma (,)":{title:"Comma (,)"}}};if(!e.version&&!e.formatVersion&&(e.version=2,e.formatVersion=2,e.type&&(e.type.indexOf("Line")>=0||e.type.indexOf("Area")>=0))){var l=e.column;e.column=e.aggregation,e.aggregation=l}e.type&&e.type.indexOf("3D ")>=0&&(e.type=e.type.replace("3D ",""),e.is3d=!0),e.barColoringType||(e.barColoringType="Gantt"===e.type?"multi":"mono"),t.transpose="Horizontal"==e.dataorientation,$("#macro-browser-dialog .macro-desc .macro-doco-link").before("Post \u003ca href=\u0022https://stiltsoft.customercase.com/forums/table-filter-for-confluence/ideas/create?from=macro\u0022\u003eIdea\u003c/a\u003e or \u003ca href=\u0022https://jsd.stiltsoft.com/servicedesk/customer/portal/2?from=macro\u0022\u003eIssue\u003c/a\u003e.   "),$("#macro-param-div-id").hide(),e.column?(t.columnParams=e.column.split("‚"),$.each(t.columnParams,(function(e,a){t.columnParams[e]=$.trim(a)}))):t.columnParams=t.tableColumns.length?[d.default.getRawColumns(t.tables)[0]]:[],e.aggregation?(t.aggregateParams=e.aggregation.split("‚"),$.each(t.aggregateParams,(function(e,a){t.aggregateParams[e]=$.trim(a)}))):t.aggregateParams=t.tableColumns.length>1?[d.default.getRawColumns(t.tables)[1]]:[],e.colors&&(t.colors=e.colors.split(",")),d.default.chartColors.forEach((function(e){-1==$.inArray(e,t.colors)&&t.colors.push(e)})),e.pieKeys&&(t.pieKeys=e.pieKeys.split("‚")),t.defaultInterpolation=null,2!=e.version&&2!=e.formatVersion||(e.version=3,e.formatVersion=3,t.defaultInterpolation=e.interpolation?e.interpolation:"Linear","false"===e.innerlabels?e.innerlabels="None":e.type&&"Pie"!==e.type&&-1===e.type.indexOf("Donut")||(e.innerlabels="Percentage")),function(e){(e.dateFormat||e.datepattern)&&$("#macro-param-datepattern").val(e.dateFormat||e.datepattern);(e["tfc-height"]||e.height)&&$("#macro-param-tfc-height").val(e["tfc-height"]||e.height);(e["tfc-width"]||e.width)&&$("#macro-param-tfc-width").val(e["tfc-width"]||e.width);(e.separator||e.decimalSeparator)&&$("#macro-param-separator").val(e.separator||e.decimalSeparator);"true"!=e.hide&&"true"!=e.hideSource||$("#macro-param-hide").prop("checked",!0);"true"!=e.hideControls&&"true"!=e.hidecontrols||$("#macro-param-hidecontrols").prop("checked",!0);"false"==e.grid?$("#macro-param-grid").prop("checked",!1):$("#macro-param-grid").prop("checked",!0);"string"==typeof e.legend?"false"==e.legend?e.legend="none":"true"==e.legend&&(e.legend="right"):e.legend||void 0===e.legend?e.legend="right":e.legend="none";$("#macro-param-legend").val(e.legend),e.minvalue&&$("#macro-param-minvalue").val(e.minvalue);e.maxvalue&&$("#macro-param-maxvalue").val(e.maxvalue);e.xminvalue&&$("#macro-param-xminvalue").val(e.xminvalue);e.xmaxvalue&&$("#macro-param-xmaxvalue").val(e.xmaxvalue);e.scalestep&&$("#macro-param-scalestep").val(e.scalestep);e.xscalestep&&$("#macro-param-xscalestep").val(e.xscalestep);e.title&&$("#macro-param-title").val(e.title);e.xtitle&&$("#macro-param-xtitle").val(e.xtitle);e.ytitle&&$("#macro-param-ytitle").val(e.ytitle);"true"==e.log&&$("#macro-param-log").prop("checked",!0);"true"==e.xlog&&$("#macro-param-xlog").prop("checked",!0);"true"==e.trendline&&$("#macro-param-trendline").prop("checked",!0);e.tabs&&$("#macro-param-tabs").prop("checked",!0);e.is3d&&$("#macro-param-is3d").prop("checked",!0);e.interpolation&&$("#macro-param-interpolation").val(e.interpolation);e["line-settings"]&&$("#macro-param-line-settings").val(e["line-settings"])}(e);var r=$("#macro-param-column"),o=$("#macro-param-aggregation");t.columnSelect=G(r,t.tableColumns,t.columnParams,t.aggregateParams,[],t),t.aggregateSelect=G(o,t.tableColumns,t.aggregateParams,[],t.colors,t),t.typeSelect=$("#macro-param-type"),$(".search-field input").one("focus",(function(){$(".search-choice").css("max-width",$(".chosen-container").width()-40)})),t.dateFormatInput=$("#macro-param-datepattern"),M.default.initDateFormatInput(e),u.default.initMacroBrowserWorklogDialog(e.worklog);var i=$("#macro-param-div-colors"),n=$("#macro-param-div-column"),c=$("#macro-param-div-aggregation"),m=$("#macro-param-div-scalestep"),p=$("#macro-param-div-xscalestep"),f=$("#macro-param-div-type"),g=$("#macro-param-div-maxvalue");m.find(".macro-param-desc").addClass("chart-browser-hidden");var b="Gantt"===e.type;t.typeSelect.change((function(){var e=!0,a=t.typeSelect.val().indexOf("Bar")>=0||t.typeSelect.val().indexOf("Column")>=0;t.isGantt="Gantt"===t.typeSelect.val(),t.isBubblePie="Bubble Pie"===t.typeSelect.val(),t.isMultipleChoice=a||t.typeSelect.val().indexOf("Line")>=0||t.typeSelect.val().indexOf("Area")>=0||t.isGantt,m.find(".macro-param-desc").text("For scale X enter number of days (X), weeks (Xw), months (Xm) or years (Xy)"),t.isBubblePie?X(m.find(".macro-param-desc").text("For time scales enter number of hours (Xh/Yh), days (X/Y), months (Xm/Ym) or years (Xy/Yy)").removeClass("gantt")):t.typeSelect.val().indexOf("Time")>=0?X(m.find(".macro-param-desc").removeClass("gantt")):(t.isGantt?X(m.find(".macro-param-desc").addClass("gantt")):W(m.find(".macro-param-desc")),e="Line"===t.typeSelect.val()||"Area"===t.typeSelect.val()||"Stacked Area"===t.typeSelect.val()),t.isPivot&&(W(n),t.tableColumns.length>2?c.show():W(c)),(t.isGantt?!b:b)&&(b&&t.columnParams.length>1&&(t.columnParams.length=1,t.columnSelect.find("option:selected").removeAttr("selected"),t.columnSelect.find("option").filter((function(){return this.textContent==t.columnParams[0]})).attr("selected","selected"),r.val(t.columnParams[0]),t.columnSelect.trigger("chosen:updated")),b=t.isGantt),p.removeClass("gantt"),f.removeClass("short"),e||t.isBubblePie?m.addClass("multiple").css("display",""):(t.isGantt?p.addClass("gantt"):f.addClass("short"),m.removeClass("multiple")),-1!==t.typeSelect.val().indexOf("Radar")?g.addClass("wide"):g.removeClass("wide")})),e.type||(e.type="Pie"),s.initSelects(a,e),$("#macro-param-dataorientation").change((function(){t.transpose="Horizontal"==$(this).val(),t.tables=d.default.transpose(t.tables),t.tableColumns=d.default.getColumns(t.tables);var e=d.default.getRawColumns(t.tables);t.columnSelect.find("option").remove(),t.aggregateSelect.find("option").remove(),t.columnParams.length=0,t.aggregateParams.length=0,$.each(t.tableColumns,(function(e,a){t.columnSelect.append($("<option></option>").text(a)),t.aggregateSelect.append($("<option></option>").text(a))})),t.columnSelect.val(e[0]).trigger("change",{selected:e[0]}).trigger("chosen:updated"),t.aggregateSelect.val(e[1]).trigger("change",{selected:e[1]}).trigger("chosen:updated")})),t.barColoringTypeSelect=$("#macro-param-barColoringType").change((function(){t.updatePieKeys()})),t.TableChart.typeSelect=t.typeSelect,t.updatePieKeys(),u.default.initMacroBrowserChartColorsDialog(t,i),t.isCloud||(t.initInterpolationDialog(e),t.initLineSettingsDialog(e)),function(){$("#macro-param-div-type").before(_().chartTabs());var e=[$("#macro-param-div-column"),$("#macro-param-div-aggregation"),$("#macro-param-div-type"),$("#macro-param-div-is3d")],t=[$("#macro-param-div-tfc-height"),$("#macro-param-div-tfc-width"),$("#macro-param-div-colors"),$("#macro-param-div-align"),$("#macro-param-div-legend"),$("#macro-param-div-grid"),$("#macro-param-div-hide"),$("#macro-param-div-hidecontrols"),$("#macro-param-div-title"),$("#macro-param-div-xtitle"),$("#macro-param-div-barColoringType"),$("#macro-param-div-ytitle"),$("#macro-param-div-innerlabels"),$("#macro-param-div-outerLabels"),$("#macro-param-div-line-settings")],a=[$("#macro-param-div-datepattern"),$("#macro-param-div-separator"),$("#macro-param-div-dataorientation"),$("#macro-param-div-xminvalue"),$("#macro-param-div-xmaxvalue"),$("#macro-param-div-minvalue"),$("#macro-param-div-maxvalue"),$("#macro-param-div-xscalestep"),$("#macro-param-div-scalestep"),$("#macro-param-div-log"),$("#macro-param-div-xlog"),$("#macro-param-div-interpolation"),$("#macro-param-div-trendline"),$("#macro-param-div-worklog"),$("#macro-param-div-tabs")];$(".tf-macrobrowser-tabs a").attr("disabled","disabled");var l=$("#tab-columns"),r=$("#tab-display-options"),o=$("#tab-advanced-options"),i=[l,r,o];function n(e){a(e[0],"in");for(var t=1;t<e.length;t++)a(e[t],"out");function a(e,t){for(var a=0;a<e.length;a++)"in"==t?e[a].removeClass("chart-browser-hidden-by-tab"):e[a].addClass("chart-browser-hidden-by-tab")}}function s(e){e.hasClass("active-tab")||(i.forEach((function(e){e.removeClass("active-tab")})),e.addClass("active-tab"))}l.click((function(){l.hasClass("active-tab")||(s(l),n([e,t,a]))})),r.click((function(){r.hasClass("active-tab")||(s(r),n([t,e,a]))})),o.click((function(){o.hasClass("active-tab")||(s(o),n([a,e,t]))})),l.trigger("click")}()},z.prototype.initInterpolationDialog=function(e){var t=this,a=[];if(t.defaultInterpolation)t.chartKeys.forEach((function(e,l){t.savedInterpolation[e]=t.defaultInterpolation,a.push(t.defaultInterpolation)}));else{var l=e.interpolation?e.interpolation.split(","):[];t.chartKeys.forEach((function(e,r){var o=r<l.length?l[r]:"Linear";t.savedInterpolation[e]=o,a.push(o)}))}e.type&&(e.type.indexOf("Line")>=0||e.type.indexOf("Area")>=0)&&(e.interpolation=a.join(",")),u.default.initMacroBrowserInterpolationDialog(t,$("#macro-param-div-interpolation"))},z.prototype.initLineSettingsDialog=function(e){var t=this,a=[],l=e["line-settings"]?e["line-settings"].split(","):[];t.chartKeys.forEach((function(e,r){var o=r<l.length?{type:l[r].split("-")[0],width:l[r].split("-")[1]}:{type:"solid",width:1.5};t.savedLineSettings[e]=o,a.push(o.type+"-"+o.width.toString())})),e.type&&e.type.indexOf("Line")>=0&&(e["line-settings"]=a.join(",")),u.default.initMacroBrowserLineSettingsDialog(t,$("#macro-param-div-line-settings"))},z.prototype.initTableChart=function(e){var t=this;t.TableChart=new U.default({macroId:"editor",columns:e.column,aggregation:e.aggregation,dateFormat:e.datepattern,separator:e.separator,pageId:0,dataorientation:e.dataorientation,colors:e.colors,pieKeys:e.pieKeys,worklog:e.worklog,sessionId:0,barColoringType:e.barColoringType}),t.TableChart.content=$(),t.TableChart.is3DWrapper=$()},z.prototype.updatePieKeys=function(){var e=this;e.TableChart.barColoringType=e.barColoringTypeSelect.val(),e.TableChart.colors=e.colors,e.TableChart.pieKeys=e.pieKeys,e.TableChart.columns=e.columnParams.slice(),e.TableChart.columnsCache=e.columnParams.slice(),e.TableChart.aggregation=e.aggregateParams.slice(),e.TableChart.aggregationCache=e.aggregateParams.slice(),e.TableChart.transpose=e.transpose,e.TableChart.dateFormat=e.dateFormatInput.val(),e.TableChart.getType(),e.TableChart.colorKeyMap=e.TableChart.setColorKeyMap({},e.TableChart.getAllChartColorLabels(),e.colors),e.TableChart.resetDateFormats();var t=d.default.getRawColumns(e.TableChart.tables);1===e.TableChart.columns.length&&-1===t.indexOf(e.TableChart.columns[0])&&(e.TableChart.columns=[]),1===e.TableChart.aggregation.length&&-1===t.indexOf(e.TableChart.aggregation[0])&&(e.TableChart.aggregation=[]),0==e.TableChart.columns.length&&void 0!==t[0]&&e.TableChart.columns.push(t[0]),e.TableChart.isPivot?0==e.TableChart.aggregation.length&&void 0!==t[t.length-1]&&e.TableChart.aggregation.push(t[t.length-1]):0==e.TableChart.aggregation.length&&e.TableChart.aggregation.push(t[1]),e.TableChart.calculate(),e.pieKeys=e.TableChart.pieKeys,e.colors=e.TableChart.colors,e.chartKeys=e.TableChart.chartKeys},z.prototype.getTrimmedColors=function(){var e=this;e.TableChart.columnsCache=e.columnParams.slice(),e.TableChart.aggregationCache=e.aggregateParams.slice(),e.TableChart.chartKeys=[];var t=e.TableChart.getAllChartColorLabels(),a=e.TableChart.getColorsFromMap(e.TableChart.colorKeyMap,t,e.TableChart.palette);return(a=a.slice(0,t.length)).length&&(e.colors=a),e.colors},z.prototype.setTables=function(e){var t=this;t.TableChart.chartBody=$('<div class="chart-body">'+e+"</div>"),t.TableChart.checkPivotContent(),t.TableChart.getOriginalTable()},z.prototype.updateColumns=function(e,t){var a=this;function l(e){var l,r=!1;a.setTables(t?e:e.html());var o=d.default.getRelevantRows(a.TableChart.rows,a.transpose);a.tables=[];var i=a.TableChart.tables;$.each(i,(function(e,t){var l=[];$.each(t,(function(t,a){o[e][t]&&l.push(a)})),a.tables.push(l)})),$.each(d.default.getRawColumns(a.tables),(function(e,t){if(l=!1,-1==$.inArray(t,a.tableColumns)){r=!0,a.tableColumns.push(t);var o=a.columnParams&&$.inArray(t,a.columnParams)>=0||!a.columnParams&&0==e;a.isPivot&&0==a.columnParams.length&&(a.columnParams.push(t),o=!0,l=!0);var i=o?'selected="selected"':"";a.columnSelect.append($("<option "+i+"></option>").text(t)),o=!a.aggregateParams&&0==e||a.aggregateParams&&$.inArray(t,a.aggregateParams)>=0,a.isPivot&&0==a.aggregateParams.length&&!l&&(a.aggregateParams.push(t),o=!0),i=o?'selected="selected"':"",a.aggregateSelect.append($("<option "+i+"></option>").text(t))}})),a.isPivot&&a.tableColumns.length>2&&($("#macro-param-div-aggregation").removeClass("chart-browser-hidden"),a.typeSelect.find("option").each((function(){var e=$(this);"Line"!=e.val()&&"Area"!=e.val()&&"Stacked Area"!=e.val()||e.show()}))),r&&(a.columnSelect.trigger("chosen:updated"),a.aggregateSelect.trigger("chosen:updated"),d.default.sortSelectedOptions(a.columnSelect,a.columnParams),d.default.sortSelectedOptions(a.aggregateSelect,a.aggregateParams)),a.typeSelect.trigger("change"),a.updatePieKeys()}M.default.bindPreview(e,l),d.default.addIframe(e,"chart-body",(function(e){a.updateColumns(e.parent())})),l(e)};var Q,Y=z,Z=!1,ee=function(){this.tableChartMacro=null};function te(e){return null==e.tableChartMacro&&(e.tableChartMacro=new Y,e.tableChartMacro.storedParams={},e.tableChartMacro.isSaveClick=!1,e.tableChartMacro.isSetParams=!1,e.tableChartMacro.hasTable=!1),e.tableChartMacro}ee.prototype.getMacroDetailsFromSelectedMacro=function(e,t){Z=!1,Q.bodyView=w.convertStorageToView(t),te(Q).getMacroDetails(Q.bodyView,t.params,!1),w.showTabsParam(Q.bodyView),Q.tableChartMacro.hasTable=Q.bodyView.indexOf("table")>0},ee.prototype.beforeParamsRetrieved=function(e){var t=Q.tableChartMacro;return Z||(t.columnSelect.trigger("chosen:updated"),t.aggregateSelect.trigger("chosen:updated"),d.default.sortSelectedOptions(t.columnSelect,t.columnParams),d.default.sortSelectedOptions(t.aggregateSelect,t.aggregateParams),Z=!0),e.colors=t.getTrimmedColors().join(","),e.pieKeys=t.pieKeys.join("‚"),t.isSaveClick&&h.default.gaEditorChart(e,t.storedParams),t.isSetParams&&(t.storedParams=e||{}),e},ee.prototype.postPreview=function(e){var t=Q.tableChartMacro;t.updateColumns($(e).contents().find(".chart-body")),t.isSaveClick=!1,t.isSetParams=!1},ee.prototype.manipulateMarkup=function(e){return Q.tableChartMacro.isSaveClick=!0,Q.tableChartMacro.isSetParams=!1,e},ee.prototype.beforeParamsSet=function(e){$(".tfc-container").remove();var t=te(Q);return t.gotBody||Q.getMacroDetailsFromSelectedMacro(null,{body:tinymce.activeEditor.selection.getContent(),params:e}),t.gotBody=!1,t.transformElements(e),e.id=(new Date).getTime()+"_"+d.default.hashCode(t.tfBody),w.showTabsParam(Q.bodyView),t.isSaveClick=!1,t.isSetParams=!0,e.isFirstTimeEnter=t.hasTable?void 0===e.isFirstTimeEnter:void 0,e};var ae=Q=new ee,le=function(){this.tables=[],this.tableColumns=[],this.columnSelect=null,this.rowSelect=null,this.aggregateSelect=null,this.tfBody="",this.typeParams=[],this.columnParams=[],this.rowParams=[],this.aggregateParams=[],this.sortColumns=[],this.gotBody=!1};function re(e,t,a,l,r){e.hide();var o=[];a.forEach((function(e){o.push(e.replace("‌",""))}));var i=$("<select multiple/>");return $.each(o,(function(e,a){a=$.trim(a),-1==$.inArray(a,t)&&t.push(a)})),t.sort((function(e,t){return e.localeCompare(t)})),$.each(t,(function(e,t){var a=-1==$.inArray(t,o)?"":'selected="selected" ';i.append($("<option "+a+"></option>").text(t))})),e.after(i),oe(i,e,a,l,r),i}function oe(e,t,a,l,r){e.chosenTF({no_results_text:l?"No matches found. Press \u0027Enter\u0027 to add":"No matches for",placeholder_text_multiple:"Click and start typing...",width:"100%",display_selected_options:!1,addUserOption:l}).change((function(l,o){if(null!=o.selected)e.find("option").filter((function(){return this.textContent==o.selected})).prop("selected",!0),""==(i=o.selected)&&(i="‌"),a.push(i);else if(null!=o.deselected){var i;e.find("option").filter((function(){return this.textContent==o.deselected})).prop("selected",!1),""==(i=o.deselected)&&(i="‌"),a.splice($.inArray(i,a),1)}if("macro-param-column"==t.attr("id")){var n=r.sortSelect.parent();null!=e.val()&&e.val().length>1&&!n.hasClass("tf-always-hidden")?n.addClass("tf-always-hidden"):(null==e.val()||e.val().length<=1)&&n.removeClass("tf-always-hidden")}r.updateSortOptions(),t.val(a.join("‚"))}));var o=d.default.sortSelectedOptions(e,a);o.sortable({tolerance:"pointer",cursor:"move",helper:"clone",items:".search-choice",stop:function(){a.length=0,o.find(".search-choice").each((function(){var e=this.textContent;""==e&&(e="‌"),a.push(e)})),t.val(a.join("‚"))}})}le.prototype.getMacroDetails=function(e){var t=this;t.gotBody=!0,t.tfBody=e;var a=$('<div class="original-table">'+e+"</div>");t.tables=d.default.getTables(a,d.default.textType,"tf-numbering"),t.tableColumns=d.default.getColumns(t.tables)},le.prototype.transformElements=function(e){var t=this,a={vvpattern:{v:{title:"Number"},p:{title:"Percentage"},vp:{title:"Number (Percentage)"},pv:{title:"Percentage (Number)"}},decimalseparator:{"Point (.)":{title:"Point (.)"},"Comma (,)":{title:"Comma (,)"}},separator:{"":{title:""},"Space ( )":{title:"Comma (,)"},"Point (.)":{title:"Point (.)"},"Comma (,)":{title:"Comma (,)"}},dateaccuracy:{Day:{title:"Day"},None:{title:"None"},Hour:{title:"Hour"},Week:{title:"Week"},Month:{title:"Month"},Quarter:{title:"Quarter"},Year:{title:"Year"}},type:{"":{title:""},Count:{title:"Count"},Sum:{title:"Sum"},Average:{title:"Average"},Max:{title:"Max"},Min:{title:"Min"},Literal:{title:"Literal"},__multiSelect:!0}};if($("#macro-browser-dialog .macro-desc .macro-doco-link").before("Post \u003ca href=\u0022https://stiltsoft.customercase.com/forums/table-filter-for-confluence/ideas/create?from=macro\u0022\u003eIdea\u003c/a\u003e or \u003ca href=\u0022https://jsd.stiltsoft.com/servicedesk/customer/portal/2?from=macro\u0022\u003eIssue\u003c/a\u003e.   "),$("#macro-param-div-id").hide(),e.column?(t.columnParams=e.column.split("‚"),$.each(t.columnParams,(function(e,a){t.columnParams[e]=$.trim(a)}))):t.columnParams=[],e.row?(t.rowParams=e.row.split("‚"),$.each(t.rowParams,(function(e,a){t.rowParams[e]=$.trim(a)}))):t.rowParams=[],e.aggregation?(t.aggregateParams=e.aggregation.split("‚"),$.each(t.aggregateParams,(function(e,a){t.aggregateParams[e]=$.trim(a)}))):t.aggregateParams=[],t.typeParams=["Count"],e.type&&(t.typeParams=e.type.split("‚")),e.version||2==t.columnParams.length&&(t.rowParams=[t.columnParams[1]],t.columnParams.length=1),e.sort&&(e.sort=e.sort.replace(" (‍Desc)"," ⇩").replace(" (‍Asc)"," ⇧").split(",")),!e.version||1==e.version){e.version=2;var l=t.typeParams[t.typeParams.length-1];"Count"==l||0==t.aggregateParams.length?e.sort=l+" ⇩":e.sort=l+" of "+t.aggregateParams[t.aggregateParams.length-1]+" ⇩"}!function(e){(e.decimalSeparator||e.decimalseparator)&&$("#macro-param-decimalseparator").val(e.decimalSeparator||e.decimalseparator);e.decimals&&$("#macro-param-decimals").val(e.decimals);e.separator&&$("#macro-param-separator").val(e.separator);"true"==e.showrawdata&&$("#macro-param-showrawdata").prop("checked",!0);"true"==e.hidePane&&$("#macro-param-hidePane").prop("checked",!0);e.ddSeparator&&$("#macro-param-ddSeparator").val(e.ddSeparator);e.dateaccuracy&&$("#macro-param-dateaccuracy").val(e.dateaccuracy);"true"==e.hideTotal&&$("#macro-param-hideTotal").prop("checked",!0);e.numberaccuracy&&$("#macro-param-numberaccuracy").val(e.numberaccuracy);e.literalseparator&&$("#macro-param-literalseparator").val(e.literalseparator);e.tabs&&$("#macro-param-tabs").prop("checked",!0);e.vvpattern&&$("#macro-param-vvpattern").val(e.vvpattern)}(e);var r=$.merge([],t.columnParams);$.merge(r,t.rowParams),$.merge(r,t.aggregateParams),$.each(r,(function(e,a){a=a.replace("‌",""),-1==$.inArray(a,t.tableColumns)&&t.tableColumns.push(a)})),t.columnSelect=re($("#macro-param-column"),t.tableColumns,t.columnParams,!0,t),t.rowSelect=re($("#macro-param-row"),t.tableColumns,t.rowParams,!0,t),t.aggregateSelect=re($("#macro-param-aggregation"),t.tableColumns,t.aggregateParams,!0,t),t.sortSelect=$("#macro-param-sort"),t.sortSelect.chosenTF(),$(".search-field input").one("focus",(function(){$(".search-choice").css("max-width",$(".chosen-container").width()-40)})),M.default.initDateFormatInput(e),u.default.initMacroBrowserWorklogDialog(e.worklog),d.default.inputAutocomplete($("#macro-param-literalseparator"),null,[{label:"None",value:"​"},{label:"Comma",value:", "},{label:"Semicolon",value:"; "},{label:"Space",value:"\\u0020"},{label:"Line break",value:"\\n"},{label:"Bulleted list",value:"<ul>"},{label:"Numbered list",value:"<ol>"}]);var o=$("#macro-param-type");o.attr("multiple","multiple"),o.find("option").each((function(){var e=$(this);-1==$.inArray(e.val(),t.typeParams)?e.prop("selected",!1):e.prop("selected",!0)})),s.initSelects(a,e),oe(o,$("<input>"),t.typeParams,!1,t),function(){$("#macro-param-div-column").before(_().pivotTabs());var e=[$("#macro-param-div-column"),$("#macro-param-div-row"),$("#macro-param-div-aggregation"),$("#macro-param-div-type")],t=[$("#macro-param-div-sort"),$("#macro-param-div-decimalseparator"),$("#macro-param-div-separator"),$("#macro-param-div-decimals"),$("#macro-param-div-showrawdata"),$("#macro-param-div-hidePane"),$("#macro-param-div-ddSeparator"),$("#macro-param-div-vvpattern"),$("#macro-param-div-datepattern"),$("#macro-param-div-dateaccuracy"),$("#macro-param-div-numberaccuracy"),$("#macro-param-div-worklog"),$("#macro-param-div-hideTotal"),$("#macro-param-div-tabs"),$("#macro-param-div-literalseparator")];$(".tf-macrobrowser-tabs a").attr("disabled","disabled");var a=$("#tab-columns"),l=$("#tab-options"),r=[a,l];function o(e){function t(e,t){for(var a=0;a<e.length;a++)"in"==t?e[a].show():e[a].hide()}t(e[0],"in"),t(e[1],"out")}function i(e){e.hasClass("active-tab")||(r.forEach((function(e){e.removeClass("active-tab")})),e.addClass("active-tab"))}a.click((function(){i(a),o([e,t])})),l.click((function(){i(l),o([t,e])})),a.trigger("click")}(),t.updateSortOptions(e.sort);var i=$("#macro-param-div-literalseparator");-1===t.typeParams.indexOf("Literal")&&i.addClass("tf-always-hidden"),o.change((function(){-1===t.typeParams.indexOf("Literal")?i.addClass("tf-always-hidden"):i.removeClass("tf-always-hidden")})),o.on("chosen:showing_dropdown",(function(){$(".macro-input-fields").animate({scrollTop:$(".macro-input-fields form.aui").height()},750)})),2==e.version&&($("#macro-param-literalseparator").val(", "),e.version=3)},le.prototype.updateSortOptions=function(e){var t=this,a=e||t.sortSelect.val();function l(e,a,i){var n=d.default.getCellPosition(i,t.rowParams[a]);null!=n?$.each(i,(function(s,c){0!=s&&(a+1<t.rowParams.length?(l(e+" "+c[n],a+1,r(i,n,c[n])),l(e,a+1,r(i,n,c[n]))):o(e+" "+c[n]))})):a+1<t.rowParams.length&&l(e,a+1,i),o(e)}function r(e,t,a){var l=[];return $.each(e,(function(e,r){0!=e&&r[t]!=a||l.push(r)})),l}function o(e){$.trim(e).length&&(-1==$.inArray(e+" ⇧",t.sortColumns)&&t.sortColumns.push(e+" ⇧"),-1==$.inArray(e+" ⇩",t.sortColumns)&&t.sortColumns.push(e+" ⇩"))}t.sortColumns=[],t.sortSelect.empty().append('<option selected="selected" value="false"></option>').append('<option value="-as_is-">'+"Preserve the original sorting order"+"</option>"),t.columnParams.length<=1&&(o(t.columnParams[0]),$.each(t.tables,(function(e,a){$.each(t.typeParams,(function(e,r){t.rowParams.length>0?"Count"==r?l(r,0,a):$.each(t.aggregateParams,(function(e,t){l(r+" of "+t,0,a)})):"Count"==r?o(r):$.each(t.aggregateParams,(function(e,t){o(r+" of "+t)}))}))}))),$.each(t.sortColumns.sort((function(e,t){return e.localeCompare(t)})),(function(e,a){t.sortSelect.append($("<option></option>").val(a).text(a))})),t.sortSelect.val(a),t.sortSelect.trigger("chosen:updated")},le.prototype.updateColumns=function(e){var t=this;function a(e){var a=!1;d.default.normalizeTable(e),t.tables=d.default.getTables(e,d.default.textType,"tf-numbering"),$.each(d.default.getRawColumns(t.tables),(function(e,l){-1==$.inArray(l,t.tableColumns)&&(a=!0,t.tableColumns.push(l),t.columnSelect.append($("<option></option>").val(l).text(l)),t.rowSelect.append($("<option></option>").val(l).text(l)),t.aggregateSelect.append($("<option></option>").val(l).text(l)))})),a&&(d.default.sortSelectOptions(t.columnSelect),d.default.sortSelectOptions(t.rowSelect),d.default.sortSelectOptions(t.aggregateSelect),t.columnSelect.trigger("chosen:updated"),t.rowSelect.trigger("chosen:updated"),t.aggregateSelect.trigger("chosen:updated"),d.default.sortSelectedOptions(t.columnSelect,t.columnParams),d.default.sortSelectedOptions(t.rowSelect,t.rowParams),d.default.sortSelectedOptions(t.aggregateSelect,t.aggregateParams))}t.body=e,M.default.bindPreview(e,a),d.default.addIframe(e,"original-table",(function(e){a(e.parent())})),a(e)};var ie,ne=le,se=!1,ce=function(){this.pivotTableMacro=new ne,this.pivotTableMacro.storedParams={},this.pivotTableMacro.isSaveClick=!1,this.pivotTableMacro.isSetParams=!1,this.pivotTableMacro.hasTable=!1};ce.prototype.getMacroDetailsFromSelectedMacro=function(e,t){se=!1,ie.bodyView=w.convertStorageToView({body:t.body}),ie.pivotTableMacro.getMacroDetails(ie.bodyView),w.showTabsParam(ie.bodyView),ie.pivotTableMacro.hasTable=ie.bodyView.indexOf("table")>0},ce.prototype.postPreview=function(e){var t=ie.pivotTableMacro;t.updateColumns($(e).contents().find(".original-table")),t.isSaveClick=!1,t.isSetParams=!1},ce.prototype.beforeParamsSet=function(e){var t=ie.pivotTableMacro;return t.gotBody||ie.getMacroDetailsFromSelectedMacro(null,{body:tinymce.activeEditor.selection.getContent()}),t.gotBody=!1,t.transformElements(e),e.id=(new Date).getTime()+"_"+d.default.hashCode(t.tfBody),w.showTabsParam(ie.bodyView),t.isSaveClick=!1,t.isSetParams=!0,e.isFirstTimeEnter=t.hasTable?void 0===e.isFirstTimeEnter:void 0,e},ce.prototype.manipulateMarkup=function(e){return ie.pivotTableMacro.isSaveClick=!0,ie.pivotTableMacro.isSetParams=!1,e},ce.prototype.beforeParamsRetrieved=function(e){var t=ie.pivotTableMacro;return se||(t.columnSelect.trigger("chosen:updated"),t.rowSelect.trigger("chosen:updated"),t.aggregateSelect.trigger("chosen:updated"),d.default.sortSelectedOptions(t.columnSelect,t.columnParams),d.default.sortSelectedOptions(t.rowSelect,t.rowParams),d.default.sortSelectedOptions(t.aggregateSelect,t.aggregateParams),se=!0),e.type=t.typeParams.join("‚"),t.isSaveClick&&h.default.gaEditorPivot(e,t.storedParams),t.isSetParams&&(t.storedParams=e||{}),e};var me=ie=new ce;AJS.toInit((function(){AJS.MacroBrowser.setMacroJsOverride("csv-table",new y),AJS.MacroBrowser.setMacroJsOverride("json-from-table",new y),AJS.MacroBrowser.setMacroJsOverride("table-excerpt-include",T),AJS.MacroBrowser.setMacroJsOverride("table-joiner",{opener:P}),AJS.MacroBrowser.setMacroJsOverride("table-filter",q),AJS.MacroBrowser.setMacroJsOverride("table-chart",ae),AJS.MacroBrowser.setMacroJsOverride("pivot-table",me)}))}},t={};function a(l){if(t[l])return t[l].exports;var r=t[l]={id:l,loaded:!1,exports:{}};return e[l].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}a.m=e,a.amdD=function(){throw new Error("define cannot be used indirect")},a.amdO={},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,{a:t}),t},a.d=function(e,t){for(var l in t)a.o(t,l)&&!a.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){var e={560:0},t=[[75208,248,961,166,639,266,681,401,782,734]],l=function(){};function r(){for(var l,r=0;r<t.length;r++){for(var o=t[r],i=!0,n=1;n<o.length;n++){var s=o[n];0!==e[s]&&(i=!1)}i&&(t.splice(r--,1),l=a(a.s=o[0]))}return 0===t.length&&(a.x(),a.x=function(){}),l}a.x=function(){a.x=function(){},i=i.slice();for(var e=0;e<i.length;e++)o(i[e]);return(l=r)()};var o=function(r){for(var o,i,s=r[0],c=r[1],m=r[2],p=r[3],u=0,d=[];u<s.length;u++)i=s[u],a.o(e,i)&&e[i]&&d.push(e[i][0]),e[i]=0;for(o in c)a.o(c,o)&&(a.m[o]=c[o]);for(m&&m(a),n(r);d.length;)d.shift()();return p&&t.push.apply(t,p),l()},i=self.webpackChunk=self.webpackChunk||[],n=i.push.bind(i);i.push=o}(),a.x()}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.ext.newcode-macro-plugin:code-macro-editor', location = '/scripts/code-macro-languages.js' */
/**
 * Provides custom behaviour in the macro browser for the code macro.
 */
(function($) {

    var CodeMacroConfig = function() {};

    CodeMacroConfig.prototype.fields = {
        "string" : {
            "language" : function(param, options) {

                var paramDiv = $(Confluence.Templates.MacroBrowser.macroParameterSelect());
                var input = $("select", paramDiv);

                // we need to do some trickery when the value is first set, and when the value is subsequently changed,
                // so set this up.
                if (options == null)
                    options = {};
                options.setValue = function(value) {

                    var targetOption = input.find("option[value='" + value + "']");
                    if (targetOption.length == 0) {
                        var option = $("<option/>");
                        option.val(value);
                        option.text(value);
                        input.append(option);
                    }
                };

                bindAsyncDropDown(input);
                return new AJS.MacroBrowser.Field(paramDiv, input, options);
            }
        }
    };

    AJS.MacroBrowser.Macros["code"] = new CodeMacroConfig();

    /**
     * Populates an HTML Select element with the list of configured syntax highlighters.
     * @param dropDown JQuery selector for the HTML select element to be populated.
     */
    function bindAsyncDropDown(dropDown) {
        // Load the languages from Confluence
        getLanguagesAsync(function(languages) {
                    if (!languages.length)
                    {
                        AJS.log("Configured code macro languages result was not in the expected format.");
                        return;
                    }

                    var currentValue = dropDown.val();

                    dropDown.empty();
                    dropDown.append($("<option/>").attr("value", ""));

                    $.each(languages, function(index, lang) {
                        var option = $("<option />");
                        option.val(lang.aliases[0]);
                        option.text(lang.friendlyName);

                        dropDown.append(option);
                    });

                    // restore the currently selected value.
                    dropDown.val(currentValue);
                },
                function(xhr, textStatus, errorThrown) {
                    AJS.log("Failed to retrieve syntax highlighters from Confluence " + textStatus + " - " + errorThrown);
                });
    }

    /**
     * Asynchronously retrieves the current set of syntax highlighters currently installed for the Code macro.
     *
     * @param successHandler Callback to invoke if the retrieval is successful
     * @param errorHandler Callback to invoke if the retrieval fails.
     */
    function getLanguagesAsync(successHandler, errorHandler) {
        AJS.$.ajax({
            async: true,
            url: AJS.contextPath() + "/plugins/newcode/getlanguages.action",
            dataType: "json",
            timeout: 10000, // 10 seconds,
            error: function(xhr, textStatus, errorThrown) {
                if (errorHandler && typeof(errorHandler) == "function") {
                    errorHandler(xhr, textStatus, errorThrown);
                }
            },
            success: function(data) {
                if (successHandler && typeof(successHandler) == "function") {
                    successHandler(data);
                }
            }
        });
    }
})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'de.griffel.confluence.plugins.plant-uml:macro-browser-fields', location = 'js/macro.js' */
AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("svg",["svg","svgz"]);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.confluence.markdown.confluence-markdown-macro:hidden-field-parameter', location = 'js/hidden-parameter-field.js' */
function processParameter(param, paramType) {
    var requestUrl = AJS.contextPath() + '/rest/markdown-from-url/1.0/config/retrieve';

    // sync request for first loading params, then rendering edit-macro
    var request = new XMLHttpRequest();
    request.open('GET', requestUrl, false);
    request.send(null);

    var parameterField = AJS.MacroBrowser.ParameterFields[paramType](param, {});

    if (request.status === 200) {
        parameterField = hideParameter(param, parameterField, !(request.responseText === "true"));
    }

    return parameterField;
}

/// hides parameter field if it is needed
function hideParameter(param, parameterField, toHide){
    if (toHide){
        var parameterField = AJS.MacroBrowser.ParameterFields["_hidden"](param, {});

        if (!parameterField.getValue()) {
            // by default placing null value
            parameterField.setValue(null);
        }
    }

    return parameterField;
}

AJS.MacroBrowser.setMacroJsOverride("markdown-from-url", {
    fields: {
        string: {
            "LinkAzureDevOpsRepository": function (param) {
                return processParameter(param, "string");
            }
        }
    }
});
}catch(e){WRMCB(e)};